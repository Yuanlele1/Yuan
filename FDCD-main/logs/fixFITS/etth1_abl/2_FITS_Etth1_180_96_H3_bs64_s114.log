Args in experiment:
Namespace(H_order=3, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_180_96_FITS_ETTh1_ftM_sl180_ll48_pl96_H3_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=34, out_features=52, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1584128.0
params:  1820.0
Trainable parameters:  1820
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.6954879760742188
Epoch: 1, Steps: 65 | Train Loss: 0.6496466 Vali Loss: 1.3778925 Test Loss: 0.8170393
Validation loss decreased (inf --> 1.377892).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.231365442276001
Epoch: 2, Steps: 65 | Train Loss: 0.5032226 Vali Loss: 1.1690927 Test Loss: 0.6744679
Validation loss decreased (1.377892 --> 1.169093).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 2.0035040378570557
Epoch: 3, Steps: 65 | Train Loss: 0.4163570 Vali Loss: 1.0536280 Test Loss: 0.5977701
Validation loss decreased (1.169093 --> 1.053628).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.5982251167297363
Epoch: 4, Steps: 65 | Train Loss: 0.3597085 Vali Loss: 0.9789776 Test Loss: 0.5516521
Validation loss decreased (1.053628 --> 0.978978).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.6327941417694092
Epoch: 5, Steps: 65 | Train Loss: 0.3201313 Vali Loss: 0.9342863 Test Loss: 0.5209676
Validation loss decreased (0.978978 --> 0.934286).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.1100456714630127
Epoch: 6, Steps: 65 | Train Loss: 0.2909737 Vali Loss: 0.8917218 Test Loss: 0.4987543
Validation loss decreased (0.934286 --> 0.891722).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.6423523426055908
Epoch: 7, Steps: 65 | Train Loss: 0.2692532 Vali Loss: 0.8720790 Test Loss: 0.4830604
Validation loss decreased (0.891722 --> 0.872079).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 2.2531089782714844
Epoch: 8, Steps: 65 | Train Loss: 0.2523338 Vali Loss: 0.8489440 Test Loss: 0.4708364
Validation loss decreased (0.872079 --> 0.848944).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 2.2447948455810547
Epoch: 9, Steps: 65 | Train Loss: 0.2389485 Vali Loss: 0.8310549 Test Loss: 0.4615917
Validation loss decreased (0.848944 --> 0.831055).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.8617565631866455
Epoch: 10, Steps: 65 | Train Loss: 0.2282991 Vali Loss: 0.8218427 Test Loss: 0.4538819
Validation loss decreased (0.831055 --> 0.821843).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 2.199030876159668
Epoch: 11, Steps: 65 | Train Loss: 0.2197393 Vali Loss: 0.8121877 Test Loss: 0.4481708
Validation loss decreased (0.821843 --> 0.812188).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 2.4263076782226562
Epoch: 12, Steps: 65 | Train Loss: 0.2125683 Vali Loss: 0.8040437 Test Loss: 0.4427960
Validation loss decreased (0.812188 --> 0.804044).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.6356351375579834
Epoch: 13, Steps: 65 | Train Loss: 0.2065463 Vali Loss: 0.7997538 Test Loss: 0.4387995
Validation loss decreased (0.804044 --> 0.799754).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.4251105785369873
Epoch: 14, Steps: 65 | Train Loss: 0.2014284 Vali Loss: 0.7937856 Test Loss: 0.4354693
Validation loss decreased (0.799754 --> 0.793786).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.407719612121582
Epoch: 15, Steps: 65 | Train Loss: 0.1971189 Vali Loss: 0.7846303 Test Loss: 0.4328777
Validation loss decreased (0.793786 --> 0.784630).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.4991731643676758
Epoch: 16, Steps: 65 | Train Loss: 0.1934797 Vali Loss: 0.7823216 Test Loss: 0.4301324
Validation loss decreased (0.784630 --> 0.782322).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.4749343395233154
Epoch: 17, Steps: 65 | Train Loss: 0.1902719 Vali Loss: 0.7813294 Test Loss: 0.4280226
Validation loss decreased (0.782322 --> 0.781329).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.4270424842834473
Epoch: 18, Steps: 65 | Train Loss: 0.1874901 Vali Loss: 0.7724565 Test Loss: 0.4261753
Validation loss decreased (0.781329 --> 0.772456).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.35886549949646
Epoch: 19, Steps: 65 | Train Loss: 0.1849780 Vali Loss: 0.7715074 Test Loss: 0.4244037
Validation loss decreased (0.772456 --> 0.771507).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.3358287811279297
Epoch: 20, Steps: 65 | Train Loss: 0.1825816 Vali Loss: 0.7721419 Test Loss: 0.4229975
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.659661054611206
Epoch: 21, Steps: 65 | Train Loss: 0.1806552 Vali Loss: 0.7636443 Test Loss: 0.4215429
Validation loss decreased (0.771507 --> 0.763644).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.603231430053711
Epoch: 22, Steps: 65 | Train Loss: 0.1788754 Vali Loss: 0.7647786 Test Loss: 0.4203114
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 1.3632538318634033
Epoch: 23, Steps: 65 | Train Loss: 0.1772209 Vali Loss: 0.7625815 Test Loss: 0.4193549
Validation loss decreased (0.763644 --> 0.762582).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.9283382892608643
Epoch: 24, Steps: 65 | Train Loss: 0.1758867 Vali Loss: 0.7633261 Test Loss: 0.4183069
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.5555377006530762
Epoch: 25, Steps: 65 | Train Loss: 0.1744921 Vali Loss: 0.7599829 Test Loss: 0.4173439
Validation loss decreased (0.762582 --> 0.759983).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 1.571997880935669
Epoch: 26, Steps: 65 | Train Loss: 0.1733717 Vali Loss: 0.7614940 Test Loss: 0.4164253
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.3662619590759277
Epoch: 27, Steps: 65 | Train Loss: 0.1721616 Vali Loss: 0.7566175 Test Loss: 0.4157334
Validation loss decreased (0.759983 --> 0.756617).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 2.0336785316467285
Epoch: 28, Steps: 65 | Train Loss: 0.1711349 Vali Loss: 0.7590516 Test Loss: 0.4150223
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.3767051696777344
Epoch: 29, Steps: 65 | Train Loss: 0.1702671 Vali Loss: 0.7575338 Test Loss: 0.4143546
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.407069206237793
Epoch: 30, Steps: 65 | Train Loss: 0.1695635 Vali Loss: 0.7516802 Test Loss: 0.4136936
Validation loss decreased (0.756617 --> 0.751680).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 1.6032357215881348
Epoch: 31, Steps: 65 | Train Loss: 0.1685481 Vali Loss: 0.7596257 Test Loss: 0.4131193
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.9514038562774658
Epoch: 32, Steps: 65 | Train Loss: 0.1680026 Vali Loss: 0.7543387 Test Loss: 0.4126647
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.3738369941711426
Epoch: 33, Steps: 65 | Train Loss: 0.1671330 Vali Loss: 0.7569612 Test Loss: 0.4121909
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.615652084350586
Epoch: 34, Steps: 65 | Train Loss: 0.1666254 Vali Loss: 0.7463861 Test Loss: 0.4117842
Validation loss decreased (0.751680 --> 0.746386).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.3663206100463867
Epoch: 35, Steps: 65 | Train Loss: 0.1661066 Vali Loss: 0.7499167 Test Loss: 0.4112763
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.4090056419372559
Epoch: 36, Steps: 65 | Train Loss: 0.1654168 Vali Loss: 0.7530076 Test Loss: 0.4109289
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.2555699348449707
Epoch: 37, Steps: 65 | Train Loss: 0.1649984 Vali Loss: 0.7490671 Test Loss: 0.4105322
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.3815758228302002
Epoch: 38, Steps: 65 | Train Loss: 0.1645984 Vali Loss: 0.7502493 Test Loss: 0.4102062
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.4509804248809814
Epoch: 39, Steps: 65 | Train Loss: 0.1641771 Vali Loss: 0.7478107 Test Loss: 0.4098872
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.4173429012298584
Epoch: 40, Steps: 65 | Train Loss: 0.1637739 Vali Loss: 0.7477641 Test Loss: 0.4095364
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 1.797004222869873
Epoch: 41, Steps: 65 | Train Loss: 0.1633539 Vali Loss: 0.7469530 Test Loss: 0.4092784
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.631990671157837
Epoch: 42, Steps: 65 | Train Loss: 0.1629460 Vali Loss: 0.7474664 Test Loss: 0.4090253
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.2506146430969238
Epoch: 43, Steps: 65 | Train Loss: 0.1628006 Vali Loss: 0.7483314 Test Loss: 0.4087418
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.2777137756347656
Epoch: 44, Steps: 65 | Train Loss: 0.1623386 Vali Loss: 0.7438512 Test Loss: 0.4085536
Validation loss decreased (0.746386 --> 0.743851).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.302950382232666
Epoch: 45, Steps: 65 | Train Loss: 0.1621442 Vali Loss: 0.7443704 Test Loss: 0.4083028
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.7484817504882812
Epoch: 46, Steps: 65 | Train Loss: 0.1617199 Vali Loss: 0.7404302 Test Loss: 0.4080604
Validation loss decreased (0.743851 --> 0.740430).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.3671202659606934
Epoch: 47, Steps: 65 | Train Loss: 0.1615246 Vali Loss: 0.7431129 Test Loss: 0.4078602
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.2090065479278564
Epoch: 48, Steps: 65 | Train Loss: 0.1611756 Vali Loss: 0.7447947 Test Loss: 0.4076886
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.2253355979919434
Epoch: 49, Steps: 65 | Train Loss: 0.1610430 Vali Loss: 0.7443290 Test Loss: 0.4075017
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.3167924880981445
Epoch: 50, Steps: 65 | Train Loss: 0.1607496 Vali Loss: 0.7446740 Test Loss: 0.4073223
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.0934007167816162
Epoch: 51, Steps: 65 | Train Loss: 0.1606701 Vali Loss: 0.7443295 Test Loss: 0.4071532
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.2541589736938477
Epoch: 52, Steps: 65 | Train Loss: 0.1604130 Vali Loss: 0.7445946 Test Loss: 0.4069776
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.3466947078704834
Epoch: 53, Steps: 65 | Train Loss: 0.1601543 Vali Loss: 0.7396877 Test Loss: 0.4068622
Validation loss decreased (0.740430 --> 0.739688).  Saving model ...
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.355360507965088
Epoch: 54, Steps: 65 | Train Loss: 0.1598919 Vali Loss: 0.7432420 Test Loss: 0.4067248
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 1.3459856510162354
Epoch: 55, Steps: 65 | Train Loss: 0.1598706 Vali Loss: 0.7405699 Test Loss: 0.4066021
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 1.496577501296997
Epoch: 56, Steps: 65 | Train Loss: 0.1596588 Vali Loss: 0.7419652 Test Loss: 0.4064739
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 1.3388361930847168
Epoch: 57, Steps: 65 | Train Loss: 0.1595040 Vali Loss: 0.7403808 Test Loss: 0.4063466
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 1.234004020690918
Epoch: 58, Steps: 65 | Train Loss: 0.1593593 Vali Loss: 0.7420200 Test Loss: 0.4062414
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.2555875778198242
Epoch: 59, Steps: 65 | Train Loss: 0.1592391 Vali Loss: 0.7426792 Test Loss: 0.4061360
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.3796803951263428
Epoch: 60, Steps: 65 | Train Loss: 0.1591540 Vali Loss: 0.7421034 Test Loss: 0.4060279
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.3363258838653564
Epoch: 61, Steps: 65 | Train Loss: 0.1589990 Vali Loss: 0.7426260 Test Loss: 0.4059671
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.4185912609100342
Epoch: 62, Steps: 65 | Train Loss: 0.1587798 Vali Loss: 0.7386204 Test Loss: 0.4058537
Validation loss decreased (0.739688 --> 0.738620).  Saving model ...
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.2140836715698242
Epoch: 63, Steps: 65 | Train Loss: 0.1586559 Vali Loss: 0.7332050 Test Loss: 0.4057822
Validation loss decreased (0.738620 --> 0.733205).  Saving model ...
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 1.3391754627227783
Epoch: 64, Steps: 65 | Train Loss: 0.1586178 Vali Loss: 0.7385502 Test Loss: 0.4057036
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 1.3955388069152832
Epoch: 65, Steps: 65 | Train Loss: 0.1584493 Vali Loss: 0.7359545 Test Loss: 0.4056203
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.611696720123291
Epoch: 66, Steps: 65 | Train Loss: 0.1583754 Vali Loss: 0.7397078 Test Loss: 0.4055490
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 1.3918774127960205
Epoch: 67, Steps: 65 | Train Loss: 0.1582779 Vali Loss: 0.7415140 Test Loss: 0.4054720
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.3403055667877197
Epoch: 68, Steps: 65 | Train Loss: 0.1582382 Vali Loss: 0.7436332 Test Loss: 0.4054072
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 1.7203352451324463
Epoch: 69, Steps: 65 | Train Loss: 0.1581271 Vali Loss: 0.7418114 Test Loss: 0.4053497
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 1.2720890045166016
Epoch: 70, Steps: 65 | Train Loss: 0.1580753 Vali Loss: 0.7403883 Test Loss: 0.4052927
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 1.2459158897399902
Epoch: 71, Steps: 65 | Train Loss: 0.1579832 Vali Loss: 0.7379640 Test Loss: 0.4052457
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 1.4244487285614014
Epoch: 72, Steps: 65 | Train Loss: 0.1579539 Vali Loss: 0.7376468 Test Loss: 0.4051858
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 1.3679697513580322
Epoch: 73, Steps: 65 | Train Loss: 0.1578119 Vali Loss: 0.7389842 Test Loss: 0.4051349
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 1.3004474639892578
Epoch: 74, Steps: 65 | Train Loss: 0.1579188 Vali Loss: 0.7384294 Test Loss: 0.4050844
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 1.2810091972351074
Epoch: 75, Steps: 65 | Train Loss: 0.1577005 Vali Loss: 0.7366776 Test Loss: 0.4050441
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 1.2641727924346924
Epoch: 76, Steps: 65 | Train Loss: 0.1577529 Vali Loss: 0.7415305 Test Loss: 0.4050077
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 1.3390004634857178
Epoch: 77, Steps: 65 | Train Loss: 0.1575993 Vali Loss: 0.7399392 Test Loss: 0.4049553
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 1.3663580417633057
Epoch: 78, Steps: 65 | Train Loss: 0.1575213 Vali Loss: 0.7390621 Test Loss: 0.4049229
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 1.519157886505127
Epoch: 79, Steps: 65 | Train Loss: 0.1575890 Vali Loss: 0.7385241 Test Loss: 0.4048923
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 1.5369198322296143
Epoch: 80, Steps: 65 | Train Loss: 0.1574546 Vali Loss: 0.7379881 Test Loss: 0.4048515
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 1.3459699153900146
Epoch: 81, Steps: 65 | Train Loss: 0.1574454 Vali Loss: 0.7375231 Test Loss: 0.4048171
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 1.278531789779663
Epoch: 82, Steps: 65 | Train Loss: 0.1573927 Vali Loss: 0.7353925 Test Loss: 0.4047857
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 1.2072076797485352
Epoch: 83, Steps: 65 | Train Loss: 0.1573443 Vali Loss: 0.7375699 Test Loss: 0.4047515
EarlyStopping counter: 20 out of 20
Early stopping
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=34, out_features=52, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1584128.0
params:  1820.0
Trainable parameters:  1820
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.4498136043548584
Epoch: 1, Steps: 65 | Train Loss: 0.3629398 Vali Loss: 0.7201564 Test Loss: 0.3929876
Validation loss decreased (inf --> 0.720156).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.4952383041381836
Epoch: 2, Steps: 65 | Train Loss: 0.3571195 Vali Loss: 0.7185445 Test Loss: 0.3902561
Validation loss decreased (0.720156 --> 0.718544).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.6018719673156738
Epoch: 3, Steps: 65 | Train Loss: 0.3550311 Vali Loss: 0.7179496 Test Loss: 0.3893710
Validation loss decreased (0.718544 --> 0.717950).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.22617769241333
Epoch: 4, Steps: 65 | Train Loss: 0.3543987 Vali Loss: 0.7115344 Test Loss: 0.3882461
Validation loss decreased (0.717950 --> 0.711534).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.3728015422821045
Epoch: 5, Steps: 65 | Train Loss: 0.3541202 Vali Loss: 0.7082864 Test Loss: 0.3878611
Validation loss decreased (0.711534 --> 0.708286).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.2724742889404297
Epoch: 6, Steps: 65 | Train Loss: 0.3536699 Vali Loss: 0.7094557 Test Loss: 0.3875973
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.4020373821258545
Epoch: 7, Steps: 65 | Train Loss: 0.3533540 Vali Loss: 0.7117671 Test Loss: 0.3870936
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.4407238960266113
Epoch: 8, Steps: 65 | Train Loss: 0.3532060 Vali Loss: 0.7101958 Test Loss: 0.3876671
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.2746696472167969
Epoch: 9, Steps: 65 | Train Loss: 0.3532433 Vali Loss: 0.7090943 Test Loss: 0.3866468
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.2537472248077393
Epoch: 10, Steps: 65 | Train Loss: 0.3532526 Vali Loss: 0.7137629 Test Loss: 0.3869207
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.3528716564178467
Epoch: 11, Steps: 65 | Train Loss: 0.3531114 Vali Loss: 0.7077773 Test Loss: 0.3867461
Validation loss decreased (0.708286 --> 0.707777).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.3350067138671875
Epoch: 12, Steps: 65 | Train Loss: 0.3527650 Vali Loss: 0.7091132 Test Loss: 0.3870537
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.3865749835968018
Epoch: 13, Steps: 65 | Train Loss: 0.3530774 Vali Loss: 0.7113899 Test Loss: 0.3871118
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.2979226112365723
Epoch: 14, Steps: 65 | Train Loss: 0.3529911 Vali Loss: 0.7091605 Test Loss: 0.3868867
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.2450149059295654
Epoch: 15, Steps: 65 | Train Loss: 0.3530220 Vali Loss: 0.7089701 Test Loss: 0.3869148
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.2720742225646973
Epoch: 16, Steps: 65 | Train Loss: 0.3527314 Vali Loss: 0.7086407 Test Loss: 0.3867724
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.4373159408569336
Epoch: 17, Steps: 65 | Train Loss: 0.3526574 Vali Loss: 0.7097928 Test Loss: 0.3867304
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.3057761192321777
Epoch: 18, Steps: 65 | Train Loss: 0.3525619 Vali Loss: 0.7089424 Test Loss: 0.3867461
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.3864805698394775
Epoch: 19, Steps: 65 | Train Loss: 0.3525760 Vali Loss: 0.7121664 Test Loss: 0.3868630
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.7062768936157227
Epoch: 20, Steps: 65 | Train Loss: 0.3526166 Vali Loss: 0.7078431 Test Loss: 0.3866463
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.0536482334136963
Epoch: 21, Steps: 65 | Train Loss: 0.3523824 Vali Loss: 0.7032630 Test Loss: 0.3867742
Validation loss decreased (0.707777 --> 0.703263).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.73880934715271
Epoch: 22, Steps: 65 | Train Loss: 0.3528150 Vali Loss: 0.7103059 Test Loss: 0.3868535
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 2.0279462337493896
Epoch: 23, Steps: 65 | Train Loss: 0.3525496 Vali Loss: 0.7067162 Test Loss: 0.3866539
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.4490320682525635
Epoch: 24, Steps: 65 | Train Loss: 0.3525797 Vali Loss: 0.7086335 Test Loss: 0.3867412
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.1741323471069336
Epoch: 25, Steps: 65 | Train Loss: 0.3527294 Vali Loss: 0.7103730 Test Loss: 0.3867981
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 2.2853450775146484
Epoch: 26, Steps: 65 | Train Loss: 0.3524584 Vali Loss: 0.7072764 Test Loss: 0.3867200
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.7949230670928955
Epoch: 27, Steps: 65 | Train Loss: 0.3526785 Vali Loss: 0.7085936 Test Loss: 0.3867386
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 1.7256693840026855
Epoch: 28, Steps: 65 | Train Loss: 0.3522300 Vali Loss: 0.7065995 Test Loss: 0.3867832
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.7403688430786133
Epoch: 29, Steps: 65 | Train Loss: 0.3527793 Vali Loss: 0.7055643 Test Loss: 0.3868100
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.3586463928222656
Epoch: 30, Steps: 65 | Train Loss: 0.3526624 Vali Loss: 0.7070198 Test Loss: 0.3867333
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 1.4815688133239746
Epoch: 31, Steps: 65 | Train Loss: 0.3525123 Vali Loss: 0.7091092 Test Loss: 0.3867539
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.4789271354675293
Epoch: 32, Steps: 65 | Train Loss: 0.3524102 Vali Loss: 0.7102438 Test Loss: 0.3867035
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.360187292098999
Epoch: 33, Steps: 65 | Train Loss: 0.3524896 Vali Loss: 0.7062775 Test Loss: 0.3868254
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.2766597270965576
Epoch: 34, Steps: 65 | Train Loss: 0.3524843 Vali Loss: 0.7051903 Test Loss: 0.3867595
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.1877295970916748
Epoch: 35, Steps: 65 | Train Loss: 0.3523376 Vali Loss: 0.7072097 Test Loss: 0.3868200
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.2738490104675293
Epoch: 36, Steps: 65 | Train Loss: 0.3524036 Vali Loss: 0.7046126 Test Loss: 0.3867349
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.17531156539917
Epoch: 37, Steps: 65 | Train Loss: 0.3529340 Vali Loss: 0.7033719 Test Loss: 0.3867303
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.120035171508789
Epoch: 38, Steps: 65 | Train Loss: 0.3525039 Vali Loss: 0.7092584 Test Loss: 0.3867696
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.2153949737548828
Epoch: 39, Steps: 65 | Train Loss: 0.3523802 Vali Loss: 0.7106003 Test Loss: 0.3868036
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.2867398262023926
Epoch: 40, Steps: 65 | Train Loss: 0.3522545 Vali Loss: 0.7057293 Test Loss: 0.3867289
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 1.30476975440979
Epoch: 41, Steps: 65 | Train Loss: 0.3523612 Vali Loss: 0.7045591 Test Loss: 0.3867379
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh1_180_96_FITS_ETTh1_ftM_sl180_ll48_pl96_H3_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3860878348350525, mae:0.4000645875930786, rse:0.590202271938324, corr:[0.27276468 0.27617207 0.2766772  0.27476346 0.2719276  0.2698256
 0.26927063 0.2694044  0.2690417  0.2686835  0.26873037 0.26907027
 0.2690008  0.2680609  0.26738375 0.2676036  0.26808262 0.26809448
 0.26756573 0.26694307 0.26677206 0.26713556 0.267359   0.26683164
 0.26566467 0.2652899  0.2653311  0.26508883 0.2641974  0.26332355
 0.263028   0.26314443 0.26306885 0.26261628 0.2622891  0.2627218
 0.2634075  0.26329085 0.26286125 0.26284662 0.26342392 0.26400203
 0.2640083  0.2638615  0.2642381  0.26486737 0.26526612 0.26457158
 0.26283264 0.2617319  0.26076326 0.25949427 0.25790596 0.25652632
 0.25600883 0.25616962 0.25628078 0.25628278 0.25607106 0.25655714
 0.2572379  0.2569877  0.25636733 0.256103   0.25640064 0.25677216
 0.2567624  0.2563845  0.2563055  0.25668108 0.25696805 0.25605822
 0.25409132 0.25287554 0.25238615 0.2521039  0.2516084  0.25090957
 0.25063977 0.2507816  0.2506818  0.25028595 0.24974102 0.24993284
 0.25071335 0.25053832 0.24984205 0.24941929 0.24962148 0.25008282
 0.24989848 0.24880992 0.2479217  0.24802767 0.24947323 0.25029096]
