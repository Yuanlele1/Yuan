Args in experiment:
Namespace(H_order=3, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=103, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H3_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=103, out_features=116, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  10705408.0
params:  12064.0
Trainable parameters:  12064
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 4.832551956176758
Epoch: 1, Steps: 61 | Train Loss: 0.5717200 Vali Loss: 0.9536170 Test Loss: 0.4926620
Validation loss decreased (inf --> 0.953617).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 4.703346014022827
Epoch: 2, Steps: 61 | Train Loss: 0.4050959 Vali Loss: 0.8211207 Test Loss: 0.4120332
Validation loss decreased (0.953617 --> 0.821121).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 4.5539772510528564
Epoch: 3, Steps: 61 | Train Loss: 0.3717657 Vali Loss: 0.7823005 Test Loss: 0.3939760
Validation loss decreased (0.821121 --> 0.782300).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 4.42877721786499
Epoch: 4, Steps: 61 | Train Loss: 0.3611488 Vali Loss: 0.7641576 Test Loss: 0.3900863
Validation loss decreased (0.782300 --> 0.764158).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 4.483707427978516
Epoch: 5, Steps: 61 | Train Loss: 0.3561311 Vali Loss: 0.7546828 Test Loss: 0.3883425
Validation loss decreased (0.764158 --> 0.754683).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 4.225167989730835
Epoch: 6, Steps: 61 | Train Loss: 0.3526024 Vali Loss: 0.7410012 Test Loss: 0.3872973
Validation loss decreased (0.754683 --> 0.741001).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 4.946181774139404
Epoch: 7, Steps: 61 | Train Loss: 0.3503208 Vali Loss: 0.7356094 Test Loss: 0.3874285
Validation loss decreased (0.741001 --> 0.735609).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 5.005829095840454
Epoch: 8, Steps: 61 | Train Loss: 0.3486067 Vali Loss: 0.7308099 Test Loss: 0.3871941
Validation loss decreased (0.735609 --> 0.730810).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 4.57776951789856
Epoch: 9, Steps: 61 | Train Loss: 0.3472457 Vali Loss: 0.7228714 Test Loss: 0.3870225
Validation loss decreased (0.730810 --> 0.722871).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 4.35680365562439
Epoch: 10, Steps: 61 | Train Loss: 0.3459934 Vali Loss: 0.7257035 Test Loss: 0.3870651
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 4.6524879932403564
Epoch: 11, Steps: 61 | Train Loss: 0.3451633 Vali Loss: 0.7214290 Test Loss: 0.3868318
Validation loss decreased (0.722871 --> 0.721429).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 4.590929269790649
Epoch: 12, Steps: 61 | Train Loss: 0.3447004 Vali Loss: 0.7213237 Test Loss: 0.3871219
Validation loss decreased (0.721429 --> 0.721324).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 4.364938497543335
Epoch: 13, Steps: 61 | Train Loss: 0.3440416 Vali Loss: 0.7161838 Test Loss: 0.3867401
Validation loss decreased (0.721324 --> 0.716184).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 4.570409059524536
Epoch: 14, Steps: 61 | Train Loss: 0.3437034 Vali Loss: 0.7157607 Test Loss: 0.3868768
Validation loss decreased (0.716184 --> 0.715761).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 4.720273017883301
Epoch: 15, Steps: 61 | Train Loss: 0.3429976 Vali Loss: 0.7187293 Test Loss: 0.3870314
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 4.4447033405303955
Epoch: 16, Steps: 61 | Train Loss: 0.3428155 Vali Loss: 0.7159461 Test Loss: 0.3870782
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 4.5904083251953125
Epoch: 17, Steps: 61 | Train Loss: 0.3426568 Vali Loss: 0.7138299 Test Loss: 0.3871688
Validation loss decreased (0.715761 --> 0.713830).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 4.580552339553833
Epoch: 18, Steps: 61 | Train Loss: 0.3423763 Vali Loss: 0.7154163 Test Loss: 0.3867680
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 4.68475079536438
Epoch: 19, Steps: 61 | Train Loss: 0.3420010 Vali Loss: 0.7133246 Test Loss: 0.3872733
Validation loss decreased (0.713830 --> 0.713325).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 4.748865604400635
Epoch: 20, Steps: 61 | Train Loss: 0.3417367 Vali Loss: 0.7137315 Test Loss: 0.3868547
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 4.604919672012329
Epoch: 21, Steps: 61 | Train Loss: 0.3416182 Vali Loss: 0.7105562 Test Loss: 0.3870278
Validation loss decreased (0.713325 --> 0.710556).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 4.8804614543914795
Epoch: 22, Steps: 61 | Train Loss: 0.3416959 Vali Loss: 0.7095076 Test Loss: 0.3868779
Validation loss decreased (0.710556 --> 0.709508).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 4.005533695220947
Epoch: 23, Steps: 61 | Train Loss: 0.3414206 Vali Loss: 0.7113769 Test Loss: 0.3868695
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 4.626458406448364
Epoch: 24, Steps: 61 | Train Loss: 0.3412338 Vali Loss: 0.7124065 Test Loss: 0.3870004
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 4.724599123001099
Epoch: 25, Steps: 61 | Train Loss: 0.3410913 Vali Loss: 0.7084250 Test Loss: 0.3869964
Validation loss decreased (0.709508 --> 0.708425).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 4.780532598495483
Epoch: 26, Steps: 61 | Train Loss: 0.3409216 Vali Loss: 0.7048536 Test Loss: 0.3870270
Validation loss decreased (0.708425 --> 0.704854).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 4.398861885070801
Epoch: 27, Steps: 61 | Train Loss: 0.3408179 Vali Loss: 0.7069001 Test Loss: 0.3869581
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 4.7131547927856445
Epoch: 28, Steps: 61 | Train Loss: 0.3406837 Vali Loss: 0.7112553 Test Loss: 0.3869590
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 4.558828592300415
Epoch: 29, Steps: 61 | Train Loss: 0.3406426 Vali Loss: 0.7109625 Test Loss: 0.3869508
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 4.807948589324951
Epoch: 30, Steps: 61 | Train Loss: 0.3405023 Vali Loss: 0.7109178 Test Loss: 0.3869009
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 4.67900276184082
Epoch: 31, Steps: 61 | Train Loss: 0.3403219 Vali Loss: 0.7112464 Test Loss: 0.3870711
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 4.929592847824097
Epoch: 32, Steps: 61 | Train Loss: 0.3403632 Vali Loss: 0.7063596 Test Loss: 0.3869708
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 4.7877631187438965
Epoch: 33, Steps: 61 | Train Loss: 0.3402463 Vali Loss: 0.7070912 Test Loss: 0.3869842
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 4.732170581817627
Epoch: 34, Steps: 61 | Train Loss: 0.3401074 Vali Loss: 0.7093762 Test Loss: 0.3870603
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 5.250611066818237
Epoch: 35, Steps: 61 | Train Loss: 0.3401084 Vali Loss: 0.7073305 Test Loss: 0.3871715
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 4.626722574234009
Epoch: 36, Steps: 61 | Train Loss: 0.3400857 Vali Loss: 0.7086238 Test Loss: 0.3869328
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 4.468547105789185
Epoch: 37, Steps: 61 | Train Loss: 0.3400226 Vali Loss: 0.7103057 Test Loss: 0.3871277
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 4.792135953903198
Epoch: 38, Steps: 61 | Train Loss: 0.3400449 Vali Loss: 0.7047887 Test Loss: 0.3871742
Validation loss decreased (0.704854 --> 0.704789).  Saving model ...
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 4.857253313064575
Epoch: 39, Steps: 61 | Train Loss: 0.3398952 Vali Loss: 0.7121980 Test Loss: 0.3870101
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 4.489142894744873
Epoch: 40, Steps: 61 | Train Loss: 0.3397984 Vali Loss: 0.7093298 Test Loss: 0.3871920
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 4.3777570724487305
Epoch: 41, Steps: 61 | Train Loss: 0.3397182 Vali Loss: 0.7083354 Test Loss: 0.3870185
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 4.576415300369263
Epoch: 42, Steps: 61 | Train Loss: 0.3394479 Vali Loss: 0.7088109 Test Loss: 0.3871038
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 4.960294723510742
Epoch: 43, Steps: 61 | Train Loss: 0.3396842 Vali Loss: 0.7081135 Test Loss: 0.3870560
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 4.37864875793457
Epoch: 44, Steps: 61 | Train Loss: 0.3397355 Vali Loss: 0.7099172 Test Loss: 0.3870366
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 4.430309534072876
Epoch: 45, Steps: 61 | Train Loss: 0.3394605 Vali Loss: 0.7092106 Test Loss: 0.3870250
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 5.245352506637573
Epoch: 46, Steps: 61 | Train Loss: 0.3395163 Vali Loss: 0.7073985 Test Loss: 0.3871048
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 4.978180170059204
Epoch: 47, Steps: 61 | Train Loss: 0.3395566 Vali Loss: 0.7057134 Test Loss: 0.3870038
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 4.9562273025512695
Epoch: 48, Steps: 61 | Train Loss: 0.3395510 Vali Loss: 0.7069954 Test Loss: 0.3870874
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 4.707693099975586
Epoch: 49, Steps: 61 | Train Loss: 0.3396263 Vali Loss: 0.7074370 Test Loss: 0.3871681
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 4.711759805679321
Epoch: 50, Steps: 61 | Train Loss: 0.3395531 Vali Loss: 0.7117168 Test Loss: 0.3870446
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 4.596316337585449
Epoch: 51, Steps: 61 | Train Loss: 0.3394140 Vali Loss: 0.7046483 Test Loss: 0.3871024
Validation loss decreased (0.704789 --> 0.704648).  Saving model ...
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 4.1152503490448
Epoch: 52, Steps: 61 | Train Loss: 0.3390158 Vali Loss: 0.7054825 Test Loss: 0.3870445
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 4.920251846313477
Epoch: 53, Steps: 61 | Train Loss: 0.3394494 Vali Loss: 0.7079996 Test Loss: 0.3870476
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 4.663325548171997
Epoch: 54, Steps: 61 | Train Loss: 0.3393088 Vali Loss: 0.7098147 Test Loss: 0.3870532
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 4.492807626724243
Epoch: 55, Steps: 61 | Train Loss: 0.3390422 Vali Loss: 0.7049223 Test Loss: 0.3870585
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 4.250591278076172
Epoch: 56, Steps: 61 | Train Loss: 0.3395434 Vali Loss: 0.7065999 Test Loss: 0.3870371
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 4.47848105430603
Epoch: 57, Steps: 61 | Train Loss: 0.3394111 Vali Loss: 0.7093560 Test Loss: 0.3870694
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 5.032312870025635
Epoch: 58, Steps: 61 | Train Loss: 0.3393269 Vali Loss: 0.7078364 Test Loss: 0.3870991
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 4.735578298568726
Epoch: 59, Steps: 61 | Train Loss: 0.3393217 Vali Loss: 0.7067414 Test Loss: 0.3870651
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 4.725584268569946
Epoch: 60, Steps: 61 | Train Loss: 0.3393807 Vali Loss: 0.7095668 Test Loss: 0.3870538
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 4.056498765945435
Epoch: 61, Steps: 61 | Train Loss: 0.3394109 Vali Loss: 0.7108949 Test Loss: 0.3870050
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 4.979766368865967
Epoch: 62, Steps: 61 | Train Loss: 0.3388656 Vali Loss: 0.7085262 Test Loss: 0.3870128
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 4.2559685707092285
Epoch: 63, Steps: 61 | Train Loss: 0.3391105 Vali Loss: 0.7076892 Test Loss: 0.3870120
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 4.792356014251709
Epoch: 64, Steps: 61 | Train Loss: 0.3391514 Vali Loss: 0.7108954 Test Loss: 0.3870495
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 4.61541485786438
Epoch: 65, Steps: 61 | Train Loss: 0.3392346 Vali Loss: 0.7057472 Test Loss: 0.3870022
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 5.3471808433532715
Epoch: 66, Steps: 61 | Train Loss: 0.3386977 Vali Loss: 0.7075948 Test Loss: 0.3870127
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 4.437098741531372
Epoch: 67, Steps: 61 | Train Loss: 0.3392890 Vali Loss: 0.7052332 Test Loss: 0.3870674
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 4.92026424407959
Epoch: 68, Steps: 61 | Train Loss: 0.3392229 Vali Loss: 0.7053765 Test Loss: 0.3870128
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 4.882176160812378
Epoch: 69, Steps: 61 | Train Loss: 0.3391924 Vali Loss: 0.7040734 Test Loss: 0.3870167
Validation loss decreased (0.704648 --> 0.704073).  Saving model ...
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 4.1241841316223145
Epoch: 70, Steps: 61 | Train Loss: 0.3391929 Vali Loss: 0.7080854 Test Loss: 0.3870421
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 4.209571123123169
Epoch: 71, Steps: 61 | Train Loss: 0.3391541 Vali Loss: 0.7046660 Test Loss: 0.3870564
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 4.806791067123413
Epoch: 72, Steps: 61 | Train Loss: 0.3390676 Vali Loss: 0.7035853 Test Loss: 0.3870317
Validation loss decreased (0.704073 --> 0.703585).  Saving model ...
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 4.592962980270386
Epoch: 73, Steps: 61 | Train Loss: 0.3392045 Vali Loss: 0.7081051 Test Loss: 0.3870321
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 4.906104564666748
Epoch: 74, Steps: 61 | Train Loss: 0.3392656 Vali Loss: 0.7074078 Test Loss: 0.3870188
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 4.846984386444092
Epoch: 75, Steps: 61 | Train Loss: 0.3391052 Vali Loss: 0.7067887 Test Loss: 0.3870337
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 4.616110801696777
Epoch: 76, Steps: 61 | Train Loss: 0.3389785 Vali Loss: 0.7055790 Test Loss: 0.3870196
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 4.455866098403931
Epoch: 77, Steps: 61 | Train Loss: 0.3390141 Vali Loss: 0.7050366 Test Loss: 0.3870289
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 4.729044198989868
Epoch: 78, Steps: 61 | Train Loss: 0.3391866 Vali Loss: 0.7061445 Test Loss: 0.3870348
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 4.228837490081787
Epoch: 79, Steps: 61 | Train Loss: 0.3391390 Vali Loss: 0.7065057 Test Loss: 0.3870303
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 4.778838634490967
Epoch: 80, Steps: 61 | Train Loss: 0.3391664 Vali Loss: 0.7066537 Test Loss: 0.3870183
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 5.255795955657959
Epoch: 81, Steps: 61 | Train Loss: 0.3389251 Vali Loss: 0.7061611 Test Loss: 0.3870217
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 4.211275100708008
Epoch: 82, Steps: 61 | Train Loss: 0.3391348 Vali Loss: 0.7079586 Test Loss: 0.3870269
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 4.306726932525635
Epoch: 83, Steps: 61 | Train Loss: 0.3390003 Vali Loss: 0.7070523 Test Loss: 0.3870245
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 4.622770309448242
Epoch: 84, Steps: 61 | Train Loss: 0.3392111 Vali Loss: 0.7069459 Test Loss: 0.3870419
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 5.190498352050781
Epoch: 85, Steps: 61 | Train Loss: 0.3390658 Vali Loss: 0.7060670 Test Loss: 0.3870313
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 4.419233083724976
Epoch: 86, Steps: 61 | Train Loss: 0.3390441 Vali Loss: 0.7055925 Test Loss: 0.3870316
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.389640937399644e-06
Epoch: 87 cost time: 4.447488069534302
Epoch: 87, Steps: 61 | Train Loss: 0.3390723 Vali Loss: 0.7075928 Test Loss: 0.3870443
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.070158890529662e-06
Epoch: 88 cost time: 4.826465129852295
Epoch: 88, Steps: 61 | Train Loss: 0.3392161 Vali Loss: 0.7063774 Test Loss: 0.3870278
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.766650946003179e-06
Epoch: 89 cost time: 4.614476919174194
Epoch: 89, Steps: 61 | Train Loss: 0.3390877 Vali Loss: 0.7098868 Test Loss: 0.3870277
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.47831839870302e-06
Epoch: 90 cost time: 4.921945095062256
Epoch: 90, Steps: 61 | Train Loss: 0.3389747 Vali Loss: 0.7071946 Test Loss: 0.3870214
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.204402478767869e-06
Epoch: 91 cost time: 4.896195650100708
Epoch: 91, Steps: 61 | Train Loss: 0.3392389 Vali Loss: 0.7032012 Test Loss: 0.3870294
Validation loss decreased (0.703585 --> 0.703201).  Saving model ...
Updating learning rate to 4.944182354829475e-06
Epoch: 92 cost time: 4.064777612686157
Epoch: 92, Steps: 61 | Train Loss: 0.3390497 Vali Loss: 0.7097940 Test Loss: 0.3870181
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.696973237088e-06
Epoch: 93 cost time: 4.303856372833252
Epoch: 93, Steps: 61 | Train Loss: 0.3390491 Vali Loss: 0.7053284 Test Loss: 0.3870279
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.462124575233601e-06
Epoch: 94 cost time: 4.250966548919678
Epoch: 94, Steps: 61 | Train Loss: 0.3389986 Vali Loss: 0.7042652 Test Loss: 0.3870341
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.239018346471921e-06
Epoch: 95 cost time: 4.698953628540039
Epoch: 95, Steps: 61 | Train Loss: 0.3389912 Vali Loss: 0.7047310 Test Loss: 0.3870308
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.027067429148324e-06
Epoch: 96 cost time: 4.582907199859619
Epoch: 96, Steps: 61 | Train Loss: 0.3387197 Vali Loss: 0.7034076 Test Loss: 0.3870226
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.825714057690908e-06
Epoch: 97 cost time: 4.541115045547485
Epoch: 97, Steps: 61 | Train Loss: 0.3387507 Vali Loss: 0.7071459 Test Loss: 0.3870250
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.6344283548063623e-06
Epoch: 98 cost time: 4.446474075317383
Epoch: 98, Steps: 61 | Train Loss: 0.3390006 Vali Loss: 0.7039250 Test Loss: 0.3870277
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.452706937066044e-06
Epoch: 99 cost time: 4.777878522872925
Epoch: 99, Steps: 61 | Train Loss: 0.3388702 Vali Loss: 0.7064992 Test Loss: 0.3870309
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.2800715902127414e-06
Epoch: 100 cost time: 4.394554376602173
Epoch: 100, Steps: 61 | Train Loss: 0.3389299 Vali Loss: 0.7075797 Test Loss: 0.3870260
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.1160680107021042e-06
>>>>>>>testing : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H3_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38665997982025146, mae:0.407950222492218, rse:0.5906394720077515, corr:[0.26954603 0.276562   0.2780222  0.27513584 0.2716773  0.26937646
 0.2683818  0.26844645 0.26870167 0.2687706  0.26862082 0.26831105
 0.2681168  0.26813158 0.26829416 0.26843253 0.26831585 0.26802367
 0.26758254 0.26715514 0.26694673 0.2670813  0.26710454 0.26707143
 0.26691434 0.26675135 0.26658756 0.26623783 0.2656827  0.26506594
 0.2646335  0.2643384  0.26424658 0.2642897  0.2642345  0.26412222
 0.26407287 0.2641215  0.26425877 0.2644634  0.26484248 0.26512256
 0.26510212 0.2649101  0.26476097 0.2647847  0.2649956  0.2651506
 0.26467606 0.2637955  0.26252154 0.26121596 0.26012036 0.25915152
 0.25845212 0.25805363 0.25777602 0.25762385 0.25737125 0.2571317
 0.25691074 0.2567915  0.2567039  0.25672007 0.25678632 0.25685164
 0.25701943 0.25710693 0.2571127  0.25702155 0.2567325  0.25604662
 0.25518465 0.2543784  0.25364396 0.25312912 0.25257427 0.25179026
 0.25086436 0.25001314 0.24935459 0.24897563 0.24862133 0.24810506
 0.24759524 0.24715452 0.24697249 0.24690686 0.24678527 0.24621218
 0.24490513 0.24324138 0.24214323 0.2426852  0.24496412 0.24519448]
