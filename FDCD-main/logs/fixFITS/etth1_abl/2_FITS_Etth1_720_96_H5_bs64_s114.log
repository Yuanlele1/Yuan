Args in experiment:
Namespace(H_order=5, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=165, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H5_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=165, out_features=187, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  27646080.0
params:  31042.0
Trainable parameters:  31042
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.802088737487793
Epoch: 1, Steps: 61 | Train Loss: 0.5983880 Vali Loss: 1.3500168 Test Loss: 0.7468351
Validation loss decreased (inf --> 1.350017).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.6884701251983643
Epoch: 2, Steps: 61 | Train Loss: 0.4692130 Vali Loss: 1.2317387 Test Loss: 0.6984767
Validation loss decreased (1.350017 --> 1.231739).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.5762677192687988
Epoch: 3, Steps: 61 | Train Loss: 0.4060148 Vali Loss: 1.1935625 Test Loss: 0.6853831
Validation loss decreased (1.231739 --> 1.193563).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.6480133533477783
Epoch: 4, Steps: 61 | Train Loss: 0.3677587 Vali Loss: 1.1713991 Test Loss: 0.6774889
Validation loss decreased (1.193563 --> 1.171399).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.6113028526306152
Epoch: 5, Steps: 61 | Train Loss: 0.3395220 Vali Loss: 1.1574404 Test Loss: 0.6737710
Validation loss decreased (1.171399 --> 1.157440).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.4509477615356445
Epoch: 6, Steps: 61 | Train Loss: 0.3169202 Vali Loss: 1.1330647 Test Loss: 0.6618670
Validation loss decreased (1.157440 --> 1.133065).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.4381215572357178
Epoch: 7, Steps: 61 | Train Loss: 0.2979201 Vali Loss: 1.1162878 Test Loss: 0.6547918
Validation loss decreased (1.133065 --> 1.116288).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.2827808856964111
Epoch: 8, Steps: 61 | Train Loss: 0.2813107 Vali Loss: 1.0963378 Test Loss: 0.6434877
Validation loss decreased (1.116288 --> 1.096338).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.6306636333465576
Epoch: 9, Steps: 61 | Train Loss: 0.2668176 Vali Loss: 1.0813286 Test Loss: 0.6347568
Validation loss decreased (1.096338 --> 1.081329).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.4938242435455322
Epoch: 10, Steps: 61 | Train Loss: 0.2538603 Vali Loss: 1.0640347 Test Loss: 0.6264979
Validation loss decreased (1.081329 --> 1.064035).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.5931508541107178
Epoch: 11, Steps: 61 | Train Loss: 0.2423913 Vali Loss: 1.0485573 Test Loss: 0.6154680
Validation loss decreased (1.064035 --> 1.048557).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.5515620708465576
Epoch: 12, Steps: 61 | Train Loss: 0.2321480 Vali Loss: 1.0315580 Test Loss: 0.6059108
Validation loss decreased (1.048557 --> 1.031558).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.5451750755310059
Epoch: 13, Steps: 61 | Train Loss: 0.2226594 Vali Loss: 1.0174198 Test Loss: 0.5970447
Validation loss decreased (1.031558 --> 1.017420).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.7391648292541504
Epoch: 14, Steps: 61 | Train Loss: 0.2142845 Vali Loss: 1.0005988 Test Loss: 0.5864896
Validation loss decreased (1.017420 --> 1.000599).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.6264674663543701
Epoch: 15, Steps: 61 | Train Loss: 0.2066189 Vali Loss: 0.9892694 Test Loss: 0.5781398
Validation loss decreased (1.000599 --> 0.989269).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.4620463848114014
Epoch: 16, Steps: 61 | Train Loss: 0.1995289 Vali Loss: 0.9779493 Test Loss: 0.5712675
Validation loss decreased (0.989269 --> 0.977949).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.621802568435669
Epoch: 17, Steps: 61 | Train Loss: 0.1931523 Vali Loss: 0.9662877 Test Loss: 0.5625588
Validation loss decreased (0.977949 --> 0.966288).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.6502723693847656
Epoch: 18, Steps: 61 | Train Loss: 0.1872637 Vali Loss: 0.9559886 Test Loss: 0.5570999
Validation loss decreased (0.966288 --> 0.955989).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.5180742740631104
Epoch: 19, Steps: 61 | Train Loss: 0.1817945 Vali Loss: 0.9467747 Test Loss: 0.5502095
Validation loss decreased (0.955989 --> 0.946775).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.67362642288208
Epoch: 20, Steps: 61 | Train Loss: 0.1768862 Vali Loss: 0.9367561 Test Loss: 0.5439807
Validation loss decreased (0.946775 --> 0.936756).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.7221214771270752
Epoch: 21, Steps: 61 | Train Loss: 0.1723035 Vali Loss: 0.9327853 Test Loss: 0.5385084
Validation loss decreased (0.936756 --> 0.932785).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.6100592613220215
Epoch: 22, Steps: 61 | Train Loss: 0.1680629 Vali Loss: 0.9240215 Test Loss: 0.5333878
Validation loss decreased (0.932785 --> 0.924021).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 1.6301202774047852
Epoch: 23, Steps: 61 | Train Loss: 0.1641544 Vali Loss: 0.9165374 Test Loss: 0.5288898
Validation loss decreased (0.924021 --> 0.916537).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.4943740367889404
Epoch: 24, Steps: 61 | Train Loss: 0.1605003 Vali Loss: 0.9084802 Test Loss: 0.5239419
Validation loss decreased (0.916537 --> 0.908480).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.6515014171600342
Epoch: 25, Steps: 61 | Train Loss: 0.1571331 Vali Loss: 0.8998850 Test Loss: 0.5191826
Validation loss decreased (0.908480 --> 0.899885).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 1.757491111755371
Epoch: 26, Steps: 61 | Train Loss: 0.1540477 Vali Loss: 0.8958783 Test Loss: 0.5152616
Validation loss decreased (0.899885 --> 0.895878).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.4924607276916504
Epoch: 27, Steps: 61 | Train Loss: 0.1511249 Vali Loss: 0.8919579 Test Loss: 0.5112761
Validation loss decreased (0.895878 --> 0.891958).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 1.8670737743377686
Epoch: 28, Steps: 61 | Train Loss: 0.1483658 Vali Loss: 0.8843735 Test Loss: 0.5073763
Validation loss decreased (0.891958 --> 0.884374).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.6691973209381104
Epoch: 29, Steps: 61 | Train Loss: 0.1459123 Vali Loss: 0.8803997 Test Loss: 0.5043620
Validation loss decreased (0.884374 --> 0.880400).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.5069961547851562
Epoch: 30, Steps: 61 | Train Loss: 0.1435296 Vali Loss: 0.8784289 Test Loss: 0.5014124
Validation loss decreased (0.880400 --> 0.878429).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 1.7127175331115723
Epoch: 31, Steps: 61 | Train Loss: 0.1413251 Vali Loss: 0.8709051 Test Loss: 0.4981470
Validation loss decreased (0.878429 --> 0.870905).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.5692389011383057
Epoch: 32, Steps: 61 | Train Loss: 0.1392714 Vali Loss: 0.8689341 Test Loss: 0.4955252
Validation loss decreased (0.870905 --> 0.868934).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.5209455490112305
Epoch: 33, Steps: 61 | Train Loss: 0.1373412 Vali Loss: 0.8644628 Test Loss: 0.4932408
Validation loss decreased (0.868934 --> 0.864463).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.6392436027526855
Epoch: 34, Steps: 61 | Train Loss: 0.1355097 Vali Loss: 0.8561412 Test Loss: 0.4901371
Validation loss decreased (0.864463 --> 0.856141).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.7113373279571533
Epoch: 35, Steps: 61 | Train Loss: 0.1338322 Vali Loss: 0.8567392 Test Loss: 0.4882850
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.6153414249420166
Epoch: 36, Steps: 61 | Train Loss: 0.1322663 Vali Loss: 0.8533953 Test Loss: 0.4863719
Validation loss decreased (0.856141 --> 0.853395).  Saving model ...
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.7255287170410156
Epoch: 37, Steps: 61 | Train Loss: 0.1307102 Vali Loss: 0.8537564 Test Loss: 0.4843755
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.6341466903686523
Epoch: 38, Steps: 61 | Train Loss: 0.1293044 Vali Loss: 0.8480578 Test Loss: 0.4820489
Validation loss decreased (0.853395 --> 0.848058).  Saving model ...
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.4552254676818848
Epoch: 39, Steps: 61 | Train Loss: 0.1279728 Vali Loss: 0.8452713 Test Loss: 0.4802694
Validation loss decreased (0.848058 --> 0.845271).  Saving model ...
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.4486157894134521
Epoch: 40, Steps: 61 | Train Loss: 0.1266847 Vali Loss: 0.8452920 Test Loss: 0.4784598
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 1.582165002822876
Epoch: 41, Steps: 61 | Train Loss: 0.1255983 Vali Loss: 0.8422411 Test Loss: 0.4767190
Validation loss decreased (0.845271 --> 0.842241).  Saving model ...
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.614816665649414
Epoch: 42, Steps: 61 | Train Loss: 0.1244828 Vali Loss: 0.8371882 Test Loss: 0.4750628
Validation loss decreased (0.842241 --> 0.837188).  Saving model ...
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.56502366065979
Epoch: 43, Steps: 61 | Train Loss: 0.1234251 Vali Loss: 0.8330404 Test Loss: 0.4739187
Validation loss decreased (0.837188 --> 0.833040).  Saving model ...
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.5093753337860107
Epoch: 44, Steps: 61 | Train Loss: 0.1224411 Vali Loss: 0.8328595 Test Loss: 0.4719855
Validation loss decreased (0.833040 --> 0.832860).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.4680166244506836
Epoch: 45, Steps: 61 | Train Loss: 0.1215387 Vali Loss: 0.8321849 Test Loss: 0.4711571
Validation loss decreased (0.832860 --> 0.832185).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.5457069873809814
Epoch: 46, Steps: 61 | Train Loss: 0.1206305 Vali Loss: 0.8244367 Test Loss: 0.4696625
Validation loss decreased (0.832185 --> 0.824437).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.351459264755249
Epoch: 47, Steps: 61 | Train Loss: 0.1197792 Vali Loss: 0.8302878 Test Loss: 0.4686533
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.3638660907745361
Epoch: 48, Steps: 61 | Train Loss: 0.1190315 Vali Loss: 0.8259251 Test Loss: 0.4676332
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.4399333000183105
Epoch: 49, Steps: 61 | Train Loss: 0.1182679 Vali Loss: 0.8246848 Test Loss: 0.4667397
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.44331955909729
Epoch: 50, Steps: 61 | Train Loss: 0.1175468 Vali Loss: 0.8262241 Test Loss: 0.4655996
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.4541425704956055
Epoch: 51, Steps: 61 | Train Loss: 0.1169018 Vali Loss: 0.8227945 Test Loss: 0.4645719
Validation loss decreased (0.824437 --> 0.822794).  Saving model ...
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.4891350269317627
Epoch: 52, Steps: 61 | Train Loss: 0.1162734 Vali Loss: 0.8227379 Test Loss: 0.4636328
Validation loss decreased (0.822794 --> 0.822738).  Saving model ...
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.7365996837615967
Epoch: 53, Steps: 61 | Train Loss: 0.1156591 Vali Loss: 0.8202416 Test Loss: 0.4628227
Validation loss decreased (0.822738 --> 0.820242).  Saving model ...
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.5138423442840576
Epoch: 54, Steps: 61 | Train Loss: 0.1150810 Vali Loss: 0.8205042 Test Loss: 0.4620351
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 1.5188024044036865
Epoch: 55, Steps: 61 | Train Loss: 0.1145863 Vali Loss: 0.8188584 Test Loss: 0.4611724
Validation loss decreased (0.820242 --> 0.818858).  Saving model ...
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 1.6168992519378662
Epoch: 56, Steps: 61 | Train Loss: 0.1139955 Vali Loss: 0.8168684 Test Loss: 0.4605773
Validation loss decreased (0.818858 --> 0.816868).  Saving model ...
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 1.5172076225280762
Epoch: 57, Steps: 61 | Train Loss: 0.1135739 Vali Loss: 0.8169438 Test Loss: 0.4599254
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 1.4512085914611816
Epoch: 58, Steps: 61 | Train Loss: 0.1130682 Vali Loss: 0.8150208 Test Loss: 0.4592204
Validation loss decreased (0.816868 --> 0.815021).  Saving model ...
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.980872392654419
Epoch: 59, Steps: 61 | Train Loss: 0.1126455 Vali Loss: 0.8112338 Test Loss: 0.4586594
Validation loss decreased (0.815021 --> 0.811234).  Saving model ...
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.3840093612670898
Epoch: 60, Steps: 61 | Train Loss: 0.1122559 Vali Loss: 0.8116456 Test Loss: 0.4579827
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.3856093883514404
Epoch: 61, Steps: 61 | Train Loss: 0.1118730 Vali Loss: 0.8095630 Test Loss: 0.4574785
Validation loss decreased (0.811234 --> 0.809563).  Saving model ...
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.2998337745666504
Epoch: 62, Steps: 61 | Train Loss: 0.1114782 Vali Loss: 0.8104725 Test Loss: 0.4570695
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.4514784812927246
Epoch: 63, Steps: 61 | Train Loss: 0.1111559 Vali Loss: 0.8059646 Test Loss: 0.4564679
Validation loss decreased (0.809563 --> 0.805965).  Saving model ...
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 1.5443215370178223
Epoch: 64, Steps: 61 | Train Loss: 0.1107985 Vali Loss: 0.8104064 Test Loss: 0.4560603
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 1.716759204864502
Epoch: 65, Steps: 61 | Train Loss: 0.1104634 Vali Loss: 0.8100282 Test Loss: 0.4555769
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.5189170837402344
Epoch: 66, Steps: 61 | Train Loss: 0.1101584 Vali Loss: 0.8096572 Test Loss: 0.4550711
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 1.5860013961791992
Epoch: 67, Steps: 61 | Train Loss: 0.1098776 Vali Loss: 0.8070231 Test Loss: 0.4546780
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.5047552585601807
Epoch: 68, Steps: 61 | Train Loss: 0.1095953 Vali Loss: 0.8071638 Test Loss: 0.4543596
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 1.285266637802124
Epoch: 69, Steps: 61 | Train Loss: 0.1093079 Vali Loss: 0.8053517 Test Loss: 0.4539525
Validation loss decreased (0.805965 --> 0.805352).  Saving model ...
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 1.381828784942627
Epoch: 70, Steps: 61 | Train Loss: 0.1090826 Vali Loss: 0.8063275 Test Loss: 0.4535997
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 1.6324946880340576
Epoch: 71, Steps: 61 | Train Loss: 0.1088825 Vali Loss: 0.8048947 Test Loss: 0.4532393
Validation loss decreased (0.805352 --> 0.804895).  Saving model ...
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 1.3358738422393799
Epoch: 72, Steps: 61 | Train Loss: 0.1086390 Vali Loss: 0.8075921 Test Loss: 0.4529146
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 1.6499557495117188
Epoch: 73, Steps: 61 | Train Loss: 0.1084283 Vali Loss: 0.8041363 Test Loss: 0.4525965
Validation loss decreased (0.804895 --> 0.804136).  Saving model ...
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 1.4349687099456787
Epoch: 74, Steps: 61 | Train Loss: 0.1082116 Vali Loss: 0.8031873 Test Loss: 0.4522946
Validation loss decreased (0.804136 --> 0.803187).  Saving model ...
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 1.70477294921875
Epoch: 75, Steps: 61 | Train Loss: 0.1080180 Vali Loss: 0.8062357 Test Loss: 0.4520209
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 1.551534652709961
Epoch: 76, Steps: 61 | Train Loss: 0.1078186 Vali Loss: 0.8039641 Test Loss: 0.4518326
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 1.427506446838379
Epoch: 77, Steps: 61 | Train Loss: 0.1076836 Vali Loss: 0.8021137 Test Loss: 0.4515864
Validation loss decreased (0.803187 --> 0.802114).  Saving model ...
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 1.7494559288024902
Epoch: 78, Steps: 61 | Train Loss: 0.1075247 Vali Loss: 0.8018403 Test Loss: 0.4513011
Validation loss decreased (0.802114 --> 0.801840).  Saving model ...
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 1.6201894283294678
Epoch: 79, Steps: 61 | Train Loss: 0.1073066 Vali Loss: 0.8033456 Test Loss: 0.4511430
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 1.4213507175445557
Epoch: 80, Steps: 61 | Train Loss: 0.1072028 Vali Loss: 0.8014899 Test Loss: 0.4509028
Validation loss decreased (0.801840 --> 0.801490).  Saving model ...
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 1.5867621898651123
Epoch: 81, Steps: 61 | Train Loss: 0.1070421 Vali Loss: 0.8004928 Test Loss: 0.4507464
Validation loss decreased (0.801490 --> 0.800493).  Saving model ...
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 1.5312552452087402
Epoch: 82, Steps: 61 | Train Loss: 0.1069371 Vali Loss: 0.7999123 Test Loss: 0.4505394
Validation loss decreased (0.800493 --> 0.799912).  Saving model ...
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 1.4206817150115967
Epoch: 83, Steps: 61 | Train Loss: 0.1067908 Vali Loss: 0.8015887 Test Loss: 0.4503734
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 1.4737286567687988
Epoch: 84, Steps: 61 | Train Loss: 0.1066641 Vali Loss: 0.8002791 Test Loss: 0.4501488
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 1.3555631637573242
Epoch: 85, Steps: 61 | Train Loss: 0.1065381 Vali Loss: 0.8006330 Test Loss: 0.4500006
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 1.4090309143066406
Epoch: 86, Steps: 61 | Train Loss: 0.1064370 Vali Loss: 0.7986870 Test Loss: 0.4498172
Validation loss decreased (0.799912 --> 0.798687).  Saving model ...
Updating learning rate to 6.389640937399644e-06
Epoch: 87 cost time: 1.1944267749786377
Epoch: 87, Steps: 61 | Train Loss: 0.1063235 Vali Loss: 0.8026614 Test Loss: 0.4497380
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.070158890529662e-06
Epoch: 88 cost time: 1.2282018661499023
Epoch: 88, Steps: 61 | Train Loss: 0.1062058 Vali Loss: 0.7983871 Test Loss: 0.4495261
Validation loss decreased (0.798687 --> 0.798387).  Saving model ...
Updating learning rate to 5.766650946003179e-06
Epoch: 89 cost time: 1.3277645111083984
Epoch: 89, Steps: 61 | Train Loss: 0.1061308 Vali Loss: 0.7973859 Test Loss: 0.4494199
Validation loss decreased (0.798387 --> 0.797386).  Saving model ...
Updating learning rate to 5.47831839870302e-06
Epoch: 90 cost time: 1.3579742908477783
Epoch: 90, Steps: 61 | Train Loss: 0.1060115 Vali Loss: 0.7991410 Test Loss: 0.4492722
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.204402478767869e-06
Epoch: 91 cost time: 1.376478910446167
Epoch: 91, Steps: 61 | Train Loss: 0.1059579 Vali Loss: 0.8003963 Test Loss: 0.4491427
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.944182354829475e-06
Epoch: 92 cost time: 1.3704428672790527
Epoch: 92, Steps: 61 | Train Loss: 0.1059040 Vali Loss: 0.8014519 Test Loss: 0.4490205
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.696973237088e-06
Epoch: 93 cost time: 1.4022462368011475
Epoch: 93, Steps: 61 | Train Loss: 0.1057448 Vali Loss: 0.7958694 Test Loss: 0.4489158
Validation loss decreased (0.797386 --> 0.795869).  Saving model ...
Updating learning rate to 4.462124575233601e-06
Epoch: 94 cost time: 1.3537864685058594
Epoch: 94, Steps: 61 | Train Loss: 0.1057234 Vali Loss: 0.7960845 Test Loss: 0.4488124
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.239018346471921e-06
Epoch: 95 cost time: 1.4578900337219238
Epoch: 95, Steps: 61 | Train Loss: 0.1055960 Vali Loss: 0.7939680 Test Loss: 0.4487065
Validation loss decreased (0.795869 --> 0.793968).  Saving model ...
Updating learning rate to 4.027067429148324e-06
Epoch: 96 cost time: 1.4468615055084229
Epoch: 96, Steps: 61 | Train Loss: 0.1055991 Vali Loss: 0.7990019 Test Loss: 0.4486228
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.825714057690908e-06
Epoch: 97 cost time: 1.5206401348114014
Epoch: 97, Steps: 61 | Train Loss: 0.1055033 Vali Loss: 0.7952066 Test Loss: 0.4485377
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.6344283548063623e-06
Epoch: 98 cost time: 1.391448736190796
Epoch: 98, Steps: 61 | Train Loss: 0.1054514 Vali Loss: 0.7992110 Test Loss: 0.4484369
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.452706937066044e-06
Epoch: 99 cost time: 1.614509105682373
Epoch: 99, Steps: 61 | Train Loss: 0.1054224 Vali Loss: 0.8000915 Test Loss: 0.4483893
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.2800715902127414e-06
Epoch: 100 cost time: 1.5173277854919434
Epoch: 100, Steps: 61 | Train Loss: 0.1053224 Vali Loss: 0.7995203 Test Loss: 0.4483053
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.1160680107021042e-06
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=165, out_features=187, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  27646080.0
params:  31042.0
Trainable parameters:  31042
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.335132122039795
Epoch: 1, Steps: 61 | Train Loss: 0.3551244 Vali Loss: 0.7054552 Test Loss: 0.3842458
Validation loss decreased (inf --> 0.705455).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.462247610092163
Epoch: 2, Steps: 61 | Train Loss: 0.3384599 Vali Loss: 0.7020038 Test Loss: 0.3829369
Validation loss decreased (0.705455 --> 0.702004).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.515836477279663
Epoch: 3, Steps: 61 | Train Loss: 0.3359499 Vali Loss: 0.7003289 Test Loss: 0.3820409
Validation loss decreased (0.702004 --> 0.700329).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.6562175750732422
Epoch: 4, Steps: 61 | Train Loss: 0.3349962 Vali Loss: 0.6951846 Test Loss: 0.3830057
Validation loss decreased (0.700329 --> 0.695185).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.4102590084075928
Epoch: 5, Steps: 61 | Train Loss: 0.3342646 Vali Loss: 0.6955392 Test Loss: 0.3824615
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.3654532432556152
Epoch: 6, Steps: 61 | Train Loss: 0.3335979 Vali Loss: 0.6963843 Test Loss: 0.3818910
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.430419683456421
Epoch: 7, Steps: 61 | Train Loss: 0.3331185 Vali Loss: 0.6985739 Test Loss: 0.3823691
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 0.9195904731750488
Epoch: 8, Steps: 61 | Train Loss: 0.3327521 Vali Loss: 0.7016752 Test Loss: 0.3822784
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.160825490951538
Epoch: 9, Steps: 61 | Train Loss: 0.3325850 Vali Loss: 0.6946615 Test Loss: 0.3823463
Validation loss decreased (0.695185 --> 0.694661).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.001023292541504
Epoch: 10, Steps: 61 | Train Loss: 0.3323541 Vali Loss: 0.6991226 Test Loss: 0.3824421
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.0825080871582031
Epoch: 11, Steps: 61 | Train Loss: 0.3320249 Vali Loss: 0.6938237 Test Loss: 0.3822604
Validation loss decreased (0.694661 --> 0.693824).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.0630192756652832
Epoch: 12, Steps: 61 | Train Loss: 0.3319577 Vali Loss: 0.6981093 Test Loss: 0.3823294
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.0417540073394775
Epoch: 13, Steps: 61 | Train Loss: 0.3319012 Vali Loss: 0.6936967 Test Loss: 0.3820876
Validation loss decreased (0.693824 --> 0.693697).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.2103188037872314
Epoch: 14, Steps: 61 | Train Loss: 0.3315869 Vali Loss: 0.6985798 Test Loss: 0.3820423
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.2571008205413818
Epoch: 15, Steps: 61 | Train Loss: 0.3314722 Vali Loss: 0.6965702 Test Loss: 0.3825421
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.3780293464660645
Epoch: 16, Steps: 61 | Train Loss: 0.3315739 Vali Loss: 0.6917623 Test Loss: 0.3821251
Validation loss decreased (0.693697 --> 0.691762).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.1005456447601318
Epoch: 17, Steps: 61 | Train Loss: 0.3311968 Vali Loss: 0.6938559 Test Loss: 0.3821547
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 0.9558041095733643
Epoch: 18, Steps: 61 | Train Loss: 0.3312572 Vali Loss: 0.6959468 Test Loss: 0.3821227
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.0796899795532227
Epoch: 19, Steps: 61 | Train Loss: 0.3310932 Vali Loss: 0.6943377 Test Loss: 0.3817770
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.0102448463439941
Epoch: 20, Steps: 61 | Train Loss: 0.3310536 Vali Loss: 0.6953177 Test Loss: 0.3817685
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 0.8020944595336914
Epoch: 21, Steps: 61 | Train Loss: 0.3311157 Vali Loss: 0.6930227 Test Loss: 0.3817555
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.048607349395752
Epoch: 22, Steps: 61 | Train Loss: 0.3309387 Vali Loss: 0.6948520 Test Loss: 0.3819806
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 0.8203797340393066
Epoch: 23, Steps: 61 | Train Loss: 0.3309894 Vali Loss: 0.6958508 Test Loss: 0.3817501
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 0.6484329700469971
Epoch: 24, Steps: 61 | Train Loss: 0.3307768 Vali Loss: 0.6919152 Test Loss: 0.3818748
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 0.6208126544952393
Epoch: 25, Steps: 61 | Train Loss: 0.3308341 Vali Loss: 0.6942226 Test Loss: 0.3820814
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 0.8957247734069824
Epoch: 26, Steps: 61 | Train Loss: 0.3307792 Vali Loss: 0.6920221 Test Loss: 0.3815390
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.3729755878448486
Epoch: 27, Steps: 61 | Train Loss: 0.3306302 Vali Loss: 0.6928031 Test Loss: 0.3818256
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 0.8338785171508789
Epoch: 28, Steps: 61 | Train Loss: 0.3303900 Vali Loss: 0.6915809 Test Loss: 0.3817154
Validation loss decreased (0.691762 --> 0.691581).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 0.8920562267303467
Epoch: 29, Steps: 61 | Train Loss: 0.3306697 Vali Loss: 0.6910343 Test Loss: 0.3817413
Validation loss decreased (0.691581 --> 0.691034).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 0.8897767066955566
Epoch: 30, Steps: 61 | Train Loss: 0.3303665 Vali Loss: 0.6944566 Test Loss: 0.3818810
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 0.7710893154144287
Epoch: 31, Steps: 61 | Train Loss: 0.3305517 Vali Loss: 0.6955304 Test Loss: 0.3818132
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 0.8766889572143555
Epoch: 32, Steps: 61 | Train Loss: 0.3304178 Vali Loss: 0.6935617 Test Loss: 0.3819078
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 0.8203146457672119
Epoch: 33, Steps: 61 | Train Loss: 0.3304011 Vali Loss: 0.6961564 Test Loss: 0.3817668
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 0.8134264945983887
Epoch: 34, Steps: 61 | Train Loss: 0.3304305 Vali Loss: 0.6947184 Test Loss: 0.3819389
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 0.7917976379394531
Epoch: 35, Steps: 61 | Train Loss: 0.3302562 Vali Loss: 0.6932201 Test Loss: 0.3818443
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 0.8982772827148438
Epoch: 36, Steps: 61 | Train Loss: 0.3300939 Vali Loss: 0.6947219 Test Loss: 0.3817854
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 0.831526517868042
Epoch: 37, Steps: 61 | Train Loss: 0.3303233 Vali Loss: 0.6934813 Test Loss: 0.3817681
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 0.8814687728881836
Epoch: 38, Steps: 61 | Train Loss: 0.3302215 Vali Loss: 0.6962965 Test Loss: 0.3818752
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 0.9412777423858643
Epoch: 39, Steps: 61 | Train Loss: 0.3302723 Vali Loss: 0.6980969 Test Loss: 0.3817996
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 0.9529750347137451
Epoch: 40, Steps: 61 | Train Loss: 0.3301409 Vali Loss: 0.6933774 Test Loss: 0.3817066
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 0.8447575569152832
Epoch: 41, Steps: 61 | Train Loss: 0.3301795 Vali Loss: 0.6942587 Test Loss: 0.3817103
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 0.98899245262146
Epoch: 42, Steps: 61 | Train Loss: 0.3299328 Vali Loss: 0.6985074 Test Loss: 0.3817840
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 0.840545654296875
Epoch: 43, Steps: 61 | Train Loss: 0.3297785 Vali Loss: 0.6940305 Test Loss: 0.3817456
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.0644588470458984
Epoch: 44, Steps: 61 | Train Loss: 0.3300932 Vali Loss: 0.6908460 Test Loss: 0.3817514
Validation loss decreased (0.691034 --> 0.690846).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 0.8292460441589355
Epoch: 45, Steps: 61 | Train Loss: 0.3301664 Vali Loss: 0.6971246 Test Loss: 0.3816902
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 0.8201229572296143
Epoch: 46, Steps: 61 | Train Loss: 0.3301213 Vali Loss: 0.6971520 Test Loss: 0.3817602
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 0.9166684150695801
Epoch: 47, Steps: 61 | Train Loss: 0.3299291 Vali Loss: 0.6935765 Test Loss: 0.3817482
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 0.9234914779663086
Epoch: 48, Steps: 61 | Train Loss: 0.3300191 Vali Loss: 0.6935163 Test Loss: 0.3817721
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.117013931274414
Epoch: 49, Steps: 61 | Train Loss: 0.3300215 Vali Loss: 0.6932263 Test Loss: 0.3816440
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 0.9976799488067627
Epoch: 50, Steps: 61 | Train Loss: 0.3300161 Vali Loss: 0.6941212 Test Loss: 0.3817740
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 0.7809939384460449
Epoch: 51, Steps: 61 | Train Loss: 0.3299347 Vali Loss: 0.6911424 Test Loss: 0.3817344
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 0.9249310493469238
Epoch: 52, Steps: 61 | Train Loss: 0.3300785 Vali Loss: 0.6948417 Test Loss: 0.3817716
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.110926628112793
Epoch: 53, Steps: 61 | Train Loss: 0.3299108 Vali Loss: 0.6958888 Test Loss: 0.3817756
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 0.9876327514648438
Epoch: 54, Steps: 61 | Train Loss: 0.3298853 Vali Loss: 0.6950188 Test Loss: 0.3817414
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 0.9040014743804932
Epoch: 55, Steps: 61 | Train Loss: 0.3299420 Vali Loss: 0.6929178 Test Loss: 0.3817370
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 1.0176122188568115
Epoch: 56, Steps: 61 | Train Loss: 0.3300413 Vali Loss: 0.6896482 Test Loss: 0.3817613
Validation loss decreased (0.690846 --> 0.689648).  Saving model ...
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 0.8406929969787598
Epoch: 57, Steps: 61 | Train Loss: 0.3298645 Vali Loss: 0.6911044 Test Loss: 0.3817609
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 0.9170703887939453
Epoch: 58, Steps: 61 | Train Loss: 0.3295287 Vali Loss: 0.6945620 Test Loss: 0.3817482
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.0184333324432373
Epoch: 59, Steps: 61 | Train Loss: 0.3299178 Vali Loss: 0.6962409 Test Loss: 0.3817953
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 0.9009079933166504
Epoch: 60, Steps: 61 | Train Loss: 0.3298812 Vali Loss: 0.6943847 Test Loss: 0.3816805
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 0.8893795013427734
Epoch: 61, Steps: 61 | Train Loss: 0.3296870 Vali Loss: 0.6922075 Test Loss: 0.3817484
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.0050346851348877
Epoch: 62, Steps: 61 | Train Loss: 0.3297286 Vali Loss: 0.6971583 Test Loss: 0.3817306
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 0.8092525005340576
Epoch: 63, Steps: 61 | Train Loss: 0.3297727 Vali Loss: 0.6924577 Test Loss: 0.3817433
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 0.8125014305114746
Epoch: 64, Steps: 61 | Train Loss: 0.3299930 Vali Loss: 0.6949599 Test Loss: 0.3817273
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 0.857905387878418
Epoch: 65, Steps: 61 | Train Loss: 0.3297987 Vali Loss: 0.6932744 Test Loss: 0.3817191
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 0.9959738254547119
Epoch: 66, Steps: 61 | Train Loss: 0.3295245 Vali Loss: 0.6921625 Test Loss: 0.3817467
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 1.0492806434631348
Epoch: 67, Steps: 61 | Train Loss: 0.3297340 Vali Loss: 0.6943073 Test Loss: 0.3817336
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 0.9420506954193115
Epoch: 68, Steps: 61 | Train Loss: 0.3295706 Vali Loss: 0.6953854 Test Loss: 0.3817521
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 0.8642697334289551
Epoch: 69, Steps: 61 | Train Loss: 0.3298068 Vali Loss: 0.6962261 Test Loss: 0.3817276
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 0.7745115756988525
Epoch: 70, Steps: 61 | Train Loss: 0.3298578 Vali Loss: 0.6947455 Test Loss: 0.3817414
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 0.725353479385376
Epoch: 71, Steps: 61 | Train Loss: 0.3297905 Vali Loss: 0.6959603 Test Loss: 0.3817342
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 0.7949731349945068
Epoch: 72, Steps: 61 | Train Loss: 0.3297200 Vali Loss: 0.6951475 Test Loss: 0.3817395
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 0.7490229606628418
Epoch: 73, Steps: 61 | Train Loss: 0.3299316 Vali Loss: 0.6936273 Test Loss: 0.3817288
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 0.8408329486846924
Epoch: 74, Steps: 61 | Train Loss: 0.3298895 Vali Loss: 0.6935619 Test Loss: 0.3817478
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 0.7827458381652832
Epoch: 75, Steps: 61 | Train Loss: 0.3296888 Vali Loss: 0.6925326 Test Loss: 0.3817257
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 0.7156484127044678
Epoch: 76, Steps: 61 | Train Loss: 0.3299208 Vali Loss: 0.6892503 Test Loss: 0.3817439
Validation loss decreased (0.689648 --> 0.689250).  Saving model ...
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 0.7491984367370605
Epoch: 77, Steps: 61 | Train Loss: 0.3298544 Vali Loss: 0.6927491 Test Loss: 0.3817572
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 0.7846269607543945
Epoch: 78, Steps: 61 | Train Loss: 0.3295479 Vali Loss: 0.6965193 Test Loss: 0.3817532
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 0.7986242771148682
Epoch: 79, Steps: 61 | Train Loss: 0.3296303 Vali Loss: 0.6938320 Test Loss: 0.3817446
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 0.8426876068115234
Epoch: 80, Steps: 61 | Train Loss: 0.3297044 Vali Loss: 0.6942168 Test Loss: 0.3817531
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 0.8996982574462891
Epoch: 81, Steps: 61 | Train Loss: 0.3296490 Vali Loss: 0.6894656 Test Loss: 0.3817409
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 0.7986485958099365
Epoch: 82, Steps: 61 | Train Loss: 0.3297629 Vali Loss: 0.6957883 Test Loss: 0.3817643
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 1.0801112651824951
Epoch: 83, Steps: 61 | Train Loss: 0.3296030 Vali Loss: 0.6932019 Test Loss: 0.3817524
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 0.7157862186431885
Epoch: 84, Steps: 61 | Train Loss: 0.3296682 Vali Loss: 0.6941670 Test Loss: 0.3817577
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 0.9283590316772461
Epoch: 85, Steps: 61 | Train Loss: 0.3296742 Vali Loss: 0.6923586 Test Loss: 0.3817602
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 0.8459699153900146
Epoch: 86, Steps: 61 | Train Loss: 0.3296708 Vali Loss: 0.6935098 Test Loss: 0.3817633
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.389640937399644e-06
Epoch: 87 cost time: 0.7845606803894043
Epoch: 87, Steps: 61 | Train Loss: 0.3296669 Vali Loss: 0.6932716 Test Loss: 0.3817475
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.070158890529662e-06
Epoch: 88 cost time: 0.98600172996521
Epoch: 88, Steps: 61 | Train Loss: 0.3298280 Vali Loss: 0.6931748 Test Loss: 0.3817552
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.766650946003179e-06
Epoch: 89 cost time: 0.9683146476745605
Epoch: 89, Steps: 61 | Train Loss: 0.3292850 Vali Loss: 0.6945627 Test Loss: 0.3817540
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.47831839870302e-06
Epoch: 90 cost time: 1.0919771194458008
Epoch: 90, Steps: 61 | Train Loss: 0.3297179 Vali Loss: 0.6949202 Test Loss: 0.3817445
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.204402478767869e-06
Epoch: 91 cost time: 0.873384952545166
Epoch: 91, Steps: 61 | Train Loss: 0.3295896 Vali Loss: 0.6908561 Test Loss: 0.3817400
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.944182354829475e-06
Epoch: 92 cost time: 0.8904480934143066
Epoch: 92, Steps: 61 | Train Loss: 0.3297859 Vali Loss: 0.6940249 Test Loss: 0.3817428
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.696973237088e-06
Epoch: 93 cost time: 0.948796272277832
Epoch: 93, Steps: 61 | Train Loss: 0.3293755 Vali Loss: 0.6930586 Test Loss: 0.3817458
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.462124575233601e-06
Epoch: 94 cost time: 0.8162779808044434
Epoch: 94, Steps: 61 | Train Loss: 0.3297834 Vali Loss: 0.6913911 Test Loss: 0.3817529
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.239018346471921e-06
Epoch: 95 cost time: 0.8761842250823975
Epoch: 95, Steps: 61 | Train Loss: 0.3298104 Vali Loss: 0.6944880 Test Loss: 0.3817485
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.027067429148324e-06
Epoch: 96 cost time: 1.0434644222259521
Epoch: 96, Steps: 61 | Train Loss: 0.3296890 Vali Loss: 0.6945012 Test Loss: 0.3817414
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H5_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38133081793785095, mae:0.4038098454475403, rse:0.5865550637245178, corr:[0.26994288 0.2777831  0.27881944 0.2774993  0.27526674 0.2727782
 0.2709909  0.2703941  0.2703425  0.27048334 0.27044743 0.27027982
 0.27034852 0.27041936 0.27033752 0.27039105 0.27051324 0.27048647
 0.26994213 0.2691305  0.26870975 0.268779   0.26851043 0.26832706
 0.26834506 0.26840895 0.2682288  0.2678999  0.2676236  0.26729822
 0.266891   0.26639578 0.26620013 0.2663391  0.2663154  0.2661856
 0.26611945 0.2661788  0.26620895 0.2661197  0.26631552 0.266665
 0.26674664 0.2664918  0.26628083 0.26634783 0.26674652 0.2670726
 0.266622   0.26579696 0.26463604 0.26338506 0.2622156  0.26102114
 0.26015785 0.25964728 0.25925493 0.2591415  0.25893062 0.25884035
 0.25864258 0.25844437 0.2582366  0.2581144  0.25799307 0.25798306
 0.25831905 0.25840595 0.25806928 0.2577356  0.25773796 0.25765443
 0.2571275  0.2560595  0.25488016 0.25445637 0.25430298 0.25368112
 0.25281268 0.25223246 0.25183016 0.2512599  0.25052184 0.2501711
 0.25030318 0.25009045 0.24961229 0.24941087 0.24965848 0.24955799
 0.24904142 0.24909016 0.24982926 0.24988689 0.25054276 0.2545386 ]
