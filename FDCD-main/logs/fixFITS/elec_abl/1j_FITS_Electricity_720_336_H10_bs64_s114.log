Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j336_H10', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_j336_H10_FITS_custom_ftM_sl720_ll48_pl336_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 2297
test 4925
Model(
  (freq_upsampler): Linear(in_features=320, out_features=469, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  6166487040.0
params:  150549.0
Trainable parameters:  150549
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4375554
	speed: 1.3843s/iter; left time: 18551.3749s
Epoch: 1 cost time: 181.6265208721161
Epoch: 1, Steps: 135 | Train Loss: 0.6036354 Vali Loss: 0.3026169 Test Loss: 0.3629843
Validation loss decreased (inf --> 0.302617).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2461328
	speed: 2.8373s/iter; left time: 37639.6555s
Epoch: 2 cost time: 170.68548011779785
Epoch: 2, Steps: 135 | Train Loss: 0.2828202 Vali Loss: 0.1799903 Test Loss: 0.2189051
Validation loss decreased (0.302617 --> 0.179990).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1946849
	speed: 3.0722s/iter; left time: 40340.7850s
Epoch: 3 cost time: 190.4252576828003
Epoch: 3, Steps: 135 | Train Loss: 0.2005616 Vali Loss: 0.1498224 Test Loss: 0.1805231
Validation loss decreased (0.179990 --> 0.149822).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1685213
	speed: 3.1244s/iter; left time: 40605.1190s
Epoch: 4 cost time: 189.1369993686676
Epoch: 4, Steps: 135 | Train Loss: 0.1804360 Vali Loss: 0.1436748 Test Loss: 0.1716485
Validation loss decreased (0.149822 --> 0.143675).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1682100
	speed: 2.7414s/iter; left time: 35257.7671s
Epoch: 5 cost time: 177.66164326667786
Epoch: 5, Steps: 135 | Train Loss: 0.1760222 Vali Loss: 0.1423057 Test Loss: 0.1694778
Validation loss decreased (0.143675 --> 0.142306).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1658244
	speed: 3.0049s/iter; left time: 38240.3259s
Epoch: 6 cost time: 179.33248448371887
Epoch: 6, Steps: 135 | Train Loss: 0.1747424 Vali Loss: 0.1422069 Test Loss: 0.1687456
Validation loss decreased (0.142306 --> 0.142207).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1840975
	speed: 2.9710s/iter; left time: 37407.4748s
Epoch: 7 cost time: 189.85792708396912
Epoch: 7, Steps: 135 | Train Loss: 0.1741294 Vali Loss: 0.1420715 Test Loss: 0.1683384
Validation loss decreased (0.142207 --> 0.142071).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1722383
	speed: 2.8111s/iter; left time: 35014.5679s
Epoch: 8 cost time: 171.69667267799377
Epoch: 8, Steps: 135 | Train Loss: 0.1737572 Vali Loss: 0.1422198 Test Loss: 0.1681416
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1764408
	speed: 2.9737s/iter; left time: 36639.3686s
Epoch: 9 cost time: 184.11089086532593
Epoch: 9, Steps: 135 | Train Loss: 0.1735151 Vali Loss: 0.1416550 Test Loss: 0.1679889
Validation loss decreased (0.142071 --> 0.141655).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1922245
	speed: 2.8604s/iter; left time: 34856.3970s
Epoch: 10 cost time: 178.53422451019287
Epoch: 10, Steps: 135 | Train Loss: 0.1733677 Vali Loss: 0.1416959 Test Loss: 0.1679059
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1644817
	speed: 2.8510s/iter; left time: 34357.0845s
Epoch: 11 cost time: 174.2348165512085
Epoch: 11, Steps: 135 | Train Loss: 0.1731429 Vali Loss: 0.1415561 Test Loss: 0.1677886
Validation loss decreased (0.141655 --> 0.141556).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1826963
	speed: 2.8492s/iter; left time: 33951.1501s
Epoch: 12 cost time: 177.793607711792
Epoch: 12, Steps: 135 | Train Loss: 0.1730568 Vali Loss: 0.1417613 Test Loss: 0.1677494
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1843881
	speed: 2.8795s/iter; left time: 33923.9003s
Epoch: 13 cost time: 175.33346843719482
Epoch: 13, Steps: 135 | Train Loss: 0.1729579 Vali Loss: 0.1415920 Test Loss: 0.1677001
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1804338
	speed: 2.6511s/iter; left time: 30874.1492s
Epoch: 14 cost time: 152.64747953414917
Epoch: 14, Steps: 135 | Train Loss: 0.1728174 Vali Loss: 0.1413099 Test Loss: 0.1676376
Validation loss decreased (0.141556 --> 0.141310).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1792087
	speed: 2.4799s/iter; left time: 28546.1747s
Epoch: 15 cost time: 151.0942976474762
Epoch: 15, Steps: 135 | Train Loss: 0.1728493 Vali Loss: 0.1413179 Test Loss: 0.1676227
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1850917
	speed: 2.5481s/iter; left time: 28986.6337s
Epoch: 16 cost time: 156.01992440223694
Epoch: 16, Steps: 135 | Train Loss: 0.1726217 Vali Loss: 0.1411728 Test Loss: 0.1675599
Validation loss decreased (0.141310 --> 0.141173).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1696152
	speed: 2.4911s/iter; left time: 28002.5550s
Epoch: 17 cost time: 152.60599207878113
Epoch: 17, Steps: 135 | Train Loss: 0.1726225 Vali Loss: 0.1415831 Test Loss: 0.1675584
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1635439
	speed: 2.5426s/iter; left time: 28238.2989s
Epoch: 18 cost time: 158.91254353523254
Epoch: 18, Steps: 135 | Train Loss: 0.1726266 Vali Loss: 0.1415569 Test Loss: 0.1675245
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1710525
	speed: 2.5340s/iter; left time: 27800.2823s
Epoch: 19 cost time: 156.6618812084198
Epoch: 19, Steps: 135 | Train Loss: 0.1725815 Vali Loss: 0.1414152 Test Loss: 0.1675406
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1811344
	speed: 2.4511s/iter; left time: 26560.0914s
Epoch: 20 cost time: 148.20172715187073
Epoch: 20, Steps: 135 | Train Loss: 0.1726110 Vali Loss: 0.1414808 Test Loss: 0.1675282
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1745820
	speed: 2.0530s/iter; left time: 21969.0856s
Epoch: 21 cost time: 131.13154554367065
Epoch: 21, Steps: 135 | Train Loss: 0.1724935 Vali Loss: 0.1412856 Test Loss: 0.1675131
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1666334
	speed: 2.4703s/iter; left time: 26101.7082s
Epoch: 22 cost time: 153.45265746116638
Epoch: 22, Steps: 135 | Train Loss: 0.1724196 Vali Loss: 0.1413139 Test Loss: 0.1674838
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1805141
	speed: 2.5823s/iter; left time: 26936.1777s
Epoch: 23 cost time: 155.50929641723633
Epoch: 23, Steps: 135 | Train Loss: 0.1724525 Vali Loss: 0.1412283 Test Loss: 0.1674755
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1699815
	speed: 2.5286s/iter; left time: 26034.8177s
Epoch: 24 cost time: 158.03484201431274
Epoch: 24, Steps: 135 | Train Loss: 0.1724358 Vali Loss: 0.1415296 Test Loss: 0.1674506
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1762960
	speed: 2.6414s/iter; left time: 26838.9055s
Epoch: 25 cost time: 156.3468840122223
Epoch: 25, Steps: 135 | Train Loss: 0.1724301 Vali Loss: 0.1411919 Test Loss: 0.1674774
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1679455
	speed: 2.4999s/iter; left time: 25063.8216s
Epoch: 26 cost time: 153.88398718833923
Epoch: 26, Steps: 135 | Train Loss: 0.1724051 Vali Loss: 0.1414663 Test Loss: 0.1674235
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1774634
	speed: 2.5219s/iter; left time: 24944.5723s
Epoch: 27 cost time: 153.33403825759888
Epoch: 27, Steps: 135 | Train Loss: 0.1724249 Vali Loss: 0.1413640 Test Loss: 0.1674385
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1689991
	speed: 2.2693s/iter; left time: 22139.4813s
Epoch: 28 cost time: 126.5866539478302
Epoch: 28, Steps: 135 | Train Loss: 0.1724132 Vali Loss: 0.1412553 Test Loss: 0.1674077
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1696941
	speed: 1.9466s/iter; left time: 18728.3152s
Epoch: 29 cost time: 104.1386775970459
Epoch: 29, Steps: 135 | Train Loss: 0.1723935 Vali Loss: 0.1411464 Test Loss: 0.1674351
Validation loss decreased (0.141173 --> 0.141146).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1723363
	speed: 1.6135s/iter; left time: 15305.6093s
Epoch: 30 cost time: 102.41691756248474
Epoch: 30, Steps: 135 | Train Loss: 0.1723946 Vali Loss: 0.1413917 Test Loss: 0.1673869
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1671976
	speed: 1.6844s/iter; left time: 15750.6053s
Epoch: 31 cost time: 112.9147596359253
Epoch: 31, Steps: 135 | Train Loss: 0.1723436 Vali Loss: 0.1413256 Test Loss: 0.1673892
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1688802
	speed: 1.9692s/iter; left time: 18148.2533s
Epoch: 32 cost time: 118.28242182731628
Epoch: 32, Steps: 135 | Train Loss: 0.1723325 Vali Loss: 0.1412113 Test Loss: 0.1673921
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1714934
	speed: 1.7429s/iter; left time: 15827.0840s
Epoch: 33 cost time: 106.11060523986816
Epoch: 33, Steps: 135 | Train Loss: 0.1722898 Vali Loss: 0.1412408 Test Loss: 0.1673728
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1694195
	speed: 2.1482s/iter; left time: 19217.6706s
Epoch: 34 cost time: 115.74608063697815
Epoch: 34, Steps: 135 | Train Loss: 0.1722574 Vali Loss: 0.1411575 Test Loss: 0.1673793
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1699057
	speed: 1.1643s/iter; left time: 10258.9411s
Epoch: 35 cost time: 67.14490818977356
Epoch: 35, Steps: 135 | Train Loss: 0.1722578 Vali Loss: 0.1412533 Test Loss: 0.1673881
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1659648
	speed: 1.0608s/iter; left time: 9203.4485s
Epoch: 36 cost time: 63.29426312446594
Epoch: 36, Steps: 135 | Train Loss: 0.1723033 Vali Loss: 0.1413016 Test Loss: 0.1673633
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1795070
	speed: 1.4107s/iter; left time: 12048.5147s
Epoch: 37 cost time: 108.58193731307983
Epoch: 37, Steps: 135 | Train Loss: 0.1723106 Vali Loss: 0.1414487 Test Loss: 0.1673539
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1738302
	speed: 1.7632s/iter; left time: 14821.8250s
Epoch: 38 cost time: 103.3455228805542
Epoch: 38, Steps: 135 | Train Loss: 0.1722374 Vali Loss: 0.1411152 Test Loss: 0.1673638
Validation loss decreased (0.141146 --> 0.141115).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1700078
	speed: 1.7020s/iter; left time: 14077.3307s
Epoch: 39 cost time: 106.62781262397766
Epoch: 39, Steps: 135 | Train Loss: 0.1723190 Vali Loss: 0.1411832 Test Loss: 0.1673451
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1697686
	speed: 1.7373s/iter; left time: 14134.2963s
Epoch: 40 cost time: 118.44155669212341
Epoch: 40, Steps: 135 | Train Loss: 0.1722953 Vali Loss: 0.1414641 Test Loss: 0.1673582
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1762549
	speed: 2.3984s/iter; left time: 19189.3743s
Epoch: 41 cost time: 149.59046030044556
Epoch: 41, Steps: 135 | Train Loss: 0.1722651 Vali Loss: 0.1412340 Test Loss: 0.1673485
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1881366
	speed: 2.3326s/iter; left time: 18348.1573s
Epoch: 42 cost time: 133.61254024505615
Epoch: 42, Steps: 135 | Train Loss: 0.1721735 Vali Loss: 0.1413939 Test Loss: 0.1673555
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1751681
	speed: 1.6422s/iter; left time: 12696.0986s
Epoch: 43 cost time: 98.43635702133179
Epoch: 43, Steps: 135 | Train Loss: 0.1722330 Vali Loss: 0.1413798 Test Loss: 0.1673449
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1721864
	speed: 1.9854s/iter; left time: 15080.7475s
Epoch: 44 cost time: 140.43402743339539
Epoch: 44, Steps: 135 | Train Loss: 0.1722434 Vali Loss: 0.1414755 Test Loss: 0.1673426
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1854585
	speed: 2.4026s/iter; left time: 17925.7072s
Epoch: 45 cost time: 145.71510648727417
Epoch: 45, Steps: 135 | Train Loss: 0.1722378 Vali Loss: 0.1411945 Test Loss: 0.1673383
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1741146
	speed: 2.4219s/iter; left time: 17743.0479s
Epoch: 46 cost time: 145.0506021976471
Epoch: 46, Steps: 135 | Train Loss: 0.1722334 Vali Loss: 0.1411864 Test Loss: 0.1673409
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1747258
	speed: 2.3842s/iter; left time: 17144.7002s
Epoch: 47 cost time: 149.21510529518127
Epoch: 47, Steps: 135 | Train Loss: 0.1722625 Vali Loss: 0.1411343 Test Loss: 0.1673347
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1715858
	speed: 2.4315s/iter; left time: 17156.3263s
Epoch: 48 cost time: 173.53355503082275
Epoch: 48, Steps: 135 | Train Loss: 0.1721784 Vali Loss: 0.1410830 Test Loss: 0.1673404
Validation loss decreased (0.141115 --> 0.141083).  Saving model ...
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1677025
	speed: 2.3874s/iter; left time: 16523.4507s
Epoch: 49 cost time: 91.0111072063446
Epoch: 49, Steps: 135 | Train Loss: 0.1722444 Vali Loss: 0.1411338 Test Loss: 0.1673367
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1831430
	speed: 1.3077s/iter; left time: 8874.0570s
Epoch: 50 cost time: 106.96247863769531
Epoch: 50, Steps: 135 | Train Loss: 0.1721954 Vali Loss: 0.1412770 Test Loss: 0.1673343
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1685668
	speed: 2.6611s/iter; left time: 17699.1292s
Epoch: 51 cost time: 112.85936164855957
Epoch: 51, Steps: 135 | Train Loss: 0.1721769 Vali Loss: 0.1411376 Test Loss: 0.1673363
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1740511
	speed: 1.3760s/iter; left time: 8965.7258s
Epoch: 52 cost time: 83.89786839485168
Epoch: 52, Steps: 135 | Train Loss: 0.1721869 Vali Loss: 0.1412947 Test Loss: 0.1673194
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1808595
	speed: 1.2272s/iter; left time: 7831.0819s
Epoch: 53 cost time: 70.14497661590576
Epoch: 53, Steps: 135 | Train Loss: 0.1721591 Vali Loss: 0.1410874 Test Loss: 0.1673287
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1728303
	speed: 1.1933s/iter; left time: 7453.0701s
Epoch: 54 cost time: 73.0137345790863
Epoch: 54, Steps: 135 | Train Loss: 0.1722039 Vali Loss: 0.1412891 Test Loss: 0.1673301
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1619217
	speed: 1.4579s/iter; left time: 8909.4935s
Epoch: 55 cost time: 102.89477610588074
Epoch: 55, Steps: 135 | Train Loss: 0.1721425 Vali Loss: 0.1411687 Test Loss: 0.1673346
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1686350
	speed: 1.8275s/iter; left time: 10920.8629s
Epoch: 56 cost time: 104.29118824005127
Epoch: 56, Steps: 135 | Train Loss: 0.1722088 Vali Loss: 0.1411667 Test Loss: 0.1673214
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1827336
	speed: 1.7959s/iter; left time: 10489.8324s
Epoch: 57 cost time: 109.36078453063965
Epoch: 57, Steps: 135 | Train Loss: 0.1721631 Vali Loss: 0.1413364 Test Loss: 0.1673258
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1603335
	speed: 1.7877s/iter; left time: 10200.6124s
Epoch: 58 cost time: 104.90131950378418
Epoch: 58, Steps: 135 | Train Loss: 0.1721676 Vali Loss: 0.1409920 Test Loss: 0.1673263
Validation loss decreased (0.141083 --> 0.140992).  Saving model ...
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1808162
	speed: 1.6840s/iter; left time: 9381.7301s
Epoch: 59 cost time: 100.0432231426239
Epoch: 59, Steps: 135 | Train Loss: 0.1720786 Vali Loss: 0.1413005 Test Loss: 0.1673242
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1667151
	speed: 1.7578s/iter; left time: 9555.2749s
Epoch: 60 cost time: 103.84265923500061
Epoch: 60, Steps: 135 | Train Loss: 0.1721917 Vali Loss: 0.1411529 Test Loss: 0.1673247
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1709385
	speed: 1.7344s/iter; left time: 9193.9072s
Epoch: 61 cost time: 105.46498799324036
Epoch: 61, Steps: 135 | Train Loss: 0.1721728 Vali Loss: 0.1412307 Test Loss: 0.1673147
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1714244
	speed: 1.6960s/iter; left time: 8761.3466s
Epoch: 62 cost time: 101.84686398506165
Epoch: 62, Steps: 135 | Train Loss: 0.1721721 Vali Loss: 0.1410789 Test Loss: 0.1673212
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1677656
	speed: 1.6889s/iter; left time: 8496.7234s
Epoch: 63 cost time: 104.3859429359436
Epoch: 63, Steps: 135 | Train Loss: 0.1721089 Vali Loss: 0.1412649 Test Loss: 0.1673274
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1882342
	speed: 1.7466s/iter; left time: 8551.1335s
Epoch: 64 cost time: 102.22586607933044
Epoch: 64, Steps: 135 | Train Loss: 0.1721498 Vali Loss: 0.1409428 Test Loss: 0.1673216
Validation loss decreased (0.140992 --> 0.140943).  Saving model ...
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1839531
	speed: 1.6287s/iter; left time: 7754.3438s
Epoch: 65 cost time: 97.33607602119446
Epoch: 65, Steps: 135 | Train Loss: 0.1721392 Vali Loss: 0.1416017 Test Loss: 0.1673215
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1654854
	speed: 1.5907s/iter; left time: 7358.7096s
Epoch: 66 cost time: 96.94984149932861
Epoch: 66, Steps: 135 | Train Loss: 0.1721862 Vali Loss: 0.1413058 Test Loss: 0.1673189
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1672832
	speed: 1.5662s/iter; left time: 7033.7839s
Epoch: 67 cost time: 98.66060519218445
Epoch: 67, Steps: 135 | Train Loss: 0.1721593 Vali Loss: 0.1411994 Test Loss: 0.1673219
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1719846
	speed: 1.5722s/iter; left time: 6848.6541s
Epoch: 68 cost time: 92.82819819450378
Epoch: 68, Steps: 135 | Train Loss: 0.1721623 Vali Loss: 0.1412744 Test Loss: 0.1673201
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1728134
	speed: 1.6106s/iter; left time: 6798.2539s
Epoch: 69 cost time: 110.00736498832703
Epoch: 69, Steps: 135 | Train Loss: 0.1720722 Vali Loss: 0.1410952 Test Loss: 0.1673179
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1728509
	speed: 1.5752s/iter; left time: 6436.4417s
Epoch: 70 cost time: 83.33086633682251
Epoch: 70, Steps: 135 | Train Loss: 0.1721616 Vali Loss: 0.1413024 Test Loss: 0.1673189
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1886930
	speed: 1.3941s/iter; left time: 5508.1546s
Epoch: 71 cost time: 84.16445541381836
Epoch: 71, Steps: 135 | Train Loss: 0.1722094 Vali Loss: 0.1410675 Test Loss: 0.1673180
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1674628
	speed: 1.3219s/iter; left time: 5044.4302s
Epoch: 72 cost time: 78.28757882118225
Epoch: 72, Steps: 135 | Train Loss: 0.1721990 Vali Loss: 0.1413723 Test Loss: 0.1673123
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1753316
	speed: 1.3004s/iter; left time: 4786.6654s
Epoch: 73 cost time: 75.75047183036804
Epoch: 73, Steps: 135 | Train Loss: 0.1720720 Vali Loss: 0.1411922 Test Loss: 0.1673171
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1533282
	speed: 1.2602s/iter; left time: 4468.6057s
Epoch: 74 cost time: 75.27213740348816
Epoch: 74, Steps: 135 | Train Loss: 0.1722140 Vali Loss: 0.1412557 Test Loss: 0.1673201
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1766082
	speed: 1.2263s/iter; left time: 4182.7832s
Epoch: 75 cost time: 75.5368754863739
Epoch: 75, Steps: 135 | Train Loss: 0.1721711 Vali Loss: 0.1409230 Test Loss: 0.1673176
Validation loss decreased (0.140943 --> 0.140923).  Saving model ...
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1653240
	speed: 1.2444s/iter; left time: 4076.6462s
Epoch: 76 cost time: 74.6344084739685
Epoch: 76, Steps: 135 | Train Loss: 0.1722343 Vali Loss: 0.1411909 Test Loss: 0.1673139
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1725347
	speed: 1.3593s/iter; left time: 4269.4289s
Epoch: 77 cost time: 83.77533984184265
Epoch: 77, Steps: 135 | Train Loss: 0.1721148 Vali Loss: 0.1413519 Test Loss: 0.1673137
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1846325
	speed: 1.2815s/iter; left time: 3852.3221s
Epoch: 78 cost time: 79.09218287467957
Epoch: 78, Steps: 135 | Train Loss: 0.1721006 Vali Loss: 0.1409364 Test Loss: 0.1673179
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1655397
	speed: 1.3529s/iter; left time: 3884.2469s
Epoch: 79 cost time: 90.72250461578369
Epoch: 79, Steps: 135 | Train Loss: 0.1721180 Vali Loss: 0.1412658 Test Loss: 0.1673174
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1785021
	speed: 1.5264s/iter; left time: 4176.2712s
Epoch: 80 cost time: 83.77889490127563
Epoch: 80, Steps: 135 | Train Loss: 0.1720820 Vali Loss: 0.1411587 Test Loss: 0.1673175
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.1754547
	speed: 1.3387s/iter; left time: 3481.9011s
Epoch: 81 cost time: 79.68329977989197
Epoch: 81, Steps: 135 | Train Loss: 0.1721506 Vali Loss: 0.1411512 Test Loss: 0.1673146
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1765637
	speed: 1.3377s/iter; left time: 3298.6603s
Epoch: 82 cost time: 81.61958384513855
Epoch: 82, Steps: 135 | Train Loss: 0.1721577 Vali Loss: 0.1410652 Test Loss: 0.1673159
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1744338
	speed: 1.2939s/iter; left time: 3016.1341s
Epoch: 83 cost time: 77.52831554412842
Epoch: 83, Steps: 135 | Train Loss: 0.1721408 Vali Loss: 0.1409743 Test Loss: 0.1673147
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.1770000
	speed: 1.1291s/iter; left time: 2479.4376s
Epoch: 84 cost time: 62.98623538017273
Epoch: 84, Steps: 135 | Train Loss: 0.1721920 Vali Loss: 0.1411008 Test Loss: 0.1673158
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1959067
	speed: 1.0422s/iter; left time: 2147.9071s
Epoch: 85 cost time: 62.60153818130493
Epoch: 85, Steps: 135 | Train Loss: 0.1722298 Vali Loss: 0.1410075 Test Loss: 0.1673156
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.1766597
	speed: 1.0581s/iter; left time: 2037.9923s
Epoch: 86 cost time: 62.46873450279236
Epoch: 86, Steps: 135 | Train Loss: 0.1722253 Vali Loss: 0.1410364 Test Loss: 0.1673138
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.1761579
	speed: 1.0432s/iter; left time: 1868.3065s
Epoch: 87 cost time: 63.97394132614136
Epoch: 87, Steps: 135 | Train Loss: 0.1721443 Vali Loss: 0.1410148 Test Loss: 0.1673156
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.1750934
	speed: 1.0307s/iter; left time: 1706.8849s
Epoch: 88 cost time: 60.83193397521973
Epoch: 88, Steps: 135 | Train Loss: 0.1721050 Vali Loss: 0.1409467 Test Loss: 0.1673153
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.1675232
	speed: 1.0330s/iter; left time: 1571.2161s
Epoch: 89 cost time: 62.92176628112793
Epoch: 89, Steps: 135 | Train Loss: 0.1721055 Vali Loss: 0.1411427 Test Loss: 0.1673140
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.1763076
	speed: 1.0538s/iter; left time: 1460.5894s
Epoch: 90 cost time: 62.751962661743164
Epoch: 90, Steps: 135 | Train Loss: 0.1721388 Vali Loss: 0.1410384 Test Loss: 0.1673140
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.1580963
	speed: 1.0486s/iter; left time: 1311.8021s
Epoch: 91 cost time: 63.04416346549988
Epoch: 91, Steps: 135 | Train Loss: 0.1720504 Vali Loss: 0.1411191 Test Loss: 0.1673138
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.944182354829475e-06
	iters: 100, epoch: 92 | loss: 0.1649355
	speed: 1.0530s/iter; left time: 1175.1077s
Epoch: 92 cost time: 62.94593906402588
Epoch: 92, Steps: 135 | Train Loss: 0.1721946 Vali Loss: 0.1412042 Test Loss: 0.1673137
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.696973237088e-06
	iters: 100, epoch: 93 | loss: 0.1631960
	speed: 1.0538s/iter; left time: 1033.8092s
Epoch: 93 cost time: 62.48578500747681
Epoch: 93, Steps: 135 | Train Loss: 0.1721261 Vali Loss: 0.1414034 Test Loss: 0.1673139
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.462124575233601e-06
	iters: 100, epoch: 94 | loss: 0.1614862
	speed: 1.1094s/iter; left time: 938.5804s
Epoch: 94 cost time: 72.16842365264893
Epoch: 94, Steps: 135 | Train Loss: 0.1721509 Vali Loss: 0.1410964 Test Loss: 0.1673140
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.239018346471921e-06
	iters: 100, epoch: 95 | loss: 0.1805695
	speed: 1.1002s/iter; left time: 782.2581s
Epoch: 95 cost time: 63.231836557388306
Epoch: 95, Steps: 135 | Train Loss: 0.1721835 Vali Loss: 0.1412438 Test Loss: 0.1673126
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_720_j336_H10_FITS_custom_ftM_sl720_ll48_pl336_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16510610282421112, mae:0.26040419936180115, rse:0.4044108986854553, corr:[0.4595693  0.4618535  0.46201727 0.4634488  0.46326858 0.46396574
 0.46382633 0.46390826 0.46367884 0.46354678 0.46337578 0.46324855
 0.46320933 0.46317008 0.46318847 0.46322426 0.46325278 0.46328247
 0.46323383 0.46310565 0.46308744 0.4630029  0.46320358 0.46332178
 0.4636554  0.4638093  0.46398208 0.46403465 0.46378002 0.46381003
 0.46357304 0.46344253 0.46329063 0.463162   0.4630952  0.46301565
 0.46303457 0.463054   0.46306926 0.46309623 0.4631044  0.4631052
 0.46308374 0.46290338 0.46286905 0.4627402  0.46279907 0.46293452
 0.4630428  0.4632514  0.46324787 0.463257   0.46310058 0.46301815
 0.46295935 0.46281165 0.46277893 0.46270153 0.4626717  0.462661
 0.4626678  0.46269518 0.4627123  0.462711   0.462719   0.46270043
 0.4626561  0.4624254  0.46226946 0.46225867 0.46220785 0.46232432
 0.46230906 0.46241856 0.46245098 0.46235812 0.46230072 0.46216896
 0.46216273 0.4620563  0.46199214 0.46198013 0.4619256  0.46190754
 0.46192047 0.46190774 0.46191108 0.4618982  0.4618777  0.4618931
 0.46187827 0.46188048 0.46180588 0.46186125 0.46186367 0.46190935
 0.46203166 0.4620417  0.4621401  0.462071   0.46200293 0.46196115
 0.46187747 0.46185118 0.46179935 0.46177864 0.46174464 0.4617227
 0.46169466 0.46171385 0.4617043  0.4616972  0.4616884  0.46167842
 0.46167147 0.4615852  0.46149746 0.461481   0.4615621  0.46163478
 0.46185884 0.46193218 0.46194994 0.46195516 0.4618995  0.46189404
 0.4618626  0.46180525 0.46176773 0.46174505 0.4617095  0.4616533
 0.4616258  0.46165138 0.4616587  0.46166098 0.4616587  0.46167827
 0.46164358 0.46146318 0.46133783 0.46120316 0.46115306 0.46115884
 0.4611986  0.4612844  0.4612907  0.46133578 0.46132037 0.46128532
 0.4612603  0.46120048 0.46120194 0.4612002  0.46113932 0.4611317
 0.46112627 0.46110374 0.4611366  0.4611389  0.46115375 0.46116176
 0.46116668 0.4609987  0.46087524 0.46084502 0.46074566 0.46078736
 0.46068642 0.46067873 0.4607886  0.46069342 0.46061626 0.46047947
 0.46039686 0.46032733 0.46019405 0.46008736 0.45996252 0.45984748
 0.45975897 0.45967937 0.4596107  0.4595048  0.4593608  0.4592787
 0.45909953 0.45896646 0.45884365 0.45874408 0.458736   0.45877582
 0.4589084  0.45899013 0.45911115 0.4591132  0.45904922 0.45899495
 0.45887974 0.45881346 0.4587227  0.45863962 0.45854723 0.45848402
 0.45845363 0.45844904 0.45844355 0.4584163  0.45836547 0.45836103
 0.45831272 0.45813727 0.45808887 0.45803207 0.45805895 0.45812857
 0.45826325 0.45847797 0.45857015 0.4586042  0.45851707 0.45849246
 0.45846653 0.45840317 0.45837736 0.45828605 0.45819515 0.45814493
 0.45808798 0.45807445 0.4580706  0.45800105 0.45802012 0.45797777
 0.45793527 0.4577746  0.4576312  0.45766062 0.45766082 0.45778838
 0.45788458 0.45804995 0.45815212 0.45818815 0.45816654 0.45805687
 0.45805317 0.45796928 0.4578894  0.45783153 0.45770296 0.45762053
 0.45762548 0.45756873 0.4575415  0.45748594 0.45744684 0.45745865
 0.45742956 0.4574689  0.45741847 0.45752192 0.4575888  0.4576877
 0.45785612 0.45793697 0.45807475 0.45798865 0.4579708  0.45793974
 0.45780963 0.45774877 0.45762268 0.45751953 0.45743498 0.4573408
 0.4573399  0.45731428 0.4572871  0.45734945 0.45726317 0.4573079
 0.45733416 0.45726    0.4572617  0.45728064 0.45743567 0.457554
 0.45783362 0.4578697  0.45792443 0.45791006 0.4577896  0.4577499
 0.4576374  0.45751154 0.45739368 0.45728555 0.45711914 0.45703194
 0.45699012 0.45702785 0.4569734  0.45704257 0.4570857  0.45706573
 0.45709667 0.45683247 0.45678625 0.45667008 0.45672575 0.45678365
 0.4567775  0.4568617  0.4568223  0.45684385 0.45665386 0.45656902
 0.45640174 0.456303   0.4561892  0.45612204 0.4560862  0.45617566
 0.45621198 0.45634818 0.4563637  0.4563813  0.45650473 0.45622286
 0.45645723 0.4558209  0.45614967 0.4556899  0.4565085  0.4564076 ]
