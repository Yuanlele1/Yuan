Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=170, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_360_j336_H10', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_360_j336_H10_FITS_custom_ftM_sl360_ll48_pl336_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17717
val 2297
test 4925
Model(
  (freq_upsampler): Linear(in_features=170, out_features=328, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2291066880.0
params:  56088.0
Trainable parameters:  56088
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6573257
	speed: 0.3967s/iter; left time: 5434.8036s
Epoch: 1 cost time: 56.026179790496826
Epoch: 1, Steps: 138 | Train Loss: 0.8513455 Vali Loss: 0.4966869 Test Loss: 0.5847890
Validation loss decreased (inf --> 0.496687).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4367203
	speed: 0.9394s/iter; left time: 12741.4002s
Epoch: 2 cost time: 53.68666744232178
Epoch: 2, Steps: 138 | Train Loss: 0.4877711 Vali Loss: 0.3299987 Test Loss: 0.3919634
Validation loss decreased (0.496687 --> 0.329999).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3144012
	speed: 0.9265s/iter; left time: 12437.8217s
Epoch: 3 cost time: 55.48921084403992
Epoch: 3, Steps: 138 | Train Loss: 0.3415061 Vali Loss: 0.2411251 Test Loss: 0.2880629
Validation loss decreased (0.329999 --> 0.241125).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2672205
	speed: 0.9560s/iter; left time: 12702.7048s
Epoch: 4 cost time: 56.21145296096802
Epoch: 4, Steps: 138 | Train Loss: 0.2627821 Vali Loss: 0.1940761 Test Loss: 0.2320829
Validation loss decreased (0.241125 --> 0.194076).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2215091
	speed: 0.9363s/iter; left time: 12311.3929s
Epoch: 5 cost time: 52.53559851646423
Epoch: 5, Steps: 138 | Train Loss: 0.2211313 Vali Loss: 0.1699811 Test Loss: 0.2026891
Validation loss decreased (0.194076 --> 0.169981).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2052467
	speed: 0.8242s/iter; left time: 10724.1403s
Epoch: 6 cost time: 50.07392692565918
Epoch: 6, Steps: 138 | Train Loss: 0.1998510 Vali Loss: 0.1584956 Test Loss: 0.1877006
Validation loss decreased (0.169981 --> 0.158496).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1868537
	speed: 0.9269s/iter; left time: 11931.3813s
Epoch: 7 cost time: 59.07320547103882
Epoch: 7, Steps: 138 | Train Loss: 0.1893183 Vali Loss: 0.1529901 Test Loss: 0.1802904
Validation loss decreased (0.158496 --> 0.152990).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2012658
	speed: 0.9092s/iter; left time: 11578.2554s
Epoch: 8 cost time: 50.700945138931274
Epoch: 8, Steps: 138 | Train Loss: 0.1843306 Vali Loss: 0.1503040 Test Loss: 0.1766942
Validation loss decreased (0.152990 --> 0.150304).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1818901
	speed: 0.8124s/iter; left time: 10234.2844s
Epoch: 9 cost time: 47.01379442214966
Epoch: 9, Steps: 138 | Train Loss: 0.1818818 Vali Loss: 0.1490990 Test Loss: 0.1749291
Validation loss decreased (0.150304 --> 0.149099).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1729753
	speed: 0.8140s/iter; left time: 10141.0706s
Epoch: 10 cost time: 47.248353242874146
Epoch: 10, Steps: 138 | Train Loss: 0.1807377 Vali Loss: 0.1485561 Test Loss: 0.1741040
Validation loss decreased (0.149099 --> 0.148556).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1762953
	speed: 1.1392s/iter; left time: 14035.6194s
Epoch: 11 cost time: 79.85968685150146
Epoch: 11, Steps: 138 | Train Loss: 0.1801700 Vali Loss: 0.1483009 Test Loss: 0.1736555
Validation loss decreased (0.148556 --> 0.148301).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1731947
	speed: 1.3187s/iter; left time: 16065.3625s
Epoch: 12 cost time: 80.12143158912659
Epoch: 12, Steps: 138 | Train Loss: 0.1798901 Vali Loss: 0.1481913 Test Loss: 0.1734331
Validation loss decreased (0.148301 --> 0.148191).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1743185
	speed: 1.4792s/iter; left time: 17816.7824s
Epoch: 13 cost time: 89.96402287483215
Epoch: 13, Steps: 138 | Train Loss: 0.1797671 Vali Loss: 0.1479122 Test Loss: 0.1732538
Validation loss decreased (0.148191 --> 0.147912).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1725878
	speed: 1.3394s/iter; left time: 15948.7235s
Epoch: 14 cost time: 80.9135091304779
Epoch: 14, Steps: 138 | Train Loss: 0.1796162 Vali Loss: 0.1481184 Test Loss: 0.1731947
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1865839
	speed: 1.3993s/iter; left time: 16467.8945s
Epoch: 15 cost time: 83.81622552871704
Epoch: 15, Steps: 138 | Train Loss: 0.1795951 Vali Loss: 0.1479224 Test Loss: 0.1731041
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1827003
	speed: 1.4929s/iter; left time: 17363.8233s
Epoch: 16 cost time: 87.57073593139648
Epoch: 16, Steps: 138 | Train Loss: 0.1795013 Vali Loss: 0.1480787 Test Loss: 0.1730819
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1748012
	speed: 1.4138s/iter; left time: 16248.3893s
Epoch: 17 cost time: 81.0842866897583
Epoch: 17, Steps: 138 | Train Loss: 0.1794796 Vali Loss: 0.1480140 Test Loss: 0.1730518
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1839620
	speed: 1.4275s/iter; left time: 16208.7482s
Epoch: 18 cost time: 80.4889988899231
Epoch: 18, Steps: 138 | Train Loss: 0.1794514 Vali Loss: 0.1479367 Test Loss: 0.1730060
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1814293
	speed: 1.2805s/iter; left time: 14363.2662s
Epoch: 19 cost time: 81.7523410320282
Epoch: 19, Steps: 138 | Train Loss: 0.1794366 Vali Loss: 0.1480250 Test Loss: 0.1730086
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1829461
	speed: 1.4365s/iter; left time: 15914.9214s
Epoch: 20 cost time: 80.2823498249054
Epoch: 20, Steps: 138 | Train Loss: 0.1794229 Vali Loss: 0.1480662 Test Loss: 0.1729710
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1745287
	speed: 1.3224s/iter; left time: 14468.3940s
Epoch: 21 cost time: 79.8272705078125
Epoch: 21, Steps: 138 | Train Loss: 0.1793081 Vali Loss: 0.1478821 Test Loss: 0.1729630
Validation loss decreased (0.147912 --> 0.147882).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1750802
	speed: 1.3656s/iter; left time: 14752.1015s
Epoch: 22 cost time: 81.56056690216064
Epoch: 22, Steps: 138 | Train Loss: 0.1793030 Vali Loss: 0.1478556 Test Loss: 0.1729207
Validation loss decreased (0.147882 --> 0.147856).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1712872
	speed: 1.3892s/iter; left time: 14816.0025s
Epoch: 23 cost time: 79.8179292678833
Epoch: 23, Steps: 138 | Train Loss: 0.1793212 Vali Loss: 0.1477868 Test Loss: 0.1729168
Validation loss decreased (0.147856 --> 0.147787).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1823334
	speed: 1.3835s/iter; left time: 14563.7234s
Epoch: 24 cost time: 89.12462854385376
Epoch: 24, Steps: 138 | Train Loss: 0.1792894 Vali Loss: 0.1477329 Test Loss: 0.1729163
Validation loss decreased (0.147787 --> 0.147733).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1885924
	speed: 1.4659s/iter; left time: 15229.6589s
Epoch: 25 cost time: 88.65209627151489
Epoch: 25, Steps: 138 | Train Loss: 0.1792954 Vali Loss: 0.1479227 Test Loss: 0.1729141
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1742546
	speed: 1.5393s/iter; left time: 15779.4466s
Epoch: 26 cost time: 85.62619853019714
Epoch: 26, Steps: 138 | Train Loss: 0.1792374 Vali Loss: 0.1480858 Test Loss: 0.1728822
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1840249
	speed: 1.4594s/iter; left time: 14758.4097s
Epoch: 27 cost time: 88.75452780723572
Epoch: 27, Steps: 138 | Train Loss: 0.1791298 Vali Loss: 0.1481444 Test Loss: 0.1728707
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1744037
	speed: 1.3105s/iter; left time: 13072.0712s
Epoch: 28 cost time: 65.28538489341736
Epoch: 28, Steps: 138 | Train Loss: 0.1791826 Vali Loss: 0.1476372 Test Loss: 0.1728697
Validation loss decreased (0.147733 --> 0.147637).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1789200
	speed: 1.0283s/iter; left time: 10115.1103s
Epoch: 29 cost time: 61.53117632865906
Epoch: 29, Steps: 138 | Train Loss: 0.1792373 Vali Loss: 0.1477506 Test Loss: 0.1728635
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1756410
	speed: 1.0122s/iter; left time: 9816.8907s
Epoch: 30 cost time: 60.71131992340088
Epoch: 30, Steps: 138 | Train Loss: 0.1791322 Vali Loss: 0.1477069 Test Loss: 0.1728616
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1813389
	speed: 1.0636s/iter; left time: 10168.6312s
Epoch: 31 cost time: 59.649012327194214
Epoch: 31, Steps: 138 | Train Loss: 0.1791703 Vali Loss: 0.1477391 Test Loss: 0.1728432
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1793017
	speed: 1.0586s/iter; left time: 9975.0622s
Epoch: 32 cost time: 69.24793124198914
Epoch: 32, Steps: 138 | Train Loss: 0.1791527 Vali Loss: 0.1478564 Test Loss: 0.1728377
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1815008
	speed: 1.2029s/iter; left time: 11169.0347s
Epoch: 33 cost time: 67.86736917495728
Epoch: 33, Steps: 138 | Train Loss: 0.1791352 Vali Loss: 0.1475339 Test Loss: 0.1728539
Validation loss decreased (0.147637 --> 0.147534).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1820276
	speed: 1.0880s/iter; left time: 9951.5169s
Epoch: 34 cost time: 61.44966769218445
Epoch: 34, Steps: 138 | Train Loss: 0.1791649 Vali Loss: 0.1478283 Test Loss: 0.1728313
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1798970
	speed: 1.0252s/iter; left time: 9235.6300s
Epoch: 35 cost time: 63.51469039916992
Epoch: 35, Steps: 138 | Train Loss: 0.1791228 Vali Loss: 0.1475570 Test Loss: 0.1728464
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1655384
	speed: 1.1033s/iter; left time: 9787.6756s
Epoch: 36 cost time: 61.36295485496521
Epoch: 36, Steps: 138 | Train Loss: 0.1791745 Vali Loss: 0.1477369 Test Loss: 0.1728254
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1981351
	speed: 0.9605s/iter; left time: 8387.7045s
Epoch: 37 cost time: 58.382129192352295
Epoch: 37, Steps: 138 | Train Loss: 0.1791517 Vali Loss: 0.1479202 Test Loss: 0.1728285
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1942981
	speed: 1.0002s/iter; left time: 8596.4489s
Epoch: 38 cost time: 57.81760549545288
Epoch: 38, Steps: 138 | Train Loss: 0.1791085 Vali Loss: 0.1478737 Test Loss: 0.1728268
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1837388
	speed: 0.9980s/iter; left time: 8439.7789s
Epoch: 39 cost time: 60.76428532600403
Epoch: 39, Steps: 138 | Train Loss: 0.1791302 Vali Loss: 0.1478218 Test Loss: 0.1728317
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1853809
	speed: 1.1376s/iter; left time: 9464.0046s
Epoch: 40 cost time: 76.43373966217041
Epoch: 40, Steps: 138 | Train Loss: 0.1791538 Vali Loss: 0.1476189 Test Loss: 0.1728157
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1768344
	speed: 1.5652s/iter; left time: 12805.0102s
Epoch: 41 cost time: 100.3069384098053
Epoch: 41, Steps: 138 | Train Loss: 0.1790714 Vali Loss: 0.1476692 Test Loss: 0.1728195
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1781173
	speed: 1.2861s/iter; left time: 10344.0694s
Epoch: 42 cost time: 75.28537464141846
Epoch: 42, Steps: 138 | Train Loss: 0.1791536 Vali Loss: 0.1476417 Test Loss: 0.1728200
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1745574
	speed: 1.3303s/iter; left time: 10516.1256s
Epoch: 43 cost time: 80.4395637512207
Epoch: 43, Steps: 138 | Train Loss: 0.1791614 Vali Loss: 0.1477110 Test Loss: 0.1728113
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1687698
	speed: 1.3327s/iter; left time: 10350.7293s
Epoch: 44 cost time: 75.95697474479675
Epoch: 44, Steps: 138 | Train Loss: 0.1790887 Vali Loss: 0.1476482 Test Loss: 0.1728161
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1713812
	speed: 1.4034s/iter; left time: 10706.6058s
Epoch: 45 cost time: 76.71492767333984
Epoch: 45, Steps: 138 | Train Loss: 0.1790587 Vali Loss: 0.1475114 Test Loss: 0.1728067
Validation loss decreased (0.147534 --> 0.147511).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1908533
	speed: 1.2993s/iter; left time: 9732.7549s
Epoch: 46 cost time: 72.35064816474915
Epoch: 46, Steps: 138 | Train Loss: 0.1790955 Vali Loss: 0.1476716 Test Loss: 0.1728078
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1854407
	speed: 1.3781s/iter; left time: 10133.1550s
Epoch: 47 cost time: 83.798898935318
Epoch: 47, Steps: 138 | Train Loss: 0.1790609 Vali Loss: 0.1478622 Test Loss: 0.1728061
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1858152
	speed: 1.3091s/iter; left time: 9445.1664s
Epoch: 48 cost time: 73.05212187767029
Epoch: 48, Steps: 138 | Train Loss: 0.1791443 Vali Loss: 0.1478518 Test Loss: 0.1728039
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1888760
	speed: 1.3188s/iter; left time: 9333.3302s
Epoch: 49 cost time: 80.10235524177551
Epoch: 49, Steps: 138 | Train Loss: 0.1791257 Vali Loss: 0.1477267 Test Loss: 0.1727979
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1824254
	speed: 1.4933s/iter; left time: 10361.7462s
Epoch: 50 cost time: 79.11460947990417
Epoch: 50, Steps: 138 | Train Loss: 0.1790337 Vali Loss: 0.1477277 Test Loss: 0.1728013
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1940356
	speed: 1.4152s/iter; left time: 9624.5040s
Epoch: 51 cost time: 83.67306804656982
Epoch: 51, Steps: 138 | Train Loss: 0.1790912 Vali Loss: 0.1477268 Test Loss: 0.1728033
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1942224
	speed: 1.3381s/iter; left time: 8915.9479s
Epoch: 52 cost time: 77.23770523071289
Epoch: 52, Steps: 138 | Train Loss: 0.1790991 Vali Loss: 0.1478976 Test Loss: 0.1728004
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1821587
	speed: 1.3936s/iter; left time: 9093.5506s
Epoch: 53 cost time: 87.37992095947266
Epoch: 53, Steps: 138 | Train Loss: 0.1790901 Vali Loss: 0.1476590 Test Loss: 0.1727977
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1833502
	speed: 1.4074s/iter; left time: 8989.1183s
Epoch: 54 cost time: 77.08291339874268
Epoch: 54, Steps: 138 | Train Loss: 0.1790208 Vali Loss: 0.1478397 Test Loss: 0.1727912
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1768924
	speed: 1.3100s/iter; left time: 8186.1901s
Epoch: 55 cost time: 78.02957892417908
Epoch: 55, Steps: 138 | Train Loss: 0.1790754 Vali Loss: 0.1478718 Test Loss: 0.1727953
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1620001
	speed: 1.3606s/iter; left time: 8314.5089s
Epoch: 56 cost time: 77.22462105751038
Epoch: 56, Steps: 138 | Train Loss: 0.1789985 Vali Loss: 0.1476527 Test Loss: 0.1727949
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1925029
	speed: 1.6029s/iter; left time: 9573.8491s
Epoch: 57 cost time: 122.29524230957031
Epoch: 57, Steps: 138 | Train Loss: 0.1790858 Vali Loss: 0.1474984 Test Loss: 0.1727969
Validation loss decreased (0.147511 --> 0.147498).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1808150
	speed: 1.5298s/iter; left time: 8926.2522s
Epoch: 58 cost time: 77.85849332809448
Epoch: 58, Steps: 138 | Train Loss: 0.1791024 Vali Loss: 0.1478113 Test Loss: 0.1727888
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1823723
	speed: 1.5539s/iter; left time: 8852.4600s
Epoch: 59 cost time: 97.05328726768494
Epoch: 59, Steps: 138 | Train Loss: 0.1791046 Vali Loss: 0.1477497 Test Loss: 0.1727891
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1758366
	speed: 1.3416s/iter; left time: 7457.9666s
Epoch: 60 cost time: 79.17998456954956
Epoch: 60, Steps: 138 | Train Loss: 0.1790628 Vali Loss: 0.1478209 Test Loss: 0.1727895
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1720451
	speed: 1.3194s/iter; left time: 7152.3840s
Epoch: 61 cost time: 79.04644775390625
Epoch: 61, Steps: 138 | Train Loss: 0.1790523 Vali Loss: 0.1477782 Test Loss: 0.1727889
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1929606
	speed: 1.3875s/iter; left time: 7330.4198s
Epoch: 62 cost time: 83.18272733688354
Epoch: 62, Steps: 138 | Train Loss: 0.1790949 Vali Loss: 0.1476921 Test Loss: 0.1727874
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1885111
	speed: 1.3228s/iter; left time: 6805.9167s
Epoch: 63 cost time: 75.2307550907135
Epoch: 63, Steps: 138 | Train Loss: 0.1790951 Vali Loss: 0.1476050 Test Loss: 0.1727902
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1691174
	speed: 1.3779s/iter; left time: 6899.2221s
Epoch: 64 cost time: 78.38318634033203
Epoch: 64, Steps: 138 | Train Loss: 0.1790463 Vali Loss: 0.1477387 Test Loss: 0.1727892
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1881766
	speed: 1.3267s/iter; left time: 6459.6864s
Epoch: 65 cost time: 72.7710211277008
Epoch: 65, Steps: 138 | Train Loss: 0.1790856 Vali Loss: 0.1478153 Test Loss: 0.1727907
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1860941
	speed: 1.1854s/iter; left time: 5608.0140s
Epoch: 66 cost time: 74.31319785118103
Epoch: 66, Steps: 138 | Train Loss: 0.1790493 Vali Loss: 0.1478727 Test Loss: 0.1727895
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1834811
	speed: 1.2912s/iter; left time: 5930.5539s
Epoch: 67 cost time: 77.5924973487854
Epoch: 67, Steps: 138 | Train Loss: 0.1790894 Vali Loss: 0.1477305 Test Loss: 0.1727905
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1716042
	speed: 1.3626s/iter; left time: 6070.4522s
Epoch: 68 cost time: 94.37929582595825
Epoch: 68, Steps: 138 | Train Loss: 0.1791051 Vali Loss: 0.1477579 Test Loss: 0.1727881
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1790645
	speed: 2.3693s/iter; left time: 10228.4470s
Epoch: 69 cost time: 197.8309199810028
Epoch: 69, Steps: 138 | Train Loss: 0.1790292 Vali Loss: 0.1476918 Test Loss: 0.1727895
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1717872
	speed: 3.3681s/iter; left time: 14075.2813s
Epoch: 70 cost time: 159.37041473388672
Epoch: 70, Steps: 138 | Train Loss: 0.1790721 Vali Loss: 0.1477693 Test Loss: 0.1727896
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1914094
	speed: 1.6399s/iter; left time: 6626.8966s
Epoch: 71 cost time: 95.3490538597107
Epoch: 71, Steps: 138 | Train Loss: 0.1791109 Vali Loss: 0.1478825 Test Loss: 0.1727892
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1933923
	speed: 2.7378s/iter; left time: 10685.5779s
Epoch: 72 cost time: 198.26976370811462
Epoch: 72, Steps: 138 | Train Loss: 0.1790300 Vali Loss: 0.1477059 Test Loss: 0.1727905
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1752357
	speed: 3.0207s/iter; left time: 11372.8166s
Epoch: 73 cost time: 148.9765601158142
Epoch: 73, Steps: 138 | Train Loss: 0.1790739 Vali Loss: 0.1475475 Test Loss: 0.1727890
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1687905
	speed: 1.8251s/iter; left time: 6619.6146s
Epoch: 74 cost time: 101.94170260429382
Epoch: 74, Steps: 138 | Train Loss: 0.1791050 Vali Loss: 0.1476037 Test Loss: 0.1727888
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1787703
	speed: 2.1379s/iter; left time: 7459.1047s
Epoch: 75 cost time: 131.79837942123413
Epoch: 75, Steps: 138 | Train Loss: 0.1790620 Vali Loss: 0.1475359 Test Loss: 0.1727863
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1731125
	speed: 2.1901s/iter; left time: 7338.9119s
Epoch: 76 cost time: 133.58690404891968
Epoch: 76, Steps: 138 | Train Loss: 0.1790282 Vali Loss: 0.1478457 Test Loss: 0.1727873
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1722327
	speed: 2.2981s/iter; left time: 7383.9124s
Epoch: 77 cost time: 138.59421372413635
Epoch: 77, Steps: 138 | Train Loss: 0.1790633 Vali Loss: 0.1473212 Test Loss: 0.1727880
Validation loss decreased (0.147498 --> 0.147321).  Saving model ...
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1739614
	speed: 2.3330s/iter; left time: 7173.8529s
Epoch: 78 cost time: 144.08231616020203
Epoch: 78, Steps: 138 | Train Loss: 0.1790492 Vali Loss: 0.1474402 Test Loss: 0.1727877
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1840852
	speed: 2.2057s/iter; left time: 6478.0135s
Epoch: 79 cost time: 127.7934000492096
Epoch: 79, Steps: 138 | Train Loss: 0.1790177 Vali Loss: 0.1478975 Test Loss: 0.1727863
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1784324
	speed: 2.1373s/iter; left time: 5982.1946s
Epoch: 80 cost time: 129.79276037216187
Epoch: 80, Steps: 138 | Train Loss: 0.1790689 Vali Loss: 0.1477564 Test Loss: 0.1727868
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.1789485
	speed: 2.1441s/iter; left time: 5705.5624s
Epoch: 81 cost time: 128.14121842384338
Epoch: 81, Steps: 138 | Train Loss: 0.1789532 Vali Loss: 0.1477888 Test Loss: 0.1727861
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1915256
	speed: 2.1774s/iter; left time: 5493.4620s
Epoch: 82 cost time: 132.2596297264099
Epoch: 82, Steps: 138 | Train Loss: 0.1789924 Vali Loss: 0.1479269 Test Loss: 0.1727856
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1773111
	speed: 2.2299s/iter; left time: 5318.3530s
Epoch: 83 cost time: 136.5489947795868
Epoch: 83, Steps: 138 | Train Loss: 0.1790878 Vali Loss: 0.1476758 Test Loss: 0.1727864
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.1821877
	speed: 2.3011s/iter; left time: 5170.4603s
Epoch: 84 cost time: 129.3493070602417
Epoch: 84, Steps: 138 | Train Loss: 0.1790630 Vali Loss: 0.1477306 Test Loss: 0.1727857
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1850617
	speed: 2.1859s/iter; left time: 4610.0347s
Epoch: 85 cost time: 131.37683296203613
Epoch: 85, Steps: 138 | Train Loss: 0.1790671 Vali Loss: 0.1475173 Test Loss: 0.1727851
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.1747235
	speed: 2.2365s/iter; left time: 4408.2104s
Epoch: 86 cost time: 133.41067385673523
Epoch: 86, Steps: 138 | Train Loss: 0.1790124 Vali Loss: 0.1477971 Test Loss: 0.1727847
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.1781737
	speed: 2.2236s/iter; left time: 4075.9361s
Epoch: 87 cost time: 131.1170859336853
Epoch: 87, Steps: 138 | Train Loss: 0.1790551 Vali Loss: 0.1477125 Test Loss: 0.1727851
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.1842517
	speed: 2.2489s/iter; left time: 3811.8365s
Epoch: 88 cost time: 131.62678456306458
Epoch: 88, Steps: 138 | Train Loss: 0.1790083 Vali Loss: 0.1476451 Test Loss: 0.1727842
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.1891253
	speed: 2.2064s/iter; left time: 3435.2933s
Epoch: 89 cost time: 133.13832592964172
Epoch: 89, Steps: 138 | Train Loss: 0.1790918 Vali Loss: 0.1476562 Test Loss: 0.1727846
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.1719210
	speed: 2.2724s/iter; left time: 3224.5176s
Epoch: 90 cost time: 134.8109745979309
Epoch: 90, Steps: 138 | Train Loss: 0.1790309 Vali Loss: 0.1477838 Test Loss: 0.1727843
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.1841791
	speed: 2.1180s/iter; left time: 2713.2192s
Epoch: 91 cost time: 129.1844379901886
Epoch: 91, Steps: 138 | Train Loss: 0.1790842 Vali Loss: 0.1477000 Test Loss: 0.1727840
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.944182354829475e-06
	iters: 100, epoch: 92 | loss: 0.1854893
	speed: 2.1891s/iter; left time: 2502.1730s
Epoch: 92 cost time: 136.0013782978058
Epoch: 92, Steps: 138 | Train Loss: 0.1790640 Vali Loss: 0.1475593 Test Loss: 0.1727840
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.696973237088e-06
	iters: 100, epoch: 93 | loss: 0.1738763
	speed: 2.2796s/iter; left time: 2291.0368s
Epoch: 93 cost time: 136.42188596725464
Epoch: 93, Steps: 138 | Train Loss: 0.1790067 Vali Loss: 0.1477713 Test Loss: 0.1727840
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.462124575233601e-06
	iters: 100, epoch: 94 | loss: 0.1856506
	speed: 2.2092s/iter; left time: 1915.4155s
Epoch: 94 cost time: 131.03041338920593
Epoch: 94, Steps: 138 | Train Loss: 0.1790584 Vali Loss: 0.1478052 Test Loss: 0.1727842
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.239018346471921e-06
	iters: 100, epoch: 95 | loss: 0.1684117
	speed: 2.1876s/iter; left time: 1594.7458s
Epoch: 95 cost time: 134.1310498714447
Epoch: 95, Steps: 138 | Train Loss: 0.1790876 Vali Loss: 0.1479981 Test Loss: 0.1727843
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.027067429148324e-06
	iters: 100, epoch: 96 | loss: 0.1713851
	speed: 2.1262s/iter; left time: 1256.5809s
Epoch: 96 cost time: 126.00434422492981
Epoch: 96, Steps: 138 | Train Loss: 0.1790401 Vali Loss: 0.1473791 Test Loss: 0.1727843
EarlyStopping counter: 19 out of 20
Updating learning rate to 3.825714057690908e-06
	iters: 100, epoch: 97 | loss: 0.1748119
	speed: 2.0539s/iter; left time: 930.4047s
Epoch: 97 cost time: 119.1283106803894
Epoch: 97, Steps: 138 | Train Loss: 0.1790250 Vali Loss: 0.1477751 Test Loss: 0.1727839
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_360_j336_H10_FITS_custom_ftM_sl360_ll48_pl336_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.170639306306839, mae:0.26446229219436646, rse:0.4111315906047821, corr:[0.45926428 0.46093768 0.46072993 0.46278659 0.4626106  0.463618
 0.46333218 0.46341494 0.46302673 0.46272132 0.46244177 0.4621077
 0.4620621  0.4619122  0.46198267 0.46194327 0.46207067 0.4620017
 0.4620529  0.46186742 0.46176142 0.46188223 0.46183708 0.46221638
 0.46226874 0.4625287  0.46260056 0.46246466 0.46241188 0.4620852
 0.46202284 0.46169767 0.46159846 0.4613951  0.46132836 0.4612999
 0.46130154 0.46135685 0.46136996 0.4614491  0.4614182  0.46148163
 0.46138477 0.4612411  0.46112972 0.4610191  0.46108565 0.461113
 0.46126738 0.46132812 0.46134856 0.461314   0.46107063 0.46105856
 0.46087632 0.4608236  0.46073306 0.46067184 0.46065468 0.46065742
 0.4607277  0.46071947 0.46077007 0.46075535 0.46079767 0.46076494
 0.46069086 0.46050143 0.46028522 0.46026072 0.46018144 0.46023834
 0.46029884 0.4602624  0.4603275  0.46016952 0.46012247 0.45999148
 0.45995992 0.45988575 0.45981392 0.4598315  0.45977908 0.4598065
 0.45981207 0.45985392 0.45983768 0.459846   0.45981964 0.4598046
 0.45982504 0.45975703 0.4597428  0.45974135 0.45976263 0.45983255
 0.45985624 0.45992687 0.45987833 0.45987013 0.45980474 0.4597456
 0.45972887 0.45967406 0.45968395 0.45963478 0.4596388  0.45960543
 0.45962635 0.45960975 0.45963016 0.45961627 0.45961073 0.4596208
 0.45954943 0.45948115 0.45936355 0.4593591  0.45940608 0.4594536
 0.4596296  0.45964998 0.45970604 0.45972103 0.45968232 0.45971096
 0.45966634 0.45970416 0.4596614  0.45970026 0.45965457 0.45964867
 0.4596588  0.45963535 0.45964718 0.45958728 0.45962626 0.4595809
 0.45960334 0.45949924 0.45937538 0.45939612 0.45944914 0.45960853
 0.45994437 0.4601464  0.46024036 0.4602588  0.4603459  0.46032858
 0.46033287 0.4603146  0.4602953  0.46027422 0.46023834 0.46023378
 0.46020034 0.46021742 0.46019936 0.46021116 0.4601788  0.46018228
 0.46017477 0.45995536 0.4598882  0.4597702  0.4597336  0.45964023
 0.4594672  0.4593792  0.4592889  0.4591742  0.4590245  0.45890406
 0.45882857 0.45873523 0.45868078 0.45855367 0.45843226 0.4582732
 0.45819357 0.45807502 0.45799455 0.45789915 0.45776117 0.4576321
 0.45745504 0.45733535 0.45716384 0.45708317 0.4570652  0.45706075
 0.4571264  0.45714235 0.45723322 0.4572     0.45713195 0.45710808
 0.45701456 0.45696113 0.45683756 0.45680174 0.45667118 0.45660496
 0.45657256 0.4565209  0.45650294 0.4564388  0.4564445  0.4563866
 0.45637026 0.4562094  0.45607227 0.45605803 0.45603988 0.45619074
 0.45629123 0.45639846 0.45652136 0.4565178  0.45652106 0.45644563
 0.4564294  0.45634618 0.45630354 0.45624256 0.45614776 0.45610073
 0.45603588 0.45600265 0.4559263  0.45593658 0.4558996  0.45590672
 0.45584846 0.4556884  0.45558268 0.4555111  0.45557752 0.45564955
 0.45575514 0.45588234 0.45595726 0.45598945 0.4559332  0.45590693
 0.45586348 0.4558102  0.45574045 0.45562747 0.45553455 0.45542294
 0.45542917 0.4553351  0.4553202  0.45526674 0.4552621  0.4552806
 0.45525035 0.45534176 0.455281   0.45536757 0.4554421  0.45555195
 0.455678   0.4557211  0.45581532 0.4558028  0.45578703 0.45575362
 0.45564964 0.4555923  0.45546567 0.45536846 0.45518944 0.45512378
 0.45505816 0.4550714  0.4550542  0.45505634 0.45514366 0.45508724
 0.4551983  0.45507982 0.45506522 0.45510584 0.45520142 0.45540783
 0.455566   0.455707   0.45574638 0.45574465 0.4557294  0.45562872
 0.45560327 0.45543334 0.45532852 0.45519984 0.45508766 0.4549926
 0.4549922  0.455036   0.4550124  0.4551443  0.45510328 0.45525777
 0.45522612 0.4552012  0.4551035  0.45516574 0.4553788  0.45557356
 0.45599025 0.45606098 0.4561201  0.45608482 0.45598897 0.45588753
 0.45572093 0.45565107 0.45551386 0.45549965 0.45541158 0.4555181
 0.4555651  0.45566234 0.45582527 0.45574722 0.45589107 0.45554027
 0.45565006 0.45496777 0.4551318  0.45466465 0.4552445  0.45539558]
