Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_90_j96_H6', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_90_j96_H6_FITS_custom_ftM_sl90_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18227
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  97789440.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6262982
	speed: 0.3647s/iter; left time: 5142.6293s
Epoch: 1 cost time: 49.548760652542114
Epoch: 1, Steps: 142 | Train Loss: 0.8404555 Vali Loss: 0.4300410 Test Loss: 0.4943842
Validation loss decreased (inf --> 0.430041).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3549011
	speed: 0.8126s/iter; left time: 11342.5056s
Epoch: 2 cost time: 48.231016635894775
Epoch: 2, Steps: 142 | Train Loss: 0.3871274 Vali Loss: 0.2759296 Test Loss: 0.3139242
Validation loss decreased (0.430041 --> 0.275930).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2785605
	speed: 0.7753s/iter; left time: 10711.7329s
Epoch: 3 cost time: 48.11703014373779
Epoch: 3, Steps: 142 | Train Loss: 0.2846550 Vali Loss: 0.2330459 Test Loss: 0.2637536
Validation loss decreased (0.275930 --> 0.233046).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2507542
	speed: 0.8437s/iter; left time: 11537.1995s
Epoch: 4 cost time: 52.40633010864258
Epoch: 4, Steps: 142 | Train Loss: 0.2535161 Vali Loss: 0.2175135 Test Loss: 0.2454039
Validation loss decreased (0.233046 --> 0.217514).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2430923
	speed: 0.8871s/iter; left time: 12004.9689s
Epoch: 5 cost time: 53.28295636177063
Epoch: 5, Steps: 142 | Train Loss: 0.2405965 Vali Loss: 0.2099530 Test Loss: 0.2362161
Validation loss decreased (0.217514 --> 0.209953).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2319245
	speed: 0.8481s/iter; left time: 11357.4939s
Epoch: 6 cost time: 51.854660749435425
Epoch: 6, Steps: 142 | Train Loss: 0.2333774 Vali Loss: 0.2046199 Test Loss: 0.2305492
Validation loss decreased (0.209953 --> 0.204620).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2473639
	speed: 0.8798s/iter; left time: 11656.9874s
Epoch: 7 cost time: 52.308557748794556
Epoch: 7, Steps: 142 | Train Loss: 0.2286257 Vali Loss: 0.2013561 Test Loss: 0.2266400
Validation loss decreased (0.204620 --> 0.201356).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2221247
	speed: 0.8986s/iter; left time: 11778.4610s
Epoch: 8 cost time: 52.437079668045044
Epoch: 8, Steps: 142 | Train Loss: 0.2252559 Vali Loss: 0.1989145 Test Loss: 0.2237705
Validation loss decreased (0.201356 --> 0.198914).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2205560
	speed: 0.8174s/iter; left time: 10597.0029s
Epoch: 9 cost time: 50.38136601448059
Epoch: 9, Steps: 142 | Train Loss: 0.2227630 Vali Loss: 0.1967394 Test Loss: 0.2215789
Validation loss decreased (0.198914 --> 0.196739).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2209657
	speed: 0.8469s/iter; left time: 10859.2376s
Epoch: 10 cost time: 52.33105111122131
Epoch: 10, Steps: 142 | Train Loss: 0.2208782 Vali Loss: 0.1958616 Test Loss: 0.2198489
Validation loss decreased (0.196739 --> 0.195862).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2172019
	speed: 0.8582s/iter; left time: 10882.4125s
Epoch: 11 cost time: 51.766743183135986
Epoch: 11, Steps: 142 | Train Loss: 0.2192948 Vali Loss: 0.1940458 Test Loss: 0.2184492
Validation loss decreased (0.195862 --> 0.194046).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2190876
	speed: 0.7859s/iter; left time: 9854.6761s
Epoch: 12 cost time: 47.05303621292114
Epoch: 12, Steps: 142 | Train Loss: 0.2180807 Vali Loss: 0.1932652 Test Loss: 0.2172645
Validation loss decreased (0.194046 --> 0.193265).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2178857
	speed: 0.8739s/iter; left time: 10834.3299s
Epoch: 13 cost time: 53.36432147026062
Epoch: 13, Steps: 142 | Train Loss: 0.2170116 Vali Loss: 0.1919295 Test Loss: 0.2162949
Validation loss decreased (0.193265 --> 0.191929).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2205205
	speed: 0.8330s/iter; left time: 10208.3417s
Epoch: 14 cost time: 49.96384119987488
Epoch: 14, Steps: 142 | Train Loss: 0.2161212 Vali Loss: 0.1916717 Test Loss: 0.2154623
Validation loss decreased (0.191929 --> 0.191672).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2041513
	speed: 0.9093s/iter; left time: 11014.4634s
Epoch: 15 cost time: 56.218491315841675
Epoch: 15, Steps: 142 | Train Loss: 0.2153661 Vali Loss: 0.1910881 Test Loss: 0.2147281
Validation loss decreased (0.191672 --> 0.191088).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2161700
	speed: 0.8793s/iter; left time: 10526.1968s
Epoch: 16 cost time: 49.85071516036987
Epoch: 16, Steps: 142 | Train Loss: 0.2146541 Vali Loss: 0.1905401 Test Loss: 0.2141048
Validation loss decreased (0.191088 --> 0.190540).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2254906
	speed: 0.8336s/iter; left time: 9860.8233s
Epoch: 17 cost time: 53.514867067337036
Epoch: 17, Steps: 142 | Train Loss: 0.2141214 Vali Loss: 0.1894586 Test Loss: 0.2135258
Validation loss decreased (0.190540 --> 0.189459).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2184390
	speed: 0.8512s/iter; left time: 9948.1324s
Epoch: 18 cost time: 48.29337430000305
Epoch: 18, Steps: 142 | Train Loss: 0.2135345 Vali Loss: 0.1896911 Test Loss: 0.2130519
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2153361
	speed: 0.8645s/iter; left time: 9980.4011s
Epoch: 19 cost time: 51.933688163757324
Epoch: 19, Steps: 142 | Train Loss: 0.2131557 Vali Loss: 0.1891171 Test Loss: 0.2126096
Validation loss decreased (0.189459 --> 0.189117).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2085694
	speed: 0.8369s/iter; left time: 9542.6931s
Epoch: 20 cost time: 51.618616342544556
Epoch: 20, Steps: 142 | Train Loss: 0.2127305 Vali Loss: 0.1891211 Test Loss: 0.2122197
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2150364
	speed: 0.8230s/iter; left time: 9267.9105s
Epoch: 21 cost time: 50.62997388839722
Epoch: 21, Steps: 142 | Train Loss: 0.2123893 Vali Loss: 0.1885404 Test Loss: 0.2118769
Validation loss decreased (0.189117 --> 0.188540).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2118091
	speed: 0.9316s/iter; left time: 10358.9196s
Epoch: 22 cost time: 55.40347170829773
Epoch: 22, Steps: 142 | Train Loss: 0.2121325 Vali Loss: 0.1882963 Test Loss: 0.2115704
Validation loss decreased (0.188540 --> 0.188296).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2131411
	speed: 0.8606s/iter; left time: 9446.7910s
Epoch: 23 cost time: 54.55006814002991
Epoch: 23, Steps: 142 | Train Loss: 0.2117012 Vali Loss: 0.1882440 Test Loss: 0.2112981
Validation loss decreased (0.188296 --> 0.188244).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2102204
	speed: 0.9455s/iter; left time: 10244.6313s
Epoch: 24 cost time: 54.465319871902466
Epoch: 24, Steps: 142 | Train Loss: 0.2115502 Vali Loss: 0.1881474 Test Loss: 0.2110485
Validation loss decreased (0.188244 --> 0.188147).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2030591
	speed: 0.8516s/iter; left time: 9106.5891s
Epoch: 25 cost time: 52.14830684661865
Epoch: 25, Steps: 142 | Train Loss: 0.2112362 Vali Loss: 0.1875288 Test Loss: 0.2108340
Validation loss decreased (0.188147 --> 0.187529).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2124013
	speed: 0.8523s/iter; left time: 8992.6955s
Epoch: 26 cost time: 50.834153175354004
Epoch: 26, Steps: 142 | Train Loss: 0.2111095 Vali Loss: 0.1873104 Test Loss: 0.2106259
Validation loss decreased (0.187529 --> 0.187310).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2064618
	speed: 0.8362s/iter; left time: 8703.7187s
Epoch: 27 cost time: 47.9931275844574
Epoch: 27, Steps: 142 | Train Loss: 0.2109242 Vali Loss: 0.1872011 Test Loss: 0.2104458
Validation loss decreased (0.187310 --> 0.187201).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2037915
	speed: 0.8056s/iter; left time: 8271.5981s
Epoch: 28 cost time: 52.94787788391113
Epoch: 28, Steps: 142 | Train Loss: 0.2106968 Vali Loss: 0.1871755 Test Loss: 0.2102886
Validation loss decreased (0.187201 --> 0.187176).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2188989
	speed: 0.8850s/iter; left time: 8960.9781s
Epoch: 29 cost time: 49.29019904136658
Epoch: 29, Steps: 142 | Train Loss: 0.2105608 Vali Loss: 0.1869917 Test Loss: 0.2101539
Validation loss decreased (0.187176 --> 0.186992).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1954702
	speed: 0.7830s/iter; left time: 7816.2278s
Epoch: 30 cost time: 50.6085844039917
Epoch: 30, Steps: 142 | Train Loss: 0.2104775 Vali Loss: 0.1871836 Test Loss: 0.2100266
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2063547
	speed: 0.8925s/iter; left time: 8783.4002s
Epoch: 31 cost time: 53.10775327682495
Epoch: 31, Steps: 142 | Train Loss: 0.2103404 Vali Loss: 0.1866780 Test Loss: 0.2099137
Validation loss decreased (0.186992 --> 0.186678).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1992672
	speed: 0.9024s/iter; left time: 8752.6396s
Epoch: 32 cost time: 54.789477586746216
Epoch: 32, Steps: 142 | Train Loss: 0.2102636 Vali Loss: 0.1871006 Test Loss: 0.2098072
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2044581
	speed: 0.7987s/iter; left time: 7632.7255s
Epoch: 33 cost time: 47.449496030807495
Epoch: 33, Steps: 142 | Train Loss: 0.2101445 Vali Loss: 0.1867130 Test Loss: 0.2097158
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2034358
	speed: 0.7933s/iter; left time: 7468.7070s
Epoch: 34 cost time: 45.691202878952026
Epoch: 34, Steps: 142 | Train Loss: 0.2100004 Vali Loss: 0.1867628 Test Loss: 0.2096345
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2056546
	speed: 0.8080s/iter; left time: 7492.3996s
Epoch: 35 cost time: 50.692137718200684
Epoch: 35, Steps: 142 | Train Loss: 0.2099876 Vali Loss: 0.1864838 Test Loss: 0.2095614
Validation loss decreased (0.186678 --> 0.186484).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2161537
	speed: 0.7988s/iter; left time: 7294.0045s
Epoch: 36 cost time: 48.08211898803711
Epoch: 36, Steps: 142 | Train Loss: 0.2098480 Vali Loss: 0.1863053 Test Loss: 0.2095022
Validation loss decreased (0.186484 --> 0.186305).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2198838
	speed: 0.7811s/iter; left time: 7021.3268s
Epoch: 37 cost time: 47.0040717124939
Epoch: 37, Steps: 142 | Train Loss: 0.2098447 Vali Loss: 0.1864128 Test Loss: 0.2094499
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2088019
	speed: 0.7864s/iter; left time: 6957.6794s
Epoch: 38 cost time: 46.666210889816284
Epoch: 38, Steps: 142 | Train Loss: 0.2097523 Vali Loss: 0.1864030 Test Loss: 0.2093950
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2152645
	speed: 0.7610s/iter; left time: 6624.1763s
Epoch: 39 cost time: 47.75563359260559
Epoch: 39, Steps: 142 | Train Loss: 0.2097235 Vali Loss: 0.1865690 Test Loss: 0.2093445
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2148707
	speed: 0.8174s/iter; left time: 6999.2944s
Epoch: 40 cost time: 49.06138777732849
Epoch: 40, Steps: 142 | Train Loss: 0.2096641 Vali Loss: 0.1861198 Test Loss: 0.2093044
Validation loss decreased (0.186305 --> 0.186120).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2200302
	speed: 0.7754s/iter; left time: 6529.6730s
Epoch: 41 cost time: 49.01960849761963
Epoch: 41, Steps: 142 | Train Loss: 0.2096305 Vali Loss: 0.1864423 Test Loss: 0.2092625
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2083543
	speed: 0.8076s/iter; left time: 6686.3546s
Epoch: 42 cost time: 50.869112968444824
Epoch: 42, Steps: 142 | Train Loss: 0.2095933 Vali Loss: 0.1864712 Test Loss: 0.2092417
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2000542
	speed: 0.8264s/iter; left time: 6724.1792s
Epoch: 43 cost time: 48.72191023826599
Epoch: 43, Steps: 142 | Train Loss: 0.2096181 Vali Loss: 0.1860281 Test Loss: 0.2092009
Validation loss decreased (0.186120 --> 0.186028).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2107867
	speed: 0.8543s/iter; left time: 6829.9239s
Epoch: 44 cost time: 53.91389226913452
Epoch: 44, Steps: 142 | Train Loss: 0.2095915 Vali Loss: 0.1863996 Test Loss: 0.2091784
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2005792
	speed: 0.8383s/iter; left time: 6582.8790s
Epoch: 45 cost time: 54.98211359977722
Epoch: 45, Steps: 142 | Train Loss: 0.2095125 Vali Loss: 0.1865415 Test Loss: 0.2091549
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2184376
	speed: 0.9571s/iter; left time: 7379.9662s
Epoch: 46 cost time: 60.059096813201904
Epoch: 46, Steps: 142 | Train Loss: 0.2095226 Vali Loss: 0.1859924 Test Loss: 0.2091312
Validation loss decreased (0.186028 --> 0.185992).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2135115
	speed: 0.9982s/iter; left time: 7555.2234s
Epoch: 47 cost time: 59.25546050071716
Epoch: 47, Steps: 142 | Train Loss: 0.2095171 Vali Loss: 0.1862980 Test Loss: 0.2091134
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2071633
	speed: 0.9622s/iter; left time: 7146.4611s
Epoch: 48 cost time: 58.0294885635376
Epoch: 48, Steps: 142 | Train Loss: 0.2094991 Vali Loss: 0.1861181 Test Loss: 0.2090997
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2082942
	speed: 0.9921s/iter; left time: 7227.5311s
Epoch: 49 cost time: 60.00688982009888
Epoch: 49, Steps: 142 | Train Loss: 0.2095040 Vali Loss: 0.1859819 Test Loss: 0.2090809
Validation loss decreased (0.185992 --> 0.185982).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2063522
	speed: 0.9765s/iter; left time: 6975.4109s
Epoch: 50 cost time: 59.27984428405762
Epoch: 50, Steps: 142 | Train Loss: 0.2094490 Vali Loss: 0.1862577 Test Loss: 0.2090722
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2052845
	speed: 0.9844s/iter; left time: 6891.6388s
Epoch: 51 cost time: 61.75615954399109
Epoch: 51, Steps: 142 | Train Loss: 0.2093849 Vali Loss: 0.1862530 Test Loss: 0.2090615
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2120380
	speed: 0.9783s/iter; left time: 6710.0227s
Epoch: 52 cost time: 59.12703037261963
Epoch: 52, Steps: 142 | Train Loss: 0.2093949 Vali Loss: 0.1861152 Test Loss: 0.2090488
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2139351
	speed: 0.9461s/iter; left time: 6355.1766s
Epoch: 53 cost time: 54.61530518531799
Epoch: 53, Steps: 142 | Train Loss: 0.2094660 Vali Loss: 0.1861997 Test Loss: 0.2090445
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2115387
	speed: 0.8336s/iter; left time: 5480.6637s
Epoch: 54 cost time: 48.128904819488525
Epoch: 54, Steps: 142 | Train Loss: 0.2093993 Vali Loss: 0.1861474 Test Loss: 0.2090329
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2102374
	speed: 0.7991s/iter; left time: 5140.7035s
Epoch: 55 cost time: 51.90473008155823
Epoch: 55, Steps: 142 | Train Loss: 0.2093668 Vali Loss: 0.1861945 Test Loss: 0.2090222
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2067090
	speed: 0.8984s/iter; left time: 5652.0161s
Epoch: 56 cost time: 53.07294416427612
Epoch: 56, Steps: 142 | Train Loss: 0.2094116 Vali Loss: 0.1862119 Test Loss: 0.2090149
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1978507
	speed: 0.8944s/iter; left time: 5499.9349s
Epoch: 57 cost time: 53.47473907470703
Epoch: 57, Steps: 142 | Train Loss: 0.2093740 Vali Loss: 0.1858703 Test Loss: 0.2090079
Validation loss decreased (0.185982 --> 0.185870).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2083298
	speed: 0.8042s/iter; left time: 4830.8971s
Epoch: 58 cost time: 49.02700233459473
Epoch: 58, Steps: 142 | Train Loss: 0.2093874 Vali Loss: 0.1862478 Test Loss: 0.2090033
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2159853
	speed: 0.7797s/iter; left time: 4572.8642s
Epoch: 59 cost time: 45.25431299209595
Epoch: 59, Steps: 142 | Train Loss: 0.2093410 Vali Loss: 0.1862450 Test Loss: 0.2089965
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.2073175
	speed: 0.7755s/iter; left time: 4437.9445s
Epoch: 60 cost time: 47.969085931777954
Epoch: 60, Steps: 142 | Train Loss: 0.2093174 Vali Loss: 0.1857281 Test Loss: 0.2089908
Validation loss decreased (0.185870 --> 0.185728).  Saving model ...
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1994854
	speed: 0.7657s/iter; left time: 4273.5507s
Epoch: 61 cost time: 48.01631951332092
Epoch: 61, Steps: 142 | Train Loss: 0.2092896 Vali Loss: 0.1860140 Test Loss: 0.2089884
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2335719
	speed: 0.8247s/iter; left time: 4485.2924s
Epoch: 62 cost time: 49.52838325500488
Epoch: 62, Steps: 142 | Train Loss: 0.2093933 Vali Loss: 0.1862318 Test Loss: 0.2089838
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2131050
	speed: 0.7754s/iter; left time: 4107.5210s
Epoch: 63 cost time: 46.652867555618286
Epoch: 63, Steps: 142 | Train Loss: 0.2093656 Vali Loss: 0.1860479 Test Loss: 0.2089809
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2024500
	speed: 0.8210s/iter; left time: 4232.2088s
Epoch: 64 cost time: 50.20368218421936
Epoch: 64, Steps: 142 | Train Loss: 0.2093244 Vali Loss: 0.1862284 Test Loss: 0.2089750
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2212471
	speed: 0.8059s/iter; left time: 4039.8977s
Epoch: 65 cost time: 48.05589175224304
Epoch: 65, Steps: 142 | Train Loss: 0.2093126 Vali Loss: 0.1860667 Test Loss: 0.2089706
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2151558
	speed: 0.7826s/iter; left time: 3811.8523s
Epoch: 66 cost time: 46.8982880115509
Epoch: 66, Steps: 142 | Train Loss: 0.2093377 Vali Loss: 0.1863900 Test Loss: 0.2089698
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2254821
	speed: 0.8253s/iter; left time: 3902.7534s
Epoch: 67 cost time: 49.597574949264526
Epoch: 67, Steps: 142 | Train Loss: 0.2093470 Vali Loss: 0.1862218 Test Loss: 0.2089667
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1976941
	speed: 0.7680s/iter; left time: 3522.7707s
Epoch: 68 cost time: 46.81481623649597
Epoch: 68, Steps: 142 | Train Loss: 0.2093461 Vali Loss: 0.1860439 Test Loss: 0.2089658
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2178654
	speed: 0.8070s/iter; left time: 3587.3122s
Epoch: 69 cost time: 49.889578342437744
Epoch: 69, Steps: 142 | Train Loss: 0.2093330 Vali Loss: 0.1858520 Test Loss: 0.2089633
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2142711
	speed: 0.8684s/iter; left time: 3736.6190s
Epoch: 70 cost time: 53.19926929473877
Epoch: 70, Steps: 142 | Train Loss: 0.2092800 Vali Loss: 0.1861085 Test Loss: 0.2089591
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2119270
	speed: 0.8311s/iter; left time: 3458.3055s
Epoch: 71 cost time: 49.75344204902649
Epoch: 71, Steps: 142 | Train Loss: 0.2093635 Vali Loss: 0.1864273 Test Loss: 0.2089570
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2009958
	speed: 0.8283s/iter; left time: 3328.9406s
Epoch: 72 cost time: 48.64545440673828
Epoch: 72, Steps: 142 | Train Loss: 0.2092666 Vali Loss: 0.1865326 Test Loss: 0.2089540
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1960524
	speed: 0.7914s/iter; left time: 3068.3321s
Epoch: 73 cost time: 49.14759826660156
Epoch: 73, Steps: 142 | Train Loss: 0.2093308 Vali Loss: 0.1858275 Test Loss: 0.2089528
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1981616
	speed: 0.7794s/iter; left time: 2911.2451s
Epoch: 74 cost time: 47.34911870956421
Epoch: 74, Steps: 142 | Train Loss: 0.2092667 Vali Loss: 0.1858687 Test Loss: 0.2089532
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2046254
	speed: 0.7992s/iter; left time: 2871.6679s
Epoch: 75 cost time: 49.255794048309326
Epoch: 75, Steps: 142 | Train Loss: 0.2092701 Vali Loss: 0.1861722 Test Loss: 0.2089519
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.2117198
	speed: 0.7899s/iter; left time: 2726.0914s
Epoch: 76 cost time: 48.8943407535553
Epoch: 76, Steps: 142 | Train Loss: 0.2092867 Vali Loss: 0.1862185 Test Loss: 0.2089509
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2003992
	speed: 0.7907s/iter; left time: 2616.4923s
Epoch: 77 cost time: 47.38587164878845
Epoch: 77, Steps: 142 | Train Loss: 0.2093333 Vali Loss: 0.1861654 Test Loss: 0.2089470
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2185615
	speed: 0.7804s/iter; left time: 2471.3888s
Epoch: 78 cost time: 46.21057081222534
Epoch: 78, Steps: 142 | Train Loss: 0.2093565 Vali Loss: 0.1862617 Test Loss: 0.2089455
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.2169941
	speed: 0.7771s/iter; left time: 2350.8708s
Epoch: 79 cost time: 49.31973886489868
Epoch: 79, Steps: 142 | Train Loss: 0.2092927 Vali Loss: 0.1861904 Test Loss: 0.2089463
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1990311
	speed: 0.7536s/iter; left time: 2172.5419s
Epoch: 80 cost time: 45.25029158592224
Epoch: 80, Steps: 142 | Train Loss: 0.2093590 Vali Loss: 0.1858116 Test Loss: 0.2089442
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_90_j96_H6_FITS_custom_ftM_sl90_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.5800361633300781, mae:0.603005051612854, rse:0.7569573521614075, corr:[0.3692052  0.31942397 0.22809264 0.14349324 0.24318345 0.28533676
 0.3167364  0.359693   0.35270435 0.3435749  0.3220342  0.30237368
 0.29895926 0.32518557 0.35089985 0.34015155 0.33792004 0.33474314
 0.3151411  0.3342478  0.35087135 0.36092076 0.3542557  0.3354661
 0.29786965 0.25449154 0.27568796 0.21482676 0.15855737 0.2711459
 0.31798157 0.32654083 0.3385859  0.34780806 0.3610371  0.3627197
 0.3627825  0.34999225 0.33449915 0.32985944 0.30309957 0.3055807
 0.34375018 0.36188453 0.34976855 0.3414284  0.35030615 0.34192413
 0.31504115 0.24931665 0.20292129 0.2496321  0.23158918 0.26116908
 0.33869925 0.36210325 0.37407956 0.39490196 0.40128303 0.3994061
 0.39121944 0.36711615 0.33794934 0.35741103 0.37752667 0.37614644
 0.3808019  0.39007545 0.38339987 0.3862433  0.38610396 0.36921313
 0.35070288 0.37783122 0.37997076 0.35087204 0.34561306 0.37203884
 0.40862072 0.43264443 0.42415154 0.41034332 0.42176756 0.42419767
 0.417487   0.4123003  0.4208686  0.42014742 0.41364777 0.41024172
 0.39208284 0.4067977  0.41479823 0.4075555  0.42527762 0.4130031 ]
