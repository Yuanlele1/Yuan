Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_180_j192_H4', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_180_j192_H4_FITS_custom_ftM_sl180_ll48_pl192_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18041
val 2441
test 5069
Model(
  (freq_upsampler): Linear(in_features=42, out_features=86, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  148409856.0
params:  3698.0
Trainable parameters:  3698
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4369818
	speed: 0.5886s/iter; left time: 8181.8799s
Epoch: 1 cost time: 82.6553566455841
Epoch: 1, Steps: 140 | Train Loss: 0.6184354 Vali Loss: 0.3211758 Test Loss: 0.3466780
Validation loss decreased (inf --> 0.321176).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2674326
	speed: 1.2072s/iter; left time: 16612.7811s
Epoch: 2 cost time: 68.8208167552948
Epoch: 2, Steps: 140 | Train Loss: 0.3044251 Vali Loss: 0.2340799 Test Loss: 0.2578051
Validation loss decreased (0.321176 --> 0.234080).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2367108
	speed: 1.1201s/iter; left time: 15256.3159s
Epoch: 3 cost time: 70.46564888954163
Epoch: 3, Steps: 140 | Train Loss: 0.2452358 Vali Loss: 0.1996858 Test Loss: 0.2253392
Validation loss decreased (0.234080 --> 0.199686).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2155858
	speed: 1.1603s/iter; left time: 15641.4967s
Epoch: 4 cost time: 66.84465765953064
Epoch: 4, Steps: 140 | Train Loss: 0.2173374 Vali Loss: 0.1809266 Test Loss: 0.2077200
Validation loss decreased (0.199686 --> 0.180927).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2122357
	speed: 1.1234s/iter; left time: 14987.2487s
Epoch: 5 cost time: 68.82966566085815
Epoch: 5, Steps: 140 | Train Loss: 0.2015794 Vali Loss: 0.1701240 Test Loss: 0.1975665
Validation loss decreased (0.180927 --> 0.170124).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1919969
	speed: 1.1571s/iter; left time: 15275.3877s
Epoch: 6 cost time: 70.45907020568848
Epoch: 6, Steps: 140 | Train Loss: 0.1924562 Vali Loss: 0.1636908 Test Loss: 0.1915184
Validation loss decreased (0.170124 --> 0.163691).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1859209
	speed: 1.1816s/iter; left time: 15432.4807s
Epoch: 7 cost time: 71.97768688201904
Epoch: 7, Steps: 140 | Train Loss: 0.1870354 Vali Loss: 0.1599026 Test Loss: 0.1878834
Validation loss decreased (0.163691 --> 0.159903).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1770215
	speed: 1.1779s/iter; left time: 15219.1209s
Epoch: 8 cost time: 69.15043258666992
Epoch: 8, Steps: 140 | Train Loss: 0.1837313 Vali Loss: 0.1576862 Test Loss: 0.1856024
Validation loss decreased (0.159903 --> 0.157686).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1688274
	speed: 1.0852s/iter; left time: 13870.2254s
Epoch: 9 cost time: 63.507787227630615
Epoch: 9, Steps: 140 | Train Loss: 0.1816963 Vali Loss: 0.1561758 Test Loss: 0.1841540
Validation loss decreased (0.157686 --> 0.156176).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1874426
	speed: 1.0801s/iter; left time: 13653.6000s
Epoch: 10 cost time: 65.52752161026001
Epoch: 10, Steps: 140 | Train Loss: 0.1804056 Vali Loss: 0.1552158 Test Loss: 0.1831698
Validation loss decreased (0.156176 --> 0.155216).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1797723
	speed: 1.1042s/iter; left time: 13804.0072s
Epoch: 11 cost time: 66.48443388938904
Epoch: 11, Steps: 140 | Train Loss: 0.1795707 Vali Loss: 0.1546173 Test Loss: 0.1824972
Validation loss decreased (0.155216 --> 0.154617).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1876911
	speed: 1.1267s/iter; left time: 13927.2239s
Epoch: 12 cost time: 66.63099360466003
Epoch: 12, Steps: 140 | Train Loss: 0.1788678 Vali Loss: 0.1541239 Test Loss: 0.1820117
Validation loss decreased (0.154617 --> 0.154124).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1742977
	speed: 1.1071s/iter; left time: 13530.0626s
Epoch: 13 cost time: 69.61280393600464
Epoch: 13, Steps: 140 | Train Loss: 0.1784811 Vali Loss: 0.1537656 Test Loss: 0.1816435
Validation loss decreased (0.154124 --> 0.153766).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1796213
	speed: 1.1232s/iter; left time: 13569.1167s
Epoch: 14 cost time: 66.26328945159912
Epoch: 14, Steps: 140 | Train Loss: 0.1781080 Vali Loss: 0.1534950 Test Loss: 0.1813835
Validation loss decreased (0.153766 --> 0.153495).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1821140
	speed: 1.0764s/iter; left time: 12853.8491s
Epoch: 15 cost time: 67.55938410758972
Epoch: 15, Steps: 140 | Train Loss: 0.1777630 Vali Loss: 0.1532670 Test Loss: 0.1811453
Validation loss decreased (0.153495 --> 0.153267).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1724635
	speed: 1.2134s/iter; left time: 14318.7897s
Epoch: 16 cost time: 75.0639488697052
Epoch: 16, Steps: 140 | Train Loss: 0.1776470 Vali Loss: 0.1530883 Test Loss: 0.1809596
Validation loss decreased (0.153267 --> 0.153088).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1775046
	speed: 1.4270s/iter; left time: 16640.7369s
Epoch: 17 cost time: 85.13719534873962
Epoch: 17, Steps: 140 | Train Loss: 0.1774090 Vali Loss: 0.1528852 Test Loss: 0.1808236
Validation loss decreased (0.153088 --> 0.152885).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1840480
	speed: 1.4424s/iter; left time: 16618.0679s
Epoch: 18 cost time: 90.5945553779602
Epoch: 18, Steps: 140 | Train Loss: 0.1772725 Vali Loss: 0.1527684 Test Loss: 0.1807275
Validation loss decreased (0.152885 --> 0.152768).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1667060
	speed: 1.4839s/iter; left time: 16888.0712s
Epoch: 19 cost time: 87.6827781200409
Epoch: 19, Steps: 140 | Train Loss: 0.1771135 Vali Loss: 0.1526450 Test Loss: 0.1806155
Validation loss decreased (0.152768 --> 0.152645).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1733231
	speed: 1.4584s/iter; left time: 16393.7590s
Epoch: 20 cost time: 88.83281588554382
Epoch: 20, Steps: 140 | Train Loss: 0.1770302 Vali Loss: 0.1524893 Test Loss: 0.1805658
Validation loss decreased (0.152645 --> 0.152489).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1787524
	speed: 1.4889s/iter; left time: 16528.5131s
Epoch: 21 cost time: 88.93812704086304
Epoch: 21, Steps: 140 | Train Loss: 0.1769272 Vali Loss: 0.1525604 Test Loss: 0.1804716
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1800081
	speed: 1.3894s/iter; left time: 15229.2999s
Epoch: 22 cost time: 77.3817298412323
Epoch: 22, Steps: 140 | Train Loss: 0.1769825 Vali Loss: 0.1524339 Test Loss: 0.1804194
Validation loss decreased (0.152489 --> 0.152434).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1865964
	speed: 1.2831s/iter; left time: 13884.2428s
Epoch: 23 cost time: 76.42480301856995
Epoch: 23, Steps: 140 | Train Loss: 0.1770051 Vali Loss: 0.1523846 Test Loss: 0.1803576
Validation loss decreased (0.152434 --> 0.152385).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1813368
	speed: 1.2686s/iter; left time: 13549.4585s
Epoch: 24 cost time: 75.0286500453949
Epoch: 24, Steps: 140 | Train Loss: 0.1768413 Vali Loss: 0.1523813 Test Loss: 0.1803322
Validation loss decreased (0.152385 --> 0.152381).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1864574
	speed: 1.2390s/iter; left time: 13060.2653s
Epoch: 25 cost time: 75.90519046783447
Epoch: 25, Steps: 140 | Train Loss: 0.1768158 Vali Loss: 0.1524131 Test Loss: 0.1802895
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1741224
	speed: 1.3168s/iter; left time: 13696.2067s
Epoch: 26 cost time: 76.61865091323853
Epoch: 26, Steps: 140 | Train Loss: 0.1767379 Vali Loss: 0.1523209 Test Loss: 0.1802647
Validation loss decreased (0.152381 --> 0.152321).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1774084
	speed: 1.2906s/iter; left time: 13242.7128s
Epoch: 27 cost time: 78.88327050209045
Epoch: 27, Steps: 140 | Train Loss: 0.1767525 Vali Loss: 0.1522595 Test Loss: 0.1802382
Validation loss decreased (0.152321 --> 0.152260).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1729883
	speed: 1.2814s/iter; left time: 12969.2649s
Epoch: 28 cost time: 82.03329277038574
Epoch: 28, Steps: 140 | Train Loss: 0.1767126 Vali Loss: 0.1521747 Test Loss: 0.1802142
Validation loss decreased (0.152260 --> 0.152175).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1792799
	speed: 1.4546s/iter; left time: 14518.5747s
Epoch: 29 cost time: 89.01476788520813
Epoch: 29, Steps: 140 | Train Loss: 0.1766732 Vali Loss: 0.1521743 Test Loss: 0.1801867
Validation loss decreased (0.152175 --> 0.152174).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2011588
	speed: 1.3565s/iter; left time: 13348.9194s
Epoch: 30 cost time: 76.06319236755371
Epoch: 30, Steps: 140 | Train Loss: 0.1765501 Vali Loss: 0.1522455 Test Loss: 0.1801657
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1631295
	speed: 1.2180s/iter; left time: 11816.0401s
Epoch: 31 cost time: 75.47538375854492
Epoch: 31, Steps: 140 | Train Loss: 0.1766362 Vali Loss: 0.1521392 Test Loss: 0.1801534
Validation loss decreased (0.152174 --> 0.152139).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1831220
	speed: 1.2069s/iter; left time: 11539.5514s
Epoch: 32 cost time: 68.7671287059784
Epoch: 32, Steps: 140 | Train Loss: 0.1765591 Vali Loss: 0.1521927 Test Loss: 0.1801278
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1763250
	speed: 1.2130s/iter; left time: 11427.6683s
Epoch: 33 cost time: 73.97490096092224
Epoch: 33, Steps: 140 | Train Loss: 0.1766450 Vali Loss: 0.1521531 Test Loss: 0.1801141
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1815975
	speed: 1.1920s/iter; left time: 11062.9500s
Epoch: 34 cost time: 70.65826678276062
Epoch: 34, Steps: 140 | Train Loss: 0.1765890 Vali Loss: 0.1521534 Test Loss: 0.1801022
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1783892
	speed: 1.0861s/iter; left time: 9927.7006s
Epoch: 35 cost time: 60.08296227455139
Epoch: 35, Steps: 140 | Train Loss: 0.1765120 Vali Loss: 0.1521000 Test Loss: 0.1800896
Validation loss decreased (0.152139 --> 0.152100).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1801682
	speed: 1.0264s/iter; left time: 9238.6414s
Epoch: 36 cost time: 62.5000205039978
Epoch: 36, Steps: 140 | Train Loss: 0.1765705 Vali Loss: 0.1521218 Test Loss: 0.1800842
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1681425
	speed: 1.0155s/iter; left time: 8998.3129s
Epoch: 37 cost time: 60.51214385032654
Epoch: 37, Steps: 140 | Train Loss: 0.1765724 Vali Loss: 0.1520514 Test Loss: 0.1800772
Validation loss decreased (0.152100 --> 0.152051).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1762422
	speed: 1.0114s/iter; left time: 8820.2920s
Epoch: 38 cost time: 62.18791317939758
Epoch: 38, Steps: 140 | Train Loss: 0.1765035 Vali Loss: 0.1519954 Test Loss: 0.1800716
Validation loss decreased (0.152051 --> 0.151995).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1756730
	speed: 0.9983s/iter; left time: 8566.1387s
Epoch: 39 cost time: 55.643128395080566
Epoch: 39, Steps: 140 | Train Loss: 0.1765626 Vali Loss: 0.1520172 Test Loss: 0.1800592
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1871879
	speed: 0.9942s/iter; left time: 8391.8827s
Epoch: 40 cost time: 62.12754511833191
Epoch: 40, Steps: 140 | Train Loss: 0.1765519 Vali Loss: 0.1520275 Test Loss: 0.1800475
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1793665
	speed: 0.9701s/iter; left time: 8052.6874s
Epoch: 41 cost time: 58.565428018569946
Epoch: 41, Steps: 140 | Train Loss: 0.1765321 Vali Loss: 0.1520538 Test Loss: 0.1800443
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1797373
	speed: 0.9906s/iter; left time: 8084.2602s
Epoch: 42 cost time: 62.091280460357666
Epoch: 42, Steps: 140 | Train Loss: 0.1764998 Vali Loss: 0.1519939 Test Loss: 0.1800348
Validation loss decreased (0.151995 --> 0.151994).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1678335
	speed: 0.9938s/iter; left time: 7971.6527s
Epoch: 43 cost time: 56.594433546066284
Epoch: 43, Steps: 140 | Train Loss: 0.1764361 Vali Loss: 0.1520076 Test Loss: 0.1800351
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1833644
	speed: 0.9818s/iter; left time: 7737.6480s
Epoch: 44 cost time: 60.84475588798523
Epoch: 44, Steps: 140 | Train Loss: 0.1765483 Vali Loss: 0.1520524 Test Loss: 0.1800226
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1749425
	speed: 1.0234s/iter; left time: 7922.4691s
Epoch: 45 cost time: 59.87103796005249
Epoch: 45, Steps: 140 | Train Loss: 0.1764402 Vali Loss: 0.1519827 Test Loss: 0.1800183
Validation loss decreased (0.151994 --> 0.151983).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1648971
	speed: 1.0018s/iter; left time: 7614.4869s
Epoch: 46 cost time: 60.51572799682617
Epoch: 46, Steps: 140 | Train Loss: 0.1764647 Vali Loss: 0.1519903 Test Loss: 0.1800191
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1874142
	speed: 1.0280s/iter; left time: 7670.1228s
Epoch: 47 cost time: 57.98634147644043
Epoch: 47, Steps: 140 | Train Loss: 0.1764404 Vali Loss: 0.1520285 Test Loss: 0.1800081
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1751075
	speed: 1.0057s/iter; left time: 7362.9469s
Epoch: 48 cost time: 61.25164818763733
Epoch: 48, Steps: 140 | Train Loss: 0.1764721 Vali Loss: 0.1519402 Test Loss: 0.1800072
Validation loss decreased (0.151983 --> 0.151940).  Saving model ...
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1702840
	speed: 1.0588s/iter; left time: 7603.3549s
Epoch: 49 cost time: 61.97788405418396
Epoch: 49, Steps: 140 | Train Loss: 0.1764797 Vali Loss: 0.1520500 Test Loss: 0.1800033
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1789282
	speed: 0.9625s/iter; left time: 6776.7146s
Epoch: 50 cost time: 59.6348659992218
Epoch: 50, Steps: 140 | Train Loss: 0.1763933 Vali Loss: 0.1519928 Test Loss: 0.1799938
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1806089
	speed: 1.0193s/iter; left time: 7034.5077s
Epoch: 51 cost time: 59.72343468666077
Epoch: 51, Steps: 140 | Train Loss: 0.1764802 Vali Loss: 0.1519848 Test Loss: 0.1799991
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1780584
	speed: 0.9839s/iter; left time: 6652.0442s
Epoch: 52 cost time: 59.1605179309845
Epoch: 52, Steps: 140 | Train Loss: 0.1764755 Vali Loss: 0.1520058 Test Loss: 0.1799918
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1742225
	speed: 1.0050s/iter; left time: 6654.2106s
Epoch: 53 cost time: 60.73066306114197
Epoch: 53, Steps: 140 | Train Loss: 0.1764895 Vali Loss: 0.1519753 Test Loss: 0.1799867
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1696286
	speed: 0.9690s/iter; left time: 6280.0945s
Epoch: 54 cost time: 59.349942684173584
Epoch: 54, Steps: 140 | Train Loss: 0.1765382 Vali Loss: 0.1518968 Test Loss: 0.1799848
Validation loss decreased (0.151940 --> 0.151897).  Saving model ...
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1757910
	speed: 1.0178s/iter; left time: 6453.7611s
Epoch: 55 cost time: 58.15362620353699
Epoch: 55, Steps: 140 | Train Loss: 0.1764685 Vali Loss: 0.1519184 Test Loss: 0.1799893
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1791994
	speed: 0.9983s/iter; left time: 6190.3283s
Epoch: 56 cost time: 59.97189378738403
Epoch: 56, Steps: 140 | Train Loss: 0.1764097 Vali Loss: 0.1520197 Test Loss: 0.1799782
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1693342
	speed: 1.0174s/iter; left time: 6166.4076s
Epoch: 57 cost time: 61.33807349205017
Epoch: 57, Steps: 140 | Train Loss: 0.1764389 Vali Loss: 0.1519570 Test Loss: 0.1799779
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1772440
	speed: 1.0716s/iter; left time: 6345.0849s
Epoch: 58 cost time: 68.7653911113739
Epoch: 58, Steps: 140 | Train Loss: 0.1763947 Vali Loss: 0.1519354 Test Loss: 0.1799783
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1691893
	speed: 1.0526s/iter; left time: 6085.2353s
Epoch: 59 cost time: 61.75661873817444
Epoch: 59, Steps: 140 | Train Loss: 0.1765141 Vali Loss: 0.1519718 Test Loss: 0.1799769
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1658067
	speed: 1.1179s/iter; left time: 6306.1945s
Epoch: 60 cost time: 67.36422824859619
Epoch: 60, Steps: 140 | Train Loss: 0.1764021 Vali Loss: 0.1519232 Test Loss: 0.1799739
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1708884
	speed: 1.1177s/iter; left time: 6148.6243s
Epoch: 61 cost time: 67.166170835495
Epoch: 61, Steps: 140 | Train Loss: 0.1764257 Vali Loss: 0.1520480 Test Loss: 0.1799736
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1659815
	speed: 1.0624s/iter; left time: 5695.5646s
Epoch: 62 cost time: 61.29156827926636
Epoch: 62, Steps: 140 | Train Loss: 0.1764587 Vali Loss: 0.1520332 Test Loss: 0.1799687
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1766086
	speed: 1.0382s/iter; left time: 5420.5550s
Epoch: 63 cost time: 64.56445670127869
Epoch: 63, Steps: 140 | Train Loss: 0.1764609 Vali Loss: 0.1519339 Test Loss: 0.1799677
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1772174
	speed: 1.0378s/iter; left time: 5273.0885s
Epoch: 64 cost time: 59.75874876976013
Epoch: 64, Steps: 140 | Train Loss: 0.1763813 Vali Loss: 0.1519267 Test Loss: 0.1799653
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1629843
	speed: 1.0221s/iter; left time: 5050.0186s
Epoch: 65 cost time: 63.38548707962036
Epoch: 65, Steps: 140 | Train Loss: 0.1764554 Vali Loss: 0.1519648 Test Loss: 0.1799655
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1769325
	speed: 1.0645s/iter; left time: 5110.8378s
Epoch: 66 cost time: 62.32695937156677
Epoch: 66, Steps: 140 | Train Loss: 0.1764763 Vali Loss: 0.1520526 Test Loss: 0.1799640
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1769211
	speed: 0.9875s/iter; left time: 4602.8593s
Epoch: 67 cost time: 59.12653613090515
Epoch: 67, Steps: 140 | Train Loss: 0.1763439 Vali Loss: 0.1519599 Test Loss: 0.1799623
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1757964
	speed: 0.9527s/iter; left time: 4307.2257s
Epoch: 68 cost time: 58.56562948226929
Epoch: 68, Steps: 140 | Train Loss: 0.1764884 Vali Loss: 0.1519406 Test Loss: 0.1799614
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1734776
	speed: 0.9475s/iter; left time: 4151.0658s
Epoch: 69 cost time: 54.46299695968628
Epoch: 69, Steps: 140 | Train Loss: 0.1764820 Vali Loss: 0.1518861 Test Loss: 0.1799630
Validation loss decreased (0.151897 --> 0.151886).  Saving model ...
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1868771
	speed: 0.9521s/iter; left time: 4037.7711s
Epoch: 70 cost time: 58.63851594924927
Epoch: 70, Steps: 140 | Train Loss: 0.1764559 Vali Loss: 0.1519289 Test Loss: 0.1799574
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1593774
	speed: 0.9952s/iter; left time: 4081.4164s
Epoch: 71 cost time: 59.57707166671753
Epoch: 71, Steps: 140 | Train Loss: 0.1764901 Vali Loss: 0.1518825 Test Loss: 0.1799586
Validation loss decreased (0.151886 --> 0.151883).  Saving model ...
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1797727
	speed: 0.9655s/iter; left time: 3824.2617s
Epoch: 72 cost time: 53.86017036437988
Epoch: 72, Steps: 140 | Train Loss: 0.1764125 Vali Loss: 0.1519836 Test Loss: 0.1799582
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1693459
	speed: 0.8409s/iter; left time: 3212.9459s
Epoch: 73 cost time: 48.89751887321472
Epoch: 73, Steps: 140 | Train Loss: 0.1764287 Vali Loss: 0.1519531 Test Loss: 0.1799562
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1735440
	speed: 0.7679s/iter; left time: 2826.4683s
Epoch: 74 cost time: 45.33064866065979
Epoch: 74, Steps: 140 | Train Loss: 0.1762931 Vali Loss: 0.1519008 Test Loss: 0.1799577
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1773920
	speed: 0.7690s/iter; left time: 2723.1423s
Epoch: 75 cost time: 45.02200746536255
Epoch: 75, Steps: 140 | Train Loss: 0.1764042 Vali Loss: 0.1519334 Test Loss: 0.1799551
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1723803
	speed: 0.7594s/iter; left time: 2582.7136s
Epoch: 76 cost time: 45.63774085044861
Epoch: 76, Steps: 140 | Train Loss: 0.1764103 Vali Loss: 0.1520037 Test Loss: 0.1799542
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1787034
	speed: 0.7706s/iter; left time: 2512.8242s
Epoch: 77 cost time: 45.507848501205444
Epoch: 77, Steps: 140 | Train Loss: 0.1764144 Vali Loss: 0.1520040 Test Loss: 0.1799537
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1780052
	speed: 0.7378s/iter; left time: 2302.6692s
Epoch: 78 cost time: 46.04854106903076
Epoch: 78, Steps: 140 | Train Loss: 0.1764308 Vali Loss: 0.1519680 Test Loss: 0.1799532
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1871317
	speed: 0.7609s/iter; left time: 2268.3023s
Epoch: 79 cost time: 42.24879026412964
Epoch: 79, Steps: 140 | Train Loss: 0.1764351 Vali Loss: 0.1519527 Test Loss: 0.1799536
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1828523
	speed: 0.7491s/iter; left time: 2128.2702s
Epoch: 80 cost time: 46.334864139556885
Epoch: 80, Steps: 140 | Train Loss: 0.1763953 Vali Loss: 0.1518889 Test Loss: 0.1799529
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.1689247
	speed: 0.7410s/iter; left time: 2001.3097s
Epoch: 81 cost time: 44.771249294281006
Epoch: 81, Steps: 140 | Train Loss: 0.1764070 Vali Loss: 0.1519582 Test Loss: 0.1799527
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1790121
	speed: 0.7641s/iter; left time: 1956.7806s
Epoch: 82 cost time: 45.26829767227173
Epoch: 82, Steps: 140 | Train Loss: 0.1763904 Vali Loss: 0.1519196 Test Loss: 0.1799526
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1693819
	speed: 0.7413s/iter; left time: 1794.6249s
Epoch: 83 cost time: 45.76187252998352
Epoch: 83, Steps: 140 | Train Loss: 0.1764400 Vali Loss: 0.1519637 Test Loss: 0.1799515
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.1714656
	speed: 0.7541s/iter; left time: 1720.1710s
Epoch: 84 cost time: 42.15648078918457
Epoch: 84, Steps: 140 | Train Loss: 0.1764819 Vali Loss: 0.1519140 Test Loss: 0.1799515
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1743272
	speed: 0.6894s/iter; left time: 1476.0255s
Epoch: 85 cost time: 44.08005738258362
Epoch: 85, Steps: 140 | Train Loss: 0.1763470 Vali Loss: 0.1519486 Test Loss: 0.1799518
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.1727329
	speed: 0.7234s/iter; left time: 1447.6030s
Epoch: 86 cost time: 41.54910707473755
Epoch: 86, Steps: 140 | Train Loss: 0.1764002 Vali Loss: 0.1519856 Test Loss: 0.1799507
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.1694626
	speed: 0.6685s/iter; left time: 1244.0946s
Epoch: 87 cost time: 40.706506967544556
Epoch: 87, Steps: 140 | Train Loss: 0.1764868 Vali Loss: 0.1519672 Test Loss: 0.1799510
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.1715778
	speed: 0.8272s/iter; left time: 1423.6028s
Epoch: 88 cost time: 60.40534472465515
Epoch: 88, Steps: 140 | Train Loss: 0.1764088 Vali Loss: 0.1519260 Test Loss: 0.1799503
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.1742720
	speed: 1.1965s/iter; left time: 1891.5941s
Epoch: 89 cost time: 72.28226661682129
Epoch: 89, Steps: 140 | Train Loss: 0.1763902 Vali Loss: 0.1519771 Test Loss: 0.1799499
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.1668771
	speed: 1.1850s/iter; left time: 1707.5503s
Epoch: 90 cost time: 73.4055027961731
Epoch: 90, Steps: 140 | Train Loss: 0.1764763 Vali Loss: 0.1519669 Test Loss: 0.1799490
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.1782595
	speed: 1.2439s/iter; left time: 1618.2491s
Epoch: 91 cost time: 70.64880704879761
Epoch: 91, Steps: 140 | Train Loss: 0.1763996 Vali Loss: 0.1520107 Test Loss: 0.1799492
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_180_j192_H4_FITS_custom_ftM_sl180_ll48_pl192_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.17732015252113342, mae:0.27475646138191223, rse:0.41867923736572266, corr:[0.4637739  0.46419483 0.46473274 0.46525759 0.46551862 0.4654259
 0.46513948 0.46499267 0.46496868 0.46463665 0.46408838 0.46393234
 0.46409422 0.46369845 0.4634028  0.4634441  0.4635065  0.46354872
 0.4635403  0.4633935  0.46337613 0.46377245 0.46420005 0.46410418
 0.46357876 0.4634241  0.46330646 0.4631171  0.4630018  0.46294567
 0.4627956  0.4626235  0.46256033 0.4624633  0.46213725 0.46184143
 0.46185932 0.46168396 0.46150255 0.46135798 0.46118912 0.46106398
 0.46102268 0.46097094 0.4608961  0.46097136 0.46113032 0.46113482
 0.4609377  0.4609174  0.46079683 0.46063972 0.46062332 0.46066618
 0.46059385 0.4604754  0.46047416 0.46051088 0.46045077 0.46033913
 0.46034345 0.46017963 0.46015558 0.46022543 0.4602005  0.46013275
 0.46006864 0.4599532  0.45986176 0.45996246 0.4600878  0.45999342
 0.45972705 0.4597828  0.4597941  0.4596662  0.45961174 0.4596671
 0.4596741  0.4596149  0.4596181  0.4596096  0.45949924 0.45945215
 0.45960888 0.4595095  0.45937872 0.45935145 0.45938224 0.4594171
 0.45940644 0.45926616 0.45908132 0.4590818  0.45919257 0.45919856
 0.45899984 0.4590223  0.45903128 0.4589896  0.4590091  0.45905173
 0.459007   0.45892718 0.45895585 0.4590264  0.4589662  0.4588633
 0.4589467  0.4589134  0.45892313 0.45893076 0.45885214 0.4587753
 0.4587889  0.45881265 0.45877784 0.45881462 0.45892492 0.45896667
 0.45886442 0.4590266  0.45911556 0.4590717  0.45910946 0.45924255
 0.45928192 0.4591936  0.45917132 0.45921424 0.4592122  0.45924982
 0.45942163 0.459349   0.45926222 0.4592807  0.45933554 0.4593447
 0.4592995  0.45916167 0.45905718 0.45917913 0.45941314 0.45950255
 0.45933226 0.45943514 0.45960468 0.4596664  0.45968074 0.45974037
 0.4598001  0.45983586 0.4599066  0.45995754 0.45995468 0.4600536
 0.46040735 0.46068847 0.4607558  0.4606529  0.46071467 0.46093696
 0.46104038 0.46094477 0.46100333 0.46141666 0.46152666 0.4610061
 0.46030983 0.45988807 0.45951542 0.4592017  0.4590393  0.4588453
 0.4584965  0.4582096  0.45818472 0.45820937 0.45806885 0.457929
 0.45804736 0.45805877 0.45819792 0.4582907  0.45805544 0.4577302
 0.45754695 0.45738277 0.45722175 0.45729768 0.45762697 0.45703855]
