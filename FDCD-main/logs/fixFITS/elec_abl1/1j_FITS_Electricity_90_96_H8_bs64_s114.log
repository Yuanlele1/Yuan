Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_90_j96_H8', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_90_j96_H8_FITS_custom_ftM_sl90_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18227
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=42, out_features=86, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  148409856.0
params:  3698.0
Trainable parameters:  3698
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4675245
	speed: 0.2464s/iter; left time: 3474.1709s
Epoch: 1 cost time: 34.75513052940369
Epoch: 1, Steps: 142 | Train Loss: 0.6355176 Vali Loss: 0.3386891 Test Loss: 0.3856400
Validation loss decreased (inf --> 0.338689).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2922068
	speed: 0.5753s/iter; left time: 8029.9626s
Epoch: 2 cost time: 33.30494260787964
Epoch: 2, Steps: 142 | Train Loss: 0.3156934 Vali Loss: 0.2389128 Test Loss: 0.2705943
Validation loss decreased (0.338689 --> 0.238913).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2467727
	speed: 0.5506s/iter; left time: 7607.3990s
Epoch: 3 cost time: 33.98191857337952
Epoch: 3, Steps: 142 | Train Loss: 0.2522894 Vali Loss: 0.2125315 Test Loss: 0.2397637
Validation loss decreased (0.238913 --> 0.212532).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2227387
	speed: 0.5789s/iter; left time: 7916.6011s
Epoch: 4 cost time: 35.657204151153564
Epoch: 4, Steps: 142 | Train Loss: 0.2328646 Vali Loss: 0.2018691 Test Loss: 0.2279401
Validation loss decreased (0.212532 --> 0.201869).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2246993
	speed: 0.5611s/iter; left time: 7593.2830s
Epoch: 5 cost time: 33.72856283187866
Epoch: 5, Steps: 142 | Train Loss: 0.2244468 Vali Loss: 0.1967026 Test Loss: 0.2219186
Validation loss decreased (0.201869 --> 0.196703).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2266887
	speed: 0.5537s/iter; left time: 7414.4375s
Epoch: 6 cost time: 34.38441467285156
Epoch: 6, Steps: 142 | Train Loss: 0.2197915 Vali Loss: 0.1933440 Test Loss: 0.2182887
Validation loss decreased (0.196703 --> 0.193344).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2116187
	speed: 0.5692s/iter; left time: 7540.9763s
Epoch: 7 cost time: 32.498748540878296
Epoch: 7, Steps: 142 | Train Loss: 0.2168961 Vali Loss: 0.1914436 Test Loss: 0.2158533
Validation loss decreased (0.193344 --> 0.191444).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2258612
	speed: 0.5475s/iter; left time: 7176.5160s
Epoch: 8 cost time: 33.88225841522217
Epoch: 8, Steps: 142 | Train Loss: 0.2149281 Vali Loss: 0.1899717 Test Loss: 0.2141462
Validation loss decreased (0.191444 --> 0.189972).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2071157
	speed: 0.5585s/iter; left time: 7241.0695s
Epoch: 9 cost time: 33.369479179382324
Epoch: 9, Steps: 142 | Train Loss: 0.2135471 Vali Loss: 0.1887964 Test Loss: 0.2129043
Validation loss decreased (0.189972 --> 0.188796).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2160434
	speed: 0.5505s/iter; left time: 7058.7185s
Epoch: 10 cost time: 33.38692593574524
Epoch: 10, Steps: 142 | Train Loss: 0.2124621 Vali Loss: 0.1879308 Test Loss: 0.2119581
Validation loss decreased (0.188796 --> 0.187931).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2225079
	speed: 0.5781s/iter; left time: 7330.8976s
Epoch: 11 cost time: 35.55267071723938
Epoch: 11, Steps: 142 | Train Loss: 0.2117084 Vali Loss: 0.1874629 Test Loss: 0.2112020
Validation loss decreased (0.187931 --> 0.187463).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2035986
	speed: 0.5560s/iter; left time: 6971.2622s
Epoch: 12 cost time: 32.35860753059387
Epoch: 12, Steps: 142 | Train Loss: 0.2110683 Vali Loss: 0.1869725 Test Loss: 0.2105924
Validation loss decreased (0.187463 --> 0.186973).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2012110
	speed: 0.5468s/iter; left time: 6778.7484s
Epoch: 13 cost time: 33.84053587913513
Epoch: 13, Steps: 142 | Train Loss: 0.2105696 Vali Loss: 0.1864077 Test Loss: 0.2100801
Validation loss decreased (0.186973 --> 0.186408).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2110688
	speed: 0.6326s/iter; left time: 7752.9825s
Epoch: 14 cost time: 39.6211953163147
Epoch: 14, Steps: 142 | Train Loss: 0.2101389 Vali Loss: 0.1860450 Test Loss: 0.2096595
Validation loss decreased (0.186408 --> 0.186045).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2078736
	speed: 0.6472s/iter; left time: 7839.5842s
Epoch: 15 cost time: 39.945605516433716
Epoch: 15, Steps: 142 | Train Loss: 0.2097899 Vali Loss: 0.1858366 Test Loss: 0.2092867
Validation loss decreased (0.186045 --> 0.185837).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2153827
	speed: 0.6920s/iter; left time: 8283.8180s
Epoch: 16 cost time: 41.9361355304718
Epoch: 16, Steps: 142 | Train Loss: 0.2094063 Vali Loss: 0.1858947 Test Loss: 0.2089902
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2079303
	speed: 0.7037s/iter; left time: 8323.5931s
Epoch: 17 cost time: 42.719542264938354
Epoch: 17, Steps: 142 | Train Loss: 0.2091649 Vali Loss: 0.1850194 Test Loss: 0.2087154
Validation loss decreased (0.185837 --> 0.185019).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2093871
	speed: 0.7319s/iter; left time: 8553.2336s
Epoch: 18 cost time: 43.98022150993347
Epoch: 18, Steps: 142 | Train Loss: 0.2089440 Vali Loss: 0.1852318 Test Loss: 0.2084836
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2015574
	speed: 0.6782s/iter; left time: 7829.8304s
Epoch: 19 cost time: 39.58324575424194
Epoch: 19, Steps: 142 | Train Loss: 0.2087205 Vali Loss: 0.1852013 Test Loss: 0.2082873
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2258269
	speed: 0.7016s/iter; left time: 8000.3550s
Epoch: 20 cost time: 42.50376319885254
Epoch: 20, Steps: 142 | Train Loss: 0.2085838 Vali Loss: 0.1852645 Test Loss: 0.2081026
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2073697
	speed: 0.6627s/iter; left time: 7462.6256s
Epoch: 21 cost time: 39.763999938964844
Epoch: 21, Steps: 142 | Train Loss: 0.2083778 Vali Loss: 0.1849804 Test Loss: 0.2079480
Validation loss decreased (0.185019 --> 0.184980).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2064670
	speed: 0.6578s/iter; left time: 7313.8231s
Epoch: 22 cost time: 39.87760829925537
Epoch: 22, Steps: 142 | Train Loss: 0.2082557 Vali Loss: 0.1850208 Test Loss: 0.2078149
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2051578
	speed: 0.6712s/iter; left time: 7367.5233s
Epoch: 23 cost time: 39.55432868003845
Epoch: 23, Steps: 142 | Train Loss: 0.2081598 Vali Loss: 0.1850403 Test Loss: 0.2076948
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1968976
	speed: 0.6921s/iter; left time: 7499.1348s
Epoch: 24 cost time: 41.45111966133118
Epoch: 24, Steps: 142 | Train Loss: 0.2079219 Vali Loss: 0.1845573 Test Loss: 0.2076001
Validation loss decreased (0.184980 --> 0.184557).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1993664
	speed: 0.6806s/iter; left time: 7277.2414s
Epoch: 25 cost time: 42.58576321601868
Epoch: 25, Steps: 142 | Train Loss: 0.2079308 Vali Loss: 0.1845203 Test Loss: 0.2074981
Validation loss decreased (0.184557 --> 0.184520).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2030879
	speed: 0.7038s/iter; left time: 7425.6115s
Epoch: 26 cost time: 42.40921330451965
Epoch: 26, Steps: 142 | Train Loss: 0.2078850 Vali Loss: 0.1846760 Test Loss: 0.2074291
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2165187
	speed: 0.6959s/iter; left time: 7243.2487s
Epoch: 27 cost time: 40.386314392089844
Epoch: 27, Steps: 142 | Train Loss: 0.2077628 Vali Loss: 0.1847000 Test Loss: 0.2073534
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2055586
	speed: 0.6680s/iter; left time: 6858.0763s
Epoch: 28 cost time: 42.03885555267334
Epoch: 28, Steps: 142 | Train Loss: 0.2076971 Vali Loss: 0.1846542 Test Loss: 0.2072969
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2180258
	speed: 0.7037s/iter; left time: 7125.2323s
Epoch: 29 cost time: 41.73133444786072
Epoch: 29, Steps: 142 | Train Loss: 0.2076658 Vali Loss: 0.1840758 Test Loss: 0.2072311
Validation loss decreased (0.184520 --> 0.184076).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2130538
	speed: 0.6926s/iter; left time: 6913.9755s
Epoch: 30 cost time: 41.35581684112549
Epoch: 30, Steps: 142 | Train Loss: 0.2076335 Vali Loss: 0.1843956 Test Loss: 0.2071794
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2112230
	speed: 0.6759s/iter; left time: 6651.7206s
Epoch: 31 cost time: 40.221076250076294
Epoch: 31, Steps: 142 | Train Loss: 0.2076527 Vali Loss: 0.1845114 Test Loss: 0.2071469
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2095171
	speed: 0.6771s/iter; left time: 6567.3215s
Epoch: 32 cost time: 41.89637565612793
Epoch: 32, Steps: 142 | Train Loss: 0.2075191 Vali Loss: 0.1841227 Test Loss: 0.2071077
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1985416
	speed: 0.6773s/iter; left time: 6473.2171s
Epoch: 33 cost time: 40.62275981903076
Epoch: 33, Steps: 142 | Train Loss: 0.2075713 Vali Loss: 0.1844932 Test Loss: 0.2070815
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2087492
	speed: 0.6704s/iter; left time: 6312.1604s
Epoch: 34 cost time: 41.53130006790161
Epoch: 34, Steps: 142 | Train Loss: 0.2075155 Vali Loss: 0.1843542 Test Loss: 0.2070460
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2131584
	speed: 0.6729s/iter; left time: 6239.6277s
Epoch: 35 cost time: 39.30073833465576
Epoch: 35, Steps: 142 | Train Loss: 0.2074162 Vali Loss: 0.1844218 Test Loss: 0.2070185
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2135584
	speed: 0.6488s/iter; left time: 5923.9522s
Epoch: 36 cost time: 40.948057889938354
Epoch: 36, Steps: 142 | Train Loss: 0.2074561 Vali Loss: 0.1840390 Test Loss: 0.2069931
Validation loss decreased (0.184076 --> 0.184039).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2048192
	speed: 0.6573s/iter; left time: 5908.5471s
Epoch: 37 cost time: 39.74455523490906
Epoch: 37, Steps: 142 | Train Loss: 0.2074299 Vali Loss: 0.1843074 Test Loss: 0.2069840
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2168237
	speed: 0.6469s/iter; left time: 5722.8611s
Epoch: 38 cost time: 38.37639117240906
Epoch: 38, Steps: 142 | Train Loss: 0.2073904 Vali Loss: 0.1843945 Test Loss: 0.2069678
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2147219
	speed: 0.6799s/iter; left time: 5918.9618s
Epoch: 39 cost time: 40.46567249298096
Epoch: 39, Steps: 142 | Train Loss: 0.2073867 Vali Loss: 0.1840411 Test Loss: 0.2069435
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2088742
	speed: 0.6274s/iter; left time: 5372.8276s
Epoch: 40 cost time: 36.25228238105774
Epoch: 40, Steps: 142 | Train Loss: 0.2072833 Vali Loss: 0.1837730 Test Loss: 0.2069237
Validation loss decreased (0.184039 --> 0.183773).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2072807
	speed: 0.6199s/iter; left time: 5219.9467s
Epoch: 41 cost time: 38.44478511810303
Epoch: 41, Steps: 142 | Train Loss: 0.2073949 Vali Loss: 0.1845293 Test Loss: 0.2069093
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2043045
	speed: 0.6557s/iter; left time: 5428.8831s
Epoch: 42 cost time: 38.790531396865845
Epoch: 42, Steps: 142 | Train Loss: 0.2073672 Vali Loss: 0.1842660 Test Loss: 0.2069010
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1996105
	speed: 0.6316s/iter; left time: 5139.3348s
Epoch: 43 cost time: 38.42262554168701
Epoch: 43, Steps: 142 | Train Loss: 0.2073110 Vali Loss: 0.1837147 Test Loss: 0.2068874
Validation loss decreased (0.183773 --> 0.183715).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2087112
	speed: 0.6153s/iter; left time: 4919.3885s
Epoch: 44 cost time: 35.74786138534546
Epoch: 44, Steps: 142 | Train Loss: 0.2073166 Vali Loss: 0.1841370 Test Loss: 0.2068834
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2006474
	speed: 0.5949s/iter; left time: 4671.4610s
Epoch: 45 cost time: 37.78376483917236
Epoch: 45, Steps: 142 | Train Loss: 0.2073664 Vali Loss: 0.1838211 Test Loss: 0.2068693
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2057329
	speed: 0.6108s/iter; left time: 4709.8770s
Epoch: 46 cost time: 35.130821228027344
Epoch: 46, Steps: 142 | Train Loss: 0.2072751 Vali Loss: 0.1837547 Test Loss: 0.2068678
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2130918
	speed: 0.6294s/iter; left time: 4763.9006s
Epoch: 47 cost time: 39.77956986427307
Epoch: 47, Steps: 142 | Train Loss: 0.2073160 Vali Loss: 0.1842397 Test Loss: 0.2068552
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2134403
	speed: 0.7820s/iter; left time: 5807.9363s
Epoch: 48 cost time: 51.429595947265625
Epoch: 48, Steps: 142 | Train Loss: 0.2072929 Vali Loss: 0.1840020 Test Loss: 0.2068536
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2032920
	speed: 0.8001s/iter; left time: 5828.8069s
Epoch: 49 cost time: 48.79883408546448
Epoch: 49, Steps: 142 | Train Loss: 0.2072861 Vali Loss: 0.1841590 Test Loss: 0.2068417
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2099368
	speed: 0.8288s/iter; left time: 5920.0304s
Epoch: 50 cost time: 50.21621918678284
Epoch: 50, Steps: 142 | Train Loss: 0.2072561 Vali Loss: 0.1842306 Test Loss: 0.2068331
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2156428
	speed: 0.8509s/iter; left time: 5956.9665s
Epoch: 51 cost time: 50.22309184074402
Epoch: 51, Steps: 142 | Train Loss: 0.2072476 Vali Loss: 0.1838611 Test Loss: 0.2068341
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2009242
	speed: 0.8468s/iter; left time: 5808.0947s
Epoch: 52 cost time: 50.52645397186279
Epoch: 52, Steps: 142 | Train Loss: 0.2071798 Vali Loss: 0.1838957 Test Loss: 0.2068268
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2068188
	speed: 0.8450s/iter; left time: 5675.7894s
Epoch: 53 cost time: 50.749845027923584
Epoch: 53, Steps: 142 | Train Loss: 0.2072572 Vali Loss: 0.1843450 Test Loss: 0.2068243
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2046235
	speed: 0.8417s/iter; left time: 5534.1685s
Epoch: 54 cost time: 51.27174782752991
Epoch: 54, Steps: 142 | Train Loss: 0.2072625 Vali Loss: 0.1841955 Test Loss: 0.2068165
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2095127
	speed: 0.8380s/iter; left time: 5390.6779s
Epoch: 55 cost time: 49.65468144416809
Epoch: 55, Steps: 142 | Train Loss: 0.2072697 Vali Loss: 0.1841742 Test Loss: 0.2068156
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1954022
	speed: 0.7822s/iter; left time: 4920.7153s
Epoch: 56 cost time: 44.80140566825867
Epoch: 56, Steps: 142 | Train Loss: 0.2072191 Vali Loss: 0.1838118 Test Loss: 0.2068089
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2004311
	speed: 0.7846s/iter; left time: 4824.5552s
Epoch: 57 cost time: 48.15383768081665
Epoch: 57, Steps: 142 | Train Loss: 0.2072530 Vali Loss: 0.1845208 Test Loss: 0.2068059
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2056192
	speed: 0.7903s/iter; left time: 4747.1498s
Epoch: 58 cost time: 48.087533950805664
Epoch: 58, Steps: 142 | Train Loss: 0.2072750 Vali Loss: 0.1839727 Test Loss: 0.2068044
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2181593
	speed: 0.8087s/iter; left time: 4743.1682s
Epoch: 59 cost time: 48.63363027572632
Epoch: 59, Steps: 142 | Train Loss: 0.2072821 Vali Loss: 0.1836376 Test Loss: 0.2068013
Validation loss decreased (0.183715 --> 0.183638).  Saving model ...
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1998415
	speed: 0.7971s/iter; left time: 4562.0035s
Epoch: 60 cost time: 48.47062134742737
Epoch: 60, Steps: 142 | Train Loss: 0.2072339 Vali Loss: 0.1839684 Test Loss: 0.2067995
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2096665
	speed: 0.8373s/iter; left time: 4673.1341s
Epoch: 61 cost time: 49.997039794921875
Epoch: 61, Steps: 142 | Train Loss: 0.2072421 Vali Loss: 0.1843374 Test Loss: 0.2067968
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2092286
	speed: 0.8205s/iter; left time: 4462.6724s
Epoch: 62 cost time: 49.41205382347107
Epoch: 62, Steps: 142 | Train Loss: 0.2072295 Vali Loss: 0.1841157 Test Loss: 0.2067944
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2116675
	speed: 0.8027s/iter; left time: 4251.9324s
Epoch: 63 cost time: 47.642910957336426
Epoch: 63, Steps: 142 | Train Loss: 0.2072748 Vali Loss: 0.1843404 Test Loss: 0.2067902
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2201138
	speed: 0.8258s/iter; left time: 4256.8582s
Epoch: 64 cost time: 50.048683404922485
Epoch: 64, Steps: 142 | Train Loss: 0.2072645 Vali Loss: 0.1840362 Test Loss: 0.2067884
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2236821
	speed: 0.7885s/iter; left time: 3952.8282s
Epoch: 65 cost time: 46.977959394454956
Epoch: 65, Steps: 142 | Train Loss: 0.2072788 Vali Loss: 0.1838775 Test Loss: 0.2067883
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2148104
	speed: 0.7914s/iter; left time: 3854.7292s
Epoch: 66 cost time: 49.57113194465637
Epoch: 66, Steps: 142 | Train Loss: 0.2072139 Vali Loss: 0.1840020 Test Loss: 0.2067873
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2204006
	speed: 0.8568s/iter; left time: 4051.7492s
Epoch: 67 cost time: 49.81626844406128
Epoch: 67, Steps: 142 | Train Loss: 0.2072391 Vali Loss: 0.1838091 Test Loss: 0.2067840
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2153281
	speed: 0.8115s/iter; left time: 3722.3137s
Epoch: 68 cost time: 49.59534692764282
Epoch: 68, Steps: 142 | Train Loss: 0.2072679 Vali Loss: 0.1836116 Test Loss: 0.2067803
Validation loss decreased (0.183638 --> 0.183612).  Saving model ...
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2181372
	speed: 0.8157s/iter; left time: 3625.6473s
Epoch: 69 cost time: 50.26087784767151
Epoch: 69, Steps: 142 | Train Loss: 0.2072480 Vali Loss: 0.1844071 Test Loss: 0.2067811
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2016695
	speed: 0.7664s/iter; left time: 3297.7458s
Epoch: 70 cost time: 46.962594509124756
Epoch: 70, Steps: 142 | Train Loss: 0.2072123 Vali Loss: 0.1837151 Test Loss: 0.2067782
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2050389
	speed: 0.8266s/iter; left time: 3439.4893s
Epoch: 71 cost time: 48.080952882766724
Epoch: 71, Steps: 142 | Train Loss: 0.2072086 Vali Loss: 0.1838762 Test Loss: 0.2067773
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2039997
	speed: 0.8244s/iter; left time: 3313.4487s
Epoch: 72 cost time: 50.10032844543457
Epoch: 72, Steps: 142 | Train Loss: 0.2071818 Vali Loss: 0.1841185 Test Loss: 0.2067744
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.2123007
	speed: 0.7839s/iter; left time: 3039.0805s
Epoch: 73 cost time: 51.131038188934326
Epoch: 73, Steps: 142 | Train Loss: 0.2071920 Vali Loss: 0.1837099 Test Loss: 0.2067737
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.2004212
	speed: 0.8482s/iter; left time: 3167.9419s
Epoch: 74 cost time: 49.938186168670654
Epoch: 74, Steps: 142 | Train Loss: 0.2071376 Vali Loss: 0.1835832 Test Loss: 0.2067732
Validation loss decreased (0.183612 --> 0.183583).  Saving model ...
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2147736
	speed: 0.7925s/iter; left time: 2847.5664s
Epoch: 75 cost time: 48.44466948509216
Epoch: 75, Steps: 142 | Train Loss: 0.2072673 Vali Loss: 0.1839982 Test Loss: 0.2067729
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.2103858
	speed: 0.7890s/iter; left time: 2722.8290s
Epoch: 76 cost time: 51.69509196281433
Epoch: 76, Steps: 142 | Train Loss: 0.2072160 Vali Loss: 0.1840191 Test Loss: 0.2067717
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2040802
	speed: 0.8588s/iter; left time: 2841.6444s
Epoch: 77 cost time: 51.31209683418274
Epoch: 77, Steps: 142 | Train Loss: 0.2072672 Vali Loss: 0.1843444 Test Loss: 0.2067712
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2051638
	speed: 0.7938s/iter; left time: 2513.8372s
Epoch: 78 cost time: 45.33046054840088
Epoch: 78, Steps: 142 | Train Loss: 0.2071803 Vali Loss: 0.1836660 Test Loss: 0.2067698
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.2116480
	speed: 0.7957s/iter; left time: 2407.1282s
Epoch: 79 cost time: 46.3719916343689
Epoch: 79, Steps: 142 | Train Loss: 0.2072309 Vali Loss: 0.1839080 Test Loss: 0.2067699
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.2086749
	speed: 0.7927s/iter; left time: 2285.3834s
Epoch: 80 cost time: 49.48775553703308
Epoch: 80, Steps: 142 | Train Loss: 0.2072078 Vali Loss: 0.1841141 Test Loss: 0.2067681
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.2182274
	speed: 0.7660s/iter; left time: 2099.5623s
Epoch: 81 cost time: 46.8703727722168
Epoch: 81, Steps: 142 | Train Loss: 0.2072281 Vali Loss: 0.1839985 Test Loss: 0.2067677
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.2157329
	speed: 0.7906s/iter; left time: 2054.8708s
Epoch: 82 cost time: 50.731597900390625
Epoch: 82, Steps: 142 | Train Loss: 0.2072161 Vali Loss: 0.1840965 Test Loss: 0.2067667
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1989180
	speed: 0.8240s/iter; left time: 2024.4999s
Epoch: 83 cost time: 48.626853942871094
Epoch: 83, Steps: 142 | Train Loss: 0.2071694 Vali Loss: 0.1840483 Test Loss: 0.2067661
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.2109907
	speed: 0.7698s/iter; left time: 1782.1436s
Epoch: 84 cost time: 46.5038697719574
Epoch: 84, Steps: 142 | Train Loss: 0.2071882 Vali Loss: 0.1841099 Test Loss: 0.2067655
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1957222
	speed: 0.7933s/iter; left time: 1723.8975s
Epoch: 85 cost time: 47.01563382148743
Epoch: 85, Steps: 142 | Train Loss: 0.2071884 Vali Loss: 0.1839962 Test Loss: 0.2067654
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.2091012
	speed: 0.7955s/iter; left time: 1615.6438s
Epoch: 86 cost time: 48.42995619773865
Epoch: 86, Steps: 142 | Train Loss: 0.2072111 Vali Loss: 0.1836384 Test Loss: 0.2067642
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.2129546
	speed: 0.8002s/iter; left time: 1511.6612s
Epoch: 87 cost time: 47.5514874458313
Epoch: 87, Steps: 142 | Train Loss: 0.2072016 Vali Loss: 0.1838635 Test Loss: 0.2067644
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.2068264
	speed: 0.8060s/iter; left time: 1408.0582s
Epoch: 88 cost time: 49.85815095901489
Epoch: 88, Steps: 142 | Train Loss: 0.2071887 Vali Loss: 0.1842029 Test Loss: 0.2067643
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.2084950
	speed: 0.8219s/iter; left time: 1319.0892s
Epoch: 89 cost time: 50.26847696304321
Epoch: 89, Steps: 142 | Train Loss: 0.2072321 Vali Loss: 0.1836150 Test Loss: 0.2067629
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.2016007
	speed: 0.7993s/iter; left time: 1169.3048s
Epoch: 90 cost time: 48.46524453163147
Epoch: 90, Steps: 142 | Train Loss: 0.2071553 Vali Loss: 0.1836512 Test Loss: 0.2067631
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.2257980
	speed: 0.7918s/iter; left time: 1046.0274s
Epoch: 91 cost time: 48.402097940444946
Epoch: 91, Steps: 142 | Train Loss: 0.2071964 Vali Loss: 0.1844115 Test Loss: 0.2067620
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.944182354829475e-06
	iters: 100, epoch: 92 | loss: 0.2077060
	speed: 0.8066s/iter; left time: 950.9225s
Epoch: 92 cost time: 48.729820013046265
Epoch: 92, Steps: 142 | Train Loss: 0.2072460 Vali Loss: 0.1838589 Test Loss: 0.2067623
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.696973237088e-06
	iters: 100, epoch: 93 | loss: 0.2039559
	speed: 0.7587s/iter; left time: 786.8098s
Epoch: 93 cost time: 44.55259418487549
Epoch: 93, Steps: 142 | Train Loss: 0.2072046 Vali Loss: 0.1839677 Test Loss: 0.2067618
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.462124575233601e-06
	iters: 100, epoch: 94 | loss: 0.2091773
	speed: 0.7697s/iter; left time: 688.8524s
Epoch: 94 cost time: 47.36576533317566
Epoch: 94, Steps: 142 | Train Loss: 0.2072021 Vali Loss: 0.1843117 Test Loss: 0.2067612
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_90_j96_H8_FITS_custom_ftM_sl90_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.20572496950626373, mae:0.2808656096458435, rse:0.45080360770225525, corr:[0.46155974 0.46173683 0.46020243 0.45924464 0.4581771  0.45760733
 0.45754054 0.45684463 0.45606872 0.45496744 0.4544508  0.4537227
 0.4533806  0.45280188 0.45247963 0.45210138 0.452014   0.45226043
 0.4523505  0.45245907 0.45249122 0.45250517 0.45254314 0.4515441
 0.44943503 0.4477588  0.44656318 0.445592   0.44493115 0.44521543
 0.4458395  0.4460489  0.44542384 0.4449631  0.44461405 0.44423625
 0.44420043 0.44394296 0.44389847 0.4437134  0.4437696  0.44385177
 0.44399655 0.444177   0.4442989  0.4446012  0.4447333  0.44452074
 0.44360644 0.4430819  0.44307044 0.4432463  0.44417727 0.44568828
 0.4478617  0.44912067 0.44890955 0.44890034 0.4486865  0.44855407
 0.44853082 0.4484154  0.44864717 0.44881904 0.44911003 0.44936875
 0.44973686 0.4499102  0.45027465 0.4507451  0.4513331  0.45160028
 0.45177016 0.45226753 0.4529577  0.45412844 0.45603755 0.45844764
 0.46162742 0.46356612 0.46344787 0.46326107 0.46291932 0.46270484
 0.46264172 0.46268058 0.46282557 0.46300444 0.46315187 0.4633693
 0.46333995 0.4632653  0.46310416 0.46307912 0.4626102  0.46320033]
