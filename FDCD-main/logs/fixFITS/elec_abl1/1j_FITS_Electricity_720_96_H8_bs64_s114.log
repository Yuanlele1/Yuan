Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=258, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j96_H8', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_j96_H8_FITS_custom_ftM_sl720_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=258, out_features=292, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3095405568.0
params:  75628.0
Trainable parameters:  75628
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2193644
	speed: 0.6537s/iter; left time: 8890.7693s
Epoch: 1 cost time: 94.28005647659302
Epoch: 1, Steps: 137 | Train Loss: 0.3993108 Vali Loss: 0.1372334 Test Loss: 0.1644429
Validation loss decreased (inf --> 0.137233).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1379308
	speed: 1.5167s/iter; left time: 20421.3869s
Epoch: 2 cost time: 85.54954195022583
Epoch: 2, Steps: 137 | Train Loss: 0.1481067 Vali Loss: 0.1187285 Test Loss: 0.1415968
Validation loss decreased (0.137233 --> 0.118729).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1389616
	speed: 1.4605s/iter; left time: 19464.6410s
Epoch: 3 cost time: 92.3163013458252
Epoch: 3, Steps: 137 | Train Loss: 0.1409906 Vali Loss: 0.1174865 Test Loss: 0.1397652
Validation loss decreased (0.118729 --> 0.117486).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1381817
	speed: 1.5494s/iter; left time: 20436.4762s
Epoch: 4 cost time: 96.24807143211365
Epoch: 4, Steps: 137 | Train Loss: 0.1395615 Vali Loss: 0.1167749 Test Loss: 0.1390496
Validation loss decreased (0.117486 --> 0.116775).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1444983
	speed: 1.5088s/iter; left time: 19694.0168s
Epoch: 5 cost time: 92.69218325614929
Epoch: 5, Steps: 137 | Train Loss: 0.1388379 Vali Loss: 0.1162160 Test Loss: 0.1386579
Validation loss decreased (0.116775 --> 0.116216).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1337392
	speed: 1.4519s/iter; left time: 18753.1047s
Epoch: 6 cost time: 87.09406518936157
Epoch: 6, Steps: 137 | Train Loss: 0.1383135 Vali Loss: 0.1160882 Test Loss: 0.1383862
Validation loss decreased (0.116216 --> 0.116088).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1361665
	speed: 1.5098s/iter; left time: 19293.9439s
Epoch: 7 cost time: 96.67580914497375
Epoch: 7, Steps: 137 | Train Loss: 0.1380374 Vali Loss: 0.1158022 Test Loss: 0.1381268
Validation loss decreased (0.116088 --> 0.115802).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1342717
	speed: 1.5591s/iter; left time: 19709.9327s
Epoch: 8 cost time: 100.2334463596344
Epoch: 8, Steps: 137 | Train Loss: 0.1379362 Vali Loss: 0.1159623 Test Loss: 0.1380117
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1290619
	speed: 1.4293s/iter; left time: 17873.5964s
Epoch: 9 cost time: 88.82214045524597
Epoch: 9, Steps: 137 | Train Loss: 0.1377331 Vali Loss: 0.1155395 Test Loss: 0.1378503
Validation loss decreased (0.115802 --> 0.115539).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1230720
	speed: 1.5362s/iter; left time: 18999.4250s
Epoch: 10 cost time: 95.81809568405151
Epoch: 10, Steps: 137 | Train Loss: 0.1375752 Vali Loss: 0.1154291 Test Loss: 0.1377569
Validation loss decreased (0.115539 --> 0.115429).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1366474
	speed: 1.5990s/iter; left time: 19556.7901s
Epoch: 11 cost time: 95.66934394836426
Epoch: 11, Steps: 137 | Train Loss: 0.1374690 Vali Loss: 0.1154708 Test Loss: 0.1377203
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1393341
	speed: 1.4415s/iter; left time: 17433.0852s
Epoch: 12 cost time: 90.37604522705078
Epoch: 12, Steps: 137 | Train Loss: 0.1373905 Vali Loss: 0.1151609 Test Loss: 0.1376635
Validation loss decreased (0.115429 --> 0.115161).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1306224
	speed: 1.5252s/iter; left time: 18236.5853s
Epoch: 13 cost time: 100.05041289329529
Epoch: 13, Steps: 137 | Train Loss: 0.1373240 Vali Loss: 0.1155927 Test Loss: 0.1375786
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1303900
	speed: 1.5773s/iter; left time: 18643.4293s
Epoch: 14 cost time: 98.41252875328064
Epoch: 14, Steps: 137 | Train Loss: 0.1372799 Vali Loss: 0.1154737 Test Loss: 0.1375424
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1374027
	speed: 1.6190s/iter; left time: 18914.7129s
Epoch: 15 cost time: 98.54059505462646
Epoch: 15, Steps: 137 | Train Loss: 0.1371749 Vali Loss: 0.1151811 Test Loss: 0.1374470
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1444318
	speed: 1.5084s/iter; left time: 17415.9270s
Epoch: 16 cost time: 95.25179958343506
Epoch: 16, Steps: 137 | Train Loss: 0.1371938 Vali Loss: 0.1154035 Test Loss: 0.1374424
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1386851
	speed: 1.5287s/iter; left time: 17440.7570s
Epoch: 17 cost time: 95.20054054260254
Epoch: 17, Steps: 137 | Train Loss: 0.1371655 Vali Loss: 0.1154709 Test Loss: 0.1374769
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1345895
	speed: 1.6336s/iter; left time: 18413.8478s
Epoch: 18 cost time: 100.13218402862549
Epoch: 18, Steps: 137 | Train Loss: 0.1370568 Vali Loss: 0.1153923 Test Loss: 0.1374919
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1460436
	speed: 1.5264s/iter; left time: 16995.9322s
Epoch: 19 cost time: 90.3961193561554
Epoch: 19, Steps: 137 | Train Loss: 0.1370959 Vali Loss: 0.1153722 Test Loss: 0.1374297
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1474400
	speed: 1.5275s/iter; left time: 16798.9500s
Epoch: 20 cost time: 94.7311680316925
Epoch: 20, Steps: 137 | Train Loss: 0.1370786 Vali Loss: 0.1153472 Test Loss: 0.1374461
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1344197
	speed: 1.5047s/iter; left time: 16343.0477s
Epoch: 21 cost time: 94.86062455177307
Epoch: 21, Steps: 137 | Train Loss: 0.1370413 Vali Loss: 0.1151732 Test Loss: 0.1373526
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1363457
	speed: 1.5938s/iter; left time: 17092.3794s
Epoch: 22 cost time: 98.83905005455017
Epoch: 22, Steps: 137 | Train Loss: 0.1370226 Vali Loss: 0.1154605 Test Loss: 0.1374131
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1418721
	speed: 1.4955s/iter; left time: 15832.6313s
Epoch: 23 cost time: 88.37422156333923
Epoch: 23, Steps: 137 | Train Loss: 0.1369836 Vali Loss: 0.1152589 Test Loss: 0.1373780
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1508833
	speed: 1.5104s/iter; left time: 15784.1080s
Epoch: 24 cost time: 94.96794056892395
Epoch: 24, Steps: 137 | Train Loss: 0.1369513 Vali Loss: 0.1155162 Test Loss: 0.1373899
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1364700
	speed: 1.4844s/iter; left time: 15308.7681s
Epoch: 25 cost time: 96.3635048866272
Epoch: 25, Steps: 137 | Train Loss: 0.1369439 Vali Loss: 0.1148395 Test Loss: 0.1373383
Validation loss decreased (0.115161 --> 0.114840).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1351608
	speed: 1.5687s/iter; left time: 15962.6689s
Epoch: 26 cost time: 95.23427367210388
Epoch: 26, Steps: 137 | Train Loss: 0.1369017 Vali Loss: 0.1152854 Test Loss: 0.1373643
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1427288
	speed: 1.5744s/iter; left time: 15805.3037s
Epoch: 27 cost time: 99.28731989860535
Epoch: 27, Steps: 137 | Train Loss: 0.1368946 Vali Loss: 0.1151003 Test Loss: 0.1373512
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1383014
	speed: 1.5541s/iter; left time: 15388.3350s
Epoch: 28 cost time: 98.0265884399414
Epoch: 28, Steps: 137 | Train Loss: 0.1369212 Vali Loss: 0.1154928 Test Loss: 0.1373274
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1489858
	speed: 1.5780s/iter; left time: 15408.7072s
Epoch: 29 cost time: 91.85687851905823
Epoch: 29, Steps: 137 | Train Loss: 0.1368512 Vali Loss: 0.1152110 Test Loss: 0.1373124
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1483221
	speed: 1.5381s/iter; left time: 14808.4387s
Epoch: 30 cost time: 97.7250144481659
Epoch: 30, Steps: 137 | Train Loss: 0.1369363 Vali Loss: 0.1152685 Test Loss: 0.1373486
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1316563
	speed: 1.6153s/iter; left time: 15330.7288s
Epoch: 31 cost time: 99.11137294769287
Epoch: 31, Steps: 137 | Train Loss: 0.1368501 Vali Loss: 0.1149969 Test Loss: 0.1372970
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1397545
	speed: 1.5597s/iter; left time: 14589.1919s
Epoch: 32 cost time: 96.157151222229
Epoch: 32, Steps: 137 | Train Loss: 0.1368913 Vali Loss: 0.1152164 Test Loss: 0.1372699
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1298819
	speed: 1.5674s/iter; left time: 14446.3960s
Epoch: 33 cost time: 94.77765226364136
Epoch: 33, Steps: 137 | Train Loss: 0.1368223 Vali Loss: 0.1150278 Test Loss: 0.1372678
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1359391
	speed: 1.4817s/iter; left time: 13453.8236s
Epoch: 34 cost time: 89.58816289901733
Epoch: 34, Steps: 137 | Train Loss: 0.1368812 Vali Loss: 0.1153091 Test Loss: 0.1372872
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1445105
	speed: 1.5213s/iter; left time: 13605.0658s
Epoch: 35 cost time: 100.64660716056824
Epoch: 35, Steps: 137 | Train Loss: 0.1368843 Vali Loss: 0.1152146 Test Loss: 0.1372449
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1444251
	speed: 1.6568s/iter; left time: 14589.7553s
Epoch: 36 cost time: 103.25566983222961
Epoch: 36, Steps: 137 | Train Loss: 0.1368376 Vali Loss: 0.1150484 Test Loss: 0.1372728
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1314854
	speed: 1.5640s/iter; left time: 13558.4376s
Epoch: 37 cost time: 94.700439453125
Epoch: 37, Steps: 137 | Train Loss: 0.1367958 Vali Loss: 0.1151186 Test Loss: 0.1372271
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1285407
	speed: 1.5586s/iter; left time: 13298.3034s
Epoch: 38 cost time: 98.58377599716187
Epoch: 38, Steps: 137 | Train Loss: 0.1368459 Vali Loss: 0.1151088 Test Loss: 0.1372341
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1347259
	speed: 1.5000s/iter; left time: 12592.7847s
Epoch: 39 cost time: 94.86002588272095
Epoch: 39, Steps: 137 | Train Loss: 0.1368135 Vali Loss: 0.1151449 Test Loss: 0.1372302
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1409326
	speed: 1.5904s/iter; left time: 13133.2137s
Epoch: 40 cost time: 93.93234467506409
Epoch: 40, Steps: 137 | Train Loss: 0.1368471 Vali Loss: 0.1151805 Test Loss: 0.1372467
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1414861
	speed: 1.5684s/iter; left time: 12736.8080s
Epoch: 41 cost time: 98.85117316246033
Epoch: 41, Steps: 137 | Train Loss: 0.1367681 Vali Loss: 0.1151370 Test Loss: 0.1372305
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1310924
	speed: 1.5678s/iter; left time: 12516.9558s
Epoch: 42 cost time: 96.52531599998474
Epoch: 42, Steps: 137 | Train Loss: 0.1367889 Vali Loss: 0.1151906 Test Loss: 0.1372382
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1389030
	speed: 1.5280s/iter; left time: 11990.0129s
Epoch: 43 cost time: 95.6013731956482
Epoch: 43, Steps: 137 | Train Loss: 0.1367154 Vali Loss: 0.1150196 Test Loss: 0.1372080
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1428649
	speed: 1.5296s/iter; left time: 11793.5807s
Epoch: 44 cost time: 92.5096116065979
Epoch: 44, Steps: 137 | Train Loss: 0.1366995 Vali Loss: 0.1150238 Test Loss: 0.1371915
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1284533
	speed: 1.5647s/iter; left time: 11849.4041s
Epoch: 45 cost time: 97.48972678184509
Epoch: 45, Steps: 137 | Train Loss: 0.1367603 Vali Loss: 0.1149305 Test Loss: 0.1372120
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_720_j96_H8_FITS_custom_ftM_sl720_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.1367640346288681, mae:0.2353029102087021, rse:0.36756134033203125, corr:[0.4658135  0.46770245 0.469906   0.47013694 0.4711402  0.47106716
 0.4711383  0.47139376 0.47099265 0.47102785 0.47089404 0.47072563
 0.47080332 0.4705022  0.4704013  0.47055158 0.4704488  0.47042125
 0.47046342 0.47043052 0.4704081  0.4703359  0.47036716 0.47056207
 0.4706717  0.4709015  0.4709205  0.47083876 0.4708405  0.47064072
 0.47048578 0.47051892 0.47041157 0.47032812 0.47026145 0.47019774
 0.47020346 0.47001532 0.46988258 0.46998283 0.46993455 0.4698823
 0.46990952 0.46973583 0.46967998 0.46969748 0.4696649  0.46989235
 0.47000906 0.47006872 0.47024786 0.47018045 0.4700687  0.4701329
 0.47007677 0.4699963  0.46993023 0.46982563 0.4697867  0.4696789
 0.46960467 0.46960628 0.4694918  0.46951583 0.46959263 0.46948972
 0.46953186 0.46944988 0.46913424 0.4690977  0.46911907 0.4690679
 0.4691391  0.46915126 0.46910974 0.4691162  0.46902958 0.46902508
 0.46898952 0.4688098  0.46870995 0.46864557 0.468749   0.46877792
 0.46858916 0.46880844 0.46884733 0.46858358 0.46882525 0.46861312
 0.46832263 0.46854714 0.46815988 0.4685924  0.4684777  0.46915334]
