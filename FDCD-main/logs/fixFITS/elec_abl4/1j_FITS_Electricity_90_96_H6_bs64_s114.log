Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_90_j96_H6', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_90_j96_H6_FITS_custom_ftM_sl90_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18227
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  97789440.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6262982
	speed: 0.0746s/iter; left time: 1051.2971s
Epoch: 1 cost time: 10.164137363433838
Epoch: 1, Steps: 142 | Train Loss: 0.8404555 Vali Loss: 0.4300410 Test Loss: 0.4943843
Validation loss decreased (inf --> 0.430041).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3549011
	speed: 0.1551s/iter; left time: 2165.4655s
Epoch: 2 cost time: 10.291597127914429
Epoch: 2, Steps: 142 | Train Loss: 0.3871274 Vali Loss: 0.2759295 Test Loss: 0.3139242
Validation loss decreased (0.430041 --> 0.275930).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2785605
	speed: 0.1557s/iter; left time: 2150.8281s
Epoch: 3 cost time: 10.232794761657715
Epoch: 3, Steps: 142 | Train Loss: 0.2846550 Vali Loss: 0.2330460 Test Loss: 0.2637536
Validation loss decreased (0.275930 --> 0.233046).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2507542
	speed: 0.1559s/iter; left time: 2131.9293s
Epoch: 4 cost time: 10.211127519607544
Epoch: 4, Steps: 142 | Train Loss: 0.2535161 Vali Loss: 0.2175135 Test Loss: 0.2454039
Validation loss decreased (0.233046 --> 0.217514).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2430923
	speed: 0.1541s/iter; left time: 2085.6283s
Epoch: 5 cost time: 10.089349746704102
Epoch: 5, Steps: 142 | Train Loss: 0.2405965 Vali Loss: 0.2099530 Test Loss: 0.2362161
Validation loss decreased (0.217514 --> 0.209953).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2319245
	speed: 0.1541s/iter; left time: 2064.0428s
Epoch: 6 cost time: 9.722779750823975
Epoch: 6, Steps: 142 | Train Loss: 0.2333774 Vali Loss: 0.2046199 Test Loss: 0.2305492
Validation loss decreased (0.209953 --> 0.204620).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2473639
	speed: 0.1306s/iter; left time: 1730.7398s
Epoch: 7 cost time: 8.571918249130249
Epoch: 7, Steps: 142 | Train Loss: 0.2286257 Vali Loss: 0.2013561 Test Loss: 0.2266400
Validation loss decreased (0.204620 --> 0.201356).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2221247
	speed: 0.1315s/iter; left time: 1724.0955s
Epoch: 8 cost time: 8.6015465259552
Epoch: 8, Steps: 142 | Train Loss: 0.2252559 Vali Loss: 0.1989145 Test Loss: 0.2237705
Validation loss decreased (0.201356 --> 0.198914).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2205560
	speed: 0.1406s/iter; left time: 1823.4345s
Epoch: 9 cost time: 9.929305076599121
Epoch: 9, Steps: 142 | Train Loss: 0.2227630 Vali Loss: 0.1967394 Test Loss: 0.2215789
Validation loss decreased (0.198914 --> 0.196739).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2209657
	speed: 0.1535s/iter; left time: 1968.4134s
Epoch: 10 cost time: 10.068719148635864
Epoch: 10, Steps: 142 | Train Loss: 0.2208782 Vali Loss: 0.1958616 Test Loss: 0.2198489
Validation loss decreased (0.196739 --> 0.195862).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2172019
	speed: 0.1550s/iter; left time: 1965.2597s
Epoch: 11 cost time: 10.153238773345947
Epoch: 11, Steps: 142 | Train Loss: 0.2192948 Vali Loss: 0.1940458 Test Loss: 0.2184492
Validation loss decreased (0.195862 --> 0.194046).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2190876
	speed: 0.1534s/iter; left time: 1923.2351s
Epoch: 12 cost time: 10.188402891159058
Epoch: 12, Steps: 142 | Train Loss: 0.2180807 Vali Loss: 0.1932652 Test Loss: 0.2172645
Validation loss decreased (0.194046 --> 0.193265).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2178857
	speed: 0.1549s/iter; left time: 1920.8537s
Epoch: 13 cost time: 10.233850955963135
Epoch: 13, Steps: 142 | Train Loss: 0.2170116 Vali Loss: 0.1919295 Test Loss: 0.2162949
Validation loss decreased (0.193265 --> 0.191929).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2205205
	speed: 0.1565s/iter; left time: 1917.9186s
Epoch: 14 cost time: 10.26747727394104
Epoch: 14, Steps: 142 | Train Loss: 0.2161212 Vali Loss: 0.1916717 Test Loss: 0.2154623
Validation loss decreased (0.191929 --> 0.191672).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2041513
	speed: 0.1568s/iter; left time: 1899.5128s
Epoch: 15 cost time: 10.192895889282227
Epoch: 15, Steps: 142 | Train Loss: 0.2153661 Vali Loss: 0.1910881 Test Loss: 0.2147281
Validation loss decreased (0.191672 --> 0.191088).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2161700
	speed: 0.1542s/iter; left time: 1845.9222s
Epoch: 16 cost time: 10.105168342590332
Epoch: 16, Steps: 142 | Train Loss: 0.2146541 Vali Loss: 0.1905401 Test Loss: 0.2141048
Validation loss decreased (0.191088 --> 0.190540).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2254906
	speed: 0.1537s/iter; left time: 1818.1747s
Epoch: 17 cost time: 10.113623142242432
Epoch: 17, Steps: 142 | Train Loss: 0.2141214 Vali Loss: 0.1894586 Test Loss: 0.2135258
Validation loss decreased (0.190540 --> 0.189459).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2184390
	speed: 0.1515s/iter; left time: 1770.6690s
Epoch: 18 cost time: 9.858908414840698
Epoch: 18, Steps: 142 | Train Loss: 0.2135345 Vali Loss: 0.1896911 Test Loss: 0.2130519
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2153361
	speed: 0.1535s/iter; left time: 1772.0439s
Epoch: 19 cost time: 9.996819496154785
Epoch: 19, Steps: 142 | Train Loss: 0.2131557 Vali Loss: 0.1891171 Test Loss: 0.2126096
Validation loss decreased (0.189459 --> 0.189117).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2085694
	speed: 0.1559s/iter; left time: 1777.3615s
Epoch: 20 cost time: 10.110404014587402
Epoch: 20, Steps: 142 | Train Loss: 0.2127305 Vali Loss: 0.1891211 Test Loss: 0.2122197
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2150364
	speed: 0.1558s/iter; left time: 1754.4757s
Epoch: 21 cost time: 10.104627847671509
Epoch: 21, Steps: 142 | Train Loss: 0.2123893 Vali Loss: 0.1885404 Test Loss: 0.2118769
Validation loss decreased (0.189117 --> 0.188540).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2118091
	speed: 0.1567s/iter; left time: 1742.8759s
Epoch: 22 cost time: 10.299381256103516
Epoch: 22, Steps: 142 | Train Loss: 0.2121325 Vali Loss: 0.1882964 Test Loss: 0.2115704
Validation loss decreased (0.188540 --> 0.188296).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2131411
	speed: 0.1542s/iter; left time: 1692.1318s
Epoch: 23 cost time: 9.992792844772339
Epoch: 23, Steps: 142 | Train Loss: 0.2117012 Vali Loss: 0.1882440 Test Loss: 0.2112981
Validation loss decreased (0.188296 --> 0.188244).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2102204
	speed: 0.1567s/iter; left time: 1697.9925s
Epoch: 24 cost time: 10.318988800048828
Epoch: 24, Steps: 142 | Train Loss: 0.2115502 Vali Loss: 0.1881474 Test Loss: 0.2110485
Validation loss decreased (0.188244 --> 0.188147).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2030591
	speed: 0.1543s/iter; left time: 1650.0369s
Epoch: 25 cost time: 10.169082641601562
Epoch: 25, Steps: 142 | Train Loss: 0.2112362 Vali Loss: 0.1875288 Test Loss: 0.2108340
Validation loss decreased (0.188147 --> 0.187529).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2124013
	speed: 0.1521s/iter; left time: 1604.3563s
Epoch: 26 cost time: 10.040462970733643
Epoch: 26, Steps: 142 | Train Loss: 0.2111095 Vali Loss: 0.1873103 Test Loss: 0.2106259
Validation loss decreased (0.187529 --> 0.187310).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2064618
	speed: 0.1521s/iter; left time: 1583.3936s
Epoch: 27 cost time: 10.100620031356812
Epoch: 27, Steps: 142 | Train Loss: 0.2109242 Vali Loss: 0.1872011 Test Loss: 0.2104458
Validation loss decreased (0.187310 --> 0.187201).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2037915
	speed: 0.1547s/iter; left time: 1588.8125s
Epoch: 28 cost time: 10.11568021774292
Epoch: 28, Steps: 142 | Train Loss: 0.2106968 Vali Loss: 0.1871755 Test Loss: 0.2102886
Validation loss decreased (0.187201 --> 0.187176).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2188989
	speed: 0.1563s/iter; left time: 1582.9981s
Epoch: 29 cost time: 10.222703218460083
Epoch: 29, Steps: 142 | Train Loss: 0.2105608 Vali Loss: 0.1869917 Test Loss: 0.2101539
Validation loss decreased (0.187176 --> 0.186992).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1954702
	speed: 0.1566s/iter; left time: 1563.1528s
Epoch: 30 cost time: 10.278499126434326
Epoch: 30, Steps: 142 | Train Loss: 0.2104775 Vali Loss: 0.1871836 Test Loss: 0.2100266
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2063547
	speed: 0.1573s/iter; left time: 1548.3142s
Epoch: 31 cost time: 10.205803394317627
Epoch: 31, Steps: 142 | Train Loss: 0.2103404 Vali Loss: 0.1866780 Test Loss: 0.2099137
Validation loss decreased (0.186992 --> 0.186678).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1992672
	speed: 0.1594s/iter; left time: 1546.0022s
Epoch: 32 cost time: 10.130455493927002
Epoch: 32, Steps: 142 | Train Loss: 0.2102636 Vali Loss: 0.1871006 Test Loss: 0.2098072
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2044581
	speed: 0.1565s/iter; left time: 1496.1131s
Epoch: 33 cost time: 10.215441942214966
Epoch: 33, Steps: 142 | Train Loss: 0.2101445 Vali Loss: 0.1867130 Test Loss: 0.2097158
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2034358
	speed: 0.1546s/iter; left time: 1455.7737s
Epoch: 34 cost time: 10.087474346160889
Epoch: 34, Steps: 142 | Train Loss: 0.2100004 Vali Loss: 0.1867628 Test Loss: 0.2096345
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2056546
	speed: 0.1568s/iter; left time: 1453.9540s
Epoch: 35 cost time: 10.226421356201172
Epoch: 35, Steps: 142 | Train Loss: 0.2099876 Vali Loss: 0.1864838 Test Loss: 0.2095614
Validation loss decreased (0.186678 --> 0.186484).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2161537
	speed: 0.1563s/iter; left time: 1427.4483s
Epoch: 36 cost time: 10.04133677482605
Epoch: 36, Steps: 142 | Train Loss: 0.2098480 Vali Loss: 0.1863053 Test Loss: 0.2095022
Validation loss decreased (0.186484 --> 0.186305).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2198838
	speed: 0.1564s/iter; left time: 1405.9637s
Epoch: 37 cost time: 10.248459100723267
Epoch: 37, Steps: 142 | Train Loss: 0.2098447 Vali Loss: 0.1864128 Test Loss: 0.2094499
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2088019
	speed: 0.1550s/iter; left time: 1371.3510s
Epoch: 38 cost time: 10.137701749801636
Epoch: 38, Steps: 142 | Train Loss: 0.2097523 Vali Loss: 0.1864030 Test Loss: 0.2093950
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2152645
	speed: 0.1567s/iter; left time: 1363.9018s
Epoch: 39 cost time: 10.180882215499878
Epoch: 39, Steps: 142 | Train Loss: 0.2097235 Vali Loss: 0.1865690 Test Loss: 0.2093445
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2148707
	speed: 0.1555s/iter; left time: 1331.7392s
Epoch: 40 cost time: 10.120067596435547
Epoch: 40, Steps: 142 | Train Loss: 0.2096641 Vali Loss: 0.1861198 Test Loss: 0.2093044
Validation loss decreased (0.186305 --> 0.186120).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2200302
	speed: 0.1553s/iter; left time: 1307.8228s
Epoch: 41 cost time: 10.271713495254517
Epoch: 41, Steps: 142 | Train Loss: 0.2096305 Vali Loss: 0.1864423 Test Loss: 0.2092625
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2083543
	speed: 0.1552s/iter; left time: 1285.0214s
Epoch: 42 cost time: 9.938778638839722
Epoch: 42, Steps: 142 | Train Loss: 0.2095933 Vali Loss: 0.1864712 Test Loss: 0.2092417
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2000542
	speed: 0.1530s/iter; left time: 1245.3199s
Epoch: 43 cost time: 10.020642518997192
Epoch: 43, Steps: 142 | Train Loss: 0.2096181 Vali Loss: 0.1860281 Test Loss: 0.2092009
Validation loss decreased (0.186120 --> 0.186028).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2107867
	speed: 0.1573s/iter; left time: 1257.3477s
Epoch: 44 cost time: 10.138134241104126
Epoch: 44, Steps: 142 | Train Loss: 0.2095915 Vali Loss: 0.1863996 Test Loss: 0.2091784
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2005792
	speed: 0.1567s/iter; left time: 1230.9000s
Epoch: 45 cost time: 10.17577075958252
Epoch: 45, Steps: 142 | Train Loss: 0.2095125 Vali Loss: 0.1865415 Test Loss: 0.2091549
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2184376
	speed: 0.1563s/iter; left time: 1205.2814s
Epoch: 46 cost time: 10.106113910675049
Epoch: 46, Steps: 142 | Train Loss: 0.2095226 Vali Loss: 0.1859924 Test Loss: 0.2091312
Validation loss decreased (0.186028 --> 0.185992).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2135115
	speed: 0.1542s/iter; left time: 1167.2106s
Epoch: 47 cost time: 10.12952709197998
Epoch: 47, Steps: 142 | Train Loss: 0.2095171 Vali Loss: 0.1862980 Test Loss: 0.2091134
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2071633
	speed: 0.1545s/iter; left time: 1147.5035s
Epoch: 48 cost time: 10.085691928863525
Epoch: 48, Steps: 142 | Train Loss: 0.2094991 Vali Loss: 0.1861181 Test Loss: 0.2090997
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2082942
	speed: 0.1552s/iter; left time: 1130.9189s
Epoch: 49 cost time: 10.205711364746094
Epoch: 49, Steps: 142 | Train Loss: 0.2095040 Vali Loss: 0.1859819 Test Loss: 0.2090810
Validation loss decreased (0.185992 --> 0.185982).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2063522
	speed: 0.1550s/iter; left time: 1107.5105s
Epoch: 50 cost time: 10.046786546707153
Epoch: 50, Steps: 142 | Train Loss: 0.2094490 Vali Loss: 0.1862577 Test Loss: 0.2090722
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2052845
	speed: 0.1530s/iter; left time: 1070.9076s
Epoch: 51 cost time: 10.017829656600952
Epoch: 51, Steps: 142 | Train Loss: 0.2093849 Vali Loss: 0.1862530 Test Loss: 0.2090615
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2120380
	speed: 0.1569s/iter; left time: 1075.9296s
Epoch: 52 cost time: 10.271337509155273
Epoch: 52, Steps: 142 | Train Loss: 0.2093949 Vali Loss: 0.1861152 Test Loss: 0.2090488
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2139351
	speed: 0.1570s/iter; left time: 1054.6849s
Epoch: 53 cost time: 10.331681489944458
Epoch: 53, Steps: 142 | Train Loss: 0.2094660 Vali Loss: 0.1861997 Test Loss: 0.2090445
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2115387
	speed: 0.1573s/iter; left time: 1034.1821s
Epoch: 54 cost time: 10.253443241119385
Epoch: 54, Steps: 142 | Train Loss: 0.2093993 Vali Loss: 0.1861474 Test Loss: 0.2090329
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2102374
	speed: 0.1575s/iter; left time: 1013.0902s
Epoch: 55 cost time: 10.355756759643555
Epoch: 55, Steps: 142 | Train Loss: 0.2093668 Vali Loss: 0.1861945 Test Loss: 0.2090222
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2067090
	speed: 0.1561s/iter; left time: 981.9267s
Epoch: 56 cost time: 10.24014163017273
Epoch: 56, Steps: 142 | Train Loss: 0.2094116 Vali Loss: 0.1862119 Test Loss: 0.2090149
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1978507
	speed: 0.1530s/iter; left time: 940.6711s
Epoch: 57 cost time: 10.025293111801147
Epoch: 57, Steps: 142 | Train Loss: 0.2093740 Vali Loss: 0.1858703 Test Loss: 0.2090079
Validation loss decreased (0.185982 --> 0.185870).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2083298
	speed: 0.1570s/iter; left time: 942.9078s
Epoch: 58 cost time: 10.115739345550537
Epoch: 58, Steps: 142 | Train Loss: 0.2093874 Vali Loss: 0.1862478 Test Loss: 0.2090033
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2159853
	speed: 0.1557s/iter; left time: 912.9297s
Epoch: 59 cost time: 10.297144651412964
Epoch: 59, Steps: 142 | Train Loss: 0.2093410 Vali Loss: 0.1862450 Test Loss: 0.2089965
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.2073175
	speed: 0.1572s/iter; left time: 899.5614s
Epoch: 60 cost time: 10.182838678359985
Epoch: 60, Steps: 142 | Train Loss: 0.2093174 Vali Loss: 0.1857281 Test Loss: 0.2089908
Validation loss decreased (0.185870 --> 0.185728).  Saving model ...
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1994854
	speed: 0.1590s/iter; left time: 887.2342s
Epoch: 61 cost time: 10.288600206375122
Epoch: 61, Steps: 142 | Train Loss: 0.2092896 Vali Loss: 0.1860140 Test Loss: 0.2089884
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2335719
	speed: 0.1596s/iter; left time: 867.8117s
Epoch: 62 cost time: 10.416957139968872
Epoch: 62, Steps: 142 | Train Loss: 0.2093933 Vali Loss: 0.1862318 Test Loss: 0.2089838
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2131050
	speed: 0.1607s/iter; left time: 851.1772s
Epoch: 63 cost time: 10.651617527008057
Epoch: 63, Steps: 142 | Train Loss: 0.2093656 Vali Loss: 0.1860479 Test Loss: 0.2089809
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2024500
	speed: 0.1641s/iter; left time: 845.7983s
Epoch: 64 cost time: 10.716984033584595
Epoch: 64, Steps: 142 | Train Loss: 0.2093244 Vali Loss: 0.1862284 Test Loss: 0.2089750
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2212471
	speed: 0.1628s/iter; left time: 816.0546s
Epoch: 65 cost time: 10.572458982467651
Epoch: 65, Steps: 142 | Train Loss: 0.2093126 Vali Loss: 0.1860667 Test Loss: 0.2089706
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2151558
	speed: 0.1600s/iter; left time: 779.5364s
Epoch: 66 cost time: 10.340883731842041
Epoch: 66, Steps: 142 | Train Loss: 0.2093377 Vali Loss: 0.1863900 Test Loss: 0.2089698
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2254821
	speed: 0.1560s/iter; left time: 737.5492s
Epoch: 67 cost time: 10.14260745048523
Epoch: 67, Steps: 142 | Train Loss: 0.2093470 Vali Loss: 0.1862219 Test Loss: 0.2089667
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1976941
	speed: 0.1563s/iter; left time: 716.9358s
Epoch: 68 cost time: 10.055176734924316
Epoch: 68, Steps: 142 | Train Loss: 0.2093461 Vali Loss: 0.1860439 Test Loss: 0.2089658
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2178654
	speed: 0.1545s/iter; left time: 686.8504s
Epoch: 69 cost time: 9.890262126922607
Epoch: 69, Steps: 142 | Train Loss: 0.2093330 Vali Loss: 0.1858520 Test Loss: 0.2089633
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2142711
	speed: 0.1546s/iter; left time: 665.3803s
Epoch: 70 cost time: 10.024649858474731
Epoch: 70, Steps: 142 | Train Loss: 0.2092800 Vali Loss: 0.1861085 Test Loss: 0.2089591
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2119270
	speed: 0.1589s/iter; left time: 661.0668s
Epoch: 71 cost time: 10.474631786346436
Epoch: 71, Steps: 142 | Train Loss: 0.2093635 Vali Loss: 0.1864273 Test Loss: 0.2089570
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2009958
	speed: 0.1575s/iter; left time: 632.9921s
Epoch: 72 cost time: 10.155358076095581
Epoch: 72, Steps: 142 | Train Loss: 0.2092666 Vali Loss: 0.1865326 Test Loss: 0.2089540
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1960524
	speed: 0.1539s/iter; left time: 596.6670s
Epoch: 73 cost time: 10.154564619064331
Epoch: 73, Steps: 142 | Train Loss: 0.2093308 Vali Loss: 0.1858275 Test Loss: 0.2089528
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1981616
	speed: 0.1559s/iter; left time: 582.3214s
Epoch: 74 cost time: 10.248879671096802
Epoch: 74, Steps: 142 | Train Loss: 0.2092667 Vali Loss: 0.1858687 Test Loss: 0.2089532
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2046254
	speed: 0.1561s/iter; left time: 560.7713s
Epoch: 75 cost time: 10.267839193344116
Epoch: 75, Steps: 142 | Train Loss: 0.2092701 Vali Loss: 0.1861722 Test Loss: 0.2089519
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.2117198
	speed: 0.1545s/iter; left time: 533.3147s
Epoch: 76 cost time: 9.819666862487793
Epoch: 76, Steps: 142 | Train Loss: 0.2092867 Vali Loss: 0.1862185 Test Loss: 0.2089509
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2003992
	speed: 0.1517s/iter; left time: 502.1001s
Epoch: 77 cost time: 10.059260845184326
Epoch: 77, Steps: 142 | Train Loss: 0.2093333 Vali Loss: 0.1861654 Test Loss: 0.2089470
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2185615
	speed: 0.1570s/iter; left time: 497.2064s
Epoch: 78 cost time: 10.415364503860474
Epoch: 78, Steps: 142 | Train Loss: 0.2093565 Vali Loss: 0.1862617 Test Loss: 0.2089456
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.2169941
	speed: 0.1615s/iter; left time: 488.4612s
Epoch: 79 cost time: 10.438223600387573
Epoch: 79, Steps: 142 | Train Loss: 0.2092927 Vali Loss: 0.1861904 Test Loss: 0.2089463
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1990311
	speed: 0.1575s/iter; left time: 454.0082s
Epoch: 80 cost time: 10.156100034713745
Epoch: 80, Steps: 142 | Train Loss: 0.2093590 Vali Loss: 0.1858116 Test Loss: 0.2089442
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_90_j96_H6_FITS_custom_ftM_sl90_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.20793981850147247, mae:0.28473323583602905, rse:0.4532237946987152, corr:[0.46214697 0.46058127 0.45981625 0.4583391  0.4578884  0.45741427
 0.45709124 0.45670694 0.45572343 0.45464912 0.4539053  0.45322868
 0.4527602  0.452111   0.45197916 0.45142868 0.45148256 0.4516757
 0.451726   0.45194423 0.45195287 0.45216346 0.45215333 0.4511517
 0.4489825  0.44755927 0.44610372 0.44513163 0.44474205 0.4445429
 0.44549605 0.4455441  0.44487885 0.4445821  0.4440665  0.44362032
 0.44365132 0.44331682 0.44334975 0.44317058 0.44323117 0.44350338
 0.44359234 0.44376826 0.44400105 0.44433448 0.44433555 0.44414416
 0.44313404 0.44273993 0.4424768  0.44271174 0.44368246 0.44498408
 0.44727394 0.4485144  0.4484646  0.44849646 0.4482885  0.44800833
 0.44815528 0.44790357 0.4482075  0.44849172 0.4486975  0.44908845
 0.44938913 0.44959044 0.44989005 0.45038313 0.4506586  0.45102066
 0.45117468 0.45167822 0.4523148  0.45349964 0.45527425 0.4577814
 0.4608862  0.4630239  0.46326357 0.46301147 0.46269313 0.4623243
 0.4624419  0.4621644  0.46243227 0.46260703 0.462633   0.46290755
 0.46289054 0.46273834 0.4626558  0.46269393 0.46241382 0.4627777 ]
