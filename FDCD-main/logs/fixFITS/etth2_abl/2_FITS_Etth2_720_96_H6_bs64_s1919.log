Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=196, d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh2_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=1919, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_720_96_FITS_ETTh2_ftM_sl720_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  38986752.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.4447352886199951
Epoch: 1, Steps: 61 | Train Loss: 0.5475495 Vali Loss: 0.3778959 Test Loss: 0.3767291
Validation loss decreased (inf --> 0.377896).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.4502172470092773
Epoch: 2, Steps: 61 | Train Loss: 0.4218365 Vali Loss: 0.3338650 Test Loss: 0.3413261
Validation loss decreased (0.377896 --> 0.333865).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.482532024383545
Epoch: 3, Steps: 61 | Train Loss: 0.3611411 Vali Loss: 0.3205592 Test Loss: 0.3302863
Validation loss decreased (0.333865 --> 0.320559).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.3715929985046387
Epoch: 4, Steps: 61 | Train Loss: 0.3244514 Vali Loss: 0.3151825 Test Loss: 0.3268040
Validation loss decreased (0.320559 --> 0.315183).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.4368512630462646
Epoch: 5, Steps: 61 | Train Loss: 0.2974114 Vali Loss: 0.3128887 Test Loss: 0.3247965
Validation loss decreased (0.315183 --> 0.312889).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.3482568264007568
Epoch: 6, Steps: 61 | Train Loss: 0.2762842 Vali Loss: 0.3107137 Test Loss: 0.3239097
Validation loss decreased (0.312889 --> 0.310714).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.397763729095459
Epoch: 7, Steps: 61 | Train Loss: 0.2586190 Vali Loss: 0.3084939 Test Loss: 0.3226745
Validation loss decreased (0.310714 --> 0.308494).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.4619126319885254
Epoch: 8, Steps: 61 | Train Loss: 0.2431993 Vali Loss: 0.3054102 Test Loss: 0.3211519
Validation loss decreased (0.308494 --> 0.305410).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.3880093097686768
Epoch: 9, Steps: 61 | Train Loss: 0.2305161 Vali Loss: 0.3028561 Test Loss: 0.3197058
Validation loss decreased (0.305410 --> 0.302856).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.3635904788970947
Epoch: 10, Steps: 61 | Train Loss: 0.2190097 Vali Loss: 0.3008703 Test Loss: 0.3182757
Validation loss decreased (0.302856 --> 0.300870).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.3760294914245605
Epoch: 11, Steps: 61 | Train Loss: 0.2083822 Vali Loss: 0.2975201 Test Loss: 0.3163784
Validation loss decreased (0.300870 --> 0.297520).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 2.2699458599090576
Epoch: 12, Steps: 61 | Train Loss: 0.1994598 Vali Loss: 0.2951470 Test Loss: 0.3148887
Validation loss decreased (0.297520 --> 0.295147).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.3902900218963623
Epoch: 13, Steps: 61 | Train Loss: 0.1912595 Vali Loss: 0.2933572 Test Loss: 0.3133093
Validation loss decreased (0.295147 --> 0.293357).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.4522275924682617
Epoch: 14, Steps: 61 | Train Loss: 0.1839462 Vali Loss: 0.2907307 Test Loss: 0.3117784
Validation loss decreased (0.293357 --> 0.290731).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.467482089996338
Epoch: 15, Steps: 61 | Train Loss: 0.1773250 Vali Loss: 0.2879837 Test Loss: 0.3101152
Validation loss decreased (0.290731 --> 0.287984).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.403350830078125
Epoch: 16, Steps: 61 | Train Loss: 0.1713067 Vali Loss: 0.2857788 Test Loss: 0.3085798
Validation loss decreased (0.287984 --> 0.285779).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.5085315704345703
Epoch: 17, Steps: 61 | Train Loss: 0.1656254 Vali Loss: 0.2843378 Test Loss: 0.3072655
Validation loss decreased (0.285779 --> 0.284338).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.4058003425598145
Epoch: 18, Steps: 61 | Train Loss: 0.1604737 Vali Loss: 0.2821705 Test Loss: 0.3058566
Validation loss decreased (0.284338 --> 0.282171).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.3159422874450684
Epoch: 19, Steps: 61 | Train Loss: 0.1561909 Vali Loss: 0.2802664 Test Loss: 0.3047232
Validation loss decreased (0.282171 --> 0.280266).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.4514782428741455
Epoch: 20, Steps: 61 | Train Loss: 0.1518099 Vali Loss: 0.2784597 Test Loss: 0.3034953
Validation loss decreased (0.280266 --> 0.278460).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.355626106262207
Epoch: 21, Steps: 61 | Train Loss: 0.1480990 Vali Loss: 0.2772333 Test Loss: 0.3023368
Validation loss decreased (0.278460 --> 0.277233).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.3261606693267822
Epoch: 22, Steps: 61 | Train Loss: 0.1444524 Vali Loss: 0.2752901 Test Loss: 0.3013667
Validation loss decreased (0.277233 --> 0.275290).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 1.4081096649169922
Epoch: 23, Steps: 61 | Train Loss: 0.1412906 Vali Loss: 0.2735656 Test Loss: 0.3003671
Validation loss decreased (0.275290 --> 0.273566).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.3510758876800537
Epoch: 24, Steps: 61 | Train Loss: 0.1381804 Vali Loss: 0.2721998 Test Loss: 0.2994343
Validation loss decreased (0.273566 --> 0.272200).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.3734872341156006
Epoch: 25, Steps: 61 | Train Loss: 0.1352763 Vali Loss: 0.2711549 Test Loss: 0.2986565
Validation loss decreased (0.272200 --> 0.271155).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 1.4083800315856934
Epoch: 26, Steps: 61 | Train Loss: 0.1328859 Vali Loss: 0.2702823 Test Loss: 0.2977221
Validation loss decreased (0.271155 --> 0.270282).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.2673907279968262
Epoch: 27, Steps: 61 | Train Loss: 0.1303594 Vali Loss: 0.2687636 Test Loss: 0.2970094
Validation loss decreased (0.270282 --> 0.268764).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 1.350600004196167
Epoch: 28, Steps: 61 | Train Loss: 0.1282101 Vali Loss: 0.2672172 Test Loss: 0.2962442
Validation loss decreased (0.268764 --> 0.267217).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.3951146602630615
Epoch: 29, Steps: 61 | Train Loss: 0.1261561 Vali Loss: 0.2660502 Test Loss: 0.2956271
Validation loss decreased (0.267217 --> 0.266050).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.3052973747253418
Epoch: 30, Steps: 61 | Train Loss: 0.1242064 Vali Loss: 0.2645630 Test Loss: 0.2949379
Validation loss decreased (0.266050 --> 0.264563).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 1.286804437637329
Epoch: 31, Steps: 61 | Train Loss: 0.1221772 Vali Loss: 0.2643821 Test Loss: 0.2943478
Validation loss decreased (0.264563 --> 0.264382).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.3456637859344482
Epoch: 32, Steps: 61 | Train Loss: 0.1207065 Vali Loss: 0.2633813 Test Loss: 0.2938856
Validation loss decreased (0.264382 --> 0.263381).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.3368949890136719
Epoch: 33, Steps: 61 | Train Loss: 0.1191990 Vali Loss: 0.2618509 Test Loss: 0.2932678
Validation loss decreased (0.263381 --> 0.261851).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.4747602939605713
Epoch: 34, Steps: 61 | Train Loss: 0.1176908 Vali Loss: 0.2620669 Test Loss: 0.2927882
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.3671953678131104
Epoch: 35, Steps: 61 | Train Loss: 0.1162304 Vali Loss: 0.2608927 Test Loss: 0.2923278
Validation loss decreased (0.261851 --> 0.260893).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.321411371231079
Epoch: 36, Steps: 61 | Train Loss: 0.1150001 Vali Loss: 0.2598473 Test Loss: 0.2918738
Validation loss decreased (0.260893 --> 0.259847).  Saving model ...
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.5604257583618164
Epoch: 37, Steps: 61 | Train Loss: 0.1138679 Vali Loss: 0.2594020 Test Loss: 0.2914946
Validation loss decreased (0.259847 --> 0.259402).  Saving model ...
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.39859938621521
Epoch: 38, Steps: 61 | Train Loss: 0.1126627 Vali Loss: 0.2598443 Test Loss: 0.2911204
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.3504095077514648
Epoch: 39, Steps: 61 | Train Loss: 0.1116460 Vali Loss: 0.2601630 Test Loss: 0.2907871
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.4053924083709717
Epoch: 40, Steps: 61 | Train Loss: 0.1105964 Vali Loss: 0.2575639 Test Loss: 0.2903645
Validation loss decreased (0.259402 --> 0.257564).  Saving model ...
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 1.3906540870666504
Epoch: 41, Steps: 61 | Train Loss: 0.1096407 Vali Loss: 0.2577491 Test Loss: 0.2899978
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.3844738006591797
Epoch: 42, Steps: 61 | Train Loss: 0.1086163 Vali Loss: 0.2565692 Test Loss: 0.2897160
Validation loss decreased (0.257564 --> 0.256569).  Saving model ...
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.2922916412353516
Epoch: 43, Steps: 61 | Train Loss: 0.1077550 Vali Loss: 0.2568914 Test Loss: 0.2894001
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.3985919952392578
Epoch: 44, Steps: 61 | Train Loss: 0.1070917 Vali Loss: 0.2559651 Test Loss: 0.2891703
Validation loss decreased (0.256569 --> 0.255965).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.3204517364501953
Epoch: 45, Steps: 61 | Train Loss: 0.1064622 Vali Loss: 0.2554151 Test Loss: 0.2889257
Validation loss decreased (0.255965 --> 0.255415).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.3229894638061523
Epoch: 46, Steps: 61 | Train Loss: 0.1057353 Vali Loss: 0.2547700 Test Loss: 0.2886400
Validation loss decreased (0.255415 --> 0.254770).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.36118483543396
Epoch: 47, Steps: 61 | Train Loss: 0.1051340 Vali Loss: 0.2543650 Test Loss: 0.2883872
Validation loss decreased (0.254770 --> 0.254365).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.3737788200378418
Epoch: 48, Steps: 61 | Train Loss: 0.1043993 Vali Loss: 0.2547762 Test Loss: 0.2881989
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.3583598136901855
Epoch: 49, Steps: 61 | Train Loss: 0.1038786 Vali Loss: 0.2534544 Test Loss: 0.2880056
Validation loss decreased (0.254365 --> 0.253454).  Saving model ...
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.3758511543273926
Epoch: 50, Steps: 61 | Train Loss: 0.1032834 Vali Loss: 0.2543257 Test Loss: 0.2877917
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.4294111728668213
Epoch: 51, Steps: 61 | Train Loss: 0.1026851 Vali Loss: 0.2540154 Test Loss: 0.2876039
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.3801980018615723
Epoch: 52, Steps: 61 | Train Loss: 0.1022748 Vali Loss: 0.2535416 Test Loss: 0.2874196
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.3558940887451172
Epoch: 53, Steps: 61 | Train Loss: 0.1017307 Vali Loss: 0.2530486 Test Loss: 0.2872702
Validation loss decreased (0.253454 --> 0.253049).  Saving model ...
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.3566920757293701
Epoch: 54, Steps: 61 | Train Loss: 0.1012706 Vali Loss: 0.2532997 Test Loss: 0.2871120
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 1.382045030593872
Epoch: 55, Steps: 61 | Train Loss: 0.1009403 Vali Loss: 0.2523993 Test Loss: 0.2869701
Validation loss decreased (0.253049 --> 0.252399).  Saving model ...
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 1.391474962234497
Epoch: 56, Steps: 61 | Train Loss: 0.1004818 Vali Loss: 0.2524243 Test Loss: 0.2868009
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 1.295046091079712
Epoch: 57, Steps: 61 | Train Loss: 0.1000789 Vali Loss: 0.2521642 Test Loss: 0.2866824
Validation loss decreased (0.252399 --> 0.252164).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 1.375774621963501
Epoch: 58, Steps: 61 | Train Loss: 0.0997366 Vali Loss: 0.2514579 Test Loss: 0.2865306
Validation loss decreased (0.252164 --> 0.251458).  Saving model ...
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.3823435306549072
Epoch: 59, Steps: 61 | Train Loss: 0.0994385 Vali Loss: 0.2522573 Test Loss: 0.2864245
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.4125044345855713
Epoch: 60, Steps: 61 | Train Loss: 0.0990897 Vali Loss: 0.2520158 Test Loss: 0.2862940
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.433150291442871
Epoch: 61, Steps: 61 | Train Loss: 0.0987071 Vali Loss: 0.2516993 Test Loss: 0.2861870
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.343142032623291
Epoch: 62, Steps: 61 | Train Loss: 0.0984603 Vali Loss: 0.2513819 Test Loss: 0.2860825
Validation loss decreased (0.251458 --> 0.251382).  Saving model ...
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.3701879978179932
Epoch: 63, Steps: 61 | Train Loss: 0.0981272 Vali Loss: 0.2501381 Test Loss: 0.2859834
Validation loss decreased (0.251382 --> 0.250138).  Saving model ...
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 1.409942388534546
Epoch: 64, Steps: 61 | Train Loss: 0.0978778 Vali Loss: 0.2511052 Test Loss: 0.2858996
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 1.323472499847412
Epoch: 65, Steps: 61 | Train Loss: 0.0976616 Vali Loss: 0.2504084 Test Loss: 0.2858074
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.344996690750122
Epoch: 66, Steps: 61 | Train Loss: 0.0972990 Vali Loss: 0.2504663 Test Loss: 0.2857356
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 1.3491473197937012
Epoch: 67, Steps: 61 | Train Loss: 0.0971707 Vali Loss: 0.2504407 Test Loss: 0.2856446
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.3344485759735107
Epoch: 68, Steps: 61 | Train Loss: 0.0968943 Vali Loss: 0.2505875 Test Loss: 0.2855593
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 1.3358182907104492
Epoch: 69, Steps: 61 | Train Loss: 0.0966935 Vali Loss: 0.2513655 Test Loss: 0.2854854
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 1.342153787612915
Epoch: 70, Steps: 61 | Train Loss: 0.0965361 Vali Loss: 0.2501630 Test Loss: 0.2854106
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 1.3456931114196777
Epoch: 71, Steps: 61 | Train Loss: 0.0963791 Vali Loss: 0.2492662 Test Loss: 0.2853393
Validation loss decreased (0.250138 --> 0.249266).  Saving model ...
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 1.3637738227844238
Epoch: 72, Steps: 61 | Train Loss: 0.0962039 Vali Loss: 0.2497266 Test Loss: 0.2852893
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 1.3113062381744385
Epoch: 73, Steps: 61 | Train Loss: 0.0959743 Vali Loss: 0.2498355 Test Loss: 0.2852250
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 1.2976322174072266
Epoch: 74, Steps: 61 | Train Loss: 0.0958939 Vali Loss: 0.2505441 Test Loss: 0.2851580
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 1.29709792137146
Epoch: 75, Steps: 61 | Train Loss: 0.0956904 Vali Loss: 0.2499922 Test Loss: 0.2851213
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 1.371701717376709
Epoch: 76, Steps: 61 | Train Loss: 0.0956486 Vali Loss: 0.2495227 Test Loss: 0.2850672
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 1.4699113368988037
Epoch: 77, Steps: 61 | Train Loss: 0.0953938 Vali Loss: 0.2496428 Test Loss: 0.2850106
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 1.3978192806243896
Epoch: 78, Steps: 61 | Train Loss: 0.0953829 Vali Loss: 0.2495860 Test Loss: 0.2849670
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 1.387955904006958
Epoch: 79, Steps: 61 | Train Loss: 0.0951314 Vali Loss: 0.2490409 Test Loss: 0.2849230
Validation loss decreased (0.249266 --> 0.249041).  Saving model ...
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 1.3166306018829346
Epoch: 80, Steps: 61 | Train Loss: 0.0949428 Vali Loss: 0.2495507 Test Loss: 0.2848791
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 1.3106591701507568
Epoch: 81, Steps: 61 | Train Loss: 0.0949628 Vali Loss: 0.2488418 Test Loss: 0.2848399
Validation loss decreased (0.249041 --> 0.248842).  Saving model ...
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 1.3449532985687256
Epoch: 82, Steps: 61 | Train Loss: 0.0948415 Vali Loss: 0.2486225 Test Loss: 0.2848053
Validation loss decreased (0.248842 --> 0.248622).  Saving model ...
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 1.3858578205108643
Epoch: 83, Steps: 61 | Train Loss: 0.0947631 Vali Loss: 0.2487605 Test Loss: 0.2847656
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 1.3977043628692627
Epoch: 84, Steps: 61 | Train Loss: 0.0947091 Vali Loss: 0.2486392 Test Loss: 0.2847311
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 1.3045611381530762
Epoch: 85, Steps: 61 | Train Loss: 0.0945728 Vali Loss: 0.2488695 Test Loss: 0.2846982
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 1.3431146144866943
Epoch: 86, Steps: 61 | Train Loss: 0.0944353 Vali Loss: 0.2483048 Test Loss: 0.2846750
Validation loss decreased (0.248622 --> 0.248305).  Saving model ...
Updating learning rate to 6.389640937399644e-06
Epoch: 87 cost time: 1.3187851905822754
Epoch: 87, Steps: 61 | Train Loss: 0.0943596 Vali Loss: 0.2485107 Test Loss: 0.2846356
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.070158890529662e-06
Epoch: 88 cost time: 1.3654263019561768
Epoch: 88, Steps: 61 | Train Loss: 0.0943457 Vali Loss: 0.2484739 Test Loss: 0.2846086
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.766650946003179e-06
Epoch: 89 cost time: 1.3470368385314941
Epoch: 89, Steps: 61 | Train Loss: 0.0942221 Vali Loss: 0.2494173 Test Loss: 0.2845834
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.47831839870302e-06
Epoch: 90 cost time: 1.306792974472046
Epoch: 90, Steps: 61 | Train Loss: 0.0941301 Vali Loss: 0.2482076 Test Loss: 0.2845530
Validation loss decreased (0.248305 --> 0.248208).  Saving model ...
Updating learning rate to 5.204402478767869e-06
Epoch: 91 cost time: 1.351327657699585
Epoch: 91, Steps: 61 | Train Loss: 0.0940255 Vali Loss: 0.2482103 Test Loss: 0.2845317
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.944182354829475e-06
Epoch: 92 cost time: 1.30076003074646
Epoch: 92, Steps: 61 | Train Loss: 0.0940383 Vali Loss: 0.2481272 Test Loss: 0.2845086
Validation loss decreased (0.248208 --> 0.248127).  Saving model ...
Updating learning rate to 4.696973237088e-06
Epoch: 93 cost time: 1.3654601573944092
Epoch: 93, Steps: 61 | Train Loss: 0.0939982 Vali Loss: 0.2488580 Test Loss: 0.2844861
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.462124575233601e-06
Epoch: 94 cost time: 1.3766062259674072
Epoch: 94, Steps: 61 | Train Loss: 0.0939584 Vali Loss: 0.2482958 Test Loss: 0.2844636
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.239018346471921e-06
Epoch: 95 cost time: 1.3817226886749268
Epoch: 95, Steps: 61 | Train Loss: 0.0938227 Vali Loss: 0.2489935 Test Loss: 0.2844466
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.027067429148324e-06
Epoch: 96 cost time: 1.4111895561218262
Epoch: 96, Steps: 61 | Train Loss: 0.0937270 Vali Loss: 0.2487116 Test Loss: 0.2844259
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.825714057690908e-06
Epoch: 97 cost time: 1.354562759399414
Epoch: 97, Steps: 61 | Train Loss: 0.0936457 Vali Loss: 0.2485368 Test Loss: 0.2844110
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.6344283548063623e-06
Epoch: 98 cost time: 1.3805263042449951
Epoch: 98, Steps: 61 | Train Loss: 0.0937226 Vali Loss: 0.2480135 Test Loss: 0.2843906
Validation loss decreased (0.248127 --> 0.248014).  Saving model ...
Updating learning rate to 3.452706937066044e-06
Epoch: 99 cost time: 1.3904471397399902
Epoch: 99, Steps: 61 | Train Loss: 0.0936528 Vali Loss: 0.2483707 Test Loss: 0.2843749
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.2800715902127414e-06
Epoch: 100 cost time: 1.3658251762390137
Epoch: 100, Steps: 61 | Train Loss: 0.0936585 Vali Loss: 0.2480140 Test Loss: 0.2843594
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.1160680107021042e-06
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  38986752.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.2685222625732422
Epoch: 1, Steps: 61 | Train Loss: 0.4232252 Vali Loss: 0.2239755 Test Loss: 0.2734317
Validation loss decreased (inf --> 0.223975).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.3202149868011475
Epoch: 2, Steps: 61 | Train Loss: 0.4097643 Vali Loss: 0.2204395 Test Loss: 0.2734537
Validation loss decreased (0.223975 --> 0.220439).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.3948330879211426
Epoch: 3, Steps: 61 | Train Loss: 0.4073873 Vali Loss: 0.2176797 Test Loss: 0.2727641
Validation loss decreased (0.220439 --> 0.217680).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.3766660690307617
Epoch: 4, Steps: 61 | Train Loss: 0.4051518 Vali Loss: 0.2157576 Test Loss: 0.2727681
Validation loss decreased (0.217680 --> 0.215758).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.334585428237915
Epoch: 5, Steps: 61 | Train Loss: 0.4036244 Vali Loss: 0.2147451 Test Loss: 0.2726664
Validation loss decreased (0.215758 --> 0.214745).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.3204550743103027
Epoch: 6, Steps: 61 | Train Loss: 0.4033757 Vali Loss: 0.2135733 Test Loss: 0.2724619
Validation loss decreased (0.214745 --> 0.213573).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.3576149940490723
Epoch: 7, Steps: 61 | Train Loss: 0.4026787 Vali Loss: 0.2138830 Test Loss: 0.2722310
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.3770864009857178
Epoch: 8, Steps: 61 | Train Loss: 0.4022790 Vali Loss: 0.2146193 Test Loss: 0.2719572
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.3408150672912598
Epoch: 9, Steps: 61 | Train Loss: 0.4014713 Vali Loss: 0.2135008 Test Loss: 0.2721233
Validation loss decreased (0.213573 --> 0.213501).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.4067652225494385
Epoch: 10, Steps: 61 | Train Loss: 0.4013950 Vali Loss: 0.2132880 Test Loss: 0.2721056
Validation loss decreased (0.213501 --> 0.213288).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.3839523792266846
Epoch: 11, Steps: 61 | Train Loss: 0.4010132 Vali Loss: 0.2127132 Test Loss: 0.2719388
Validation loss decreased (0.213288 --> 0.212713).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.4423038959503174
Epoch: 12, Steps: 61 | Train Loss: 0.4006586 Vali Loss: 0.2128462 Test Loss: 0.2720417
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.4548838138580322
Epoch: 13, Steps: 61 | Train Loss: 0.3991924 Vali Loss: 0.2125927 Test Loss: 0.2718873
Validation loss decreased (0.212713 --> 0.212593).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.381131649017334
Epoch: 14, Steps: 61 | Train Loss: 0.4000586 Vali Loss: 0.2131951 Test Loss: 0.2718113
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.2674968242645264
Epoch: 15, Steps: 61 | Train Loss: 0.3997121 Vali Loss: 0.2127450 Test Loss: 0.2719261
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.3396875858306885
Epoch: 16, Steps: 61 | Train Loss: 0.3988972 Vali Loss: 0.2128446 Test Loss: 0.2718167
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.2618298530578613
Epoch: 17, Steps: 61 | Train Loss: 0.3992460 Vali Loss: 0.2125398 Test Loss: 0.2716002
Validation loss decreased (0.212593 --> 0.212540).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.3764145374298096
Epoch: 18, Steps: 61 | Train Loss: 0.3991366 Vali Loss: 0.2119249 Test Loss: 0.2715766
Validation loss decreased (0.212540 --> 0.211925).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.3461647033691406
Epoch: 19, Steps: 61 | Train Loss: 0.3994508 Vali Loss: 0.2126959 Test Loss: 0.2716219
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.3632862567901611
Epoch: 20, Steps: 61 | Train Loss: 0.3990543 Vali Loss: 0.2121548 Test Loss: 0.2716933
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.3129997253417969
Epoch: 21, Steps: 61 | Train Loss: 0.3987197 Vali Loss: 0.2134331 Test Loss: 0.2715385
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.312157392501831
Epoch: 22, Steps: 61 | Train Loss: 0.3987006 Vali Loss: 0.2122597 Test Loss: 0.2717742
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 1.3535313606262207
Epoch: 23, Steps: 61 | Train Loss: 0.3988720 Vali Loss: 0.2121948 Test Loss: 0.2715049
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.3538663387298584
Epoch: 24, Steps: 61 | Train Loss: 0.3976515 Vali Loss: 0.2125690 Test Loss: 0.2714975
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.3457951545715332
Epoch: 25, Steps: 61 | Train Loss: 0.3980288 Vali Loss: 0.2125962 Test Loss: 0.2715906
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 1.332883596420288
Epoch: 26, Steps: 61 | Train Loss: 0.3981179 Vali Loss: 0.2112490 Test Loss: 0.2713156
Validation loss decreased (0.211925 --> 0.211249).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.332608699798584
Epoch: 27, Steps: 61 | Train Loss: 0.3983533 Vali Loss: 0.2125149 Test Loss: 0.2713229
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 1.3685791492462158
Epoch: 28, Steps: 61 | Train Loss: 0.3978293 Vali Loss: 0.2126316 Test Loss: 0.2713104
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.3735311031341553
Epoch: 29, Steps: 61 | Train Loss: 0.3982004 Vali Loss: 0.2106701 Test Loss: 0.2713688
Validation loss decreased (0.211249 --> 0.210670).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.357405424118042
Epoch: 30, Steps: 61 | Train Loss: 0.3982918 Vali Loss: 0.2116453 Test Loss: 0.2712848
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 1.373448371887207
Epoch: 31, Steps: 61 | Train Loss: 0.3982248 Vali Loss: 0.2116853 Test Loss: 0.2714111
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.3660352230072021
Epoch: 32, Steps: 61 | Train Loss: 0.3970070 Vali Loss: 0.2110110 Test Loss: 0.2713451
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.521117925643921
Epoch: 33, Steps: 61 | Train Loss: 0.3976759 Vali Loss: 0.2109638 Test Loss: 0.2712682
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.3393893241882324
Epoch: 34, Steps: 61 | Train Loss: 0.3981978 Vali Loss: 0.2115808 Test Loss: 0.2714531
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.380453109741211
Epoch: 35, Steps: 61 | Train Loss: 0.3977097 Vali Loss: 0.2108126 Test Loss: 0.2713150
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.3968505859375
Epoch: 36, Steps: 61 | Train Loss: 0.3969772 Vali Loss: 0.2122966 Test Loss: 0.2712926
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.3552765846252441
Epoch: 37, Steps: 61 | Train Loss: 0.3971777 Vali Loss: 0.2107635 Test Loss: 0.2713805
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.4597923755645752
Epoch: 38, Steps: 61 | Train Loss: 0.3977244 Vali Loss: 0.2112438 Test Loss: 0.2712849
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.3933448791503906
Epoch: 39, Steps: 61 | Train Loss: 0.3972477 Vali Loss: 0.2111607 Test Loss: 0.2712791
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.4656522274017334
Epoch: 40, Steps: 61 | Train Loss: 0.3969287 Vali Loss: 0.2125496 Test Loss: 0.2713065
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 1.3795151710510254
Epoch: 41, Steps: 61 | Train Loss: 0.3972626 Vali Loss: 0.2108823 Test Loss: 0.2713308
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.4409539699554443
Epoch: 42, Steps: 61 | Train Loss: 0.3975548 Vali Loss: 0.2115881 Test Loss: 0.2712941
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.4405763149261475
Epoch: 43, Steps: 61 | Train Loss: 0.3974737 Vali Loss: 0.2117728 Test Loss: 0.2713127
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.404881238937378
Epoch: 44, Steps: 61 | Train Loss: 0.3977461 Vali Loss: 0.2121183 Test Loss: 0.2713138
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.3221347332000732
Epoch: 45, Steps: 61 | Train Loss: 0.3970469 Vali Loss: 0.2121165 Test Loss: 0.2712761
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.3315675258636475
Epoch: 46, Steps: 61 | Train Loss: 0.3975749 Vali Loss: 0.2115176 Test Loss: 0.2713142
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.3673207759857178
Epoch: 47, Steps: 61 | Train Loss: 0.3975580 Vali Loss: 0.2115284 Test Loss: 0.2712433
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.3187074661254883
Epoch: 48, Steps: 61 | Train Loss: 0.3974075 Vali Loss: 0.2119265 Test Loss: 0.2712747
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.4541583061218262
Epoch: 49, Steps: 61 | Train Loss: 0.3973190 Vali Loss: 0.2114366 Test Loss: 0.2712922
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh2_720_96_FITS_ETTh2_ftM_sl720_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.27107954025268555, mae:0.3361158072948456, rse:0.4195943772792816, corr:[0.2739193  0.27623963 0.2750372  0.2751501  0.2745261  0.27319536
 0.27270964 0.27240756 0.2714125  0.2700737  0.2690446  0.2676069
 0.26577717 0.26442036 0.26382962 0.26348677 0.26293835 0.26267153
 0.26230526 0.26100934 0.25932267 0.25831127 0.2575349  0.25570193
 0.25330368 0.25164586 0.25045177 0.24876891 0.24719521 0.24643105
 0.24564518 0.24412777 0.24229461 0.2410062  0.2397572  0.23848842
 0.23751542 0.23648776 0.23519577 0.23414183 0.23381047 0.23354125
 0.23299326 0.23212433 0.23096783 0.2296512  0.22877298 0.22771433
 0.22572462 0.22365579 0.22265673 0.22160497 0.22017986 0.21840978
 0.21643144 0.21464281 0.21270932 0.2109591  0.20964304 0.2082876
 0.207297   0.20720424 0.20761555 0.20764066 0.2070503  0.20717785
 0.20684312 0.20550668 0.20487931 0.20507535 0.20437966 0.2030502
 0.20221536 0.20167463 0.20076671 0.19924314 0.19856136 0.19814418
 0.19793887 0.19748886 0.19752195 0.1973383  0.19689411 0.19654241
 0.1955705  0.1953954  0.19635296 0.1963267  0.19407351 0.19401833
 0.19549073 0.19434007 0.19329543 0.19428007 0.19248119 0.19151439]
