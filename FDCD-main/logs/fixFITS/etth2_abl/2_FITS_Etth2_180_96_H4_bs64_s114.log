Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_180_96_FITS_ETTh2_ftM_sl180_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=42, out_features=64, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2408448.0
params:  2752.0
Trainable parameters:  2752
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 5.376781463623047
Epoch: 1, Steps: 65 | Train Loss: 0.4479525 Vali Loss: 0.2926075 Test Loss: 0.4002250
Validation loss decreased (inf --> 0.292607).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.3876278400421143
Epoch: 2, Steps: 65 | Train Loss: 0.3658765 Vali Loss: 0.2659301 Test Loss: 0.3631090
Validation loss decreased (0.292607 --> 0.265930).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 2.859851837158203
Epoch: 3, Steps: 65 | Train Loss: 0.3169215 Vali Loss: 0.2505417 Test Loss: 0.3419459
Validation loss decreased (0.265930 --> 0.250542).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 2.738274335861206
Epoch: 4, Steps: 65 | Train Loss: 0.2841405 Vali Loss: 0.2403325 Test Loss: 0.3292443
Validation loss decreased (0.250542 --> 0.240332).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 2.1113874912261963
Epoch: 5, Steps: 65 | Train Loss: 0.2614856 Vali Loss: 0.2364873 Test Loss: 0.3214179
Validation loss decreased (0.240332 --> 0.236487).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 2.0387258529663086
Epoch: 6, Steps: 65 | Train Loss: 0.2447727 Vali Loss: 0.2328987 Test Loss: 0.3161345
Validation loss decreased (0.236487 --> 0.232899).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 2.1605987548828125
Epoch: 7, Steps: 65 | Train Loss: 0.2326750 Vali Loss: 0.2297102 Test Loss: 0.3124507
Validation loss decreased (0.232899 --> 0.229710).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 2.6231188774108887
Epoch: 8, Steps: 65 | Train Loss: 0.2232579 Vali Loss: 0.2275469 Test Loss: 0.3097294
Validation loss decreased (0.229710 --> 0.227547).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 2.8602375984191895
Epoch: 9, Steps: 65 | Train Loss: 0.2152781 Vali Loss: 0.2248904 Test Loss: 0.3076666
Validation loss decreased (0.227547 --> 0.224890).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 2.804086446762085
Epoch: 10, Steps: 65 | Train Loss: 0.2090992 Vali Loss: 0.2241568 Test Loss: 0.3059916
Validation loss decreased (0.224890 --> 0.224157).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 4.853808641433716
Epoch: 11, Steps: 65 | Train Loss: 0.2039449 Vali Loss: 0.2236476 Test Loss: 0.3045963
Validation loss decreased (0.224157 --> 0.223648).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 2.1312386989593506
Epoch: 12, Steps: 65 | Train Loss: 0.1987059 Vali Loss: 0.2217135 Test Loss: 0.3034242
Validation loss decreased (0.223648 --> 0.221713).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 4.338500261306763
Epoch: 13, Steps: 65 | Train Loss: 0.1953828 Vali Loss: 0.2217048 Test Loss: 0.3024144
Validation loss decreased (0.221713 --> 0.221705).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 2.921457529067993
Epoch: 14, Steps: 65 | Train Loss: 0.1919393 Vali Loss: 0.2201638 Test Loss: 0.3015630
Validation loss decreased (0.221705 --> 0.220164).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 2.4406778812408447
Epoch: 15, Steps: 65 | Train Loss: 0.1884972 Vali Loss: 0.2209186 Test Loss: 0.3007734
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 4.823061466217041
Epoch: 16, Steps: 65 | Train Loss: 0.1859180 Vali Loss: 0.2193417 Test Loss: 0.3000708
Validation loss decreased (0.220164 --> 0.219342).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 2.80977201461792
Epoch: 17, Steps: 65 | Train Loss: 0.1839796 Vali Loss: 0.2194097 Test Loss: 0.2994626
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 2.3310434818267822
Epoch: 18, Steps: 65 | Train Loss: 0.1816480 Vali Loss: 0.2192010 Test Loss: 0.2988871
Validation loss decreased (0.219342 --> 0.219201).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 2.3751349449157715
Epoch: 19, Steps: 65 | Train Loss: 0.1801557 Vali Loss: 0.2184816 Test Loss: 0.2984071
Validation loss decreased (0.219201 --> 0.218482).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 2.0035955905914307
Epoch: 20, Steps: 65 | Train Loss: 0.1788301 Vali Loss: 0.2180413 Test Loss: 0.2979051
Validation loss decreased (0.218482 --> 0.218041).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 2.458737373352051
Epoch: 21, Steps: 65 | Train Loss: 0.1776173 Vali Loss: 0.2175449 Test Loss: 0.2975073
Validation loss decreased (0.218041 --> 0.217545).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 2.6335902214050293
Epoch: 22, Steps: 65 | Train Loss: 0.1760245 Vali Loss: 0.2161607 Test Loss: 0.2971040
Validation loss decreased (0.217545 --> 0.216161).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 2.018231153488159
Epoch: 23, Steps: 65 | Train Loss: 0.1745768 Vali Loss: 0.2169334 Test Loss: 0.2967576
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 2.0910234451293945
Epoch: 24, Steps: 65 | Train Loss: 0.1741359 Vali Loss: 0.2168960 Test Loss: 0.2964975
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.7006425857543945
Epoch: 25, Steps: 65 | Train Loss: 0.1728860 Vali Loss: 0.2162569 Test Loss: 0.2961585
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 3.416149377822876
Epoch: 26, Steps: 65 | Train Loss: 0.1721402 Vali Loss: 0.2168857 Test Loss: 0.2958826
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 4.132749557495117
Epoch: 27, Steps: 65 | Train Loss: 0.1714776 Vali Loss: 0.2168720 Test Loss: 0.2956770
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 2.344383955001831
Epoch: 28, Steps: 65 | Train Loss: 0.1702020 Vali Loss: 0.2160310 Test Loss: 0.2954315
Validation loss decreased (0.216161 --> 0.216031).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 2.560318946838379
Epoch: 29, Steps: 65 | Train Loss: 0.1693527 Vali Loss: 0.2157616 Test Loss: 0.2952322
Validation loss decreased (0.216031 --> 0.215762).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 2.0315496921539307
Epoch: 30, Steps: 65 | Train Loss: 0.1692494 Vali Loss: 0.2157050 Test Loss: 0.2950330
Validation loss decreased (0.215762 --> 0.215705).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 2.0493619441986084
Epoch: 31, Steps: 65 | Train Loss: 0.1683604 Vali Loss: 0.2152942 Test Loss: 0.2948177
Validation loss decreased (0.215705 --> 0.215294).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 2.650254964828491
Epoch: 32, Steps: 65 | Train Loss: 0.1679621 Vali Loss: 0.2152850 Test Loss: 0.2946771
Validation loss decreased (0.215294 --> 0.215285).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.581695795059204
Epoch: 33, Steps: 65 | Train Loss: 0.1675046 Vali Loss: 0.2156268 Test Loss: 0.2945153
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 2.0452487468719482
Epoch: 34, Steps: 65 | Train Loss: 0.1668110 Vali Loss: 0.2142119 Test Loss: 0.2943752
Validation loss decreased (0.215285 --> 0.214212).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 2.8286359310150146
Epoch: 35, Steps: 65 | Train Loss: 0.1670274 Vali Loss: 0.2138277 Test Loss: 0.2942539
Validation loss decreased (0.214212 --> 0.213828).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 3.0733835697174072
Epoch: 36, Steps: 65 | Train Loss: 0.1664308 Vali Loss: 0.2140466 Test Loss: 0.2941034
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.932945728302002
Epoch: 37, Steps: 65 | Train Loss: 0.1660915 Vali Loss: 0.2140182 Test Loss: 0.2939760
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 2.810173988342285
Epoch: 38, Steps: 65 | Train Loss: 0.1656759 Vali Loss: 0.2141846 Test Loss: 0.2938994
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 3.061025381088257
Epoch: 39, Steps: 65 | Train Loss: 0.1652740 Vali Loss: 0.2142220 Test Loss: 0.2937854
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 3.566291093826294
Epoch: 40, Steps: 65 | Train Loss: 0.1654991 Vali Loss: 0.2142611 Test Loss: 0.2936801
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 3.0439887046813965
Epoch: 41, Steps: 65 | Train Loss: 0.1652207 Vali Loss: 0.2135822 Test Loss: 0.2936011
Validation loss decreased (0.213828 --> 0.213582).  Saving model ...
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.6589980125427246
Epoch: 42, Steps: 65 | Train Loss: 0.1649991 Vali Loss: 0.2129514 Test Loss: 0.2935147
Validation loss decreased (0.213582 --> 0.212951).  Saving model ...
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 3.9152474403381348
Epoch: 43, Steps: 65 | Train Loss: 0.1643043 Vali Loss: 0.2143979 Test Loss: 0.2934235
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 3.146519660949707
Epoch: 44, Steps: 65 | Train Loss: 0.1644197 Vali Loss: 0.2124687 Test Loss: 0.2933553
Validation loss decreased (0.212951 --> 0.212469).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 3.593918800354004
Epoch: 45, Steps: 65 | Train Loss: 0.1637703 Vali Loss: 0.2125917 Test Loss: 0.2932834
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 2.128807544708252
Epoch: 46, Steps: 65 | Train Loss: 0.1642102 Vali Loss: 0.2142846 Test Loss: 0.2932042
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 3.204148054122925
Epoch: 47, Steps: 65 | Train Loss: 0.1640018 Vali Loss: 0.2132973 Test Loss: 0.2931571
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 4.55946683883667
Epoch: 48, Steps: 65 | Train Loss: 0.1638131 Vali Loss: 0.2141162 Test Loss: 0.2930880
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 4.83698582649231
Epoch: 49, Steps: 65 | Train Loss: 0.1639891 Vali Loss: 0.2146517 Test Loss: 0.2930425
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 3.549236297607422
Epoch: 50, Steps: 65 | Train Loss: 0.1636727 Vali Loss: 0.2125068 Test Loss: 0.2929958
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 5.213213682174683
Epoch: 51, Steps: 65 | Train Loss: 0.1636332 Vali Loss: 0.2136594 Test Loss: 0.2929427
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 2.9547386169433594
Epoch: 52, Steps: 65 | Train Loss: 0.1626492 Vali Loss: 0.2130435 Test Loss: 0.2928909
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 2.1317787170410156
Epoch: 53, Steps: 65 | Train Loss: 0.1629243 Vali Loss: 0.2131095 Test Loss: 0.2928411
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 2.085935592651367
Epoch: 54, Steps: 65 | Train Loss: 0.1631290 Vali Loss: 0.2136017 Test Loss: 0.2927984
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 2.6142027378082275
Epoch: 55, Steps: 65 | Train Loss: 0.1626733 Vali Loss: 0.2136388 Test Loss: 0.2927680
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 3.823774576187134
Epoch: 56, Steps: 65 | Train Loss: 0.1627228 Vali Loss: 0.2139848 Test Loss: 0.2927215
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 3.0972204208374023
Epoch: 57, Steps: 65 | Train Loss: 0.1629584 Vali Loss: 0.2129887 Test Loss: 0.2926843
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 3.84818434715271
Epoch: 58, Steps: 65 | Train Loss: 0.1626870 Vali Loss: 0.2133637 Test Loss: 0.2926577
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 3.520705461502075
Epoch: 59, Steps: 65 | Train Loss: 0.1622817 Vali Loss: 0.2135264 Test Loss: 0.2926343
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 3.217054843902588
Epoch: 60, Steps: 65 | Train Loss: 0.1620543 Vali Loss: 0.2138414 Test Loss: 0.2925915
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 2.8412747383117676
Epoch: 61, Steps: 65 | Train Loss: 0.1621454 Vali Loss: 0.2126807 Test Loss: 0.2925730
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 4.011163949966431
Epoch: 62, Steps: 65 | Train Loss: 0.1624166 Vali Loss: 0.2133054 Test Loss: 0.2925437
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 2.4134480953216553
Epoch: 63, Steps: 65 | Train Loss: 0.1617886 Vali Loss: 0.2131058 Test Loss: 0.2925200
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 2.3286726474761963
Epoch: 64, Steps: 65 | Train Loss: 0.1621265 Vali Loss: 0.2133783 Test Loss: 0.2924978
EarlyStopping counter: 20 out of 20
Early stopping
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=42, out_features=64, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2408448.0
params:  2752.0
Trainable parameters:  2752
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.649676561355591
Epoch: 1, Steps: 65 | Train Loss: 0.4132178 Vali Loss: 0.2105850 Test Loss: 0.2902887
Validation loss decreased (inf --> 0.210585).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.959291458129883
Epoch: 2, Steps: 65 | Train Loss: 0.4100667 Vali Loss: 0.2093513 Test Loss: 0.2892027
Validation loss decreased (0.210585 --> 0.209351).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 3.607120990753174
Epoch: 3, Steps: 65 | Train Loss: 0.4093151 Vali Loss: 0.2092917 Test Loss: 0.2885090
Validation loss decreased (0.209351 --> 0.209292).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 3.095834493637085
Epoch: 4, Steps: 65 | Train Loss: 0.4072907 Vali Loss: 0.2077515 Test Loss: 0.2882271
Validation loss decreased (0.209292 --> 0.207752).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 2.6197409629821777
Epoch: 5, Steps: 65 | Train Loss: 0.4055812 Vali Loss: 0.2068597 Test Loss: 0.2878995
Validation loss decreased (0.207752 --> 0.206860).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 3.3804140090942383
Epoch: 6, Steps: 65 | Train Loss: 0.4056581 Vali Loss: 0.2081142 Test Loss: 0.2877213
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 2.8274130821228027
Epoch: 7, Steps: 65 | Train Loss: 0.4066832 Vali Loss: 0.2081745 Test Loss: 0.2876055
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 2.8313705921173096
Epoch: 8, Steps: 65 | Train Loss: 0.4057855 Vali Loss: 0.2085451 Test Loss: 0.2873795
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 3.4997353553771973
Epoch: 9, Steps: 65 | Train Loss: 0.4053830 Vali Loss: 0.2079053 Test Loss: 0.2874052
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 2.812566041946411
Epoch: 10, Steps: 65 | Train Loss: 0.4056540 Vali Loss: 0.2077620 Test Loss: 0.2872099
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 4.206743001937866
Epoch: 11, Steps: 65 | Train Loss: 0.4048815 Vali Loss: 0.2067339 Test Loss: 0.2870946
Validation loss decreased (0.206860 --> 0.206734).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.922309160232544
Epoch: 12, Steps: 65 | Train Loss: 0.4051736 Vali Loss: 0.2079031 Test Loss: 0.2869142
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 2.8568599224090576
Epoch: 13, Steps: 65 | Train Loss: 0.4053110 Vali Loss: 0.2066251 Test Loss: 0.2870398
Validation loss decreased (0.206734 --> 0.206625).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 2.050724983215332
Epoch: 14, Steps: 65 | Train Loss: 0.4042698 Vali Loss: 0.2073245 Test Loss: 0.2868416
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 3.114055633544922
Epoch: 15, Steps: 65 | Train Loss: 0.4027286 Vali Loss: 0.2065782 Test Loss: 0.2868834
Validation loss decreased (0.206625 --> 0.206578).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 3.169492483139038
Epoch: 16, Steps: 65 | Train Loss: 0.4043854 Vali Loss: 0.2069827 Test Loss: 0.2867463
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 4.2080302238464355
Epoch: 17, Steps: 65 | Train Loss: 0.4046029 Vali Loss: 0.2078833 Test Loss: 0.2868123
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 3.27470064163208
Epoch: 18, Steps: 65 | Train Loss: 0.4044716 Vali Loss: 0.2067897 Test Loss: 0.2867613
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 2.1158130168914795
Epoch: 19, Steps: 65 | Train Loss: 0.4040315 Vali Loss: 0.2070373 Test Loss: 0.2867094
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 4.153185129165649
Epoch: 20, Steps: 65 | Train Loss: 0.4041828 Vali Loss: 0.2057595 Test Loss: 0.2866749
Validation loss decreased (0.206578 --> 0.205759).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 2.991076707839966
Epoch: 21, Steps: 65 | Train Loss: 0.4026262 Vali Loss: 0.2067002 Test Loss: 0.2866238
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 2.737248182296753
Epoch: 22, Steps: 65 | Train Loss: 0.4039071 Vali Loss: 0.2067281 Test Loss: 0.2865800
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 3.4942479133605957
Epoch: 23, Steps: 65 | Train Loss: 0.4039598 Vali Loss: 0.2071258 Test Loss: 0.2865848
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 2.692229986190796
Epoch: 24, Steps: 65 | Train Loss: 0.4034523 Vali Loss: 0.2065574 Test Loss: 0.2865209
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 2.484421730041504
Epoch: 25, Steps: 65 | Train Loss: 0.4039754 Vali Loss: 0.2072092 Test Loss: 0.2865502
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 2.9464430809020996
Epoch: 26, Steps: 65 | Train Loss: 0.4030039 Vali Loss: 0.2061665 Test Loss: 0.2864838
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 2.1575403213500977
Epoch: 27, Steps: 65 | Train Loss: 0.4023342 Vali Loss: 0.2070721 Test Loss: 0.2864325
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 4.366909742355347
Epoch: 28, Steps: 65 | Train Loss: 0.4031017 Vali Loss: 0.2058488 Test Loss: 0.2864506
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 3.0825233459472656
Epoch: 29, Steps: 65 | Train Loss: 0.4023939 Vali Loss: 0.2060264 Test Loss: 0.2864278
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 3.548978567123413
Epoch: 30, Steps: 65 | Train Loss: 0.4023759 Vali Loss: 0.2060805 Test Loss: 0.2864060
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 2.7038090229034424
Epoch: 31, Steps: 65 | Train Loss: 0.4006407 Vali Loss: 0.2070164 Test Loss: 0.2863688
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 3.3006703853607178
Epoch: 32, Steps: 65 | Train Loss: 0.4027891 Vali Loss: 0.2047900 Test Loss: 0.2863682
Validation loss decreased (0.205759 --> 0.204790).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 4.407792568206787
Epoch: 33, Steps: 65 | Train Loss: 0.4032032 Vali Loss: 0.2060683 Test Loss: 0.2863587
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 3.792069673538208
Epoch: 34, Steps: 65 | Train Loss: 0.4029626 Vali Loss: 0.2058663 Test Loss: 0.2863700
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.649629831314087
Epoch: 35, Steps: 65 | Train Loss: 0.4039579 Vali Loss: 0.2069391 Test Loss: 0.2863554
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 3.2958498001098633
Epoch: 36, Steps: 65 | Train Loss: 0.4040295 Vali Loss: 0.2070100 Test Loss: 0.2863650
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 2.8636884689331055
Epoch: 37, Steps: 65 | Train Loss: 0.4034642 Vali Loss: 0.2074769 Test Loss: 0.2863579
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 2.0172641277313232
Epoch: 38, Steps: 65 | Train Loss: 0.4026606 Vali Loss: 0.2065173 Test Loss: 0.2863310
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 2.673255681991577
Epoch: 39, Steps: 65 | Train Loss: 0.4031322 Vali Loss: 0.2071668 Test Loss: 0.2863553
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 2.0202667713165283
Epoch: 40, Steps: 65 | Train Loss: 0.4035862 Vali Loss: 0.2060108 Test Loss: 0.2863215
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 2.9016873836517334
Epoch: 41, Steps: 65 | Train Loss: 0.4031538 Vali Loss: 0.2065031 Test Loss: 0.2863385
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 3.458878755569458
Epoch: 42, Steps: 65 | Train Loss: 0.4024436 Vali Loss: 0.2057967 Test Loss: 0.2863203
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 2.289799213409424
Epoch: 43, Steps: 65 | Train Loss: 0.4027896 Vali Loss: 0.2053226 Test Loss: 0.2863296
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 2.409882068634033
Epoch: 44, Steps: 65 | Train Loss: 0.4023067 Vali Loss: 0.2069710 Test Loss: 0.2862956
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 3.5905532836914062
Epoch: 45, Steps: 65 | Train Loss: 0.4030654 Vali Loss: 0.2067693 Test Loss: 0.2863052
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 2.8795742988586426
Epoch: 46, Steps: 65 | Train Loss: 0.4036102 Vali Loss: 0.2063296 Test Loss: 0.2863041
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 2.266193151473999
Epoch: 47, Steps: 65 | Train Loss: 0.4033198 Vali Loss: 0.2066643 Test Loss: 0.2862970
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.8409178256988525
Epoch: 48, Steps: 65 | Train Loss: 0.4032975 Vali Loss: 0.2070139 Test Loss: 0.2863007
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 2.027507781982422
Epoch: 49, Steps: 65 | Train Loss: 0.4035211 Vali Loss: 0.2065617 Test Loss: 0.2862858
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 2.4481914043426514
Epoch: 50, Steps: 65 | Train Loss: 0.4037291 Vali Loss: 0.2064703 Test Loss: 0.2862882
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.8649170398712158
Epoch: 51, Steps: 65 | Train Loss: 0.4035618 Vali Loss: 0.2060641 Test Loss: 0.2862830
EarlyStopping counter: 19 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 2.071106433868408
Epoch: 52, Steps: 65 | Train Loss: 0.4028569 Vali Loss: 0.2060322 Test Loss: 0.2862874
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh2_180_96_FITS_ETTh2_ftM_sl180_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.28617364168167114, mae:0.339690625667572, rse:0.431117981672287, corr:[0.27508152 0.2777167  0.27599564 0.2747521  0.27430934 0.27337483
 0.27189484 0.27065867 0.2699601  0.2689352  0.26760152 0.2658295
 0.264354   0.26315686 0.26230162 0.26168337 0.2612961  0.26083392
 0.25991324 0.25867292 0.2575177  0.25655812 0.25532237 0.2532298
 0.25033006 0.24796483 0.24606481 0.2443818  0.24254553 0.24105509
 0.23977512 0.2380932  0.23592807 0.23409224 0.2330045  0.23191196
 0.23044565 0.22861953 0.22758609 0.22679903 0.22622587 0.22555871
 0.22491653 0.22406825 0.22308514 0.22180843 0.22039168 0.21884967
 0.2162663  0.21353412 0.21118726 0.20975107 0.20830216 0.20637648
 0.20392293 0.2018765  0.2006751  0.19921125 0.19769658 0.19647962
 0.1962236  0.19561245 0.19537136 0.19504255 0.19486639 0.19441676
 0.19355844 0.19262542 0.19240876 0.19227345 0.19102661 0.18953283
 0.18783493 0.18663639 0.18517685 0.18375638 0.1828486  0.18273012
 0.18206726 0.1809823  0.18113895 0.18168163 0.18176071 0.18130676
 0.18168634 0.18224727 0.18278684 0.18246236 0.18217312 0.18191576
 0.18160115 0.18086465 0.18100718 0.18128681 0.18035127 0.18074214]
