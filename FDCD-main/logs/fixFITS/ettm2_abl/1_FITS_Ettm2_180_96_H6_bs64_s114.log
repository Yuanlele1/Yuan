Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  650496.0
params:  759.0
Trainable parameters:  759
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2325474
	speed: 0.0287s/iter; left time: 763.6965s
	iters: 200, epoch: 1 | loss: 0.2968304
	speed: 0.0113s/iter; left time: 299.9554s
Epoch: 1 cost time: 4.764610052108765
Epoch: 1, Steps: 267 | Train Loss: 0.3045184 Vali Loss: 0.1369248 Test Loss: 0.1950908
Validation loss decreased (inf --> 0.136925).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2768445
	speed: 0.0612s/iter; left time: 1611.6692s
	iters: 200, epoch: 2 | loss: 0.3357533
	speed: 0.0102s/iter; left time: 267.7189s
Epoch: 2 cost time: 3.8778414726257324
Epoch: 2, Steps: 267 | Train Loss: 0.2536725 Vali Loss: 0.1293732 Test Loss: 0.1845996
Validation loss decreased (0.136925 --> 0.129373).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3152943
	speed: 0.0652s/iter; left time: 1698.9927s
	iters: 200, epoch: 3 | loss: 0.2404208
	speed: 0.0103s/iter; left time: 266.3602s
Epoch: 3 cost time: 3.361812114715576
Epoch: 3, Steps: 267 | Train Loss: 0.2442363 Vali Loss: 0.1273567 Test Loss: 0.1809065
Validation loss decreased (0.129373 --> 0.127357).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2034557
	speed: 0.0601s/iter; left time: 1550.7281s
	iters: 200, epoch: 4 | loss: 0.1916479
	speed: 0.0104s/iter; left time: 267.7602s
Epoch: 4 cost time: 3.3653929233551025
Epoch: 4, Steps: 267 | Train Loss: 0.2397959 Vali Loss: 0.1263292 Test Loss: 0.1789692
Validation loss decreased (0.127357 --> 0.126329).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2833754
	speed: 0.0599s/iter; left time: 1528.3286s
	iters: 200, epoch: 5 | loss: 0.1741041
	speed: 0.0104s/iter; left time: 263.7095s
Epoch: 5 cost time: 3.3920817375183105
Epoch: 5, Steps: 267 | Train Loss: 0.2379213 Vali Loss: 0.1257233 Test Loss: 0.1774040
Validation loss decreased (0.126329 --> 0.125723).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2802765
	speed: 0.0554s/iter; left time: 1400.1231s
	iters: 200, epoch: 6 | loss: 0.3779124
	speed: 0.0102s/iter; left time: 255.9832s
Epoch: 6 cost time: 3.2997617721557617
Epoch: 6, Steps: 267 | Train Loss: 0.2363826 Vali Loss: 0.1252739 Test Loss: 0.1764850
Validation loss decreased (0.125723 --> 0.125274).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1804809
	speed: 0.0606s/iter; left time: 1515.7792s
	iters: 200, epoch: 7 | loss: 0.3035825
	speed: 0.0111s/iter; left time: 277.1477s
Epoch: 7 cost time: 3.5475704669952393
Epoch: 7, Steps: 267 | Train Loss: 0.2350767 Vali Loss: 0.1249369 Test Loss: 0.1758643
Validation loss decreased (0.125274 --> 0.124937).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2301961
	speed: 0.0616s/iter; left time: 1524.5617s
	iters: 200, epoch: 8 | loss: 0.1503467
	speed: 0.0105s/iter; left time: 259.8292s
Epoch: 8 cost time: 3.363420009613037
Epoch: 8, Steps: 267 | Train Loss: 0.2344409 Vali Loss: 0.1247720 Test Loss: 0.1754874
Validation loss decreased (0.124937 --> 0.124772).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2383800
	speed: 0.0603s/iter; left time: 1475.9876s
	iters: 200, epoch: 9 | loss: 0.2423784
	speed: 0.0104s/iter; left time: 252.5081s
Epoch: 9 cost time: 3.3589415550231934
Epoch: 9, Steps: 267 | Train Loss: 0.2338101 Vali Loss: 0.1244620 Test Loss: 0.1751349
Validation loss decreased (0.124772 --> 0.124462).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1954221
	speed: 0.0892s/iter; left time: 2159.5662s
	iters: 200, epoch: 10 | loss: 0.4027309
	speed: 0.0104s/iter; left time: 251.4872s
Epoch: 10 cost time: 3.3459885120391846
Epoch: 10, Steps: 267 | Train Loss: 0.2332417 Vali Loss: 0.1243795 Test Loss: 0.1747033
Validation loss decreased (0.124462 --> 0.124380).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2036383
	speed: 0.0605s/iter; left time: 1447.8400s
	iters: 200, epoch: 11 | loss: 0.1514051
	speed: 0.0106s/iter; left time: 253.2481s
Epoch: 11 cost time: 3.4338479042053223
Epoch: 11, Steps: 267 | Train Loss: 0.2327816 Vali Loss: 0.1241276 Test Loss: 0.1745197
Validation loss decreased (0.124380 --> 0.124128).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1540528
	speed: 0.0582s/iter; left time: 1378.3944s
	iters: 200, epoch: 12 | loss: 0.3413914
	speed: 0.0102s/iter; left time: 241.4623s
Epoch: 12 cost time: 3.306527853012085
Epoch: 12, Steps: 267 | Train Loss: 0.2325099 Vali Loss: 0.1241510 Test Loss: 0.1744557
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2819557
	speed: 0.0616s/iter; left time: 1440.7411s
	iters: 200, epoch: 13 | loss: 0.2734776
	speed: 0.0105s/iter; left time: 245.3326s
Epoch: 13 cost time: 3.414966106414795
Epoch: 13, Steps: 267 | Train Loss: 0.2321451 Vali Loss: 0.1240518 Test Loss: 0.1743094
Validation loss decreased (0.124128 --> 0.124052).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1444543
	speed: 0.0592s/iter; left time: 1368.2558s
	iters: 200, epoch: 14 | loss: 0.1960155
	speed: 0.0102s/iter; left time: 234.5101s
Epoch: 14 cost time: 3.3378748893737793
Epoch: 14, Steps: 267 | Train Loss: 0.2319191 Vali Loss: 0.1240732 Test Loss: 0.1740969
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1373217
	speed: 0.0597s/iter; left time: 1364.5032s
	iters: 200, epoch: 15 | loss: 0.2271988
	speed: 0.0106s/iter; left time: 241.5530s
Epoch: 15 cost time: 3.5275518894195557
Epoch: 15, Steps: 267 | Train Loss: 0.2318648 Vali Loss: 0.1239417 Test Loss: 0.1739484
Validation loss decreased (0.124052 --> 0.123942).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1768257
	speed: 0.0848s/iter; left time: 1916.6114s
	iters: 200, epoch: 16 | loss: 0.1927018
	speed: 0.0108s/iter; left time: 243.3448s
Epoch: 16 cost time: 3.812809705734253
Epoch: 16, Steps: 267 | Train Loss: 0.2319985 Vali Loss: 0.1240368 Test Loss: 0.1739666
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2980013
	speed: 0.0608s/iter; left time: 1357.4834s
	iters: 200, epoch: 17 | loss: 0.2032653
	speed: 0.0106s/iter; left time: 236.2208s
Epoch: 17 cost time: 3.4099230766296387
Epoch: 17, Steps: 267 | Train Loss: 0.2318100 Vali Loss: 0.1240387 Test Loss: 0.1739526
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2099540
	speed: 0.0623s/iter; left time: 1375.5454s
	iters: 200, epoch: 18 | loss: 0.2136967
	speed: 0.0104s/iter; left time: 227.7835s
Epoch: 18 cost time: 3.4418091773986816
Epoch: 18, Steps: 267 | Train Loss: 0.2314548 Vali Loss: 0.1239867 Test Loss: 0.1738583
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2132398
	speed: 0.0641s/iter; left time: 1396.5058s
	iters: 200, epoch: 19 | loss: 0.2493165
	speed: 0.0108s/iter; left time: 234.7395s
Epoch: 19 cost time: 3.380556106567383
Epoch: 19, Steps: 267 | Train Loss: 0.2316206 Vali Loss: 0.1240720 Test Loss: 0.1738387
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2468490
	speed: 0.0604s/iter; left time: 1299.3850s
	iters: 200, epoch: 20 | loss: 0.2040223
	speed: 0.0105s/iter; left time: 224.3364s
Epoch: 20 cost time: 3.9596569538116455
Epoch: 20, Steps: 267 | Train Loss: 0.2313769 Vali Loss: 0.1240954 Test Loss: 0.1738002
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4462238
	speed: 0.0649s/iter; left time: 1380.8232s
	iters: 200, epoch: 21 | loss: 0.1522969
	speed: 0.0341s/iter; left time: 722.5740s
Epoch: 21 cost time: 8.266753196716309
Epoch: 21, Steps: 267 | Train Loss: 0.2313150 Vali Loss: 0.1238661 Test Loss: 0.1738274
Validation loss decreased (0.123942 --> 0.123866).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2750196
	speed: 0.2668s/iter; left time: 5600.8864s
	iters: 200, epoch: 22 | loss: 0.2399210
	speed: 0.0420s/iter; left time: 878.1407s
Epoch: 22 cost time: 18.947875261306763
Epoch: 22, Steps: 267 | Train Loss: 0.2312563 Vali Loss: 0.1240165 Test Loss: 0.1738012
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2673140
	speed: 0.2657s/iter; left time: 5506.5053s
	iters: 200, epoch: 23 | loss: 0.2515679
	speed: 0.0184s/iter; left time: 379.2703s
Epoch: 23 cost time: 10.709738969802856
Epoch: 23, Steps: 267 | Train Loss: 0.2312427 Vali Loss: 0.1239648 Test Loss: 0.1738583
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2611844
	speed: 0.0661s/iter; left time: 1352.2711s
	iters: 200, epoch: 24 | loss: 0.2442282
	speed: 0.0116s/iter; left time: 236.5714s
Epoch: 24 cost time: 3.570775270462036
Epoch: 24, Steps: 267 | Train Loss: 0.2306669 Vali Loss: 0.1239787 Test Loss: 0.1737732
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1962237
	speed: 0.0648s/iter; left time: 1307.9910s
	iters: 200, epoch: 25 | loss: 0.2583873
	speed: 0.0106s/iter; left time: 212.7251s
Epoch: 25 cost time: 4.371248722076416
Epoch: 25, Steps: 267 | Train Loss: 0.2311584 Vali Loss: 0.1239788 Test Loss: 0.1737453
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1726601
	speed: 0.0661s/iter; left time: 1316.2859s
	iters: 200, epoch: 26 | loss: 0.2059395
	speed: 0.0104s/iter; left time: 206.3906s
Epoch: 26 cost time: 3.476686716079712
Epoch: 26, Steps: 267 | Train Loss: 0.2307846 Vali Loss: 0.1239458 Test Loss: 0.1736724
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1637658
	speed: 0.0596s/iter; left time: 1171.2441s
	iters: 200, epoch: 27 | loss: 0.2798552
	speed: 0.0118s/iter; left time: 231.7440s
Epoch: 27 cost time: 3.721780776977539
Epoch: 27, Steps: 267 | Train Loss: 0.2307114 Vali Loss: 0.1239313 Test Loss: 0.1736790
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1882166
	speed: 0.0594s/iter; left time: 1151.1712s
	iters: 200, epoch: 28 | loss: 0.1915464
	speed: 0.0101s/iter; left time: 195.1550s
Epoch: 28 cost time: 3.2259318828582764
Epoch: 28, Steps: 267 | Train Loss: 0.2310609 Vali Loss: 0.1238680 Test Loss: 0.1736857
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1480793
	speed: 0.0626s/iter; left time: 1196.9287s
	iters: 200, epoch: 29 | loss: 0.2315687
	speed: 0.0108s/iter; left time: 205.1596s
Epoch: 29 cost time: 3.574662446975708
Epoch: 29, Steps: 267 | Train Loss: 0.2311572 Vali Loss: 0.1240073 Test Loss: 0.1736801
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1519211
	speed: 0.0620s/iter; left time: 1169.6536s
	iters: 200, epoch: 30 | loss: 0.1792886
	speed: 0.0105s/iter; left time: 196.2720s
Epoch: 30 cost time: 3.369755268096924
Epoch: 30, Steps: 267 | Train Loss: 0.2310850 Vali Loss: 0.1239353 Test Loss: 0.1737631
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1556256
	speed: 0.0635s/iter; left time: 1180.5523s
	iters: 200, epoch: 31 | loss: 0.1853093
	speed: 0.0119s/iter; left time: 219.7001s
Epoch: 31 cost time: 3.657785654067993
Epoch: 31, Steps: 267 | Train Loss: 0.2306015 Vali Loss: 0.1240063 Test Loss: 0.1737142
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1579589
	speed: 0.0601s/iter; left time: 1102.1623s
	iters: 200, epoch: 32 | loss: 0.1430635
	speed: 0.0105s/iter; left time: 191.1273s
Epoch: 32 cost time: 3.3376376628875732
Epoch: 32, Steps: 267 | Train Loss: 0.2305086 Vali Loss: 0.1239141 Test Loss: 0.1737269
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1648246
	speed: 0.0573s/iter; left time: 1034.2502s
	iters: 200, epoch: 33 | loss: 0.1984779
	speed: 0.0104s/iter; left time: 186.7973s
Epoch: 33 cost time: 3.275430917739868
Epoch: 33, Steps: 267 | Train Loss: 0.2308795 Vali Loss: 0.1239509 Test Loss: 0.1736991
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2613940
	speed: 0.0603s/iter; left time: 1072.8120s
	iters: 200, epoch: 34 | loss: 0.2902603
	speed: 0.0100s/iter; left time: 176.7536s
Epoch: 34 cost time: 3.4191226959228516
Epoch: 34, Steps: 267 | Train Loss: 0.2306023 Vali Loss: 0.1239376 Test Loss: 0.1736602
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2243376
	speed: 0.0669s/iter; left time: 1172.6310s
	iters: 200, epoch: 35 | loss: 0.3900668
	speed: 0.0110s/iter; left time: 191.8731s
Epoch: 35 cost time: 3.3864521980285645
Epoch: 35, Steps: 267 | Train Loss: 0.2307164 Vali Loss: 0.1239229 Test Loss: 0.1737042
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3501110
	speed: 0.0564s/iter; left time: 973.8538s
	iters: 200, epoch: 36 | loss: 0.2670981
	speed: 0.0100s/iter; left time: 171.3767s
Epoch: 36 cost time: 3.329841375350952
Epoch: 36, Steps: 267 | Train Loss: 0.2309745 Vali Loss: 0.1238273 Test Loss: 0.1736932
Validation loss decreased (0.123866 --> 0.123827).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2396866
	speed: 0.0593s/iter; left time: 1007.5382s
	iters: 200, epoch: 37 | loss: 0.2642437
	speed: 0.0101s/iter; left time: 170.9487s
Epoch: 37 cost time: 3.3317301273345947
Epoch: 37, Steps: 267 | Train Loss: 0.2308448 Vali Loss: 0.1239382 Test Loss: 0.1736582
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2980922
	speed: 0.0579s/iter; left time: 967.8521s
	iters: 200, epoch: 38 | loss: 0.2390691
	speed: 0.0101s/iter; left time: 168.2805s
Epoch: 38 cost time: 3.198760986328125
Epoch: 38, Steps: 267 | Train Loss: 0.2308223 Vali Loss: 0.1239984 Test Loss: 0.1736471
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3575633
	speed: 0.0586s/iter; left time: 964.1385s
	iters: 200, epoch: 39 | loss: 0.2558189
	speed: 0.0104s/iter; left time: 170.1282s
Epoch: 39 cost time: 3.3145415782928467
Epoch: 39, Steps: 267 | Train Loss: 0.2308027 Vali Loss: 0.1239487 Test Loss: 0.1736220
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3033409
	speed: 0.0604s/iter; left time: 977.0573s
	iters: 200, epoch: 40 | loss: 0.2091250
	speed: 0.0102s/iter; left time: 163.6807s
Epoch: 40 cost time: 3.325674295425415
Epoch: 40, Steps: 267 | Train Loss: 0.2304503 Vali Loss: 0.1239073 Test Loss: 0.1736257
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2188505
	speed: 0.0603s/iter; left time: 959.5160s
	iters: 200, epoch: 41 | loss: 0.2052582
	speed: 0.0104s/iter; left time: 164.2887s
Epoch: 41 cost time: 3.38568377494812
Epoch: 41, Steps: 267 | Train Loss: 0.2304204 Vali Loss: 0.1238234 Test Loss: 0.1736149
Validation loss decreased (0.123827 --> 0.123823).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1779964
	speed: 0.0573s/iter; left time: 897.1536s
	iters: 200, epoch: 42 | loss: 0.4023655
	speed: 0.0103s/iter; left time: 159.9451s
Epoch: 42 cost time: 3.199686288833618
Epoch: 42, Steps: 267 | Train Loss: 0.2308141 Vali Loss: 0.1239628 Test Loss: 0.1736131
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2112686
	speed: 0.0591s/iter; left time: 909.3438s
	iters: 200, epoch: 43 | loss: 0.1983552
	speed: 0.0100s/iter; left time: 152.1163s
Epoch: 43 cost time: 3.2376861572265625
Epoch: 43, Steps: 267 | Train Loss: 0.2305969 Vali Loss: 0.1239625 Test Loss: 0.1736087
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3058879
	speed: 0.0602s/iter; left time: 909.5386s
	iters: 200, epoch: 44 | loss: 0.3163958
	speed: 0.0099s/iter; left time: 148.2458s
Epoch: 44 cost time: 3.3364195823669434
Epoch: 44, Steps: 267 | Train Loss: 0.2303988 Vali Loss: 0.1239511 Test Loss: 0.1735897
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2306648
	speed: 0.0583s/iter; left time: 866.5620s
	iters: 200, epoch: 45 | loss: 0.1930192
	speed: 0.0105s/iter; left time: 155.1891s
Epoch: 45 cost time: 3.376338481903076
Epoch: 45, Steps: 267 | Train Loss: 0.2306356 Vali Loss: 0.1238797 Test Loss: 0.1735994
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3558086
	speed: 0.0594s/iter; left time: 866.1115s
	iters: 200, epoch: 46 | loss: 0.1741683
	speed: 0.0106s/iter; left time: 153.7101s
Epoch: 46 cost time: 3.3000619411468506
Epoch: 46, Steps: 267 | Train Loss: 0.2306183 Vali Loss: 0.1239080 Test Loss: 0.1736076
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2948571
	speed: 0.0589s/iter; left time: 843.9235s
	iters: 200, epoch: 47 | loss: 0.3245568
	speed: 0.0102s/iter; left time: 145.6104s
Epoch: 47 cost time: 3.3482742309570312
Epoch: 47, Steps: 267 | Train Loss: 0.2305657 Vali Loss: 0.1238654 Test Loss: 0.1736102
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1963283
	speed: 0.0598s/iter; left time: 840.5408s
	iters: 200, epoch: 48 | loss: 0.2515981
	speed: 0.0102s/iter; left time: 142.5715s
Epoch: 48 cost time: 3.3092868328094482
Epoch: 48, Steps: 267 | Train Loss: 0.2304014 Vali Loss: 0.1238884 Test Loss: 0.1736019
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.3097230
	speed: 0.0584s/iter; left time: 805.1135s
	iters: 200, epoch: 49 | loss: 0.1364618
	speed: 0.0102s/iter; left time: 139.3402s
Epoch: 49 cost time: 3.28993821144104
Epoch: 49, Steps: 267 | Train Loss: 0.2308448 Vali Loss: 0.1239074 Test Loss: 0.1736112
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2168364
	speed: 0.0612s/iter; left time: 827.8453s
	iters: 200, epoch: 50 | loss: 0.2503808
	speed: 0.0110s/iter; left time: 147.2730s
Epoch: 50 cost time: 3.5294346809387207
Epoch: 50, Steps: 267 | Train Loss: 0.2305412 Vali Loss: 0.1239422 Test Loss: 0.1735969
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1549405
	speed: 0.0625s/iter; left time: 828.3261s
	iters: 200, epoch: 51 | loss: 0.2579348
	speed: 0.0111s/iter; left time: 145.6965s
Epoch: 51 cost time: 3.604809522628784
Epoch: 51, Steps: 267 | Train Loss: 0.2305554 Vali Loss: 0.1239485 Test Loss: 0.1736055
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1533473
	speed: 0.0600s/iter; left time: 778.4949s
	iters: 200, epoch: 52 | loss: 0.1753357
	speed: 0.0112s/iter; left time: 144.2117s
Epoch: 52 cost time: 3.6194286346435547
Epoch: 52, Steps: 267 | Train Loss: 0.2305154 Vali Loss: 0.1238736 Test Loss: 0.1735897
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2360849
	speed: 0.0619s/iter; left time: 787.4113s
	iters: 200, epoch: 53 | loss: 0.2354395
	speed: 0.0113s/iter; left time: 143.0011s
Epoch: 53 cost time: 3.6230196952819824
Epoch: 53, Steps: 267 | Train Loss: 0.2307418 Vali Loss: 0.1238909 Test Loss: 0.1736017
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2390321
	speed: 0.0605s/iter; left time: 753.8200s
	iters: 200, epoch: 54 | loss: 0.3121937
	speed: 0.0103s/iter; left time: 127.2725s
Epoch: 54 cost time: 3.3143255710601807
Epoch: 54, Steps: 267 | Train Loss: 0.2297903 Vali Loss: 0.1239422 Test Loss: 0.1735850
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2643901
	speed: 0.0610s/iter; left time: 743.4191s
	iters: 200, epoch: 55 | loss: 0.2110049
	speed: 0.0112s/iter; left time: 135.8556s
Epoch: 55 cost time: 3.493248462677002
Epoch: 55, Steps: 267 | Train Loss: 0.2305679 Vali Loss: 0.1239058 Test Loss: 0.1735888
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3564043
	speed: 0.0607s/iter; left time: 723.5594s
	iters: 200, epoch: 56 | loss: 0.2354767
	speed: 0.0101s/iter; left time: 119.2448s
Epoch: 56 cost time: 3.318455457687378
Epoch: 56, Steps: 267 | Train Loss: 0.2306037 Vali Loss: 0.1239001 Test Loss: 0.1735967
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2169282
	speed: 0.0588s/iter; left time: 684.5728s
	iters: 200, epoch: 57 | loss: 0.1860338
	speed: 0.0103s/iter; left time: 119.1146s
Epoch: 57 cost time: 3.323281764984131
Epoch: 57, Steps: 267 | Train Loss: 0.2303425 Vali Loss: 0.1238868 Test Loss: 0.1735842
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2080351
	speed: 0.0592s/iter; left time: 673.3657s
	iters: 200, epoch: 58 | loss: 0.2190923
	speed: 0.0107s/iter; left time: 120.9055s
Epoch: 58 cost time: 3.337299108505249
Epoch: 58, Steps: 267 | Train Loss: 0.2306474 Vali Loss: 0.1239249 Test Loss: 0.1735871
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1825641
	speed: 0.0581s/iter; left time: 645.2882s
	iters: 200, epoch: 59 | loss: 0.2039787
	speed: 0.0106s/iter; left time: 116.4847s
Epoch: 59 cost time: 3.317253351211548
Epoch: 59, Steps: 267 | Train Loss: 0.2301682 Vali Loss: 0.1239144 Test Loss: 0.1735774
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.2228652
	speed: 0.0608s/iter; left time: 659.1695s
	iters: 200, epoch: 60 | loss: 0.1661622
	speed: 0.0101s/iter; left time: 108.8797s
Epoch: 60 cost time: 3.482149839401245
Epoch: 60, Steps: 267 | Train Loss: 0.2305151 Vali Loss: 0.1239674 Test Loss: 0.1735771
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.3160677
	speed: 0.0580s/iter; left time: 613.2156s
	iters: 200, epoch: 61 | loss: 0.1970742
	speed: 0.0101s/iter; left time: 106.1568s
Epoch: 61 cost time: 3.324080467224121
Epoch: 61, Steps: 267 | Train Loss: 0.2307301 Vali Loss: 0.1238769 Test Loss: 0.1735856
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.17436307668685913, mae:0.26002803444862366, rse:0.33855047821998596, corr:[0.5679655  0.5712809  0.5696035  0.5660789  0.56336796 0.5623001
 0.56245184 0.5627667  0.56252855 0.5616357  0.56039506 0.55935097
 0.55881655 0.5586956  0.5587595  0.5586246  0.5580776  0.55711746
 0.5559767  0.55495614 0.5542862  0.5539709  0.55383897 0.55370724
 0.55338603 0.55280644 0.5520859  0.5513516  0.55069155 0.5501386
 0.549699   0.5493759  0.5490556  0.5486414  0.5480799  0.5474533
 0.54677457 0.5461375  0.54553604 0.54497254 0.54448265 0.5440466
 0.5436154  0.54314446 0.5425928  0.54199207 0.54134244 0.54066545
 0.5399439  0.5391668  0.5383491  0.53759056 0.5368875  0.53621066
 0.5356029  0.53514737 0.53477055 0.5344839  0.534206   0.53393805
 0.5336206  0.5333324  0.5331049  0.5328846  0.53268826 0.5325677
 0.5324594  0.5323541  0.5322353  0.5321306  0.531999   0.53184503
 0.53172666 0.53155804 0.53141445 0.5312256  0.5309715  0.5305716
 0.530064   0.5295316  0.5290079  0.5284995  0.52804726 0.52763855
 0.5272371  0.5268185  0.5263163  0.5258605  0.52546257 0.52509123
 0.5248534  0.52479684 0.52476376 0.5245177  0.52373445 0.5215991 ]
