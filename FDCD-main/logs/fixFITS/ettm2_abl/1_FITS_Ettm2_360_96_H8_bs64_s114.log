Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=42, out_features=53, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1994496.0
params:  2279.0
Trainable parameters:  2279
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1803913
	speed: 0.0180s/iter; left time: 477.2149s
	iters: 200, epoch: 1 | loss: 0.2508416
	speed: 0.0124s/iter; left time: 328.2733s
Epoch: 1 cost time: 3.8838083744049072
Epoch: 1, Steps: 266 | Train Loss: 0.3175902 Vali Loss: 0.1368846 Test Loss: 0.1910638
Validation loss decreased (inf --> 0.136885).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2281980
	speed: 0.0653s/iter; left time: 1713.0149s
	iters: 200, epoch: 2 | loss: 0.1895233
	speed: 0.0135s/iter; left time: 352.2442s
Epoch: 2 cost time: 4.030066251754761
Epoch: 2, Steps: 266 | Train Loss: 0.2478977 Vali Loss: 0.1259381 Test Loss: 0.1776079
Validation loss decreased (0.136885 --> 0.125938).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3911301
	speed: 0.0690s/iter; left time: 1792.8543s
	iters: 200, epoch: 3 | loss: 0.2785552
	speed: 0.0139s/iter; left time: 360.6140s
Epoch: 3 cost time: 4.254794359207153
Epoch: 3, Steps: 266 | Train Loss: 0.2334458 Vali Loss: 0.1225246 Test Loss: 0.1731664
Validation loss decreased (0.125938 --> 0.122525).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2950164
	speed: 0.0672s/iter; left time: 1726.7952s
	iters: 200, epoch: 4 | loss: 0.1452335
	speed: 0.0129s/iter; left time: 330.3947s
Epoch: 4 cost time: 4.0078208446502686
Epoch: 4, Steps: 266 | Train Loss: 0.2274686 Vali Loss: 0.1209250 Test Loss: 0.1711822
Validation loss decreased (0.122525 --> 0.120925).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2689802
	speed: 0.0689s/iter; left time: 1752.0745s
	iters: 200, epoch: 5 | loss: 0.2620817
	speed: 0.0130s/iter; left time: 329.4121s
Epoch: 5 cost time: 4.038182735443115
Epoch: 5, Steps: 266 | Train Loss: 0.2238674 Vali Loss: 0.1201021 Test Loss: 0.1695320
Validation loss decreased (0.120925 --> 0.120102).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2499633
	speed: 0.0670s/iter; left time: 1687.4859s
	iters: 200, epoch: 6 | loss: 0.2072288
	speed: 0.0128s/iter; left time: 320.8631s
Epoch: 6 cost time: 4.023031949996948
Epoch: 6, Steps: 266 | Train Loss: 0.2217086 Vali Loss: 0.1192783 Test Loss: 0.1687459
Validation loss decreased (0.120102 --> 0.119278).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1836788
	speed: 0.0632s/iter; left time: 1575.1287s
	iters: 200, epoch: 7 | loss: 0.1228364
	speed: 0.0121s/iter; left time: 299.0595s
Epoch: 7 cost time: 3.7898478507995605
Epoch: 7, Steps: 266 | Train Loss: 0.2203167 Vali Loss: 0.1188473 Test Loss: 0.1680297
Validation loss decreased (0.119278 --> 0.118847).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1865187
	speed: 0.0642s/iter; left time: 1582.8014s
	iters: 200, epoch: 8 | loss: 0.2249591
	speed: 0.0122s/iter; left time: 299.2106s
Epoch: 8 cost time: 3.8575069904327393
Epoch: 8, Steps: 266 | Train Loss: 0.2192636 Vali Loss: 0.1183922 Test Loss: 0.1674752
Validation loss decreased (0.118847 --> 0.118392).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2552241
	speed: 0.0623s/iter; left time: 1517.9380s
	iters: 200, epoch: 9 | loss: 0.1566754
	speed: 0.0126s/iter; left time: 306.6071s
Epoch: 9 cost time: 3.869523525238037
Epoch: 9, Steps: 266 | Train Loss: 0.2186229 Vali Loss: 0.1183403 Test Loss: 0.1674287
Validation loss decreased (0.118392 --> 0.118340).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2577376
	speed: 0.0653s/iter; left time: 1574.0902s
	iters: 200, epoch: 10 | loss: 0.2087291
	speed: 0.0128s/iter; left time: 307.6583s
Epoch: 10 cost time: 3.9942760467529297
Epoch: 10, Steps: 266 | Train Loss: 0.2178939 Vali Loss: 0.1181404 Test Loss: 0.1668344
Validation loss decreased (0.118340 --> 0.118140).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2232686
	speed: 0.0630s/iter; left time: 1502.2445s
	iters: 200, epoch: 11 | loss: 0.2536495
	speed: 0.0129s/iter; left time: 306.5590s
Epoch: 11 cost time: 3.914806365966797
Epoch: 11, Steps: 266 | Train Loss: 0.2171324 Vali Loss: 0.1180805 Test Loss: 0.1666531
Validation loss decreased (0.118140 --> 0.118080).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3643980
	speed: 0.0657s/iter; left time: 1549.7787s
	iters: 200, epoch: 12 | loss: 0.2226290
	speed: 0.0130s/iter; left time: 305.7205s
Epoch: 12 cost time: 4.018388271331787
Epoch: 12, Steps: 266 | Train Loss: 0.2170837 Vali Loss: 0.1178497 Test Loss: 0.1665076
Validation loss decreased (0.118080 --> 0.117850).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2621258
	speed: 0.0672s/iter; left time: 1565.6405s
	iters: 200, epoch: 13 | loss: 0.2338692
	speed: 0.0232s/iter; left time: 537.6397s
Epoch: 13 cost time: 5.229604721069336
Epoch: 13, Steps: 266 | Train Loss: 0.2166930 Vali Loss: 0.1179159 Test Loss: 0.1662753
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2799952
	speed: 0.0642s/iter; left time: 1479.9039s
	iters: 200, epoch: 14 | loss: 0.1759395
	speed: 0.0121s/iter; left time: 277.9565s
Epoch: 14 cost time: 3.7672672271728516
Epoch: 14, Steps: 266 | Train Loss: 0.2164465 Vali Loss: 0.1178984 Test Loss: 0.1662253
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2471536
	speed: 0.0646s/iter; left time: 1472.3869s
	iters: 200, epoch: 15 | loss: 0.3530383
	speed: 0.0125s/iter; left time: 283.0163s
Epoch: 15 cost time: 3.934725046157837
Epoch: 15, Steps: 266 | Train Loss: 0.2157537 Vali Loss: 0.1179644 Test Loss: 0.1659960
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2661673
	speed: 0.0650s/iter; left time: 1463.2422s
	iters: 200, epoch: 16 | loss: 0.1492306
	speed: 0.0122s/iter; left time: 273.0574s
Epoch: 16 cost time: 3.872288703918457
Epoch: 16, Steps: 266 | Train Loss: 0.2158386 Vali Loss: 0.1177918 Test Loss: 0.1661456
Validation loss decreased (0.117850 --> 0.117792).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1891314
	speed: 0.0636s/iter; left time: 1415.1666s
	iters: 200, epoch: 17 | loss: 0.2325350
	speed: 0.0125s/iter; left time: 277.2747s
Epoch: 17 cost time: 3.894981622695923
Epoch: 17, Steps: 266 | Train Loss: 0.2159107 Vali Loss: 0.1176795 Test Loss: 0.1660694
Validation loss decreased (0.117792 --> 0.117680).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2057150
	speed: 0.0670s/iter; left time: 1471.5756s
	iters: 200, epoch: 18 | loss: 0.3280408
	speed: 0.0128s/iter; left time: 280.8250s
Epoch: 18 cost time: 3.9828529357910156
Epoch: 18, Steps: 266 | Train Loss: 0.2157085 Vali Loss: 0.1177349 Test Loss: 0.1658283
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1756032
	speed: 0.0644s/iter; left time: 1397.5753s
	iters: 200, epoch: 19 | loss: 0.1524567
	speed: 0.0132s/iter; left time: 286.1003s
Epoch: 19 cost time: 3.955312490463257
Epoch: 19, Steps: 266 | Train Loss: 0.2155996 Vali Loss: 0.1176159 Test Loss: 0.1659794
Validation loss decreased (0.117680 --> 0.117616).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2010332
	speed: 0.0644s/iter; left time: 1381.9517s
	iters: 200, epoch: 20 | loss: 0.1963224
	speed: 0.0140s/iter; left time: 299.5585s
Epoch: 20 cost time: 4.272940158843994
Epoch: 20, Steps: 266 | Train Loss: 0.2154859 Vali Loss: 0.1177602 Test Loss: 0.1657947
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2724051
	speed: 0.0654s/iter; left time: 1386.2302s
	iters: 200, epoch: 21 | loss: 0.2552590
	speed: 0.0199s/iter; left time: 419.0408s
Epoch: 21 cost time: 4.574078798294067
Epoch: 21, Steps: 266 | Train Loss: 0.2153988 Vali Loss: 0.1177103 Test Loss: 0.1657778
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2175823
	speed: 0.0651s/iter; left time: 1361.3452s
	iters: 200, epoch: 22 | loss: 0.1639026
	speed: 0.0126s/iter; left time: 261.9429s
Epoch: 22 cost time: 3.9132730960845947
Epoch: 22, Steps: 266 | Train Loss: 0.2153319 Vali Loss: 0.1176904 Test Loss: 0.1656512
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2504081
	speed: 0.0653s/iter; left time: 1349.2262s
	iters: 200, epoch: 23 | loss: 0.1982551
	speed: 0.0127s/iter; left time: 261.7084s
Epoch: 23 cost time: 3.9035990238189697
Epoch: 23, Steps: 266 | Train Loss: 0.2152482 Vali Loss: 0.1177217 Test Loss: 0.1654935
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1834192
	speed: 0.0649s/iter; left time: 1322.0874s
	iters: 200, epoch: 24 | loss: 0.1658973
	speed: 0.0128s/iter; left time: 259.6516s
Epoch: 24 cost time: 3.9497201442718506
Epoch: 24, Steps: 266 | Train Loss: 0.2153039 Vali Loss: 0.1176827 Test Loss: 0.1656044
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2440610
	speed: 0.0658s/iter; left time: 1323.3673s
	iters: 200, epoch: 25 | loss: 0.1311819
	speed: 0.0129s/iter; left time: 259.0904s
Epoch: 25 cost time: 4.041200876235962
Epoch: 25, Steps: 266 | Train Loss: 0.2151989 Vali Loss: 0.1176679 Test Loss: 0.1655793
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2162449
	speed: 0.0652s/iter; left time: 1294.9380s
	iters: 200, epoch: 26 | loss: 0.1810539
	speed: 0.0131s/iter; left time: 259.1207s
Epoch: 26 cost time: 4.0439772605896
Epoch: 26, Steps: 266 | Train Loss: 0.2152234 Vali Loss: 0.1176250 Test Loss: 0.1655784
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1733767
	speed: 0.0662s/iter; left time: 1297.1985s
	iters: 200, epoch: 27 | loss: 0.2149045
	speed: 0.0127s/iter; left time: 246.9918s
Epoch: 27 cost time: 3.898010015487671
Epoch: 27, Steps: 266 | Train Loss: 0.2151513 Vali Loss: 0.1176617 Test Loss: 0.1656205
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1574558
	speed: 0.0643s/iter; left time: 1241.3578s
	iters: 200, epoch: 28 | loss: 0.2641374
	speed: 0.0126s/iter; left time: 243.0975s
Epoch: 28 cost time: 3.901611566543579
Epoch: 28, Steps: 266 | Train Loss: 0.2148207 Vali Loss: 0.1176890 Test Loss: 0.1656162
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2818704
	speed: 0.0633s/iter; left time: 1206.3722s
	iters: 200, epoch: 29 | loss: 0.3038666
	speed: 0.0126s/iter; left time: 239.1519s
Epoch: 29 cost time: 3.90458607673645
Epoch: 29, Steps: 266 | Train Loss: 0.2149203 Vali Loss: 0.1176987 Test Loss: 0.1655186
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1490776
	speed: 0.0633s/iter; left time: 1189.1658s
	iters: 200, epoch: 30 | loss: 0.1906558
	speed: 0.0126s/iter; left time: 235.5696s
Epoch: 30 cost time: 3.864447593688965
Epoch: 30, Steps: 266 | Train Loss: 0.2148976 Vali Loss: 0.1176366 Test Loss: 0.1655917
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2570187
	speed: 0.0640s/iter; left time: 1185.4073s
	iters: 200, epoch: 31 | loss: 0.2192754
	speed: 0.0126s/iter; left time: 232.0412s
Epoch: 31 cost time: 3.8845341205596924
Epoch: 31, Steps: 266 | Train Loss: 0.2149431 Vali Loss: 0.1176335 Test Loss: 0.1655400
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2916584
	speed: 0.0645s/iter; left time: 1177.6471s
	iters: 200, epoch: 32 | loss: 0.1630062
	speed: 0.0131s/iter; left time: 236.9995s
Epoch: 32 cost time: 4.003464937210083
Epoch: 32, Steps: 266 | Train Loss: 0.2148797 Vali Loss: 0.1176147 Test Loss: 0.1656137
Validation loss decreased (0.117616 --> 0.117615).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1543682
	speed: 0.0617s/iter; left time: 1109.0508s
	iters: 200, epoch: 33 | loss: 0.3011872
	speed: 0.0129s/iter; left time: 230.3314s
Epoch: 33 cost time: 3.9368011951446533
Epoch: 33, Steps: 266 | Train Loss: 0.2148473 Vali Loss: 0.1175263 Test Loss: 0.1655774
Validation loss decreased (0.117615 --> 0.117526).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2360574
	speed: 0.0651s/iter; left time: 1152.9652s
	iters: 200, epoch: 34 | loss: 0.2155683
	speed: 0.0126s/iter; left time: 221.8001s
Epoch: 34 cost time: 3.8122997283935547
Epoch: 34, Steps: 266 | Train Loss: 0.2148074 Vali Loss: 0.1175678 Test Loss: 0.1655819
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3741054
	speed: 0.0644s/iter; left time: 1124.3822s
	iters: 200, epoch: 35 | loss: 0.1694404
	speed: 0.0130s/iter; left time: 225.4609s
Epoch: 35 cost time: 3.9550929069519043
Epoch: 35, Steps: 266 | Train Loss: 0.2146729 Vali Loss: 0.1176481 Test Loss: 0.1655111
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1957961
	speed: 0.0624s/iter; left time: 1072.4508s
	iters: 200, epoch: 36 | loss: 0.1684904
	speed: 0.0124s/iter; left time: 211.9857s
Epoch: 36 cost time: 3.5544235706329346
Epoch: 36, Steps: 266 | Train Loss: 0.2147313 Vali Loss: 0.1176978 Test Loss: 0.1654885
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2405710
	speed: 0.0624s/iter; left time: 1056.6069s
	iters: 200, epoch: 37 | loss: 0.2557407
	speed: 0.0135s/iter; left time: 226.8959s
Epoch: 37 cost time: 3.960707902908325
Epoch: 37, Steps: 266 | Train Loss: 0.2148275 Vali Loss: 0.1176349 Test Loss: 0.1654947
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1769336
	speed: 0.0652s/iter; left time: 1086.4305s
	iters: 200, epoch: 38 | loss: 0.1865752
	speed: 0.0134s/iter; left time: 221.4846s
Epoch: 38 cost time: 4.04815673828125
Epoch: 38, Steps: 266 | Train Loss: 0.2148564 Vali Loss: 0.1176407 Test Loss: 0.1654495
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1631915
	speed: 0.0650s/iter; left time: 1065.2109s
	iters: 200, epoch: 39 | loss: 0.1884044
	speed: 0.0125s/iter; left time: 203.1564s
Epoch: 39 cost time: 3.9194605350494385
Epoch: 39, Steps: 266 | Train Loss: 0.2148395 Vali Loss: 0.1176371 Test Loss: 0.1654383
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2543884
	speed: 0.0646s/iter; left time: 1042.3707s
	iters: 200, epoch: 40 | loss: 0.1490987
	speed: 0.0131s/iter; left time: 209.3838s
Epoch: 40 cost time: 4.016729354858398
Epoch: 40, Steps: 266 | Train Loss: 0.2147198 Vali Loss: 0.1175877 Test Loss: 0.1654698
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2025793
	speed: 0.0651s/iter; left time: 1032.4502s
	iters: 200, epoch: 41 | loss: 0.1701519
	speed: 0.0130s/iter; left time: 204.4947s
Epoch: 41 cost time: 3.9603309631347656
Epoch: 41, Steps: 266 | Train Loss: 0.2145567 Vali Loss: 0.1176841 Test Loss: 0.1654845
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2494799
	speed: 0.0839s/iter; left time: 1308.2836s
	iters: 200, epoch: 42 | loss: 0.2397175
	speed: 0.0131s/iter; left time: 202.6383s
Epoch: 42 cost time: 5.9996325969696045
Epoch: 42, Steps: 266 | Train Loss: 0.2147200 Vali Loss: 0.1175495 Test Loss: 0.1654884
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1696253
	speed: 0.0976s/iter; left time: 1496.2097s
	iters: 200, epoch: 43 | loss: 0.1912867
	speed: 0.0138s/iter; left time: 210.4098s
Epoch: 43 cost time: 4.19316840171814
Epoch: 43, Steps: 266 | Train Loss: 0.2145693 Vali Loss: 0.1176473 Test Loss: 0.1654484
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1930233
	speed: 0.0667s/iter; left time: 1005.1469s
	iters: 200, epoch: 44 | loss: 0.1785825
	speed: 0.0135s/iter; left time: 202.1806s
Epoch: 44 cost time: 4.213423252105713
Epoch: 44, Steps: 266 | Train Loss: 0.2144095 Vali Loss: 0.1176697 Test Loss: 0.1654865
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2483547
	speed: 0.0677s/iter; left time: 1001.2011s
	iters: 200, epoch: 45 | loss: 0.2991886
	speed: 0.0131s/iter; left time: 192.4607s
Epoch: 45 cost time: 4.0300562381744385
Epoch: 45, Steps: 266 | Train Loss: 0.2147365 Vali Loss: 0.1175679 Test Loss: 0.1654669
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2331697
	speed: 0.0651s/iter; left time: 945.4540s
	iters: 200, epoch: 46 | loss: 0.1576396
	speed: 0.0125s/iter; left time: 180.6826s
Epoch: 46 cost time: 3.8981027603149414
Epoch: 46, Steps: 266 | Train Loss: 0.2146032 Vali Loss: 0.1176752 Test Loss: 0.1654724
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2000033
	speed: 0.0618s/iter; left time: 881.0124s
	iters: 200, epoch: 47 | loss: 0.3069348
	speed: 0.0124s/iter; left time: 175.9783s
Epoch: 47 cost time: 3.84765625
Epoch: 47, Steps: 266 | Train Loss: 0.2146070 Vali Loss: 0.1176570 Test Loss: 0.1654852
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2103122
	speed: 0.0640s/iter; left time: 895.9279s
	iters: 200, epoch: 48 | loss: 0.2451117
	speed: 0.0129s/iter; left time: 179.0155s
Epoch: 48 cost time: 3.904571533203125
Epoch: 48, Steps: 266 | Train Loss: 0.2144564 Vali Loss: 0.1175514 Test Loss: 0.1654794
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1827690
	speed: 0.0627s/iter; left time: 860.6089s
	iters: 200, epoch: 49 | loss: 0.2229052
	speed: 0.0128s/iter; left time: 174.0960s
Epoch: 49 cost time: 3.880296230316162
Epoch: 49, Steps: 266 | Train Loss: 0.2145636 Vali Loss: 0.1175230 Test Loss: 0.1654560
Validation loss decreased (0.117526 --> 0.117523).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1613311
	speed: 0.0627s/iter; left time: 844.4031s
	iters: 200, epoch: 50 | loss: 0.1656472
	speed: 0.0129s/iter; left time: 172.3688s
Epoch: 50 cost time: 3.9159657955169678
Epoch: 50, Steps: 266 | Train Loss: 0.2145511 Vali Loss: 0.1173998 Test Loss: 0.1654384
Validation loss decreased (0.117523 --> 0.117400).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1534321
	speed: 0.0639s/iter; left time: 843.7089s
	iters: 200, epoch: 51 | loss: 0.2690412
	speed: 0.0125s/iter; left time: 164.4034s
Epoch: 51 cost time: 3.85587477684021
Epoch: 51, Steps: 266 | Train Loss: 0.2144848 Vali Loss: 0.1175632 Test Loss: 0.1654551
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2155412
	speed: 0.0648s/iter; left time: 837.8208s
	iters: 200, epoch: 52 | loss: 0.1664420
	speed: 0.0129s/iter; left time: 166.1416s
Epoch: 52 cost time: 3.991586685180664
Epoch: 52, Steps: 266 | Train Loss: 0.2145236 Vali Loss: 0.1176226 Test Loss: 0.1654493
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2188796
	speed: 0.0648s/iter; left time: 821.4219s
	iters: 200, epoch: 53 | loss: 0.1750160
	speed: 0.0139s/iter; left time: 174.4117s
Epoch: 53 cost time: 4.131253242492676
Epoch: 53, Steps: 266 | Train Loss: 0.2145565 Vali Loss: 0.1175644 Test Loss: 0.1654192
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2130281
	speed: 0.0680s/iter; left time: 843.3547s
	iters: 200, epoch: 54 | loss: 0.1662500
	speed: 0.0134s/iter; left time: 165.4585s
Epoch: 54 cost time: 4.142475128173828
Epoch: 54, Steps: 266 | Train Loss: 0.2146633 Vali Loss: 0.1175475 Test Loss: 0.1654006
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1706264
	speed: 0.0832s/iter; left time: 1010.1028s
	iters: 200, epoch: 55 | loss: 0.1935917
	speed: 0.0129s/iter; left time: 155.1332s
Epoch: 55 cost time: 4.1291279792785645
Epoch: 55, Steps: 266 | Train Loss: 0.2145772 Vali Loss: 0.1175608 Test Loss: 0.1654050
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3234998
	speed: 0.0614s/iter; left time: 729.3509s
	iters: 200, epoch: 56 | loss: 0.3348830
	speed: 0.0124s/iter; left time: 145.6633s
Epoch: 56 cost time: 3.7363908290863037
Epoch: 56, Steps: 266 | Train Loss: 0.2145416 Vali Loss: 0.1176329 Test Loss: 0.1653974
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2059635
	speed: 0.0644s/iter; left time: 747.5475s
	iters: 200, epoch: 57 | loss: 0.2745330
	speed: 0.0130s/iter; left time: 149.3563s
Epoch: 57 cost time: 4.002932786941528
Epoch: 57, Steps: 266 | Train Loss: 0.2145383 Vali Loss: 0.1176148 Test Loss: 0.1654109
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2012248
	speed: 0.0649s/iter; left time: 735.4531s
	iters: 200, epoch: 58 | loss: 0.2211744
	speed: 0.0131s/iter; left time: 146.6877s
Epoch: 58 cost time: 4.015517950057983
Epoch: 58, Steps: 266 | Train Loss: 0.2145472 Vali Loss: 0.1176436 Test Loss: 0.1654252
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2287490
	speed: 0.0642s/iter; left time: 710.7761s
	iters: 200, epoch: 59 | loss: 0.2045868
	speed: 0.0128s/iter; left time: 140.5926s
Epoch: 59 cost time: 3.840770959854126
Epoch: 59, Steps: 266 | Train Loss: 0.2142910 Vali Loss: 0.1176294 Test Loss: 0.1654086
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.2211157
	speed: 0.0708s/iter; left time: 764.6028s
	iters: 200, epoch: 60 | loss: 0.1623726
	speed: 0.0140s/iter; left time: 149.7319s
Epoch: 60 cost time: 4.312691926956177
Epoch: 60, Steps: 266 | Train Loss: 0.2144424 Vali Loss: 0.1174772 Test Loss: 0.1654026
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2030165
	speed: 0.0721s/iter; left time: 760.5238s
	iters: 200, epoch: 61 | loss: 0.1625522
	speed: 0.0147s/iter; left time: 152.9799s
Epoch: 61 cost time: 4.913230895996094
Epoch: 61, Steps: 266 | Train Loss: 0.2145003 Vali Loss: 0.1175706 Test Loss: 0.1654000
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2445319
	speed: 0.0638s/iter; left time: 655.8044s
	iters: 200, epoch: 62 | loss: 0.1980411
	speed: 0.0125s/iter; left time: 127.5114s
Epoch: 62 cost time: 3.8545563220977783
Epoch: 62, Steps: 266 | Train Loss: 0.2144605 Vali Loss: 0.1175291 Test Loss: 0.1653973
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2424152
	speed: 0.0652s/iter; left time: 652.2506s
	iters: 200, epoch: 63 | loss: 0.1876985
	speed: 0.0128s/iter; left time: 127.0763s
Epoch: 63 cost time: 3.963536500930786
Epoch: 63, Steps: 266 | Train Loss: 0.2145232 Vali Loss: 0.1176283 Test Loss: 0.1654063
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1921896
	speed: 0.0648s/iter; left time: 631.5560s
	iters: 200, epoch: 64 | loss: 0.1655216
	speed: 0.0130s/iter; left time: 125.5672s
Epoch: 64 cost time: 3.9925482273101807
Epoch: 64, Steps: 266 | Train Loss: 0.2143793 Vali Loss: 0.1175269 Test Loss: 0.1653955
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2755207
	speed: 0.0660s/iter; left time: 625.3159s
	iters: 200, epoch: 65 | loss: 0.2403643
	speed: 0.0133s/iter; left time: 125.0482s
Epoch: 65 cost time: 4.0163726806640625
Epoch: 65, Steps: 266 | Train Loss: 0.2145420 Vali Loss: 0.1176513 Test Loss: 0.1654044
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1774135
	speed: 0.0644s/iter; left time: 593.1548s
	iters: 200, epoch: 66 | loss: 0.2556878
	speed: 0.0131s/iter; left time: 119.1884s
Epoch: 66 cost time: 3.899613857269287
Epoch: 66, Steps: 266 | Train Loss: 0.2145256 Vali Loss: 0.1175140 Test Loss: 0.1654023
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.3006848
	speed: 0.0652s/iter; left time: 582.7893s
	iters: 200, epoch: 67 | loss: 0.2251516
	speed: 0.0128s/iter; left time: 112.8685s
Epoch: 67 cost time: 3.9894721508026123
Epoch: 67, Steps: 266 | Train Loss: 0.2144696 Vali Loss: 0.1175607 Test Loss: 0.1654012
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1826851
	speed: 0.0643s/iter; left time: 558.0526s
	iters: 200, epoch: 68 | loss: 0.1891535
	speed: 0.0127s/iter; left time: 108.7923s
Epoch: 68 cost time: 3.974449396133423
Epoch: 68, Steps: 266 | Train Loss: 0.2145491 Vali Loss: 0.1175712 Test Loss: 0.1654023
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2302214
	speed: 0.0652s/iter; left time: 548.7603s
	iters: 200, epoch: 69 | loss: 0.2434864
	speed: 0.0132s/iter; left time: 109.4523s
Epoch: 69 cost time: 4.04921293258667
Epoch: 69, Steps: 266 | Train Loss: 0.2143383 Vali Loss: 0.1175292 Test Loss: 0.1653984
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2058516
	speed: 0.0637s/iter; left time: 518.8890s
	iters: 200, epoch: 70 | loss: 0.1596520
	speed: 0.0131s/iter; left time: 105.1299s
Epoch: 70 cost time: 4.0100977420806885
Epoch: 70, Steps: 266 | Train Loss: 0.2144144 Vali Loss: 0.1175673 Test Loss: 0.1654023
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16602464020252228, mae:0.2558744251728058, rse:0.3303561806678772, corr:[0.5667689  0.5698931  0.56893045 0.5665436  0.5648911  0.5643887
 0.56468546 0.56498593 0.564758   0.56403047 0.56312287 0.5625076
 0.562377   0.5625851  0.5628551  0.5628227  0.5623756  0.56152844
 0.5605493  0.559694   0.55916077 0.5589709  0.55893207 0.5588974
 0.55866784 0.5581474  0.5574729  0.55680186 0.5562612  0.55585533
 0.5555597  0.555355   0.55510914 0.55473804 0.5542275  0.55362725
 0.55298436 0.5523348  0.5517614  0.5512704  0.55080944 0.55037636
 0.5499     0.5493366  0.54867744 0.5478752  0.54706085 0.5463093
 0.5455747  0.5448537  0.5440751  0.5433399  0.5425785  0.54173094
 0.5408404  0.54005206 0.5393869  0.53886586 0.53848153 0.5382022
 0.53792185 0.5376267  0.53733414 0.53706187 0.53681767 0.5366286
 0.5364721  0.5363133  0.5361898  0.53610116 0.53599256 0.53586423
 0.5357082  0.53552175 0.5352612  0.5348878  0.5344445  0.5339043
 0.5333068  0.53272897 0.5322635  0.5317916  0.5312668  0.5306275
 0.52995276 0.529346   0.5288116  0.5284913  0.5282869  0.5279675
 0.5275524  0.5272239  0.52683103 0.52648515 0.526433   0.5248165 ]
