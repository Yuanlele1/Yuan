Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=34, out_features=52, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1584128.0
params:  1820.0
Trainable parameters:  1820
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2482979
	speed: 0.0374s/iter; left time: 993.9352s
	iters: 200, epoch: 1 | loss: 0.1903651
	speed: 0.0166s/iter; left time: 440.0071s
Epoch: 1 cost time: 6.571763277053833
Epoch: 1, Steps: 267 | Train Loss: 0.2193776 Vali Loss: 0.1755266 Test Loss: 0.2394857
Validation loss decreased (inf --> 0.175527).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1240987
	speed: 0.0986s/iter; left time: 2595.9854s
	iters: 200, epoch: 2 | loss: 0.1777182
	speed: 0.0178s/iter; left time: 467.4238s
Epoch: 2 cost time: 6.113400459289551
Epoch: 2, Steps: 267 | Train Loss: 0.1473931 Vali Loss: 0.1572867 Test Loss: 0.2173554
Validation loss decreased (0.175527 --> 0.157287).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1249186
	speed: 0.0999s/iter; left time: 2605.0110s
	iters: 200, epoch: 3 | loss: 0.1229797
	speed: 0.0234s/iter; left time: 608.0267s
Epoch: 3 cost time: 6.133030652999878
Epoch: 3, Steps: 267 | Train Loss: 0.1225751 Vali Loss: 0.1471418 Test Loss: 0.2049973
Validation loss decreased (0.157287 --> 0.147142).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0982278
	speed: 0.1237s/iter; left time: 3190.4869s
	iters: 200, epoch: 4 | loss: 0.1218099
	speed: 0.0169s/iter; left time: 435.1699s
Epoch: 4 cost time: 8.705503940582275
Epoch: 4, Steps: 267 | Train Loss: 0.1102486 Vali Loss: 0.1407501 Test Loss: 0.1968230
Validation loss decreased (0.147142 --> 0.140750).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0892024
	speed: 0.1491s/iter; left time: 3807.1145s
	iters: 200, epoch: 5 | loss: 0.0990497
	speed: 0.0422s/iter; left time: 1072.4435s
Epoch: 5 cost time: 10.617696285247803
Epoch: 5, Steps: 267 | Train Loss: 0.1028593 Vali Loss: 0.1362630 Test Loss: 0.1907644
Validation loss decreased (0.140750 --> 0.136263).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0723616
	speed: 0.1684s/iter; left time: 4253.8083s
	iters: 200, epoch: 6 | loss: 0.0936031
	speed: 0.0289s/iter; left time: 727.0662s
Epoch: 6 cost time: 8.223278284072876
Epoch: 6, Steps: 267 | Train Loss: 0.0980386 Vali Loss: 0.1327112 Test Loss: 0.1862437
Validation loss decreased (0.136263 --> 0.132711).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0852702
	speed: 0.1182s/iter; left time: 2955.9195s
	iters: 200, epoch: 7 | loss: 0.0654231
	speed: 0.0166s/iter; left time: 413.8394s
Epoch: 7 cost time: 6.9408745765686035
Epoch: 7, Steps: 267 | Train Loss: 0.0949481 Vali Loss: 0.1305099 Test Loss: 0.1830570
Validation loss decreased (0.132711 --> 0.130510).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1000593
	speed: 0.1067s/iter; left time: 2638.0625s
	iters: 200, epoch: 8 | loss: 0.0916061
	speed: 0.0168s/iter; left time: 413.7741s
Epoch: 8 cost time: 5.883954763412476
Epoch: 8, Steps: 267 | Train Loss: 0.0927337 Vali Loss: 0.1289705 Test Loss: 0.1809584
Validation loss decreased (0.130510 --> 0.128971).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0769999
	speed: 0.0934s/iter; left time: 2285.5878s
	iters: 200, epoch: 9 | loss: 0.0822286
	speed: 0.0180s/iter; left time: 439.2695s
Epoch: 9 cost time: 5.909164905548096
Epoch: 9, Steps: 267 | Train Loss: 0.0911020 Vali Loss: 0.1279619 Test Loss: 0.1793478
Validation loss decreased (0.128971 --> 0.127962).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0791558
	speed: 0.1110s/iter; left time: 2686.3414s
	iters: 200, epoch: 10 | loss: 0.0738461
	speed: 0.0231s/iter; left time: 555.8927s
Epoch: 10 cost time: 8.119851112365723
Epoch: 10, Steps: 267 | Train Loss: 0.0900809 Vali Loss: 0.1269632 Test Loss: 0.1781208
Validation loss decreased (0.127962 --> 0.126963).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1430303
	speed: 0.1902s/iter; left time: 4550.6930s
	iters: 200, epoch: 11 | loss: 0.0843602
	speed: 0.0290s/iter; left time: 692.0009s
Epoch: 11 cost time: 8.802988767623901
Epoch: 11, Steps: 267 | Train Loss: 0.0893135 Vali Loss: 0.1264364 Test Loss: 0.1773043
Validation loss decreased (0.126963 --> 0.126436).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0664454
	speed: 0.1859s/iter; left time: 4400.0765s
	iters: 200, epoch: 12 | loss: 0.1229235
	speed: 0.0232s/iter; left time: 546.4469s
Epoch: 12 cost time: 8.80883240699768
Epoch: 12, Steps: 267 | Train Loss: 0.0887774 Vali Loss: 0.1259683 Test Loss: 0.1766670
Validation loss decreased (0.126436 --> 0.125968).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0634717
	speed: 0.1859s/iter; left time: 4350.6402s
	iters: 200, epoch: 13 | loss: 0.0975555
	speed: 0.0174s/iter; left time: 405.3378s
Epoch: 13 cost time: 8.464474201202393
Epoch: 13, Steps: 267 | Train Loss: 0.0885096 Vali Loss: 0.1256860 Test Loss: 0.1763554
Validation loss decreased (0.125968 --> 0.125686).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0739522
	speed: 0.1185s/iter; left time: 2739.8320s
	iters: 200, epoch: 14 | loss: 0.1151459
	speed: 0.0173s/iter; left time: 399.4313s
Epoch: 14 cost time: 5.6409735679626465
Epoch: 14, Steps: 267 | Train Loss: 0.0883521 Vali Loss: 0.1254908 Test Loss: 0.1759459
Validation loss decreased (0.125686 --> 0.125491).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0980037
	speed: 0.1299s/iter; left time: 2969.5234s
	iters: 200, epoch: 15 | loss: 0.0849954
	speed: 0.0228s/iter; left time: 518.7765s
Epoch: 15 cost time: 6.63832688331604
Epoch: 15, Steps: 267 | Train Loss: 0.0879782 Vali Loss: 0.1254011 Test Loss: 0.1758221
Validation loss decreased (0.125491 --> 0.125401).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1354404
	speed: 0.1133s/iter; left time: 2559.6308s
	iters: 200, epoch: 16 | loss: 0.0757973
	speed: 0.0210s/iter; left time: 472.3875s
Epoch: 16 cost time: 6.116904973983765
Epoch: 16, Steps: 267 | Train Loss: 0.0879224 Vali Loss: 0.1251993 Test Loss: 0.1756661
Validation loss decreased (0.125401 --> 0.125199).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1083711
	speed: 0.1231s/iter; left time: 2748.7170s
	iters: 200, epoch: 17 | loss: 0.1258607
	speed: 0.0183s/iter; left time: 406.1866s
Epoch: 17 cost time: 8.137694597244263
Epoch: 17, Steps: 267 | Train Loss: 0.0879463 Vali Loss: 0.1250102 Test Loss: 0.1755646
Validation loss decreased (0.125199 --> 0.125010).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0772311
	speed: 0.1083s/iter; left time: 2388.6805s
	iters: 200, epoch: 18 | loss: 0.0724603
	speed: 0.0284s/iter; left time: 622.8832s
Epoch: 18 cost time: 7.673851728439331
Epoch: 18, Steps: 267 | Train Loss: 0.0877918 Vali Loss: 0.1249628 Test Loss: 0.1755860
Validation loss decreased (0.125010 --> 0.124963).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0916645
	speed: 0.1158s/iter; left time: 2523.5230s
	iters: 200, epoch: 19 | loss: 0.1133552
	speed: 0.0260s/iter; left time: 563.3660s
Epoch: 19 cost time: 7.416672468185425
Epoch: 19, Steps: 267 | Train Loss: 0.0879515 Vali Loss: 0.1249615 Test Loss: 0.1755383
Validation loss decreased (0.124963 --> 0.124961).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1393255
	speed: 0.1637s/iter; left time: 3523.8236s
	iters: 200, epoch: 20 | loss: 0.0824768
	speed: 0.0295s/iter; left time: 631.1633s
Epoch: 20 cost time: 9.666402101516724
Epoch: 20, Steps: 267 | Train Loss: 0.0879658 Vali Loss: 0.1250760 Test Loss: 0.1754917
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1056590
	speed: 0.1639s/iter; left time: 3484.0861s
	iters: 200, epoch: 21 | loss: 0.1109467
	speed: 0.0164s/iter; left time: 346.6460s
Epoch: 21 cost time: 6.769501447677612
Epoch: 21, Steps: 267 | Train Loss: 0.0879015 Vali Loss: 0.1250090 Test Loss: 0.1753623
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0735050
	speed: 0.1141s/iter; left time: 2396.4081s
	iters: 200, epoch: 22 | loss: 0.0854951
	speed: 0.0231s/iter; left time: 483.5651s
Epoch: 22 cost time: 7.4295759201049805
Epoch: 22, Steps: 267 | Train Loss: 0.0879021 Vali Loss: 0.1249765 Test Loss: 0.1754026
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1004167
	speed: 0.1571s/iter; left time: 3257.1395s
	iters: 200, epoch: 23 | loss: 0.0930393
	speed: 0.0316s/iter; left time: 650.8129s
Epoch: 23 cost time: 7.998754262924194
Epoch: 23, Steps: 267 | Train Loss: 0.0878251 Vali Loss: 0.1250203 Test Loss: 0.1753833
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1720650
	speed: 0.1186s/iter; left time: 2426.2371s
	iters: 200, epoch: 24 | loss: 0.0733064
	speed: 0.0209s/iter; left time: 426.4878s
Epoch: 24 cost time: 5.76119327545166
Epoch: 24, Steps: 267 | Train Loss: 0.0878892 Vali Loss: 0.1249966 Test Loss: 0.1753914
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0849964
	speed: 0.1223s/iter; left time: 2468.6164s
	iters: 200, epoch: 25 | loss: 0.0763978
	speed: 0.0310s/iter; left time: 622.6145s
Epoch: 25 cost time: 9.410209655761719
Epoch: 25, Steps: 267 | Train Loss: 0.0878307 Vali Loss: 0.1251333 Test Loss: 0.1754436
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0782590
	speed: 0.1475s/iter; left time: 2939.7306s
	iters: 200, epoch: 26 | loss: 0.1026226
	speed: 0.0287s/iter; left time: 569.4199s
Epoch: 26 cost time: 8.667138814926147
Epoch: 26, Steps: 267 | Train Loss: 0.0878523 Vali Loss: 0.1249516 Test Loss: 0.1753688
Validation loss decreased (0.124961 --> 0.124952).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1093021
	speed: 0.1169s/iter; left time: 2298.7582s
	iters: 200, epoch: 27 | loss: 0.0976628
	speed: 0.0199s/iter; left time: 388.7403s
Epoch: 27 cost time: 6.167729616165161
Epoch: 27, Steps: 267 | Train Loss: 0.0879147 Vali Loss: 0.1250498 Test Loss: 0.1754120
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0838913
	speed: 0.1761s/iter; left time: 3414.5311s
	iters: 200, epoch: 28 | loss: 0.1238894
	speed: 0.0184s/iter; left time: 354.0550s
Epoch: 28 cost time: 7.29815411567688
Epoch: 28, Steps: 267 | Train Loss: 0.0879276 Vali Loss: 0.1250253 Test Loss: 0.1754130
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0849469
	speed: 0.1491s/iter; left time: 2851.4902s
	iters: 200, epoch: 29 | loss: 0.0924497
	speed: 0.0538s/iter; left time: 1023.7132s
Epoch: 29 cost time: 11.713696718215942
Epoch: 29, Steps: 267 | Train Loss: 0.0878370 Vali Loss: 0.1250341 Test Loss: 0.1753622
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0788105
	speed: 0.1295s/iter; left time: 2441.5213s
	iters: 200, epoch: 30 | loss: 0.1356109
	speed: 0.0309s/iter; left time: 579.9052s
Epoch: 30 cost time: 8.717851161956787
Epoch: 30, Steps: 267 | Train Loss: 0.0879012 Vali Loss: 0.1250741 Test Loss: 0.1754360
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0790635
	speed: 0.1171s/iter; left time: 2176.4127s
	iters: 200, epoch: 31 | loss: 0.0856639
	speed: 0.0349s/iter; left time: 644.7904s
Epoch: 31 cost time: 8.834807634353638
Epoch: 31, Steps: 267 | Train Loss: 0.0878797 Vali Loss: 0.1250028 Test Loss: 0.1753905
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0831094
	speed: 0.1293s/iter; left time: 2369.6221s
	iters: 200, epoch: 32 | loss: 0.0721844
	speed: 0.0287s/iter; left time: 522.3050s
Epoch: 32 cost time: 8.251392602920532
Epoch: 32, Steps: 267 | Train Loss: 0.0878028 Vali Loss: 0.1250525 Test Loss: 0.1753967
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0724574
	speed: 0.1637s/iter; left time: 2956.1787s
	iters: 200, epoch: 33 | loss: 0.0966545
	speed: 0.0417s/iter; left time: 748.0811s
Epoch: 33 cost time: 11.033601760864258
Epoch: 33, Steps: 267 | Train Loss: 0.0878757 Vali Loss: 0.1251287 Test Loss: 0.1754308
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0883225
	speed: 0.1160s/iter; left time: 2063.2142s
	iters: 200, epoch: 34 | loss: 0.0559903
	speed: 0.0524s/iter; left time: 926.2339s
Epoch: 34 cost time: 8.891820907592773
Epoch: 34, Steps: 267 | Train Loss: 0.0878445 Vali Loss: 0.1250098 Test Loss: 0.1754230
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0991736
	speed: 0.0999s/iter; left time: 1749.9140s
	iters: 200, epoch: 35 | loss: 0.1470906
	speed: 0.0202s/iter; left time: 352.2458s
Epoch: 35 cost time: 6.319025278091431
Epoch: 35, Steps: 267 | Train Loss: 0.0877433 Vali Loss: 0.1250462 Test Loss: 0.1754255
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1008167
	speed: 0.1092s/iter; left time: 1884.4396s
	iters: 200, epoch: 36 | loss: 0.0531408
	speed: 0.0243s/iter; left time: 417.7002s
Epoch: 36 cost time: 6.481076717376709
Epoch: 36, Steps: 267 | Train Loss: 0.0876455 Vali Loss: 0.1250133 Test Loss: 0.1753702
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0972907
	speed: 0.1318s/iter; left time: 2238.5929s
	iters: 200, epoch: 37 | loss: 0.1008570
	speed: 0.0170s/iter; left time: 287.2122s
Epoch: 37 cost time: 7.241452932357788
Epoch: 37, Steps: 267 | Train Loss: 0.0877376 Vali Loss: 0.1250504 Test Loss: 0.1753834
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0732089
	speed: 0.1378s/iter; left time: 2304.2952s
	iters: 200, epoch: 38 | loss: 0.0799788
	speed: 0.0199s/iter; left time: 330.3741s
Epoch: 38 cost time: 8.794184923171997
Epoch: 38, Steps: 267 | Train Loss: 0.0878930 Vali Loss: 0.1249862 Test Loss: 0.1753677
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0879638
	speed: 0.1427s/iter; left time: 2348.3311s
	iters: 200, epoch: 39 | loss: 0.1255483
	speed: 0.0162s/iter; left time: 264.2519s
Epoch: 39 cost time: 9.27755069732666
Epoch: 39, Steps: 267 | Train Loss: 0.0878160 Vali Loss: 0.1249814 Test Loss: 0.1753792
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1248559
	speed: 0.1396s/iter; left time: 2259.3043s
	iters: 200, epoch: 40 | loss: 0.0861043
	speed: 0.0281s/iter; left time: 452.2580s
Epoch: 40 cost time: 7.2772486209869385
Epoch: 40, Steps: 267 | Train Loss: 0.0879185 Vali Loss: 0.1250480 Test Loss: 0.1753633
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1225927
	speed: 0.1140s/iter; left time: 1815.2352s
	iters: 200, epoch: 41 | loss: 0.0835819
	speed: 0.0173s/iter; left time: 273.6713s
Epoch: 41 cost time: 6.009329080581665
Epoch: 41, Steps: 267 | Train Loss: 0.0878131 Vali Loss: 0.1249840 Test Loss: 0.1753640
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0710849
	speed: 0.1596s/iter; left time: 2498.1022s
	iters: 200, epoch: 42 | loss: 0.0764940
	speed: 0.0245s/iter; left time: 380.3616s
Epoch: 42 cost time: 10.098405838012695
Epoch: 42, Steps: 267 | Train Loss: 0.0878123 Vali Loss: 0.1250339 Test Loss: 0.1753652
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0643210
	speed: 0.1680s/iter; left time: 2585.1423s
	iters: 200, epoch: 43 | loss: 0.0916637
	speed: 0.0327s/iter; left time: 500.0668s
Epoch: 43 cost time: 9.501758813858032
Epoch: 43, Steps: 267 | Train Loss: 0.0878757 Vali Loss: 0.1250397 Test Loss: 0.1753905
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0749070
	speed: 0.1486s/iter; left time: 2246.9493s
	iters: 200, epoch: 44 | loss: 0.0804040
	speed: 0.0440s/iter; left time: 660.6774s
Epoch: 44 cost time: 10.602828025817871
Epoch: 44, Steps: 267 | Train Loss: 0.0878833 Vali Loss: 0.1250243 Test Loss: 0.1753735
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0787408
	speed: 0.1155s/iter; left time: 1715.3259s
	iters: 200, epoch: 45 | loss: 0.0931436
	speed: 0.0275s/iter; left time: 405.2858s
Epoch: 45 cost time: 7.658329248428345
Epoch: 45, Steps: 267 | Train Loss: 0.0876983 Vali Loss: 0.1250996 Test Loss: 0.1753616
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0815274
	speed: 0.0940s/iter; left time: 1371.4998s
	iters: 200, epoch: 46 | loss: 0.0725506
	speed: 0.0243s/iter; left time: 351.4059s
Epoch: 46 cost time: 6.610503673553467
Epoch: 46, Steps: 267 | Train Loss: 0.0878505 Vali Loss: 0.1250103 Test Loss: 0.1753555
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=34, out_features=52, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1584128.0
params:  1820.0
Trainable parameters:  1820
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1856907
	speed: 0.0427s/iter; left time: 1135.2453s
	iters: 200, epoch: 1 | loss: 0.1714774
	speed: 0.0294s/iter; left time: 779.7291s
Epoch: 1 cost time: 9.618054151535034
Epoch: 1, Steps: 267 | Train Loss: 0.2310924 Vali Loss: 0.1240228 Test Loss: 0.1738231
Validation loss decreased (inf --> 0.124023).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1749184
	speed: 0.1575s/iter; left time: 4148.6457s
	iters: 200, epoch: 2 | loss: 0.1544697
	speed: 0.0295s/iter; left time: 772.6436s
Epoch: 2 cost time: 10.884296178817749
Epoch: 2, Steps: 267 | Train Loss: 0.2307775 Vali Loss: 0.1238075 Test Loss: 0.1736832
Validation loss decreased (0.124023 --> 0.123808).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2076533
	speed: 0.1606s/iter; left time: 4186.6167s
	iters: 200, epoch: 3 | loss: 0.1994435
	speed: 0.0367s/iter; left time: 954.2196s
Epoch: 3 cost time: 8.398056507110596
Epoch: 3, Steps: 267 | Train Loss: 0.2300384 Vali Loss: 0.1235170 Test Loss: 0.1736275
Validation loss decreased (0.123808 --> 0.123517).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2199426
	speed: 0.1049s/iter; left time: 2706.7960s
	iters: 200, epoch: 4 | loss: 0.2138724
	speed: 0.0158s/iter; left time: 405.6702s
Epoch: 4 cost time: 5.283584117889404
Epoch: 4, Steps: 267 | Train Loss: 0.2294652 Vali Loss: 0.1233520 Test Loss: 0.1733476
Validation loss decreased (0.123517 --> 0.123352).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3060722
	speed: 0.0995s/iter; left time: 2540.9506s
	iters: 200, epoch: 5 | loss: 0.1695153
	speed: 0.0202s/iter; left time: 513.1638s
Epoch: 5 cost time: 5.507035255432129
Epoch: 5, Steps: 267 | Train Loss: 0.2294031 Vali Loss: 0.1233953 Test Loss: 0.1728647
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3008555
	speed: 0.1138s/iter; left time: 2874.1807s
	iters: 200, epoch: 6 | loss: 0.2554098
	speed: 0.0231s/iter; left time: 580.2248s
Epoch: 6 cost time: 5.770759344100952
Epoch: 6, Steps: 267 | Train Loss: 0.2292694 Vali Loss: 0.1233824 Test Loss: 0.1728708
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1980264
	speed: 0.1103s/iter; left time: 2756.6102s
	iters: 200, epoch: 7 | loss: 0.1535688
	speed: 0.0279s/iter; left time: 694.7352s
Epoch: 7 cost time: 6.964041709899902
Epoch: 7, Steps: 267 | Train Loss: 0.2292840 Vali Loss: 0.1232684 Test Loss: 0.1730079
Validation loss decreased (0.123352 --> 0.123268).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2453841
	speed: 0.1108s/iter; left time: 2740.9451s
	iters: 200, epoch: 8 | loss: 0.1871814
	speed: 0.0372s/iter; left time: 917.2351s
Epoch: 8 cost time: 8.569994926452637
Epoch: 8, Steps: 267 | Train Loss: 0.2292310 Vali Loss: 0.1234904 Test Loss: 0.1729677
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2782917
	speed: 0.1184s/iter; left time: 2897.1209s
	iters: 200, epoch: 9 | loss: 0.2376376
	speed: 0.0237s/iter; left time: 576.2757s
Epoch: 9 cost time: 8.294053792953491
Epoch: 9, Steps: 267 | Train Loss: 0.2285946 Vali Loss: 0.1232700 Test Loss: 0.1728423
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2831480
	speed: 0.1470s/iter; left time: 3555.9532s
	iters: 200, epoch: 10 | loss: 0.2970141
	speed: 0.0255s/iter; left time: 614.2255s
Epoch: 10 cost time: 10.016739845275879
Epoch: 10, Steps: 267 | Train Loss: 0.2289270 Vali Loss: 0.1232602 Test Loss: 0.1725399
Validation loss decreased (0.123268 --> 0.123260).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2132447
	speed: 0.1530s/iter; left time: 3660.5005s
	iters: 200, epoch: 11 | loss: 0.3250355
	speed: 0.0180s/iter; left time: 428.6011s
Epoch: 11 cost time: 6.024842739105225
Epoch: 11, Steps: 267 | Train Loss: 0.2290165 Vali Loss: 0.1231531 Test Loss: 0.1727112
Validation loss decreased (0.123260 --> 0.123153).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1654623
	speed: 0.1129s/iter; left time: 2672.3819s
	iters: 200, epoch: 12 | loss: 0.2172378
	speed: 0.0292s/iter; left time: 688.5992s
Epoch: 12 cost time: 8.396479606628418
Epoch: 12, Steps: 267 | Train Loss: 0.2285807 Vali Loss: 0.1230432 Test Loss: 0.1726969
Validation loss decreased (0.123153 --> 0.123043).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1365741
	speed: 0.1400s/iter; left time: 3276.4891s
	iters: 200, epoch: 13 | loss: 0.2273317
	speed: 0.0177s/iter; left time: 412.8476s
Epoch: 13 cost time: 7.3734753131866455
Epoch: 13, Steps: 267 | Train Loss: 0.2285000 Vali Loss: 0.1231267 Test Loss: 0.1726055
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2354503
	speed: 0.2138s/iter; left time: 4946.0809s
	iters: 200, epoch: 14 | loss: 0.1390584
	speed: 0.0304s/iter; left time: 700.0018s
Epoch: 14 cost time: 9.418013334274292
Epoch: 14, Steps: 267 | Train Loss: 0.2282257 Vali Loss: 0.1231880 Test Loss: 0.1726439
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1847182
	speed: 0.1690s/iter; left time: 3863.5548s
	iters: 200, epoch: 15 | loss: 0.2805972
	speed: 0.0391s/iter; left time: 891.0900s
Epoch: 15 cost time: 9.953848361968994
Epoch: 15, Steps: 267 | Train Loss: 0.2283961 Vali Loss: 0.1229763 Test Loss: 0.1726173
Validation loss decreased (0.123043 --> 0.122976).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2639787
	speed: 0.1285s/iter; left time: 2903.0686s
	iters: 200, epoch: 16 | loss: 0.2334991
	speed: 0.0306s/iter; left time: 688.7110s
Epoch: 16 cost time: 6.902493476867676
Epoch: 16, Steps: 267 | Train Loss: 0.2286524 Vali Loss: 0.1232168 Test Loss: 0.1727356
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1565554
	speed: 0.1320s/iter; left time: 2946.7529s
	iters: 200, epoch: 17 | loss: 0.2036129
	speed: 0.0263s/iter; left time: 584.8900s
Epoch: 17 cost time: 8.161848306655884
Epoch: 17, Steps: 267 | Train Loss: 0.2286122 Vali Loss: 0.1232494 Test Loss: 0.1728354
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1995654
	speed: 0.1637s/iter; left time: 3612.2870s
	iters: 200, epoch: 18 | loss: 0.2060095
	speed: 0.0331s/iter; left time: 726.7524s
Epoch: 18 cost time: 10.894999980926514
Epoch: 18, Steps: 267 | Train Loss: 0.2286962 Vali Loss: 0.1231815 Test Loss: 0.1726079
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1567999
	speed: 0.1405s/iter; left time: 3062.0431s
	iters: 200, epoch: 19 | loss: 0.2578369
	speed: 0.0352s/iter; left time: 763.0836s
Epoch: 19 cost time: 9.660035133361816
Epoch: 19, Steps: 267 | Train Loss: 0.2286601 Vali Loss: 0.1231746 Test Loss: 0.1726619
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2027489
	speed: 0.1450s/iter; left time: 3121.2921s
	iters: 200, epoch: 20 | loss: 0.2635899
	speed: 0.0355s/iter; left time: 760.4833s
Epoch: 20 cost time: 8.190191507339478
Epoch: 20, Steps: 267 | Train Loss: 0.2284904 Vali Loss: 0.1232415 Test Loss: 0.1726412
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3984018
	speed: 0.1027s/iter; left time: 2184.2288s
	iters: 200, epoch: 21 | loss: 0.3083642
	speed: 0.0281s/iter; left time: 594.1730s
Epoch: 21 cost time: 7.650993824005127
Epoch: 21, Steps: 267 | Train Loss: 0.2284849 Vali Loss: 0.1231964 Test Loss: 0.1726555
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2325351
	speed: 0.1133s/iter; left time: 2379.4201s
	iters: 200, epoch: 22 | loss: 0.2694179
	speed: 0.0234s/iter; left time: 488.4659s
Epoch: 22 cost time: 6.187646150588989
Epoch: 22, Steps: 267 | Train Loss: 0.2284675 Vali Loss: 0.1232661 Test Loss: 0.1727603
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2864325
	speed: 0.1357s/iter; left time: 2813.2462s
	iters: 200, epoch: 23 | loss: 0.3817140
	speed: 0.0182s/iter; left time: 375.1504s
Epoch: 23 cost time: 6.710691452026367
Epoch: 23, Steps: 267 | Train Loss: 0.2286265 Vali Loss: 0.1232463 Test Loss: 0.1727181
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1363123
	speed: 0.1114s/iter; left time: 2279.6453s
	iters: 200, epoch: 24 | loss: 0.4156289
	speed: 0.0445s/iter; left time: 905.6375s
Epoch: 24 cost time: 10.498971939086914
Epoch: 24, Steps: 267 | Train Loss: 0.2285872 Vali Loss: 0.1231099 Test Loss: 0.1726609
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2528120
	speed: 0.1637s/iter; left time: 3305.6599s
	iters: 200, epoch: 25 | loss: 0.2822645
	speed: 0.0194s/iter; left time: 390.3174s
Epoch: 25 cost time: 5.819045066833496
Epoch: 25, Steps: 267 | Train Loss: 0.2282594 Vali Loss: 0.1231487 Test Loss: 0.1726192
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1666328
	speed: 0.0951s/iter; left time: 1895.6270s
	iters: 200, epoch: 26 | loss: 0.2038272
	speed: 0.0170s/iter; left time: 336.9462s
Epoch: 26 cost time: 5.938939094543457
Epoch: 26, Steps: 267 | Train Loss: 0.2284776 Vali Loss: 0.1231078 Test Loss: 0.1726872
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2554531
	speed: 0.1255s/iter; left time: 2467.9223s
	iters: 200, epoch: 27 | loss: 0.2543092
	speed: 0.0556s/iter; left time: 1087.1761s
Epoch: 27 cost time: 11.313436269760132
Epoch: 27, Steps: 267 | Train Loss: 0.2285040 Vali Loss: 0.1231337 Test Loss: 0.1726344
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1630156
	speed: 0.1446s/iter; left time: 2803.8174s
	iters: 200, epoch: 28 | loss: 0.2652819
	speed: 0.0276s/iter; left time: 532.9419s
Epoch: 28 cost time: 6.786021947860718
Epoch: 28, Steps: 267 | Train Loss: 0.2284555 Vali Loss: 0.1231408 Test Loss: 0.1726689
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3443908
	speed: 0.1887s/iter; left time: 3609.8256s
	iters: 200, epoch: 29 | loss: 0.2209157
	speed: 0.0261s/iter; left time: 496.4796s
Epoch: 29 cost time: 8.70081114768982
Epoch: 29, Steps: 267 | Train Loss: 0.2286173 Vali Loss: 0.1231943 Test Loss: 0.1726243
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2236214
	speed: 0.1579s/iter; left time: 2978.3915s
	iters: 200, epoch: 30 | loss: 0.2323174
	speed: 0.0206s/iter; left time: 387.0911s
Epoch: 30 cost time: 8.10014271736145
Epoch: 30, Steps: 267 | Train Loss: 0.2284627 Vali Loss: 0.1231557 Test Loss: 0.1726662
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3065597
	speed: 0.1431s/iter; left time: 2660.1825s
	iters: 200, epoch: 31 | loss: 0.2023301
	speed: 0.0158s/iter; left time: 293.0131s
Epoch: 31 cost time: 5.195053577423096
Epoch: 31, Steps: 267 | Train Loss: 0.2284060 Vali Loss: 0.1231417 Test Loss: 0.1726117
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2135983
	speed: 0.1121s/iter; left time: 2054.5971s
	iters: 200, epoch: 32 | loss: 0.1960292
	speed: 0.0196s/iter; left time: 356.2832s
Epoch: 32 cost time: 7.410800218582153
Epoch: 32, Steps: 267 | Train Loss: 0.2284740 Vali Loss: 0.1231212 Test Loss: 0.1726348
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2103243
	speed: 0.1193s/iter; left time: 2153.5126s
	iters: 200, epoch: 33 | loss: 0.2511041
	speed: 0.0247s/iter; left time: 442.7705s
Epoch: 33 cost time: 6.422703504562378
Epoch: 33, Steps: 267 | Train Loss: 0.2284141 Vali Loss: 0.1231226 Test Loss: 0.1727127
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3103709
	speed: 0.1137s/iter; left time: 2023.0177s
	iters: 200, epoch: 34 | loss: 0.2059267
	speed: 0.0182s/iter; left time: 322.0503s
Epoch: 34 cost time: 8.744370222091675
Epoch: 34, Steps: 267 | Train Loss: 0.2284207 Vali Loss: 0.1230853 Test Loss: 0.1726611
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1526467
	speed: 0.1524s/iter; left time: 2669.7546s
	iters: 200, epoch: 35 | loss: 0.2303365
	speed: 0.0182s/iter; left time: 317.0470s
Epoch: 35 cost time: 9.600996494293213
Epoch: 35, Steps: 267 | Train Loss: 0.2283267 Vali Loss: 0.1231314 Test Loss: 0.1726630
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.17336831986904144, mae:0.2589026093482971, rse:0.33758336305618286, corr:[0.5736242  0.57344764 0.5686655  0.5660898  0.5659933  0.5656429
 0.56407887 0.56230295 0.5614343  0.56123537 0.5608087  0.5600118
 0.55936766 0.5591993  0.55918217 0.5586808  0.55765325 0.5565913
 0.55592936 0.5555665  0.5551383  0.5545037  0.5539203  0.55361974
 0.55340075 0.5529315  0.55222654 0.5515471  0.5511048  0.5507736
 0.55033857 0.54975826 0.5490555  0.54845726 0.54806626 0.54780614
 0.54736817 0.5467203  0.54592264 0.5451123  0.5444605  0.5440175
 0.54372305 0.54347485 0.54315656 0.5427078  0.5420465  0.5412046
 0.5402855  0.53944814 0.5387553  0.53820825 0.5376228  0.5369228
 0.53629464 0.535873   0.5354281  0.5349242  0.5343854  0.5340111
 0.53376096 0.53367037 0.53358465 0.5332984  0.5329487  0.53277993
 0.53270966 0.5326218  0.5324416  0.5322718  0.532163   0.53210944
 0.5320193  0.53172374 0.53142387 0.531155   0.53096735 0.5307203
 0.5303492  0.5298895  0.5293971  0.528944   0.5285221  0.52803177
 0.5274926  0.52703226 0.5266852  0.5264862  0.5262333  0.52586067
 0.5255764  0.52547455 0.5253951  0.5252428  0.52483886 0.5233481 ]
