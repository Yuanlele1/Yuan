Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=34, out_features=52, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1584128.0
params:  1820.0
Trainable parameters:  1820
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3648838
	speed: 0.0620s/iter; left time: 1648.4783s
	iters: 200, epoch: 1 | loss: 0.2745499
	speed: 0.0383s/iter; left time: 1015.7500s
Epoch: 1 cost time: 13.836655855178833
Epoch: 1, Steps: 267 | Train Loss: 0.3081758 Vali Loss: 0.1423521 Test Loss: 0.2003956
Validation loss decreased (inf --> 0.142352).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1952286
	speed: 0.2047s/iter; left time: 5391.2842s
	iters: 200, epoch: 2 | loss: 0.3604447
	speed: 0.0522s/iter; left time: 1370.3861s
Epoch: 2 cost time: 13.934587240219116
Epoch: 2, Steps: 267 | Train Loss: 0.2541073 Vali Loss: 0.1308805 Test Loss: 0.1857249
Validation loss decreased (0.142352 --> 0.130881).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2455806
	speed: 0.2039s/iter; left time: 5314.8377s
	iters: 200, epoch: 3 | loss: 0.2490812
	speed: 0.0316s/iter; left time: 821.3224s
Epoch: 3 cost time: 11.303215980529785
Epoch: 3, Steps: 267 | Train Loss: 0.2425420 Vali Loss: 0.1273167 Test Loss: 0.1804913
Validation loss decreased (0.130881 --> 0.127317).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2085886
	speed: 0.1499s/iter; left time: 3867.4909s
	iters: 200, epoch: 4 | loss: 0.2789876
	speed: 0.0240s/iter; left time: 617.9174s
Epoch: 4 cost time: 7.870446443557739
Epoch: 4, Steps: 267 | Train Loss: 0.2379158 Vali Loss: 0.1259061 Test Loss: 0.1781248
Validation loss decreased (0.127317 --> 0.125906).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1930988
	speed: 0.2313s/iter; left time: 5904.5894s
	iters: 200, epoch: 5 | loss: 0.2322319
	speed: 0.0523s/iter; left time: 1329.9032s
Epoch: 5 cost time: 15.083101749420166
Epoch: 5, Steps: 267 | Train Loss: 0.2354114 Vali Loss: 0.1250689 Test Loss: 0.1764979
Validation loss decreased (0.125906 --> 0.125069).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1609158
	speed: 0.2148s/iter; left time: 5426.0037s
	iters: 200, epoch: 6 | loss: 0.2227224
	speed: 0.0401s/iter; left time: 1010.0873s
Epoch: 6 cost time: 12.140025615692139
Epoch: 6, Steps: 267 | Train Loss: 0.2337794 Vali Loss: 0.1242995 Test Loss: 0.1755923
Validation loss decreased (0.125069 --> 0.124300).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2079192
	speed: 0.1812s/iter; left time: 4530.0641s
	iters: 200, epoch: 7 | loss: 0.1489649
	speed: 0.0439s/iter; left time: 1092.5091s
Epoch: 7 cost time: 12.168355703353882
Epoch: 7, Steps: 267 | Train Loss: 0.2331546 Vali Loss: 0.1240648 Test Loss: 0.1749659
Validation loss decreased (0.124300 --> 0.124065).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2503559
	speed: 0.1527s/iter; left time: 3775.9031s
	iters: 200, epoch: 8 | loss: 0.2340318
	speed: 0.0307s/iter; left time: 756.1421s
Epoch: 8 cost time: 9.182059049606323
Epoch: 8, Steps: 267 | Train Loss: 0.2324240 Vali Loss: 0.1238882 Test Loss: 0.1746456
Validation loss decreased (0.124065 --> 0.123888).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1871380
	speed: 0.1333s/iter; left time: 3260.7673s
	iters: 200, epoch: 9 | loss: 0.2045012
	speed: 0.0296s/iter; left time: 720.2978s
Epoch: 9 cost time: 9.832192420959473
Epoch: 9, Steps: 267 | Train Loss: 0.2315631 Vali Loss: 0.1237788 Test Loss: 0.1742064
Validation loss decreased (0.123888 --> 0.123779).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2030185
	speed: 0.2129s/iter; left time: 5151.3301s
	iters: 200, epoch: 10 | loss: 0.1869190
	speed: 0.0367s/iter; left time: 884.5356s
Epoch: 10 cost time: 12.734659433364868
Epoch: 10, Steps: 267 | Train Loss: 0.2312434 Vali Loss: 0.1234915 Test Loss: 0.1739332
Validation loss decreased (0.123779 --> 0.123491).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3830947
	speed: 0.2127s/iter; left time: 5090.1610s
	iters: 200, epoch: 11 | loss: 0.2183250
	speed: 0.0432s/iter; left time: 1028.8664s
Epoch: 11 cost time: 12.807762861251831
Epoch: 11, Steps: 267 | Train Loss: 0.2307705 Vali Loss: 0.1235023 Test Loss: 0.1738030
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1684352
	speed: 0.1736s/iter; left time: 4108.4222s
	iters: 200, epoch: 12 | loss: 0.3276697
	speed: 0.0308s/iter; left time: 726.7097s
Epoch: 12 cost time: 7.43724513053894
Epoch: 12, Steps: 267 | Train Loss: 0.2303833 Vali Loss: 0.1233889 Test Loss: 0.1735600
Validation loss decreased (0.123491 --> 0.123389).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1590043
	speed: 0.1218s/iter; left time: 2849.8306s
	iters: 200, epoch: 13 | loss: 0.2594317
	speed: 0.0375s/iter; left time: 874.4958s
Epoch: 13 cost time: 9.547665119171143
Epoch: 13, Steps: 267 | Train Loss: 0.2303497 Vali Loss: 0.1233198 Test Loss: 0.1735160
Validation loss decreased (0.123389 --> 0.123320).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1898462
	speed: 0.1807s/iter; left time: 4178.8887s
	iters: 200, epoch: 14 | loss: 0.3094949
	speed: 0.0655s/iter; left time: 1509.1337s
Epoch: 14 cost time: 17.509795904159546
Epoch: 14, Steps: 267 | Train Loss: 0.2303255 Vali Loss: 0.1232985 Test Loss: 0.1732803
Validation loss decreased (0.123320 --> 0.123299).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2607120
	speed: 0.2798s/iter; left time: 6397.4640s
	iters: 200, epoch: 15 | loss: 0.2170529
	speed: 0.0487s/iter; left time: 1108.8109s
Epoch: 15 cost time: 16.775884866714478
Epoch: 15, Steps: 267 | Train Loss: 0.2295137 Vali Loss: 0.1233325 Test Loss: 0.1732964
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3595975
	speed: 0.2539s/iter; left time: 5737.2769s
	iters: 200, epoch: 16 | loss: 0.1944516
	speed: 0.0351s/iter; left time: 789.0935s
Epoch: 16 cost time: 12.634859085083008
Epoch: 16, Steps: 267 | Train Loss: 0.2294953 Vali Loss: 0.1232053 Test Loss: 0.1732202
Validation loss decreased (0.123299 --> 0.123205).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2850317
	speed: 0.1478s/iter; left time: 3300.0622s
	iters: 200, epoch: 17 | loss: 0.3426553
	speed: 0.0173s/iter; left time: 383.8071s
Epoch: 17 cost time: 7.036831378936768
Epoch: 17, Steps: 267 | Train Loss: 0.2296178 Vali Loss: 0.1230576 Test Loss: 0.1731238
Validation loss decreased (0.123205 --> 0.123058).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1972985
	speed: 0.1481s/iter; left time: 3268.2685s
	iters: 200, epoch: 18 | loss: 0.1889810
	speed: 0.0344s/iter; left time: 754.6829s
Epoch: 18 cost time: 10.817013502120972
Epoch: 18, Steps: 267 | Train Loss: 0.2291749 Vali Loss: 0.1230439 Test Loss: 0.1731942
Validation loss decreased (0.123058 --> 0.123044).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2348472
	speed: 0.1879s/iter; left time: 4096.1998s
	iters: 200, epoch: 19 | loss: 0.3012667
	speed: 0.0502s/iter; left time: 1088.3516s
Epoch: 19 cost time: 13.391000509262085
Epoch: 19, Steps: 267 | Train Loss: 0.2296151 Vali Loss: 0.1230675 Test Loss: 0.1731600
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3732187
	speed: 0.1835s/iter; left time: 3950.2172s
	iters: 200, epoch: 20 | loss: 0.2160745
	speed: 0.0313s/iter; left time: 670.3811s
Epoch: 20 cost time: 10.93848991394043
Epoch: 20, Steps: 267 | Train Loss: 0.2296287 Vali Loss: 0.1231959 Test Loss: 0.1731019
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2709438
	speed: 0.1946s/iter; left time: 4137.6421s
	iters: 200, epoch: 21 | loss: 0.2920651
	speed: 0.0234s/iter; left time: 495.1517s
Epoch: 21 cost time: 10.155891418457031
Epoch: 21, Steps: 267 | Train Loss: 0.2294212 Vali Loss: 0.1231414 Test Loss: 0.1729398
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1868854
	speed: 0.1259s/iter; left time: 2642.5954s
	iters: 200, epoch: 22 | loss: 0.2194228
	speed: 0.0251s/iter; left time: 524.7454s
Epoch: 22 cost time: 8.838666200637817
Epoch: 22, Steps: 267 | Train Loss: 0.2293654 Vali Loss: 0.1231140 Test Loss: 0.1729962
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2643431
	speed: 0.1824s/iter; left time: 3781.5968s
	iters: 200, epoch: 23 | loss: 0.2439266
	speed: 0.0517s/iter; left time: 1066.3587s
Epoch: 23 cost time: 13.622982263565063
Epoch: 23, Steps: 267 | Train Loss: 0.2290970 Vali Loss: 0.1231523 Test Loss: 0.1729483
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.4646672
	speed: 0.1635s/iter; left time: 3344.8302s
	iters: 200, epoch: 24 | loss: 0.1826550
	speed: 0.0508s/iter; left time: 1034.5974s
Epoch: 24 cost time: 15.351794242858887
Epoch: 24, Steps: 267 | Train Loss: 0.2292622 Vali Loss: 0.1231246 Test Loss: 0.1729496
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2147362
	speed: 0.2140s/iter; left time: 4320.4656s
	iters: 200, epoch: 25 | loss: 0.1959669
	speed: 0.0624s/iter; left time: 1252.8529s
Epoch: 25 cost time: 15.368996381759644
Epoch: 25, Steps: 267 | Train Loss: 0.2290632 Vali Loss: 0.1232455 Test Loss: 0.1729928
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2049542
	speed: 0.1706s/iter; left time: 3400.3598s
	iters: 200, epoch: 26 | loss: 0.2728078
	speed: 0.0386s/iter; left time: 765.9835s
Epoch: 26 cost time: 11.688573598861694
Epoch: 26, Steps: 267 | Train Loss: 0.2291191 Vali Loss: 0.1230521 Test Loss: 0.1728856
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2894948
	speed: 0.2043s/iter; left time: 4015.8610s
	iters: 200, epoch: 27 | loss: 0.2558191
	speed: 0.0292s/iter; left time: 571.5891s
Epoch: 27 cost time: 9.367824792861938
Epoch: 27, Steps: 267 | Train Loss: 0.2292525 Vali Loss: 0.1231434 Test Loss: 0.1729168
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2212492
	speed: 0.2237s/iter; left time: 4338.4400s
	iters: 200, epoch: 28 | loss: 0.3327307
	speed: 0.0410s/iter; left time: 790.6036s
Epoch: 28 cost time: 13.336283445358276
Epoch: 28, Steps: 267 | Train Loss: 0.2292621 Vali Loss: 0.1231155 Test Loss: 0.1729186
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2229007
	speed: 0.1332s/iter; left time: 2546.5283s
	iters: 200, epoch: 29 | loss: 0.2408767
	speed: 0.0532s/iter; left time: 1011.8055s
Epoch: 29 cost time: 11.736247301101685
Epoch: 29, Steps: 267 | Train Loss: 0.2289997 Vali Loss: 0.1231297 Test Loss: 0.1728703
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2056212
	speed: 0.1457s/iter; left time: 2747.8895s
	iters: 200, epoch: 30 | loss: 0.3687730
	speed: 0.0398s/iter; left time: 747.0777s
Epoch: 30 cost time: 11.012712717056274
Epoch: 30, Steps: 267 | Train Loss: 0.2291520 Vali Loss: 0.1231631 Test Loss: 0.1729271
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1991307
	speed: 0.1627s/iter; left time: 3024.6146s
	iters: 200, epoch: 31 | loss: 0.2245611
	speed: 0.0421s/iter; left time: 778.4753s
Epoch: 31 cost time: 11.661390781402588
Epoch: 31, Steps: 267 | Train Loss: 0.2290734 Vali Loss: 0.1230964 Test Loss: 0.1728843
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2123132
	speed: 0.1348s/iter; left time: 2469.7630s
	iters: 200, epoch: 32 | loss: 0.1837086
	speed: 0.0204s/iter; left time: 372.6168s
Epoch: 32 cost time: 7.460484981536865
Epoch: 32, Steps: 267 | Train Loss: 0.2288438 Vali Loss: 0.1231362 Test Loss: 0.1728816
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1890371
	speed: 0.1961s/iter; left time: 3541.2659s
	iters: 200, epoch: 33 | loss: 0.2489176
	speed: 0.0362s/iter; left time: 649.1801s
Epoch: 33 cost time: 12.598438262939453
Epoch: 33, Steps: 267 | Train Loss: 0.2290217 Vali Loss: 0.1231975 Test Loss: 0.1728901
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2338501
	speed: 0.1871s/iter; left time: 3327.8398s
	iters: 200, epoch: 34 | loss: 0.1377539
	speed: 0.0319s/iter; left time: 563.6584s
Epoch: 34 cost time: 8.422995328903198
Epoch: 34, Steps: 267 | Train Loss: 0.2289179 Vali Loss: 0.1230792 Test Loss: 0.1728836
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2588111
	speed: 0.1318s/iter; left time: 2310.0437s
	iters: 200, epoch: 35 | loss: 0.3993008
	speed: 0.0308s/iter; left time: 536.2005s
Epoch: 35 cost time: 9.165823698043823
Epoch: 35, Steps: 267 | Train Loss: 0.2285957 Vali Loss: 0.1231249 Test Loss: 0.1729060
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2664285
	speed: 0.1958s/iter; left time: 3379.4470s
	iters: 200, epoch: 36 | loss: 0.1310078
	speed: 0.0507s/iter; left time: 869.9082s
Epoch: 36 cost time: 12.532345533370972
Epoch: 36, Steps: 267 | Train Loss: 0.2283459 Vali Loss: 0.1230849 Test Loss: 0.1728289
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2569639
	speed: 0.1906s/iter; left time: 3237.8416s
	iters: 200, epoch: 37 | loss: 0.2638565
	speed: 0.0663s/iter; left time: 1119.6972s
Epoch: 37 cost time: 14.659617900848389
Epoch: 37, Steps: 267 | Train Loss: 0.2285691 Vali Loss: 0.1231185 Test Loss: 0.1728339
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1893565
	speed: 0.1651s/iter; left time: 2761.4626s
	iters: 200, epoch: 38 | loss: 0.2056567
	speed: 0.0383s/iter; left time: 636.0281s
Epoch: 38 cost time: 11.463124990463257
Epoch: 38, Steps: 267 | Train Loss: 0.2290187 Vali Loss: 0.1230582 Test Loss: 0.1728194
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1739508956670761, mae:0.2594658434391022, rse:0.3381500840187073, corr:[0.5701433  0.572841   0.56717104 0.5646166  0.56534815 0.56550384
 0.5637982  0.5618415  0.56111187 0.56115025 0.56082314 0.5599637
 0.5592835  0.55922174 0.5593118  0.55882686 0.5576941  0.55651313
 0.55586666 0.55562586 0.55527616 0.5545804  0.55383474 0.55343413
 0.5533248  0.5531489  0.5526974  0.5520182  0.55135477 0.5508701
 0.5505194  0.55016583 0.54964286 0.5490019  0.54838836 0.54790986
 0.5474169  0.5468449  0.5461448  0.5453932  0.54475534 0.54428345
 0.5439231  0.54357755 0.5432039  0.54281974 0.54232854 0.5416326
 0.5407108  0.53974277 0.5389366  0.5383822  0.53788614 0.53724897
 0.5365444  0.5359513  0.5354129  0.53499085 0.5346137  0.5342929
 0.5339572  0.53374386 0.5336164  0.5333995  0.5330992  0.53286403
 0.5326875  0.53257865 0.53248715 0.5324081  0.53229123 0.53215295
 0.5320275  0.5318001  0.53157735 0.53127825 0.53094417 0.53056073
 0.53017545 0.52979136 0.52935255 0.52883154 0.5282669  0.5276935
 0.5271555  0.5267344  0.52630436 0.5258492  0.525375   0.5249469
 0.52473634 0.5246063  0.52428204 0.5238962  0.5234565  0.52162415]
