Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=122, out_features=178, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  19457536.0
params:  21894.0
Trainable parameters:  21894
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3568774
	speed: 0.0231s/iter; left time: 599.4223s
	iters: 200, epoch: 1 | loss: 0.2740619
	speed: 0.0180s/iter; left time: 466.1443s
Epoch: 1 cost time: 5.230005502700806
Epoch: 1, Steps: 261 | Train Loss: 0.3382220 Vali Loss: 0.2371604 Test Loss: 0.3196177
Validation loss decreased (inf --> 0.237160).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2260374
	speed: 0.0815s/iter; left time: 2096.8714s
	iters: 200, epoch: 2 | loss: 0.2347637
	speed: 0.0179s/iter; left time: 459.8095s
Epoch: 2 cost time: 5.274421691894531
Epoch: 2, Steps: 261 | Train Loss: 0.2186122 Vali Loss: 0.2194319 Test Loss: 0.2980978
Validation loss decreased (0.237160 --> 0.219432).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1868978
	speed: 0.0809s/iter; left time: 2060.5942s
	iters: 200, epoch: 3 | loss: 0.1427472
	speed: 0.0181s/iter; left time: 458.3164s
Epoch: 3 cost time: 5.3317551612854
Epoch: 3, Steps: 261 | Train Loss: 0.1781806 Vali Loss: 0.2113953 Test Loss: 0.2885374
Validation loss decreased (0.219432 --> 0.211395).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1930912
	speed: 0.0850s/iter; left time: 2142.9749s
	iters: 200, epoch: 4 | loss: 0.1316605
	speed: 0.0184s/iter; left time: 461.1952s
Epoch: 4 cost time: 5.41695237159729
Epoch: 4, Steps: 261 | Train Loss: 0.1571769 Vali Loss: 0.2058575 Test Loss: 0.2822119
Validation loss decreased (0.211395 --> 0.205858).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1459786
	speed: 0.0838s/iter; left time: 2091.6725s
	iters: 200, epoch: 5 | loss: 0.1262241
	speed: 0.0183s/iter; left time: 456.0663s
Epoch: 5 cost time: 5.479383945465088
Epoch: 5, Steps: 261 | Train Loss: 0.1451889 Vali Loss: 0.2025849 Test Loss: 0.2781757
Validation loss decreased (0.205858 --> 0.202585).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1379473
	speed: 0.0839s/iter; left time: 2071.3555s
	iters: 200, epoch: 6 | loss: 0.1268583
	speed: 0.0181s/iter; left time: 445.3389s
Epoch: 6 cost time: 5.376374959945679
Epoch: 6, Steps: 261 | Train Loss: 0.1388035 Vali Loss: 0.2003751 Test Loss: 0.2757414
Validation loss decreased (0.202585 --> 0.200375).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1611965
	speed: 0.0852s/iter; left time: 2082.1234s
	iters: 200, epoch: 7 | loss: 0.1633504
	speed: 0.0181s/iter; left time: 441.5153s
Epoch: 7 cost time: 5.477950811386108
Epoch: 7, Steps: 261 | Train Loss: 0.1347615 Vali Loss: 0.1986067 Test Loss: 0.2738999
Validation loss decreased (0.200375 --> 0.198607).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1160290
	speed: 0.0818s/iter; left time: 1976.7884s
	iters: 200, epoch: 8 | loss: 0.1294101
	speed: 0.0180s/iter; left time: 433.8409s
Epoch: 8 cost time: 5.271195650100708
Epoch: 8, Steps: 261 | Train Loss: 0.1326540 Vali Loss: 0.1975563 Test Loss: 0.2729532
Validation loss decreased (0.198607 --> 0.197556).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1199094
	speed: 0.0814s/iter; left time: 1945.5828s
	iters: 200, epoch: 9 | loss: 0.1036603
	speed: 0.0182s/iter; left time: 433.9589s
Epoch: 9 cost time: 5.201548337936401
Epoch: 9, Steps: 261 | Train Loss: 0.1312273 Vali Loss: 0.1972483 Test Loss: 0.2725968
Validation loss decreased (0.197556 --> 0.197248).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1712206
	speed: 0.0820s/iter; left time: 1939.3144s
	iters: 200, epoch: 10 | loss: 0.1378577
	speed: 0.0185s/iter; left time: 434.9836s
Epoch: 10 cost time: 5.4833080768585205
Epoch: 10, Steps: 261 | Train Loss: 0.1304615 Vali Loss: 0.1965967 Test Loss: 0.2723349
Validation loss decreased (0.197248 --> 0.196597).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1162557
	speed: 0.0826s/iter; left time: 1931.1011s
	iters: 200, epoch: 11 | loss: 0.1395755
	speed: 0.0188s/iter; left time: 437.0227s
Epoch: 11 cost time: 5.5156238079071045
Epoch: 11, Steps: 261 | Train Loss: 0.1298969 Vali Loss: 0.1964859 Test Loss: 0.2721113
Validation loss decreased (0.196597 --> 0.196486).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1965001
	speed: 0.0856s/iter; left time: 1980.9069s
	iters: 200, epoch: 12 | loss: 0.1229623
	speed: 0.0176s/iter; left time: 405.1126s
Epoch: 12 cost time: 5.427106142044067
Epoch: 12, Steps: 261 | Train Loss: 0.1297792 Vali Loss: 0.1964167 Test Loss: 0.2720444
Validation loss decreased (0.196486 --> 0.196417).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1089977
	speed: 0.0824s/iter; left time: 1884.3438s
	iters: 200, epoch: 13 | loss: 0.1234976
	speed: 0.0185s/iter; left time: 421.7522s
Epoch: 13 cost time: 5.467810153961182
Epoch: 13, Steps: 261 | Train Loss: 0.1295830 Vali Loss: 0.1962423 Test Loss: 0.2719061
Validation loss decreased (0.196417 --> 0.196242).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1755645
	speed: 0.0831s/iter; left time: 1878.2845s
	iters: 200, epoch: 14 | loss: 0.0978020
	speed: 0.0181s/iter; left time: 406.9415s
Epoch: 14 cost time: 5.2978196144104
Epoch: 14, Steps: 261 | Train Loss: 0.1295520 Vali Loss: 0.1960533 Test Loss: 0.2719324
Validation loss decreased (0.196242 --> 0.196053).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1133220
	speed: 0.0858s/iter; left time: 1917.3747s
	iters: 200, epoch: 15 | loss: 0.1536789
	speed: 0.0179s/iter; left time: 397.1664s
Epoch: 15 cost time: 5.383073329925537
Epoch: 15, Steps: 261 | Train Loss: 0.1294060 Vali Loss: 0.1960675 Test Loss: 0.2720185
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1465830
	speed: 0.0814s/iter; left time: 1798.6971s
	iters: 200, epoch: 16 | loss: 0.1236256
	speed: 0.0180s/iter; left time: 396.1478s
Epoch: 16 cost time: 5.2882444858551025
Epoch: 16, Steps: 261 | Train Loss: 0.1293635 Vali Loss: 0.1958403 Test Loss: 0.2718300
Validation loss decreased (0.196053 --> 0.195840).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1456897
	speed: 0.0821s/iter; left time: 1790.9640s
	iters: 200, epoch: 17 | loss: 0.1278218
	speed: 0.0177s/iter; left time: 385.0161s
Epoch: 17 cost time: 5.2198708057403564
Epoch: 17, Steps: 261 | Train Loss: 0.1291435 Vali Loss: 0.1960696 Test Loss: 0.2719240
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1348030
	speed: 0.0813s/iter; left time: 1752.4931s
	iters: 200, epoch: 18 | loss: 0.1319388
	speed: 0.0177s/iter; left time: 379.9793s
Epoch: 18 cost time: 5.32313084602356
Epoch: 18, Steps: 261 | Train Loss: 0.1293576 Vali Loss: 0.1959042 Test Loss: 0.2718579
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1621279
	speed: 0.0833s/iter; left time: 1773.6796s
	iters: 200, epoch: 19 | loss: 0.1277046
	speed: 0.0186s/iter; left time: 394.1301s
Epoch: 19 cost time: 5.547750473022461
Epoch: 19, Steps: 261 | Train Loss: 0.1293050 Vali Loss: 0.1959016 Test Loss: 0.2718974
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1023527
	speed: 0.0847s/iter; left time: 1781.7209s
	iters: 200, epoch: 20 | loss: 0.1394131
	speed: 0.0188s/iter; left time: 394.4426s
Epoch: 20 cost time: 5.490121364593506
Epoch: 20, Steps: 261 | Train Loss: 0.1293550 Vali Loss: 0.1961215 Test Loss: 0.2719318
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1635707
	speed: 0.0836s/iter; left time: 1737.5299s
	iters: 200, epoch: 21 | loss: 0.0973291
	speed: 0.0180s/iter; left time: 373.2031s
Epoch: 21 cost time: 5.436838865280151
Epoch: 21, Steps: 261 | Train Loss: 0.1293861 Vali Loss: 0.1959352 Test Loss: 0.2719040
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1021142
	speed: 0.0871s/iter; left time: 1787.2638s
	iters: 200, epoch: 22 | loss: 0.1249964
	speed: 0.0192s/iter; left time: 392.1835s
Epoch: 22 cost time: 5.73082971572876
Epoch: 22, Steps: 261 | Train Loss: 0.1292111 Vali Loss: 0.1961026 Test Loss: 0.2720237
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1009538
	speed: 0.0868s/iter; left time: 1759.0028s
	iters: 200, epoch: 23 | loss: 0.1050089
	speed: 0.0207s/iter; left time: 417.5604s
Epoch: 23 cost time: 6.309270620346069
Epoch: 23, Steps: 261 | Train Loss: 0.1292407 Vali Loss: 0.1958112 Test Loss: 0.2717417
Validation loss decreased (0.195840 --> 0.195811).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1129526
	speed: 0.0860s/iter; left time: 1719.5749s
	iters: 200, epoch: 24 | loss: 0.1357936
	speed: 0.0191s/iter; left time: 380.1886s
Epoch: 24 cost time: 5.684818983078003
Epoch: 24, Steps: 261 | Train Loss: 0.1293557 Vali Loss: 0.1960445 Test Loss: 0.2717987
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1447472
	speed: 0.0845s/iter; left time: 1667.5574s
	iters: 200, epoch: 25 | loss: 0.1140867
	speed: 0.0202s/iter; left time: 396.4297s
Epoch: 25 cost time: 5.752316474914551
Epoch: 25, Steps: 261 | Train Loss: 0.1293192 Vali Loss: 0.1959466 Test Loss: 0.2718261
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1120269
	speed: 0.0829s/iter; left time: 1613.6555s
	iters: 200, epoch: 26 | loss: 0.0862583
	speed: 0.0184s/iter; left time: 356.3630s
Epoch: 26 cost time: 5.417850971221924
Epoch: 26, Steps: 261 | Train Loss: 0.1291016 Vali Loss: 0.1959898 Test Loss: 0.2718495
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1186667
	speed: 0.0835s/iter; left time: 1604.5857s
	iters: 200, epoch: 27 | loss: 0.1434539
	speed: 0.0195s/iter; left time: 373.0145s
Epoch: 27 cost time: 5.488823175430298
Epoch: 27, Steps: 261 | Train Loss: 0.1292477 Vali Loss: 0.1959690 Test Loss: 0.2718331
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1206728
	speed: 0.0838s/iter; left time: 1589.1766s
	iters: 200, epoch: 28 | loss: 0.1601701
	speed: 0.0224s/iter; left time: 421.8593s
Epoch: 28 cost time: 5.964819431304932
Epoch: 28, Steps: 261 | Train Loss: 0.1292034 Vali Loss: 0.1959492 Test Loss: 0.2718304
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1202272
	speed: 0.0869s/iter; left time: 1623.5832s
	iters: 200, epoch: 29 | loss: 0.1387037
	speed: 0.0197s/iter; left time: 366.7645s
Epoch: 29 cost time: 5.781402587890625
Epoch: 29, Steps: 261 | Train Loss: 0.1291025 Vali Loss: 0.1957562 Test Loss: 0.2717392
Validation loss decreased (0.195811 --> 0.195756).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1439963
	speed: 0.0888s/iter; left time: 1637.4557s
	iters: 200, epoch: 30 | loss: 0.1031861
	speed: 0.0188s/iter; left time: 344.8817s
Epoch: 30 cost time: 5.557276725769043
Epoch: 30, Steps: 261 | Train Loss: 0.1292244 Vali Loss: 0.1961191 Test Loss: 0.2718252
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0870003
	speed: 0.0831s/iter; left time: 1509.7288s
	iters: 200, epoch: 31 | loss: 0.1136052
	speed: 0.0190s/iter; left time: 342.4509s
Epoch: 31 cost time: 5.683506011962891
Epoch: 31, Steps: 261 | Train Loss: 0.1292191 Vali Loss: 0.1960059 Test Loss: 0.2717966
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1924058
	speed: 0.0875s/iter; left time: 1566.6031s
	iters: 200, epoch: 32 | loss: 0.1128102
	speed: 0.0185s/iter; left time: 329.7460s
Epoch: 32 cost time: 5.491848707199097
Epoch: 32, Steps: 261 | Train Loss: 0.1291993 Vali Loss: 0.1959448 Test Loss: 0.2716590
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1213653
	speed: 0.0838s/iter; left time: 1478.5850s
	iters: 200, epoch: 33 | loss: 0.0995103
	speed: 0.0190s/iter; left time: 333.8335s
Epoch: 33 cost time: 5.501199007034302
Epoch: 33, Steps: 261 | Train Loss: 0.1290857 Vali Loss: 0.1959026 Test Loss: 0.2717531
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1411589
	speed: 0.0867s/iter; left time: 1507.4794s
	iters: 200, epoch: 34 | loss: 0.0781530
	speed: 0.0195s/iter; left time: 336.8162s
Epoch: 34 cost time: 5.711770057678223
Epoch: 34, Steps: 261 | Train Loss: 0.1290538 Vali Loss: 0.1959617 Test Loss: 0.2717828
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1108336
	speed: 0.0864s/iter; left time: 1479.9492s
	iters: 200, epoch: 35 | loss: 0.0986537
	speed: 0.0191s/iter; left time: 325.4873s
Epoch: 35 cost time: 5.727782249450684
Epoch: 35, Steps: 261 | Train Loss: 0.1292821 Vali Loss: 0.1959072 Test Loss: 0.2717167
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1707366
	speed: 0.0896s/iter; left time: 1511.9320s
	iters: 200, epoch: 36 | loss: 0.1251995
	speed: 0.0195s/iter; left time: 327.6317s
Epoch: 36 cost time: 5.7692766189575195
Epoch: 36, Steps: 261 | Train Loss: 0.1291437 Vali Loss: 0.1959988 Test Loss: 0.2716889
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1222056
	speed: 0.0844s/iter; left time: 1401.8977s
	iters: 200, epoch: 37 | loss: 0.1826382
	speed: 0.0189s/iter; left time: 311.7137s
Epoch: 37 cost time: 5.99195671081543
Epoch: 37, Steps: 261 | Train Loss: 0.1291384 Vali Loss: 0.1959879 Test Loss: 0.2716669
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1603243
	speed: 0.0937s/iter; left time: 1531.6662s
	iters: 200, epoch: 38 | loss: 0.0975108
	speed: 0.0197s/iter; left time: 319.8750s
Epoch: 38 cost time: 5.461190938949585
Epoch: 38, Steps: 261 | Train Loss: 0.1291023 Vali Loss: 0.1957874 Test Loss: 0.2717372
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1654713
	speed: 0.0812s/iter; left time: 1306.4908s
	iters: 200, epoch: 39 | loss: 0.1138533
	speed: 0.0193s/iter; left time: 308.6263s
Epoch: 39 cost time: 5.7718260288238525
Epoch: 39, Steps: 261 | Train Loss: 0.1291366 Vali Loss: 0.1958525 Test Loss: 0.2717088
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1407708
	speed: 0.0853s/iter; left time: 1348.8850s
	iters: 200, epoch: 40 | loss: 0.1058407
	speed: 0.0185s/iter; left time: 291.1257s
Epoch: 40 cost time: 5.697519302368164
Epoch: 40, Steps: 261 | Train Loss: 0.1292663 Vali Loss: 0.1959542 Test Loss: 0.2717159
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1233089
	speed: 0.0829s/iter; left time: 1289.6360s
	iters: 200, epoch: 41 | loss: 0.1153091
	speed: 0.0219s/iter; left time: 339.2354s
Epoch: 41 cost time: 5.928070306777954
Epoch: 41, Steps: 261 | Train Loss: 0.1291186 Vali Loss: 0.1957960 Test Loss: 0.2717128
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1831173
	speed: 0.0855s/iter; left time: 1307.5890s
	iters: 200, epoch: 42 | loss: 0.1459582
	speed: 0.0194s/iter; left time: 295.4475s
Epoch: 42 cost time: 5.506508827209473
Epoch: 42, Steps: 261 | Train Loss: 0.1291425 Vali Loss: 0.1959531 Test Loss: 0.2717123
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1703959
	speed: 0.0876s/iter; left time: 1317.9468s
	iters: 200, epoch: 43 | loss: 0.1103523
	speed: 0.0188s/iter; left time: 280.5295s
Epoch: 43 cost time: 5.749028205871582
Epoch: 43, Steps: 261 | Train Loss: 0.1292362 Vali Loss: 0.1960050 Test Loss: 0.2717136
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1214429
	speed: 0.0865s/iter; left time: 1278.5006s
	iters: 200, epoch: 44 | loss: 0.0935064
	speed: 0.0194s/iter; left time: 284.2487s
Epoch: 44 cost time: 5.812650918960571
Epoch: 44, Steps: 261 | Train Loss: 0.1290158 Vali Loss: 0.1959086 Test Loss: 0.2716953
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1032636
	speed: 0.0888s/iter; left time: 1289.2977s
	iters: 200, epoch: 45 | loss: 0.1410739
	speed: 0.0207s/iter; left time: 298.3300s
Epoch: 45 cost time: 5.862025499343872
Epoch: 45, Steps: 261 | Train Loss: 0.1290561 Vali Loss: 0.1959196 Test Loss: 0.2716943
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1377121
	speed: 0.0871s/iter; left time: 1242.1411s
	iters: 200, epoch: 46 | loss: 0.1509307
	speed: 0.0189s/iter; left time: 267.1232s
Epoch: 46 cost time: 5.519258260726929
Epoch: 46, Steps: 261 | Train Loss: 0.1292160 Vali Loss: 0.1959421 Test Loss: 0.2717041
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1365798
	speed: 0.0834s/iter; left time: 1167.3101s
	iters: 200, epoch: 47 | loss: 0.1630712
	speed: 0.0185s/iter; left time: 257.3094s
Epoch: 47 cost time: 5.447114944458008
Epoch: 47, Steps: 261 | Train Loss: 0.1292047 Vali Loss: 0.1959072 Test Loss: 0.2716957
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1098899
	speed: 0.0830s/iter; left time: 1139.3636s
	iters: 200, epoch: 48 | loss: 0.1336301
	speed: 0.0191s/iter; left time: 260.3723s
Epoch: 48 cost time: 5.639349460601807
Epoch: 48, Steps: 261 | Train Loss: 0.1292238 Vali Loss: 0.1959285 Test Loss: 0.2716926
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1585547
	speed: 0.0887s/iter; left time: 1195.0739s
	iters: 200, epoch: 49 | loss: 0.1176719
	speed: 0.0189s/iter; left time: 253.1429s
Epoch: 49 cost time: 5.644383907318115
Epoch: 49, Steps: 261 | Train Loss: 0.1291978 Vali Loss: 0.1956933 Test Loss: 0.2717029
Validation loss decreased (0.195756 --> 0.195693).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1122145
	speed: 0.0882s/iter; left time: 1165.1494s
	iters: 200, epoch: 50 | loss: 0.1168772
	speed: 0.0185s/iter; left time: 243.1672s
Epoch: 50 cost time: 5.660700798034668
Epoch: 50, Steps: 261 | Train Loss: 0.1290478 Vali Loss: 0.1958996 Test Loss: 0.2716772
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1198632
	speed: 0.0884s/iter; left time: 1144.3944s
	iters: 200, epoch: 51 | loss: 0.1199348
	speed: 0.0195s/iter; left time: 250.1371s
Epoch: 51 cost time: 5.775029420852661
Epoch: 51, Steps: 261 | Train Loss: 0.1291495 Vali Loss: 0.1960808 Test Loss: 0.2716820
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1381511
	speed: 0.0864s/iter; left time: 1096.3232s
	iters: 200, epoch: 52 | loss: 0.1426603
	speed: 0.0194s/iter; left time: 244.2179s
Epoch: 52 cost time: 5.731123208999634
Epoch: 52, Steps: 261 | Train Loss: 0.1291720 Vali Loss: 0.1959057 Test Loss: 0.2716709
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.0995336
	speed: 0.0871s/iter; left time: 1081.9794s
	iters: 200, epoch: 53 | loss: 0.1262235
	speed: 0.0216s/iter; left time: 266.1007s
Epoch: 53 cost time: 5.9072935581207275
Epoch: 53, Steps: 261 | Train Loss: 0.1290638 Vali Loss: 0.1959734 Test Loss: 0.2716791
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.0996028
	speed: 0.0877s/iter; left time: 1066.6429s
	iters: 200, epoch: 54 | loss: 0.0992571
	speed: 0.0245s/iter; left time: 295.4619s
Epoch: 54 cost time: 6.214138746261597
Epoch: 54, Steps: 261 | Train Loss: 0.1291791 Vali Loss: 0.1957664 Test Loss: 0.2716685
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1416678
	speed: 0.0865s/iter; left time: 1029.8939s
	iters: 200, epoch: 55 | loss: 0.1078403
	speed: 0.0204s/iter; left time: 241.1074s
Epoch: 55 cost time: 5.74396538734436
Epoch: 55, Steps: 261 | Train Loss: 0.1292076 Vali Loss: 0.1955584 Test Loss: 0.2716655
Validation loss decreased (0.195693 --> 0.195558).  Saving model ...
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1251036
	speed: 0.0801s/iter; left time: 933.0358s
	iters: 200, epoch: 56 | loss: 0.1490690
	speed: 0.0257s/iter; left time: 296.9134s
Epoch: 56 cost time: 6.159119367599487
Epoch: 56, Steps: 261 | Train Loss: 0.1291872 Vali Loss: 0.1957624 Test Loss: 0.2716582
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1306528
	speed: 0.0823s/iter; left time: 937.2356s
	iters: 200, epoch: 57 | loss: 0.1091932
	speed: 0.0184s/iter; left time: 207.4692s
Epoch: 57 cost time: 5.597499370574951
Epoch: 57, Steps: 261 | Train Loss: 0.1291726 Vali Loss: 0.1959617 Test Loss: 0.2716697
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1739358
	speed: 0.0842s/iter; left time: 936.2905s
	iters: 200, epoch: 58 | loss: 0.1067462
	speed: 0.0190s/iter; left time: 209.0986s
Epoch: 58 cost time: 5.528229236602783
Epoch: 58, Steps: 261 | Train Loss: 0.1292383 Vali Loss: 0.1958506 Test Loss: 0.2716534
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1154441
	speed: 0.0847s/iter; left time: 920.3833s
	iters: 200, epoch: 59 | loss: 0.0976652
	speed: 0.0220s/iter; left time: 236.3988s
Epoch: 59 cost time: 6.146442651748657
Epoch: 59, Steps: 261 | Train Loss: 0.1291661 Vali Loss: 0.1959451 Test Loss: 0.2716670
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1654333
	speed: 0.0859s/iter; left time: 910.3401s
	iters: 200, epoch: 60 | loss: 0.1830877
	speed: 0.0192s/iter; left time: 201.2596s
Epoch: 60 cost time: 5.475674152374268
Epoch: 60, Steps: 261 | Train Loss: 0.1290083 Vali Loss: 0.1958261 Test Loss: 0.2716709
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1469910
	speed: 0.0816s/iter; left time: 843.5262s
	iters: 200, epoch: 61 | loss: 0.1707969
	speed: 0.0194s/iter; left time: 198.7136s
Epoch: 61 cost time: 5.619317293167114
Epoch: 61, Steps: 261 | Train Loss: 0.1289942 Vali Loss: 0.1957836 Test Loss: 0.2716531
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.0906355
	speed: 0.0820s/iter; left time: 826.4131s
	iters: 200, epoch: 62 | loss: 0.0832266
	speed: 0.0191s/iter; left time: 190.3551s
Epoch: 62 cost time: 5.544151544570923
Epoch: 62, Steps: 261 | Train Loss: 0.1291727 Vali Loss: 0.1959574 Test Loss: 0.2716657
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1249316
	speed: 0.0880s/iter; left time: 864.3836s
	iters: 200, epoch: 63 | loss: 0.1011276
	speed: 0.0188s/iter; left time: 183.1970s
Epoch: 63 cost time: 5.734670639038086
Epoch: 63, Steps: 261 | Train Loss: 0.1291984 Vali Loss: 0.1959167 Test Loss: 0.2716601
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.0942280
	speed: 0.0889s/iter; left time: 849.6438s
	iters: 200, epoch: 64 | loss: 0.1159662
	speed: 0.0182s/iter; left time: 171.9339s
Epoch: 64 cost time: 5.630087375640869
Epoch: 64, Steps: 261 | Train Loss: 0.1291970 Vali Loss: 0.1958646 Test Loss: 0.2716731
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1046767
	speed: 0.0845s/iter; left time: 785.9587s
	iters: 200, epoch: 65 | loss: 0.1582779
	speed: 0.0197s/iter; left time: 180.8345s
Epoch: 65 cost time: 5.5797340869903564
Epoch: 65, Steps: 261 | Train Loss: 0.1290905 Vali Loss: 0.1959796 Test Loss: 0.2716754
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1676509
	speed: 0.0815s/iter; left time: 736.5314s
	iters: 200, epoch: 66 | loss: 0.1265543
	speed: 0.0192s/iter; left time: 171.9708s
Epoch: 66 cost time: 5.528632640838623
Epoch: 66, Steps: 261 | Train Loss: 0.1292385 Vali Loss: 0.1960089 Test Loss: 0.2716702
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1323327
	speed: 0.0849s/iter; left time: 744.8921s
	iters: 200, epoch: 67 | loss: 0.1215387
	speed: 0.0188s/iter; left time: 163.4527s
Epoch: 67 cost time: 5.453392505645752
Epoch: 67, Steps: 261 | Train Loss: 0.1289076 Vali Loss: 0.1958296 Test Loss: 0.2716769
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.0921452
	speed: 0.0838s/iter; left time: 713.8287s
	iters: 200, epoch: 68 | loss: 0.1157723
	speed: 0.0194s/iter; left time: 163.2310s
Epoch: 68 cost time: 5.429049253463745
Epoch: 68, Steps: 261 | Train Loss: 0.1291047 Vali Loss: 0.1958983 Test Loss: 0.2716775
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.0804635
	speed: 0.0827s/iter; left time: 682.6394s
	iters: 200, epoch: 69 | loss: 0.1236622
	speed: 0.0189s/iter; left time: 154.0512s
Epoch: 69 cost time: 5.672971963882446
Epoch: 69, Steps: 261 | Train Loss: 0.1289799 Vali Loss: 0.1957567 Test Loss: 0.2716713
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1093052
	speed: 0.0887s/iter; left time: 708.5939s
	iters: 200, epoch: 70 | loss: 0.1078590
	speed: 0.0192s/iter; left time: 151.7534s
Epoch: 70 cost time: 5.685894727706909
Epoch: 70, Steps: 261 | Train Loss: 0.1290630 Vali Loss: 0.1960068 Test Loss: 0.2716705
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1247707
	speed: 0.0811s/iter; left time: 627.0030s
	iters: 200, epoch: 71 | loss: 0.1334236
	speed: 0.0183s/iter; left time: 139.8306s
Epoch: 71 cost time: 5.873230457305908
Epoch: 71, Steps: 261 | Train Loss: 0.1290579 Vali Loss: 0.1960013 Test Loss: 0.2716686
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1352133
	speed: 0.1020s/iter; left time: 761.6372s
	iters: 200, epoch: 72 | loss: 0.1210845
	speed: 0.0178s/iter; left time: 131.5527s
Epoch: 72 cost time: 6.573902368545532
Epoch: 72, Steps: 261 | Train Loss: 0.1292219 Vali Loss: 0.1958674 Test Loss: 0.2716713
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1513281
	speed: 0.0841s/iter; left time: 606.4384s
	iters: 200, epoch: 73 | loss: 0.1932372
	speed: 0.0194s/iter; left time: 137.8682s
Epoch: 73 cost time: 5.718559265136719
Epoch: 73, Steps: 261 | Train Loss: 0.1291584 Vali Loss: 0.1958340 Test Loss: 0.2716680
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1671799
	speed: 0.0812s/iter; left time: 563.9221s
	iters: 200, epoch: 74 | loss: 0.1426307
	speed: 0.0182s/iter; left time: 124.7007s
Epoch: 74 cost time: 5.46274209022522
Epoch: 74, Steps: 261 | Train Loss: 0.1292042 Vali Loss: 0.1958461 Test Loss: 0.2716680
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.0974830
	speed: 0.0860s/iter; left time: 575.3128s
	iters: 200, epoch: 75 | loss: 0.1279834
	speed: 0.0240s/iter; left time: 157.7976s
Epoch: 75 cost time: 6.058868646621704
Epoch: 75, Steps: 261 | Train Loss: 0.1291794 Vali Loss: 0.1958904 Test Loss: 0.2716718
EarlyStopping counter: 20 out of 20
Early stopping
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=122, out_features=178, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  19457536.0
params:  21894.0
Trainable parameters:  21894
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3696700
	speed: 0.0261s/iter; left time: 677.7074s
	iters: 200, epoch: 1 | loss: 0.2796075
	speed: 0.0181s/iter; left time: 469.2839s
Epoch: 1 cost time: 5.553717613220215
Epoch: 1, Steps: 261 | Train Loss: 0.3786727 Vali Loss: 0.1940933 Test Loss: 0.2697978
Validation loss decreased (inf --> 0.194093).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4238175
	speed: 0.0852s/iter; left time: 2193.1387s
	iters: 200, epoch: 2 | loss: 0.4906523
	speed: 0.0182s/iter; left time: 466.0447s
Epoch: 2 cost time: 5.501120090484619
Epoch: 2, Steps: 261 | Train Loss: 0.3775110 Vali Loss: 0.1932724 Test Loss: 0.2688793
Validation loss decreased (0.194093 --> 0.193272).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3539574
	speed: 0.0854s/iter; left time: 2175.6253s
	iters: 200, epoch: 3 | loss: 0.3869630
	speed: 0.0186s/iter; left time: 473.2226s
Epoch: 3 cost time: 5.66436767578125
Epoch: 3, Steps: 261 | Train Loss: 0.3763568 Vali Loss: 0.1931256 Test Loss: 0.2684396
Validation loss decreased (0.193272 --> 0.193126).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4478516
	speed: 0.0857s/iter; left time: 2161.7972s
	iters: 200, epoch: 4 | loss: 0.3287012
	speed: 0.0217s/iter; left time: 543.8810s
Epoch: 4 cost time: 5.936818361282349
Epoch: 4, Steps: 261 | Train Loss: 0.3754041 Vali Loss: 0.1931615 Test Loss: 0.2682749
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2684048
	speed: 0.0928s/iter; left time: 2316.9684s
	iters: 200, epoch: 5 | loss: 0.4508245
	speed: 0.0193s/iter; left time: 480.5019s
Epoch: 5 cost time: 6.051396369934082
Epoch: 5, Steps: 261 | Train Loss: 0.3749356 Vali Loss: 0.1927063 Test Loss: 0.2680420
Validation loss decreased (0.193126 --> 0.192706).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3752184
	speed: 0.0836s/iter; left time: 2065.7046s
	iters: 200, epoch: 6 | loss: 0.3017335
	speed: 0.0208s/iter; left time: 512.7957s
Epoch: 6 cost time: 5.782941818237305
Epoch: 6, Steps: 261 | Train Loss: 0.3748802 Vali Loss: 0.1928176 Test Loss: 0.2679415
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3048003
	speed: 0.0885s/iter; left time: 2163.4746s
	iters: 200, epoch: 7 | loss: 0.3700847
	speed: 0.0213s/iter; left time: 518.6972s
Epoch: 7 cost time: 6.6531641483306885
Epoch: 7, Steps: 261 | Train Loss: 0.3752893 Vali Loss: 0.1930874 Test Loss: 0.2681460
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4629872
	speed: 0.1283s/iter; left time: 3101.8777s
	iters: 200, epoch: 8 | loss: 0.2452357
	speed: 0.0214s/iter; left time: 515.5411s
Epoch: 8 cost time: 8.088672876358032
Epoch: 8, Steps: 261 | Train Loss: 0.3749422 Vali Loss: 0.1927714 Test Loss: 0.2678616
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4493426
	speed: 0.0964s/iter; left time: 2306.3014s
	iters: 200, epoch: 9 | loss: 0.3456849
	speed: 0.0256s/iter; left time: 610.4867s
Epoch: 9 cost time: 6.938456296920776
Epoch: 9, Steps: 261 | Train Loss: 0.3745178 Vali Loss: 0.1924079 Test Loss: 0.2674475
Validation loss decreased (0.192706 --> 0.192408).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.4118363
	speed: 0.0928s/iter; left time: 2194.2644s
	iters: 200, epoch: 10 | loss: 0.3537994
	speed: 0.0197s/iter; left time: 464.8786s
Epoch: 10 cost time: 6.015525579452515
Epoch: 10, Steps: 261 | Train Loss: 0.3746910 Vali Loss: 0.1923987 Test Loss: 0.2675711
Validation loss decreased (0.192408 --> 0.192399).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2624184
	speed: 0.0879s/iter; left time: 2056.4187s
	iters: 200, epoch: 11 | loss: 0.4340173
	speed: 0.0284s/iter; left time: 661.0060s
Epoch: 11 cost time: 6.6090240478515625
Epoch: 11, Steps: 261 | Train Loss: 0.3742488 Vali Loss: 0.1924912 Test Loss: 0.2676440
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3490017
	speed: 0.0880s/iter; left time: 2035.7179s
	iters: 200, epoch: 12 | loss: 0.2662124
	speed: 0.0195s/iter; left time: 449.4226s
Epoch: 12 cost time: 5.728957176208496
Epoch: 12, Steps: 261 | Train Loss: 0.3739652 Vali Loss: 0.1926428 Test Loss: 0.2677709
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3629510
	speed: 0.0799s/iter; left time: 1827.7552s
	iters: 200, epoch: 13 | loss: 0.2709663
	speed: 0.0232s/iter; left time: 527.5884s
Epoch: 13 cost time: 5.901817083358765
Epoch: 13, Steps: 261 | Train Loss: 0.3742487 Vali Loss: 0.1922512 Test Loss: 0.2673289
Validation loss decreased (0.192399 --> 0.192251).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3643172
	speed: 0.0856s/iter; left time: 1935.7586s
	iters: 200, epoch: 14 | loss: 0.3541538
	speed: 0.0196s/iter; left time: 440.9212s
Epoch: 14 cost time: 5.679407835006714
Epoch: 14, Steps: 261 | Train Loss: 0.3740074 Vali Loss: 0.1922999 Test Loss: 0.2674403
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.4482750
	speed: 0.0859s/iter; left time: 1919.9142s
	iters: 200, epoch: 15 | loss: 0.3434618
	speed: 0.0200s/iter; left time: 443.9139s
Epoch: 15 cost time: 5.8647706508636475
Epoch: 15, Steps: 261 | Train Loss: 0.3735175 Vali Loss: 0.1925750 Test Loss: 0.2675833
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3942835
	speed: 0.0855s/iter; left time: 1889.2987s
	iters: 200, epoch: 16 | loss: 0.4066353
	speed: 0.0200s/iter; left time: 440.7409s
Epoch: 16 cost time: 5.693959951400757
Epoch: 16, Steps: 261 | Train Loss: 0.3740606 Vali Loss: 0.1923118 Test Loss: 0.2674956
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4399582
	speed: 0.0869s/iter; left time: 1897.3565s
	iters: 200, epoch: 17 | loss: 0.5662253
	speed: 0.0198s/iter; left time: 430.8052s
Epoch: 17 cost time: 5.789211273193359
Epoch: 17, Steps: 261 | Train Loss: 0.3733126 Vali Loss: 0.1923713 Test Loss: 0.2674468
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3883513
	speed: 0.0849s/iter; left time: 1830.1014s
	iters: 200, epoch: 18 | loss: 0.3923682
	speed: 0.0202s/iter; left time: 433.2905s
Epoch: 18 cost time: 5.926874160766602
Epoch: 18, Steps: 261 | Train Loss: 0.3733653 Vali Loss: 0.1921216 Test Loss: 0.2671911
Validation loss decreased (0.192251 --> 0.192122).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3770339
	speed: 0.0906s/iter; left time: 1930.5981s
	iters: 200, epoch: 19 | loss: 0.3586884
	speed: 0.0196s/iter; left time: 415.7626s
Epoch: 19 cost time: 5.928472518920898
Epoch: 19, Steps: 261 | Train Loss: 0.3738704 Vali Loss: 0.1924098 Test Loss: 0.2673856
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3793806
	speed: 0.0881s/iter; left time: 1852.7954s
	iters: 200, epoch: 20 | loss: 0.3850985
	speed: 0.0209s/iter; left time: 436.8616s
Epoch: 20 cost time: 5.955204248428345
Epoch: 20, Steps: 261 | Train Loss: 0.3734270 Vali Loss: 0.1923788 Test Loss: 0.2673787
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4233168
	speed: 0.0845s/iter; left time: 1756.0392s
	iters: 200, epoch: 21 | loss: 0.4356324
	speed: 0.0192s/iter; left time: 396.2522s
Epoch: 21 cost time: 5.550863265991211
Epoch: 21, Steps: 261 | Train Loss: 0.3734499 Vali Loss: 0.1922449 Test Loss: 0.2673143
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3480737
	speed: 0.0883s/iter; left time: 1812.6383s
	iters: 200, epoch: 22 | loss: 0.3505395
	speed: 0.0191s/iter; left time: 390.1786s
Epoch: 22 cost time: 5.627070903778076
Epoch: 22, Steps: 261 | Train Loss: 0.3734043 Vali Loss: 0.1922766 Test Loss: 0.2673209
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3199133
	speed: 0.0862s/iter; left time: 1745.7175s
	iters: 200, epoch: 23 | loss: 0.3007898
	speed: 0.0188s/iter; left time: 378.4729s
Epoch: 23 cost time: 5.590474605560303
Epoch: 23, Steps: 261 | Train Loss: 0.3735480 Vali Loss: 0.1923949 Test Loss: 0.2674062
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2875431
	speed: 0.0844s/iter; left time: 1688.2875s
	iters: 200, epoch: 24 | loss: 0.3089395
	speed: 0.0185s/iter; left time: 369.0989s
Epoch: 24 cost time: 5.506106615066528
Epoch: 24, Steps: 261 | Train Loss: 0.3728605 Vali Loss: 0.1922447 Test Loss: 0.2670699
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3234820
	speed: 0.0853s/iter; left time: 1683.5898s
	iters: 200, epoch: 25 | loss: 0.3100356
	speed: 0.0192s/iter; left time: 376.9991s
Epoch: 25 cost time: 5.6519246101379395
Epoch: 25, Steps: 261 | Train Loss: 0.3735026 Vali Loss: 0.1919971 Test Loss: 0.2672088
Validation loss decreased (0.192122 --> 0.191997).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.4487180
	speed: 0.0840s/iter; left time: 1636.8833s
	iters: 200, epoch: 26 | loss: 0.3222309
	speed: 0.0187s/iter; left time: 362.2588s
Epoch: 26 cost time: 5.739522933959961
Epoch: 26, Steps: 261 | Train Loss: 0.3734972 Vali Loss: 0.1922643 Test Loss: 0.2672434
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2487885
	speed: 0.0893s/iter; left time: 1715.4676s
	iters: 200, epoch: 27 | loss: 0.3162329
	speed: 0.0200s/iter; left time: 381.6056s
Epoch: 27 cost time: 5.735679388046265
Epoch: 27, Steps: 261 | Train Loss: 0.3732041 Vali Loss: 0.1922805 Test Loss: 0.2671720
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2898060
	speed: 0.0865s/iter; left time: 1638.9617s
	iters: 200, epoch: 28 | loss: 0.2345265
	speed: 0.0182s/iter; left time: 344.0823s
Epoch: 28 cost time: 5.958476543426514
Epoch: 28, Steps: 261 | Train Loss: 0.3727068 Vali Loss: 0.1917896 Test Loss: 0.2671998
Validation loss decreased (0.191997 --> 0.191790).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3171054
	speed: 0.0920s/iter; left time: 1720.3501s
	iters: 200, epoch: 29 | loss: 0.3525656
	speed: 0.0201s/iter; left time: 373.5172s
Epoch: 29 cost time: 5.805294036865234
Epoch: 29, Steps: 261 | Train Loss: 0.3732578 Vali Loss: 0.1920669 Test Loss: 0.2672408
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4522244
	speed: 0.0891s/iter; left time: 1643.0253s
	iters: 200, epoch: 30 | loss: 0.2888102
	speed: 0.0197s/iter; left time: 361.4804s
Epoch: 30 cost time: 5.687438488006592
Epoch: 30, Steps: 261 | Train Loss: 0.3731381 Vali Loss: 0.1919441 Test Loss: 0.2671279
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.4726049
	speed: 0.0901s/iter; left time: 1637.8175s
	iters: 200, epoch: 31 | loss: 0.3380481
	speed: 0.0190s/iter; left time: 343.6223s
Epoch: 31 cost time: 6.005509376525879
Epoch: 31, Steps: 261 | Train Loss: 0.3729545 Vali Loss: 0.1921696 Test Loss: 0.2672266
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3551185
	speed: 0.0888s/iter; left time: 1590.3774s
	iters: 200, epoch: 32 | loss: 0.4023382
	speed: 0.0212s/iter; left time: 378.2704s
Epoch: 32 cost time: 6.015643358230591
Epoch: 32, Steps: 261 | Train Loss: 0.3731832 Vali Loss: 0.1922492 Test Loss: 0.2672682
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3070824
	speed: 0.0919s/iter; left time: 1622.1958s
	iters: 200, epoch: 33 | loss: 0.5838283
	speed: 0.0204s/iter; left time: 357.3547s
Epoch: 33 cost time: 6.113846778869629
Epoch: 33, Steps: 261 | Train Loss: 0.3731830 Vali Loss: 0.1921344 Test Loss: 0.2672929
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.4260253
	speed: 0.0936s/iter; left time: 1626.6544s
	iters: 200, epoch: 34 | loss: 0.4831190
	speed: 0.0208s/iter; left time: 358.9952s
Epoch: 34 cost time: 6.17500901222229
Epoch: 34, Steps: 261 | Train Loss: 0.3730689 Vali Loss: 0.1922527 Test Loss: 0.2672384
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3615248
	speed: 0.0918s/iter; left time: 1572.3536s
	iters: 200, epoch: 35 | loss: 0.2951092
	speed: 0.0209s/iter; left time: 355.2154s
Epoch: 35 cost time: 6.211709260940552
Epoch: 35, Steps: 261 | Train Loss: 0.3733704 Vali Loss: 0.1920667 Test Loss: 0.2671891
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3656687
	speed: 0.0900s/iter; left time: 1517.2844s
	iters: 200, epoch: 36 | loss: 0.3419672
	speed: 0.0186s/iter; left time: 311.3768s
Epoch: 36 cost time: 5.679224491119385
Epoch: 36, Steps: 261 | Train Loss: 0.3733147 Vali Loss: 0.1922644 Test Loss: 0.2672098
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.4328015
	speed: 0.0882s/iter; left time: 1464.7237s
	iters: 200, epoch: 37 | loss: 0.3067955
	speed: 0.0186s/iter; left time: 306.8677s
Epoch: 37 cost time: 5.663510084152222
Epoch: 37, Steps: 261 | Train Loss: 0.3733859 Vali Loss: 0.1922451 Test Loss: 0.2672182
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3685679
	speed: 0.0873s/iter; left time: 1427.1215s
	iters: 200, epoch: 38 | loss: 0.3385589
	speed: 0.0190s/iter; left time: 309.0067s
Epoch: 38 cost time: 5.58824348449707
Epoch: 38, Steps: 261 | Train Loss: 0.3732428 Vali Loss: 0.1921756 Test Loss: 0.2671739
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.4761135
	speed: 0.0898s/iter; left time: 1444.3648s
	iters: 200, epoch: 39 | loss: 0.3821042
	speed: 0.0203s/iter; left time: 324.7947s
Epoch: 39 cost time: 5.895334005355835
Epoch: 39, Steps: 261 | Train Loss: 0.3728460 Vali Loss: 0.1923311 Test Loss: 0.2672154
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.4249921
	speed: 0.0894s/iter; left time: 1415.1226s
	iters: 200, epoch: 40 | loss: 0.3533146
	speed: 0.0215s/iter; left time: 337.2540s
Epoch: 40 cost time: 5.988995552062988
Epoch: 40, Steps: 261 | Train Loss: 0.3727850 Vali Loss: 0.1922307 Test Loss: 0.2671992
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.4113691
	speed: 0.0904s/iter; left time: 1406.4365s
	iters: 200, epoch: 41 | loss: 0.4356978
	speed: 0.0202s/iter; left time: 312.1367s
Epoch: 41 cost time: 6.067507743835449
Epoch: 41, Steps: 261 | Train Loss: 0.3730836 Vali Loss: 0.1920796 Test Loss: 0.2671977
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2985547
	speed: 0.0867s/iter; left time: 1325.9872s
	iters: 200, epoch: 42 | loss: 0.2224187
	speed: 0.0203s/iter; left time: 308.1800s
Epoch: 42 cost time: 5.9051549434661865
Epoch: 42, Steps: 261 | Train Loss: 0.3730055 Vali Loss: 0.1920988 Test Loss: 0.2672103
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.5119951
	speed: 0.0883s/iter; left time: 1328.2506s
	iters: 200, epoch: 43 | loss: 0.3535455
	speed: 0.0196s/iter; left time: 293.2099s
Epoch: 43 cost time: 5.783306360244751
Epoch: 43, Steps: 261 | Train Loss: 0.3725887 Vali Loss: 0.1920847 Test Loss: 0.2671563
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3444590
	speed: 0.0841s/iter; left time: 1242.5958s
	iters: 200, epoch: 44 | loss: 0.4230887
	speed: 0.0199s/iter; left time: 292.5639s
Epoch: 44 cost time: 5.861204624176025
Epoch: 44, Steps: 261 | Train Loss: 0.3728392 Vali Loss: 0.1920187 Test Loss: 0.2671425
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2981604
	speed: 0.0882s/iter; left time: 1279.9974s
	iters: 200, epoch: 45 | loss: 0.4391625
	speed: 0.0188s/iter; left time: 271.3170s
Epoch: 45 cost time: 5.7268311977386475
Epoch: 45, Steps: 261 | Train Loss: 0.3727876 Vali Loss: 0.1919551 Test Loss: 0.2671556
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3715520
	speed: 0.0855s/iter; left time: 1219.1836s
	iters: 200, epoch: 46 | loss: 0.4800484
	speed: 0.0191s/iter; left time: 270.7061s
Epoch: 46 cost time: 5.616734027862549
Epoch: 46, Steps: 261 | Train Loss: 0.3723174 Vali Loss: 0.1922447 Test Loss: 0.2671024
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3221492
	speed: 0.0883s/iter; left time: 1236.3809s
	iters: 200, epoch: 47 | loss: 0.4756720
	speed: 0.0204s/iter; left time: 284.0067s
Epoch: 47 cost time: 5.959141731262207
Epoch: 47, Steps: 261 | Train Loss: 0.3723578 Vali Loss: 0.1921531 Test Loss: 0.2671575
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3182449
	speed: 0.0884s/iter; left time: 1214.4001s
	iters: 200, epoch: 48 | loss: 0.3295064
	speed: 0.0209s/iter; left time: 285.1050s
Epoch: 48 cost time: 5.8400795459747314
Epoch: 48, Steps: 261 | Train Loss: 0.3726771 Vali Loss: 0.1919807 Test Loss: 0.2671544
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.26821884512901306, mae:0.32595616579055786, rse:0.4183168113231659, corr:[0.5624716  0.5602945  0.5562615  0.5548754  0.55550116 0.55585456
 0.55494225 0.55368745 0.55315304 0.5533985  0.55367804 0.5533927
 0.55276096 0.55229795 0.5522782  0.5523159  0.5519314  0.5510553
 0.5500215  0.54924047 0.5488269  0.5484957  0.5479772  0.5472904
 0.54663837 0.546221   0.54599404 0.54569954 0.54514515 0.5444208
 0.5437593  0.5433826  0.5431491  0.5427694  0.5421559  0.54145044
 0.54078126 0.5402359  0.5397171  0.5391277  0.5384753  0.53783697
 0.5373441  0.5369782  0.5365951  0.53601426 0.5352234  0.534364
 0.5335543  0.5328992  0.5323649  0.5318389  0.53113896 0.53025746
 0.52936107 0.52867734 0.52822775 0.527926   0.5276621  0.5273674
 0.527062   0.52684903 0.5267007  0.5265178  0.5262818  0.52606183
 0.525836   0.5256335  0.52542454 0.5251673  0.52486414 0.52459407
 0.52438164 0.5241947  0.5238868  0.5234466  0.5229065  0.52233505
 0.52176607 0.5212429  0.5206393  0.51999015 0.5193121  0.51865697
 0.51807976 0.5175804  0.51709664 0.5166668  0.51632404 0.51605886
 0.5158267  0.51551884 0.51499856 0.5142965  0.5134661  0.51247144
 0.51126415 0.5098658  0.50826687 0.5066569  0.5053066  0.5043234
 0.5036095  0.50287056 0.50191814 0.5007214  0.49948058 0.49838355
 0.49740922 0.49649116 0.4955964  0.49471068 0.49391833 0.49316016
 0.49232718 0.491455   0.49064106 0.4899047  0.48930228 0.48869574
 0.488052   0.4872534  0.4863981  0.48555967 0.4847764  0.4840156
 0.4832105  0.48223713 0.48108587 0.47993687 0.47902244 0.47840506
 0.4779679  0.4774717  0.4767582  0.4758774  0.47501555 0.4744176
 0.47406405 0.47378623 0.47334707 0.47273356 0.47209653 0.47148857
 0.4709212  0.4702161  0.46942985 0.46854514 0.4676675  0.46684378
 0.46616697 0.4656379  0.4650605  0.4643362  0.4635451  0.46284235
 0.4622479  0.46176532 0.4613534  0.46110073 0.4608984  0.4606704
 0.46029153 0.4598128  0.45934826 0.45903483 0.45882732 0.45865163
 0.45844322 0.45820862 0.45789272 0.45758685 0.4573289  0.45706457
 0.45671204 0.4562505  0.4557511  0.45531413 0.4548807  0.45442542
 0.4536863  0.45261315 0.4515385  0.45079467 0.45049196 0.450452
 0.45034185 0.44992805 0.44911993 0.44804356 0.446953   0.44599098
 0.44513994 0.4443356  0.44325954 0.44182962 0.4402887  0.43881446
 0.43755388 0.43645298 0.4354441  0.43440223 0.43331242 0.43223625
 0.43125618 0.43038258 0.42954022 0.42868233 0.42788363 0.42718914
 0.42640543 0.4255196  0.42462555 0.42375743 0.42292488 0.42196956
 0.4208955  0.4198114  0.41897896 0.41830942 0.41747215 0.4162736
 0.41472837 0.41315228 0.41195807 0.4111233  0.41051024 0.40989098
 0.40896633 0.4078484  0.40670457 0.40577334 0.40506747 0.40453216
 0.40404665 0.40367824 0.40343413 0.40329552 0.40315613 0.4027836
 0.4021085  0.40115443 0.40026522 0.3998468  0.39971033 0.3996471
 0.3994467  0.39908013 0.3985975  0.3981427  0.39803448 0.39820346
 0.39844888 0.39872557 0.3988412  0.39885256 0.39872313 0.3985017
 0.3981559  0.39771262 0.39725393 0.3968954  0.39664793 0.3965374
 0.3964512  0.3962431  0.39601618 0.3958294  0.39565864 0.39542642
 0.39510468 0.3947409  0.39425012 0.3937632  0.39334124 0.39303717
 0.39293072 0.3926948  0.39211157 0.39130396 0.39050177 0.3901135
 0.39027336 0.39083195 0.39139494 0.39150965 0.39094645 0.38965568
 0.38807696 0.38688514 0.3861622  0.38570568 0.38530147 0.38477656
 0.38429022 0.38383797 0.3833302  0.3827362  0.3821827  0.38151622
 0.38089746 0.3802744  0.3797711  0.37926105 0.3788294  0.3785119
 0.37832955 0.37807363 0.37784624 0.37775972 0.37778234 0.3779476
 0.3778403  0.37747854 0.3769876  0.37662327 0.37658507 0.3767707
 0.3767691  0.37650734 0.37619662 0.37609214 0.37618294 0.3763224
 0.3761798  0.37577125 0.3754568  0.37538084 0.37551296 0.37525573
 0.37439823 0.37316322 0.372358   0.3723048  0.37100253 0.36364788]
