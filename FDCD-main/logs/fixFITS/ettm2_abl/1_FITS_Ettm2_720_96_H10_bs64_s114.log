Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  8225280.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4092803
	speed: 0.0342s/iter; left time: 895.9017s
	iters: 200, epoch: 1 | loss: 0.2027498
	speed: 0.0180s/iter; left time: 469.0935s
Epoch: 1 cost time: 6.309031963348389
Epoch: 1, Steps: 263 | Train Loss: 0.3039528 Vali Loss: 0.1304194 Test Loss: 0.1808510
Validation loss decreased (inf --> 0.130419).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3049994
	speed: 0.0927s/iter; left time: 2404.3194s
	iters: 200, epoch: 2 | loss: 0.2325357
	speed: 0.0208s/iter; left time: 537.2785s
Epoch: 2 cost time: 6.079201936721802
Epoch: 2, Steps: 263 | Train Loss: 0.2360003 Vali Loss: 0.1218738 Test Loss: 0.1713719
Validation loss decreased (0.130419 --> 0.121874).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2640305
	speed: 0.0944s/iter; left time: 2424.6960s
	iters: 200, epoch: 3 | loss: 0.2923995
	speed: 0.0280s/iter; left time: 715.8554s
Epoch: 3 cost time: 6.636475324630737
Epoch: 3, Steps: 263 | Train Loss: 0.2236869 Vali Loss: 0.1189179 Test Loss: 0.1680036
Validation loss decreased (0.121874 --> 0.118918).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2164309
	speed: 0.0989s/iter; left time: 2512.7173s
	iters: 200, epoch: 4 | loss: 0.2107121
	speed: 0.0270s/iter; left time: 682.3706s
Epoch: 4 cost time: 6.47554087638855
Epoch: 4, Steps: 263 | Train Loss: 0.2185349 Vali Loss: 0.1176447 Test Loss: 0.1664944
Validation loss decreased (0.118918 --> 0.117645).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2140257
	speed: 0.1174s/iter; left time: 2951.7970s
	iters: 200, epoch: 5 | loss: 0.1672977
	speed: 0.0353s/iter; left time: 883.0946s
Epoch: 5 cost time: 9.655943632125854
Epoch: 5, Steps: 263 | Train Loss: 0.2154446 Vali Loss: 0.1169565 Test Loss: 0.1658431
Validation loss decreased (0.117645 --> 0.116956).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1927605
	speed: 0.0849s/iter; left time: 2112.2162s
	iters: 200, epoch: 6 | loss: 0.1867158
	speed: 0.0269s/iter; left time: 666.5607s
Epoch: 6 cost time: 6.100555181503296
Epoch: 6, Steps: 263 | Train Loss: 0.2133363 Vali Loss: 0.1164962 Test Loss: 0.1651866
Validation loss decreased (0.116956 --> 0.116496).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2460884
	speed: 0.0827s/iter; left time: 2035.9765s
	iters: 200, epoch: 7 | loss: 0.1713753
	speed: 0.0253s/iter; left time: 620.1096s
Epoch: 7 cost time: 6.3940205574035645
Epoch: 7, Steps: 263 | Train Loss: 0.2122981 Vali Loss: 0.1161233 Test Loss: 0.1643794
Validation loss decreased (0.116496 --> 0.116123).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1654372
	speed: 0.0907s/iter; left time: 2209.8723s
	iters: 200, epoch: 8 | loss: 0.2063618
	speed: 0.0174s/iter; left time: 422.5970s
Epoch: 8 cost time: 5.581432819366455
Epoch: 8, Steps: 263 | Train Loss: 0.2112895 Vali Loss: 0.1161470 Test Loss: 0.1642151
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1615069
	speed: 0.0990s/iter; left time: 2386.6875s
	iters: 200, epoch: 9 | loss: 0.2559523
	speed: 0.0190s/iter; left time: 456.8814s
Epoch: 9 cost time: 6.593829870223999
Epoch: 9, Steps: 263 | Train Loss: 0.2106175 Vali Loss: 0.1158414 Test Loss: 0.1638268
Validation loss decreased (0.116123 --> 0.115841).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2008460
	speed: 0.0952s/iter; left time: 2269.4362s
	iters: 200, epoch: 10 | loss: 0.2046283
	speed: 0.0195s/iter; left time: 462.7978s
Epoch: 10 cost time: 6.262274980545044
Epoch: 10, Steps: 263 | Train Loss: 0.2100117 Vali Loss: 0.1157332 Test Loss: 0.1637038
Validation loss decreased (0.115841 --> 0.115733).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2057712
	speed: 0.0944s/iter; left time: 2224.0867s
	iters: 200, epoch: 11 | loss: 0.1950020
	speed: 0.0245s/iter; left time: 575.5602s
Epoch: 11 cost time: 5.889002799987793
Epoch: 11, Steps: 263 | Train Loss: 0.2095551 Vali Loss: 0.1157446 Test Loss: 0.1637459
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2753107
	speed: 0.0844s/iter; left time: 1966.7285s
	iters: 200, epoch: 12 | loss: 0.1434233
	speed: 0.0232s/iter; left time: 538.0852s
Epoch: 12 cost time: 5.862394332885742
Epoch: 12, Steps: 263 | Train Loss: 0.2093961 Vali Loss: 0.1155816 Test Loss: 0.1636098
Validation loss decreased (0.115733 --> 0.115582).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1910036
	speed: 0.0899s/iter; left time: 2072.2566s
	iters: 200, epoch: 13 | loss: 0.1660490
	speed: 0.0186s/iter; left time: 426.1532s
Epoch: 13 cost time: 5.73561429977417
Epoch: 13, Steps: 263 | Train Loss: 0.2092293 Vali Loss: 0.1158055 Test Loss: 0.1635727
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2074308
	speed: 0.0908s/iter; left time: 2068.4673s
	iters: 200, epoch: 14 | loss: 0.2765465
	speed: 0.0219s/iter; left time: 497.6341s
Epoch: 14 cost time: 6.186607599258423
Epoch: 14, Steps: 263 | Train Loss: 0.2091024 Vali Loss: 0.1157274 Test Loss: 0.1634335
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1793326
	speed: 0.0856s/iter; left time: 1928.1883s
	iters: 200, epoch: 15 | loss: 0.2310134
	speed: 0.0249s/iter; left time: 557.7484s
Epoch: 15 cost time: 5.923482179641724
Epoch: 15, Steps: 263 | Train Loss: 0.2084840 Vali Loss: 0.1155691 Test Loss: 0.1634544
Validation loss decreased (0.115582 --> 0.115569).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2733103
	speed: 0.0896s/iter; left time: 1993.5752s
	iters: 200, epoch: 16 | loss: 0.1840952
	speed: 0.0185s/iter; left time: 409.5156s
Epoch: 16 cost time: 6.913087368011475
Epoch: 16, Steps: 263 | Train Loss: 0.2087650 Vali Loss: 0.1154912 Test Loss: 0.1633119
Validation loss decreased (0.115569 --> 0.115491).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3262484
	speed: 0.0990s/iter; left time: 2177.7640s
	iters: 200, epoch: 17 | loss: 0.2167875
	speed: 0.0166s/iter; left time: 362.4340s
Epoch: 17 cost time: 5.26523756980896
Epoch: 17, Steps: 263 | Train Loss: 0.2085812 Vali Loss: 0.1154611 Test Loss: 0.1630657
Validation loss decreased (0.115491 --> 0.115461).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2313135
	speed: 0.1012s/iter; left time: 2198.8621s
	iters: 200, epoch: 18 | loss: 0.1941473
	speed: 0.0208s/iter; left time: 449.3808s
Epoch: 18 cost time: 7.180252313613892
Epoch: 18, Steps: 263 | Train Loss: 0.2083853 Vali Loss: 0.1153908 Test Loss: 0.1632513
Validation loss decreased (0.115461 --> 0.115391).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1638597
	speed: 0.0849s/iter; left time: 1822.3039s
	iters: 200, epoch: 19 | loss: 0.3183887
	speed: 0.0316s/iter; left time: 674.7786s
Epoch: 19 cost time: 6.523660182952881
Epoch: 19, Steps: 263 | Train Loss: 0.2081820 Vali Loss: 0.1154276 Test Loss: 0.1631088
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1748230
	speed: 0.0995s/iter; left time: 2110.4527s
	iters: 200, epoch: 20 | loss: 0.2100231
	speed: 0.0169s/iter; left time: 357.5889s
Epoch: 20 cost time: 5.9578022956848145
Epoch: 20, Steps: 263 | Train Loss: 0.2082293 Vali Loss: 0.1155628 Test Loss: 0.1631805
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1657835
	speed: 0.0920s/iter; left time: 1926.4228s
	iters: 200, epoch: 21 | loss: 0.2567618
	speed: 0.0170s/iter; left time: 353.5467s
Epoch: 21 cost time: 6.53913688659668
Epoch: 21, Steps: 263 | Train Loss: 0.2082053 Vali Loss: 0.1154151 Test Loss: 0.1631354
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2566229
	speed: 0.0858s/iter; left time: 1774.0745s
	iters: 200, epoch: 22 | loss: 0.1247489
	speed: 0.0224s/iter; left time: 461.7965s
Epoch: 22 cost time: 5.817074775695801
Epoch: 22, Steps: 263 | Train Loss: 0.2081046 Vali Loss: 0.1154406 Test Loss: 0.1631433
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2105570
	speed: 0.0892s/iter; left time: 1820.4190s
	iters: 200, epoch: 23 | loss: 0.2269000
	speed: 0.0245s/iter; left time: 497.4322s
Epoch: 23 cost time: 5.985566854476929
Epoch: 23, Steps: 263 | Train Loss: 0.2079388 Vali Loss: 0.1152173 Test Loss: 0.1630231
Validation loss decreased (0.115391 --> 0.115217).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1538000
	speed: 0.0839s/iter; left time: 1690.0044s
	iters: 200, epoch: 24 | loss: 0.1926997
	speed: 0.0240s/iter; left time: 481.9949s
Epoch: 24 cost time: 5.7644202709198
Epoch: 24, Steps: 263 | Train Loss: 0.2079495 Vali Loss: 0.1152220 Test Loss: 0.1629521
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1578382
	speed: 0.0927s/iter; left time: 1843.4691s
	iters: 200, epoch: 25 | loss: 0.2799068
	speed: 0.0215s/iter; left time: 425.2487s
Epoch: 25 cost time: 6.363792181015015
Epoch: 25, Steps: 263 | Train Loss: 0.2076248 Vali Loss: 0.1153056 Test Loss: 0.1630421
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2273814
	speed: 0.0919s/iter; left time: 1803.4132s
	iters: 200, epoch: 26 | loss: 0.1654348
	speed: 0.0174s/iter; left time: 339.4544s
Epoch: 26 cost time: 6.604600667953491
Epoch: 26, Steps: 263 | Train Loss: 0.2075524 Vali Loss: 0.1153304 Test Loss: 0.1630164
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2527728
	speed: 0.0934s/iter; left time: 1809.0354s
	iters: 200, epoch: 27 | loss: 0.2254277
	speed: 0.0174s/iter; left time: 336.0456s
Epoch: 27 cost time: 5.548583745956421
Epoch: 27, Steps: 263 | Train Loss: 0.2077925 Vali Loss: 0.1153707 Test Loss: 0.1629724
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2037154
	speed: 0.0846s/iter; left time: 1615.7538s
	iters: 200, epoch: 28 | loss: 0.1351444
	speed: 0.0192s/iter; left time: 365.6902s
Epoch: 28 cost time: 6.242416620254517
Epoch: 28, Steps: 263 | Train Loss: 0.2075934 Vali Loss: 0.1153021 Test Loss: 0.1630042
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2062571
	speed: 0.0821s/iter; left time: 1546.0466s
	iters: 200, epoch: 29 | loss: 0.1352817
	speed: 0.0158s/iter; left time: 295.8324s
Epoch: 29 cost time: 5.541727066040039
Epoch: 29, Steps: 263 | Train Loss: 0.2072084 Vali Loss: 0.1154232 Test Loss: 0.1630214
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2068896
	speed: 0.0883s/iter; left time: 1640.2772s
	iters: 200, epoch: 30 | loss: 0.2074347
	speed: 0.0166s/iter; left time: 306.2415s
Epoch: 30 cost time: 5.477076530456543
Epoch: 30, Steps: 263 | Train Loss: 0.2075732 Vali Loss: 0.1152717 Test Loss: 0.1628294
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2257801
	speed: 0.0948s/iter; left time: 1735.9813s
	iters: 200, epoch: 31 | loss: 0.2697509
	speed: 0.0158s/iter; left time: 287.8555s
Epoch: 31 cost time: 5.654487609863281
Epoch: 31, Steps: 263 | Train Loss: 0.2076485 Vali Loss: 0.1152385 Test Loss: 0.1629215
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2172178
	speed: 0.0910s/iter; left time: 1641.7973s
	iters: 200, epoch: 32 | loss: 0.1268743
	speed: 0.0255s/iter; left time: 458.3314s
Epoch: 32 cost time: 6.17981481552124
Epoch: 32, Steps: 263 | Train Loss: 0.2075613 Vali Loss: 0.1153029 Test Loss: 0.1629737
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1950346
	speed: 0.0827s/iter; left time: 1470.4384s
	iters: 200, epoch: 33 | loss: 0.2712800
	speed: 0.0223s/iter; left time: 393.7434s
Epoch: 33 cost time: 6.047705411911011
Epoch: 33, Steps: 263 | Train Loss: 0.2074972 Vali Loss: 0.1152110 Test Loss: 0.1629108
Validation loss decreased (0.115217 --> 0.115211).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2047545
	speed: 0.0887s/iter; left time: 1553.8606s
	iters: 200, epoch: 34 | loss: 0.2049051
	speed: 0.0164s/iter; left time: 286.3450s
Epoch: 34 cost time: 5.52448844909668
Epoch: 34, Steps: 263 | Train Loss: 0.2075469 Vali Loss: 0.1152323 Test Loss: 0.1628484
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2193060
	speed: 0.0872s/iter; left time: 1505.1679s
	iters: 200, epoch: 35 | loss: 0.2039521
	speed: 0.0175s/iter; left time: 300.8713s
Epoch: 35 cost time: 6.79929780960083
Epoch: 35, Steps: 263 | Train Loss: 0.2074859 Vali Loss: 0.1152771 Test Loss: 0.1629136
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1983370
	speed: 0.0901s/iter; left time: 1531.1620s
	iters: 200, epoch: 36 | loss: 0.2617542
	speed: 0.0253s/iter; left time: 428.0042s
Epoch: 36 cost time: 6.038472652435303
Epoch: 36, Steps: 263 | Train Loss: 0.2073768 Vali Loss: 0.1152233 Test Loss: 0.1628557
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2527671
	speed: 0.0811s/iter; left time: 1357.5168s
	iters: 200, epoch: 37 | loss: 0.3903379
	speed: 0.0240s/iter; left time: 399.2191s
Epoch: 37 cost time: 5.823605298995972
Epoch: 37, Steps: 263 | Train Loss: 0.2073012 Vali Loss: 0.1152404 Test Loss: 0.1628593
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1848520
	speed: 0.0923s/iter; left time: 1520.0281s
	iters: 200, epoch: 38 | loss: 0.1815105
	speed: 0.0347s/iter; left time: 568.6045s
Epoch: 38 cost time: 7.574548006057739
Epoch: 38, Steps: 263 | Train Loss: 0.2073495 Vali Loss: 0.1152111 Test Loss: 0.1627992
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1930131
	speed: 0.1086s/iter; left time: 1760.0353s
	iters: 200, epoch: 39 | loss: 0.1793945
	speed: 0.0175s/iter; left time: 281.5742s
Epoch: 39 cost time: 7.166936635971069
Epoch: 39, Steps: 263 | Train Loss: 0.2071920 Vali Loss: 0.1152962 Test Loss: 0.1629209
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1540828
	speed: 0.0949s/iter; left time: 1512.6424s
	iters: 200, epoch: 40 | loss: 0.2240783
	speed: 0.0188s/iter; left time: 297.6410s
Epoch: 40 cost time: 6.331305980682373
Epoch: 40, Steps: 263 | Train Loss: 0.2072344 Vali Loss: 0.1151538 Test Loss: 0.1627962
Validation loss decreased (0.115211 --> 0.115154).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1536916
	speed: 0.0875s/iter; left time: 1372.8529s
	iters: 200, epoch: 41 | loss: 0.1770794
	speed: 0.0198s/iter; left time: 308.4974s
Epoch: 41 cost time: 5.691697359085083
Epoch: 41, Steps: 263 | Train Loss: 0.2071378 Vali Loss: 0.1152468 Test Loss: 0.1627937
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1825811
	speed: 0.0825s/iter; left time: 1271.8252s
	iters: 200, epoch: 42 | loss: 0.2350469
	speed: 0.0238s/iter; left time: 364.5957s
Epoch: 42 cost time: 6.104048728942871
Epoch: 42, Steps: 263 | Train Loss: 0.2070953 Vali Loss: 0.1152066 Test Loss: 0.1627701
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2642391
	speed: 0.0838s/iter; left time: 1269.7885s
	iters: 200, epoch: 43 | loss: 0.1610709
	speed: 0.0247s/iter; left time: 371.1791s
Epoch: 43 cost time: 6.0699005126953125
Epoch: 43, Steps: 263 | Train Loss: 0.2072444 Vali Loss: 0.1152500 Test Loss: 0.1628625
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1600219
	speed: 0.0864s/iter; left time: 1286.1821s
	iters: 200, epoch: 44 | loss: 0.2247501
	speed: 0.0298s/iter; left time: 440.0988s
Epoch: 44 cost time: 6.607150077819824
Epoch: 44, Steps: 263 | Train Loss: 0.2071912 Vali Loss: 0.1152598 Test Loss: 0.1628041
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1877577
	speed: 0.0884s/iter; left time: 1292.9371s
	iters: 200, epoch: 45 | loss: 0.1831966
	speed: 0.0244s/iter; left time: 354.0496s
Epoch: 45 cost time: 6.399511337280273
Epoch: 45, Steps: 263 | Train Loss: 0.2072734 Vali Loss: 0.1151782 Test Loss: 0.1628352
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1657311
	speed: 0.0863s/iter; left time: 1240.4431s
	iters: 200, epoch: 46 | loss: 0.1894630
	speed: 0.0167s/iter; left time: 238.8402s
Epoch: 46 cost time: 5.859982252120972
Epoch: 46, Steps: 263 | Train Loss: 0.2072260 Vali Loss: 0.1152159 Test Loss: 0.1628037
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1922999
	speed: 0.0888s/iter; left time: 1252.9124s
	iters: 200, epoch: 47 | loss: 0.1564366
	speed: 0.0172s/iter; left time: 241.1161s
Epoch: 47 cost time: 5.651508331298828
Epoch: 47, Steps: 263 | Train Loss: 0.2070674 Vali Loss: 0.1152209 Test Loss: 0.1628028
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1935121
	speed: 0.0919s/iter; left time: 1272.0763s
	iters: 200, epoch: 48 | loss: 0.1831286
	speed: 0.0181s/iter; left time: 248.3162s
Epoch: 48 cost time: 6.247265815734863
Epoch: 48, Steps: 263 | Train Loss: 0.2071171 Vali Loss: 0.1151082 Test Loss: 0.1627764
Validation loss decreased (0.115154 --> 0.115108).  Saving model ...
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2325877
	speed: 0.0921s/iter; left time: 1250.7775s
	iters: 200, epoch: 49 | loss: 0.2403269
	speed: 0.0240s/iter; left time: 323.9346s
Epoch: 49 cost time: 6.52796745300293
Epoch: 49, Steps: 263 | Train Loss: 0.2071792 Vali Loss: 0.1152730 Test Loss: 0.1627904
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1787804
	speed: 0.0863s/iter; left time: 1148.8805s
	iters: 200, epoch: 50 | loss: 0.2806340
	speed: 0.0222s/iter; left time: 293.4554s
Epoch: 50 cost time: 6.117413520812988
Epoch: 50, Steps: 263 | Train Loss: 0.2069839 Vali Loss: 0.1151783 Test Loss: 0.1628065
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2131097
	speed: 0.0888s/iter; left time: 1158.7581s
	iters: 200, epoch: 51 | loss: 0.2095613
	speed: 0.0266s/iter; left time: 344.8628s
Epoch: 51 cost time: 6.300682783126831
Epoch: 51, Steps: 263 | Train Loss: 0.2070664 Vali Loss: 0.1152241 Test Loss: 0.1627850
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2122446
	speed: 0.0841s/iter; left time: 1075.4162s
	iters: 200, epoch: 52 | loss: 0.2888212
	speed: 0.0182s/iter; left time: 230.9350s
Epoch: 52 cost time: 5.629951477050781
Epoch: 52, Steps: 263 | Train Loss: 0.2071727 Vali Loss: 0.1152359 Test Loss: 0.1627562
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2208637
	speed: 0.0862s/iter; left time: 1080.1497s
	iters: 200, epoch: 53 | loss: 0.2365843
	speed: 0.0172s/iter; left time: 213.3640s
Epoch: 53 cost time: 5.770208358764648
Epoch: 53, Steps: 263 | Train Loss: 0.2070811 Vali Loss: 0.1151390 Test Loss: 0.1627660
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2384104
	speed: 0.1004s/iter; left time: 1231.1005s
	iters: 200, epoch: 54 | loss: 0.2304361
	speed: 0.0183s/iter; left time: 222.2938s
Epoch: 54 cost time: 6.586298942565918
Epoch: 54, Steps: 263 | Train Loss: 0.2069221 Vali Loss: 0.1152110 Test Loss: 0.1627681
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2161188
	speed: 0.0851s/iter; left time: 1020.8677s
	iters: 200, epoch: 55 | loss: 0.1443794
	speed: 0.0219s/iter; left time: 261.1819s
Epoch: 55 cost time: 5.980631589889526
Epoch: 55, Steps: 263 | Train Loss: 0.2071721 Vali Loss: 0.1152444 Test Loss: 0.1628148
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2172424
	speed: 0.0865s/iter; left time: 1015.1870s
	iters: 200, epoch: 56 | loss: 0.2189991
	speed: 0.0175s/iter; left time: 203.3142s
Epoch: 56 cost time: 5.949007511138916
Epoch: 56, Steps: 263 | Train Loss: 0.2069991 Vali Loss: 0.1152204 Test Loss: 0.1627684
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1730050
	speed: 0.0861s/iter; left time: 987.9969s
	iters: 200, epoch: 57 | loss: 0.1745172
	speed: 0.0220s/iter; left time: 250.3776s
Epoch: 57 cost time: 5.984518527984619
Epoch: 57, Steps: 263 | Train Loss: 0.2070420 Vali Loss: 0.1151928 Test Loss: 0.1627535
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2147605
	speed: 0.0952s/iter; left time: 1067.6537s
	iters: 200, epoch: 58 | loss: 0.2443375
	speed: 0.0194s/iter; left time: 215.7447s
Epoch: 58 cost time: 6.010357618331909
Epoch: 58, Steps: 263 | Train Loss: 0.2069557 Vali Loss: 0.1151711 Test Loss: 0.1627528
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1888009
	speed: 0.0848s/iter; left time: 928.4744s
	iters: 200, epoch: 59 | loss: 0.1567590
	speed: 0.0169s/iter; left time: 183.1359s
Epoch: 59 cost time: 5.851372480392456
Epoch: 59, Steps: 263 | Train Loss: 0.2071528 Vali Loss: 0.1151652 Test Loss: 0.1627743
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1670278
	speed: 0.0977s/iter; left time: 1043.7911s
	iters: 200, epoch: 60 | loss: 0.1768204
	speed: 0.0172s/iter; left time: 181.5325s
Epoch: 60 cost time: 6.264161586761475
Epoch: 60, Steps: 263 | Train Loss: 0.2071288 Vali Loss: 0.1152332 Test Loss: 0.1627555
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1759326
	speed: 0.0962s/iter; left time: 1002.9042s
	iters: 200, epoch: 61 | loss: 0.1424642
	speed: 0.0174s/iter; left time: 179.9098s
Epoch: 61 cost time: 5.882665157318115
Epoch: 61, Steps: 263 | Train Loss: 0.2071275 Vali Loss: 0.1150737 Test Loss: 0.1627605
Validation loss decreased (0.115108 --> 0.115074).  Saving model ...
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2489056
	speed: 0.0884s/iter; left time: 898.4423s
	iters: 200, epoch: 62 | loss: 0.1880769
	speed: 0.0236s/iter; left time: 237.7453s
Epoch: 62 cost time: 6.018479347229004
Epoch: 62, Steps: 263 | Train Loss: 0.2066695 Vali Loss: 0.1150574 Test Loss: 0.1627285
Validation loss decreased (0.115074 --> 0.115057).  Saving model ...
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1593962
	speed: 0.0899s/iter; left time: 889.3974s
	iters: 200, epoch: 63 | loss: 0.1709382
	speed: 0.0180s/iter; left time: 176.2297s
Epoch: 63 cost time: 6.175487518310547
Epoch: 63, Steps: 263 | Train Loss: 0.2067625 Vali Loss: 0.1151270 Test Loss: 0.1627259
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1674804
	speed: 0.0927s/iter; left time: 892.5056s
	iters: 200, epoch: 64 | loss: 0.2061417
	speed: 0.0169s/iter; left time: 161.2240s
Epoch: 64 cost time: 6.2154083251953125
Epoch: 64, Steps: 263 | Train Loss: 0.2067285 Vali Loss: 0.1152111 Test Loss: 0.1627404
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.3006805
	speed: 0.0860s/iter; left time: 805.8712s
	iters: 200, epoch: 65 | loss: 0.1948568
	speed: 0.0216s/iter; left time: 199.9388s
Epoch: 65 cost time: 5.876728057861328
Epoch: 65, Steps: 263 | Train Loss: 0.2069028 Vali Loss: 0.1151764 Test Loss: 0.1627334
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2018315
	speed: 0.0812s/iter; left time: 739.8018s
	iters: 200, epoch: 66 | loss: 0.1624267
	speed: 0.0203s/iter; left time: 183.1343s
Epoch: 66 cost time: 5.3182289600372314
Epoch: 66, Steps: 263 | Train Loss: 0.2070859 Vali Loss: 0.1152529 Test Loss: 0.1627464
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1628603
	speed: 0.0915s/iter; left time: 809.5288s
	iters: 200, epoch: 67 | loss: 0.2035046
	speed: 0.0228s/iter; left time: 198.9038s
Epoch: 67 cost time: 6.347045421600342
Epoch: 67, Steps: 263 | Train Loss: 0.2068381 Vali Loss: 0.1152139 Test Loss: 0.1627333
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1979066
	speed: 0.0847s/iter; left time: 726.8165s
	iters: 200, epoch: 68 | loss: 0.1739746
	speed: 0.0429s/iter; left time: 363.9100s
Epoch: 68 cost time: 8.109965562820435
Epoch: 68, Steps: 263 | Train Loss: 0.2069434 Vali Loss: 0.1151847 Test Loss: 0.1627397
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1757821
	speed: 0.0957s/iter; left time: 796.0911s
	iters: 200, epoch: 69 | loss: 0.2442193
	speed: 0.0172s/iter; left time: 141.4568s
Epoch: 69 cost time: 5.859068870544434
Epoch: 69, Steps: 263 | Train Loss: 0.2067710 Vali Loss: 0.1151551 Test Loss: 0.1627364
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1324956
	speed: 0.0855s/iter; left time: 689.0061s
	iters: 200, epoch: 70 | loss: 0.1914472
	speed: 0.0208s/iter; left time: 165.4574s
Epoch: 70 cost time: 6.1022703647613525
Epoch: 70, Steps: 263 | Train Loss: 0.2070143 Vali Loss: 0.1151700 Test Loss: 0.1627320
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1443893
	speed: 0.0908s/iter; left time: 707.7581s
	iters: 200, epoch: 71 | loss: 0.1465446
	speed: 0.0252s/iter; left time: 193.6748s
Epoch: 71 cost time: 7.132670164108276
Epoch: 71, Steps: 263 | Train Loss: 0.2066257 Vali Loss: 0.1151683 Test Loss: 0.1627256
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1614517
	speed: 0.0897s/iter; left time: 674.9732s
	iters: 200, epoch: 72 | loss: 0.2202617
	speed: 0.0174s/iter; left time: 128.9554s
Epoch: 72 cost time: 5.9883153438568115
Epoch: 72, Steps: 263 | Train Loss: 0.2069853 Vali Loss: 0.1151829 Test Loss: 0.1627307
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1290404
	speed: 0.0924s/iter; left time: 671.5166s
	iters: 200, epoch: 73 | loss: 0.2080401
	speed: 0.0194s/iter; left time: 138.9038s
Epoch: 73 cost time: 6.29398512840271
Epoch: 73, Steps: 263 | Train Loss: 0.2070189 Vali Loss: 0.1151307 Test Loss: 0.1627269
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.2094667
	speed: 0.0977s/iter; left time: 684.2272s
	iters: 200, epoch: 74 | loss: 0.2002498
	speed: 0.0261s/iter; left time: 179.8269s
Epoch: 74 cost time: 6.625633239746094
Epoch: 74, Steps: 263 | Train Loss: 0.2068917 Vali Loss: 0.1151508 Test Loss: 0.1627271
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1771771
	speed: 0.0866s/iter; left time: 583.6727s
	iters: 200, epoch: 75 | loss: 0.2236687
	speed: 0.0213s/iter; left time: 141.1994s
Epoch: 75 cost time: 5.921172618865967
Epoch: 75, Steps: 263 | Train Loss: 0.2067095 Vali Loss: 0.1150932 Test Loss: 0.1627175
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1304329
	speed: 0.0873s/iter; left time: 565.1406s
	iters: 200, epoch: 76 | loss: 0.1991953
	speed: 0.0232s/iter; left time: 147.6417s
Epoch: 76 cost time: 6.394907236099243
Epoch: 76, Steps: 263 | Train Loss: 0.2069409 Vali Loss: 0.1151805 Test Loss: 0.1627169
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2275008
	speed: 0.0953s/iter; left time: 592.3779s
	iters: 200, epoch: 77 | loss: 0.2642750
	speed: 0.0181s/iter; left time: 110.8413s
Epoch: 77 cost time: 6.271509408950806
Epoch: 77, Steps: 263 | Train Loss: 0.2068958 Vali Loss: 0.1150893 Test Loss: 0.1627181
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2470478
	speed: 0.0905s/iter; left time: 538.3394s
	iters: 200, epoch: 78 | loss: 0.2326863
	speed: 0.0209s/iter; left time: 122.1148s
Epoch: 78 cost time: 5.9490227699279785
Epoch: 78, Steps: 263 | Train Loss: 0.2068441 Vali Loss: 0.1152022 Test Loss: 0.1627231
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.2092572
	speed: 0.0847s/iter; left time: 481.6546s
	iters: 200, epoch: 79 | loss: 0.1988178
	speed: 0.0207s/iter; left time: 115.4898s
Epoch: 79 cost time: 5.74498724937439
Epoch: 79, Steps: 263 | Train Loss: 0.2069467 Vali Loss: 0.1152030 Test Loss: 0.1627256
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.2079308
	speed: 0.0807s/iter; left time: 437.7854s
	iters: 200, epoch: 80 | loss: 0.2413261
	speed: 0.0203s/iter; left time: 108.1706s
Epoch: 80 cost time: 6.183326721191406
Epoch: 80, Steps: 263 | Train Loss: 0.2067609 Vali Loss: 0.1151807 Test Loss: 0.1627199
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.2133503
	speed: 0.0909s/iter; left time: 469.0741s
	iters: 200, epoch: 81 | loss: 0.1600675
	speed: 0.0171s/iter; left time: 86.7019s
Epoch: 81 cost time: 5.809083938598633
Epoch: 81, Steps: 263 | Train Loss: 0.2069710 Vali Loss: 0.1151595 Test Loss: 0.1627204
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1603617
	speed: 0.0947s/iter; left time: 463.7169s
	iters: 200, epoch: 82 | loss: 0.1541235
	speed: 0.0155s/iter; left time: 74.3106s
Epoch: 82 cost time: 5.7240636348724365
Epoch: 82, Steps: 263 | Train Loss: 0.2069769 Vali Loss: 0.1151229 Test Loss: 0.1627246
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16317777335643768, mae:0.2542269825935364, rse:0.32751160860061646, corr:[0.56842667 0.5697617  0.5676632  0.5654898  0.5645589  0.5647703
 0.565329   0.56541675 0.56484914 0.5640298  0.5634338  0.56327355
 0.5634934  0.56374806 0.5637461  0.5632648  0.5624829  0.56163836
 0.56091624 0.5603687  0.55995554 0.55949163 0.55891025 0.5582553
 0.55758893 0.5570296  0.55663645 0.55633694 0.5559792  0.55547523
 0.55478287 0.5541065  0.55352914 0.5530078  0.55253696 0.5521233
 0.55165714 0.55106485 0.55030876 0.5494718  0.54867536 0.5480049
 0.54749715 0.54708797 0.5466739  0.54609776 0.54532903 0.5444559
 0.5434891  0.54250085 0.54160583 0.54091436 0.5403221  0.5396593
 0.53882337 0.5379125  0.53701806 0.53628266 0.53582925 0.5356787
 0.5356438  0.53560585 0.53541744 0.5350155  0.53446287 0.53401124
 0.5337192  0.53363264 0.5336569  0.5335922  0.5333102  0.53282017
 0.53224367 0.5317983  0.5315231  0.5313447  0.5310335  0.5304323
 0.5295343  0.528617   0.5278075  0.52734524 0.52710253 0.52675575
 0.5260757  0.5250939  0.5239007  0.52300537 0.52288675 0.52339643
 0.5238703  0.5237406  0.5227347  0.52148503 0.5218906  0.5244066 ]
