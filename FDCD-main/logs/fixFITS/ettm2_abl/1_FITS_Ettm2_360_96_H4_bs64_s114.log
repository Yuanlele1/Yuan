Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=26, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=26, out_features=32, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  745472.0
params:  864.0
Trainable parameters:  864
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2427084
	speed: 0.1135s/iter; left time: 3009.0635s
	iters: 200, epoch: 1 | loss: 0.2417037
	speed: 0.1072s/iter; left time: 2830.1327s
Epoch: 1 cost time: 29.463831901550293
Epoch: 1, Steps: 266 | Train Loss: 0.3227071 Vali Loss: 0.1407966 Test Loss: 0.1971931
Validation loss decreased (inf --> 0.140797).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3437823
	speed: 0.4103s/iter; left time: 10763.1895s
	iters: 200, epoch: 2 | loss: 0.2271446
	speed: 0.0906s/iter; left time: 2366.9193s
Epoch: 2 cost time: 23.90033769607544
Epoch: 2, Steps: 266 | Train Loss: 0.2572194 Vali Loss: 0.1297163 Test Loss: 0.1825250
Validation loss decreased (0.140797 --> 0.129716).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2252555
	speed: 0.3627s/iter; left time: 9419.8209s
	iters: 200, epoch: 3 | loss: 0.3017388
	speed: 0.0760s/iter; left time: 1965.4366s
Epoch: 3 cost time: 20.611066818237305
Epoch: 3, Steps: 266 | Train Loss: 0.2417256 Vali Loss: 0.1255512 Test Loss: 0.1770150
Validation loss decreased (0.129716 --> 0.125551).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2625488
	speed: 0.3166s/iter; left time: 8138.4792s
	iters: 200, epoch: 4 | loss: 0.2006849
	speed: 0.0733s/iter; left time: 1875.8132s
Epoch: 4 cost time: 18.78480362892151
Epoch: 4, Steps: 266 | Train Loss: 0.2341860 Vali Loss: 0.1234377 Test Loss: 0.1739457
Validation loss decreased (0.125551 --> 0.123438).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2017237
	speed: 0.3705s/iter; left time: 9423.5767s
	iters: 200, epoch: 5 | loss: 0.2996985
	speed: 0.0904s/iter; left time: 2290.2133s
Epoch: 5 cost time: 23.797770738601685
Epoch: 5, Steps: 266 | Train Loss: 0.2296662 Vali Loss: 0.1219378 Test Loss: 0.1721360
Validation loss decreased (0.123438 --> 0.121938).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1878670
	speed: 0.3437s/iter; left time: 8652.0327s
	iters: 200, epoch: 6 | loss: 0.2135693
	speed: 0.0898s/iter; left time: 2251.1827s
Epoch: 6 cost time: 21.923176050186157
Epoch: 6, Steps: 266 | Train Loss: 0.2268903 Vali Loss: 0.1211415 Test Loss: 0.1706290
Validation loss decreased (0.121938 --> 0.121141).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2695329
	speed: 0.3681s/iter; left time: 9167.1170s
	iters: 200, epoch: 7 | loss: 0.1955409
	speed: 0.1035s/iter; left time: 2566.8506s
Epoch: 7 cost time: 28.728132247924805
Epoch: 7, Steps: 266 | Train Loss: 0.2245790 Vali Loss: 0.1207679 Test Loss: 0.1695998
Validation loss decreased (0.121141 --> 0.120768).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2796859
	speed: 0.4862s/iter; left time: 11979.5363s
	iters: 200, epoch: 8 | loss: 0.2361175
	speed: 0.1100s/iter; left time: 2700.0364s
Epoch: 8 cost time: 28.46717619895935
Epoch: 8, Steps: 266 | Train Loss: 0.2235020 Vali Loss: 0.1204741 Test Loss: 0.1689725
Validation loss decreased (0.120768 --> 0.120474).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1874829
	speed: 0.4336s/iter; left time: 10567.0826s
	iters: 200, epoch: 9 | loss: 0.2222726
	speed: 0.1245s/iter; left time: 3021.4357s
Epoch: 9 cost time: 29.227622509002686
Epoch: 9, Steps: 266 | Train Loss: 0.2226215 Vali Loss: 0.1202155 Test Loss: 0.1690893
Validation loss decreased (0.120474 --> 0.120215).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1706457
	speed: 0.4287s/iter; left time: 10335.3989s
	iters: 200, epoch: 10 | loss: 0.1964398
	speed: 0.0903s/iter; left time: 2168.2889s
Epoch: 10 cost time: 23.742342948913574
Epoch: 10, Steps: 266 | Train Loss: 0.2215776 Vali Loss: 0.1200568 Test Loss: 0.1683891
Validation loss decreased (0.120215 --> 0.120057).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3043050
	speed: 0.3765s/iter; left time: 8975.8741s
	iters: 200, epoch: 11 | loss: 0.2268331
	speed: 0.0942s/iter; left time: 2235.9274s
Epoch: 11 cost time: 23.935051202774048
Epoch: 11, Steps: 266 | Train Loss: 0.2212727 Vali Loss: 0.1197909 Test Loss: 0.1683377
Validation loss decreased (0.120057 --> 0.119791).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2031373
	speed: 0.3951s/iter; left time: 9313.7677s
	iters: 200, epoch: 12 | loss: 0.1961754
	speed: 0.0781s/iter; left time: 1832.8943s
Epoch: 12 cost time: 21.82106304168701
Epoch: 12, Steps: 266 | Train Loss: 0.2210231 Vali Loss: 0.1198719 Test Loss: 0.1681581
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4026730
	speed: 0.3537s/iter; left time: 8243.8091s
	iters: 200, epoch: 13 | loss: 0.1888754
	speed: 0.0782s/iter; left time: 1814.5048s
Epoch: 13 cost time: 21.303322553634644
Epoch: 13, Steps: 266 | Train Loss: 0.2206988 Vali Loss: 0.1197528 Test Loss: 0.1680328
Validation loss decreased (0.119791 --> 0.119753).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2159544
	speed: 0.3731s/iter; left time: 8596.4761s
	iters: 200, epoch: 14 | loss: 0.1938701
	speed: 0.0866s/iter; left time: 1986.0974s
Epoch: 14 cost time: 24.23640751838684
Epoch: 14, Steps: 266 | Train Loss: 0.2205707 Vali Loss: 0.1198239 Test Loss: 0.1679165
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1764564
	speed: 0.3667s/iter; left time: 8352.6004s
	iters: 200, epoch: 15 | loss: 0.2029763
	speed: 0.0794s/iter; left time: 1801.5161s
Epoch: 15 cost time: 22.384834051132202
Epoch: 15, Steps: 266 | Train Loss: 0.2203052 Vali Loss: 0.1197461 Test Loss: 0.1677916
Validation loss decreased (0.119753 --> 0.119746).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2912934
	speed: 0.3532s/iter; left time: 7949.8394s
	iters: 200, epoch: 16 | loss: 0.1942957
	speed: 0.0802s/iter; left time: 1796.7436s
Epoch: 16 cost time: 21.97136116027832
Epoch: 16, Steps: 266 | Train Loss: 0.2202098 Vali Loss: 0.1195927 Test Loss: 0.1678073
Validation loss decreased (0.119746 --> 0.119593).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2134965
	speed: 0.3912s/iter; left time: 8702.8907s
	iters: 200, epoch: 17 | loss: 0.1718164
	speed: 0.0957s/iter; left time: 2118.4769s
Epoch: 17 cost time: 25.77527379989624
Epoch: 17, Steps: 266 | Train Loss: 0.2199433 Vali Loss: 0.1197759 Test Loss: 0.1675560
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1742230
	speed: 0.3812s/iter; left time: 8379.1194s
	iters: 200, epoch: 18 | loss: 0.2037169
	speed: 0.0857s/iter; left time: 1875.3591s
Epoch: 18 cost time: 23.05465316772461
Epoch: 18, Steps: 266 | Train Loss: 0.2197769 Vali Loss: 0.1196239 Test Loss: 0.1676381
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2553202
	speed: 0.3984s/iter; left time: 8649.4965s
	iters: 200, epoch: 19 | loss: 0.2062553
	speed: 0.1173s/iter; left time: 2536.0820s
Epoch: 19 cost time: 27.516584634780884
Epoch: 19, Steps: 266 | Train Loss: 0.2196000 Vali Loss: 0.1196615 Test Loss: 0.1677322
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3010834
	speed: 0.4035s/iter; left time: 8653.3790s
	iters: 200, epoch: 20 | loss: 0.3007703
	speed: 0.0842s/iter; left time: 1796.4158s
Epoch: 20 cost time: 25.560256004333496
Epoch: 20, Steps: 266 | Train Loss: 0.2197159 Vali Loss: 0.1194902 Test Loss: 0.1676377
Validation loss decreased (0.119593 --> 0.119490).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1898782
	speed: 0.3571s/iter; left time: 7562.9809s
	iters: 200, epoch: 21 | loss: 0.2107529
	speed: 0.0822s/iter; left time: 1731.9535s
Epoch: 21 cost time: 22.108370780944824
Epoch: 21, Steps: 266 | Train Loss: 0.2194715 Vali Loss: 0.1194767 Test Loss: 0.1676019
Validation loss decreased (0.119490 --> 0.119477).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1682944
	speed: 0.3796s/iter; left time: 7940.1352s
	iters: 200, epoch: 22 | loss: 0.3366980
	speed: 0.1065s/iter; left time: 2215.8039s
Epoch: 22 cost time: 27.08760929107666
Epoch: 22, Steps: 266 | Train Loss: 0.2195084 Vali Loss: 0.1195311 Test Loss: 0.1675782
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2820660
	speed: 0.3782s/iter; left time: 7810.2368s
	iters: 200, epoch: 23 | loss: 0.1959779
	speed: 0.0847s/iter; left time: 1740.6584s
Epoch: 23 cost time: 22.22952699661255
Epoch: 23, Steps: 266 | Train Loss: 0.2193658 Vali Loss: 0.1194677 Test Loss: 0.1675277
Validation loss decreased (0.119477 --> 0.119468).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2383992
	speed: 0.3594s/iter; left time: 7325.7525s
	iters: 200, epoch: 24 | loss: 0.2086426
	speed: 0.0802s/iter; left time: 1626.3448s
Epoch: 24 cost time: 22.34139585494995
Epoch: 24, Steps: 266 | Train Loss: 0.2193031 Vali Loss: 0.1195231 Test Loss: 0.1676200
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2720381
	speed: 0.3858s/iter; left time: 7760.8615s
	iters: 200, epoch: 25 | loss: 0.2164347
	speed: 0.0786s/iter; left time: 1573.0769s
Epoch: 25 cost time: 24.03304100036621
Epoch: 25, Steps: 266 | Train Loss: 0.2191781 Vali Loss: 0.1194594 Test Loss: 0.1674960
Validation loss decreased (0.119468 --> 0.119459).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2585212
	speed: 0.3550s/iter; left time: 7046.6359s
	iters: 200, epoch: 26 | loss: 0.1547828
	speed: 0.0760s/iter; left time: 1501.8229s
Epoch: 26 cost time: 21.636964082717896
Epoch: 26, Steps: 266 | Train Loss: 0.2191949 Vali Loss: 0.1194568 Test Loss: 0.1674319
Validation loss decreased (0.119459 --> 0.119457).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2776506
	speed: 0.3557s/iter; left time: 6966.7825s
	iters: 200, epoch: 27 | loss: 0.1917214
	speed: 0.0821s/iter; left time: 1599.7823s
Epoch: 27 cost time: 24.05203914642334
Epoch: 27, Steps: 266 | Train Loss: 0.2192326 Vali Loss: 0.1194380 Test Loss: 0.1673653
Validation loss decreased (0.119457 --> 0.119438).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2101711
	speed: 0.3729s/iter; left time: 7204.8099s
	iters: 200, epoch: 28 | loss: 0.3159392
	speed: 0.0936s/iter; left time: 1798.2979s
Epoch: 28 cost time: 22.88420343399048
Epoch: 28, Steps: 266 | Train Loss: 0.2191551 Vali Loss: 0.1194457 Test Loss: 0.1673648
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2333371
	speed: 0.3642s/iter; left time: 6938.1823s
	iters: 200, epoch: 29 | loss: 0.1762034
	speed: 0.1058s/iter; left time: 2006.0186s
Epoch: 29 cost time: 28.005477905273438
Epoch: 29, Steps: 266 | Train Loss: 0.2191294 Vali Loss: 0.1193583 Test Loss: 0.1673635
Validation loss decreased (0.119438 --> 0.119358).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2476093
	speed: 0.3884s/iter; left time: 7296.6404s
	iters: 200, epoch: 30 | loss: 0.2031156
	speed: 0.0766s/iter; left time: 1430.6658s
Epoch: 30 cost time: 22.295153856277466
Epoch: 30, Steps: 266 | Train Loss: 0.2190676 Vali Loss: 0.1194830 Test Loss: 0.1672773
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1721446
	speed: 0.3680s/iter; left time: 6814.8890s
	iters: 200, epoch: 31 | loss: 0.3048501
	speed: 0.0771s/iter; left time: 1420.1570s
Epoch: 31 cost time: 21.459057569503784
Epoch: 31, Steps: 266 | Train Loss: 0.2191179 Vali Loss: 0.1194266 Test Loss: 0.1672467
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2118311
	speed: 0.3565s/iter; left time: 6508.0326s
	iters: 200, epoch: 32 | loss: 0.1753657
	speed: 0.0785s/iter; left time: 1425.9174s
Epoch: 32 cost time: 21.62252902984619
Epoch: 32, Steps: 266 | Train Loss: 0.2189729 Vali Loss: 0.1194229 Test Loss: 0.1672896
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3910682
	speed: 0.3704s/iter; left time: 6663.5622s
	iters: 200, epoch: 33 | loss: 0.3275836
	speed: 0.0844s/iter; left time: 1510.2512s
Epoch: 33 cost time: 22.583734035491943
Epoch: 33, Steps: 266 | Train Loss: 0.2189575 Vali Loss: 0.1194194 Test Loss: 0.1672862
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2270752
	speed: 0.3765s/iter; left time: 6673.2883s
	iters: 200, epoch: 34 | loss: 0.2306356
	speed: 0.1042s/iter; left time: 1836.3693s
Epoch: 34 cost time: 26.322574615478516
Epoch: 34, Steps: 266 | Train Loss: 0.2190198 Vali Loss: 0.1194045 Test Loss: 0.1672935
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2277513
	speed: 0.3697s/iter; left time: 6453.6777s
	iters: 200, epoch: 35 | loss: 0.1683440
	speed: 0.0759s/iter; left time: 1318.0182s
Epoch: 35 cost time: 21.30661416053772
Epoch: 35, Steps: 266 | Train Loss: 0.2188265 Vali Loss: 0.1194337 Test Loss: 0.1672887
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2016741
	speed: 0.3491s/iter; left time: 6000.7173s
	iters: 200, epoch: 36 | loss: 0.1954538
	speed: 0.0738s/iter; left time: 1261.3437s
Epoch: 36 cost time: 20.447856426239014
Epoch: 36, Steps: 266 | Train Loss: 0.2188841 Vali Loss: 0.1194955 Test Loss: 0.1672725
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2354226
	speed: 0.3314s/iter; left time: 5609.7065s
	iters: 200, epoch: 37 | loss: 0.1846262
	speed: 0.0686s/iter; left time: 1154.5784s
Epoch: 37 cost time: 19.752320528030396
Epoch: 37, Steps: 266 | Train Loss: 0.2189559 Vali Loss: 0.1194504 Test Loss: 0.1672847
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1536468
	speed: 0.3177s/iter; left time: 5292.1105s
	iters: 200, epoch: 38 | loss: 0.1834431
	speed: 0.0711s/iter; left time: 1177.6411s
Epoch: 38 cost time: 18.787763357162476
Epoch: 38, Steps: 266 | Train Loss: 0.2186961 Vali Loss: 0.1194293 Test Loss: 0.1672521
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2347158
	speed: 0.2801s/iter; left time: 4592.4319s
	iters: 200, epoch: 39 | loss: 0.3390555
	speed: 0.0791s/iter; left time: 1288.8279s
Epoch: 39 cost time: 20.625078201293945
Epoch: 39, Steps: 266 | Train Loss: 0.2185765 Vali Loss: 0.1193612 Test Loss: 0.1672788
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2856320
	speed: 0.3413s/iter; left time: 5503.5134s
	iters: 200, epoch: 40 | loss: 0.2147512
	speed: 0.0709s/iter; left time: 1136.0762s
Epoch: 40 cost time: 20.49459171295166
Epoch: 40, Steps: 266 | Train Loss: 0.2188272 Vali Loss: 0.1193755 Test Loss: 0.1672622
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2961606
	speed: 0.3225s/iter; left time: 5114.4837s
	iters: 200, epoch: 41 | loss: 0.2083582
	speed: 0.0714s/iter; left time: 1125.6805s
Epoch: 41 cost time: 20.401952981948853
Epoch: 41, Steps: 266 | Train Loss: 0.2187334 Vali Loss: 0.1193631 Test Loss: 0.1672417
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2899674
	speed: 0.3552s/iter; left time: 5539.5238s
	iters: 200, epoch: 42 | loss: 0.1580440
	speed: 0.0753s/iter; left time: 1166.7597s
Epoch: 42 cost time: 20.886343717575073
Epoch: 42, Steps: 266 | Train Loss: 0.2187942 Vali Loss: 0.1193203 Test Loss: 0.1672145
Validation loss decreased (0.119358 --> 0.119320).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2776834
	speed: 0.3310s/iter; left time: 5073.9978s
	iters: 200, epoch: 43 | loss: 0.2673757
	speed: 0.0825s/iter; left time: 1256.4167s
Epoch: 43 cost time: 21.546194314956665
Epoch: 43, Steps: 266 | Train Loss: 0.2187178 Vali Loss: 0.1193826 Test Loss: 0.1671895
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2402145
	speed: 0.3291s/iter; left time: 4957.3097s
	iters: 200, epoch: 44 | loss: 0.2038815
	speed: 0.0600s/iter; left time: 897.5886s
Epoch: 44 cost time: 18.26342535018921
Epoch: 44, Steps: 266 | Train Loss: 0.2186886 Vali Loss: 0.1194320 Test Loss: 0.1672048
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1916656
	speed: 0.3385s/iter; left time: 5008.6971s
	iters: 200, epoch: 45 | loss: 0.2867640
	speed: 0.0839s/iter; left time: 1233.3014s
Epoch: 45 cost time: 21.612553119659424
Epoch: 45, Steps: 266 | Train Loss: 0.2185830 Vali Loss: 0.1193708 Test Loss: 0.1671793
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2970214
	speed: 0.4372s/iter; left time: 6353.3081s
	iters: 200, epoch: 46 | loss: 0.2088991
	speed: 0.1248s/iter; left time: 1800.7899s
Epoch: 46 cost time: 31.61439061164856
Epoch: 46, Steps: 266 | Train Loss: 0.2186979 Vali Loss: 0.1193299 Test Loss: 0.1671910
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2621109
	speed: 0.4906s/iter; left time: 6998.4741s
	iters: 200, epoch: 47 | loss: 0.1779705
	speed: 0.1233s/iter; left time: 1746.3239s
Epoch: 47 cost time: 32.11420965194702
Epoch: 47, Steps: 266 | Train Loss: 0.2185588 Vali Loss: 0.1193024 Test Loss: 0.1671875
Validation loss decreased (0.119320 --> 0.119302).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2632118
	speed: 0.6104s/iter; left time: 8545.2227s
	iters: 200, epoch: 48 | loss: 0.2266701
	speed: 0.1165s/iter; left time: 1619.3756s
Epoch: 48 cost time: 30.753276109695435
Epoch: 48, Steps: 266 | Train Loss: 0.2186714 Vali Loss: 0.1193025 Test Loss: 0.1671703
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1964423
	speed: 0.5616s/iter; left time: 7711.8830s
	iters: 200, epoch: 49 | loss: 0.2217949
	speed: 0.1188s/iter; left time: 1620.0915s
Epoch: 49 cost time: 31.281481504440308
Epoch: 49, Steps: 266 | Train Loss: 0.2185900 Vali Loss: 0.1193278 Test Loss: 0.1671693
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1820732
	speed: 0.4751s/iter; left time: 6398.3832s
	iters: 200, epoch: 50 | loss: 0.2052431
	speed: 0.1299s/iter; left time: 1736.3392s
Epoch: 50 cost time: 34.121687173843384
Epoch: 50, Steps: 266 | Train Loss: 0.2186273 Vali Loss: 0.1193459 Test Loss: 0.1671676
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2243457
	speed: 0.5184s/iter; left time: 6842.7596s
	iters: 200, epoch: 51 | loss: 0.1325992
	speed: 0.1225s/iter; left time: 1604.8425s
Epoch: 51 cost time: 32.06316161155701
Epoch: 51, Steps: 266 | Train Loss: 0.2185492 Vali Loss: 0.1192986 Test Loss: 0.1671568
Validation loss decreased (0.119302 --> 0.119299).  Saving model ...
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2400714
	speed: 0.5322s/iter; left time: 6883.8993s
	iters: 200, epoch: 52 | loss: 0.2069150
	speed: 0.1268s/iter; left time: 1627.6029s
Epoch: 52 cost time: 34.717068672180176
Epoch: 52, Steps: 266 | Train Loss: 0.2186013 Vali Loss: 0.1193506 Test Loss: 0.1671831
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2555310
	speed: 0.5416s/iter; left time: 6861.1197s
	iters: 200, epoch: 53 | loss: 0.3249666
	speed: 0.0831s/iter; left time: 1043.9752s
Epoch: 53 cost time: 28.006131887435913
Epoch: 53, Steps: 266 | Train Loss: 0.2185077 Vali Loss: 0.1193251 Test Loss: 0.1671460
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2144701
	speed: 0.4569s/iter; left time: 5666.8376s
	iters: 200, epoch: 54 | loss: 0.1532166
	speed: 0.1092s/iter; left time: 1343.5318s
Epoch: 54 cost time: 28.603755474090576
Epoch: 54, Steps: 266 | Train Loss: 0.2184017 Vali Loss: 0.1193018 Test Loss: 0.1671240
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2038553
	speed: 0.4039s/iter; left time: 4902.3311s
	iters: 200, epoch: 55 | loss: 0.2325250
	speed: 0.0955s/iter; left time: 1149.1311s
Epoch: 55 cost time: 25.687439680099487
Epoch: 55, Steps: 266 | Train Loss: 0.2185121 Vali Loss: 0.1193236 Test Loss: 0.1671313
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2339225
	speed: 0.3804s/iter; left time: 4516.0588s
	iters: 200, epoch: 56 | loss: 0.2245246
	speed: 0.0818s/iter; left time: 963.2295s
Epoch: 56 cost time: 24.595616579055786
Epoch: 56, Steps: 266 | Train Loss: 0.2185935 Vali Loss: 0.1193017 Test Loss: 0.1671340
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2235382
	speed: 0.3797s/iter; left time: 4406.7665s
	iters: 200, epoch: 57 | loss: 0.2096844
	speed: 0.0982s/iter; left time: 1129.5687s
Epoch: 57 cost time: 25.498541355133057
Epoch: 57, Steps: 266 | Train Loss: 0.2183400 Vali Loss: 0.1193399 Test Loss: 0.1671248
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1697186
	speed: 0.3522s/iter; left time: 3993.5937s
	iters: 200, epoch: 58 | loss: 0.2090764
	speed: 0.0861s/iter; left time: 967.8165s
Epoch: 58 cost time: 21.180607080459595
Epoch: 58, Steps: 266 | Train Loss: 0.2185336 Vali Loss: 0.1193828 Test Loss: 0.1671163
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2207032
	speed: 0.3621s/iter; left time: 4009.1992s
	iters: 200, epoch: 59 | loss: 0.1753621
	speed: 0.0987s/iter; left time: 1083.4357s
Epoch: 59 cost time: 27.110501766204834
Epoch: 59, Steps: 266 | Train Loss: 0.2184185 Vali Loss: 0.1193335 Test Loss: 0.1671273
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.2981467
	speed: 0.4501s/iter; left time: 4863.9834s
	iters: 200, epoch: 60 | loss: 0.2042162
	speed: 0.0841s/iter; left time: 900.1784s
Epoch: 60 cost time: 24.246609926223755
Epoch: 60, Steps: 266 | Train Loss: 0.2185096 Vali Loss: 0.1193454 Test Loss: 0.1671255
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1797133
	speed: 0.4229s/iter; left time: 4458.2912s
	iters: 200, epoch: 61 | loss: 0.3627859
	speed: 0.0987s/iter; left time: 1030.3595s
Epoch: 61 cost time: 27.151706218719482
Epoch: 61, Steps: 266 | Train Loss: 0.2185252 Vali Loss: 0.1193440 Test Loss: 0.1671273
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1658646
	speed: 0.4198s/iter; left time: 4313.6645s
	iters: 200, epoch: 62 | loss: 0.2562660
	speed: 0.0953s/iter; left time: 969.5364s
Epoch: 62 cost time: 24.71168613433838
Epoch: 62, Steps: 266 | Train Loss: 0.2183981 Vali Loss: 0.1192438 Test Loss: 0.1671197
Validation loss decreased (0.119299 --> 0.119244).  Saving model ...
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2445277
	speed: 0.3692s/iter; left time: 3695.4034s
	iters: 200, epoch: 63 | loss: 0.1569418
	speed: 0.0823s/iter; left time: 815.3029s
Epoch: 63 cost time: 22.674967288970947
Epoch: 63, Steps: 266 | Train Loss: 0.2185417 Vali Loss: 0.1191801 Test Loss: 0.1671113
Validation loss decreased (0.119244 --> 0.119180).  Saving model ...
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1882468
	speed: 0.3785s/iter; left time: 3687.4056s
	iters: 200, epoch: 64 | loss: 0.1400411
	speed: 0.0785s/iter; left time: 756.6826s
Epoch: 64 cost time: 22.86432719230652
Epoch: 64, Steps: 266 | Train Loss: 0.2185687 Vali Loss: 0.1193392 Test Loss: 0.1671188
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1772693
	speed: 0.3262s/iter; left time: 3091.7858s
	iters: 200, epoch: 65 | loss: 0.2096411
	speed: 0.0736s/iter; left time: 690.3380s
Epoch: 65 cost time: 20.167800188064575
Epoch: 65, Steps: 266 | Train Loss: 0.2181428 Vali Loss: 0.1192910 Test Loss: 0.1671102
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2135638
	speed: 0.3848s/iter; left time: 3544.5623s
	iters: 200, epoch: 66 | loss: 0.2700383
	speed: 0.0772s/iter; left time: 702.9302s
Epoch: 66 cost time: 23.55096173286438
Epoch: 66, Steps: 266 | Train Loss: 0.2180685 Vali Loss: 0.1193502 Test Loss: 0.1671048
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1889944
	speed: 0.3825s/iter; left time: 3421.0412s
	iters: 200, epoch: 67 | loss: 0.1545342
	speed: 0.1095s/iter; left time: 968.4604s
Epoch: 67 cost time: 29.103307962417603
Epoch: 67, Steps: 266 | Train Loss: 0.2184467 Vali Loss: 0.1193751 Test Loss: 0.1671060
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2453050
	speed: 0.4725s/iter; left time: 4100.8716s
	iters: 200, epoch: 68 | loss: 0.1833622
	speed: 0.1157s/iter; left time: 992.3625s
Epoch: 68 cost time: 32.81444191932678
Epoch: 68, Steps: 266 | Train Loss: 0.2182738 Vali Loss: 0.1193720 Test Loss: 0.1671018
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2592165
	speed: 0.5366s/iter; left time: 4514.6044s
	iters: 200, epoch: 69 | loss: 0.1658360
	speed: 0.1477s/iter; left time: 1227.9594s
Epoch: 69 cost time: 39.27789831161499
Epoch: 69, Steps: 266 | Train Loss: 0.2183355 Vali Loss: 0.1192153 Test Loss: 0.1671015
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1981802
	speed: 0.5641s/iter; left time: 4595.7219s
	iters: 200, epoch: 70 | loss: 0.2454878
	speed: 0.1240s/iter; left time: 997.4911s
Epoch: 70 cost time: 32.86432766914368
Epoch: 70, Steps: 266 | Train Loss: 0.2185296 Vali Loss: 0.1192534 Test Loss: 0.1670956
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2281870
	speed: 0.6221s/iter; left time: 4902.5580s
	iters: 200, epoch: 71 | loss: 0.3061297
	speed: 0.1031s/iter; left time: 802.4087s
Epoch: 71 cost time: 30.793816089630127
Epoch: 71, Steps: 266 | Train Loss: 0.2184187 Vali Loss: 0.1193529 Test Loss: 0.1671035
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2601687
	speed: 0.5399s/iter; left time: 4111.3809s
	iters: 200, epoch: 72 | loss: 0.2319599
	speed: 0.1258s/iter; left time: 945.6324s
Epoch: 72 cost time: 34.32087230682373
Epoch: 72, Steps: 266 | Train Loss: 0.2183630 Vali Loss: 0.1193219 Test Loss: 0.1671083
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.2470957
	speed: 0.5480s/iter; left time: 4027.1654s
	iters: 200, epoch: 73 | loss: 0.3650927
	speed: 0.1279s/iter; left time: 926.8495s
Epoch: 73 cost time: 36.11904525756836
Epoch: 73, Steps: 266 | Train Loss: 0.2184907 Vali Loss: 0.1193821 Test Loss: 0.1670921
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1516113
	speed: 0.5579s/iter; left time: 3951.6683s
	iters: 200, epoch: 74 | loss: 0.1441858
	speed: 0.1064s/iter; left time: 742.9252s
Epoch: 74 cost time: 30.823631763458252
Epoch: 74, Steps: 266 | Train Loss: 0.2185189 Vali Loss: 0.1193770 Test Loss: 0.1671006
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2172115
	speed: 0.5638s/iter; left time: 3843.4296s
	iters: 200, epoch: 75 | loss: 0.1443360
	speed: 0.1474s/iter; left time: 990.1292s
Epoch: 75 cost time: 38.8293194770813
Epoch: 75, Steps: 266 | Train Loss: 0.2180479 Vali Loss: 0.1192896 Test Loss: 0.1670915
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1592178
	speed: 0.5333s/iter; left time: 3493.7018s
	iters: 200, epoch: 76 | loss: 0.2096008
	speed: 0.1209s/iter; left time: 780.2349s
Epoch: 76 cost time: 33.172900438308716
Epoch: 76, Steps: 266 | Train Loss: 0.2184312 Vali Loss: 0.1193254 Test Loss: 0.1670911
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2043349
	speed: 0.5730s/iter; left time: 3601.3727s
	iters: 200, epoch: 77 | loss: 0.1867688
	speed: 0.1291s/iter; left time: 798.6861s
Epoch: 77 cost time: 35.76497983932495
Epoch: 77, Steps: 266 | Train Loss: 0.2182346 Vali Loss: 0.1192521 Test Loss: 0.1670875
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2305838
	speed: 0.6123s/iter; left time: 3685.4051s
	iters: 200, epoch: 78 | loss: 0.2345834
	speed: 0.1156s/iter; left time: 684.1643s
Epoch: 78 cost time: 33.572925329208374
Epoch: 78, Steps: 266 | Train Loss: 0.2185228 Vali Loss: 0.1192957 Test Loss: 0.1670917
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1558716
	speed: 0.5867s/iter; left time: 3375.4688s
	iters: 200, epoch: 79 | loss: 0.1907068
	speed: 0.1283s/iter; left time: 725.4731s
Epoch: 79 cost time: 38.49086594581604
Epoch: 79, Steps: 266 | Train Loss: 0.2184524 Vali Loss: 0.1192899 Test Loss: 0.1670902
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1587162
	speed: 0.5990s/iter; left time: 3286.9171s
	iters: 200, epoch: 80 | loss: 0.1937613
	speed: 0.1237s/iter; left time: 666.4015s
Epoch: 80 cost time: 35.31269407272339
Epoch: 80, Steps: 266 | Train Loss: 0.2185488 Vali Loss: 0.1193460 Test Loss: 0.1670881
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.2164166
	speed: 0.5070s/iter; left time: 2647.1099s
	iters: 200, epoch: 81 | loss: 0.2012169
	speed: 0.0961s/iter; left time: 492.2742s
Epoch: 81 cost time: 25.991634607315063
Epoch: 81, Steps: 266 | Train Loss: 0.2183869 Vali Loss: 0.1193288 Test Loss: 0.1670859
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.2478426
	speed: 0.3559s/iter; left time: 1763.4017s
	iters: 200, epoch: 82 | loss: 0.1771353
	speed: 0.0847s/iter; left time: 411.1085s
Epoch: 82 cost time: 22.518603563308716
Epoch: 82, Steps: 266 | Train Loss: 0.2184416 Vali Loss: 0.1192203 Test Loss: 0.1670862
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.2233379
	speed: 0.4826s/iter; left time: 2262.7686s
	iters: 200, epoch: 83 | loss: 0.2445690
	speed: 0.2246s/iter; left time: 1030.5211s
Epoch: 83 cost time: 58.19619536399841
Epoch: 83, Steps: 266 | Train Loss: 0.2183871 Vali Loss: 0.1191898 Test Loss: 0.1670846
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16770464181900024, mae:0.2575215995311737, rse:0.3320234417915344, corr:[0.56228006 0.5653112  0.56715333 0.5676073  0.5669647  0.5656563
 0.5642666  0.5631037  0.56234735 0.5620675  0.5621472  0.5624671
 0.5628624  0.5631207  0.56310725 0.5627295  0.5620656  0.56118363
 0.5602267  0.5593064  0.5585592  0.5580816  0.557818   0.5577439
 0.5577267  0.5576131  0.55735624 0.55693936 0.556412   0.5558026
 0.55517    0.55461824 0.55413604 0.5537022  0.5532778  0.55283237
 0.55235475 0.55184263 0.5513463  0.55088836 0.55045277 0.5500434
 0.54957485 0.5489905  0.5482746  0.54738516 0.54642636 0.5454776
 0.5445488  0.5436894  0.5428657  0.5421438  0.54146534 0.5407755
 0.5400555  0.5393713  0.53872365 0.5381525  0.5376922  0.5373595
 0.537112   0.536937   0.5368018  0.53665537 0.5364551  0.5362426
 0.5360472  0.53586644 0.53573984 0.5356769  0.53563434 0.53555787
 0.5354061  0.53517914 0.53486574 0.5344226  0.53389883 0.53330773
 0.53270406 0.53212714 0.53163815 0.53115594 0.53062195 0.52996
 0.52923    0.5285294  0.5278673  0.5273368  0.5269818  0.5267939
 0.5267357  0.52674395 0.52653617 0.52589375 0.52459294 0.52238476]
