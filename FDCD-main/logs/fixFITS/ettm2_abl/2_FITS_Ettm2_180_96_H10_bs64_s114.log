Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=30, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=30, out_features=46, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1236480.0
params:  1426.0
Trainable parameters:  1426
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2091027
	speed: 0.0166s/iter; left time: 441.1890s
	iters: 200, epoch: 1 | loss: 0.1790546
	speed: 0.0107s/iter; left time: 284.3608s
Epoch: 1 cost time: 3.46763014793396
Epoch: 1, Steps: 267 | Train Loss: 0.2258233 Vali Loss: 0.1733509 Test Loss: 0.2390881
Validation loss decreased (inf --> 0.173351).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1704103
	speed: 0.0580s/iter; left time: 1527.0513s
	iters: 200, epoch: 2 | loss: 0.1320667
	speed: 0.0102s/iter; left time: 266.8729s
Epoch: 2 cost time: 3.2272164821624756
Epoch: 2, Steps: 267 | Train Loss: 0.1513478 Vali Loss: 0.1571099 Test Loss: 0.2186265
Validation loss decreased (0.173351 --> 0.157110).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1392115
	speed: 0.0594s/iter; left time: 1548.9144s
	iters: 200, epoch: 3 | loss: 0.1007593
	speed: 0.0100s/iter; left time: 259.7409s
Epoch: 3 cost time: 3.263209581375122
Epoch: 3, Steps: 267 | Train Loss: 0.1260624 Vali Loss: 0.1482741 Test Loss: 0.2075223
Validation loss decreased (0.157110 --> 0.148274).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1078175
	speed: 0.0602s/iter; left time: 1554.0628s
	iters: 200, epoch: 4 | loss: 0.1142744
	speed: 0.0102s/iter; left time: 261.0808s
Epoch: 4 cost time: 3.3272197246551514
Epoch: 4, Steps: 267 | Train Loss: 0.1135011 Vali Loss: 0.1415553 Test Loss: 0.1989069
Validation loss decreased (0.148274 --> 0.141555).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1033536
	speed: 0.0578s/iter; left time: 1474.6721s
	iters: 200, epoch: 5 | loss: 0.0798643
	speed: 0.0100s/iter; left time: 254.6876s
Epoch: 5 cost time: 3.1913321018218994
Epoch: 5, Steps: 267 | Train Loss: 0.1057619 Vali Loss: 0.1370044 Test Loss: 0.1923832
Validation loss decreased (0.141555 --> 0.137004).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0836104
	speed: 0.0588s/iter; left time: 1484.6387s
	iters: 200, epoch: 6 | loss: 0.0926504
	speed: 0.0102s/iter; left time: 256.3319s
Epoch: 6 cost time: 3.2299749851226807
Epoch: 6, Steps: 267 | Train Loss: 0.1005989 Vali Loss: 0.1336361 Test Loss: 0.1877384
Validation loss decreased (0.137004 --> 0.133636).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0800145
	speed: 0.0578s/iter; left time: 1444.5015s
	iters: 200, epoch: 7 | loss: 0.0676847
	speed: 0.0099s/iter; left time: 246.9998s
Epoch: 7 cost time: 3.1847543716430664
Epoch: 7, Steps: 267 | Train Loss: 0.0970108 Vali Loss: 0.1311547 Test Loss: 0.1841300
Validation loss decreased (0.133636 --> 0.131155).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0923783
	speed: 0.0579s/iter; left time: 1433.0347s
	iters: 200, epoch: 8 | loss: 0.0864650
	speed: 0.0200s/iter; left time: 492.8593s
Epoch: 8 cost time: 4.497323513031006
Epoch: 8, Steps: 267 | Train Loss: 0.0944481 Vali Loss: 0.1295327 Test Loss: 0.1818202
Validation loss decreased (0.131155 --> 0.129533).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0588121
	speed: 0.0625s/iter; left time: 1529.9492s
	iters: 200, epoch: 9 | loss: 0.1051990
	speed: 0.0099s/iter; left time: 241.1945s
Epoch: 9 cost time: 3.2494490146636963
Epoch: 9, Steps: 267 | Train Loss: 0.0928137 Vali Loss: 0.1282495 Test Loss: 0.1800377
Validation loss decreased (0.129533 --> 0.128249).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0670277
	speed: 0.0580s/iter; left time: 1404.0878s
	iters: 200, epoch: 10 | loss: 0.0871061
	speed: 0.0172s/iter; left time: 414.9818s
Epoch: 10 cost time: 3.891200304031372
Epoch: 10, Steps: 267 | Train Loss: 0.0913368 Vali Loss: 0.1273096 Test Loss: 0.1786996
Validation loss decreased (0.128249 --> 0.127310).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0882491
	speed: 0.0607s/iter; left time: 1453.3822s
	iters: 200, epoch: 11 | loss: 0.0659987
	speed: 0.0102s/iter; left time: 242.2151s
Epoch: 11 cost time: 3.205953359603882
Epoch: 11, Steps: 267 | Train Loss: 0.0905190 Vali Loss: 0.1268295 Test Loss: 0.1779143
Validation loss decreased (0.127310 --> 0.126829).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1187536
	speed: 0.0576s/iter; left time: 1363.1352s
	iters: 200, epoch: 12 | loss: 0.1149873
	speed: 0.0100s/iter; left time: 236.2619s
Epoch: 12 cost time: 3.222881317138672
Epoch: 12, Steps: 267 | Train Loss: 0.0900682 Vali Loss: 0.1263627 Test Loss: 0.1772313
Validation loss decreased (0.126829 --> 0.126363).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1228736
	speed: 0.0574s/iter; left time: 1343.3954s
	iters: 200, epoch: 13 | loss: 0.0725781
	speed: 0.0101s/iter; left time: 234.7783s
Epoch: 13 cost time: 3.2575185298919678
Epoch: 13, Steps: 267 | Train Loss: 0.0896232 Vali Loss: 0.1257935 Test Loss: 0.1766630
Validation loss decreased (0.126363 --> 0.125793).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0829348
	speed: 0.0568s/iter; left time: 1313.4524s
	iters: 200, epoch: 14 | loss: 0.0717420
	speed: 0.0100s/iter; left time: 231.0013s
Epoch: 14 cost time: 3.222306728363037
Epoch: 14, Steps: 267 | Train Loss: 0.0893378 Vali Loss: 0.1256448 Test Loss: 0.1763413
Validation loss decreased (0.125793 --> 0.125645).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0507693
	speed: 0.0579s/iter; left time: 1323.9579s
	iters: 200, epoch: 15 | loss: 0.0764040
	speed: 0.0100s/iter; left time: 227.4347s
Epoch: 15 cost time: 3.1742937564849854
Epoch: 15, Steps: 267 | Train Loss: 0.0892291 Vali Loss: 0.1254653 Test Loss: 0.1762001
Validation loss decreased (0.125645 --> 0.125465).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0783304
	speed: 0.0602s/iter; left time: 1359.2697s
	iters: 200, epoch: 16 | loss: 0.0886781
	speed: 0.0099s/iter; left time: 223.5296s
Epoch: 16 cost time: 3.244931221008301
Epoch: 16, Steps: 267 | Train Loss: 0.0891118 Vali Loss: 0.1253684 Test Loss: 0.1760565
Validation loss decreased (0.125465 --> 0.125368).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0816705
	speed: 0.0575s/iter; left time: 1284.8792s
	iters: 200, epoch: 17 | loss: 0.1242487
	speed: 0.0100s/iter; left time: 222.9019s
Epoch: 17 cost time: 3.2750251293182373
Epoch: 17, Steps: 267 | Train Loss: 0.0889515 Vali Loss: 0.1252906 Test Loss: 0.1758692
Validation loss decreased (0.125368 --> 0.125291).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0809422
	speed: 0.0564s/iter; left time: 1244.6380s
	iters: 200, epoch: 18 | loss: 0.1073520
	speed: 0.0197s/iter; left time: 432.7538s
Epoch: 18 cost time: 6.26041841506958
Epoch: 18, Steps: 267 | Train Loss: 0.0889160 Vali Loss: 0.1252751 Test Loss: 0.1757428
Validation loss decreased (0.125291 --> 0.125275).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0722970
	speed: 0.0794s/iter; left time: 1729.7067s
	iters: 200, epoch: 19 | loss: 0.0554413
	speed: 0.0099s/iter; left time: 215.7457s
Epoch: 19 cost time: 3.237164258956909
Epoch: 19, Steps: 267 | Train Loss: 0.0888256 Vali Loss: 0.1251551 Test Loss: 0.1756761
Validation loss decreased (0.125275 --> 0.125155).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0979856
	speed: 0.0569s/iter; left time: 1224.1982s
	iters: 200, epoch: 20 | loss: 0.0886904
	speed: 0.0099s/iter; left time: 212.9077s
Epoch: 20 cost time: 3.202301502227783
Epoch: 20, Steps: 267 | Train Loss: 0.0888243 Vali Loss: 0.1252028 Test Loss: 0.1756663
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0814651
	speed: 0.0568s/iter; left time: 1208.5992s
	iters: 200, epoch: 21 | loss: 0.1022141
	speed: 0.0100s/iter; left time: 211.5755s
Epoch: 21 cost time: 3.111938714981079
Epoch: 21, Steps: 267 | Train Loss: 0.0889564 Vali Loss: 0.1251415 Test Loss: 0.1755710
Validation loss decreased (0.125155 --> 0.125142).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0683378
	speed: 0.0573s/iter; left time: 1203.6686s
	iters: 200, epoch: 22 | loss: 0.0745932
	speed: 0.0101s/iter; left time: 210.0780s
Epoch: 22 cost time: 3.252842664718628
Epoch: 22, Steps: 267 | Train Loss: 0.0889231 Vali Loss: 0.1251499 Test Loss: 0.1755235
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0971579
	speed: 0.0587s/iter; left time: 1216.3913s
	iters: 200, epoch: 23 | loss: 0.1012101
	speed: 0.0101s/iter; left time: 207.4970s
Epoch: 23 cost time: 3.2631912231445312
Epoch: 23, Steps: 267 | Train Loss: 0.0889285 Vali Loss: 0.1251267 Test Loss: 0.1755504
Validation loss decreased (0.125142 --> 0.125127).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0917131
	speed: 0.0578s/iter; left time: 1181.7389s
	iters: 200, epoch: 24 | loss: 0.0719850
	speed: 0.0099s/iter; left time: 202.5288s
Epoch: 24 cost time: 3.3045549392700195
Epoch: 24, Steps: 267 | Train Loss: 0.0888471 Vali Loss: 0.1250736 Test Loss: 0.1755748
Validation loss decreased (0.125127 --> 0.125074).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0707283
	speed: 0.0573s/iter; left time: 1157.3910s
	iters: 200, epoch: 25 | loss: 0.0890812
	speed: 0.0099s/iter; left time: 199.1744s
Epoch: 25 cost time: 3.2131636142730713
Epoch: 25, Steps: 267 | Train Loss: 0.0888882 Vali Loss: 0.1251166 Test Loss: 0.1755583
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0672059
	speed: 0.0570s/iter; left time: 1135.7090s
	iters: 200, epoch: 26 | loss: 0.0702021
	speed: 0.0100s/iter; left time: 197.7452s
Epoch: 26 cost time: 3.215240716934204
Epoch: 26, Steps: 267 | Train Loss: 0.0889316 Vali Loss: 0.1251899 Test Loss: 0.1755721
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1246773
	speed: 0.0573s/iter; left time: 1126.9105s
	iters: 200, epoch: 27 | loss: 0.0960748
	speed: 0.0103s/iter; left time: 200.6650s
Epoch: 27 cost time: 3.1409664154052734
Epoch: 27, Steps: 267 | Train Loss: 0.0889615 Vali Loss: 0.1250995 Test Loss: 0.1755278
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0990869
	speed: 0.0573s/iter; left time: 1111.3180s
	iters: 200, epoch: 28 | loss: 0.0947104
	speed: 0.0100s/iter; left time: 192.0874s
Epoch: 28 cost time: 3.2175161838531494
Epoch: 28, Steps: 267 | Train Loss: 0.0888350 Vali Loss: 0.1250919 Test Loss: 0.1755457
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0778921
	speed: 0.0592s/iter; left time: 1132.2206s
	iters: 200, epoch: 29 | loss: 0.0879985
	speed: 0.0100s/iter; left time: 190.2326s
Epoch: 29 cost time: 3.240084171295166
Epoch: 29, Steps: 267 | Train Loss: 0.0888946 Vali Loss: 0.1251918 Test Loss: 0.1755566
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1063547
	speed: 0.0576s/iter; left time: 1086.6119s
	iters: 200, epoch: 30 | loss: 0.0984712
	speed: 0.0101s/iter; left time: 189.5498s
Epoch: 30 cost time: 3.2276885509490967
Epoch: 30, Steps: 267 | Train Loss: 0.0889136 Vali Loss: 0.1250847 Test Loss: 0.1755625
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0951695
	speed: 0.0567s/iter; left time: 1054.8562s
	iters: 200, epoch: 31 | loss: 0.0770078
	speed: 0.0101s/iter; left time: 185.9040s
Epoch: 31 cost time: 3.2743847370147705
Epoch: 31, Steps: 267 | Train Loss: 0.0888399 Vali Loss: 0.1251097 Test Loss: 0.1755343
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0696025
	speed: 0.0565s/iter; left time: 1035.1846s
	iters: 200, epoch: 32 | loss: 0.0575912
	speed: 0.0101s/iter; left time: 183.6564s
Epoch: 32 cost time: 3.180166721343994
Epoch: 32, Steps: 267 | Train Loss: 0.0888335 Vali Loss: 0.1251852 Test Loss: 0.1755814
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0968980
	speed: 0.0569s/iter; left time: 1027.2814s
	iters: 200, epoch: 33 | loss: 0.0816144
	speed: 0.0101s/iter; left time: 181.1096s
Epoch: 33 cost time: 3.179549217224121
Epoch: 33, Steps: 267 | Train Loss: 0.0889433 Vali Loss: 0.1251211 Test Loss: 0.1755874
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0966143
	speed: 0.0578s/iter; left time: 1027.6273s
	iters: 200, epoch: 34 | loss: 0.0827126
	speed: 0.0110s/iter; left time: 195.4407s
Epoch: 34 cost time: 3.31117844581604
Epoch: 34, Steps: 267 | Train Loss: 0.0887758 Vali Loss: 0.1251837 Test Loss: 0.1755930
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1134241
	speed: 0.0565s/iter; left time: 989.2605s
	iters: 200, epoch: 35 | loss: 0.1177970
	speed: 0.0102s/iter; left time: 177.6289s
Epoch: 35 cost time: 3.12760591506958
Epoch: 35, Steps: 267 | Train Loss: 0.0888797 Vali Loss: 0.1252040 Test Loss: 0.1756051
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1011291
	speed: 0.0562s/iter; left time: 969.2619s
	iters: 200, epoch: 36 | loss: 0.1110210
	speed: 0.0101s/iter; left time: 173.5768s
Epoch: 36 cost time: 3.211256504058838
Epoch: 36, Steps: 267 | Train Loss: 0.0889000 Vali Loss: 0.1252249 Test Loss: 0.1755768
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1031474
	speed: 0.0583s/iter; left time: 990.6064s
	iters: 200, epoch: 37 | loss: 0.0890266
	speed: 0.0099s/iter; left time: 167.6231s
Epoch: 37 cost time: 3.2866628170013428
Epoch: 37, Steps: 267 | Train Loss: 0.0889538 Vali Loss: 0.1252241 Test Loss: 0.1755880
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0773936
	speed: 0.0601s/iter; left time: 1004.5067s
	iters: 200, epoch: 38 | loss: 0.0615032
	speed: 0.0100s/iter; left time: 165.8653s
Epoch: 38 cost time: 3.2945914268493652
Epoch: 38, Steps: 267 | Train Loss: 0.0887884 Vali Loss: 0.1251861 Test Loss: 0.1755681
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0654899
	speed: 0.0583s/iter; left time: 959.1628s
	iters: 200, epoch: 39 | loss: 0.0927511
	speed: 0.0100s/iter; left time: 164.3148s
Epoch: 39 cost time: 3.230973482131958
Epoch: 39, Steps: 267 | Train Loss: 0.0888722 Vali Loss: 0.1251632 Test Loss: 0.1756132
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0868977
	speed: 0.0614s/iter; left time: 993.7459s
	iters: 200, epoch: 40 | loss: 0.0879921
	speed: 0.0101s/iter; left time: 162.8752s
Epoch: 40 cost time: 3.3037500381469727
Epoch: 40, Steps: 267 | Train Loss: 0.0887478 Vali Loss: 0.1252119 Test Loss: 0.1755964
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0820862
	speed: 0.0593s/iter; left time: 944.0302s
	iters: 200, epoch: 41 | loss: 0.0859306
	speed: 0.0101s/iter; left time: 160.2227s
Epoch: 41 cost time: 3.2349798679351807
Epoch: 41, Steps: 267 | Train Loss: 0.0888711 Vali Loss: 0.1251456 Test Loss: 0.1756074
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1283993
	speed: 0.0596s/iter; left time: 933.4513s
	iters: 200, epoch: 42 | loss: 0.0904392
	speed: 0.0101s/iter; left time: 156.9109s
Epoch: 42 cost time: 3.3029820919036865
Epoch: 42, Steps: 267 | Train Loss: 0.0887483 Vali Loss: 0.1252518 Test Loss: 0.1755978
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0812928
	speed: 0.0576s/iter; left time: 885.8939s
	iters: 200, epoch: 43 | loss: 0.0795877
	speed: 0.0105s/iter; left time: 160.3849s
Epoch: 43 cost time: 3.265127420425415
Epoch: 43, Steps: 267 | Train Loss: 0.0887956 Vali Loss: 0.1251802 Test Loss: 0.1755809
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0683474
	speed: 0.0585s/iter; left time: 884.0841s
	iters: 200, epoch: 44 | loss: 0.0854816
	speed: 0.0100s/iter; left time: 150.4495s
Epoch: 44 cost time: 3.246014356613159
Epoch: 44, Steps: 267 | Train Loss: 0.0889159 Vali Loss: 0.1251452 Test Loss: 0.1755734
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=30, out_features=46, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1236480.0
params:  1426.0
Trainable parameters:  1426
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2352227
	speed: 0.0159s/iter; left time: 422.8382s
	iters: 200, epoch: 1 | loss: 0.2483123
	speed: 0.0101s/iter; left time: 268.7494s
Epoch: 1 cost time: 3.30484676361084
Epoch: 1, Steps: 267 | Train Loss: 0.2317853 Vali Loss: 0.1242445 Test Loss: 0.1741035
Validation loss decreased (inf --> 0.124244).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1834178
	speed: 0.0578s/iter; left time: 1522.0315s
	iters: 200, epoch: 2 | loss: 0.1847589
	speed: 0.0098s/iter; left time: 257.5706s
Epoch: 2 cost time: 3.1727142333984375
Epoch: 2, Steps: 267 | Train Loss: 0.2311902 Vali Loss: 0.1240356 Test Loss: 0.1737128
Validation loss decreased (0.124244 --> 0.124036).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3144168
	speed: 0.0570s/iter; left time: 1487.0611s
	iters: 200, epoch: 3 | loss: 0.2190846
	speed: 0.0100s/iter; left time: 259.9677s
Epoch: 3 cost time: 3.1576883792877197
Epoch: 3, Steps: 267 | Train Loss: 0.2306468 Vali Loss: 0.1237195 Test Loss: 0.1734103
Validation loss decreased (0.124036 --> 0.123720).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1677633
	speed: 0.0584s/iter; left time: 1506.6550s
	iters: 200, epoch: 4 | loss: 0.3058788
	speed: 0.0100s/iter; left time: 256.0928s
Epoch: 4 cost time: 3.2394356727600098
Epoch: 4, Steps: 267 | Train Loss: 0.2302427 Vali Loss: 0.1235194 Test Loss: 0.1731885
Validation loss decreased (0.123720 --> 0.123519).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1724728
	speed: 0.0586s/iter; left time: 1495.5594s
	iters: 200, epoch: 5 | loss: 0.2727529
	speed: 0.0100s/iter; left time: 255.1496s
Epoch: 5 cost time: 3.1888844966888428
Epoch: 5, Steps: 267 | Train Loss: 0.2299002 Vali Loss: 0.1234779 Test Loss: 0.1732488
Validation loss decreased (0.123519 --> 0.123478).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1990836
	speed: 0.0570s/iter; left time: 1439.5820s
	iters: 200, epoch: 6 | loss: 0.2661027
	speed: 0.0102s/iter; left time: 256.3111s
Epoch: 6 cost time: 3.177927255630493
Epoch: 6, Steps: 267 | Train Loss: 0.2297156 Vali Loss: 0.1233093 Test Loss: 0.1732398
Validation loss decreased (0.123478 --> 0.123309).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1744428
	speed: 0.0569s/iter; left time: 1422.7536s
	iters: 200, epoch: 7 | loss: 0.2801999
	speed: 0.0101s/iter; left time: 251.8849s
Epoch: 7 cost time: 3.2318532466888428
Epoch: 7, Steps: 267 | Train Loss: 0.2295393 Vali Loss: 0.1235183 Test Loss: 0.1731015
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2731680
	speed: 0.0584s/iter; left time: 1445.2509s
	iters: 200, epoch: 8 | loss: 0.1905168
	speed: 0.0100s/iter; left time: 247.5219s
Epoch: 8 cost time: 3.1462607383728027
Epoch: 8, Steps: 267 | Train Loss: 0.2295307 Vali Loss: 0.1234765 Test Loss: 0.1730000
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1550451
	speed: 0.0585s/iter; left time: 1431.0542s
	iters: 200, epoch: 9 | loss: 0.2417552
	speed: 0.0099s/iter; left time: 241.5039s
Epoch: 9 cost time: 3.270112991333008
Epoch: 9, Steps: 267 | Train Loss: 0.2296987 Vali Loss: 0.1233568 Test Loss: 0.1729926
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2161833
	speed: 0.0568s/iter; left time: 1373.3890s
	iters: 200, epoch: 10 | loss: 0.2798986
	speed: 0.0101s/iter; left time: 243.8471s
Epoch: 10 cost time: 3.1860532760620117
Epoch: 10, Steps: 267 | Train Loss: 0.2293544 Vali Loss: 0.1231924 Test Loss: 0.1728740
Validation loss decreased (0.123309 --> 0.123192).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2273297
	speed: 0.0559s/iter; left time: 1338.3493s
	iters: 200, epoch: 11 | loss: 0.1418336
	speed: 0.0099s/iter; left time: 236.4404s
Epoch: 11 cost time: 3.117812395095825
Epoch: 11, Steps: 267 | Train Loss: 0.2291568 Vali Loss: 0.1231665 Test Loss: 0.1727818
Validation loss decreased (0.123192 --> 0.123166).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3109297
	speed: 0.0575s/iter; left time: 1361.6056s
	iters: 200, epoch: 12 | loss: 0.2589989
	speed: 0.0100s/iter; left time: 236.3589s
Epoch: 12 cost time: 3.224222421646118
Epoch: 12, Steps: 267 | Train Loss: 0.2293868 Vali Loss: 0.1232758 Test Loss: 0.1730131
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2823246
	speed: 0.0561s/iter; left time: 1313.1378s
	iters: 200, epoch: 13 | loss: 0.2031635
	speed: 0.0100s/iter; left time: 233.2944s
Epoch: 13 cost time: 3.1562111377716064
Epoch: 13, Steps: 267 | Train Loss: 0.2292209 Vali Loss: 0.1234288 Test Loss: 0.1730946
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2755338
	speed: 0.0572s/iter; left time: 1323.4019s
	iters: 200, epoch: 14 | loss: 0.2037119
	speed: 0.0104s/iter; left time: 239.2125s
Epoch: 14 cost time: 3.255297899246216
Epoch: 14, Steps: 267 | Train Loss: 0.2291997 Vali Loss: 0.1233028 Test Loss: 0.1729806
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2109893
	speed: 0.0585s/iter; left time: 1338.2275s
	iters: 200, epoch: 15 | loss: 0.1562068
	speed: 0.0101s/iter; left time: 229.7310s
Epoch: 15 cost time: 3.2208003997802734
Epoch: 15, Steps: 267 | Train Loss: 0.2291731 Vali Loss: 0.1232236 Test Loss: 0.1728054
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2458972
	speed: 0.0593s/iter; left time: 1338.8562s
	iters: 200, epoch: 16 | loss: 0.1652095
	speed: 0.0101s/iter; left time: 228.2264s
Epoch: 16 cost time: 3.243943691253662
Epoch: 16, Steps: 267 | Train Loss: 0.2285950 Vali Loss: 0.1231665 Test Loss: 0.1727558
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3108632
	speed: 0.0565s/iter; left time: 1262.4734s
	iters: 200, epoch: 17 | loss: 0.2093559
	speed: 0.0101s/iter; left time: 225.3027s
Epoch: 17 cost time: 3.268183708190918
Epoch: 17, Steps: 267 | Train Loss: 0.2292222 Vali Loss: 0.1232771 Test Loss: 0.1727521
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2466246
	speed: 0.0572s/iter; left time: 1262.5059s
	iters: 200, epoch: 18 | loss: 0.3242708
	speed: 0.0099s/iter; left time: 217.0367s
Epoch: 18 cost time: 3.2053606510162354
Epoch: 18, Steps: 267 | Train Loss: 0.2290870 Vali Loss: 0.1233204 Test Loss: 0.1728300
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1454242
	speed: 0.0609s/iter; left time: 1328.2895s
	iters: 200, epoch: 19 | loss: 0.2620251
	speed: 0.0099s/iter; left time: 215.6565s
Epoch: 19 cost time: 3.2875306606292725
Epoch: 19, Steps: 267 | Train Loss: 0.2290434 Vali Loss: 0.1233277 Test Loss: 0.1727957
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2972352
	speed: 0.0586s/iter; left time: 1262.4294s
	iters: 200, epoch: 20 | loss: 0.2709384
	speed: 0.0100s/iter; left time: 214.4073s
Epoch: 20 cost time: 3.3169407844543457
Epoch: 20, Steps: 267 | Train Loss: 0.2285946 Vali Loss: 0.1232615 Test Loss: 0.1727778
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2751158
	speed: 0.0600s/iter; left time: 1275.8797s
	iters: 200, epoch: 21 | loss: 0.2040617
	speed: 0.0106s/iter; left time: 225.3471s
Epoch: 21 cost time: 3.2722411155700684
Epoch: 21, Steps: 267 | Train Loss: 0.2288533 Vali Loss: 0.1232533 Test Loss: 0.1728461
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2073982
	speed: 0.0591s/iter; left time: 1240.5843s
	iters: 200, epoch: 22 | loss: 0.1867759
	speed: 0.0103s/iter; left time: 215.9739s
Epoch: 22 cost time: 3.3293397426605225
Epoch: 22, Steps: 267 | Train Loss: 0.2287683 Vali Loss: 0.1231911 Test Loss: 0.1727872
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1382622
	speed: 0.0581s/iter; left time: 1205.2305s
	iters: 200, epoch: 23 | loss: 0.3123390
	speed: 0.0099s/iter; left time: 204.4567s
Epoch: 23 cost time: 3.1437511444091797
Epoch: 23, Steps: 267 | Train Loss: 0.2287731 Vali Loss: 0.1232548 Test Loss: 0.1727504
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1948878
	speed: 0.0582s/iter; left time: 1189.7582s
	iters: 200, epoch: 24 | loss: 0.2167396
	speed: 0.0100s/iter; left time: 204.0436s
Epoch: 24 cost time: 3.266965627670288
Epoch: 24, Steps: 267 | Train Loss: 0.2287806 Vali Loss: 0.1232552 Test Loss: 0.1727910
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1800447
	speed: 0.0636s/iter; left time: 1284.9699s
	iters: 200, epoch: 25 | loss: 0.1914176
	speed: 0.0101s/iter; left time: 203.5864s
Epoch: 25 cost time: 3.300326347351074
Epoch: 25, Steps: 267 | Train Loss: 0.2288981 Vali Loss: 0.1233330 Test Loss: 0.1728327
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3282913
	speed: 0.0575s/iter; left time: 1145.4720s
	iters: 200, epoch: 26 | loss: 0.1253903
	speed: 0.0100s/iter; left time: 198.3900s
Epoch: 26 cost time: 3.2557835578918457
Epoch: 26, Steps: 267 | Train Loss: 0.2286032 Vali Loss: 0.1232231 Test Loss: 0.1728467
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2240975
	speed: 0.0619s/iter; left time: 1217.3144s
	iters: 200, epoch: 27 | loss: 0.3190858
	speed: 0.0099s/iter; left time: 193.5666s
Epoch: 27 cost time: 3.220817804336548
Epoch: 27, Steps: 267 | Train Loss: 0.2289084 Vali Loss: 0.1233494 Test Loss: 0.1728593
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2738487
	speed: 0.0600s/iter; left time: 1163.6223s
	iters: 200, epoch: 28 | loss: 0.1737096
	speed: 0.0100s/iter; left time: 192.5036s
Epoch: 28 cost time: 3.2144615650177
Epoch: 28, Steps: 267 | Train Loss: 0.2288914 Vali Loss: 0.1232806 Test Loss: 0.1728092
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2169863
	speed: 0.0574s/iter; left time: 1098.4877s
	iters: 200, epoch: 29 | loss: 0.2271309
	speed: 0.0100s/iter; left time: 189.3467s
Epoch: 29 cost time: 3.180617094039917
Epoch: 29, Steps: 267 | Train Loss: 0.2285531 Vali Loss: 0.1233243 Test Loss: 0.1728298
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1842429
	speed: 0.0613s/iter; left time: 1155.5784s
	iters: 200, epoch: 30 | loss: 0.1681684
	speed: 0.0101s/iter; left time: 189.3241s
Epoch: 30 cost time: 3.3652703762054443
Epoch: 30, Steps: 267 | Train Loss: 0.2288798 Vali Loss: 0.1233087 Test Loss: 0.1728212
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2064507
	speed: 0.0590s/iter; left time: 1097.4402s
	iters: 200, epoch: 31 | loss: 0.1747153
	speed: 0.0101s/iter; left time: 187.0204s
Epoch: 31 cost time: 3.26621413230896
Epoch: 31, Steps: 267 | Train Loss: 0.2287728 Vali Loss: 0.1232505 Test Loss: 0.1728043
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1735355108976364, mae:0.2591247260570526, rse:0.33774611353874207, corr:[0.57178617 0.57301956 0.5692181  0.56582475 0.56493175 0.5652844
 0.5651234  0.5638164  0.56214637 0.5611208  0.56091523 0.56100655
 0.5607599  0.5600611  0.5593662  0.55889946 0.55851215 0.5578928
 0.55697304 0.55598176 0.5552447  0.5548015  0.5544498  0.5540199
 0.5534504  0.55287    0.5524823  0.552201   0.55177456 0.55109155
 0.55032825 0.549755   0.5493948  0.54912645 0.548739   0.5481669
 0.5473841  0.5466057  0.5459074  0.54527265 0.54470944 0.54421425
 0.5437988  0.54344803 0.5430982  0.54269624 0.5421062  0.54126865
 0.5402543  0.53927094 0.5384843  0.5379521  0.5374767  0.536872
 0.53621113 0.53568566 0.5352474  0.53490657 0.5345306  0.5341161
 0.5336322  0.53329206 0.53316325 0.5330725  0.5329191  0.5327303
 0.5324683  0.5322327  0.5321061  0.5321033  0.53208727 0.53198564
 0.5318359  0.5316097  0.53146815 0.53130573 0.5310459  0.53061855
 0.5301254  0.52966404 0.529224   0.52876323 0.52828455 0.5277831
 0.5272853  0.52685356 0.5264458  0.52612627 0.5258248  0.52548844
 0.52523416 0.5251164  0.52510476 0.5250865  0.5247015  0.5230811 ]
