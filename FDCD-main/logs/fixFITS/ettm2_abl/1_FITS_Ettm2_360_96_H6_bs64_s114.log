Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=34, out_features=43, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1309952.0
params:  1505.0
Trainable parameters:  1505
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2655650
	speed: 0.0591s/iter; left time: 1565.3680s
	iters: 200, epoch: 1 | loss: 0.3131336
	speed: 0.0221s/iter; left time: 583.1226s
Epoch: 1 cost time: 10.897997856140137
Epoch: 1, Steps: 266 | Train Loss: 0.3119650 Vali Loss: 0.1351488 Test Loss: 0.1897079
Validation loss decreased (inf --> 0.135149).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1946943
	speed: 0.1261s/iter; left time: 3308.2598s
	iters: 200, epoch: 2 | loss: 0.2749873
	speed: 0.0253s/iter; left time: 660.2605s
Epoch: 2 cost time: 6.6221983432769775
Epoch: 2, Steps: 266 | Train Loss: 0.2496045 Vali Loss: 0.1266739 Test Loss: 0.1789334
Validation loss decreased (0.135149 --> 0.126674).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1852739
	speed: 0.0978s/iter; left time: 2540.0297s
	iters: 200, epoch: 3 | loss: 0.2585834
	speed: 0.0438s/iter; left time: 1132.6927s
Epoch: 3 cost time: 10.123133659362793
Epoch: 3, Steps: 266 | Train Loss: 0.2357999 Vali Loss: 0.1231258 Test Loss: 0.1742746
Validation loss decreased (0.126674 --> 0.123126).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2031855
	speed: 0.1596s/iter; left time: 4103.0282s
	iters: 200, epoch: 4 | loss: 0.1837523
	speed: 0.0202s/iter; left time: 517.2316s
Epoch: 4 cost time: 7.297513246536255
Epoch: 4, Steps: 266 | Train Loss: 0.2295950 Vali Loss: 0.1215713 Test Loss: 0.1721892
Validation loss decreased (0.123126 --> 0.121571).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2283498
	speed: 0.1586s/iter; left time: 4033.9744s
	iters: 200, epoch: 5 | loss: 0.2813387
	speed: 0.0225s/iter; left time: 570.5437s
Epoch: 5 cost time: 8.13036060333252
Epoch: 5, Steps: 266 | Train Loss: 0.2259841 Vali Loss: 0.1206092 Test Loss: 0.1704594
Validation loss decreased (0.121571 --> 0.120609).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2449661
	speed: 0.1398s/iter; left time: 3520.0447s
	iters: 200, epoch: 6 | loss: 0.1908518
	speed: 0.0448s/iter; left time: 1123.1541s
Epoch: 6 cost time: 8.950969219207764
Epoch: 6, Steps: 266 | Train Loss: 0.2239808 Vali Loss: 0.1202286 Test Loss: 0.1694493
Validation loss decreased (0.120609 --> 0.120229).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1616258
	speed: 0.0880s/iter; left time: 2191.5534s
	iters: 200, epoch: 7 | loss: 0.2144026
	speed: 0.0207s/iter; left time: 514.4059s
Epoch: 7 cost time: 5.590052127838135
Epoch: 7, Steps: 266 | Train Loss: 0.2223336 Vali Loss: 0.1198358 Test Loss: 0.1688935
Validation loss decreased (0.120229 --> 0.119836).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2009075
	speed: 0.1043s/iter; left time: 2570.7343s
	iters: 200, epoch: 8 | loss: 0.2680595
	speed: 0.0193s/iter; left time: 473.7630s
Epoch: 8 cost time: 7.296696662902832
Epoch: 8, Steps: 266 | Train Loss: 0.2215287 Vali Loss: 0.1197274 Test Loss: 0.1685437
Validation loss decreased (0.119836 --> 0.119727).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1629200
	speed: 0.1165s/iter; left time: 2840.5948s
	iters: 200, epoch: 9 | loss: 0.2848285
	speed: 0.0375s/iter; left time: 911.1737s
Epoch: 9 cost time: 9.760375022888184
Epoch: 9, Steps: 266 | Train Loss: 0.2206707 Vali Loss: 0.1192989 Test Loss: 0.1680737
Validation loss decreased (0.119727 --> 0.119299).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2087182
	speed: 0.1458s/iter; left time: 3515.9132s
	iters: 200, epoch: 10 | loss: 0.2725354
	speed: 0.0229s/iter; left time: 548.9068s
Epoch: 10 cost time: 9.02367901802063
Epoch: 10, Steps: 266 | Train Loss: 0.2200473 Vali Loss: 0.1192551 Test Loss: 0.1676103
Validation loss decreased (0.119299 --> 0.119255).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2307193
	speed: 0.1253s/iter; left time: 2987.0645s
	iters: 200, epoch: 11 | loss: 0.2874654
	speed: 0.0463s/iter; left time: 1099.1620s
Epoch: 11 cost time: 9.390029191970825
Epoch: 11, Steps: 266 | Train Loss: 0.2193061 Vali Loss: 0.1189686 Test Loss: 0.1674839
Validation loss decreased (0.119255 --> 0.118969).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2645528
	speed: 0.1016s/iter; left time: 2394.5464s
	iters: 200, epoch: 12 | loss: 0.3249217
	speed: 0.0155s/iter; left time: 364.5303s
Epoch: 12 cost time: 5.10107684135437
Epoch: 12, Steps: 266 | Train Loss: 0.2191607 Vali Loss: 0.1190047 Test Loss: 0.1673798
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2419935
	speed: 0.1063s/iter; left time: 2476.9968s
	iters: 200, epoch: 13 | loss: 0.2366346
	speed: 0.0255s/iter; left time: 592.3854s
Epoch: 13 cost time: 6.219870567321777
Epoch: 13, Steps: 266 | Train Loss: 0.2187098 Vali Loss: 0.1188186 Test Loss: 0.1673186
Validation loss decreased (0.118969 --> 0.118819).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3335452
	speed: 0.1156s/iter; left time: 2664.4651s
	iters: 200, epoch: 14 | loss: 0.2453792
	speed: 0.0215s/iter; left time: 493.7671s
Epoch: 14 cost time: 10.0569486618042
Epoch: 14, Steps: 266 | Train Loss: 0.2183922 Vali Loss: 0.1188273 Test Loss: 0.1670069
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2421844
	speed: 0.1614s/iter; left time: 3675.7093s
	iters: 200, epoch: 15 | loss: 0.2753141
	speed: 0.0322s/iter; left time: 729.4069s
Epoch: 15 cost time: 10.175800085067749
Epoch: 15, Steps: 266 | Train Loss: 0.2181994 Vali Loss: 0.1186670 Test Loss: 0.1669161
Validation loss decreased (0.118819 --> 0.118667).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1690794
	speed: 0.1665s/iter; left time: 3747.1672s
	iters: 200, epoch: 16 | loss: 0.2157419
	speed: 0.0377s/iter; left time: 844.4416s
Epoch: 16 cost time: 9.107609987258911
Epoch: 16, Steps: 266 | Train Loss: 0.2180074 Vali Loss: 0.1187097 Test Loss: 0.1669136
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1754435
	speed: 0.1285s/iter; left time: 2859.0522s
	iters: 200, epoch: 17 | loss: 0.2426754
	speed: 0.0253s/iter; left time: 559.9256s
Epoch: 17 cost time: 6.346399545669556
Epoch: 17, Steps: 266 | Train Loss: 0.2174965 Vali Loss: 0.1186392 Test Loss: 0.1667328
Validation loss decreased (0.118667 --> 0.118639).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1942616
	speed: 0.0820s/iter; left time: 1802.3515s
	iters: 200, epoch: 18 | loss: 0.2220989
	speed: 0.0326s/iter; left time: 714.2425s
Epoch: 18 cost time: 6.666088581085205
Epoch: 18, Steps: 266 | Train Loss: 0.2177960 Vali Loss: 0.1185336 Test Loss: 0.1667249
Validation loss decreased (0.118639 --> 0.118534).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2229051
	speed: 0.1254s/iter; left time: 2722.1775s
	iters: 200, epoch: 19 | loss: 0.2363667
	speed: 0.0275s/iter; left time: 595.2326s
Epoch: 19 cost time: 10.454521179199219
Epoch: 19, Steps: 266 | Train Loss: 0.2176228 Vali Loss: 0.1184549 Test Loss: 0.1666604
Validation loss decreased (0.118534 --> 0.118455).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2459434
	speed: 0.1486s/iter; left time: 3187.2623s
	iters: 200, epoch: 20 | loss: 0.1741881
	speed: 0.0203s/iter; left time: 434.0727s
Epoch: 20 cost time: 6.997403383255005
Epoch: 20, Steps: 266 | Train Loss: 0.2174654 Vali Loss: 0.1184822 Test Loss: 0.1666339
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1616568
	speed: 0.1336s/iter; left time: 2829.6889s
	iters: 200, epoch: 21 | loss: 0.1740482
	speed: 0.0254s/iter; left time: 535.2573s
Epoch: 21 cost time: 8.932317733764648
Epoch: 21, Steps: 266 | Train Loss: 0.2171618 Vali Loss: 0.1184846 Test Loss: 0.1665705
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2847515
	speed: 0.1497s/iter; left time: 3130.8986s
	iters: 200, epoch: 22 | loss: 0.1910832
	speed: 0.0247s/iter; left time: 514.5327s
Epoch: 22 cost time: 8.955472469329834
Epoch: 22, Steps: 266 | Train Loss: 0.2173560 Vali Loss: 0.1185288 Test Loss: 0.1664460
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2362873
	speed: 0.1113s/iter; left time: 2297.2902s
	iters: 200, epoch: 23 | loss: 0.1912245
	speed: 0.0308s/iter; left time: 633.2617s
Epoch: 23 cost time: 7.914941787719727
Epoch: 23, Steps: 266 | Train Loss: 0.2171279 Vali Loss: 0.1184530 Test Loss: 0.1665954
Validation loss decreased (0.118455 --> 0.118453).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2272653
	speed: 0.1270s/iter; left time: 2588.4087s
	iters: 200, epoch: 24 | loss: 0.1516842
	speed: 0.0195s/iter; left time: 395.1059s
Epoch: 24 cost time: 6.437780380249023
Epoch: 24, Steps: 266 | Train Loss: 0.2171745 Vali Loss: 0.1183893 Test Loss: 0.1664983
Validation loss decreased (0.118453 --> 0.118389).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1985932
	speed: 0.1174s/iter; left time: 2361.0614s
	iters: 200, epoch: 25 | loss: 0.2655745
	speed: 0.0393s/iter; left time: 787.5856s
Epoch: 25 cost time: 8.458941459655762
Epoch: 25, Steps: 266 | Train Loss: 0.2167149 Vali Loss: 0.1184131 Test Loss: 0.1664858
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2218101
	speed: 0.1490s/iter; left time: 2957.9818s
	iters: 200, epoch: 26 | loss: 0.2645885
	speed: 0.0319s/iter; left time: 629.6292s
Epoch: 26 cost time: 10.00277328491211
Epoch: 26, Steps: 266 | Train Loss: 0.2167330 Vali Loss: 0.1183702 Test Loss: 0.1663853
Validation loss decreased (0.118389 --> 0.118370).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2483365
	speed: 0.1400s/iter; left time: 2741.5524s
	iters: 200, epoch: 27 | loss: 0.2391780
	speed: 0.0208s/iter; left time: 405.3850s
Epoch: 27 cost time: 8.005693674087524
Epoch: 27, Steps: 266 | Train Loss: 0.2168860 Vali Loss: 0.1185016 Test Loss: 0.1664757
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1421580
	speed: 0.1146s/iter; left time: 2213.3192s
	iters: 200, epoch: 28 | loss: 0.1741781
	speed: 0.0310s/iter; left time: 596.5097s
Epoch: 28 cost time: 7.6992950439453125
Epoch: 28, Steps: 266 | Train Loss: 0.2167529 Vali Loss: 0.1184656 Test Loss: 0.1663862
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2508963
	speed: 0.1003s/iter; left time: 1911.2775s
	iters: 200, epoch: 29 | loss: 0.2436014
	speed: 0.0278s/iter; left time: 527.4435s
Epoch: 29 cost time: 7.059119462966919
Epoch: 29, Steps: 266 | Train Loss: 0.2168872 Vali Loss: 0.1184079 Test Loss: 0.1664053
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2602487
	speed: 0.1380s/iter; left time: 2592.1738s
	iters: 200, epoch: 30 | loss: 0.3668584
	speed: 0.0234s/iter; left time: 438.1002s
Epoch: 30 cost time: 8.764793395996094
Epoch: 30, Steps: 266 | Train Loss: 0.2166745 Vali Loss: 0.1183871 Test Loss: 0.1663915
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1758923
	speed: 0.1578s/iter; left time: 2923.4392s
	iters: 200, epoch: 31 | loss: 0.2556072
	speed: 0.0337s/iter; left time: 620.9963s
Epoch: 31 cost time: 9.202828168869019
Epoch: 31, Steps: 266 | Train Loss: 0.2167146 Vali Loss: 0.1183981 Test Loss: 0.1663392
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1776529
	speed: 0.1353s/iter; left time: 2469.4774s
	iters: 200, epoch: 32 | loss: 0.2692377
	speed: 0.0376s/iter; left time: 682.5182s
Epoch: 32 cost time: 9.248761892318726
Epoch: 32, Steps: 266 | Train Loss: 0.2167056 Vali Loss: 0.1183681 Test Loss: 0.1663567
Validation loss decreased (0.118370 --> 0.118368).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2901911
	speed: 0.1043s/iter; left time: 1876.1804s
	iters: 200, epoch: 33 | loss: 0.1984556
	speed: 0.0222s/iter; left time: 396.3108s
Epoch: 33 cost time: 6.4827680587768555
Epoch: 33, Steps: 266 | Train Loss: 0.2167853 Vali Loss: 0.1183173 Test Loss: 0.1664023
Validation loss decreased (0.118368 --> 0.118317).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2355471
	speed: 0.0859s/iter; left time: 1521.6066s
	iters: 200, epoch: 34 | loss: 0.3793430
	speed: 0.0194s/iter; left time: 341.4312s
Epoch: 34 cost time: 5.819756984710693
Epoch: 34, Steps: 266 | Train Loss: 0.2166572 Vali Loss: 0.1183912 Test Loss: 0.1662990
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2030157
	speed: 0.0904s/iter; left time: 1578.7456s
	iters: 200, epoch: 35 | loss: 0.1954712
	speed: 0.0301s/iter; left time: 521.6363s
Epoch: 35 cost time: 7.214502334594727
Epoch: 35, Steps: 266 | Train Loss: 0.2167006 Vali Loss: 0.1183721 Test Loss: 0.1662633
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1627875
	speed: 0.1150s/iter; left time: 1977.3923s
	iters: 200, epoch: 36 | loss: 0.1568742
	speed: 0.0285s/iter; left time: 487.5180s
Epoch: 36 cost time: 7.722773790359497
Epoch: 36, Steps: 266 | Train Loss: 0.2165621 Vali Loss: 0.1183770 Test Loss: 0.1663035
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2510104
	speed: 0.1445s/iter; left time: 2445.3398s
	iters: 200, epoch: 37 | loss: 0.2290008
	speed: 0.0285s/iter; left time: 480.3304s
Epoch: 37 cost time: 9.734124183654785
Epoch: 37, Steps: 266 | Train Loss: 0.2165539 Vali Loss: 0.1183769 Test Loss: 0.1662624
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2505476
	speed: 0.1758s/iter; left time: 2929.0317s
	iters: 200, epoch: 38 | loss: 0.2691591
	speed: 0.0310s/iter; left time: 512.8358s
Epoch: 38 cost time: 10.947766065597534
Epoch: 38, Steps: 266 | Train Loss: 0.2164195 Vali Loss: 0.1183565 Test Loss: 0.1662698
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2138274
	speed: 0.1210s/iter; left time: 1983.8771s
	iters: 200, epoch: 39 | loss: 0.1658415
	speed: 0.0273s/iter; left time: 444.0179s
Epoch: 39 cost time: 6.752786159515381
Epoch: 39, Steps: 266 | Train Loss: 0.2165561 Vali Loss: 0.1183523 Test Loss: 0.1662815
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2407415
	speed: 0.1220s/iter; left time: 1968.2966s
	iters: 200, epoch: 40 | loss: 0.1732756
	speed: 0.0319s/iter; left time: 511.6119s
Epoch: 40 cost time: 8.368051528930664
Epoch: 40, Steps: 266 | Train Loss: 0.2166602 Vali Loss: 0.1183723 Test Loss: 0.1662792
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1722821
	speed: 0.1087s/iter; left time: 1724.3962s
	iters: 200, epoch: 41 | loss: 0.1976229
	speed: 0.0383s/iter; left time: 602.9666s
Epoch: 41 cost time: 9.375228881835938
Epoch: 41, Steps: 266 | Train Loss: 0.2165536 Vali Loss: 0.1184115 Test Loss: 0.1662620
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1817043
	speed: 0.1483s/iter; left time: 2312.5904s
	iters: 200, epoch: 42 | loss: 0.2116190
	speed: 0.0185s/iter; left time: 286.4376s
Epoch: 42 cost time: 7.881845474243164
Epoch: 42, Steps: 266 | Train Loss: 0.2163399 Vali Loss: 0.1183352 Test Loss: 0.1662120
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1819653
	speed: 0.1692s/iter; left time: 2593.9187s
	iters: 200, epoch: 43 | loss: 0.2262348
	speed: 0.0283s/iter; left time: 430.8984s
Epoch: 43 cost time: 10.690601110458374
Epoch: 43, Steps: 266 | Train Loss: 0.2164418 Vali Loss: 0.1183119 Test Loss: 0.1662317
Validation loss decreased (0.118317 --> 0.118312).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2365017
	speed: 0.1580s/iter; left time: 2379.7976s
	iters: 200, epoch: 44 | loss: 0.1433554
	speed: 0.0205s/iter; left time: 305.9968s
Epoch: 44 cost time: 6.9617018699646
Epoch: 44, Steps: 266 | Train Loss: 0.2161676 Vali Loss: 0.1184257 Test Loss: 0.1662317
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1760194
	speed: 0.1352s/iter; left time: 2001.0352s
	iters: 200, epoch: 45 | loss: 0.1774897
	speed: 0.0238s/iter; left time: 350.2778s
Epoch: 45 cost time: 6.76359486579895
Epoch: 45, Steps: 266 | Train Loss: 0.2165346 Vali Loss: 0.1183661 Test Loss: 0.1662404
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2484807
	speed: 0.0824s/iter; left time: 1197.3591s
	iters: 200, epoch: 46 | loss: 0.1998434
	speed: 0.0258s/iter; left time: 371.8512s
Epoch: 46 cost time: 5.97019624710083
Epoch: 46, Steps: 266 | Train Loss: 0.2164691 Vali Loss: 0.1183456 Test Loss: 0.1662613
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2400742
	speed: 0.1710s/iter; left time: 2439.3823s
	iters: 200, epoch: 47 | loss: 0.2223390
	speed: 0.0465s/iter; left time: 659.3512s
Epoch: 47 cost time: 11.50186538696289
Epoch: 47, Steps: 266 | Train Loss: 0.2164238 Vali Loss: 0.1183645 Test Loss: 0.1662364
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2929273
	speed: 0.1236s/iter; left time: 1730.4607s
	iters: 200, epoch: 48 | loss: 0.1826319
	speed: 0.0284s/iter; left time: 394.7451s
Epoch: 48 cost time: 8.64078974723816
Epoch: 48, Steps: 266 | Train Loss: 0.2164725 Vali Loss: 0.1183677 Test Loss: 0.1662413
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1679820
	speed: 0.1439s/iter; left time: 1976.7689s
	iters: 200, epoch: 49 | loss: 0.2467114
	speed: 0.0418s/iter; left time: 569.2715s
Epoch: 49 cost time: 9.217812299728394
Epoch: 49, Steps: 266 | Train Loss: 0.2164095 Vali Loss: 0.1182878 Test Loss: 0.1662277
Validation loss decreased (0.118312 --> 0.118288).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1658334
	speed: 0.1274s/iter; left time: 1715.9636s
	iters: 200, epoch: 50 | loss: 0.2059579
	speed: 0.0200s/iter; left time: 267.4385s
Epoch: 50 cost time: 6.933637619018555
Epoch: 50, Steps: 266 | Train Loss: 0.2163054 Vali Loss: 0.1183821 Test Loss: 0.1662250
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1529385
	speed: 0.1194s/iter; left time: 1576.2894s
	iters: 200, epoch: 51 | loss: 0.2343443
	speed: 0.0332s/iter; left time: 434.4246s
Epoch: 51 cost time: 7.4591357707977295
Epoch: 51, Steps: 266 | Train Loss: 0.2162706 Vali Loss: 0.1183962 Test Loss: 0.1662217
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2240241
	speed: 0.1127s/iter; left time: 1457.1424s
	iters: 200, epoch: 52 | loss: 0.1860428
	speed: 0.0253s/iter; left time: 325.0251s
Epoch: 52 cost time: 8.535640716552734
Epoch: 52, Steps: 266 | Train Loss: 0.2163623 Vali Loss: 0.1183072 Test Loss: 0.1662026
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.3057984
	speed: 0.1468s/iter; left time: 1859.2275s
	iters: 200, epoch: 53 | loss: 0.1960540
	speed: 0.0254s/iter; left time: 319.7715s
Epoch: 53 cost time: 10.053242683410645
Epoch: 53, Steps: 266 | Train Loss: 0.2162477 Vali Loss: 0.1183772 Test Loss: 0.1661915
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2264245
	speed: 0.1420s/iter; left time: 1760.9734s
	iters: 200, epoch: 54 | loss: 0.1993000
	speed: 0.0362s/iter; left time: 444.7976s
Epoch: 54 cost time: 9.52415418624878
Epoch: 54, Steps: 266 | Train Loss: 0.2163186 Vali Loss: 0.1183426 Test Loss: 0.1661980
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2416352
	speed: 0.1641s/iter; left time: 1991.6001s
	iters: 200, epoch: 55 | loss: 0.2147370
	speed: 0.0271s/iter; left time: 325.8758s
Epoch: 55 cost time: 8.668761491775513
Epoch: 55, Steps: 266 | Train Loss: 0.2164006 Vali Loss: 0.1183620 Test Loss: 0.1661913
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1862502
	speed: 0.1292s/iter; left time: 1533.6657s
	iters: 200, epoch: 56 | loss: 0.1990992
	speed: 0.0177s/iter; left time: 208.4630s
Epoch: 56 cost time: 5.673502206802368
Epoch: 56, Steps: 266 | Train Loss: 0.2161958 Vali Loss: 0.1184146 Test Loss: 0.1661924
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1898055
	speed: 0.0935s/iter; left time: 1084.5388s
	iters: 200, epoch: 57 | loss: 0.1584178
	speed: 0.0153s/iter; left time: 175.9195s
Epoch: 57 cost time: 5.50178074836731
Epoch: 57, Steps: 266 | Train Loss: 0.2163466 Vali Loss: 0.1183222 Test Loss: 0.1661989
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2241602
	speed: 0.1023s/iter; left time: 1160.4092s
	iters: 200, epoch: 58 | loss: 0.1715848
	speed: 0.0304s/iter; left time: 341.7733s
Epoch: 58 cost time: 7.133634805679321
Epoch: 58, Steps: 266 | Train Loss: 0.2163062 Vali Loss: 0.1183037 Test Loss: 0.1662007
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2921526
	speed: 0.0895s/iter; left time: 990.5547s
	iters: 200, epoch: 59 | loss: 0.1852586
	speed: 0.0321s/iter; left time: 352.5650s
Epoch: 59 cost time: 7.4713990688323975
Epoch: 59, Steps: 266 | Train Loss: 0.2162977 Vali Loss: 0.1183344 Test Loss: 0.1661998
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1731040
	speed: 0.1508s/iter; left time: 1629.2218s
	iters: 200, epoch: 60 | loss: 0.2399417
	speed: 0.0194s/iter; left time: 207.7186s
Epoch: 60 cost time: 8.486389875411987
Epoch: 60, Steps: 266 | Train Loss: 0.2163684 Vali Loss: 0.1183850 Test Loss: 0.1662002
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2189018
	speed: 0.1853s/iter; left time: 1953.6160s
	iters: 200, epoch: 61 | loss: 0.2852146
	speed: 0.0437s/iter; left time: 455.9008s
Epoch: 61 cost time: 12.7528657913208
Epoch: 61, Steps: 266 | Train Loss: 0.2160953 Vali Loss: 0.1184149 Test Loss: 0.1661981
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2768576
	speed: 0.1644s/iter; left time: 1689.5799s
	iters: 200, epoch: 62 | loss: 0.2090618
	speed: 0.0353s/iter; left time: 359.1066s
Epoch: 62 cost time: 9.205439805984497
Epoch: 62, Steps: 266 | Train Loss: 0.2162358 Vali Loss: 0.1183144 Test Loss: 0.1661987
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2118973
	speed: 0.0976s/iter; left time: 976.4754s
	iters: 200, epoch: 63 | loss: 0.2148515
	speed: 0.0271s/iter; left time: 268.1239s
Epoch: 63 cost time: 6.7582573890686035
Epoch: 63, Steps: 266 | Train Loss: 0.2163048 Vali Loss: 0.1183295 Test Loss: 0.1661960
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2319250
	speed: 0.1012s/iter; left time: 986.4053s
	iters: 200, epoch: 64 | loss: 0.1930697
	speed: 0.0280s/iter; left time: 269.5930s
Epoch: 64 cost time: 7.099740982055664
Epoch: 64, Steps: 266 | Train Loss: 0.2163439 Vali Loss: 0.1183214 Test Loss: 0.1662002
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1897408
	speed: 0.1222s/iter; left time: 1158.1784s
	iters: 200, epoch: 65 | loss: 0.2179541
	speed: 0.0204s/iter; left time: 191.3333s
Epoch: 65 cost time: 7.167388916015625
Epoch: 65, Steps: 266 | Train Loss: 0.2160658 Vali Loss: 0.1183309 Test Loss: 0.1661998
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2143631
	speed: 0.1761s/iter; left time: 1622.4571s
	iters: 200, epoch: 66 | loss: 0.2002710
	speed: 0.0177s/iter; left time: 161.1535s
Epoch: 66 cost time: 8.716290473937988
Epoch: 66, Steps: 266 | Train Loss: 0.2162783 Vali Loss: 0.1183580 Test Loss: 0.1661884
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2454376
	speed: 0.1312s/iter; left time: 1173.2737s
	iters: 200, epoch: 67 | loss: 0.2169501
	speed: 0.0264s/iter; left time: 233.3070s
Epoch: 67 cost time: 8.461873292922974
Epoch: 67, Steps: 266 | Train Loss: 0.2163311 Vali Loss: 0.1183935 Test Loss: 0.1661921
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1821053
	speed: 0.1198s/iter; left time: 1039.6510s
	iters: 200, epoch: 68 | loss: 0.2604940
	speed: 0.0293s/iter; left time: 251.4198s
Epoch: 68 cost time: 9.833912372589111
Epoch: 68, Steps: 266 | Train Loss: 0.2162292 Vali Loss: 0.1183289 Test Loss: 0.1661927
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2445693
	speed: 0.1444s/iter; left time: 1215.1661s
	iters: 200, epoch: 69 | loss: 0.2293850
	speed: 0.0320s/iter; left time: 265.9516s
Epoch: 69 cost time: 9.59717869758606
Epoch: 69, Steps: 266 | Train Loss: 0.2162296 Vali Loss: 0.1183076 Test Loss: 0.1661843
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1668170988559723, mae:0.2565762996673584, rse:0.33114367723464966, corr:[0.56454736 0.5678426  0.5684193  0.56723946 0.5656715  0.56443655
 0.56383413 0.56367743 0.56371546 0.56375986 0.56362265 0.563323
 0.56295174 0.5625571  0.56219584 0.56183255 0.5614814  0.5610693
 0.56058687 0.56002384 0.5594581  0.5589856  0.55859864 0.55832523
 0.55807406 0.5577246  0.55727714 0.5567463  0.5561968  0.55565524
 0.5551672  0.5548064  0.55452484 0.5542496  0.55389804 0.55343896
 0.55287397 0.5522395  0.5516217  0.5510601  0.5505453  0.55010015
 0.54963994 0.54910433 0.5484613  0.54765207 0.54677725 0.54591805
 0.54507935 0.54430604 0.54354584 0.5428694  0.5421958  0.5414498
 0.54061705 0.53979814 0.53902966 0.53839326 0.5379288  0.537645
 0.5374673  0.5373531  0.5372414  0.5370562  0.53676647 0.536445
 0.53615206 0.53590393 0.53575677 0.5357297  0.53576493 0.5357802
 0.53569454 0.5354824  0.5351318  0.53463215 0.53407705 0.5334908
 0.5329053  0.53234833 0.5318842  0.53142965 0.5309333  0.53029794
 0.5296158  0.52901864 0.5284678  0.5280159  0.5276647  0.52741534
 0.5272662  0.52717394 0.5269181  0.526491   0.5257947  0.5240183 ]
