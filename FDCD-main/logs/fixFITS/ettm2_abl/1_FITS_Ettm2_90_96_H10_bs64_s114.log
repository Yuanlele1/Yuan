Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=20, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=20, out_features=41, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  734720.0
params:  861.0
Trainable parameters:  861
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2322805
	speed: 0.0160s/iter; left time: 426.5276s
	iters: 200, epoch: 1 | loss: 0.3027494
	speed: 0.0100s/iter; left time: 265.1813s
Epoch: 1 cost time: 3.2988829612731934
Epoch: 1, Steps: 268 | Train Loss: 0.3094768 Vali Loss: 0.1473876 Test Loss: 0.2090647
Validation loss decreased (inf --> 0.147388).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2090820
	speed: 0.0588s/iter; left time: 1554.2679s
	iters: 200, epoch: 2 | loss: 0.2886632
	speed: 0.0098s/iter; left time: 259.1725s
Epoch: 2 cost time: 3.2006783485412598
Epoch: 2, Steps: 268 | Train Loss: 0.2625027 Vali Loss: 0.1359638 Test Loss: 0.1942649
Validation loss decreased (0.147388 --> 0.135964).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2470975
	speed: 0.0572s/iter; left time: 1496.8132s
	iters: 200, epoch: 3 | loss: 0.3083695
	speed: 0.0099s/iter; left time: 257.5008s
Epoch: 3 cost time: 3.164860248565674
Epoch: 3, Steps: 268 | Train Loss: 0.2520256 Vali Loss: 0.1320699 Test Loss: 0.1891622
Validation loss decreased (0.135964 --> 0.132070).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2089371
	speed: 0.0576s/iter; left time: 1491.6688s
	iters: 200, epoch: 4 | loss: 0.1690946
	speed: 0.0099s/iter; left time: 254.2062s
Epoch: 4 cost time: 3.2808382511138916
Epoch: 4, Steps: 268 | Train Loss: 0.2477409 Vali Loss: 0.1307509 Test Loss: 0.1870672
Validation loss decreased (0.132070 --> 0.130751).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2645126
	speed: 0.0584s/iter; left time: 1497.5003s
	iters: 200, epoch: 5 | loss: 0.2414076
	speed: 0.0102s/iter; left time: 260.0704s
Epoch: 5 cost time: 3.3270907402038574
Epoch: 5, Steps: 268 | Train Loss: 0.2457373 Vali Loss: 0.1300402 Test Loss: 0.1859406
Validation loss decreased (0.130751 --> 0.130040).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1517826
	speed: 0.0573s/iter; left time: 1454.2713s
	iters: 200, epoch: 6 | loss: 0.2401667
	speed: 0.0098s/iter; left time: 247.7441s
Epoch: 6 cost time: 3.261446475982666
Epoch: 6, Steps: 268 | Train Loss: 0.2442605 Vali Loss: 0.1296656 Test Loss: 0.1852177
Validation loss decreased (0.130040 --> 0.129666).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2442099
	speed: 0.0561s/iter; left time: 1406.8402s
	iters: 200, epoch: 7 | loss: 0.2026312
	speed: 0.0099s/iter; left time: 247.5106s
Epoch: 7 cost time: 3.3532493114471436
Epoch: 7, Steps: 268 | Train Loss: 0.2430608 Vali Loss: 0.1296241 Test Loss: 0.1849534
Validation loss decreased (0.129666 --> 0.129624).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2920603
	speed: 0.0597s/iter; left time: 1482.7154s
	iters: 200, epoch: 8 | loss: 0.3004358
	speed: 0.0098s/iter; left time: 241.6055s
Epoch: 8 cost time: 3.175942897796631
Epoch: 8, Steps: 268 | Train Loss: 0.2424619 Vali Loss: 0.1294966 Test Loss: 0.1846639
Validation loss decreased (0.129624 --> 0.129497).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1952773
	speed: 0.0573s/iter; left time: 1407.4427s
	iters: 200, epoch: 9 | loss: 0.2221071
	speed: 0.0098s/iter; left time: 239.6706s
Epoch: 9 cost time: 3.2623414993286133
Epoch: 9, Steps: 268 | Train Loss: 0.2422446 Vali Loss: 0.1295080 Test Loss: 0.1845976
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3136643
	speed: 0.0561s/iter; left time: 1363.5881s
	iters: 200, epoch: 10 | loss: 0.1884571
	speed: 0.0098s/iter; left time: 237.0906s
Epoch: 10 cost time: 3.1363461017608643
Epoch: 10, Steps: 268 | Train Loss: 0.2419749 Vali Loss: 0.1297064 Test Loss: 0.1845690
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2258876
	speed: 0.0567s/iter; left time: 1361.7953s
	iters: 200, epoch: 11 | loss: 0.2317304
	speed: 0.0098s/iter; left time: 234.0893s
Epoch: 11 cost time: 3.1521406173706055
Epoch: 11, Steps: 268 | Train Loss: 0.2416181 Vali Loss: 0.1298215 Test Loss: 0.1845801
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2059544
	speed: 0.0568s/iter; left time: 1349.4997s
	iters: 200, epoch: 12 | loss: 0.1753190
	speed: 0.0099s/iter; left time: 233.1562s
Epoch: 12 cost time: 3.2701969146728516
Epoch: 12, Steps: 268 | Train Loss: 0.2415291 Vali Loss: 0.1297291 Test Loss: 0.1844907
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2348827
	speed: 0.0596s/iter; left time: 1399.3620s
	iters: 200, epoch: 13 | loss: 0.1704107
	speed: 0.0101s/iter; left time: 237.2526s
Epoch: 13 cost time: 3.273729085922241
Epoch: 13, Steps: 268 | Train Loss: 0.2414240 Vali Loss: 0.1297199 Test Loss: 0.1844738
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2873432
	speed: 0.0598s/iter; left time: 1388.4301s
	iters: 200, epoch: 14 | loss: 0.2428225
	speed: 0.0099s/iter; left time: 229.5078s
Epoch: 14 cost time: 3.3192360401153564
Epoch: 14, Steps: 268 | Train Loss: 0.2410151 Vali Loss: 0.1296564 Test Loss: 0.1844200
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3052508
	speed: 0.0588s/iter; left time: 1348.8689s
	iters: 200, epoch: 15 | loss: 0.3085142
	speed: 0.0100s/iter; left time: 229.6175s
Epoch: 15 cost time: 3.3042657375335693
Epoch: 15, Steps: 268 | Train Loss: 0.2408902 Vali Loss: 0.1299243 Test Loss: 0.1845292
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4267062
	speed: 0.0595s/iter; left time: 1350.4266s
	iters: 200, epoch: 16 | loss: 0.2100175
	speed: 0.0098s/iter; left time: 221.1255s
Epoch: 16 cost time: 3.1059534549713135
Epoch: 16, Steps: 268 | Train Loss: 0.2411549 Vali Loss: 0.1299462 Test Loss: 0.1844969
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3487944
	speed: 0.0600s/iter; left time: 1344.4005s
	iters: 200, epoch: 17 | loss: 0.1947387
	speed: 0.0098s/iter; left time: 219.3262s
Epoch: 17 cost time: 3.2061305046081543
Epoch: 17, Steps: 268 | Train Loss: 0.2409127 Vali Loss: 0.1299194 Test Loss: 0.1844926
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3351583
	speed: 0.0572s/iter; left time: 1267.7230s
	iters: 200, epoch: 18 | loss: 0.2362740
	speed: 0.0098s/iter; left time: 215.9038s
Epoch: 18 cost time: 3.160113573074341
Epoch: 18, Steps: 268 | Train Loss: 0.2410072 Vali Loss: 0.1298905 Test Loss: 0.1844543
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2288652
	speed: 0.0580s/iter; left time: 1268.0829s
	iters: 200, epoch: 19 | loss: 0.1963337
	speed: 0.0098s/iter; left time: 213.5417s
Epoch: 19 cost time: 3.2649991512298584
Epoch: 19, Steps: 268 | Train Loss: 0.2406659 Vali Loss: 0.1299319 Test Loss: 0.1844502
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2133815
	speed: 0.0594s/iter; left time: 1283.4738s
	iters: 200, epoch: 20 | loss: 0.2268314
	speed: 0.0101s/iter; left time: 216.1670s
Epoch: 20 cost time: 3.2951865196228027
Epoch: 20, Steps: 268 | Train Loss: 0.2409592 Vali Loss: 0.1299454 Test Loss: 0.1844902
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2281158
	speed: 0.0582s/iter; left time: 1241.1253s
	iters: 200, epoch: 21 | loss: 0.2174733
	speed: 0.0106s/iter; left time: 225.3181s
Epoch: 21 cost time: 3.3400144577026367
Epoch: 21, Steps: 268 | Train Loss: 0.2406534 Vali Loss: 0.1299861 Test Loss: 0.1844991
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2750641
	speed: 0.0584s/iter; left time: 1229.7856s
	iters: 200, epoch: 22 | loss: 0.2384346
	speed: 0.0100s/iter; left time: 210.5483s
Epoch: 22 cost time: 3.262648344039917
Epoch: 22, Steps: 268 | Train Loss: 0.2408940 Vali Loss: 0.1299389 Test Loss: 0.1844571
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2567341
	speed: 0.0597s/iter; left time: 1242.7501s
	iters: 200, epoch: 23 | loss: 0.2970202
	speed: 0.0099s/iter; left time: 205.5025s
Epoch: 23 cost time: 3.2945072650909424
Epoch: 23, Steps: 268 | Train Loss: 0.2406992 Vali Loss: 0.1299376 Test Loss: 0.1844176
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2285936
	speed: 0.0608s/iter; left time: 1248.4696s
	iters: 200, epoch: 24 | loss: 0.2462104
	speed: 0.0097s/iter; left time: 199.1930s
Epoch: 24 cost time: 3.1855709552764893
Epoch: 24, Steps: 268 | Train Loss: 0.2403645 Vali Loss: 0.1298271 Test Loss: 0.1844028
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1939285
	speed: 0.0577s/iter; left time: 1169.8543s
	iters: 200, epoch: 25 | loss: 0.2828394
	speed: 0.0098s/iter; left time: 197.4434s
Epoch: 25 cost time: 3.1823697090148926
Epoch: 25, Steps: 268 | Train Loss: 0.2408282 Vali Loss: 0.1299439 Test Loss: 0.1843699
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2371646
	speed: 0.0607s/iter; left time: 1213.6925s
	iters: 200, epoch: 26 | loss: 0.2653882
	speed: 0.0098s/iter; left time: 195.7913s
Epoch: 26 cost time: 3.2909207344055176
Epoch: 26, Steps: 268 | Train Loss: 0.2405157 Vali Loss: 0.1299171 Test Loss: 0.1843867
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2061193
	speed: 0.0609s/iter; left time: 1201.3342s
	iters: 200, epoch: 27 | loss: 0.1910817
	speed: 0.0100s/iter; left time: 196.8449s
Epoch: 27 cost time: 3.2838361263275146
Epoch: 27, Steps: 268 | Train Loss: 0.2407168 Vali Loss: 0.1298791 Test Loss: 0.1844094
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2473129
	speed: 0.0616s/iter; left time: 1199.4842s
	iters: 200, epoch: 28 | loss: 0.4679674
	speed: 0.0102s/iter; left time: 196.8121s
Epoch: 28 cost time: 3.327198028564453
Epoch: 28, Steps: 268 | Train Loss: 0.2405183 Vali Loss: 0.1300371 Test Loss: 0.1844745
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18551473319530487, mae:0.2690454423427582, rse:0.3492089807987213, corr:[0.5697311  0.5722165  0.5642643  0.5610219  0.5625115  0.56194234
 0.55873066 0.55701786 0.55791634 0.5582012  0.5564334  0.554448
 0.55433047 0.5549609  0.554171   0.5522183  0.5511011  0.55128723
 0.55113673 0.54973143 0.54804647 0.5473792  0.54729843 0.5467024
 0.5455323  0.5447935  0.54491    0.5449503  0.5442216  0.54319346
 0.54256284 0.5422761  0.54179966 0.5410624  0.5404687  0.5402201
 0.53982115 0.539016   0.5380749  0.53739357 0.5369425  0.53655666
 0.5360772  0.5356565  0.5353933  0.5350046  0.5344003  0.5336241
 0.5329288  0.5322537  0.53140575 0.53041875 0.52958065 0.52902585
 0.5286178  0.5280636  0.52728814 0.52666646 0.5263331  0.5262299
 0.52597713 0.52559483 0.52543175 0.52558416 0.5257082  0.5255312
 0.525207   0.5249221  0.5248902  0.52498156 0.5250376  0.5250949
 0.52518314 0.525328   0.5252912  0.5250886  0.52493596 0.5249045
 0.5248508  0.52467984 0.5244693  0.52434814 0.5242993  0.5241104
 0.5237699  0.523496   0.5234203  0.52340126 0.52321225 0.5228515
 0.5228256  0.5229511  0.5228199  0.52238077 0.52224374 0.5206378 ]
