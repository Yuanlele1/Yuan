Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=42, out_features=61, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2295552.0
params:  2623.0
Trainable parameters:  2623
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3633243
	speed: 0.0779s/iter; left time: 2024.8515s
	iters: 200, epoch: 1 | loss: 0.3173249
	speed: 0.0742s/iter; left time: 1922.6803s
Epoch: 1 cost time: 19.80861783027649
Epoch: 1, Steps: 261 | Train Loss: 0.4673755 Vali Loss: 0.2127369 Test Loss: 0.2891728
Validation loss decreased (inf --> 0.212737).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2708313
	speed: 0.3109s/iter; left time: 8002.9774s
	iters: 200, epoch: 2 | loss: 0.4611128
	speed: 0.0676s/iter; left time: 1733.4143s
Epoch: 2 cost time: 18.975513458251953
Epoch: 2, Steps: 261 | Train Loss: 0.4067519 Vali Loss: 0.2041605 Test Loss: 0.2803681
Validation loss decreased (0.212737 --> 0.204160).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3649385
	speed: 0.3018s/iter; left time: 7689.4553s
	iters: 200, epoch: 3 | loss: 0.4598897
	speed: 0.0717s/iter; left time: 1818.5585s
Epoch: 3 cost time: 19.048089265823364
Epoch: 3, Steps: 261 | Train Loss: 0.3962550 Vali Loss: 0.2012957 Test Loss: 0.2769354
Validation loss decreased (0.204160 --> 0.201296).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3804453
	speed: 0.3075s/iter; left time: 7755.6909s
	iters: 200, epoch: 4 | loss: 0.4510267
	speed: 0.0728s/iter; left time: 1828.8592s
Epoch: 4 cost time: 19.685125827789307
Epoch: 4, Steps: 261 | Train Loss: 0.3917448 Vali Loss: 0.1993818 Test Loss: 0.2746011
Validation loss decreased (0.201296 --> 0.199382).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3574992
	speed: 0.3081s/iter; left time: 7690.4354s
	iters: 200, epoch: 5 | loss: 0.2428689
	speed: 0.0682s/iter; left time: 1695.8929s
Epoch: 5 cost time: 18.81769871711731
Epoch: 5, Steps: 261 | Train Loss: 0.3884968 Vali Loss: 0.1984026 Test Loss: 0.2735868
Validation loss decreased (0.199382 --> 0.198403).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.5458500
	speed: 0.3087s/iter; left time: 7624.6519s
	iters: 200, epoch: 6 | loss: 0.4332936
	speed: 0.0647s/iter; left time: 1591.7410s
Epoch: 6 cost time: 18.452714204788208
Epoch: 6, Steps: 261 | Train Loss: 0.3866146 Vali Loss: 0.1972455 Test Loss: 0.2723592
Validation loss decreased (0.198403 --> 0.197245).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.6395773
	speed: 0.3137s/iter; left time: 7665.3543s
	iters: 200, epoch: 7 | loss: 0.3828778
	speed: 0.0720s/iter; left time: 1752.6517s
Epoch: 7 cost time: 19.18083691596985
Epoch: 7, Steps: 261 | Train Loss: 0.3847842 Vali Loss: 0.1971790 Test Loss: 0.2720653
Validation loss decreased (0.197245 --> 0.197179).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2846084
	speed: 0.3049s/iter; left time: 7370.4727s
	iters: 200, epoch: 8 | loss: 0.3850048
	speed: 0.0703s/iter; left time: 1692.3108s
Epoch: 8 cost time: 19.14835810661316
Epoch: 8, Steps: 261 | Train Loss: 0.3843283 Vali Loss: 0.1968644 Test Loss: 0.2716246
Validation loss decreased (0.197179 --> 0.196864).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2527721
	speed: 0.3127s/iter; left time: 7477.5574s
	iters: 200, epoch: 9 | loss: 0.2734915
	speed: 0.0702s/iter; left time: 1672.3940s
Epoch: 9 cost time: 19.0193350315094
Epoch: 9, Steps: 261 | Train Loss: 0.3836478 Vali Loss: 0.1968413 Test Loss: 0.2715037
Validation loss decreased (0.196864 --> 0.196841).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3461192
	speed: 0.3027s/iter; left time: 7159.5578s
	iters: 200, epoch: 10 | loss: 0.4419799
	speed: 0.0728s/iter; left time: 1713.7126s
Epoch: 10 cost time: 19.374239921569824
Epoch: 10, Steps: 261 | Train Loss: 0.3826887 Vali Loss: 0.1961621 Test Loss: 0.2710134
Validation loss decreased (0.196841 --> 0.196162).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3829240
	speed: 0.3065s/iter; left time: 7169.7212s
	iters: 200, epoch: 11 | loss: 0.6134841
	speed: 0.0727s/iter; left time: 1694.3779s
Epoch: 11 cost time: 19.508084297180176
Epoch: 11, Steps: 261 | Train Loss: 0.3821276 Vali Loss: 0.1963507 Test Loss: 0.2709615
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3788069
	speed: 0.3165s/iter; left time: 7320.5717s
	iters: 200, epoch: 12 | loss: 0.4111173
	speed: 0.0701s/iter; left time: 1614.3248s
Epoch: 12 cost time: 18.8074688911438
Epoch: 12, Steps: 261 | Train Loss: 0.3818180 Vali Loss: 0.1959043 Test Loss: 0.2708932
Validation loss decreased (0.196162 --> 0.195904).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2395776
	speed: 0.2948s/iter; left time: 6741.4650s
	iters: 200, epoch: 13 | loss: 0.5799421
	speed: 0.0669s/iter; left time: 1522.8277s
Epoch: 13 cost time: 18.67870593070984
Epoch: 13, Steps: 261 | Train Loss: 0.3815046 Vali Loss: 0.1960550 Test Loss: 0.2707894
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.4113671
	speed: 0.2942s/iter; left time: 6650.1796s
	iters: 200, epoch: 14 | loss: 0.4127118
	speed: 0.0695s/iter; left time: 1565.0906s
Epoch: 14 cost time: 18.933408498764038
Epoch: 14, Steps: 261 | Train Loss: 0.3811472 Vali Loss: 0.1959982 Test Loss: 0.2706766
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.6155044
	speed: 0.3196s/iter; left time: 7141.1117s
	iters: 200, epoch: 15 | loss: 0.2536008
	speed: 0.0724s/iter; left time: 1609.7957s
Epoch: 15 cost time: 19.552844524383545
Epoch: 15, Steps: 261 | Train Loss: 0.3810438 Vali Loss: 0.1960646 Test Loss: 0.2706340
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3679330
	speed: 0.3152s/iter; left time: 6961.8090s
	iters: 200, epoch: 16 | loss: 0.5360923
	speed: 0.0700s/iter; left time: 1539.7549s
Epoch: 16 cost time: 19.095041751861572
Epoch: 16, Steps: 261 | Train Loss: 0.3810757 Vali Loss: 0.1958132 Test Loss: 0.2704267
Validation loss decreased (0.195904 --> 0.195813).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2491666
	speed: 0.3030s/iter; left time: 6613.6125s
	iters: 200, epoch: 17 | loss: 0.5224760
	speed: 0.0692s/iter; left time: 1502.8991s
Epoch: 17 cost time: 19.193403482437134
Epoch: 17, Steps: 261 | Train Loss: 0.3808431 Vali Loss: 0.1957536 Test Loss: 0.2703775
Validation loss decreased (0.195813 --> 0.195754).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.5267785
	speed: 0.3157s/iter; left time: 6807.6997s
	iters: 200, epoch: 18 | loss: 0.3227015
	speed: 0.0689s/iter; left time: 1479.0414s
Epoch: 18 cost time: 19.139073610305786
Epoch: 18, Steps: 261 | Train Loss: 0.3807466 Vali Loss: 0.1958913 Test Loss: 0.2705353
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4013911
	speed: 0.3178s/iter; left time: 6769.1388s
	iters: 200, epoch: 19 | loss: 0.4328642
	speed: 0.0713s/iter; left time: 1512.3288s
Epoch: 19 cost time: 19.188115119934082
Epoch: 19, Steps: 261 | Train Loss: 0.3810129 Vali Loss: 0.1957737 Test Loss: 0.2703842
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3469846
	speed: 0.3086s/iter; left time: 6494.1628s
	iters: 200, epoch: 20 | loss: 0.3938819
	speed: 0.0718s/iter; left time: 1504.1770s
Epoch: 20 cost time: 19.250032424926758
Epoch: 20, Steps: 261 | Train Loss: 0.3802950 Vali Loss: 0.1957076 Test Loss: 0.2702871
Validation loss decreased (0.195754 --> 0.195708).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.5119771
	speed: 0.3003s/iter; left time: 6241.1493s
	iters: 200, epoch: 21 | loss: 0.4083936
	speed: 0.0687s/iter; left time: 1420.4599s
Epoch: 21 cost time: 18.72068977355957
Epoch: 21, Steps: 261 | Train Loss: 0.3807187 Vali Loss: 0.1955748 Test Loss: 0.2703468
Validation loss decreased (0.195708 --> 0.195575).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3137338
	speed: 0.3141s/iter; left time: 6445.7870s
	iters: 200, epoch: 22 | loss: 0.3513382
	speed: 0.0708s/iter; left time: 1445.2872s
Epoch: 22 cost time: 19.58802556991577
Epoch: 22, Steps: 261 | Train Loss: 0.3801362 Vali Loss: 0.1956820 Test Loss: 0.2702072
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3729084
	speed: 0.3088s/iter; left time: 6255.1894s
	iters: 200, epoch: 23 | loss: 0.2434871
	speed: 0.0650s/iter; left time: 1310.6719s
Epoch: 23 cost time: 18.63899517059326
Epoch: 23, Steps: 261 | Train Loss: 0.3801964 Vali Loss: 0.1955511 Test Loss: 0.2701384
Validation loss decreased (0.195575 --> 0.195551).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2489949
	speed: 0.3014s/iter; left time: 6026.7215s
	iters: 200, epoch: 24 | loss: 0.3072914
	speed: 0.0691s/iter; left time: 1374.7633s
Epoch: 24 cost time: 19.151896476745605
Epoch: 24, Steps: 261 | Train Loss: 0.3801015 Vali Loss: 0.1956937 Test Loss: 0.2703120
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4763353
	speed: 0.3179s/iter; left time: 6273.9807s
	iters: 200, epoch: 25 | loss: 0.4511296
	speed: 0.0702s/iter; left time: 1378.5884s
Epoch: 25 cost time: 19.52602744102478
Epoch: 25, Steps: 261 | Train Loss: 0.3802273 Vali Loss: 0.1956447 Test Loss: 0.2702039
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.4153610
	speed: 0.3184s/iter; left time: 6201.5439s
	iters: 200, epoch: 26 | loss: 0.3519011
	speed: 0.0685s/iter; left time: 1327.3008s
Epoch: 26 cost time: 18.41892695426941
Epoch: 26, Steps: 261 | Train Loss: 0.3803123 Vali Loss: 0.1956072 Test Loss: 0.2701844
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3324930
	speed: 0.3055s/iter; left time: 5870.7852s
	iters: 200, epoch: 27 | loss: 0.5088526
	speed: 0.0711s/iter; left time: 1358.6113s
Epoch: 27 cost time: 18.732016801834106
Epoch: 27, Steps: 261 | Train Loss: 0.3801578 Vali Loss: 0.1956406 Test Loss: 0.2701183
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.4113128
	speed: 0.2918s/iter; left time: 5530.7246s
	iters: 200, epoch: 28 | loss: 0.2811844
	speed: 0.0668s/iter; left time: 1259.3674s
Epoch: 28 cost time: 19.114997625350952
Epoch: 28, Steps: 261 | Train Loss: 0.3799236 Vali Loss: 0.1956725 Test Loss: 0.2700691
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3199405
	speed: 0.3025s/iter; left time: 5653.7830s
	iters: 200, epoch: 29 | loss: 0.5448565
	speed: 0.0693s/iter; left time: 1288.8444s
Epoch: 29 cost time: 19.06671977043152
Epoch: 29, Steps: 261 | Train Loss: 0.3797133 Vali Loss: 0.1954767 Test Loss: 0.2701826
Validation loss decreased (0.195551 --> 0.195477).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4314175
	speed: 0.3155s/iter; left time: 5815.5633s
	iters: 200, epoch: 30 | loss: 0.3501118
	speed: 0.0706s/iter; left time: 1294.2978s
Epoch: 30 cost time: 19.34801459312439
Epoch: 30, Steps: 261 | Train Loss: 0.3800653 Vali Loss: 0.1955867 Test Loss: 0.2700827
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.4247732
	speed: 0.3148s/iter; left time: 5720.8964s
	iters: 200, epoch: 31 | loss: 0.4537174
	speed: 0.0684s/iter; left time: 1235.8993s
Epoch: 31 cost time: 18.94353222846985
Epoch: 31, Steps: 261 | Train Loss: 0.3798273 Vali Loss: 0.1955768 Test Loss: 0.2701289
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2789958
	speed: 0.3013s/iter; left time: 5395.7229s
	iters: 200, epoch: 32 | loss: 0.2948704
	speed: 0.0712s/iter; left time: 1268.5864s
Epoch: 32 cost time: 19.516604900360107
Epoch: 32, Steps: 261 | Train Loss: 0.3791441 Vali Loss: 0.1954724 Test Loss: 0.2700318
Validation loss decreased (0.195477 --> 0.195472).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.4233845
	speed: 0.3165s/iter; left time: 5586.3707s
	iters: 200, epoch: 33 | loss: 0.3502109
	speed: 0.0705s/iter; left time: 1237.0665s
Epoch: 33 cost time: 19.423710107803345
Epoch: 33, Steps: 261 | Train Loss: 0.3793862 Vali Loss: 0.1955712 Test Loss: 0.2700794
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3757986
	speed: 0.3029s/iter; left time: 5266.2651s
	iters: 200, epoch: 34 | loss: 0.4226603
	speed: 0.0745s/iter; left time: 1287.1559s
Epoch: 34 cost time: 19.18935799598694
Epoch: 34, Steps: 261 | Train Loss: 0.3799331 Vali Loss: 0.1956188 Test Loss: 0.2700452
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3374626
	speed: 0.3037s/iter; left time: 5201.4006s
	iters: 200, epoch: 35 | loss: 0.5003896
	speed: 0.0699s/iter; left time: 1190.9747s
Epoch: 35 cost time: 19.141764163970947
Epoch: 35, Steps: 261 | Train Loss: 0.3796640 Vali Loss: 0.1955133 Test Loss: 0.2700821
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.4812424
	speed: 0.3091s/iter; left time: 5213.6776s
	iters: 200, epoch: 36 | loss: 0.3354740
	speed: 0.0730s/iter; left time: 1224.6477s
Epoch: 36 cost time: 19.53154945373535
Epoch: 36, Steps: 261 | Train Loss: 0.3796635 Vali Loss: 0.1954324 Test Loss: 0.2700271
Validation loss decreased (0.195472 --> 0.195432).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.4082890
	speed: 0.3335s/iter; left time: 5536.9494s
	iters: 200, epoch: 37 | loss: 0.3669682
	speed: 0.0733s/iter; left time: 1209.2901s
Epoch: 37 cost time: 20.257957935333252
Epoch: 37, Steps: 261 | Train Loss: 0.3794898 Vali Loss: 0.1955047 Test Loss: 0.2700695
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.5253893
	speed: 0.3303s/iter; left time: 5398.4603s
	iters: 200, epoch: 38 | loss: 0.3484291
	speed: 0.0724s/iter; left time: 1175.3095s
Epoch: 38 cost time: 20.04159116744995
Epoch: 38, Steps: 261 | Train Loss: 0.3797400 Vali Loss: 0.1956224 Test Loss: 0.2701116
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.4816827
	speed: 0.3302s/iter; left time: 5310.8607s
	iters: 200, epoch: 39 | loss: 0.2960342
	speed: 0.0651s/iter; left time: 1040.3884s
Epoch: 39 cost time: 19.52179479598999
Epoch: 39, Steps: 261 | Train Loss: 0.3795866 Vali Loss: 0.1953598 Test Loss: 0.2700595
Validation loss decreased (0.195432 --> 0.195360).  Saving model ...
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.5099878
	speed: 0.3411s/iter; left time: 5397.2899s
	iters: 200, epoch: 40 | loss: 0.2934285
	speed: 0.0748s/iter; left time: 1176.7591s
Epoch: 40 cost time: 20.95147681236267
Epoch: 40, Steps: 261 | Train Loss: 0.3796357 Vali Loss: 0.1955389 Test Loss: 0.2700548
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.4726294
	speed: 0.3370s/iter; left time: 5244.7401s
	iters: 200, epoch: 41 | loss: 0.3488060
	speed: 0.0692s/iter; left time: 1069.7653s
Epoch: 41 cost time: 19.743818283081055
Epoch: 41, Steps: 261 | Train Loss: 0.3795412 Vali Loss: 0.1954526 Test Loss: 0.2700378
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.4020330
	speed: 0.3278s/iter; left time: 5015.7438s
	iters: 200, epoch: 42 | loss: 0.6400232
	speed: 0.0762s/iter; left time: 1158.8110s
Epoch: 42 cost time: 20.32847023010254
Epoch: 42, Steps: 261 | Train Loss: 0.3794383 Vali Loss: 0.1953474 Test Loss: 0.2700461
Validation loss decreased (0.195360 --> 0.195347).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3235208
	speed: 0.3303s/iter; left time: 4966.6569s
	iters: 200, epoch: 43 | loss: 0.3375840
	speed: 0.0770s/iter; left time: 1150.0836s
Epoch: 43 cost time: 20.892273426055908
Epoch: 43, Steps: 261 | Train Loss: 0.3793701 Vali Loss: 0.1952109 Test Loss: 0.2700387
Validation loss decreased (0.195347 --> 0.195211).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3479661
	speed: 0.3408s/iter; left time: 5035.6662s
	iters: 200, epoch: 44 | loss: 0.3049869
	speed: 0.0762s/iter; left time: 1119.0873s
Epoch: 44 cost time: 20.69170594215393
Epoch: 44, Steps: 261 | Train Loss: 0.3794163 Vali Loss: 0.1954458 Test Loss: 0.2700157
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.3683232
	speed: 0.3321s/iter; left time: 4821.3836s
	iters: 200, epoch: 45 | loss: 0.5290293
	speed: 0.0737s/iter; left time: 1062.7995s
Epoch: 45 cost time: 20.079485177993774
Epoch: 45, Steps: 261 | Train Loss: 0.3796056 Vali Loss: 0.1954012 Test Loss: 0.2699960
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2268198
	speed: 0.3276s/iter; left time: 4669.6256s
	iters: 200, epoch: 46 | loss: 0.3362645
	speed: 0.0708s/iter; left time: 1001.9627s
Epoch: 46 cost time: 19.72103214263916
Epoch: 46, Steps: 261 | Train Loss: 0.3795594 Vali Loss: 0.1954637 Test Loss: 0.2700334
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3660317
	speed: 0.3209s/iter; left time: 4491.3493s
	iters: 200, epoch: 47 | loss: 0.2634947
	speed: 0.0768s/iter; left time: 1066.5311s
Epoch: 47 cost time: 20.560524225234985
Epoch: 47, Steps: 261 | Train Loss: 0.3794468 Vali Loss: 0.1955743 Test Loss: 0.2700301
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3980797
	speed: 0.3279s/iter; left time: 4503.6198s
	iters: 200, epoch: 48 | loss: 0.3127669
	speed: 0.0747s/iter; left time: 1018.2291s
Epoch: 48 cost time: 20.20561647415161
Epoch: 48, Steps: 261 | Train Loss: 0.3785973 Vali Loss: 0.1954085 Test Loss: 0.2699879
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2926779
	speed: 0.3258s/iter; left time: 4389.7743s
	iters: 200, epoch: 49 | loss: 0.5614508
	speed: 0.0772s/iter; left time: 1031.9968s
Epoch: 49 cost time: 20.37043833732605
Epoch: 49, Steps: 261 | Train Loss: 0.3795572 Vali Loss: 0.1953540 Test Loss: 0.2699987
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.4237508
	speed: 0.3324s/iter; left time: 4391.0862s
	iters: 200, epoch: 50 | loss: 0.3934023
	speed: 0.0745s/iter; left time: 976.9332s
Epoch: 50 cost time: 20.150670289993286
Epoch: 50, Steps: 261 | Train Loss: 0.3796270 Vali Loss: 0.1953440 Test Loss: 0.2699816
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.4318615
	speed: 0.3303s/iter; left time: 4277.7412s
	iters: 200, epoch: 51 | loss: 0.3353857
	speed: 0.0785s/iter; left time: 1009.1817s
Epoch: 51 cost time: 20.791610717773438
Epoch: 51, Steps: 261 | Train Loss: 0.3790003 Vali Loss: 0.1953516 Test Loss: 0.2699898
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2600005
	speed: 0.3330s/iter; left time: 4225.4017s
	iters: 200, epoch: 52 | loss: 0.4599262
	speed: 0.0777s/iter; left time: 978.0353s
Epoch: 52 cost time: 20.38470768928528
Epoch: 52, Steps: 261 | Train Loss: 0.3796697 Vali Loss: 0.1952266 Test Loss: 0.2700029
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.3569864
	speed: 0.3301s/iter; left time: 4103.4104s
	iters: 200, epoch: 53 | loss: 0.3359770
	speed: 0.0760s/iter; left time: 936.5142s
Epoch: 53 cost time: 20.356685400009155
Epoch: 53, Steps: 261 | Train Loss: 0.3795570 Vali Loss: 0.1955384 Test Loss: 0.2700081
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.3490017
	speed: 0.3274s/iter; left time: 3983.6181s
	iters: 200, epoch: 54 | loss: 0.4044372
	speed: 0.0716s/iter; left time: 864.5397s
Epoch: 54 cost time: 19.78008723258972
Epoch: 54, Steps: 261 | Train Loss: 0.3794730 Vali Loss: 0.1954069 Test Loss: 0.2700003
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.3972177
	speed: 0.3337s/iter; left time: 3973.6973s
	iters: 200, epoch: 55 | loss: 0.4035537
	speed: 0.0781s/iter; left time: 921.8433s
Epoch: 55 cost time: 20.742791175842285
Epoch: 55, Steps: 261 | Train Loss: 0.3792981 Vali Loss: 0.1953022 Test Loss: 0.2699741
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.4172429
	speed: 0.3347s/iter; left time: 3898.0242s
	iters: 200, epoch: 56 | loss: 0.3715956
	speed: 0.0746s/iter; left time: 861.6732s
Epoch: 56 cost time: 20.25491714477539
Epoch: 56, Steps: 261 | Train Loss: 0.3794722 Vali Loss: 0.1954741 Test Loss: 0.2699837
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3867704
	speed: 0.3355s/iter; left time: 3819.4038s
	iters: 200, epoch: 57 | loss: 0.3723133
	speed: 0.0753s/iter; left time: 849.2927s
Epoch: 57 cost time: 20.517704010009766
Epoch: 57, Steps: 261 | Train Loss: 0.3792352 Vali Loss: 0.1953299 Test Loss: 0.2699682
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.4240283
	speed: 0.3278s/iter; left time: 3646.3640s
	iters: 200, epoch: 58 | loss: 0.3383451
	speed: 0.0714s/iter; left time: 787.0015s
Epoch: 58 cost time: 19.484301805496216
Epoch: 58, Steps: 261 | Train Loss: 0.3792044 Vali Loss: 0.1953467 Test Loss: 0.2699763
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.4194911
	speed: 0.3305s/iter; left time: 3589.7845s
	iters: 200, epoch: 59 | loss: 0.3022937
	speed: 0.0764s/iter; left time: 822.8252s
Epoch: 59 cost time: 20.84465789794922
Epoch: 59, Steps: 261 | Train Loss: 0.3793029 Vali Loss: 0.1953908 Test Loss: 0.2699746
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.6149703
	speed: 0.3314s/iter; left time: 3513.4079s
	iters: 200, epoch: 60 | loss: 0.3877428
	speed: 0.0748s/iter; left time: 785.1364s
Epoch: 60 cost time: 20.082054138183594
Epoch: 60, Steps: 261 | Train Loss: 0.3786668 Vali Loss: 0.1954096 Test Loss: 0.2699644
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.3516640
	speed: 0.3240s/iter; left time: 3350.8064s
	iters: 200, epoch: 61 | loss: 0.3519430
	speed: 0.0767s/iter; left time: 785.9024s
Epoch: 61 cost time: 20.068102836608887
Epoch: 61, Steps: 261 | Train Loss: 0.3789064 Vali Loss: 0.1953484 Test Loss: 0.2699757
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3307593
	speed: 0.3312s/iter; left time: 3338.3469s
	iters: 200, epoch: 62 | loss: 0.4257270
	speed: 0.0735s/iter; left time: 733.9088s
Epoch: 62 cost time: 20.166768074035645
Epoch: 62, Steps: 261 | Train Loss: 0.3793693 Vali Loss: 0.1954825 Test Loss: 0.2699750
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.4594513
	speed: 0.3339s/iter; left time: 3278.1673s
	iters: 200, epoch: 63 | loss: 0.3287494
	speed: 0.0758s/iter; left time: 736.6292s
Epoch: 63 cost time: 20.840094327926636
Epoch: 63, Steps: 261 | Train Loss: 0.3791018 Vali Loss: 0.1953304 Test Loss: 0.2699610
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.27106115221977234, mae:0.32839348912239075, rse:0.4205273687839508, corr:[0.54717225 0.5496376  0.5517351  0.55292034 0.55315965 0.55275685
 0.5520312  0.55121005 0.5504768  0.54993874 0.549616   0.5494741
 0.54948056 0.54953897 0.54961383 0.5495849  0.5494122  0.54909873
 0.54863364 0.5480189  0.5473127  0.54655516 0.54580486 0.54513556
 0.5445401  0.5440198  0.54357153 0.5431861  0.5428452  0.5425292
 0.5422002  0.5418952  0.54158723 0.54121083 0.5407355  0.5401911
 0.5395758  0.5389341  0.538278   0.5376188  0.53697324 0.5363276
 0.5356856  0.53504246 0.5344105  0.5337908  0.53320646 0.53267586
 0.53215516 0.53159946 0.53098285 0.53034735 0.529689   0.5290128
 0.5283312  0.5277091  0.5271419  0.52663    0.5261841  0.525809
 0.525495   0.52527016 0.52512795 0.5250305  0.5249476  0.52488154
 0.5247925  0.52468324 0.5245573  0.5243946  0.52415794 0.52383626
 0.5234127  0.5229077  0.52231723 0.5216766  0.5210093  0.52033496
 0.5196709  0.5190719  0.5185051  0.51800334 0.5175571  0.5171619
 0.5168177  0.5165081  0.5161781  0.51580083 0.51534295 0.51477975
 0.5141153  0.5133621  0.5124606  0.51140976 0.51022816 0.50891316
 0.507522   0.5061691  0.504867   0.50361973 0.5024349  0.50130844
 0.50023705 0.4991817  0.49814975 0.49710852 0.49609125 0.49513465
 0.49423653 0.4933742  0.49253997 0.49171618 0.49095252 0.4902305
 0.4895019  0.4887809  0.48809057 0.48739463 0.48670977 0.48597246
 0.48520514 0.48437107 0.48351288 0.4826176  0.48166537 0.4806552
 0.47964588 0.47867438 0.47776514 0.47694433 0.4762256  0.4755784
 0.4749939  0.47446764 0.47399688 0.47354376 0.47305012 0.4725101
 0.47189265 0.47122246 0.4704842  0.4697066  0.46892864 0.46811765
 0.46727806 0.4663532  0.46543708 0.4645498  0.46374622 0.46301657
 0.46239948 0.46193358 0.46154574 0.46116984 0.46076536 0.46036345
 0.45995077 0.45952052 0.4590435  0.45856783 0.45808473 0.45759904
 0.45710906 0.45664394 0.4562262  0.45589194 0.45560148 0.4553202
 0.45504978 0.45482433 0.45456767 0.45425546 0.45386943 0.45341715
 0.45292228 0.4524062  0.4518742  0.4513267  0.45072955 0.45015287
 0.4495676  0.4489593  0.44838375 0.4478509  0.44733375 0.4467994
 0.4462308  0.44562167 0.44492853 0.44408992 0.44306803 0.44185463
 0.4405071  0.43916348 0.43780425 0.43637663 0.4349203  0.43342897
 0.43195316 0.43052042 0.42916653 0.42791107 0.4267633  0.42572272
 0.42479298 0.423952   0.42312902 0.42229378 0.42148855 0.42078188
 0.42007542 0.41931403 0.41845515 0.4175054  0.41653082 0.41551843
 0.41448024 0.41339445 0.41232094 0.411296   0.41029334 0.40933344
 0.4084187  0.4075465  0.40674934 0.4059275  0.40504718 0.40413654
 0.40315416 0.40220562 0.40129533 0.4004987  0.3997993  0.3991983
 0.39864144 0.39814517 0.39767596 0.39725947 0.39692196 0.39664894
 0.39643973 0.39619458 0.39589658 0.3956243  0.39530924 0.394985
 0.39468452 0.3944336  0.39417627 0.3938724  0.39359277 0.39332977
 0.39308673 0.3929132  0.3927459  0.3925832  0.3923972  0.39220023
 0.39200604 0.39178827 0.39154094 0.39127198 0.3909688  0.39066994
 0.3903765  0.3900589  0.3897636  0.38950375 0.38925514 0.38900846
 0.3887682  0.388599   0.38847795 0.38842276 0.38838828 0.38833454
 0.38829646 0.3881741  0.38792232 0.38756976 0.38710776 0.3865801
 0.38598242 0.3853283  0.38463864 0.3839127  0.3831644  0.38232794
 0.38146308 0.38072276 0.38010937 0.3795643  0.37904385 0.37847507
 0.37791005 0.3773309  0.37671447 0.37606037 0.37546054 0.3748465
 0.37432727 0.37390035 0.3736317  0.37345058 0.3733768  0.37342152
 0.37361184 0.37380347 0.37393105 0.37393314 0.37374088 0.37346473
 0.3730325  0.37253428 0.3719855  0.37141794 0.37092045 0.37059882
 0.3704562  0.37054887 0.3708694  0.3713238  0.3717517  0.37209117
 0.37225914 0.37222606 0.37199527 0.37146327 0.37068233 0.3696973
 0.368808   0.36822283 0.36824787 0.36916795 0.37083018 0.3727852 ]
