Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=514, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3075661
	speed: 0.0203s/iter; left time: 532.9521s
	iters: 200, epoch: 1 | loss: 0.1635146
	speed: 0.0150s/iter; left time: 392.5008s
Epoch: 1 cost time: 4.51206636428833
Epoch: 1, Steps: 263 | Train Loss: 0.2500387 Vali Loss: 0.1655508 Test Loss: 0.2156848
Validation loss decreased (inf --> 0.165551).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1282487
	speed: 0.0621s/iter; left time: 1609.9171s
	iters: 200, epoch: 2 | loss: 0.1540261
	speed: 0.0151s/iter; left time: 389.4696s
Epoch: 2 cost time: 4.280267000198364
Epoch: 2, Steps: 263 | Train Loss: 0.1441270 Vali Loss: 0.1572750 Test Loss: 0.2051774
Validation loss decreased (0.165551 --> 0.157275).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.0895054
	speed: 0.0625s/iter; left time: 1603.5510s
	iters: 200, epoch: 3 | loss: 0.0861194
	speed: 0.0154s/iter; left time: 394.3771s
Epoch: 3 cost time: 4.408071279525757
Epoch: 3, Steps: 263 | Train Loss: 0.1043939 Vali Loss: 0.1495442 Test Loss: 0.1968263
Validation loss decreased (0.157275 --> 0.149544).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0976907
	speed: 0.0628s/iter; left time: 1595.2063s
	iters: 200, epoch: 4 | loss: 0.0888611
	speed: 0.0141s/iter; left time: 357.1615s
Epoch: 4 cost time: 4.103591203689575
Epoch: 4, Steps: 263 | Train Loss: 0.0810052 Vali Loss: 0.1430714 Test Loss: 0.1901436
Validation loss decreased (0.149544 --> 0.143071).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0614898
	speed: 0.0653s/iter; left time: 1641.0963s
	iters: 200, epoch: 5 | loss: 0.0576903
	speed: 0.0152s/iter; left time: 381.3896s
Epoch: 5 cost time: 4.3126749992370605
Epoch: 5, Steps: 263 | Train Loss: 0.0657006 Vali Loss: 0.1370590 Test Loss: 0.1840435
Validation loss decreased (0.143071 --> 0.137059).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0513617
	speed: 0.0591s/iter; left time: 1471.2223s
	iters: 200, epoch: 6 | loss: 0.0560788
	speed: 0.0135s/iter; left time: 335.2672s
Epoch: 6 cost time: 4.2355568408966064
Epoch: 6, Steps: 263 | Train Loss: 0.0554532 Vali Loss: 0.1321207 Test Loss: 0.1791230
Validation loss decreased (0.137059 --> 0.132121).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0525600
	speed: 0.0615s/iter; left time: 1514.5631s
	iters: 200, epoch: 7 | loss: 0.0355575
	speed: 0.0170s/iter; left time: 417.8242s
Epoch: 7 cost time: 4.6185033321380615
Epoch: 7, Steps: 263 | Train Loss: 0.0485095 Vali Loss: 0.1286218 Test Loss: 0.1759385
Validation loss decreased (0.132121 --> 0.128622).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0441085
	speed: 0.0634s/iter; left time: 1543.3596s
	iters: 200, epoch: 8 | loss: 0.0385378
	speed: 0.0149s/iter; left time: 361.3885s
Epoch: 8 cost time: 4.6569435596466064
Epoch: 8, Steps: 263 | Train Loss: 0.0438546 Vali Loss: 0.1260599 Test Loss: 0.1735145
Validation loss decreased (0.128622 --> 0.126060).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0342998
	speed: 0.0665s/iter; left time: 1603.0080s
	iters: 200, epoch: 9 | loss: 0.0464881
	speed: 0.0146s/iter; left time: 349.5266s
Epoch: 9 cost time: 4.421853303909302
Epoch: 9, Steps: 263 | Train Loss: 0.0407522 Vali Loss: 0.1240909 Test Loss: 0.1717429
Validation loss decreased (0.126060 --> 0.124091).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0390714
	speed: 0.0660s/iter; left time: 1572.5872s
	iters: 200, epoch: 10 | loss: 0.0383832
	speed: 0.0171s/iter; left time: 404.9972s
Epoch: 10 cost time: 4.582880020141602
Epoch: 10, Steps: 263 | Train Loss: 0.0386882 Vali Loss: 0.1223356 Test Loss: 0.1701154
Validation loss decreased (0.124091 --> 0.122336).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0413148
	speed: 0.0656s/iter; left time: 1545.4165s
	iters: 200, epoch: 11 | loss: 0.0342852
	speed: 0.0150s/iter; left time: 353.1704s
Epoch: 11 cost time: 4.5564117431640625
Epoch: 11, Steps: 263 | Train Loss: 0.0373124 Vali Loss: 0.1211075 Test Loss: 0.1694566
Validation loss decreased (0.122336 --> 0.121107).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0355366
	speed: 0.0604s/iter; left time: 1407.1606s
	iters: 200, epoch: 12 | loss: 0.0363902
	speed: 0.0135s/iter; left time: 312.2574s
Epoch: 12 cost time: 4.052281379699707
Epoch: 12, Steps: 263 | Train Loss: 0.0364424 Vali Loss: 0.1203369 Test Loss: 0.1687769
Validation loss decreased (0.121107 --> 0.120337).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0446893
	speed: 0.0633s/iter; left time: 1459.7622s
	iters: 200, epoch: 13 | loss: 0.0329537
	speed: 0.0160s/iter; left time: 367.2721s
Epoch: 13 cost time: 4.258954286575317
Epoch: 13, Steps: 263 | Train Loss: 0.0358950 Vali Loss: 0.1195838 Test Loss: 0.1683918
Validation loss decreased (0.120337 --> 0.119584).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0301464
	speed: 0.0660s/iter; left time: 1503.3012s
	iters: 200, epoch: 14 | loss: 0.0262696
	speed: 0.0155s/iter; left time: 352.1110s
Epoch: 14 cost time: 5.098742485046387
Epoch: 14, Steps: 263 | Train Loss: 0.0355479 Vali Loss: 0.1193629 Test Loss: 0.1680457
Validation loss decreased (0.119584 --> 0.119363).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0396753
	speed: 0.0658s/iter; left time: 1482.4308s
	iters: 200, epoch: 15 | loss: 0.0367659
	speed: 0.0141s/iter; left time: 315.9402s
Epoch: 15 cost time: 4.293002128601074
Epoch: 15, Steps: 263 | Train Loss: 0.0353065 Vali Loss: 0.1191600 Test Loss: 0.1680451
Validation loss decreased (0.119363 --> 0.119160).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0350188
	speed: 0.0632s/iter; left time: 1405.9956s
	iters: 200, epoch: 16 | loss: 0.0308610
	speed: 0.0173s/iter; left time: 384.0725s
Epoch: 16 cost time: 4.583025932312012
Epoch: 16, Steps: 263 | Train Loss: 0.0351909 Vali Loss: 0.1189250 Test Loss: 0.1677675
Validation loss decreased (0.119160 --> 0.118925).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0407866
	speed: 0.0656s/iter; left time: 1442.0520s
	iters: 200, epoch: 17 | loss: 0.0330584
	speed: 0.0136s/iter; left time: 297.2653s
Epoch: 17 cost time: 4.097138404846191
Epoch: 17, Steps: 263 | Train Loss: 0.0350676 Vali Loss: 0.1186414 Test Loss: 0.1678481
Validation loss decreased (0.118925 --> 0.118641).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0441939
	speed: 0.0631s/iter; left time: 1371.5324s
	iters: 200, epoch: 18 | loss: 0.0395057
	speed: 0.0148s/iter; left time: 319.1730s
Epoch: 18 cost time: 4.357149124145508
Epoch: 18, Steps: 263 | Train Loss: 0.0350364 Vali Loss: 0.1186198 Test Loss: 0.1678383
Validation loss decreased (0.118641 --> 0.118620).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0316594
	speed: 0.0638s/iter; left time: 1369.7970s
	iters: 200, epoch: 19 | loss: 0.0273434
	speed: 0.0143s/iter; left time: 305.8164s
Epoch: 19 cost time: 4.094391107559204
Epoch: 19, Steps: 263 | Train Loss: 0.0350164 Vali Loss: 0.1184076 Test Loss: 0.1675800
Validation loss decreased (0.118620 --> 0.118408).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0350473
	speed: 0.0610s/iter; left time: 1293.2683s
	iters: 200, epoch: 20 | loss: 0.0278150
	speed: 0.0146s/iter; left time: 307.1013s
Epoch: 20 cost time: 4.242656230926514
Epoch: 20, Steps: 263 | Train Loss: 0.0349581 Vali Loss: 0.1183968 Test Loss: 0.1675563
Validation loss decreased (0.118408 --> 0.118397).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0323105
	speed: 0.0768s/iter; left time: 1608.1336s
	iters: 200, epoch: 21 | loss: 0.0380890
	speed: 0.0152s/iter; left time: 316.5508s
Epoch: 21 cost time: 5.790372610092163
Epoch: 21, Steps: 263 | Train Loss: 0.0349894 Vali Loss: 0.1184205 Test Loss: 0.1675504
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0321914
	speed: 0.0754s/iter; left time: 1558.4524s
	iters: 200, epoch: 22 | loss: 0.0339587
	speed: 0.0154s/iter; left time: 316.8346s
Epoch: 22 cost time: 4.562938690185547
Epoch: 22, Steps: 263 | Train Loss: 0.0349687 Vali Loss: 0.1183423 Test Loss: 0.1676099
Validation loss decreased (0.118397 --> 0.118342).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0455653
	speed: 0.0616s/iter; left time: 1258.2565s
	iters: 200, epoch: 23 | loss: 0.0306536
	speed: 0.0159s/iter; left time: 323.2651s
Epoch: 23 cost time: 4.347245931625366
Epoch: 23, Steps: 263 | Train Loss: 0.0349271 Vali Loss: 0.1182496 Test Loss: 0.1673851
Validation loss decreased (0.118342 --> 0.118250).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0356475
	speed: 0.0614s/iter; left time: 1236.3954s
	iters: 200, epoch: 24 | loss: 0.0358876
	speed: 0.0250s/iter; left time: 500.4131s
Epoch: 24 cost time: 5.493074655532837
Epoch: 24, Steps: 263 | Train Loss: 0.0349626 Vali Loss: 0.1182895 Test Loss: 0.1675016
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0348002
	speed: 0.0709s/iter; left time: 1410.6960s
	iters: 200, epoch: 25 | loss: 0.0442715
	speed: 0.0178s/iter; left time: 351.8955s
Epoch: 25 cost time: 4.706749439239502
Epoch: 25, Steps: 263 | Train Loss: 0.0349439 Vali Loss: 0.1184574 Test Loss: 0.1676202
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0281002
	speed: 0.0632s/iter; left time: 1239.9587s
	iters: 200, epoch: 26 | loss: 0.0272723
	speed: 0.0171s/iter; left time: 333.0648s
Epoch: 26 cost time: 4.547866106033325
Epoch: 26, Steps: 263 | Train Loss: 0.0349495 Vali Loss: 0.1181309 Test Loss: 0.1673277
Validation loss decreased (0.118250 --> 0.118131).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0371115
	speed: 0.0729s/iter; left time: 1412.4524s
	iters: 200, epoch: 27 | loss: 0.0320274
	speed: 0.0141s/iter; left time: 272.3223s
Epoch: 27 cost time: 4.146098375320435
Epoch: 27, Steps: 263 | Train Loss: 0.0349600 Vali Loss: 0.1182410 Test Loss: 0.1673665
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0362688
	speed: 0.0601s/iter; left time: 1147.8242s
	iters: 200, epoch: 28 | loss: 0.0471512
	speed: 0.0139s/iter; left time: 264.3213s
Epoch: 28 cost time: 4.199859857559204
Epoch: 28, Steps: 263 | Train Loss: 0.0349581 Vali Loss: 0.1182458 Test Loss: 0.1673068
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0303043
	speed: 0.0630s/iter; left time: 1187.4632s
	iters: 200, epoch: 29 | loss: 0.0317553
	speed: 0.0157s/iter; left time: 295.0290s
Epoch: 29 cost time: 4.634639263153076
Epoch: 29, Steps: 263 | Train Loss: 0.0349351 Vali Loss: 0.1181257 Test Loss: 0.1674117
Validation loss decreased (0.118131 --> 0.118126).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0350279
	speed: 0.0652s/iter; left time: 1211.1014s
	iters: 200, epoch: 30 | loss: 0.0378752
	speed: 0.0141s/iter; left time: 260.8091s
Epoch: 30 cost time: 4.407442808151245
Epoch: 30, Steps: 263 | Train Loss: 0.0349687 Vali Loss: 0.1183473 Test Loss: 0.1675030
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0376893
	speed: 0.0610s/iter; left time: 1117.0204s
	iters: 200, epoch: 31 | loss: 0.0322483
	speed: 0.0146s/iter; left time: 266.6741s
Epoch: 31 cost time: 4.172668218612671
Epoch: 31, Steps: 263 | Train Loss: 0.0349437 Vali Loss: 0.1182368 Test Loss: 0.1673028
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0324842
	speed: 0.0617s/iter; left time: 1113.7108s
	iters: 200, epoch: 32 | loss: 0.0359669
	speed: 0.0138s/iter; left time: 247.0462s
Epoch: 32 cost time: 4.278932809829712
Epoch: 32, Steps: 263 | Train Loss: 0.0349528 Vali Loss: 0.1181583 Test Loss: 0.1673775
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0469236
	speed: 0.0637s/iter; left time: 1133.0074s
	iters: 200, epoch: 33 | loss: 0.0350420
	speed: 0.0139s/iter; left time: 246.5629s
Epoch: 33 cost time: 4.09931755065918
Epoch: 33, Steps: 263 | Train Loss: 0.0349253 Vali Loss: 0.1182784 Test Loss: 0.1673238
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0511772
	speed: 0.0626s/iter; left time: 1096.5819s
	iters: 200, epoch: 34 | loss: 0.0360593
	speed: 0.0266s/iter; left time: 463.6325s
Epoch: 34 cost time: 5.506373167037964
Epoch: 34, Steps: 263 | Train Loss: 0.0349295 Vali Loss: 0.1182831 Test Loss: 0.1673596
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0386488
	speed: 0.0711s/iter; left time: 1226.8738s
	iters: 200, epoch: 35 | loss: 0.0308058
	speed: 0.0153s/iter; left time: 261.6770s
Epoch: 35 cost time: 5.8345537185668945
Epoch: 35, Steps: 263 | Train Loss: 0.0349721 Vali Loss: 0.1182924 Test Loss: 0.1674873
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0384673
	speed: 0.0715s/iter; left time: 1214.4151s
	iters: 200, epoch: 36 | loss: 0.0279860
	speed: 0.0162s/iter; left time: 272.9451s
Epoch: 36 cost time: 5.089389801025391
Epoch: 36, Steps: 263 | Train Loss: 0.0349528 Vali Loss: 0.1181787 Test Loss: 0.1673280
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0333757
	speed: 0.0809s/iter; left time: 1353.9339s
	iters: 200, epoch: 37 | loss: 0.0372411
	speed: 0.0240s/iter; left time: 398.6870s
Epoch: 37 cost time: 6.098338603973389
Epoch: 37, Steps: 263 | Train Loss: 0.0349491 Vali Loss: 0.1183177 Test Loss: 0.1674650
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0350470
	speed: 0.0667s/iter; left time: 1097.7817s
	iters: 200, epoch: 38 | loss: 0.0338776
	speed: 0.0215s/iter; left time: 352.5232s
Epoch: 38 cost time: 5.929592609405518
Epoch: 38, Steps: 263 | Train Loss: 0.0348990 Vali Loss: 0.1182588 Test Loss: 0.1673612
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0341222
	speed: 0.0750s/iter; left time: 1215.0540s
	iters: 200, epoch: 39 | loss: 0.0408769
	speed: 0.0181s/iter; left time: 291.1899s
Epoch: 39 cost time: 4.494250059127808
Epoch: 39, Steps: 263 | Train Loss: 0.0349329 Vali Loss: 0.1181719 Test Loss: 0.1673349
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0312803
	speed: 0.0628s/iter; left time: 1001.6899s
	iters: 200, epoch: 40 | loss: 0.0427198
	speed: 0.0151s/iter; left time: 239.2149s
Epoch: 40 cost time: 4.373324871063232
Epoch: 40, Steps: 263 | Train Loss: 0.0349453 Vali Loss: 0.1181900 Test Loss: 0.1673571
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0317486
	speed: 0.0628s/iter; left time: 984.1679s
	iters: 200, epoch: 41 | loss: 0.0418134
	speed: 0.0161s/iter; left time: 250.9723s
Epoch: 41 cost time: 4.486225366592407
Epoch: 41, Steps: 263 | Train Loss: 0.0349499 Vali Loss: 0.1182377 Test Loss: 0.1673115
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0371667
	speed: 0.0617s/iter; left time: 950.9870s
	iters: 200, epoch: 42 | loss: 0.0332102
	speed: 0.0141s/iter; left time: 215.9883s
Epoch: 42 cost time: 4.13011622428894
Epoch: 42, Steps: 263 | Train Loss: 0.0349275 Vali Loss: 0.1181810 Test Loss: 0.1673260
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0286040
	speed: 0.0605s/iter; left time: 916.1369s
	iters: 200, epoch: 43 | loss: 0.0369923
	speed: 0.0140s/iter; left time: 210.6348s
Epoch: 43 cost time: 4.399203300476074
Epoch: 43, Steps: 263 | Train Loss: 0.0348895 Vali Loss: 0.1181922 Test Loss: 0.1674026
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0318150
	speed: 0.0654s/iter; left time: 973.4684s
	iters: 200, epoch: 44 | loss: 0.0342745
	speed: 0.0158s/iter; left time: 233.2856s
Epoch: 44 cost time: 4.47820782661438
Epoch: 44, Steps: 263 | Train Loss: 0.0349095 Vali Loss: 0.1183344 Test Loss: 0.1674079
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0295250
	speed: 0.0642s/iter; left time: 939.1412s
	iters: 200, epoch: 45 | loss: 0.0382525
	speed: 0.0168s/iter; left time: 244.1279s
Epoch: 45 cost time: 4.704488515853882
Epoch: 45, Steps: 263 | Train Loss: 0.0349323 Vali Loss: 0.1181790 Test Loss: 0.1673935
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0427899
	speed: 0.0618s/iter; left time: 887.6425s
	iters: 200, epoch: 46 | loss: 0.0472717
	speed: 0.0160s/iter; left time: 227.5689s
Epoch: 46 cost time: 4.405630111694336
Epoch: 46, Steps: 263 | Train Loss: 0.0348834 Vali Loss: 0.1182174 Test Loss: 0.1673401
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.0273969
	speed: 0.0649s/iter; left time: 915.7140s
	iters: 200, epoch: 47 | loss: 0.0284873
	speed: 0.0158s/iter; left time: 221.8277s
Epoch: 47 cost time: 4.690912246704102
Epoch: 47, Steps: 263 | Train Loss: 0.0349279 Vali Loss: 0.1182133 Test Loss: 0.1673094
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.0348726
	speed: 0.0666s/iter; left time: 921.1969s
	iters: 200, epoch: 48 | loss: 0.0311736
	speed: 0.0168s/iter; left time: 231.1284s
Epoch: 48 cost time: 4.717857360839844
Epoch: 48, Steps: 263 | Train Loss: 0.0349326 Vali Loss: 0.1182236 Test Loss: 0.1673104
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.0419374
	speed: 0.0826s/iter; left time: 1121.2106s
	iters: 200, epoch: 49 | loss: 0.0266540
	speed: 0.0226s/iter; left time: 304.5287s
Epoch: 49 cost time: 7.03053092956543
Epoch: 49, Steps: 263 | Train Loss: 0.0349374 Vali Loss: 0.1181730 Test Loss: 0.1673871
EarlyStopping counter: 20 out of 20
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2176836
	speed: 0.0252s/iter; left time: 659.9624s
	iters: 200, epoch: 1 | loss: 0.2398100
	speed: 0.0138s/iter; left time: 359.2183s
Epoch: 1 cost time: 4.786139488220215
Epoch: 1, Steps: 263 | Train Loss: 0.2129677 Vali Loss: 0.1153280 Test Loss: 0.1641627
Validation loss decreased (inf --> 0.115328).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3037727
	speed: 0.0742s/iter; left time: 1924.0029s
	iters: 200, epoch: 2 | loss: 0.1735169
	speed: 0.0135s/iter; left time: 349.6121s
Epoch: 2 cost time: 4.156380891799927
Epoch: 2, Steps: 263 | Train Loss: 0.2095510 Vali Loss: 0.1145652 Test Loss: 0.1629248
Validation loss decreased (0.115328 --> 0.114565).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1826943
	speed: 0.0627s/iter; left time: 1609.8489s
	iters: 200, epoch: 3 | loss: 0.2789041
	speed: 0.0169s/iter; left time: 433.0293s
Epoch: 3 cost time: 4.592732667922974
Epoch: 3, Steps: 263 | Train Loss: 0.2083847 Vali Loss: 0.1144560 Test Loss: 0.1630153
Validation loss decreased (0.114565 --> 0.114456).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2311859
	speed: 0.0711s/iter; left time: 1805.6354s
	iters: 200, epoch: 4 | loss: 0.1761671
	speed: 0.0152s/iter; left time: 384.9322s
Epoch: 4 cost time: 4.285825967788696
Epoch: 4, Steps: 263 | Train Loss: 0.2080386 Vali Loss: 0.1147432 Test Loss: 0.1627279
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2011717
	speed: 0.0623s/iter; left time: 1568.0324s
	iters: 200, epoch: 5 | loss: 0.2747691
	speed: 0.0138s/iter; left time: 346.9113s
Epoch: 5 cost time: 4.18655252456665
Epoch: 5, Steps: 263 | Train Loss: 0.2074251 Vali Loss: 0.1142538 Test Loss: 0.1625020
Validation loss decreased (0.114456 --> 0.114254).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1653195
	speed: 0.0628s/iter; left time: 1563.7959s
	iters: 200, epoch: 6 | loss: 0.2652570
	speed: 0.0142s/iter; left time: 350.8502s
Epoch: 6 cost time: 4.764298915863037
Epoch: 6, Steps: 263 | Train Loss: 0.2073002 Vali Loss: 0.1145392 Test Loss: 0.1626903
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2746081
	speed: 0.0704s/iter; left time: 1734.3809s
	iters: 200, epoch: 7 | loss: 0.1790863
	speed: 0.0152s/iter; left time: 371.6349s
Epoch: 7 cost time: 4.71417760848999
Epoch: 7, Steps: 263 | Train Loss: 0.2068990 Vali Loss: 0.1144697 Test Loss: 0.1625825
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2162097
	speed: 0.0641s/iter; left time: 1560.8521s
	iters: 200, epoch: 8 | loss: 0.2114564
	speed: 0.0140s/iter; left time: 340.4467s
Epoch: 8 cost time: 4.158709764480591
Epoch: 8, Steps: 263 | Train Loss: 0.2068415 Vali Loss: 0.1144820 Test Loss: 0.1625274
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1635789
	speed: 0.0634s/iter; left time: 1527.8795s
	iters: 200, epoch: 9 | loss: 0.1547239
	speed: 0.0144s/iter; left time: 345.1773s
Epoch: 9 cost time: 4.498255252838135
Epoch: 9, Steps: 263 | Train Loss: 0.2066281 Vali Loss: 0.1141293 Test Loss: 0.1622947
Validation loss decreased (0.114254 --> 0.114129).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1754805
	speed: 0.0654s/iter; left time: 1559.2886s
	iters: 200, epoch: 10 | loss: 0.2740700
	speed: 0.0319s/iter; left time: 757.4087s
Epoch: 10 cost time: 6.459644794464111
Epoch: 10, Steps: 263 | Train Loss: 0.2065344 Vali Loss: 0.1140290 Test Loss: 0.1620494
Validation loss decreased (0.114129 --> 0.114029).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1991596
	speed: 0.0668s/iter; left time: 1574.1118s
	iters: 200, epoch: 11 | loss: 0.1687602
	speed: 0.0160s/iter; left time: 375.0189s
Epoch: 11 cost time: 5.179747104644775
Epoch: 11, Steps: 263 | Train Loss: 0.2062404 Vali Loss: 0.1141978 Test Loss: 0.1623572
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2494623
	speed: 0.0787s/iter; left time: 1834.4584s
	iters: 200, epoch: 12 | loss: 0.2735737
	speed: 0.0166s/iter; left time: 386.2901s
Epoch: 12 cost time: 4.536040306091309
Epoch: 12, Steps: 263 | Train Loss: 0.2057273 Vali Loss: 0.1141774 Test Loss: 0.1621630
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2911738
	speed: 0.0682s/iter; left time: 1571.9743s
	iters: 200, epoch: 13 | loss: 0.1693092
	speed: 0.0168s/iter; left time: 386.3338s
Epoch: 13 cost time: 4.743612289428711
Epoch: 13, Steps: 263 | Train Loss: 0.2060880 Vali Loss: 0.1142754 Test Loss: 0.1619992
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2386843
	speed: 0.0641s/iter; left time: 1460.0916s
	iters: 200, epoch: 14 | loss: 0.2361570
	speed: 0.0149s/iter; left time: 338.4636s
Epoch: 14 cost time: 4.467480182647705
Epoch: 14, Steps: 263 | Train Loss: 0.2058956 Vali Loss: 0.1143460 Test Loss: 0.1623007
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2067837
	speed: 0.0638s/iter; left time: 1437.3632s
	iters: 200, epoch: 15 | loss: 0.1618495
	speed: 0.0143s/iter; left time: 320.7844s
Epoch: 15 cost time: 4.200214385986328
Epoch: 15, Steps: 263 | Train Loss: 0.2060875 Vali Loss: 0.1142916 Test Loss: 0.1622325
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2361315
	speed: 0.0643s/iter; left time: 1430.1304s
	iters: 200, epoch: 16 | loss: 0.1918792
	speed: 0.0238s/iter; left time: 527.2756s
Epoch: 16 cost time: 5.52261209487915
Epoch: 16, Steps: 263 | Train Loss: 0.2058726 Vali Loss: 0.1141678 Test Loss: 0.1620333
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2226976
	speed: 0.0650s/iter; left time: 1428.7838s
	iters: 200, epoch: 17 | loss: 0.1521416
	speed: 0.0135s/iter; left time: 294.9737s
Epoch: 17 cost time: 4.137269496917725
Epoch: 17, Steps: 263 | Train Loss: 0.2056678 Vali Loss: 0.1142849 Test Loss: 0.1622328
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1641473
	speed: 0.0582s/iter; left time: 1263.7700s
	iters: 200, epoch: 18 | loss: 0.2389521
	speed: 0.0125s/iter; left time: 270.9755s
Epoch: 18 cost time: 3.7809274196624756
Epoch: 18, Steps: 263 | Train Loss: 0.2057638 Vali Loss: 0.1140303 Test Loss: 0.1620613
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1342935
	speed: 0.0606s/iter; left time: 1301.4546s
	iters: 200, epoch: 19 | loss: 0.2188367
	speed: 0.0148s/iter; left time: 316.0160s
Epoch: 19 cost time: 4.400583028793335
Epoch: 19, Steps: 263 | Train Loss: 0.2059058 Vali Loss: 0.1143169 Test Loss: 0.1623640
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1781940
	speed: 0.0596s/iter; left time: 1264.0143s
	iters: 200, epoch: 20 | loss: 0.2427373
	speed: 0.0134s/iter; left time: 282.5236s
Epoch: 20 cost time: 4.1269004344940186
Epoch: 20, Steps: 263 | Train Loss: 0.2058229 Vali Loss: 0.1143714 Test Loss: 0.1621345
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2155516
	speed: 0.0661s/iter; left time: 1385.0919s
	iters: 200, epoch: 21 | loss: 0.2106465
	speed: 0.0147s/iter; left time: 305.9352s
Epoch: 21 cost time: 4.180140495300293
Epoch: 21, Steps: 263 | Train Loss: 0.2057154 Vali Loss: 0.1140948 Test Loss: 0.1618485
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2600369
	speed: 0.0660s/iter; left time: 1365.7221s
	iters: 200, epoch: 22 | loss: 0.2058512
	speed: 0.0144s/iter; left time: 296.6986s
Epoch: 22 cost time: 4.216871500015259
Epoch: 22, Steps: 263 | Train Loss: 0.2055399 Vali Loss: 0.1142868 Test Loss: 0.1619996
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1403792
	speed: 0.0601s/iter; left time: 1227.8934s
	iters: 200, epoch: 23 | loss: 0.2790932
	speed: 0.0194s/iter; left time: 394.7792s
Epoch: 23 cost time: 4.843012571334839
Epoch: 23, Steps: 263 | Train Loss: 0.2055684 Vali Loss: 0.1141836 Test Loss: 0.1619135
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2142805
	speed: 0.0626s/iter; left time: 1260.7195s
	iters: 200, epoch: 24 | loss: 0.2013966
	speed: 0.0136s/iter; left time: 272.3426s
Epoch: 24 cost time: 4.418369293212891
Epoch: 24, Steps: 263 | Train Loss: 0.2055565 Vali Loss: 0.1141671 Test Loss: 0.1619775
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2259200
	speed: 0.0652s/iter; left time: 1296.0623s
	iters: 200, epoch: 25 | loss: 0.1494075
	speed: 0.0142s/iter; left time: 281.4760s
Epoch: 25 cost time: 4.078604698181152
Epoch: 25, Steps: 263 | Train Loss: 0.2055913 Vali Loss: 0.1141237 Test Loss: 0.1619800
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1678542
	speed: 0.0603s/iter; left time: 1183.2368s
	iters: 200, epoch: 26 | loss: 0.1491575
	speed: 0.0190s/iter; left time: 371.4878s
Epoch: 26 cost time: 4.623517990112305
Epoch: 26, Steps: 263 | Train Loss: 0.2054955 Vali Loss: 0.1141303 Test Loss: 0.1619551
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2326783
	speed: 0.0621s/iter; left time: 1201.5835s
	iters: 200, epoch: 27 | loss: 0.2307035
	speed: 0.0147s/iter; left time: 283.1457s
Epoch: 27 cost time: 4.626431465148926
Epoch: 27, Steps: 263 | Train Loss: 0.2054234 Vali Loss: 0.1141242 Test Loss: 0.1619763
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1415871
	speed: 0.0717s/iter; left time: 1370.3106s
	iters: 200, epoch: 28 | loss: 0.2132662
	speed: 0.0138s/iter; left time: 261.2620s
Epoch: 28 cost time: 4.726034641265869
Epoch: 28, Steps: 263 | Train Loss: 0.2054030 Vali Loss: 0.1141034 Test Loss: 0.1619573
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2570907
	speed: 0.0611s/iter; left time: 1150.2989s
	iters: 200, epoch: 29 | loss: 0.1455895
	speed: 0.0146s/iter; left time: 273.5230s
Epoch: 29 cost time: 5.009812831878662
Epoch: 29, Steps: 263 | Train Loss: 0.2053046 Vali Loss: 0.1140507 Test Loss: 0.1618679
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3307371
	speed: 0.0687s/iter; left time: 1275.5885s
	iters: 200, epoch: 30 | loss: 0.1591625
	speed: 0.0199s/iter; left time: 368.3352s
Epoch: 30 cost time: 4.6585469245910645
Epoch: 30, Steps: 263 | Train Loss: 0.2053142 Vali Loss: 0.1140470 Test Loss: 0.1617986
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1625390201807022, mae:0.2531653940677643, rse:0.3268699645996094, corr:[0.57175446 0.5722017  0.56927204 0.5672661  0.56700206 0.56727785
 0.5669029  0.5659732  0.56527823 0.5651916  0.56535786 0.5651715
 0.56454194 0.5638745  0.5635633  0.56344116 0.5631117  0.5622762
 0.5611132  0.56008875 0.55951285 0.55923676 0.55894375 0.55839324
 0.5576202  0.5569153  0.5564479  0.55609447 0.5556339  0.5550388
 0.55441946 0.55402243 0.5537632  0.55337065 0.55274135 0.55198056
 0.551227   0.55061215 0.55008394 0.549534   0.54889035 0.5481854
 0.54757285 0.54713184 0.5468038  0.54635495 0.54565924 0.54477715
 0.5437646  0.54277796 0.54194486 0.5412788  0.54055744 0.5396603
 0.5386891  0.53790915 0.53737336 0.53698903 0.5365915  0.5360914
 0.5355055  0.5351257  0.5350698  0.5351916  0.53526765 0.53525215
 0.53502244 0.53472006 0.5345224  0.5344178  0.5343284  0.53421843
 0.53401846 0.5336835  0.53311944 0.5324042  0.53159523 0.530783
 0.53001934 0.5294631  0.52882767 0.52801687 0.5270327  0.52617496
 0.52579063 0.52587664 0.5257609  0.52509224 0.52403706 0.52320856
 0.5232868  0.52397156 0.52398485 0.5230048  0.5219393  0.5222058 ]
