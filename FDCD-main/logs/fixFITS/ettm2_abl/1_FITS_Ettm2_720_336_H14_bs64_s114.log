Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=122, out_features=178, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  19457536.0
params:  21894.0
Trainable parameters:  21894
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5128622
	speed: 0.0278s/iter; left time: 722.7602s
	iters: 200, epoch: 1 | loss: 0.4390127
	speed: 0.0223s/iter; left time: 577.3397s
Epoch: 1 cost time: 6.134381532669067
Epoch: 1, Steps: 261 | Train Loss: 0.4602177 Vali Loss: 0.2103010 Test Loss: 0.2890623
Validation loss decreased (inf --> 0.210301).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4245509
	speed: 0.0788s/iter; left time: 2028.8887s
	iters: 200, epoch: 2 | loss: 0.4684555
	speed: 0.0167s/iter; left time: 428.0317s
Epoch: 2 cost time: 4.961848020553589
Epoch: 2, Steps: 261 | Train Loss: 0.4026469 Vali Loss: 0.2019339 Test Loss: 0.2788179
Validation loss decreased (0.210301 --> 0.201934).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4102253
	speed: 0.0829s/iter; left time: 2111.3667s
	iters: 200, epoch: 3 | loss: 0.2954649
	speed: 0.0178s/iter; left time: 452.4657s
Epoch: 3 cost time: 5.329118967056274
Epoch: 3, Steps: 261 | Train Loss: 0.3918597 Vali Loss: 0.1986489 Test Loss: 0.2750032
Validation loss decreased (0.201934 --> 0.198649).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4936701
	speed: 0.0751s/iter; left time: 1892.7363s
	iters: 200, epoch: 4 | loss: 0.3284155
	speed: 0.0175s/iter; left time: 439.7014s
Epoch: 4 cost time: 5.119845867156982
Epoch: 4, Steps: 261 | Train Loss: 0.3866332 Vali Loss: 0.1964975 Test Loss: 0.2728049
Validation loss decreased (0.198649 --> 0.196497).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3812787
	speed: 0.0742s/iter; left time: 1852.9658s
	iters: 200, epoch: 5 | loss: 0.3373215
	speed: 0.0209s/iter; left time: 518.6096s
Epoch: 5 cost time: 5.4669435024261475
Epoch: 5, Steps: 261 | Train Loss: 0.3829253 Vali Loss: 0.1956069 Test Loss: 0.2715400
Validation loss decreased (0.196497 --> 0.195607).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3733286
	speed: 0.0715s/iter; left time: 1765.6023s
	iters: 200, epoch: 6 | loss: 0.3458129
	speed: 0.0179s/iter; left time: 439.4606s
Epoch: 6 cost time: 5.188374996185303
Epoch: 6, Steps: 261 | Train Loss: 0.3819515 Vali Loss: 0.1949159 Test Loss: 0.2706824
Validation loss decreased (0.195607 --> 0.194916).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4550209
	speed: 0.0768s/iter; left time: 1877.7679s
	iters: 200, epoch: 7 | loss: 0.4714533
	speed: 0.0165s/iter; left time: 400.7086s
Epoch: 7 cost time: 4.934676885604858
Epoch: 7, Steps: 261 | Train Loss: 0.3799390 Vali Loss: 0.1942233 Test Loss: 0.2696479
Validation loss decreased (0.194916 --> 0.194223).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3291706
	speed: 0.0705s/iter; left time: 1703.8922s
	iters: 200, epoch: 8 | loss: 0.3757976
	speed: 0.0183s/iter; left time: 440.7719s
Epoch: 8 cost time: 5.21624755859375
Epoch: 8, Steps: 261 | Train Loss: 0.3793322 Vali Loss: 0.1937510 Test Loss: 0.2692032
Validation loss decreased (0.194223 --> 0.193751).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3446513
	speed: 0.0720s/iter; left time: 1721.3653s
	iters: 200, epoch: 9 | loss: 0.2931778
	speed: 0.0168s/iter; left time: 400.8879s
Epoch: 9 cost time: 4.780778884887695
Epoch: 9, Steps: 261 | Train Loss: 0.3781748 Vali Loss: 0.1937901 Test Loss: 0.2690680
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.5070029
	speed: 0.0720s/iter; left time: 1702.5040s
	iters: 200, epoch: 10 | loss: 0.3982140
	speed: 0.0162s/iter; left time: 381.9638s
Epoch: 10 cost time: 4.915571451187134
Epoch: 10, Steps: 261 | Train Loss: 0.3775923 Vali Loss: 0.1933014 Test Loss: 0.2688375
Validation loss decreased (0.193751 --> 0.193301).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3322040
	speed: 0.0788s/iter; left time: 1842.2937s
	iters: 200, epoch: 11 | loss: 0.4102698
	speed: 0.0171s/iter; left time: 398.3190s
Epoch: 11 cost time: 5.039099454879761
Epoch: 11, Steps: 261 | Train Loss: 0.3767842 Vali Loss: 0.1933514 Test Loss: 0.2686237
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.5813174
	speed: 0.0803s/iter; left time: 1857.9954s
	iters: 200, epoch: 12 | loss: 0.3533948
	speed: 0.0199s/iter; left time: 457.9157s
Epoch: 12 cost time: 5.833125114440918
Epoch: 12, Steps: 261 | Train Loss: 0.3768743 Vali Loss: 0.1933146 Test Loss: 0.2685336
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3151031
	speed: 0.0763s/iter; left time: 1745.4988s
	iters: 200, epoch: 13 | loss: 0.3575438
	speed: 0.0225s/iter; left time: 512.0307s
Epoch: 13 cost time: 6.261421203613281
Epoch: 13, Steps: 261 | Train Loss: 0.3764307 Vali Loss: 0.1931071 Test Loss: 0.2681892
Validation loss decreased (0.193301 --> 0.193107).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.5236226
	speed: 0.0862s/iter; left time: 1949.5203s
	iters: 200, epoch: 14 | loss: 0.2780688
	speed: 0.0211s/iter; left time: 474.7144s
Epoch: 14 cost time: 5.843176603317261
Epoch: 14, Steps: 261 | Train Loss: 0.3763715 Vali Loss: 0.1929023 Test Loss: 0.2681724
Validation loss decreased (0.193107 --> 0.192902).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3259245
	speed: 0.0806s/iter; left time: 1801.1448s
	iters: 200, epoch: 15 | loss: 0.4504992
	speed: 0.0173s/iter; left time: 385.7133s
Epoch: 15 cost time: 5.154626846313477
Epoch: 15, Steps: 261 | Train Loss: 0.3758750 Vali Loss: 0.1928833 Test Loss: 0.2682613
Validation loss decreased (0.192902 --> 0.192883).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4323370
	speed: 0.0805s/iter; left time: 1776.9158s
	iters: 200, epoch: 16 | loss: 0.3607631
	speed: 0.0217s/iter; left time: 477.7205s
Epoch: 16 cost time: 5.991103410720825
Epoch: 16, Steps: 261 | Train Loss: 0.3756711 Vali Loss: 0.1926350 Test Loss: 0.2679336
Validation loss decreased (0.192883 --> 0.192635).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4301091
	speed: 0.0875s/iter; left time: 1908.7889s
	iters: 200, epoch: 17 | loss: 0.3739873
	speed: 0.0229s/iter; left time: 497.9518s
Epoch: 17 cost time: 6.544766187667847
Epoch: 17, Steps: 261 | Train Loss: 0.3748789 Vali Loss: 0.1928115 Test Loss: 0.2680135
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3833673
	speed: 0.0881s/iter; left time: 1900.6317s
	iters: 200, epoch: 18 | loss: 0.3829374
	speed: 0.0214s/iter; left time: 458.7671s
Epoch: 18 cost time: 6.339956045150757
Epoch: 18, Steps: 261 | Train Loss: 0.3754179 Vali Loss: 0.1926536 Test Loss: 0.2679210
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4742998
	speed: 0.0848s/iter; left time: 1806.6861s
	iters: 200, epoch: 19 | loss: 0.3666595
	speed: 0.0210s/iter; left time: 445.9909s
Epoch: 19 cost time: 5.945803165435791
Epoch: 19, Steps: 261 | Train Loss: 0.3751817 Vali Loss: 0.1925668 Test Loss: 0.2678769
Validation loss decreased (0.192635 --> 0.192567).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2900872
	speed: 0.0782s/iter; left time: 1646.2740s
	iters: 200, epoch: 20 | loss: 0.3969035
	speed: 0.0193s/iter; left time: 403.4294s
Epoch: 20 cost time: 5.3971967697143555
Epoch: 20, Steps: 261 | Train Loss: 0.3752531 Vali Loss: 0.1927816 Test Loss: 0.2679087
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4847815
	speed: 0.0843s/iter; left time: 1752.7726s
	iters: 200, epoch: 21 | loss: 0.2766257
	speed: 0.0178s/iter; left time: 367.5644s
Epoch: 21 cost time: 5.839328050613403
Epoch: 21, Steps: 261 | Train Loss: 0.3752708 Vali Loss: 0.1926031 Test Loss: 0.2678680
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2954676
	speed: 0.0797s/iter; left time: 1636.4330s
	iters: 200, epoch: 22 | loss: 0.3578084
	speed: 0.0194s/iter; left time: 395.9736s
Epoch: 22 cost time: 5.318399429321289
Epoch: 22, Steps: 261 | Train Loss: 0.3746317 Vali Loss: 0.1927599 Test Loss: 0.2679766
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2881082
	speed: 0.0813s/iter; left time: 1647.9712s
	iters: 200, epoch: 23 | loss: 0.2994666
	speed: 0.0201s/iter; left time: 405.1461s
Epoch: 23 cost time: 5.779196262359619
Epoch: 23, Steps: 261 | Train Loss: 0.3746310 Vali Loss: 0.1924036 Test Loss: 0.2676035
Validation loss decreased (0.192567 --> 0.192404).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3248081
	speed: 0.0786s/iter; left time: 1571.1722s
	iters: 200, epoch: 24 | loss: 0.4010035
	speed: 0.0215s/iter; left time: 428.2010s
Epoch: 24 cost time: 5.777356863021851
Epoch: 24, Steps: 261 | Train Loss: 0.3749819 Vali Loss: 0.1926427 Test Loss: 0.2676817
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4213168
	speed: 0.0862s/iter; left time: 1700.7212s
	iters: 200, epoch: 25 | loss: 0.3274378
	speed: 0.0215s/iter; left time: 422.8803s
Epoch: 25 cost time: 5.728154182434082
Epoch: 25, Steps: 261 | Train Loss: 0.3747908 Vali Loss: 0.1925303 Test Loss: 0.2676753
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3240127
	speed: 0.0885s/iter; left time: 1723.0177s
	iters: 200, epoch: 26 | loss: 0.2434493
	speed: 0.0226s/iter; left time: 437.3826s
Epoch: 26 cost time: 6.442600250244141
Epoch: 26, Steps: 261 | Train Loss: 0.3740348 Vali Loss: 0.1925737 Test Loss: 0.2677135
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3424720
	speed: 0.0875s/iter; left time: 1682.1959s
	iters: 200, epoch: 27 | loss: 0.4088286
	speed: 0.0208s/iter; left time: 397.7648s
Epoch: 27 cost time: 5.699408769607544
Epoch: 27, Steps: 261 | Train Loss: 0.3744995 Vali Loss: 0.1925241 Test Loss: 0.2676634
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3449174
	speed: 0.0853s/iter; left time: 1616.6925s
	iters: 200, epoch: 28 | loss: 0.4601102
	speed: 0.0214s/iter; left time: 403.8470s
Epoch: 28 cost time: 5.96715784072876
Epoch: 28, Steps: 261 | Train Loss: 0.3742728 Vali Loss: 0.1925036 Test Loss: 0.2676547
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3467771
	speed: 0.0845s/iter; left time: 1579.2719s
	iters: 200, epoch: 29 | loss: 0.3963549
	speed: 0.0223s/iter; left time: 414.4525s
Epoch: 29 cost time: 5.851194858551025
Epoch: 29, Steps: 261 | Train Loss: 0.3739531 Vali Loss: 0.1922959 Test Loss: 0.2675454
Validation loss decreased (0.192404 --> 0.192296).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4215829
	speed: 0.0815s/iter; left time: 1501.6541s
	iters: 200, epoch: 30 | loss: 0.2825077
	speed: 0.0214s/iter; left time: 392.4752s
Epoch: 30 cost time: 5.658462285995483
Epoch: 30, Steps: 261 | Train Loss: 0.3742932 Vali Loss: 0.1926558 Test Loss: 0.2676482
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2450437
	speed: 0.0816s/iter; left time: 1482.1973s
	iters: 200, epoch: 31 | loss: 0.3228921
	speed: 0.0197s/iter; left time: 355.4941s
Epoch: 31 cost time: 5.354231119155884
Epoch: 31, Steps: 261 | Train Loss: 0.3742356 Vali Loss: 0.1925238 Test Loss: 0.2675733
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.5735908
	speed: 0.0745s/iter; left time: 1334.7059s
	iters: 200, epoch: 32 | loss: 0.3249943
	speed: 0.0209s/iter; left time: 372.7705s
Epoch: 32 cost time: 5.360031366348267
Epoch: 32, Steps: 261 | Train Loss: 0.3741373 Vali Loss: 0.1924377 Test Loss: 0.2673995
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3510099
	speed: 0.0802s/iter; left time: 1414.7601s
	iters: 200, epoch: 33 | loss: 0.2810546
	speed: 0.0187s/iter; left time: 328.5055s
Epoch: 33 cost time: 5.677822828292847
Epoch: 33, Steps: 261 | Train Loss: 0.3737581 Vali Loss: 0.1923892 Test Loss: 0.2675000
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.4066544
	speed: 0.0829s/iter; left time: 1440.8324s
	iters: 200, epoch: 34 | loss: 0.2199365
	speed: 0.0230s/iter; left time: 397.2811s
Epoch: 34 cost time: 6.0039222240448
Epoch: 34, Steps: 261 | Train Loss: 0.3736462 Vali Loss: 0.1924621 Test Loss: 0.2675649
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3190724
	speed: 0.0882s/iter; left time: 1510.2442s
	iters: 200, epoch: 35 | loss: 0.2751568
	speed: 0.0205s/iter; left time: 349.4463s
Epoch: 35 cost time: 7.003502607345581
Epoch: 35, Steps: 261 | Train Loss: 0.3743150 Vali Loss: 0.1923756 Test Loss: 0.2674454
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.4971986
	speed: 0.0936s/iter; left time: 1578.2553s
	iters: 200, epoch: 36 | loss: 0.3531803
	speed: 0.0174s/iter; left time: 292.2597s
Epoch: 36 cost time: 6.338934898376465
Epoch: 36, Steps: 261 | Train Loss: 0.3738579 Vali Loss: 0.1924765 Test Loss: 0.2674192
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3521232
	speed: 0.0892s/iter; left time: 1480.4838s
	iters: 200, epoch: 37 | loss: 0.5391935
	speed: 0.0196s/iter; left time: 323.5595s
Epoch: 37 cost time: 5.653876543045044
Epoch: 37, Steps: 261 | Train Loss: 0.3738431 Vali Loss: 0.1924705 Test Loss: 0.2674085
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.4667978
	speed: 0.0774s/iter; left time: 1265.0132s
	iters: 200, epoch: 38 | loss: 0.2736641
	speed: 0.0177s/iter; left time: 288.2234s
Epoch: 38 cost time: 5.393468379974365
Epoch: 38, Steps: 261 | Train Loss: 0.3737344 Vali Loss: 0.1922745 Test Loss: 0.2674709
Validation loss decreased (0.192296 --> 0.192274).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.4980132
	speed: 0.0769s/iter; left time: 1237.4900s
	iters: 200, epoch: 39 | loss: 0.3269297
	speed: 0.0184s/iter; left time: 294.7917s
Epoch: 39 cost time: 5.2389585971832275
Epoch: 39, Steps: 261 | Train Loss: 0.3737627 Vali Loss: 0.1923062 Test Loss: 0.2674349
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.4212120
	speed: 0.0847s/iter; left time: 1339.7267s
	iters: 200, epoch: 40 | loss: 0.3015848
	speed: 0.0198s/iter; left time: 311.0939s
Epoch: 40 cost time: 6.101376295089722
Epoch: 40, Steps: 261 | Train Loss: 0.3741626 Vali Loss: 0.1924027 Test Loss: 0.2674181
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3559215
	speed: 0.0876s/iter; left time: 1362.3828s
	iters: 200, epoch: 41 | loss: 0.3276137
	speed: 0.0232s/iter; left time: 358.0517s
Epoch: 41 cost time: 6.4159910678863525
Epoch: 41, Steps: 261 | Train Loss: 0.3736780 Vali Loss: 0.1922832 Test Loss: 0.2674438
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.5364872
	speed: 0.0832s/iter; left time: 1272.7391s
	iters: 200, epoch: 42 | loss: 0.4289061
	speed: 0.0220s/iter; left time: 333.6492s
Epoch: 42 cost time: 5.869702100753784
Epoch: 42, Steps: 261 | Train Loss: 0.3737520 Vali Loss: 0.1924015 Test Loss: 0.2674290
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.4964337
	speed: 0.0796s/iter; left time: 1197.4320s
	iters: 200, epoch: 43 | loss: 0.3151522
	speed: 0.0179s/iter; left time: 267.5304s
Epoch: 43 cost time: 5.435571908950806
Epoch: 43, Steps: 261 | Train Loss: 0.3740123 Vali Loss: 0.1924497 Test Loss: 0.2674195
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3451380
	speed: 0.0870s/iter; left time: 1284.9602s
	iters: 200, epoch: 44 | loss: 0.2715254
	speed: 0.0192s/iter; left time: 281.4201s
Epoch: 44 cost time: 5.900043249130249
Epoch: 44, Steps: 261 | Train Loss: 0.3733079 Vali Loss: 0.1923437 Test Loss: 0.2673919
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2921128
	speed: 0.0823s/iter; left time: 1194.6092s
	iters: 200, epoch: 45 | loss: 0.4033171
	speed: 0.0236s/iter; left time: 340.2150s
Epoch: 45 cost time: 6.057245969772339
Epoch: 45, Steps: 261 | Train Loss: 0.3734469 Vali Loss: 0.1923756 Test Loss: 0.2674097
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3930499
	speed: 0.0845s/iter; left time: 1204.2506s
	iters: 200, epoch: 46 | loss: 0.4431330
	speed: 0.0226s/iter; left time: 320.4586s
Epoch: 46 cost time: 6.126769542694092
Epoch: 46, Steps: 261 | Train Loss: 0.3739663 Vali Loss: 0.1923805 Test Loss: 0.2674074
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3852370
	speed: 0.0908s/iter; left time: 1270.1038s
	iters: 200, epoch: 47 | loss: 0.4833737
	speed: 0.0212s/iter; left time: 294.9100s
Epoch: 47 cost time: 6.028516530990601
Epoch: 47, Steps: 261 | Train Loss: 0.3738692 Vali Loss: 0.1923565 Test Loss: 0.2673983
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3203049
	speed: 0.0922s/iter; left time: 1266.6781s
	iters: 200, epoch: 48 | loss: 0.3877850
	speed: 0.0218s/iter; left time: 297.3216s
Epoch: 48 cost time: 6.05463171005249
Epoch: 48, Steps: 261 | Train Loss: 0.3739140 Vali Loss: 0.1923603 Test Loss: 0.2673865
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.4648236
	speed: 0.0769s/iter; left time: 1036.3151s
	iters: 200, epoch: 49 | loss: 0.3411207
	speed: 0.0196s/iter; left time: 262.2324s
Epoch: 49 cost time: 5.473209857940674
Epoch: 49, Steps: 261 | Train Loss: 0.3738366 Vali Loss: 0.1921152 Test Loss: 0.2673911
Validation loss decreased (0.192274 --> 0.192115).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.3207347
	speed: 0.0816s/iter; left time: 1078.0388s
	iters: 200, epoch: 50 | loss: 0.3381368
	speed: 0.0230s/iter; left time: 300.9765s
Epoch: 50 cost time: 5.9388427734375
Epoch: 50, Steps: 261 | Train Loss: 0.3733552 Vali Loss: 0.1923275 Test Loss: 0.2673641
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.3473563
	speed: 0.0799s/iter; left time: 1035.2436s
	iters: 200, epoch: 51 | loss: 0.3453573
	speed: 0.0191s/iter; left time: 245.4423s
Epoch: 51 cost time: 5.550356864929199
Epoch: 51, Steps: 261 | Train Loss: 0.3736619 Vali Loss: 0.1925128 Test Loss: 0.2673659
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.3922341
	speed: 0.0840s/iter; left time: 1066.5487s
	iters: 200, epoch: 52 | loss: 0.4019547
	speed: 0.0273s/iter; left time: 343.3946s
Epoch: 52 cost time: 6.554702281951904
Epoch: 52, Steps: 261 | Train Loss: 0.3737317 Vali Loss: 0.1923341 Test Loss: 0.2673521
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2820918
	speed: 0.0773s/iter; left time: 960.2536s
	iters: 200, epoch: 53 | loss: 0.3681523
	speed: 0.0165s/iter; left time: 203.3994s
Epoch: 53 cost time: 5.08002495765686
Epoch: 53, Steps: 261 | Train Loss: 0.3734098 Vali Loss: 0.1923956 Test Loss: 0.2673603
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2886159
	speed: 0.0780s/iter; left time: 949.3901s
	iters: 200, epoch: 54 | loss: 0.2837394
	speed: 0.0191s/iter; left time: 230.7080s
Epoch: 54 cost time: 5.365166664123535
Epoch: 54, Steps: 261 | Train Loss: 0.3737235 Vali Loss: 0.1921988 Test Loss: 0.2673487
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.4203465
	speed: 0.0766s/iter; left time: 912.2174s
	iters: 200, epoch: 55 | loss: 0.3070484
	speed: 0.0177s/iter; left time: 208.5121s
Epoch: 55 cost time: 5.235597848892212
Epoch: 55, Steps: 261 | Train Loss: 0.3738198 Vali Loss: 0.1919993 Test Loss: 0.2673477
Validation loss decreased (0.192115 --> 0.191999).  Saving model ...
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3561472
	speed: 0.0770s/iter; left time: 896.5449s
	iters: 200, epoch: 56 | loss: 0.4272054
	speed: 0.0174s/iter; left time: 200.3627s
Epoch: 56 cost time: 5.144507169723511
Epoch: 56, Steps: 261 | Train Loss: 0.3737446 Vali Loss: 0.1921863 Test Loss: 0.2673324
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3807908
	speed: 0.0780s/iter; left time: 888.5659s
	iters: 200, epoch: 57 | loss: 0.3169842
	speed: 0.0160s/iter; left time: 180.8031s
Epoch: 57 cost time: 5.301776170730591
Epoch: 57, Steps: 261 | Train Loss: 0.3737092 Vali Loss: 0.1923785 Test Loss: 0.2673473
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.5271005
	speed: 0.0516s/iter; left time: 573.5418s
	iters: 200, epoch: 58 | loss: 0.3059980
	speed: 0.0114s/iter; left time: 126.0955s
Epoch: 58 cost time: 3.367304563522339
Epoch: 58, Steps: 261 | Train Loss: 0.3738865 Vali Loss: 0.1922743 Test Loss: 0.2673279
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.3338773
	speed: 0.0502s/iter; left time: 545.3103s
	iters: 200, epoch: 59 | loss: 0.2833782
	speed: 0.0114s/iter; left time: 122.2936s
Epoch: 59 cost time: 3.8625271320343018
Epoch: 59, Steps: 261 | Train Loss: 0.3736654 Vali Loss: 0.1923534 Test Loss: 0.2673374
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.4791276
	speed: 0.0556s/iter; left time: 589.5146s
	iters: 200, epoch: 60 | loss: 0.5436000
	speed: 0.0136s/iter; left time: 143.3494s
Epoch: 60 cost time: 3.78991436958313
Epoch: 60, Steps: 261 | Train Loss: 0.3731570 Vali Loss: 0.1922401 Test Loss: 0.2673414
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.4364324
	speed: 0.0506s/iter; left time: 523.5857s
	iters: 200, epoch: 61 | loss: 0.4969749
	speed: 0.0122s/iter; left time: 124.9917s
Epoch: 61 cost time: 3.5671255588531494
Epoch: 61, Steps: 261 | Train Loss: 0.3731218 Vali Loss: 0.1922141 Test Loss: 0.2673231
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2498530
	speed: 0.0458s/iter; left time: 461.3467s
	iters: 200, epoch: 62 | loss: 0.2319845
	speed: 0.0110s/iter; left time: 110.1372s
Epoch: 62 cost time: 3.3387420177459717
Epoch: 62, Steps: 261 | Train Loss: 0.3736907 Vali Loss: 0.1923759 Test Loss: 0.2673355
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.3667823
	speed: 0.0498s/iter; left time: 489.4524s
	iters: 200, epoch: 63 | loss: 0.2885389
	speed: 0.0113s/iter; left time: 109.6918s
Epoch: 63 cost time: 3.5186688899993896
Epoch: 63, Steps: 261 | Train Loss: 0.3737555 Vali Loss: 0.1923285 Test Loss: 0.2673281
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2707623
	speed: 0.0488s/iter; left time: 466.2836s
	iters: 200, epoch: 64 | loss: 0.3362690
	speed: 0.0113s/iter; left time: 106.6892s
Epoch: 64 cost time: 3.735309362411499
Epoch: 64, Steps: 261 | Train Loss: 0.3737401 Vali Loss: 0.1922791 Test Loss: 0.2673405
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2982487
	speed: 0.0513s/iter; left time: 476.4865s
	iters: 200, epoch: 65 | loss: 0.4651718
	speed: 0.0114s/iter; left time: 104.5065s
Epoch: 65 cost time: 3.292017698287964
Epoch: 65, Steps: 261 | Train Loss: 0.3734422 Vali Loss: 0.1923997 Test Loss: 0.2673438
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.4864877
	speed: 0.0451s/iter; left time: 407.3274s
	iters: 200, epoch: 66 | loss: 0.3680009
	speed: 0.0135s/iter; left time: 120.4869s
Epoch: 66 cost time: 3.4336657524108887
Epoch: 66, Steps: 261 | Train Loss: 0.3738679 Vali Loss: 0.1924094 Test Loss: 0.2673374
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.3822348
	speed: 0.0471s/iter; left time: 412.9360s
	iters: 200, epoch: 67 | loss: 0.3515089
	speed: 0.0112s/iter; left time: 97.5091s
Epoch: 67 cost time: 3.6073336601257324
Epoch: 67, Steps: 261 | Train Loss: 0.3728741 Vali Loss: 0.1922394 Test Loss: 0.2673398
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2580718
	speed: 0.0490s/iter; left time: 417.4187s
	iters: 200, epoch: 68 | loss: 0.3287499
	speed: 0.0108s/iter; left time: 90.5576s
Epoch: 68 cost time: 3.3464648723602295
Epoch: 68, Steps: 261 | Train Loss: 0.3734363 Vali Loss: 0.1923024 Test Loss: 0.2673412
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2190218
	speed: 0.0474s/iter; left time: 391.0606s
	iters: 200, epoch: 69 | loss: 0.3559870
	speed: 0.0128s/iter; left time: 104.3511s
Epoch: 69 cost time: 3.612470865249634
Epoch: 69, Steps: 261 | Train Loss: 0.3730566 Vali Loss: 0.1921713 Test Loss: 0.2673340
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.3139779
	speed: 0.0516s/iter; left time: 412.6476s
	iters: 200, epoch: 70 | loss: 0.3103806
	speed: 0.0119s/iter; left time: 94.1151s
Epoch: 70 cost time: 3.203737258911133
Epoch: 70, Steps: 261 | Train Loss: 0.3733082 Vali Loss: 0.1924224 Test Loss: 0.2673333
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.3610225
	speed: 0.0453s/iter; left time: 350.4611s
	iters: 200, epoch: 71 | loss: 0.3900782
	speed: 0.0125s/iter; left time: 95.1640s
Epoch: 71 cost time: 3.5074732303619385
Epoch: 71, Steps: 261 | Train Loss: 0.3733173 Vali Loss: 0.1924095 Test Loss: 0.2673303
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.3817546
	speed: 0.0475s/iter; left time: 354.8286s
	iters: 200, epoch: 72 | loss: 0.3458505
	speed: 0.0137s/iter; left time: 100.8469s
Epoch: 72 cost time: 3.58577823638916
Epoch: 72, Steps: 261 | Train Loss: 0.3738019 Vali Loss: 0.1922967 Test Loss: 0.2673338
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.4376107
	speed: 0.0551s/iter; left time: 397.5708s
	iters: 200, epoch: 73 | loss: 0.5646208
	speed: 0.0140s/iter; left time: 99.2563s
Epoch: 73 cost time: 3.7805681228637695
Epoch: 73, Steps: 261 | Train Loss: 0.3735799 Vali Loss: 0.1922203 Test Loss: 0.2673278
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.4921268
	speed: 0.0526s/iter; left time: 365.2214s
	iters: 200, epoch: 74 | loss: 0.4152093
	speed: 0.0144s/iter; left time: 98.8953s
Epoch: 74 cost time: 3.763936758041382
Epoch: 74, Steps: 261 | Train Loss: 0.3737284 Vali Loss: 0.1922660 Test Loss: 0.2673293
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2753597
	speed: 0.0485s/iter; left time: 324.0281s
	iters: 200, epoch: 75 | loss: 0.3758561
	speed: 0.0122s/iter; left time: 80.6808s
Epoch: 75 cost time: 3.6092042922973633
Epoch: 75, Steps: 261 | Train Loss: 0.3736766 Vali Loss: 0.1923005 Test Loss: 0.2673318
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2683664560317993, mae:0.3259780704975128, rse:0.4184318780899048, corr:[0.55966645 0.5583262  0.55290365 0.55195045 0.55363953 0.5540759
 0.5527021  0.5514081  0.55141574 0.5522958  0.55271226 0.55214196
 0.551329   0.5510549  0.5514622  0.55182546 0.55150044 0.5505897
 0.54964894 0.54911214 0.5489258  0.5486284  0.54798186 0.5471988
 0.54661316 0.5463922  0.54633355 0.54605496 0.5454093  0.54462403
 0.54400235 0.5437327  0.5435775  0.5431873  0.54250693 0.54175586
 0.5411181  0.5406635  0.5402319  0.5396704  0.538987   0.53830403
 0.5377903  0.53743726 0.53707737 0.5365113  0.5357337  0.5348971
 0.5341275  0.53349274 0.5329365  0.5323648  0.53165525 0.5308497
 0.5301139  0.52959514 0.5292105  0.52883    0.5284132  0.5280212
 0.5277481  0.527663   0.5276433  0.5275151  0.52725065 0.5269639
 0.526704   0.5265158  0.52634114 0.52610683 0.5258034  0.52550423
 0.52523154 0.52495307 0.5245495  0.52403706 0.52348423 0.5229747
 0.52251124 0.5220589  0.52145743 0.5207475  0.5200179  0.5193915
 0.5189243  0.51853085 0.5180643  0.51752186 0.5169715  0.5164953
 0.5161152  0.51572984 0.5151678  0.5143952  0.51344156 0.5123221
 0.5110745  0.50978    0.50843436 0.5071289  0.50597686 0.5049768
 0.50402457 0.5029425  0.50169945 0.50038403 0.4992288  0.49835813
 0.49763334 0.49687415 0.4959965  0.49501657 0.49408713 0.493237
 0.49240693 0.49159458 0.49081492 0.49003124 0.48928759 0.48851776
 0.48776603 0.48697588 0.486231   0.48553252 0.48485637 0.4841412
 0.48334417 0.48239407 0.48129523 0.48018402 0.47923145 0.47848997
 0.4778947  0.4773022  0.47661754 0.47586814 0.47514728 0.47458708
 0.4741408  0.47370604 0.473144   0.4724665  0.4717707  0.4710568
 0.47034422 0.46955016 0.46880436 0.46811426 0.46749994 0.4668871
 0.46627223 0.4656682  0.4649994  0.46429014 0.46363273 0.46309778
 0.46260738 0.46211234 0.4616047  0.46121982 0.46091318 0.46062252
 0.4602129  0.45970562 0.45919725 0.4588098  0.45851997 0.4582915
 0.4580912  0.45793754 0.4577521  0.45756015 0.45734134 0.4570223
 0.45654154 0.45590872 0.4552243  0.45461962 0.45411083 0.45372158
 0.45324028 0.45255437 0.45179737 0.45108435 0.45047414 0.44997668
 0.4495838  0.44927385 0.4489368  0.44840762 0.4475515  0.4462992
 0.444775   0.44330844 0.4419829  0.44083983 0.43990198 0.43896478
 0.4378782  0.43654597 0.43508047 0.43363672 0.43238312 0.43136454
 0.430484   0.42956415 0.42846793 0.4272656  0.4262159  0.42549133
 0.4248963  0.42428783 0.42361492 0.42287037 0.42210287 0.42122376
 0.42021278 0.41907114 0.41796887 0.41689846 0.41576344 0.41458324
 0.41340762 0.41235462 0.41154388 0.4108022  0.41005617 0.4092754
 0.40832663 0.4073366  0.4063811  0.40559474 0.4049694  0.40445912
 0.40391275 0.4033259  0.40268987 0.40210137 0.40167522 0.40136108
 0.40106544 0.40058026 0.3999612  0.39949062 0.39915523 0.3990244
 0.39903253 0.39905527 0.39891437 0.3985915  0.39838594 0.39836955
 0.3984378  0.39849737 0.39826292 0.39778918 0.39723197 0.3968844
 0.39680168 0.39682245 0.3967294  0.39642873 0.39595616 0.39553806
 0.39526644 0.39504275 0.39486876 0.394689   0.39445674 0.39416468
 0.3938704  0.39363796 0.3933176  0.39294684 0.39253274 0.39214694
 0.39196777 0.3918072  0.39155176 0.39128992 0.39100993 0.39075884
 0.39044645 0.39006245 0.38967425 0.38934937 0.38907218 0.38853565
 0.3876278  0.3865854  0.3854794  0.38447642 0.38375437 0.38320962
 0.3827766  0.38221285 0.3814215  0.38061565 0.38016364 0.37989432
 0.379761   0.37951103 0.37920216 0.37872007 0.37819216 0.37769398
 0.3773394  0.37708178 0.37714276 0.37751457 0.37781978 0.37784413
 0.37724346 0.37648985 0.3761515  0.37641174 0.37689966 0.37702572
 0.37644473 0.37573177 0.37567478 0.37633476 0.37689665 0.37671512
 0.37582186 0.3752192  0.3758134  0.37703338 0.3777744  0.37715465
 0.37607113 0.37596714 0.37694508 0.3770965  0.3729686  0.36426765]
