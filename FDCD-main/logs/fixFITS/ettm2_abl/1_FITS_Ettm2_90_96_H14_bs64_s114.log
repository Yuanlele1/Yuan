Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=24, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=24, out_features=49, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1053696.0
params:  1225.0
Trainable parameters:  1225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2981198
	speed: 0.0435s/iter; left time: 1160.6701s
	iters: 200, epoch: 1 | loss: 0.2616555
	speed: 0.0182s/iter; left time: 483.7775s
Epoch: 1 cost time: 8.897307634353638
Epoch: 1, Steps: 268 | Train Loss: 0.2911888 Vali Loss: 0.1371321 Test Loss: 0.1965725
Validation loss decreased (inf --> 0.137132).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2355732
	speed: 0.1568s/iter; left time: 4144.6898s
	iters: 200, epoch: 2 | loss: 0.1903382
	speed: 0.0163s/iter; left time: 428.7736s
Epoch: 2 cost time: 6.152963161468506
Epoch: 2, Steps: 268 | Train Loss: 0.2541064 Vali Loss: 0.1312141 Test Loss: 0.1882048
Validation loss decreased (0.137132 --> 0.131214).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2408326
	speed: 0.1928s/iter; left time: 5045.0660s
	iters: 200, epoch: 3 | loss: 0.3342801
	speed: 0.0314s/iter; left time: 818.3674s
Epoch: 3 cost time: 8.234418392181396
Epoch: 3, Steps: 268 | Train Loss: 0.2473941 Vali Loss: 0.1299075 Test Loss: 0.1859903
Validation loss decreased (0.131214 --> 0.129908).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2007576
	speed: 0.1641s/iter; left time: 4250.7808s
	iters: 200, epoch: 4 | loss: 0.2517163
	speed: 0.0295s/iter; left time: 762.1200s
Epoch: 4 cost time: 10.938583135604858
Epoch: 4, Steps: 268 | Train Loss: 0.2448411 Vali Loss: 0.1294938 Test Loss: 0.1852416
Validation loss decreased (0.129908 --> 0.129494).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2219338
	speed: 0.2203s/iter; left time: 5645.1833s
	iters: 200, epoch: 5 | loss: 0.2260819
	speed: 0.0268s/iter; left time: 683.7443s
Epoch: 5 cost time: 8.497452020645142
Epoch: 5, Steps: 268 | Train Loss: 0.2437735 Vali Loss: 0.1293920 Test Loss: 0.1847882
Validation loss decreased (0.129494 --> 0.129392).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1705007
	speed: 0.1455s/iter; left time: 3690.0177s
	iters: 200, epoch: 6 | loss: 0.2335052
	speed: 0.0339s/iter; left time: 855.1667s
Epoch: 6 cost time: 9.820651531219482
Epoch: 6, Steps: 268 | Train Loss: 0.2427541 Vali Loss: 0.1294087 Test Loss: 0.1845065
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2570957
	speed: 0.1614s/iter; left time: 4049.5852s
	iters: 200, epoch: 7 | loss: 0.2286663
	speed: 0.0414s/iter; left time: 1033.5179s
Epoch: 7 cost time: 11.469332695007324
Epoch: 7, Steps: 268 | Train Loss: 0.2419018 Vali Loss: 0.1295077 Test Loss: 0.1844593
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2555504
	speed: 0.2082s/iter; left time: 5169.7352s
	iters: 200, epoch: 8 | loss: 0.3346904
	speed: 0.0643s/iter; left time: 1588.8063s
Epoch: 8 cost time: 15.373959064483643
Epoch: 8, Steps: 268 | Train Loss: 0.2418426 Vali Loss: 0.1294646 Test Loss: 0.1842858
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3529298
	speed: 0.2156s/iter; left time: 5295.3316s
	iters: 200, epoch: 9 | loss: 0.1492634
	speed: 0.0426s/iter; left time: 1040.7951s
Epoch: 9 cost time: 12.658143758773804
Epoch: 9, Steps: 268 | Train Loss: 0.2412445 Vali Loss: 0.1296406 Test Loss: 0.1843238
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2277043
	speed: 0.1336s/iter; left time: 3245.2327s
	iters: 200, epoch: 10 | loss: 0.1865720
	speed: 0.0248s/iter; left time: 600.0581s
Epoch: 10 cost time: 8.304500341415405
Epoch: 10, Steps: 268 | Train Loss: 0.2413955 Vali Loss: 0.1294283 Test Loss: 0.1841350
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3862011
	speed: 0.1458s/iter; left time: 3502.0814s
	iters: 200, epoch: 11 | loss: 0.1552104
	speed: 0.0313s/iter; left time: 747.7099s
Epoch: 11 cost time: 8.19292688369751
Epoch: 11, Steps: 268 | Train Loss: 0.2410190 Vali Loss: 0.1294980 Test Loss: 0.1841178
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2805029
	speed: 0.2042s/iter; left time: 4851.2899s
	iters: 200, epoch: 12 | loss: 0.2408128
	speed: 0.0584s/iter; left time: 1380.7698s
Epoch: 12 cost time: 13.055534362792969
Epoch: 12, Steps: 268 | Train Loss: 0.2410370 Vali Loss: 0.1296270 Test Loss: 0.1841811
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2056737
	speed: 0.1809s/iter; left time: 4248.7509s
	iters: 200, epoch: 13 | loss: 0.1746549
	speed: 0.0342s/iter; left time: 798.6100s
Epoch: 13 cost time: 10.529395580291748
Epoch: 13, Steps: 268 | Train Loss: 0.2407638 Vali Loss: 0.1296197 Test Loss: 0.1841213
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1753823
	speed: 0.1713s/iter; left time: 3976.1040s
	iters: 200, epoch: 14 | loss: 0.2061976
	speed: 0.0410s/iter; left time: 947.2140s
Epoch: 14 cost time: 10.973432540893555
Epoch: 14, Steps: 268 | Train Loss: 0.2404958 Vali Loss: 0.1295459 Test Loss: 0.1841023
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2888501
	speed: 0.1533s/iter; left time: 3518.1008s
	iters: 200, epoch: 15 | loss: 0.2118009
	speed: 0.0217s/iter; left time: 495.8751s
Epoch: 15 cost time: 7.313326358795166
Epoch: 15, Steps: 268 | Train Loss: 0.2406976 Vali Loss: 0.1294626 Test Loss: 0.1840433
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2218980
	speed: 0.1208s/iter; left time: 2740.7497s
	iters: 200, epoch: 16 | loss: 0.2476429
	speed: 0.0291s/iter; left time: 658.0465s
Epoch: 16 cost time: 8.289294242858887
Epoch: 16, Steps: 268 | Train Loss: 0.2407062 Vali Loss: 0.1295916 Test Loss: 0.1840499
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2060188
	speed: 0.1907s/iter; left time: 4274.5842s
	iters: 200, epoch: 17 | loss: 0.2769454
	speed: 0.0602s/iter; left time: 1343.6426s
Epoch: 17 cost time: 14.576865911483765
Epoch: 17, Steps: 268 | Train Loss: 0.2405728 Vali Loss: 0.1296071 Test Loss: 0.1840491
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3310893
	speed: 0.1911s/iter; left time: 4232.7570s
	iters: 200, epoch: 18 | loss: 0.3133750
	speed: 0.0356s/iter; left time: 785.3710s
Epoch: 18 cost time: 13.275521755218506
Epoch: 18, Steps: 268 | Train Loss: 0.2403824 Vali Loss: 0.1295407 Test Loss: 0.1840439
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2740607
	speed: 0.2150s/iter; left time: 4703.8045s
	iters: 200, epoch: 19 | loss: 0.1891426
	speed: 0.0287s/iter; left time: 624.9649s
Epoch: 19 cost time: 10.189310073852539
Epoch: 19, Steps: 268 | Train Loss: 0.2404061 Vali Loss: 0.1297186 Test Loss: 0.1840667
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1548661
	speed: 0.1537s/iter; left time: 3320.8704s
	iters: 200, epoch: 20 | loss: 0.2233479
	speed: 0.0257s/iter; left time: 551.7450s
Epoch: 20 cost time: 8.93166971206665
Epoch: 20, Steps: 268 | Train Loss: 0.2403686 Vali Loss: 0.1295243 Test Loss: 0.1840154
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1978530
	speed: 0.1415s/iter; left time: 3019.9546s
	iters: 200, epoch: 21 | loss: 0.2822893
	speed: 0.0242s/iter; left time: 513.7049s
Epoch: 21 cost time: 8.392074584960938
Epoch: 21, Steps: 268 | Train Loss: 0.2405098 Vali Loss: 0.1298147 Test Loss: 0.1841184
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2256223
	speed: 0.1346s/iter; left time: 2835.6701s
	iters: 200, epoch: 22 | loss: 0.1557017
	speed: 0.0366s/iter; left time: 768.1966s
Epoch: 22 cost time: 9.0148446559906
Epoch: 22, Steps: 268 | Train Loss: 0.2402721 Vali Loss: 0.1297688 Test Loss: 0.1841035
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2555599
	speed: 0.1598s/iter; left time: 3325.6533s
	iters: 200, epoch: 23 | loss: 0.1889459
	speed: 0.0432s/iter; left time: 893.5245s
Epoch: 23 cost time: 10.701608180999756
Epoch: 23, Steps: 268 | Train Loss: 0.2403593 Vali Loss: 0.1297546 Test Loss: 0.1840400
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1578355
	speed: 0.1804s/iter; left time: 3705.7597s
	iters: 200, epoch: 24 | loss: 0.2056099
	speed: 0.0365s/iter; left time: 745.1627s
Epoch: 24 cost time: 12.374204635620117
Epoch: 24, Steps: 268 | Train Loss: 0.2403172 Vali Loss: 0.1296321 Test Loss: 0.1840550
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2351413
	speed: 0.1747s/iter; left time: 3540.8266s
	iters: 200, epoch: 25 | loss: 0.1783065
	speed: 0.0227s/iter; left time: 457.6324s
Epoch: 25 cost time: 6.989605188369751
Epoch: 25, Steps: 268 | Train Loss: 0.2402856 Vali Loss: 0.1297407 Test Loss: 0.1840784
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18564632534980774, mae:0.26913613080978394, rse:0.3493328094482422, corr:[0.56866485 0.56982243 0.56046945 0.5610767  0.56210023 0.5585049
 0.55681527 0.5580871  0.5574268  0.555412   0.5554934  0.5560312
 0.55469376 0.55354446 0.5540769  0.5538843  0.55212116 0.5510242
 0.55117553 0.5503966  0.5485605  0.5476052  0.54755104 0.5468681
 0.5457529  0.5455029  0.5456377  0.5450364  0.5442219  0.54393905
 0.54336625 0.5421697  0.54134583 0.54134107 0.54108155 0.5402118
 0.5394668  0.5391245  0.5384829  0.53744096 0.5367306  0.5366077
 0.536466   0.5361717  0.5359863  0.535681   0.53502995 0.53416777
 0.53345954 0.5326637  0.5315686  0.5306735  0.5302181  0.5297268
 0.5289529  0.5282253  0.527806   0.52752465 0.5270251  0.52660197
 0.5264103  0.5262486  0.526001   0.5258959  0.5259045  0.5258588
 0.52560514 0.5252901  0.5252337  0.52524656 0.52508265 0.5249848
 0.52523017 0.5255448  0.5253773  0.5250022  0.52502304 0.52508384
 0.52473146 0.5242946  0.5242846  0.52432317 0.5240046  0.52367866
 0.5236985  0.52361965 0.523179   0.5229818  0.5230616  0.5228646
 0.5225229  0.52285993 0.5229633  0.52215064 0.52200776 0.5210559 ]
