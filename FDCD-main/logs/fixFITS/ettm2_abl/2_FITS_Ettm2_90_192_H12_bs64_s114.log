Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_192_FITS_ETTm2_ftM_sl90_ll48_pl192_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=68, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1340416.0
params:  1564.0
Trainable parameters:  1564
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4350541
	speed: 0.0241s/iter; left time: 640.7222s
	iters: 200, epoch: 1 | loss: 0.2861895
	speed: 0.0178s/iter; left time: 472.8716s
Epoch: 1 cost time: 5.822064161300659
Epoch: 1, Steps: 267 | Train Loss: 0.3415659 Vali Loss: 0.2171904 Test Loss: 0.3011222
Validation loss decreased (inf --> 0.217190).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2146895
	speed: 0.0919s/iter; left time: 2419.4991s
	iters: 200, epoch: 2 | loss: 0.2343423
	speed: 0.0162s/iter; left time: 425.6756s
Epoch: 2 cost time: 5.261645317077637
Epoch: 2, Steps: 267 | Train Loss: 0.2741436 Vali Loss: 0.1974860 Test Loss: 0.2771921
Validation loss decreased (0.217190 --> 0.197486).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1821259
	speed: 0.0925s/iter; left time: 2411.9221s
	iters: 200, epoch: 3 | loss: 0.3421147
	speed: 0.0158s/iter; left time: 409.7298s
Epoch: 3 cost time: 4.834170818328857
Epoch: 3, Steps: 267 | Train Loss: 0.2558996 Vali Loss: 0.1893677 Test Loss: 0.2674254
Validation loss decreased (0.197486 --> 0.189368).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1462436
	speed: 0.0851s/iter; left time: 2194.3989s
	iters: 200, epoch: 4 | loss: 0.1947484
	speed: 0.0152s/iter; left time: 391.1194s
Epoch: 4 cost time: 4.814199686050415
Epoch: 4, Steps: 267 | Train Loss: 0.2471600 Vali Loss: 0.1841654 Test Loss: 0.2612901
Validation loss decreased (0.189368 --> 0.184165).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3238935
	speed: 0.0892s/iter; left time: 2277.1930s
	iters: 200, epoch: 5 | loss: 0.2322528
	speed: 0.0155s/iter; left time: 394.1484s
Epoch: 5 cost time: 5.2560718059539795
Epoch: 5, Steps: 267 | Train Loss: 0.2423454 Vali Loss: 0.1808093 Test Loss: 0.2570636
Validation loss decreased (0.184165 --> 0.180809).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3248013
	speed: 0.1073s/iter; left time: 2711.3408s
	iters: 200, epoch: 6 | loss: 0.2809600
	speed: 0.0225s/iter; left time: 566.4983s
Epoch: 6 cost time: 6.225641489028931
Epoch: 6, Steps: 267 | Train Loss: 0.2389234 Vali Loss: 0.1784370 Test Loss: 0.2542843
Validation loss decreased (0.180809 --> 0.178437).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2123825
	speed: 0.1015s/iter; left time: 2536.5017s
	iters: 200, epoch: 7 | loss: 0.2299914
	speed: 0.0229s/iter; left time: 569.8327s
Epoch: 7 cost time: 7.206580638885498
Epoch: 7, Steps: 267 | Train Loss: 0.2365986 Vali Loss: 0.1767720 Test Loss: 0.2522241
Validation loss decreased (0.178437 --> 0.176772).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2361190
	speed: 0.1073s/iter; left time: 2652.5692s
	iters: 200, epoch: 8 | loss: 0.2095539
	speed: 0.0163s/iter; left time: 402.3115s
Epoch: 8 cost time: 5.973636627197266
Epoch: 8, Steps: 267 | Train Loss: 0.2347916 Vali Loss: 0.1755659 Test Loss: 0.2508695
Validation loss decreased (0.176772 --> 0.175566).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2561090
	speed: 0.0926s/iter; left time: 2265.6765s
	iters: 200, epoch: 9 | loss: 0.1907879
	speed: 0.0191s/iter; left time: 466.5835s
Epoch: 9 cost time: 6.089195013046265
Epoch: 9, Steps: 267 | Train Loss: 0.2339994 Vali Loss: 0.1747567 Test Loss: 0.2499505
Validation loss decreased (0.175566 --> 0.174757).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1924047
	speed: 0.0934s/iter; left time: 2260.1737s
	iters: 200, epoch: 10 | loss: 0.3503916
	speed: 0.0192s/iter; left time: 462.0117s
Epoch: 10 cost time: 5.449635744094849
Epoch: 10, Steps: 267 | Train Loss: 0.2332188 Vali Loss: 0.1743464 Test Loss: 0.2493678
Validation loss decreased (0.174757 --> 0.174346).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1778049
	speed: 0.0846s/iter; left time: 2025.0569s
	iters: 200, epoch: 11 | loss: 0.1675934
	speed: 0.0194s/iter; left time: 462.4362s
Epoch: 11 cost time: 6.53522253036499
Epoch: 11, Steps: 267 | Train Loss: 0.2332055 Vali Loss: 0.1736546 Test Loss: 0.2488708
Validation loss decreased (0.174346 --> 0.173655).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3228222
	speed: 0.1364s/iter; left time: 3227.9828s
	iters: 200, epoch: 12 | loss: 0.2401145
	speed: 0.0162s/iter; left time: 381.6745s
Epoch: 12 cost time: 6.923482894897461
Epoch: 12, Steps: 267 | Train Loss: 0.2327970 Vali Loss: 0.1735890 Test Loss: 0.2485362
Validation loss decreased (0.173655 --> 0.173589).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1659825
	speed: 0.0936s/iter; left time: 2190.5166s
	iters: 200, epoch: 13 | loss: 0.2070060
	speed: 0.0165s/iter; left time: 384.8991s
Epoch: 13 cost time: 5.233154296875
Epoch: 13, Steps: 267 | Train Loss: 0.2326788 Vali Loss: 0.1734649 Test Loss: 0.2484841
Validation loss decreased (0.173589 --> 0.173465).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2622170
	speed: 0.1002s/iter; left time: 2317.6644s
	iters: 200, epoch: 14 | loss: 0.2922745
	speed: 0.0283s/iter; left time: 651.1791s
Epoch: 14 cost time: 6.240527868270874
Epoch: 14, Steps: 267 | Train Loss: 0.2328447 Vali Loss: 0.1734762 Test Loss: 0.2483364
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2155710
	speed: 0.0973s/iter; left time: 2225.2823s
	iters: 200, epoch: 15 | loss: 0.2280012
	speed: 0.0168s/iter; left time: 382.8571s
Epoch: 15 cost time: 5.087770938873291
Epoch: 15, Steps: 267 | Train Loss: 0.2325546 Vali Loss: 0.1733166 Test Loss: 0.2482895
Validation loss decreased (0.173465 --> 0.173317).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2070013
	speed: 0.1050s/iter; left time: 2373.4074s
	iters: 200, epoch: 16 | loss: 0.2115418
	speed: 0.0176s/iter; left time: 396.2188s
Epoch: 16 cost time: 5.86437201499939
Epoch: 16, Steps: 267 | Train Loss: 0.2324390 Vali Loss: 0.1732158 Test Loss: 0.2481941
Validation loss decreased (0.173317 --> 0.173216).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2106040
	speed: 0.0933s/iter; left time: 2082.3437s
	iters: 200, epoch: 17 | loss: 0.2155771
	speed: 0.0160s/iter; left time: 356.1053s
Epoch: 17 cost time: 5.180553197860718
Epoch: 17, Steps: 267 | Train Loss: 0.2321412 Vali Loss: 0.1732263 Test Loss: 0.2482109
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2497201
	speed: 0.0946s/iter; left time: 2087.5775s
	iters: 200, epoch: 18 | loss: 0.2585494
	speed: 0.0179s/iter; left time: 393.7239s
Epoch: 18 cost time: 5.019626617431641
Epoch: 18, Steps: 267 | Train Loss: 0.2324078 Vali Loss: 0.1732299 Test Loss: 0.2481354
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2613212
	speed: 0.0950s/iter; left time: 2070.5713s
	iters: 200, epoch: 19 | loss: 0.2592958
	speed: 0.0182s/iter; left time: 395.1146s
Epoch: 19 cost time: 5.0957865715026855
Epoch: 19, Steps: 267 | Train Loss: 0.2317978 Vali Loss: 0.1732685 Test Loss: 0.2481538
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2661155
	speed: 0.0885s/iter; left time: 1905.0436s
	iters: 200, epoch: 20 | loss: 0.2110767
	speed: 0.0158s/iter; left time: 338.2465s
Epoch: 20 cost time: 5.124305486679077
Epoch: 20, Steps: 267 | Train Loss: 0.2322705 Vali Loss: 0.1732295 Test Loss: 0.2481766
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1715415
	speed: 0.0900s/iter; left time: 1913.4247s
	iters: 200, epoch: 21 | loss: 0.1971822
	speed: 0.0153s/iter; left time: 322.7841s
Epoch: 21 cost time: 4.822666168212891
Epoch: 21, Steps: 267 | Train Loss: 0.2322576 Vali Loss: 0.1733466 Test Loss: 0.2482045
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2546417
	speed: 0.1036s/iter; left time: 2175.9289s
	iters: 200, epoch: 22 | loss: 0.2435833
	speed: 0.0165s/iter; left time: 344.5853s
Epoch: 22 cost time: 5.129050016403198
Epoch: 22, Steps: 267 | Train Loss: 0.2323148 Vali Loss: 0.1732197 Test Loss: 0.2482177
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1815697
	speed: 0.0957s/iter; left time: 1982.7658s
	iters: 200, epoch: 23 | loss: 0.2671868
	speed: 0.0242s/iter; left time: 498.1888s
Epoch: 23 cost time: 6.569577217102051
Epoch: 23, Steps: 267 | Train Loss: 0.2321203 Vali Loss: 0.1733848 Test Loss: 0.2482075
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1507589
	speed: 0.0883s/iter; left time: 1805.9303s
	iters: 200, epoch: 24 | loss: 0.2413930
	speed: 0.0284s/iter; left time: 577.7137s
Epoch: 24 cost time: 6.55411171913147
Epoch: 24, Steps: 267 | Train Loss: 0.2322659 Vali Loss: 0.1732969 Test Loss: 0.2481868
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1801737
	speed: 0.0935s/iter; left time: 1888.0231s
	iters: 200, epoch: 25 | loss: 0.1997204
	speed: 0.0158s/iter; left time: 316.8667s
Epoch: 25 cost time: 5.676618337631226
Epoch: 25, Steps: 267 | Train Loss: 0.2319946 Vali Loss: 0.1731773 Test Loss: 0.2481714
Validation loss decreased (0.173216 --> 0.173177).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3362841
	speed: 0.0954s/iter; left time: 1901.6160s
	iters: 200, epoch: 26 | loss: 0.2835134
	speed: 0.0223s/iter; left time: 442.0050s
Epoch: 26 cost time: 5.376843452453613
Epoch: 26, Steps: 267 | Train Loss: 0.2324159 Vali Loss: 0.1734507 Test Loss: 0.2482359
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3003914
	speed: 0.0883s/iter; left time: 1735.5367s
	iters: 200, epoch: 27 | loss: 0.2086447
	speed: 0.0201s/iter; left time: 393.1477s
Epoch: 27 cost time: 5.508014917373657
Epoch: 27, Steps: 267 | Train Loss: 0.2321774 Vali Loss: 0.1734992 Test Loss: 0.2482090
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3339460
	speed: 0.0900s/iter; left time: 1744.7243s
	iters: 200, epoch: 28 | loss: 0.1910607
	speed: 0.0201s/iter; left time: 387.6867s
Epoch: 28 cost time: 5.578446388244629
Epoch: 28, Steps: 267 | Train Loss: 0.2322427 Vali Loss: 0.1732346 Test Loss: 0.2482012
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2060267
	speed: 0.0984s/iter; left time: 1882.7833s
	iters: 200, epoch: 29 | loss: 0.2134472
	speed: 0.0183s/iter; left time: 349.0743s
Epoch: 29 cost time: 5.934246301651001
Epoch: 29, Steps: 267 | Train Loss: 0.2323047 Vali Loss: 0.1734492 Test Loss: 0.2482367
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2238528
	speed: 0.0875s/iter; left time: 1650.5764s
	iters: 200, epoch: 30 | loss: 0.3006908
	speed: 0.0162s/iter; left time: 302.9739s
Epoch: 30 cost time: 5.1343324184417725
Epoch: 30, Steps: 267 | Train Loss: 0.2321749 Vali Loss: 0.1734628 Test Loss: 0.2482329
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3212219
	speed: 0.0888s/iter; left time: 1650.8476s
	iters: 200, epoch: 31 | loss: 0.2008424
	speed: 0.0157s/iter; left time: 290.5794s
Epoch: 31 cost time: 4.898810863494873
Epoch: 31, Steps: 267 | Train Loss: 0.2321968 Vali Loss: 0.1734183 Test Loss: 0.2482455
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2255120
	speed: 0.0967s/iter; left time: 1771.3495s
	iters: 200, epoch: 32 | loss: 0.2053310
	speed: 0.0256s/iter; left time: 465.8402s
Epoch: 32 cost time: 5.73007345199585
Epoch: 32, Steps: 267 | Train Loss: 0.2321354 Vali Loss: 0.1733796 Test Loss: 0.2482073
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1620841
	speed: 0.1097s/iter; left time: 1981.4880s
	iters: 200, epoch: 33 | loss: 0.1859821
	speed: 0.0167s/iter; left time: 299.9915s
Epoch: 33 cost time: 5.604975938796997
Epoch: 33, Steps: 267 | Train Loss: 0.2321895 Vali Loss: 0.1734282 Test Loss: 0.2482095
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2895411
	speed: 0.1106s/iter; left time: 1966.7669s
	iters: 200, epoch: 34 | loss: 0.2257356
	speed: 0.0218s/iter; left time: 385.0649s
Epoch: 34 cost time: 6.859055042266846
Epoch: 34, Steps: 267 | Train Loss: 0.2321550 Vali Loss: 0.1734355 Test Loss: 0.2481895
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3443619
	speed: 0.0973s/iter; left time: 1704.6333s
	iters: 200, epoch: 35 | loss: 0.2251307
	speed: 0.0172s/iter; left time: 300.0991s
Epoch: 35 cost time: 5.180155515670776
Epoch: 35, Steps: 267 | Train Loss: 0.2321170 Vali Loss: 0.1732115 Test Loss: 0.2482201
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2251749
	speed: 0.0878s/iter; left time: 1515.0133s
	iters: 200, epoch: 36 | loss: 0.1554944
	speed: 0.0212s/iter; left time: 363.7022s
Epoch: 36 cost time: 6.018542528152466
Epoch: 36, Steps: 267 | Train Loss: 0.2322688 Vali Loss: 0.1733582 Test Loss: 0.2482152
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1952574
	speed: 0.0950s/iter; left time: 1613.2806s
	iters: 200, epoch: 37 | loss: 0.2335848
	speed: 0.0187s/iter; left time: 316.3405s
Epoch: 37 cost time: 5.596133470535278
Epoch: 37, Steps: 267 | Train Loss: 0.2323534 Vali Loss: 0.1734879 Test Loss: 0.2482405
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2588092
	speed: 0.1020s/iter; left time: 1706.2038s
	iters: 200, epoch: 38 | loss: 0.1588702
	speed: 0.0184s/iter; left time: 305.0210s
Epoch: 38 cost time: 6.133823394775391
Epoch: 38, Steps: 267 | Train Loss: 0.2323699 Vali Loss: 0.1733997 Test Loss: 0.2482372
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2664532
	speed: 0.1009s/iter; left time: 1659.9377s
	iters: 200, epoch: 39 | loss: 0.1891774
	speed: 0.0168s/iter; left time: 274.2475s
Epoch: 39 cost time: 5.57657790184021
Epoch: 39, Steps: 267 | Train Loss: 0.2320663 Vali Loss: 0.1734812 Test Loss: 0.2482283
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2034162
	speed: 0.1037s/iter; left time: 1677.9880s
	iters: 200, epoch: 40 | loss: 0.2900716
	speed: 0.0228s/iter; left time: 367.2477s
Epoch: 40 cost time: 6.37883734703064
Epoch: 40, Steps: 267 | Train Loss: 0.2322430 Vali Loss: 0.1733828 Test Loss: 0.2482265
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1633138
	speed: 0.0997s/iter; left time: 1586.8823s
	iters: 200, epoch: 41 | loss: 0.1789142
	speed: 0.0173s/iter; left time: 274.1128s
Epoch: 41 cost time: 5.276438474655151
Epoch: 41, Steps: 267 | Train Loss: 0.2322664 Vali Loss: 0.1735671 Test Loss: 0.2482209
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2514452
	speed: 0.0885s/iter; left time: 1385.9930s
	iters: 200, epoch: 42 | loss: 0.2151066
	speed: 0.0221s/iter; left time: 343.4077s
Epoch: 42 cost time: 5.983551502227783
Epoch: 42, Steps: 267 | Train Loss: 0.2318746 Vali Loss: 0.1735516 Test Loss: 0.2482233
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1491513
	speed: 0.0901s/iter; left time: 1386.4059s
	iters: 200, epoch: 43 | loss: 0.2259210
	speed: 0.0182s/iter; left time: 278.2059s
Epoch: 43 cost time: 5.186737537384033
Epoch: 43, Steps: 267 | Train Loss: 0.2321993 Vali Loss: 0.1733981 Test Loss: 0.2482295
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2154900
	speed: 0.0958s/iter; left time: 1448.9892s
	iters: 200, epoch: 44 | loss: 0.2286913
	speed: 0.0164s/iter; left time: 246.1117s
Epoch: 44 cost time: 5.2254297733306885
Epoch: 44, Steps: 267 | Train Loss: 0.2325119 Vali Loss: 0.1734259 Test Loss: 0.2482459
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2027900
	speed: 0.0868s/iter; left time: 1289.0898s
	iters: 200, epoch: 45 | loss: 0.2144626
	speed: 0.0168s/iter; left time: 248.3458s
Epoch: 45 cost time: 5.533797740936279
Epoch: 45, Steps: 267 | Train Loss: 0.2322416 Vali Loss: 0.1735361 Test Loss: 0.2482437
EarlyStopping counter: 20 out of 20
Early stopping
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=68, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1340416.0
params:  1564.0
Trainable parameters:  1564
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3948769
	speed: 0.0217s/iter; left time: 578.4124s
	iters: 200, epoch: 1 | loss: 0.2925555
	speed: 0.0157s/iter; left time: 416.5739s
Epoch: 1 cost time: 4.836998701095581
Epoch: 1, Steps: 267 | Train Loss: 0.3370072 Vali Loss: 0.1731150 Test Loss: 0.2480509
Validation loss decreased (inf --> 0.173115).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2382195
	speed: 0.1049s/iter; left time: 2761.2810s
	iters: 200, epoch: 2 | loss: 0.2615539
	speed: 0.0175s/iter; left time: 458.8079s
Epoch: 2 cost time: 5.634838581085205
Epoch: 2, Steps: 267 | Train Loss: 0.3365426 Vali Loss: 0.1731253 Test Loss: 0.2479809
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3431320
	speed: 0.1004s/iter; left time: 2618.1923s
	iters: 200, epoch: 3 | loss: 0.2877276
	speed: 0.0279s/iter; left time: 723.4522s
Epoch: 3 cost time: 6.163273096084595
Epoch: 3, Steps: 267 | Train Loss: 0.3364966 Vali Loss: 0.1735093 Test Loss: 0.2480232
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4077360
	speed: 0.1001s/iter; left time: 2582.0247s
	iters: 200, epoch: 4 | loss: 0.3856174
	speed: 0.0230s/iter; left time: 592.3483s
Epoch: 4 cost time: 6.754032850265503
Epoch: 4, Steps: 267 | Train Loss: 0.3365921 Vali Loss: 0.1732869 Test Loss: 0.2479205
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3001903
	speed: 0.0875s/iter; left time: 2233.3610s
	iters: 200, epoch: 5 | loss: 0.4409771
	speed: 0.0156s/iter; left time: 395.5263s
Epoch: 5 cost time: 4.690569877624512
Epoch: 5, Steps: 267 | Train Loss: 0.3358188 Vali Loss: 0.1733642 Test Loss: 0.2480594
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.6005440
	speed: 0.0929s/iter; left time: 2347.3178s
	iters: 200, epoch: 6 | loss: 0.2674902
	speed: 0.0216s/iter; left time: 542.8783s
Epoch: 6 cost time: 5.612523794174194
Epoch: 6, Steps: 267 | Train Loss: 0.3361345 Vali Loss: 0.1733567 Test Loss: 0.2479358
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4150411
	speed: 0.1115s/iter; left time: 2788.3351s
	iters: 200, epoch: 7 | loss: 0.3096774
	speed: 0.0197s/iter; left time: 491.1291s
Epoch: 7 cost time: 6.1567981243133545
Epoch: 7, Steps: 267 | Train Loss: 0.3363251 Vali Loss: 0.1734462 Test Loss: 0.2480513
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3376995
	speed: 0.1033s/iter; left time: 2555.5471s
	iters: 200, epoch: 8 | loss: 0.2526827
	speed: 0.0170s/iter; left time: 418.7987s
Epoch: 8 cost time: 6.222904443740845
Epoch: 8, Steps: 267 | Train Loss: 0.3355640 Vali Loss: 0.1734623 Test Loss: 0.2480291
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3495322
	speed: 0.1133s/iter; left time: 2771.9877s
	iters: 200, epoch: 9 | loss: 0.3866463
	speed: 0.0211s/iter; left time: 513.5448s
Epoch: 9 cost time: 7.788595676422119
Epoch: 9, Steps: 267 | Train Loss: 0.3365775 Vali Loss: 0.1736346 Test Loss: 0.2480398
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2848797
	speed: 0.1137s/iter; left time: 2752.1597s
	iters: 200, epoch: 10 | loss: 0.3361692
	speed: 0.0178s/iter; left time: 429.3443s
Epoch: 10 cost time: 6.560745716094971
Epoch: 10, Steps: 267 | Train Loss: 0.3361469 Vali Loss: 0.1734161 Test Loss: 0.2479107
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2941431
	speed: 0.0877s/iter; left time: 2097.7377s
	iters: 200, epoch: 11 | loss: 0.3405859
	speed: 0.0163s/iter; left time: 388.7054s
Epoch: 11 cost time: 4.894342422485352
Epoch: 11, Steps: 267 | Train Loss: 0.3361358 Vali Loss: 0.1734659 Test Loss: 0.2479676
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3900494
	speed: 0.0954s/iter; left time: 2256.5058s
	iters: 200, epoch: 12 | loss: 0.2944291
	speed: 0.0230s/iter; left time: 542.8003s
Epoch: 12 cost time: 7.514858961105347
Epoch: 12, Steps: 267 | Train Loss: 0.3362738 Vali Loss: 0.1734483 Test Loss: 0.2479840
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2569121
	speed: 0.1019s/iter; left time: 2383.7540s
	iters: 200, epoch: 13 | loss: 0.2807634
	speed: 0.0229s/iter; left time: 532.9271s
Epoch: 13 cost time: 5.751521825790405
Epoch: 13, Steps: 267 | Train Loss: 0.3355931 Vali Loss: 0.1734081 Test Loss: 0.2479896
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2660952
	speed: 0.0904s/iter; left time: 2090.0369s
	iters: 200, epoch: 14 | loss: 0.2806136
	speed: 0.0192s/iter; left time: 441.2191s
Epoch: 14 cost time: 5.21978235244751
Epoch: 14, Steps: 267 | Train Loss: 0.3362226 Vali Loss: 0.1734821 Test Loss: 0.2479743
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2313758
	speed: 0.0869s/iter; left time: 1986.1764s
	iters: 200, epoch: 15 | loss: 0.2500047
	speed: 0.0154s/iter; left time: 349.4835s
Epoch: 15 cost time: 4.722924470901489
Epoch: 15, Steps: 267 | Train Loss: 0.3360513 Vali Loss: 0.1733196 Test Loss: 0.2480779
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4039824
	speed: 0.0900s/iter; left time: 2033.1769s
	iters: 200, epoch: 16 | loss: 0.3442617
	speed: 0.0199s/iter; left time: 447.1494s
Epoch: 16 cost time: 5.3838629722595215
Epoch: 16, Steps: 267 | Train Loss: 0.3357555 Vali Loss: 0.1734789 Test Loss: 0.2480450
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3187522
	speed: 0.1022s/iter; left time: 2281.1615s
	iters: 200, epoch: 17 | loss: 0.4400534
	speed: 0.0176s/iter; left time: 391.6162s
Epoch: 17 cost time: 6.093367099761963
Epoch: 17, Steps: 267 | Train Loss: 0.3362132 Vali Loss: 0.1735760 Test Loss: 0.2480518
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3634639
	speed: 0.1000s/iter; left time: 2205.8405s
	iters: 200, epoch: 18 | loss: 0.4256978
	speed: 0.0159s/iter; left time: 348.7577s
Epoch: 18 cost time: 4.737857103347778
Epoch: 18, Steps: 267 | Train Loss: 0.3356346 Vali Loss: 0.1734816 Test Loss: 0.2480273
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2688975
	speed: 0.1071s/iter; left time: 2334.6268s
	iters: 200, epoch: 19 | loss: 0.3644567
	speed: 0.0166s/iter; left time: 361.1564s
Epoch: 19 cost time: 5.809138298034668
Epoch: 19, Steps: 267 | Train Loss: 0.3362801 Vali Loss: 0.1734708 Test Loss: 0.2480070
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.4429049
	speed: 0.0968s/iter; left time: 2083.8955s
	iters: 200, epoch: 20 | loss: 0.2361541
	speed: 0.0165s/iter; left time: 354.1138s
Epoch: 20 cost time: 5.613146781921387
Epoch: 20, Steps: 267 | Train Loss: 0.3358909 Vali Loss: 0.1734573 Test Loss: 0.2479486
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2666552
	speed: 0.0821s/iter; left time: 1745.3278s
	iters: 200, epoch: 21 | loss: 0.3387548
	speed: 0.0152s/iter; left time: 321.3192s
Epoch: 21 cost time: 4.8428943157196045
Epoch: 21, Steps: 267 | Train Loss: 0.3358594 Vali Loss: 0.1733197 Test Loss: 0.2480264
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_192_FITS_ETTm2_ftM_sl90_ll48_pl192_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.24888961017131805, mae:0.3072596788406372, rse:0.4038299024105072, corr:[0.56826234 0.56735593 0.562376   0.5597408  0.5593582  0.558151
 0.55619293 0.5554461  0.5555971  0.5548929  0.55337346 0.55229896
 0.55190885 0.551225   0.5499374  0.54887456 0.54831564 0.5476044
 0.5465304  0.5454958  0.54464555 0.5437103  0.54274654 0.54221195
 0.54197174 0.5413537  0.5403706  0.5395629  0.5391687  0.5386873
 0.5377351  0.5367663  0.53619295 0.5357963  0.5351427  0.53442967
 0.5339749  0.5336376  0.53301686 0.53207356 0.53126335 0.5309439
 0.5307968  0.5304733  0.53004736 0.5295916  0.5290726  0.52832615
 0.52748656 0.526665   0.5257298  0.524726   0.52391076 0.52341324
 0.52308553 0.5225531  0.5217203  0.5210879  0.5208536  0.5208322
 0.52061963 0.5202857  0.5202296  0.52046025 0.52054596 0.52034324
 0.52007407 0.51992226 0.51994115 0.52002907 0.52015984 0.52035505
 0.52049327 0.5205591  0.52050376 0.52043855 0.52046055 0.5204168
 0.5202942  0.52012295 0.5199783  0.519838   0.51969504 0.5195407
 0.5193572  0.5191065  0.51876295 0.5184743  0.51830286 0.5181884
 0.51797736 0.5175856  0.5170581  0.51645684 0.51551104 0.51392144
 0.5118776  0.50990677 0.5081658  0.50641936 0.504641   0.5031192
 0.50192475 0.50076485 0.49942023 0.4979018  0.49637523 0.4949886
 0.49368125 0.4923508  0.49101177 0.48967633 0.4884574  0.48726562
 0.48594883 0.48452324 0.48309135 0.4817987  0.48072895 0.47967264
 0.47869617 0.47774526 0.47677878 0.47582832 0.47490898 0.47394183
 0.47288448 0.47181416 0.47076026 0.46978483 0.46888366 0.46788138
 0.46686807 0.46596536 0.4650977  0.46442255 0.46376276 0.46336478
 0.46310446 0.4628022  0.46246302 0.46216673 0.46192217 0.46141723
 0.46046993 0.45935762 0.45835936 0.45763528 0.45691887 0.45603782
 0.4551677  0.45470238 0.45430198 0.45353472 0.45264557 0.45202395
 0.45168072 0.451615   0.4514475  0.45128417 0.45105845 0.4507745
 0.4506543  0.45042163 0.45038578 0.45046628 0.4506066  0.45075053
 0.45085573 0.45104071 0.4513651  0.4517204  0.451954   0.45202762
 0.45213413 0.4523283  0.4524349  0.45251805 0.4528385  0.4535235
 0.45411527 0.4541076  0.45386115 0.45378563 0.45415708 0.45463797
 0.4547581  0.45474932 0.454831   0.45526156 0.45539257 0.45339325]
