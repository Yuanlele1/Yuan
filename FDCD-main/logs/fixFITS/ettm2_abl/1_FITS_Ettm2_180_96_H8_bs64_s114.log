Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=26, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=26, out_features=39, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  908544.0
params:  1053.0
Trainable parameters:  1053
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2538682
	speed: 0.0179s/iter; left time: 475.5007s
	iters: 200, epoch: 1 | loss: 0.2055907
	speed: 0.0114s/iter; left time: 301.5957s
Epoch: 1 cost time: 3.7038512229919434
Epoch: 1, Steps: 267 | Train Loss: 0.2983366 Vali Loss: 0.1378582 Test Loss: 0.1959503
Validation loss decreased (inf --> 0.137858).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2928820
	speed: 0.0615s/iter; left time: 1618.7364s
	iters: 200, epoch: 2 | loss: 0.1910448
	speed: 0.0096s/iter; left time: 253.0608s
Epoch: 2 cost time: 3.170349359512329
Epoch: 2, Steps: 267 | Train Loss: 0.2522173 Vali Loss: 0.1299866 Test Loss: 0.1851138
Validation loss decreased (0.137858 --> 0.129987).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2057442
	speed: 0.0583s/iter; left time: 1518.5015s
	iters: 200, epoch: 3 | loss: 0.2348413
	speed: 0.0100s/iter; left time: 258.9964s
Epoch: 3 cost time: 3.2230002880096436
Epoch: 3, Steps: 267 | Train Loss: 0.2427413 Vali Loss: 0.1274115 Test Loss: 0.1807312
Validation loss decreased (0.129987 --> 0.127411).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2384120
	speed: 0.0609s/iter; left time: 1571.0464s
	iters: 200, epoch: 4 | loss: 0.3170146
	speed: 0.0100s/iter; left time: 257.8499s
Epoch: 4 cost time: 3.291043758392334
Epoch: 4, Steps: 267 | Train Loss: 0.2389443 Vali Loss: 0.1260033 Test Loss: 0.1784649
Validation loss decreased (0.127411 --> 0.126003).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2186454
	speed: 0.0594s/iter; left time: 1516.5222s
	iters: 200, epoch: 5 | loss: 0.2010737
	speed: 0.0105s/iter; left time: 265.9162s
Epoch: 5 cost time: 3.3282909393310547
Epoch: 5, Steps: 267 | Train Loss: 0.2364329 Vali Loss: 0.1253527 Test Loss: 0.1770160
Validation loss decreased (0.126003 --> 0.125353).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1962193
	speed: 0.0603s/iter; left time: 1523.4415s
	iters: 200, epoch: 6 | loss: 0.1955331
	speed: 0.0104s/iter; left time: 262.9300s
Epoch: 6 cost time: 3.283660411834717
Epoch: 6, Steps: 267 | Train Loss: 0.2349722 Vali Loss: 0.1246993 Test Loss: 0.1761913
Validation loss decreased (0.125353 --> 0.124699).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2533389
	speed: 0.0602s/iter; left time: 1505.9639s
	iters: 200, epoch: 7 | loss: 0.2843576
	speed: 0.0100s/iter; left time: 249.7036s
Epoch: 7 cost time: 3.264012336730957
Epoch: 7, Steps: 267 | Train Loss: 0.2339786 Vali Loss: 0.1242773 Test Loss: 0.1753454
Validation loss decreased (0.124699 --> 0.124277).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2501758
	speed: 0.0589s/iter; left time: 1455.9154s
	iters: 200, epoch: 8 | loss: 0.2669925
	speed: 0.0101s/iter; left time: 249.1682s
Epoch: 8 cost time: 3.396660804748535
Epoch: 8, Steps: 267 | Train Loss: 0.2331053 Vali Loss: 0.1240839 Test Loss: 0.1749080
Validation loss decreased (0.124277 --> 0.124084).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3145994
	speed: 0.0581s/iter; left time: 1420.3307s
	iters: 200, epoch: 9 | loss: 0.2435823
	speed: 0.0100s/iter; left time: 243.5659s
Epoch: 9 cost time: 3.2904317378997803
Epoch: 9, Steps: 267 | Train Loss: 0.2322477 Vali Loss: 0.1238578 Test Loss: 0.1746509
Validation loss decreased (0.124084 --> 0.123858).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2323002
	speed: 0.0593s/iter; left time: 1435.2782s
	iters: 200, epoch: 10 | loss: 0.2172999
	speed: 0.0099s/iter; left time: 238.0513s
Epoch: 10 cost time: 3.2589502334594727
Epoch: 10, Steps: 267 | Train Loss: 0.2320974 Vali Loss: 0.1238219 Test Loss: 0.1742831
Validation loss decreased (0.123858 --> 0.123822).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2761848
	speed: 0.0573s/iter; left time: 1371.3369s
	iters: 200, epoch: 11 | loss: 0.2005991
	speed: 0.0100s/iter; left time: 237.5664s
Epoch: 11 cost time: 3.188483715057373
Epoch: 11, Steps: 267 | Train Loss: 0.2316634 Vali Loss: 0.1236960 Test Loss: 0.1741682
Validation loss decreased (0.123822 --> 0.123696).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1806412
	speed: 0.0569s/iter; left time: 1345.8604s
	iters: 200, epoch: 12 | loss: 0.2342837
	speed: 0.0100s/iter; left time: 235.1559s
Epoch: 12 cost time: 3.1626315116882324
Epoch: 12, Steps: 267 | Train Loss: 0.2312654 Vali Loss: 0.1235862 Test Loss: 0.1740450
Validation loss decreased (0.123696 --> 0.123586).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2141438
	speed: 0.0585s/iter; left time: 1367.6121s
	iters: 200, epoch: 13 | loss: 0.2160197
	speed: 0.0102s/iter; left time: 236.7806s
Epoch: 13 cost time: 3.2598917484283447
Epoch: 13, Steps: 267 | Train Loss: 0.2314514 Vali Loss: 0.1236249 Test Loss: 0.1738477
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2033991
	speed: 0.0568s/iter; left time: 1313.0002s
	iters: 200, epoch: 14 | loss: 0.1911157
	speed: 0.0102s/iter; left time: 235.7372s
Epoch: 14 cost time: 3.1911284923553467
Epoch: 14, Steps: 267 | Train Loss: 0.2306467 Vali Loss: 0.1235078 Test Loss: 0.1737615
Validation loss decreased (0.123586 --> 0.123508).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2548329
	speed: 0.0586s/iter; left time: 1339.8621s
	iters: 200, epoch: 15 | loss: 0.1755714
	speed: 0.0103s/iter; left time: 234.5134s
Epoch: 15 cost time: 3.301771402359009
Epoch: 15, Steps: 267 | Train Loss: 0.2309436 Vali Loss: 0.1235552 Test Loss: 0.1737570
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2335097
	speed: 0.0610s/iter; left time: 1377.4742s
	iters: 200, epoch: 16 | loss: 0.2610676
	speed: 0.0101s/iter; left time: 227.8469s
Epoch: 16 cost time: 3.3732659816741943
Epoch: 16, Steps: 267 | Train Loss: 0.2307036 Vali Loss: 0.1234856 Test Loss: 0.1736139
Validation loss decreased (0.123508 --> 0.123486).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2053058
	speed: 0.0586s/iter; left time: 1308.6355s
	iters: 200, epoch: 17 | loss: 0.1945824
	speed: 0.0108s/iter; left time: 239.9630s
Epoch: 17 cost time: 3.3520333766937256
Epoch: 17, Steps: 267 | Train Loss: 0.2308135 Vali Loss: 0.1235090 Test Loss: 0.1735986
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3306086
	speed: 0.0576s/iter; left time: 1269.9979s
	iters: 200, epoch: 18 | loss: 0.2960058
	speed: 0.0105s/iter; left time: 231.0622s
Epoch: 18 cost time: 3.318537473678589
Epoch: 18, Steps: 267 | Train Loss: 0.2302783 Vali Loss: 0.1235075 Test Loss: 0.1735077
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1792618
	speed: 0.0584s/iter; left time: 1271.9736s
	iters: 200, epoch: 19 | loss: 0.1777760
	speed: 0.0099s/iter; left time: 215.8586s
Epoch: 19 cost time: 3.2446067333221436
Epoch: 19, Steps: 267 | Train Loss: 0.2304341 Vali Loss: 0.1235116 Test Loss: 0.1736767
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3220534
	speed: 0.0558s/iter; left time: 1200.7700s
	iters: 200, epoch: 20 | loss: 0.2265881
	speed: 0.0099s/iter; left time: 212.4343s
Epoch: 20 cost time: 3.154825448989868
Epoch: 20, Steps: 267 | Train Loss: 0.2304979 Vali Loss: 0.1235131 Test Loss: 0.1734813
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2056459
	speed: 0.0564s/iter; left time: 1199.9803s
	iters: 200, epoch: 21 | loss: 0.2313759
	speed: 0.0100s/iter; left time: 210.8773s
Epoch: 21 cost time: 3.1425421237945557
Epoch: 21, Steps: 267 | Train Loss: 0.2301656 Vali Loss: 0.1234984 Test Loss: 0.1734661
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2161113
	speed: 0.0595s/iter; left time: 1248.9865s
	iters: 200, epoch: 22 | loss: 0.2317725
	speed: 0.0100s/iter; left time: 209.7984s
Epoch: 22 cost time: 3.186692953109741
Epoch: 22, Steps: 267 | Train Loss: 0.2302534 Vali Loss: 0.1235026 Test Loss: 0.1734463
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2008011
	speed: 0.0585s/iter; left time: 1212.2964s
	iters: 200, epoch: 23 | loss: 0.2582085
	speed: 0.0100s/iter; left time: 206.6171s
Epoch: 23 cost time: 3.2959542274475098
Epoch: 23, Steps: 267 | Train Loss: 0.2302248 Vali Loss: 0.1234163 Test Loss: 0.1733836
Validation loss decreased (0.123486 --> 0.123416).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2007442
	speed: 0.0593s/iter; left time: 1212.7717s
	iters: 200, epoch: 24 | loss: 0.4414474
	speed: 0.0101s/iter; left time: 204.9584s
Epoch: 24 cost time: 3.2774641513824463
Epoch: 24, Steps: 267 | Train Loss: 0.2300485 Vali Loss: 0.1234722 Test Loss: 0.1733473
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2603413
	speed: 0.0581s/iter; left time: 1172.4798s
	iters: 200, epoch: 25 | loss: 0.2090709
	speed: 0.0101s/iter; left time: 203.3983s
Epoch: 25 cost time: 3.2895915508270264
Epoch: 25, Steps: 267 | Train Loss: 0.2303500 Vali Loss: 0.1234315 Test Loss: 0.1734632
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2597689
	speed: 0.0566s/iter; left time: 1128.5597s
	iters: 200, epoch: 26 | loss: 0.2013663
	speed: 0.0100s/iter; left time: 198.4043s
Epoch: 26 cost time: 3.197208881378174
Epoch: 26, Steps: 267 | Train Loss: 0.2299787 Vali Loss: 0.1234486 Test Loss: 0.1734286
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2505892
	speed: 0.0578s/iter; left time: 1137.2047s
	iters: 200, epoch: 27 | loss: 0.2580611
	speed: 0.0100s/iter; left time: 195.6383s
Epoch: 27 cost time: 3.2109787464141846
Epoch: 27, Steps: 267 | Train Loss: 0.2302494 Vali Loss: 0.1234506 Test Loss: 0.1733976
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1749271
	speed: 0.0567s/iter; left time: 1100.4168s
	iters: 200, epoch: 28 | loss: 0.2238729
	speed: 0.0100s/iter; left time: 192.1227s
Epoch: 28 cost time: 3.181478977203369
Epoch: 28, Steps: 267 | Train Loss: 0.2299410 Vali Loss: 0.1234455 Test Loss: 0.1733377
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2297719
	speed: 0.0578s/iter; left time: 1104.8860s
	iters: 200, epoch: 29 | loss: 0.1886511
	speed: 0.0099s/iter; left time: 187.8925s
Epoch: 29 cost time: 3.2194571495056152
Epoch: 29, Steps: 267 | Train Loss: 0.2301195 Vali Loss: 0.1234516 Test Loss: 0.1733132
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2104615
	speed: 0.0569s/iter; left time: 1072.8698s
	iters: 200, epoch: 30 | loss: 0.1822797
	speed: 0.0100s/iter; left time: 187.6085s
Epoch: 30 cost time: 3.1237173080444336
Epoch: 30, Steps: 267 | Train Loss: 0.2298290 Vali Loss: 0.1234291 Test Loss: 0.1733231
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2123391
	speed: 0.0584s/iter; left time: 1086.1098s
	iters: 200, epoch: 31 | loss: 0.2029746
	speed: 0.0103s/iter; left time: 190.0320s
Epoch: 31 cost time: 3.3181583881378174
Epoch: 31, Steps: 267 | Train Loss: 0.2299946 Vali Loss: 0.1234030 Test Loss: 0.1732972
Validation loss decreased (0.123416 --> 0.123403).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1643175
	speed: 0.0636s/iter; left time: 1165.6681s
	iters: 200, epoch: 32 | loss: 0.1770590
	speed: 0.0101s/iter; left time: 183.9107s
Epoch: 32 cost time: 3.7455995082855225
Epoch: 32, Steps: 267 | Train Loss: 0.2298127 Vali Loss: 0.1234244 Test Loss: 0.1733086
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2230575
	speed: 0.0584s/iter; left time: 1054.3169s
	iters: 200, epoch: 33 | loss: 0.2368702
	speed: 0.0101s/iter; left time: 181.8043s
Epoch: 33 cost time: 3.249035358428955
Epoch: 33, Steps: 267 | Train Loss: 0.2299515 Vali Loss: 0.1234486 Test Loss: 0.1733039
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2324538
	speed: 0.0580s/iter; left time: 1031.1805s
	iters: 200, epoch: 34 | loss: 0.2310477
	speed: 0.0102s/iter; left time: 180.5033s
Epoch: 34 cost time: 3.275129795074463
Epoch: 34, Steps: 267 | Train Loss: 0.2299111 Vali Loss: 0.1234119 Test Loss: 0.1732713
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2253083
	speed: 0.0579s/iter; left time: 1014.3667s
	iters: 200, epoch: 35 | loss: 0.2128765
	speed: 0.0101s/iter; left time: 176.4575s
Epoch: 35 cost time: 3.2403602600097656
Epoch: 35, Steps: 267 | Train Loss: 0.2299650 Vali Loss: 0.1234213 Test Loss: 0.1732374
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1709823
	speed: 0.0571s/iter; left time: 985.7041s
	iters: 200, epoch: 36 | loss: 0.3321123
	speed: 0.0100s/iter; left time: 170.9462s
Epoch: 36 cost time: 3.1564173698425293
Epoch: 36, Steps: 267 | Train Loss: 0.2297557 Vali Loss: 0.1234489 Test Loss: 0.1732910
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1698292
	speed: 0.0573s/iter; left time: 973.1987s
	iters: 200, epoch: 37 | loss: 0.2040312
	speed: 0.0100s/iter; left time: 168.0877s
Epoch: 37 cost time: 3.136652946472168
Epoch: 37, Steps: 267 | Train Loss: 0.2297516 Vali Loss: 0.1234530 Test Loss: 0.1732712
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1587970
	speed: 0.0596s/iter; left time: 996.3974s
	iters: 200, epoch: 38 | loss: 0.1624263
	speed: 0.0100s/iter; left time: 166.4201s
Epoch: 38 cost time: 3.257882833480835
Epoch: 38, Steps: 267 | Train Loss: 0.2292835 Vali Loss: 0.1234373 Test Loss: 0.1732647
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1707853
	speed: 0.0578s/iter; left time: 951.8089s
	iters: 200, epoch: 39 | loss: 0.3052758
	speed: 0.0101s/iter; left time: 165.3696s
Epoch: 39 cost time: 3.2670798301696777
Epoch: 39, Steps: 267 | Train Loss: 0.2298318 Vali Loss: 0.1234557 Test Loss: 0.1732372
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2419232
	speed: 0.0578s/iter; left time: 936.4310s
	iters: 200, epoch: 40 | loss: 0.3122891
	speed: 0.0102s/iter; left time: 163.6250s
Epoch: 40 cost time: 3.289795398712158
Epoch: 40, Steps: 267 | Train Loss: 0.2300367 Vali Loss: 0.1233506 Test Loss: 0.1732546
Validation loss decreased (0.123403 --> 0.123351).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.4074570
	speed: 0.0589s/iter; left time: 938.4246s
	iters: 200, epoch: 41 | loss: 0.2415052
	speed: 0.0136s/iter; left time: 214.8285s
Epoch: 41 cost time: 3.613105297088623
Epoch: 41, Steps: 267 | Train Loss: 0.2298478 Vali Loss: 0.1233163 Test Loss: 0.1732435
Validation loss decreased (0.123351 --> 0.123316).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2280517
	speed: 0.0590s/iter; left time: 922.8544s
	iters: 200, epoch: 42 | loss: 0.2415037
	speed: 0.0100s/iter; left time: 155.9094s
Epoch: 42 cost time: 3.2274465560913086
Epoch: 42, Steps: 267 | Train Loss: 0.2294256 Vali Loss: 0.1233397 Test Loss: 0.1732091
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2333964
	speed: 0.0594s/iter; left time: 914.6851s
	iters: 200, epoch: 43 | loss: 0.1669255
	speed: 0.0102s/iter; left time: 156.6720s
Epoch: 43 cost time: 3.345876693725586
Epoch: 43, Steps: 267 | Train Loss: 0.2297751 Vali Loss: 0.1234365 Test Loss: 0.1732309
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2835318
	speed: 0.0622s/iter; left time: 941.0963s
	iters: 200, epoch: 44 | loss: 0.2697040
	speed: 0.0100s/iter; left time: 149.6697s
Epoch: 44 cost time: 3.4150147438049316
Epoch: 44, Steps: 267 | Train Loss: 0.2299117 Vali Loss: 0.1233991 Test Loss: 0.1732274
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2663793
	speed: 0.0590s/iter; left time: 876.8459s
	iters: 200, epoch: 45 | loss: 0.2429871
	speed: 0.0100s/iter; left time: 147.0805s
Epoch: 45 cost time: 3.1746575832366943
Epoch: 45, Steps: 267 | Train Loss: 0.2298961 Vali Loss: 0.1234055 Test Loss: 0.1732260
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1486872
	speed: 0.0596s/iter; left time: 869.4311s
	iters: 200, epoch: 46 | loss: 0.1851039
	speed: 0.0101s/iter; left time: 146.9136s
Epoch: 46 cost time: 3.3480796813964844
Epoch: 46, Steps: 267 | Train Loss: 0.2291607 Vali Loss: 0.1233885 Test Loss: 0.1732369
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2926306
	speed: 0.0610s/iter; left time: 873.0184s
	iters: 200, epoch: 47 | loss: 0.1846058
	speed: 0.0101s/iter; left time: 144.2287s
Epoch: 47 cost time: 3.2200422286987305
Epoch: 47, Steps: 267 | Train Loss: 0.2296297 Vali Loss: 0.1233735 Test Loss: 0.1732284
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1961954
	speed: 0.0575s/iter; left time: 807.7771s
	iters: 200, epoch: 48 | loss: 0.3292239
	speed: 0.0099s/iter; left time: 137.7973s
Epoch: 48 cost time: 3.2201530933380127
Epoch: 48, Steps: 267 | Train Loss: 0.2299552 Vali Loss: 0.1234191 Test Loss: 0.1732215
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2894035
	speed: 0.0587s/iter; left time: 809.5615s
	iters: 200, epoch: 49 | loss: 0.2767407
	speed: 0.0100s/iter; left time: 136.2073s
Epoch: 49 cost time: 3.7858364582061768
Epoch: 49, Steps: 267 | Train Loss: 0.2299680 Vali Loss: 0.1234408 Test Loss: 0.1732264
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2146956
	speed: 0.0645s/iter; left time: 872.1546s
	iters: 200, epoch: 50 | loss: 0.4578941
	speed: 0.0101s/iter; left time: 134.9412s
Epoch: 50 cost time: 3.27005934715271
Epoch: 50, Steps: 267 | Train Loss: 0.2296708 Vali Loss: 0.1234026 Test Loss: 0.1732307
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2387590
	speed: 0.0591s/iter; left time: 783.2988s
	iters: 200, epoch: 51 | loss: 0.2020745
	speed: 0.0104s/iter; left time: 137.0030s
Epoch: 51 cost time: 3.916731595993042
Epoch: 51, Steps: 267 | Train Loss: 0.2297979 Vali Loss: 0.1234237 Test Loss: 0.1732171
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1970231
	speed: 0.0637s/iter; left time: 827.2677s
	iters: 200, epoch: 52 | loss: 0.1392435
	speed: 0.0101s/iter; left time: 130.3639s
Epoch: 52 cost time: 3.2248806953430176
Epoch: 52, Steps: 267 | Train Loss: 0.2292020 Vali Loss: 0.1233533 Test Loss: 0.1732269
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2679354
	speed: 0.0609s/iter; left time: 774.1549s
	iters: 200, epoch: 53 | loss: 0.1425846
	speed: 0.0101s/iter; left time: 127.4889s
Epoch: 53 cost time: 3.4420275688171387
Epoch: 53, Steps: 267 | Train Loss: 0.2298531 Vali Loss: 0.1234410 Test Loss: 0.1732290
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1926956
	speed: 0.0603s/iter; left time: 751.0608s
	iters: 200, epoch: 54 | loss: 0.2516859
	speed: 0.0100s/iter; left time: 122.9413s
Epoch: 54 cost time: 3.179007053375244
Epoch: 54, Steps: 267 | Train Loss: 0.2297078 Vali Loss: 0.1234345 Test Loss: 0.1732108
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2401781
	speed: 0.0580s/iter; left time: 706.2015s
	iters: 200, epoch: 55 | loss: 0.1938661
	speed: 0.0101s/iter; left time: 122.0205s
Epoch: 55 cost time: 3.2303085327148438
Epoch: 55, Steps: 267 | Train Loss: 0.2291971 Vali Loss: 0.1234405 Test Loss: 0.1732128
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2755484
	speed: 0.0565s/iter; left time: 673.1349s
	iters: 200, epoch: 56 | loss: 0.2295502
	speed: 0.0099s/iter; left time: 116.8883s
Epoch: 56 cost time: 3.0706262588500977
Epoch: 56, Steps: 267 | Train Loss: 0.2297905 Vali Loss: 0.1233800 Test Loss: 0.1732191
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2652873
	speed: 0.0591s/iter; left time: 688.5076s
	iters: 200, epoch: 57 | loss: 0.2125959
	speed: 0.0100s/iter; left time: 115.9003s
Epoch: 57 cost time: 3.2504684925079346
Epoch: 57, Steps: 267 | Train Loss: 0.2298869 Vali Loss: 0.1234210 Test Loss: 0.1732165
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1317443
	speed: 0.0589s/iter; left time: 669.9834s
	iters: 200, epoch: 58 | loss: 0.1378800
	speed: 0.0100s/iter; left time: 113.0814s
Epoch: 58 cost time: 3.272745370864868
Epoch: 58, Steps: 267 | Train Loss: 0.2294585 Vali Loss: 0.1234163 Test Loss: 0.1732088
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1676022
	speed: 0.0590s/iter; left time: 656.1240s
	iters: 200, epoch: 59 | loss: 0.2272450
	speed: 0.0269s/iter; left time: 296.7284s
Epoch: 59 cost time: 4.974122524261475
Epoch: 59, Steps: 267 | Train Loss: 0.2294295 Vali Loss: 0.1234516 Test Loss: 0.1732098
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1682140
	speed: 0.0584s/iter; left time: 633.0080s
	iters: 200, epoch: 60 | loss: 0.2094778
	speed: 0.0116s/iter; left time: 124.3282s
Epoch: 60 cost time: 3.425097942352295
Epoch: 60, Steps: 267 | Train Loss: 0.2299463 Vali Loss: 0.1234376 Test Loss: 0.1732104
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1786342
	speed: 0.0605s/iter; left time: 640.0611s
	iters: 200, epoch: 61 | loss: 0.2542256
	speed: 0.0102s/iter; left time: 106.4228s
Epoch: 61 cost time: 3.4079601764678955
Epoch: 61, Steps: 267 | Train Loss: 0.2298651 Vali Loss: 0.1234687 Test Loss: 0.1732139
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1740015596151352, mae:0.2596419155597687, rse:0.33819934725761414, corr:[0.5692525  0.5724248  0.56919765 0.5651183  0.5633456  0.56357104
 0.5640911  0.56351316 0.56185424 0.5601326  0.55928403 0.5594643
 0.5599748  0.55997    0.5592623  0.5581241  0.5570841  0.5564875
 0.5562564  0.55602753 0.5555096  0.55465084 0.5536786  0.55297583
 0.552679   0.5526279  0.55254143 0.5521423  0.551359   0.5503963
 0.54960936 0.54920644 0.5490554  0.5489111  0.548542   0.54792255
 0.54710454 0.5463175  0.54563266 0.54504454 0.5445585  0.544137
 0.5437174  0.54327005 0.5427994  0.54233223 0.54179996 0.54115295
 0.5403498  0.539411   0.5384641  0.5377035  0.5371173  0.5365996
 0.5361259  0.53569615 0.5351852  0.5346817  0.5342251  0.53389704
 0.5336288  0.53348184 0.533396   0.5332126  0.5329344  0.5326823
 0.5324627  0.53231895 0.5322547  0.5322442  0.53217953 0.53203094
 0.53185064 0.5315782  0.53135943 0.53115225 0.53091794 0.53057194
 0.53014493 0.52966356 0.5291216  0.5285868  0.52813345 0.5277185
 0.52729094 0.526865   0.5263766  0.5259512  0.5256417  0.52534556
 0.5250642  0.52486706 0.52471524 0.52448386 0.5239883  0.52231747]
