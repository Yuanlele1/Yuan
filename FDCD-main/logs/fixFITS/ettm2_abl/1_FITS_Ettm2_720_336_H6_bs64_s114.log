Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=58, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=58, out_features=85, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4417280.0
params:  5015.0
Trainable parameters:  5015
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5535710
	speed: 0.0235s/iter; left time: 611.7081s
	iters: 200, epoch: 1 | loss: 0.4358383
	speed: 0.0181s/iter; left time: 470.0016s
Epoch: 1 cost time: 5.24197793006897
Epoch: 1, Steps: 261 | Train Loss: 0.4695028 Vali Loss: 0.2137931 Test Loss: 0.2926055
Validation loss decreased (inf --> 0.213793).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5019831
	speed: 0.0800s/iter; left time: 2059.8369s
	iters: 200, epoch: 2 | loss: 0.3577835
	speed: 0.0193s/iter; left time: 494.8723s
Epoch: 2 cost time: 5.491697788238525
Epoch: 2, Steps: 261 | Train Loss: 0.4083497 Vali Loss: 0.2047718 Test Loss: 0.2815678
Validation loss decreased (0.213793 --> 0.204772).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2253598
	speed: 0.0837s/iter; left time: 2133.4107s
	iters: 200, epoch: 3 | loss: 0.3159551
	speed: 0.0183s/iter; left time: 465.3183s
Epoch: 3 cost time: 5.584354639053345
Epoch: 3, Steps: 261 | Train Loss: 0.3969730 Vali Loss: 0.2012599 Test Loss: 0.2770915
Validation loss decreased (0.204772 --> 0.201260).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2931982
	speed: 0.0798s/iter; left time: 2011.7312s
	iters: 200, epoch: 4 | loss: 0.3717265
	speed: 0.0177s/iter; left time: 443.7098s
Epoch: 4 cost time: 5.321363210678101
Epoch: 4, Steps: 261 | Train Loss: 0.3909825 Vali Loss: 0.1991468 Test Loss: 0.2743290
Validation loss decreased (0.201260 --> 0.199147).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3035500
	speed: 0.0807s/iter; left time: 2014.4722s
	iters: 200, epoch: 5 | loss: 0.4256599
	speed: 0.0178s/iter; left time: 442.3637s
Epoch: 5 cost time: 5.289644718170166
Epoch: 5, Steps: 261 | Train Loss: 0.3873544 Vali Loss: 0.1980081 Test Loss: 0.2729360
Validation loss decreased (0.199147 --> 0.198008).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4781280
	speed: 0.0824s/iter; left time: 2034.2790s
	iters: 200, epoch: 6 | loss: 0.3996560
	speed: 0.0173s/iter; left time: 426.1688s
Epoch: 6 cost time: 5.4008708000183105
Epoch: 6, Steps: 261 | Train Loss: 0.3850414 Vali Loss: 0.1971146 Test Loss: 0.2717964
Validation loss decreased (0.198008 --> 0.197115).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2734089
	speed: 0.0841s/iter; left time: 2054.7702s
	iters: 200, epoch: 7 | loss: 0.3193613
	speed: 0.0183s/iter; left time: 445.4635s
Epoch: 7 cost time: 5.483668804168701
Epoch: 7, Steps: 261 | Train Loss: 0.3832757 Vali Loss: 0.1966855 Test Loss: 0.2714366
Validation loss decreased (0.197115 --> 0.196686).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3295788
	speed: 0.0793s/iter; left time: 1917.4535s
	iters: 200, epoch: 8 | loss: 0.4067115
	speed: 0.0183s/iter; left time: 440.0003s
Epoch: 8 cost time: 5.282876253128052
Epoch: 8, Steps: 261 | Train Loss: 0.3829829 Vali Loss: 0.1962062 Test Loss: 0.2706520
Validation loss decreased (0.196686 --> 0.196206).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4977239
	speed: 0.0841s/iter; left time: 2012.1518s
	iters: 200, epoch: 9 | loss: 0.4151177
	speed: 0.0188s/iter; left time: 448.8033s
Epoch: 9 cost time: 5.598062038421631
Epoch: 9, Steps: 261 | Train Loss: 0.3818089 Vali Loss: 0.1960071 Test Loss: 0.2707615
Validation loss decreased (0.196206 --> 0.196007).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3643335
	speed: 0.0850s/iter; left time: 2011.2392s
	iters: 200, epoch: 10 | loss: 0.2990882
	speed: 0.0173s/iter; left time: 408.3528s
Epoch: 10 cost time: 5.4671924114227295
Epoch: 10, Steps: 261 | Train Loss: 0.3810931 Vali Loss: 0.1957439 Test Loss: 0.2703182
Validation loss decreased (0.196007 --> 0.195744).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3158039
	speed: 0.0801s/iter; left time: 1874.6391s
	iters: 200, epoch: 11 | loss: 0.3471124
	speed: 0.0185s/iter; left time: 430.2575s
Epoch: 11 cost time: 5.395784139633179
Epoch: 11, Steps: 261 | Train Loss: 0.3805814 Vali Loss: 0.1954768 Test Loss: 0.2696646
Validation loss decreased (0.195744 --> 0.195477).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3796152
	speed: 0.0837s/iter; left time: 1934.8938s
	iters: 200, epoch: 12 | loss: 0.4502619
	speed: 0.0186s/iter; left time: 428.9108s
Epoch: 12 cost time: 5.686691999435425
Epoch: 12, Steps: 261 | Train Loss: 0.3804177 Vali Loss: 0.1953951 Test Loss: 0.2695054
Validation loss decreased (0.195477 --> 0.195395).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3497422
	speed: 0.0808s/iter; left time: 1847.9259s
	iters: 200, epoch: 13 | loss: 0.3083932
	speed: 0.0176s/iter; left time: 399.6751s
Epoch: 13 cost time: 5.15082573890686
Epoch: 13, Steps: 261 | Train Loss: 0.3799272 Vali Loss: 0.1953934 Test Loss: 0.2696618
Validation loss decreased (0.195395 --> 0.195393).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3433270
	speed: 0.0787s/iter; left time: 1779.8327s
	iters: 200, epoch: 14 | loss: 0.4969388
	speed: 0.0184s/iter; left time: 413.4601s
Epoch: 14 cost time: 5.399845600128174
Epoch: 14, Steps: 261 | Train Loss: 0.3795555 Vali Loss: 0.1954037 Test Loss: 0.2697096
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3832185
	speed: 0.0788s/iter; left time: 1760.4173s
	iters: 200, epoch: 15 | loss: 0.5883271
	speed: 0.0178s/iter; left time: 396.9328s
Epoch: 15 cost time: 5.251457929611206
Epoch: 15, Steps: 261 | Train Loss: 0.3789139 Vali Loss: 0.1952183 Test Loss: 0.2695877
Validation loss decreased (0.195393 --> 0.195218).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4057386
	speed: 0.0766s/iter; left time: 1692.6195s
	iters: 200, epoch: 16 | loss: 0.4221281
	speed: 0.0184s/iter; left time: 404.1813s
Epoch: 16 cost time: 5.372865200042725
Epoch: 16, Steps: 261 | Train Loss: 0.3795451 Vali Loss: 0.1953561 Test Loss: 0.2696647
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3781386
	speed: 0.0821s/iter; left time: 1791.3101s
	iters: 200, epoch: 17 | loss: 0.4730664
	speed: 0.0180s/iter; left time: 390.0843s
Epoch: 17 cost time: 5.572341442108154
Epoch: 17, Steps: 261 | Train Loss: 0.3786896 Vali Loss: 0.1949155 Test Loss: 0.2693669
Validation loss decreased (0.195218 --> 0.194915).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2776135
	speed: 0.0814s/iter; left time: 1754.3750s
	iters: 200, epoch: 18 | loss: 0.3513233
	speed: 0.0175s/iter; left time: 374.8712s
Epoch: 18 cost time: 5.338652610778809
Epoch: 18, Steps: 261 | Train Loss: 0.3786916 Vali Loss: 0.1950941 Test Loss: 0.2693588
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4275606
	speed: 0.0816s/iter; left time: 1738.4376s
	iters: 200, epoch: 19 | loss: 0.2926144
	speed: 0.0177s/iter; left time: 374.9306s
Epoch: 19 cost time: 5.401569843292236
Epoch: 19, Steps: 261 | Train Loss: 0.3787503 Vali Loss: 0.1950866 Test Loss: 0.2693691
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.4977206
	speed: 0.0809s/iter; left time: 1701.2928s
	iters: 200, epoch: 20 | loss: 0.3707529
	speed: 0.0183s/iter; left time: 383.7106s
Epoch: 20 cost time: 5.277720212936401
Epoch: 20, Steps: 261 | Train Loss: 0.3787266 Vali Loss: 0.1951983 Test Loss: 0.2693083
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3779304
	speed: 0.0808s/iter; left time: 1679.1348s
	iters: 200, epoch: 21 | loss: 0.4447975
	speed: 0.0190s/iter; left time: 393.5473s
Epoch: 21 cost time: 5.610440254211426
Epoch: 21, Steps: 261 | Train Loss: 0.3785506 Vali Loss: 0.1948827 Test Loss: 0.2691486
Validation loss decreased (0.194915 --> 0.194883).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4020398
	speed: 0.0812s/iter; left time: 1667.0914s
	iters: 200, epoch: 22 | loss: 0.3000120
	speed: 0.0179s/iter; left time: 365.3682s
Epoch: 22 cost time: 5.350072145462036
Epoch: 22, Steps: 261 | Train Loss: 0.3787825 Vali Loss: 0.1949456 Test Loss: 0.2691210
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.5650793
	speed: 0.0863s/iter; left time: 1748.5923s
	iters: 200, epoch: 23 | loss: 0.5781267
	speed: 0.0180s/iter; left time: 363.3471s
Epoch: 23 cost time: 5.533949613571167
Epoch: 23, Steps: 261 | Train Loss: 0.3785720 Vali Loss: 0.1948692 Test Loss: 0.2691772
Validation loss decreased (0.194883 --> 0.194869).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3174416
	speed: 0.0811s/iter; left time: 1621.6486s
	iters: 200, epoch: 24 | loss: 0.4965338
	speed: 0.0193s/iter; left time: 383.3393s
Epoch: 24 cost time: 5.623631238937378
Epoch: 24, Steps: 261 | Train Loss: 0.3782168 Vali Loss: 0.1948484 Test Loss: 0.2691411
Validation loss decreased (0.194869 --> 0.194848).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2310078
	speed: 0.0798s/iter; left time: 1574.7054s
	iters: 200, epoch: 25 | loss: 0.4561591
	speed: 0.0173s/iter; left time: 339.4790s
Epoch: 25 cost time: 5.308706283569336
Epoch: 25, Steps: 261 | Train Loss: 0.3781368 Vali Loss: 0.1949483 Test Loss: 0.2690383
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3660727
	speed: 0.0821s/iter; left time: 1598.6240s
	iters: 200, epoch: 26 | loss: 0.2821066
	speed: 0.0181s/iter; left time: 350.5703s
Epoch: 26 cost time: 5.476552963256836
Epoch: 26, Steps: 261 | Train Loss: 0.3784765 Vali Loss: 0.1949700 Test Loss: 0.2690736
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2578882
	speed: 0.0789s/iter; left time: 1516.9066s
	iters: 200, epoch: 27 | loss: 0.4636026
	speed: 0.0173s/iter; left time: 331.3506s
Epoch: 27 cost time: 5.16357684135437
Epoch: 27, Steps: 261 | Train Loss: 0.3780083 Vali Loss: 0.1949689 Test Loss: 0.2690870
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3280676
	speed: 0.0803s/iter; left time: 1521.5265s
	iters: 200, epoch: 28 | loss: 0.2815740
	speed: 0.0178s/iter; left time: 336.4417s
Epoch: 28 cost time: 5.443536758422852
Epoch: 28, Steps: 261 | Train Loss: 0.3782371 Vali Loss: 0.1948004 Test Loss: 0.2689302
Validation loss decreased (0.194848 --> 0.194800).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3418150
	speed: 0.0802s/iter; left time: 1499.5363s
	iters: 200, epoch: 29 | loss: 0.4358720
	speed: 0.0176s/iter; left time: 328.0500s
Epoch: 29 cost time: 5.309420108795166
Epoch: 29, Steps: 261 | Train Loss: 0.3779758 Vali Loss: 0.1948917 Test Loss: 0.2691139
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.5353531
	speed: 0.0782s/iter; left time: 1441.2107s
	iters: 200, epoch: 30 | loss: 0.3804091
	speed: 0.0183s/iter; left time: 334.5714s
Epoch: 30 cost time: 5.436225652694702
Epoch: 30, Steps: 261 | Train Loss: 0.3781731 Vali Loss: 0.1948894 Test Loss: 0.2689853
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3853757
	speed: 0.0846s/iter; left time: 1536.4524s
	iters: 200, epoch: 31 | loss: 0.3325168
	speed: 0.0177s/iter; left time: 320.0354s
Epoch: 31 cost time: 5.402000665664673
Epoch: 31, Steps: 261 | Train Loss: 0.3778153 Vali Loss: 0.1948292 Test Loss: 0.2689455
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.4302123
	speed: 0.0810s/iter; left time: 1451.3237s
	iters: 200, epoch: 32 | loss: 0.3786861
	speed: 0.0190s/iter; left time: 338.5045s
Epoch: 32 cost time: 5.5048887729644775
Epoch: 32, Steps: 261 | Train Loss: 0.3778348 Vali Loss: 0.1948636 Test Loss: 0.2690130
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3748193
	speed: 0.0820s/iter; left time: 1446.6656s
	iters: 200, epoch: 33 | loss: 0.3253369
	speed: 0.0179s/iter; left time: 313.2936s
Epoch: 33 cost time: 5.376740455627441
Epoch: 33, Steps: 261 | Train Loss: 0.3776484 Vali Loss: 0.1947854 Test Loss: 0.2689725
Validation loss decreased (0.194800 --> 0.194785).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.4110435
	speed: 0.0803s/iter; left time: 1396.9092s
	iters: 200, epoch: 34 | loss: 0.3001875
	speed: 0.0181s/iter; left time: 313.4541s
Epoch: 34 cost time: 5.267507076263428
Epoch: 34, Steps: 261 | Train Loss: 0.3779607 Vali Loss: 0.1948209 Test Loss: 0.2689554
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.4034750
	speed: 0.0779s/iter; left time: 1334.5030s
	iters: 200, epoch: 35 | loss: 0.3092436
	speed: 0.0180s/iter; left time: 306.1055s
Epoch: 35 cost time: 5.116966962814331
Epoch: 35, Steps: 261 | Train Loss: 0.3777722 Vali Loss: 0.1947246 Test Loss: 0.2688832
Validation loss decreased (0.194785 --> 0.194725).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.5104142
	speed: 0.0808s/iter; left time: 1363.2643s
	iters: 200, epoch: 36 | loss: 0.2831151
	speed: 0.0175s/iter; left time: 293.4879s
Epoch: 36 cost time: 5.394200086593628
Epoch: 36, Steps: 261 | Train Loss: 0.3779137 Vali Loss: 0.1948774 Test Loss: 0.2689623
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.4945677
	speed: 0.0877s/iter; left time: 1456.6286s
	iters: 200, epoch: 37 | loss: 0.3476681
	speed: 0.0175s/iter; left time: 288.0307s
Epoch: 37 cost time: 5.243062973022461
Epoch: 37, Steps: 261 | Train Loss: 0.3772074 Vali Loss: 0.1948628 Test Loss: 0.2689295
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.4774540
	speed: 0.0802s/iter; left time: 1311.2474s
	iters: 200, epoch: 38 | loss: 0.3956502
	speed: 0.0172s/iter; left time: 278.6072s
Epoch: 38 cost time: 5.184202432632446
Epoch: 38, Steps: 261 | Train Loss: 0.3770813 Vali Loss: 0.1947712 Test Loss: 0.2689319
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3516154
	speed: 0.0800s/iter; left time: 1286.1629s
	iters: 200, epoch: 39 | loss: 0.3215577
	speed: 0.0189s/iter; left time: 302.5991s
Epoch: 39 cost time: 5.381875038146973
Epoch: 39, Steps: 261 | Train Loss: 0.3772090 Vali Loss: 0.1947729 Test Loss: 0.2688773
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3409205
	speed: 0.0806s/iter; left time: 1275.0521s
	iters: 200, epoch: 40 | loss: 0.3193128
	speed: 0.0179s/iter; left time: 280.6485s
Epoch: 40 cost time: 5.412754535675049
Epoch: 40, Steps: 261 | Train Loss: 0.3777431 Vali Loss: 0.1946143 Test Loss: 0.2688749
Validation loss decreased (0.194725 --> 0.194614).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3349388
	speed: 0.0797s/iter; left time: 1239.5589s
	iters: 200, epoch: 41 | loss: 0.3400217
	speed: 0.0178s/iter; left time: 275.9487s
Epoch: 41 cost time: 5.326565504074097
Epoch: 41, Steps: 261 | Train Loss: 0.3776764 Vali Loss: 0.1947128 Test Loss: 0.2688418
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3589299
	speed: 0.0794s/iter; left time: 1215.2016s
	iters: 200, epoch: 42 | loss: 0.4207636
	speed: 0.0185s/iter; left time: 280.5959s
Epoch: 42 cost time: 5.359945774078369
Epoch: 42, Steps: 261 | Train Loss: 0.3775184 Vali Loss: 0.1946129 Test Loss: 0.2688205
Validation loss decreased (0.194614 --> 0.194613).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3921070
	speed: 0.0807s/iter; left time: 1213.8570s
	iters: 200, epoch: 43 | loss: 0.3289143
	speed: 0.0190s/iter; left time: 284.3505s
Epoch: 43 cost time: 5.557382106781006
Epoch: 43, Steps: 261 | Train Loss: 0.3777152 Vali Loss: 0.1946629 Test Loss: 0.2688852
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2933149
	speed: 0.0783s/iter; left time: 1156.7130s
	iters: 200, epoch: 44 | loss: 0.3186079
	speed: 0.0189s/iter; left time: 277.7259s
Epoch: 44 cost time: 5.382258415222168
Epoch: 44, Steps: 261 | Train Loss: 0.3776884 Vali Loss: 0.1947346 Test Loss: 0.2688914
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.3749775
	speed: 0.0795s/iter; left time: 1154.6441s
	iters: 200, epoch: 45 | loss: 0.5252345
	speed: 0.0177s/iter; left time: 255.8384s
Epoch: 45 cost time: 5.396882057189941
Epoch: 45, Steps: 261 | Train Loss: 0.3776388 Vali Loss: 0.1947673 Test Loss: 0.2688804
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2591104
	speed: 0.0809s/iter; left time: 1153.3755s
	iters: 200, epoch: 46 | loss: 0.5286235
	speed: 0.0181s/iter; left time: 256.3475s
Epoch: 46 cost time: 5.295511484146118
Epoch: 46, Steps: 261 | Train Loss: 0.3778435 Vali Loss: 0.1946963 Test Loss: 0.2688656
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3425882
	speed: 0.0775s/iter; left time: 1084.6037s
	iters: 200, epoch: 47 | loss: 0.3446603
	speed: 0.0177s/iter; left time: 245.2894s
Epoch: 47 cost time: 5.253772020339966
Epoch: 47, Steps: 261 | Train Loss: 0.3777035 Vali Loss: 0.1947211 Test Loss: 0.2688631
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2626986
	speed: 0.0789s/iter; left time: 1083.2482s
	iters: 200, epoch: 48 | loss: 0.5044388
	speed: 0.0188s/iter; left time: 256.5929s
Epoch: 48 cost time: 5.2809717655181885
Epoch: 48, Steps: 261 | Train Loss: 0.3776755 Vali Loss: 0.1947988 Test Loss: 0.2688174
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.3060228
	speed: 0.0759s/iter; left time: 1022.2978s
	iters: 200, epoch: 49 | loss: 0.3022118
	speed: 0.0177s/iter; left time: 237.0008s
Epoch: 49 cost time: 5.176298379898071
Epoch: 49, Steps: 261 | Train Loss: 0.3778222 Vali Loss: 0.1946672 Test Loss: 0.2688327
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.4058806
	speed: 0.0795s/iter; left time: 1050.6381s
	iters: 200, epoch: 50 | loss: 0.3863128
	speed: 0.0173s/iter; left time: 226.2198s
Epoch: 50 cost time: 5.306334495544434
Epoch: 50, Steps: 261 | Train Loss: 0.3774781 Vali Loss: 0.1945000 Test Loss: 0.2688167
Validation loss decreased (0.194613 --> 0.194500).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.3131001
	speed: 0.0772s/iter; left time: 1000.0581s
	iters: 200, epoch: 51 | loss: 0.5081672
	speed: 0.0174s/iter; left time: 223.4871s
Epoch: 51 cost time: 5.171726703643799
Epoch: 51, Steps: 261 | Train Loss: 0.3763542 Vali Loss: 0.1948030 Test Loss: 0.2688347
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.4981041
	speed: 0.0771s/iter; left time: 978.3361s
	iters: 200, epoch: 52 | loss: 0.4858493
	speed: 0.0170s/iter; left time: 213.9070s
Epoch: 52 cost time: 5.132546663284302
Epoch: 52, Steps: 261 | Train Loss: 0.3774904 Vali Loss: 0.1946518 Test Loss: 0.2688147
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.5093646
	speed: 0.0766s/iter; left time: 952.5055s
	iters: 200, epoch: 53 | loss: 0.3509998
	speed: 0.0166s/iter; left time: 204.7037s
Epoch: 53 cost time: 5.120906829833984
Epoch: 53, Steps: 261 | Train Loss: 0.3773088 Vali Loss: 0.1946391 Test Loss: 0.2688245
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.3904498
	speed: 0.0785s/iter; left time: 955.2075s
	iters: 200, epoch: 54 | loss: 0.3885972
	speed: 0.0181s/iter; left time: 218.4195s
Epoch: 54 cost time: 5.143152236938477
Epoch: 54, Steps: 261 | Train Loss: 0.3776245 Vali Loss: 0.1945131 Test Loss: 0.2688276
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.3292278
	speed: 0.0767s/iter; left time: 912.6774s
	iters: 200, epoch: 55 | loss: 0.4251348
	speed: 0.0180s/iter; left time: 212.9569s
Epoch: 55 cost time: 5.192737579345703
Epoch: 55, Steps: 261 | Train Loss: 0.3775051 Vali Loss: 0.1945550 Test Loss: 0.2688226
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3268262
	speed: 0.0808s/iter; left time: 941.2203s
	iters: 200, epoch: 56 | loss: 0.4765582
	speed: 0.0175s/iter; left time: 201.8195s
Epoch: 56 cost time: 5.275655746459961
Epoch: 56, Steps: 261 | Train Loss: 0.3774791 Vali Loss: 0.1946743 Test Loss: 0.2688270
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2562499
	speed: 0.0778s/iter; left time: 886.0207s
	iters: 200, epoch: 57 | loss: 0.3465815
	speed: 0.0175s/iter; left time: 197.1615s
Epoch: 57 cost time: 5.242136001586914
Epoch: 57, Steps: 261 | Train Loss: 0.3771668 Vali Loss: 0.1946459 Test Loss: 0.2688253
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3886450
	speed: 0.0796s/iter; left time: 885.6306s
	iters: 200, epoch: 58 | loss: 0.3393433
	speed: 0.0177s/iter; left time: 194.6306s
Epoch: 58 cost time: 5.2215142250061035
Epoch: 58, Steps: 261 | Train Loss: 0.3772698 Vali Loss: 0.1945294 Test Loss: 0.2688192
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.3325358
	speed: 0.0797s/iter; left time: 865.2892s
	iters: 200, epoch: 59 | loss: 0.4077237
	speed: 0.0170s/iter; left time: 183.3395s
Epoch: 59 cost time: 5.189451456069946
Epoch: 59, Steps: 261 | Train Loss: 0.3770995 Vali Loss: 0.1947077 Test Loss: 0.2688081
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.5200726
	speed: 0.0795s/iter; left time: 843.2847s
	iters: 200, epoch: 60 | loss: 0.3823637
	speed: 0.0209s/iter; left time: 219.9734s
Epoch: 60 cost time: 5.519883871078491
Epoch: 60, Steps: 261 | Train Loss: 0.3769649 Vali Loss: 0.1945706 Test Loss: 0.2688054
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2572955
	speed: 0.0804s/iter; left time: 831.4797s
	iters: 200, epoch: 61 | loss: 0.3181938
	speed: 0.0177s/iter; left time: 181.5505s
Epoch: 61 cost time: 5.201931953430176
Epoch: 61, Steps: 261 | Train Loss: 0.3773126 Vali Loss: 0.1945811 Test Loss: 0.2688031
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3911899
	speed: 0.0822s/iter; left time: 828.1708s
	iters: 200, epoch: 62 | loss: 0.4361544
	speed: 0.0178s/iter; left time: 178.1215s
Epoch: 62 cost time: 5.3688623905181885
Epoch: 62, Steps: 261 | Train Loss: 0.3774593 Vali Loss: 0.1946377 Test Loss: 0.2688075
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.4463610
	speed: 0.0783s/iter; left time: 768.5612s
	iters: 200, epoch: 63 | loss: 0.3357101
	speed: 0.0176s/iter; left time: 171.1259s
Epoch: 63 cost time: 5.196998596191406
Epoch: 63, Steps: 261 | Train Loss: 0.3772674 Vali Loss: 0.1946701 Test Loss: 0.2687938
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.4147434
	speed: 0.0794s/iter; left time: 759.0522s
	iters: 200, epoch: 64 | loss: 0.2774086
	speed: 0.0177s/iter; left time: 167.0359s
Epoch: 64 cost time: 5.21492338180542
Epoch: 64, Steps: 261 | Train Loss: 0.3770132 Vali Loss: 0.1947305 Test Loss: 0.2687978
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.4169601
	speed: 0.0766s/iter; left time: 711.7133s
	iters: 200, epoch: 65 | loss: 0.4507553
	speed: 0.0178s/iter; left time: 164.0001s
Epoch: 65 cost time: 5.272917985916138
Epoch: 65, Steps: 261 | Train Loss: 0.3773560 Vali Loss: 0.1946060 Test Loss: 0.2688077
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.4066153
	speed: 0.0800s/iter; left time: 722.7475s
	iters: 200, epoch: 66 | loss: 0.4031721
	speed: 0.0180s/iter; left time: 161.1848s
Epoch: 66 cost time: 5.511823892593384
Epoch: 66, Steps: 261 | Train Loss: 0.3772575 Vali Loss: 0.1947298 Test Loss: 0.2687941
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.4556607
	speed: 0.0771s/iter; left time: 676.6068s
	iters: 200, epoch: 67 | loss: 0.3097117
	speed: 0.0173s/iter; left time: 150.3461s
Epoch: 67 cost time: 5.203813076019287
Epoch: 67, Steps: 261 | Train Loss: 0.3775143 Vali Loss: 0.1947273 Test Loss: 0.2687943
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2405392
	speed: 0.0768s/iter; left time: 653.5943s
	iters: 200, epoch: 68 | loss: 0.5145675
	speed: 0.0184s/iter; left time: 155.0041s
Epoch: 68 cost time: 5.380158424377441
Epoch: 68, Steps: 261 | Train Loss: 0.3770267 Vali Loss: 0.1947323 Test Loss: 0.2688067
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.3090433
	speed: 0.0788s/iter; left time: 650.2698s
	iters: 200, epoch: 69 | loss: 0.3855302
	speed: 0.0182s/iter; left time: 148.7332s
Epoch: 69 cost time: 5.299432039260864
Epoch: 69, Steps: 261 | Train Loss: 0.3771526 Vali Loss: 0.1946503 Test Loss: 0.2687938
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.3686155
	speed: 0.0748s/iter; left time: 597.4103s
	iters: 200, epoch: 70 | loss: 0.3463670
	speed: 0.0182s/iter; left time: 143.3459s
Epoch: 70 cost time: 5.191428184509277
Epoch: 70, Steps: 261 | Train Loss: 0.3774378 Vali Loss: 0.1947064 Test Loss: 0.2687950
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2698329985141754, mae:0.32736000418663025, rse:0.4195736050605774, corr:[0.5482285  0.5528996  0.55484945 0.55434793 0.552738   0.55114883
 0.55013883 0.54983056 0.55017036 0.5509506  0.55182713 0.5524526
 0.55262285 0.5522741  0.5515732  0.5506605  0.5497394  0.54896903
 0.5484027  0.54802877 0.547807   0.54763055 0.54741716 0.547128
 0.54669654 0.5461301  0.54548085 0.5448177  0.5441939  0.54365385
 0.5431916  0.54286367 0.5426215  0.54234517 0.5419638  0.5414847
 0.5408881  0.5402225  0.5395163  0.5388058  0.5381338  0.5375042
 0.5369321  0.5364058  0.535913   0.5354183  0.5349098  0.5343787
 0.5337598  0.53301096 0.5321375  0.53122354 0.5303079  0.5294467
 0.52869236 0.5281281  0.5277459  0.5275122  0.5273844  0.52730227
 0.5271999  0.5270725  0.52690256 0.52665806 0.5263391  0.52599764
 0.5256446  0.5253377  0.5251183  0.5249743  0.5248496  0.5247004
 0.52447605 0.5241642  0.52373445 0.52321094 0.52260345 0.5219295
 0.5212149  0.5205375  0.5198746  0.5192748  0.51873803 0.51826775
 0.5178641  0.51750696 0.51713276 0.5167187  0.5162436  0.515694
 0.5150832  0.5144251  0.51365745 0.51276505 0.51175165 0.51059014
 0.50932026 0.50805086 0.5067759  0.50549066 0.5042095  0.5029492
 0.5017377  0.5005764  0.49950656 0.4985174  0.49764797 0.49691612
 0.49626672 0.4956219  0.49492583 0.4941224  0.4932617  0.49233356
 0.4913242  0.49030024 0.48934683 0.48846975 0.4877192  0.4870205
 0.4863818  0.4857207  0.48503894 0.48428276 0.48339784 0.48237422
 0.4812885  0.4802125  0.47921312 0.47835255 0.47765628 0.47708717
 0.47660786 0.47617307 0.47573954 0.47524047 0.47461352 0.47388008
 0.47305113 0.4722124  0.47140613 0.47069645 0.47013745 0.46965495
 0.46919954 0.4686346  0.4680021  0.46727228 0.46647814 0.46560484
 0.46471986 0.46390998 0.4631585  0.46245962 0.4618302  0.46132898
 0.4609373  0.46061605 0.4602854  0.4599551  0.45956743 0.45911562
 0.4586008  0.4580805  0.45761517 0.45727512 0.45703363 0.45685828
 0.4567344  0.45666218 0.45651886 0.45624164 0.45579624 0.45518893
 0.4544688  0.45370188 0.45294347 0.45225066 0.4516096  0.45110995
 0.45069918 0.4503246  0.4499954  0.44967124 0.44928026 0.44876117
 0.44809368 0.44729587 0.44636497 0.445288   0.44408634 0.44280365
 0.4415384  0.4404513  0.43946132 0.43843922 0.43735832 0.43615112
 0.4348449  0.43345684 0.43205577 0.43069112 0.4294223  0.42829382
 0.42733917 0.42653292 0.42578363 0.42502528 0.42428562 0.42362803
 0.42292598 0.42211604 0.4211857  0.4201794  0.4192011  0.4182449
 0.4173141  0.4163573  0.41540813 0.41445395 0.41343284 0.41235474
 0.41123125 0.41010034 0.40904507 0.4079944  0.4069587  0.40601215
 0.40511543 0.4043699  0.40373027 0.4032067  0.40271327 0.40220115
 0.40159172 0.40092245 0.40020105 0.39951938 0.39897123 0.39858335
 0.3983685  0.39819488 0.3980091  0.39785308 0.397604   0.3972754
 0.39690527 0.39654502 0.39617065 0.3957806  0.3955078  0.39537606
 0.395373   0.39551982 0.3956678  0.3957508  0.39567408 0.39542115
 0.3950204  0.39449513 0.3939024  0.39333487 0.39285126 0.39254883
 0.3924347  0.39243346 0.39251414 0.39258403 0.39250788 0.3922013
 0.3916596  0.39101526 0.39033252 0.38975376 0.3893438  0.38914272
 0.38923118 0.38946697 0.38971782 0.38991782 0.38994533 0.3897655
 0.38930675 0.38857883 0.3876421  0.3865755  0.38549742 0.38442573
 0.38349506 0.38290736 0.3825986  0.38239208 0.38213512 0.38165385
 0.38098016 0.38012958 0.37914702 0.37815106 0.377372   0.37681818
 0.37663853 0.37675658 0.37710285 0.37739706 0.37750828 0.3773703
 0.37702432 0.37638536 0.37555346 0.37468877 0.37395045 0.37365288
 0.37377125 0.3743168  0.37506938 0.37573758 0.3761123  0.3760786
 0.3755247  0.3745645  0.3734158  0.37233356 0.37155673 0.37140197
 0.3719446  0.37307665 0.3744944  0.37568736 0.37636656 0.37623546
 0.37530142 0.37355632 0.37147468 0.37013844 0.3704548  0.37213522]
