Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2551877
	speed: 0.0870s/iter; left time: 2313.4641s
	iters: 200, epoch: 1 | loss: 0.4222429
	speed: 0.0909s/iter; left time: 2409.1858s
Epoch: 1 cost time: 22.891632556915283
Epoch: 1, Steps: 267 | Train Loss: 0.4269291 Vali Loss: 0.1920448 Test Loss: 0.2662667
Validation loss decreased (inf --> 0.192045).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3668489
	speed: 0.3425s/iter; left time: 9019.6379s
	iters: 200, epoch: 2 | loss: 0.2598432
	speed: 0.0740s/iter; left time: 1940.0755s
Epoch: 2 cost time: 20.49740505218506
Epoch: 2, Steps: 267 | Train Loss: 0.3586211 Vali Loss: 0.1762801 Test Loss: 0.2484705
Validation loss decreased (0.192045 --> 0.176280).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3620844
	speed: 0.3845s/iter; left time: 10022.5970s
	iters: 200, epoch: 3 | loss: 0.3389657
	speed: 0.0733s/iter; left time: 1902.7453s
Epoch: 3 cost time: 20.812917232513428
Epoch: 3, Steps: 267 | Train Loss: 0.3429616 Vali Loss: 0.1714581 Test Loss: 0.2432324
Validation loss decreased (0.176280 --> 0.171458).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2015952
	speed: 0.3490s/iter; left time: 9005.2039s
	iters: 200, epoch: 4 | loss: 0.3096375
	speed: 0.0726s/iter; left time: 1866.2424s
Epoch: 4 cost time: 20.611551761627197
Epoch: 4, Steps: 267 | Train Loss: 0.3364966 Vali Loss: 0.1693792 Test Loss: 0.2404865
Validation loss decreased (0.171458 --> 0.169379).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4985488
	speed: 0.3405s/iter; left time: 8693.7891s
	iters: 200, epoch: 5 | loss: 0.2411750
	speed: 0.0748s/iter; left time: 1902.6818s
Epoch: 5 cost time: 22.717294931411743
Epoch: 5, Steps: 267 | Train Loss: 0.3328470 Vali Loss: 0.1680523 Test Loss: 0.2388579
Validation loss decreased (0.169379 --> 0.168052).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2470745
	speed: 0.3570s/iter; left time: 9019.9470s
	iters: 200, epoch: 6 | loss: 0.4843917
	speed: 0.0759s/iter; left time: 1910.8064s
Epoch: 6 cost time: 21.02519178390503
Epoch: 6, Steps: 267 | Train Loss: 0.3306064 Vali Loss: 0.1672475 Test Loss: 0.2376834
Validation loss decreased (0.168052 --> 0.167248).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3619956
	speed: 0.3566s/iter; left time: 8915.5790s
	iters: 200, epoch: 7 | loss: 0.3150054
	speed: 0.0762s/iter; left time: 1898.3331s
Epoch: 7 cost time: 20.792304277420044
Epoch: 7, Steps: 267 | Train Loss: 0.3289537 Vali Loss: 0.1668860 Test Loss: 0.2367395
Validation loss decreased (0.167248 --> 0.166886).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3005835
	speed: 0.3444s/iter; left time: 8517.2359s
	iters: 200, epoch: 8 | loss: 0.3881506
	speed: 0.0778s/iter; left time: 1916.7385s
Epoch: 8 cost time: 21.770020008087158
Epoch: 8, Steps: 267 | Train Loss: 0.3278303 Vali Loss: 0.1663731 Test Loss: 0.2361792
Validation loss decreased (0.166886 --> 0.166373).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3588748
	speed: 0.3510s/iter; left time: 8587.8753s
	iters: 200, epoch: 9 | loss: 0.3058760
	speed: 0.0750s/iter; left time: 1827.7757s
Epoch: 9 cost time: 20.290749549865723
Epoch: 9, Steps: 267 | Train Loss: 0.3269640 Vali Loss: 0.1663478 Test Loss: 0.2357117
Validation loss decreased (0.166373 --> 0.166348).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.4667704
	speed: 0.3288s/iter; left time: 7956.4965s
	iters: 200, epoch: 10 | loss: 0.3283160
	speed: 0.0759s/iter; left time: 1828.6877s
Epoch: 10 cost time: 20.84340476989746
Epoch: 10, Steps: 267 | Train Loss: 0.3259904 Vali Loss: 0.1658838 Test Loss: 0.2353383
Validation loss decreased (0.166348 --> 0.165884).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3595436
	speed: 0.3425s/iter; left time: 8196.2237s
	iters: 200, epoch: 11 | loss: 0.2303984
	speed: 0.0794s/iter; left time: 1892.5424s
Epoch: 11 cost time: 21.27434229850769
Epoch: 11, Steps: 267 | Train Loss: 0.3256881 Vali Loss: 0.1658969 Test Loss: 0.2349621
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3057035
	speed: 0.3391s/iter; left time: 8025.6200s
	iters: 200, epoch: 12 | loss: 0.3086073
	speed: 0.0756s/iter; left time: 1780.8014s
Epoch: 12 cost time: 20.659155130386353
Epoch: 12, Steps: 267 | Train Loss: 0.3253064 Vali Loss: 0.1657256 Test Loss: 0.2348140
Validation loss decreased (0.165884 --> 0.165726).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3005792
	speed: 0.3378s/iter; left time: 7903.4653s
	iters: 200, epoch: 13 | loss: 0.3988554
	speed: 0.0730s/iter; left time: 1700.1499s
Epoch: 13 cost time: 20.812662363052368
Epoch: 13, Steps: 267 | Train Loss: 0.3250900 Vali Loss: 0.1653584 Test Loss: 0.2346262
Validation loss decreased (0.165726 --> 0.165358).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.5000113
	speed: 0.3364s/iter; left time: 7780.1915s
	iters: 200, epoch: 14 | loss: 0.2945801
	speed: 0.0747s/iter; left time: 1720.7413s
Epoch: 14 cost time: 20.170522689819336
Epoch: 14, Steps: 267 | Train Loss: 0.3248343 Vali Loss: 0.1654957 Test Loss: 0.2345513
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3258525
	speed: 0.3345s/iter; left time: 7648.5194s
	iters: 200, epoch: 15 | loss: 0.3946587
	speed: 0.0763s/iter; left time: 1736.6736s
Epoch: 15 cost time: 21.05256938934326
Epoch: 15, Steps: 267 | Train Loss: 0.3244693 Vali Loss: 0.1653391 Test Loss: 0.2344779
Validation loss decreased (0.165358 --> 0.165339).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2486671
	speed: 0.3407s/iter; left time: 7698.6301s
	iters: 200, epoch: 16 | loss: 0.2639692
	speed: 0.0752s/iter; left time: 1691.6634s
Epoch: 16 cost time: 21.046268224716187
Epoch: 16, Steps: 267 | Train Loss: 0.3244539 Vali Loss: 0.1654174 Test Loss: 0.2343228
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2872355
	speed: 0.3334s/iter; left time: 7444.7132s
	iters: 200, epoch: 17 | loss: 0.2284799
	speed: 0.0730s/iter; left time: 1622.6361s
Epoch: 17 cost time: 20.27853012084961
Epoch: 17, Steps: 267 | Train Loss: 0.3242587 Vali Loss: 0.1652865 Test Loss: 0.2343444
Validation loss decreased (0.165339 --> 0.165286).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.4443216
	speed: 0.3309s/iter; left time: 7299.8933s
	iters: 200, epoch: 18 | loss: 0.3597876
	speed: 0.0741s/iter; left time: 1627.0447s
Epoch: 18 cost time: 20.722975969314575
Epoch: 18, Steps: 267 | Train Loss: 0.3240886 Vali Loss: 0.1651204 Test Loss: 0.2341687
Validation loss decreased (0.165286 --> 0.165120).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2217637
	speed: 0.3313s/iter; left time: 7220.5670s
	iters: 200, epoch: 19 | loss: 0.2479825
	speed: 0.0833s/iter; left time: 1806.1324s
Epoch: 19 cost time: 21.445404529571533
Epoch: 19, Steps: 267 | Train Loss: 0.3239382 Vali Loss: 0.1652053 Test Loss: 0.2341290
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2724063
	speed: 0.3524s/iter; left time: 7587.4116s
	iters: 200, epoch: 20 | loss: 0.3470832
	speed: 0.0763s/iter; left time: 1634.8910s
Epoch: 20 cost time: 20.832308292388916
Epoch: 20, Steps: 267 | Train Loss: 0.3238737 Vali Loss: 0.1652172 Test Loss: 0.2341419
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3766575
	speed: 0.3412s/iter; left time: 7254.7799s
	iters: 200, epoch: 21 | loss: 0.3159692
	speed: 0.0729s/iter; left time: 1542.9167s
Epoch: 21 cost time: 20.616994380950928
Epoch: 21, Steps: 267 | Train Loss: 0.3238123 Vali Loss: 0.1653257 Test Loss: 0.2340323
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4339864
	speed: 0.3337s/iter; left time: 7005.5027s
	iters: 200, epoch: 22 | loss: 0.3891399
	speed: 0.0727s/iter; left time: 1520.0158s
Epoch: 22 cost time: 20.349433422088623
Epoch: 22, Steps: 267 | Train Loss: 0.3237264 Vali Loss: 0.1651310 Test Loss: 0.2339741
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3835735
	speed: 0.3330s/iter; left time: 6902.3297s
	iters: 200, epoch: 23 | loss: 0.2913415
	speed: 0.0736s/iter; left time: 1518.0192s
Epoch: 23 cost time: 20.568319082260132
Epoch: 23, Steps: 267 | Train Loss: 0.3236450 Vali Loss: 0.1651033 Test Loss: 0.2339395
Validation loss decreased (0.165120 --> 0.165103).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3940654
	speed: 0.3289s/iter; left time: 6729.4407s
	iters: 200, epoch: 24 | loss: 0.2713512
	speed: 0.0739s/iter; left time: 1504.1614s
Epoch: 24 cost time: 20.473140478134155
Epoch: 24, Steps: 267 | Train Loss: 0.3235662 Vali Loss: 0.1651292 Test Loss: 0.2338962
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4342983
	speed: 0.3325s/iter; left time: 6714.9837s
	iters: 200, epoch: 25 | loss: 0.2935835
	speed: 0.0745s/iter; left time: 1497.4714s
Epoch: 25 cost time: 20.50324821472168
Epoch: 25, Steps: 267 | Train Loss: 0.3234451 Vali Loss: 0.1651738 Test Loss: 0.2338955
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3314113
	speed: 0.3360s/iter; left time: 6694.2783s
	iters: 200, epoch: 26 | loss: 0.3908443
	speed: 0.0726s/iter; left time: 1438.6492s
Epoch: 26 cost time: 20.433825492858887
Epoch: 26, Steps: 267 | Train Loss: 0.3234384 Vali Loss: 0.1653120 Test Loss: 0.2338470
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2723173
	speed: 0.3328s/iter; left time: 6543.3838s
	iters: 200, epoch: 27 | loss: 0.3836388
	speed: 0.0744s/iter; left time: 1455.9770s
Epoch: 27 cost time: 20.620724201202393
Epoch: 27, Steps: 267 | Train Loss: 0.3234178 Vali Loss: 0.1652097 Test Loss: 0.2338116
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3232344
	speed: 0.3400s/iter; left time: 6593.3220s
	iters: 200, epoch: 28 | loss: 0.2802258
	speed: 0.0738s/iter; left time: 1424.1156s
Epoch: 28 cost time: 20.494950532913208
Epoch: 28, Steps: 267 | Train Loss: 0.3233595 Vali Loss: 0.1651335 Test Loss: 0.2337999
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2287261
	speed: 0.3274s/iter; left time: 6262.0190s
	iters: 200, epoch: 29 | loss: 0.3821552
	speed: 0.0723s/iter; left time: 1375.2685s
Epoch: 29 cost time: 20.081576585769653
Epoch: 29, Steps: 267 | Train Loss: 0.3233235 Vali Loss: 0.1651663 Test Loss: 0.2337887
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3248996
	speed: 0.3384s/iter; left time: 6382.2559s
	iters: 200, epoch: 30 | loss: 0.2742949
	speed: 0.0733s/iter; left time: 1375.6265s
Epoch: 30 cost time: 20.665430068969727
Epoch: 30, Steps: 267 | Train Loss: 0.3232888 Vali Loss: 0.1651652 Test Loss: 0.2337846
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3151765
	speed: 0.3440s/iter; left time: 6395.7809s
	iters: 200, epoch: 31 | loss: 0.3437149
	speed: 0.0625s/iter; left time: 1156.3179s
Epoch: 31 cost time: 19.10472273826599
Epoch: 31, Steps: 267 | Train Loss: 0.3231393 Vali Loss: 0.1653156 Test Loss: 0.2337778
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3339708
	speed: 0.3419s/iter; left time: 6264.5332s
	iters: 200, epoch: 32 | loss: 0.4199787
	speed: 0.0703s/iter; left time: 1280.8604s
Epoch: 32 cost time: 20.3560209274292
Epoch: 32, Steps: 267 | Train Loss: 0.3228929 Vali Loss: 0.1650470 Test Loss: 0.2337325
Validation loss decreased (0.165103 --> 0.165047).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2406726
	speed: 0.3920s/iter; left time: 7078.4214s
	iters: 200, epoch: 33 | loss: 0.2362919
	speed: 0.1021s/iter; left time: 1832.6720s
Epoch: 33 cost time: 27.07995057106018
Epoch: 33, Steps: 267 | Train Loss: 0.3231300 Vali Loss: 0.1652267 Test Loss: 0.2337171
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3245010
	speed: 0.4160s/iter; left time: 7400.4579s
	iters: 200, epoch: 34 | loss: 0.4193579
	speed: 0.0861s/iter; left time: 1522.7862s
Epoch: 34 cost time: 23.802950859069824
Epoch: 34, Steps: 267 | Train Loss: 0.3231689 Vali Loss: 0.1650765 Test Loss: 0.2337096
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3203736
	speed: 0.3375s/iter; left time: 5914.0829s
	iters: 200, epoch: 35 | loss: 0.3217668
	speed: 0.1065s/iter; left time: 1855.4087s
Epoch: 35 cost time: 26.112549304962158
Epoch: 35, Steps: 267 | Train Loss: 0.3231382 Vali Loss: 0.1651805 Test Loss: 0.2337224
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.4029359
	speed: 0.3738s/iter; left time: 6449.8416s
	iters: 200, epoch: 36 | loss: 0.2632237
	speed: 0.0947s/iter; left time: 1623.9957s
Epoch: 36 cost time: 24.968751430511475
Epoch: 36, Steps: 267 | Train Loss: 0.3229186 Vali Loss: 0.1652189 Test Loss: 0.2336892
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.4148559
	speed: 0.3917s/iter; left time: 6653.9386s
	iters: 200, epoch: 37 | loss: 0.3364094
	speed: 0.1008s/iter; left time: 1702.2037s
Epoch: 37 cost time: 26.23928737640381
Epoch: 37, Steps: 267 | Train Loss: 0.3230168 Vali Loss: 0.1651129 Test Loss: 0.2337006
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.4186170
	speed: 0.3993s/iter; left time: 6677.1930s
	iters: 200, epoch: 38 | loss: 0.3138596
	speed: 0.0720s/iter; left time: 1196.3950s
Epoch: 38 cost time: 20.233813524246216
Epoch: 38, Steps: 267 | Train Loss: 0.3229461 Vali Loss: 0.1650206 Test Loss: 0.2336689
Validation loss decreased (0.165047 --> 0.165021).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2662953
	speed: 0.3275s/iter; left time: 5389.8330s
	iters: 200, epoch: 39 | loss: 0.3075717
	speed: 0.0717s/iter; left time: 1173.3945s
Epoch: 39 cost time: 20.262315273284912
Epoch: 39, Steps: 267 | Train Loss: 0.3230242 Vali Loss: 0.1649607 Test Loss: 0.2336682
Validation loss decreased (0.165021 --> 0.164961).  Saving model ...
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3197878
	speed: 0.3366s/iter; left time: 5448.5583s
	iters: 200, epoch: 40 | loss: 0.2696119
	speed: 0.0827s/iter; left time: 1329.7002s
Epoch: 40 cost time: 22.637367010116577
Epoch: 40, Steps: 267 | Train Loss: 0.3229259 Vali Loss: 0.1652695 Test Loss: 0.2336579
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3044135
	speed: 0.3292s/iter; left time: 5241.4420s
	iters: 200, epoch: 41 | loss: 0.2914627
	speed: 0.0761s/iter; left time: 1204.2590s
Epoch: 41 cost time: 19.083389043807983
Epoch: 41, Steps: 267 | Train Loss: 0.3230309 Vali Loss: 0.1652152 Test Loss: 0.2336500
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2965853
	speed: 0.3212s/iter; left time: 5027.3042s
	iters: 200, epoch: 42 | loss: 0.2376441
	speed: 0.0720s/iter; left time: 1120.3154s
Epoch: 42 cost time: 19.772725343704224
Epoch: 42, Steps: 267 | Train Loss: 0.3229810 Vali Loss: 0.1649701 Test Loss: 0.2336448
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3573068
	speed: 0.3073s/iter; left time: 4728.7386s
	iters: 200, epoch: 43 | loss: 0.3311931
	speed: 0.0733s/iter; left time: 1120.1737s
Epoch: 43 cost time: 21.141098976135254
Epoch: 43, Steps: 267 | Train Loss: 0.3229767 Vali Loss: 0.1649766 Test Loss: 0.2336402
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3013124
	speed: 0.3440s/iter; left time: 5200.9538s
	iters: 200, epoch: 44 | loss: 0.5095783
	speed: 0.0733s/iter; left time: 1100.3222s
Epoch: 44 cost time: 20.503662824630737
Epoch: 44, Steps: 267 | Train Loss: 0.3229501 Vali Loss: 0.1651466 Test Loss: 0.2336453
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2817915
	speed: 0.3224s/iter; left time: 4788.2586s
	iters: 200, epoch: 45 | loss: 0.3724546
	speed: 0.0784s/iter; left time: 1156.8028s
Epoch: 45 cost time: 20.731825351715088
Epoch: 45, Steps: 267 | Train Loss: 0.3229623 Vali Loss: 0.1651602 Test Loss: 0.2336465
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3918656
	speed: 0.3234s/iter; left time: 4717.0617s
	iters: 200, epoch: 46 | loss: 0.3705036
	speed: 0.0720s/iter; left time: 1043.2857s
Epoch: 46 cost time: 19.684176683425903
Epoch: 46, Steps: 267 | Train Loss: 0.3229111 Vali Loss: 0.1651127 Test Loss: 0.2336280
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2738010
	speed: 0.3207s/iter; left time: 4591.9562s
	iters: 200, epoch: 47 | loss: 0.2075334
	speed: 0.0726s/iter; left time: 1032.2761s
Epoch: 47 cost time: 19.948381185531616
Epoch: 47, Steps: 267 | Train Loss: 0.3229666 Vali Loss: 0.1652048 Test Loss: 0.2336370
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3818296
	speed: 0.3290s/iter; left time: 4622.4745s
	iters: 200, epoch: 48 | loss: 0.3288400
	speed: 0.0742s/iter; left time: 1035.5665s
Epoch: 48 cost time: 20.080286264419556
Epoch: 48, Steps: 267 | Train Loss: 0.3227897 Vali Loss: 0.1651201 Test Loss: 0.2336265
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2714811
	speed: 0.3282s/iter; left time: 4524.5983s
	iters: 200, epoch: 49 | loss: 0.5038942
	speed: 0.0728s/iter; left time: 996.0292s
Epoch: 49 cost time: 20.329333305358887
Epoch: 49, Steps: 267 | Train Loss: 0.3227958 Vali Loss: 0.1651817 Test Loss: 0.2336316
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.3072385
	speed: 0.3263s/iter; left time: 4411.3922s
	iters: 200, epoch: 50 | loss: 0.2485268
	speed: 0.0723s/iter; left time: 970.3474s
Epoch: 50 cost time: 20.010279655456543
Epoch: 50, Steps: 267 | Train Loss: 0.3229313 Vali Loss: 0.1651298 Test Loss: 0.2336104
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2183676
	speed: 0.3170s/iter; left time: 4200.3814s
	iters: 200, epoch: 51 | loss: 0.4763573
	speed: 0.0718s/iter; left time: 944.1825s
Epoch: 51 cost time: 20.598578691482544
Epoch: 51, Steps: 267 | Train Loss: 0.3228704 Vali Loss: 0.1651565 Test Loss: 0.2336083
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2569889
	speed: 0.3482s/iter; left time: 4521.3293s
	iters: 200, epoch: 52 | loss: 0.3953106
	speed: 0.0718s/iter; left time: 924.5317s
Epoch: 52 cost time: 19.892815589904785
Epoch: 52, Steps: 267 | Train Loss: 0.3227727 Vali Loss: 0.1648690 Test Loss: 0.2336141
Validation loss decreased (0.164961 --> 0.164869).  Saving model ...
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.3961626
	speed: 0.3200s/iter; left time: 4069.5213s
	iters: 200, epoch: 53 | loss: 0.2851987
	speed: 0.0776s/iter; left time: 979.6237s
Epoch: 53 cost time: 20.207040309906006
Epoch: 53, Steps: 267 | Train Loss: 0.3228989 Vali Loss: 0.1652292 Test Loss: 0.2336044
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2929805
	speed: 0.3300s/iter; left time: 4108.2205s
	iters: 200, epoch: 54 | loss: 0.2336161
	speed: 0.0722s/iter; left time: 891.8044s
Epoch: 54 cost time: 20.039046049118042
Epoch: 54, Steps: 267 | Train Loss: 0.3228480 Vali Loss: 0.1651400 Test Loss: 0.2336038
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2234342
	speed: 0.3339s/iter; left time: 4068.1194s
	iters: 200, epoch: 55 | loss: 0.2207472
	speed: 0.0686s/iter; left time: 828.6584s
Epoch: 55 cost time: 19.867719411849976
Epoch: 55, Steps: 267 | Train Loss: 0.3228197 Vali Loss: 0.1652575 Test Loss: 0.2336038
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3177530
	speed: 0.3301s/iter; left time: 3933.9154s
	iters: 200, epoch: 56 | loss: 0.2455419
	speed: 0.0696s/iter; left time: 822.2857s
Epoch: 56 cost time: 19.59377956390381
Epoch: 56, Steps: 267 | Train Loss: 0.3228063 Vali Loss: 0.1651128 Test Loss: 0.2336031
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3277773
	speed: 0.3501s/iter; left time: 4078.2544s
	iters: 200, epoch: 57 | loss: 0.2902808
	speed: 0.0833s/iter; left time: 962.0201s
Epoch: 57 cost time: 20.955517530441284
Epoch: 57, Steps: 267 | Train Loss: 0.3227602 Vali Loss: 0.1651708 Test Loss: 0.2335984
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3097046
	speed: 0.3312s/iter; left time: 3770.0547s
	iters: 200, epoch: 58 | loss: 0.2858483
	speed: 0.0722s/iter; left time: 814.5778s
Epoch: 58 cost time: 20.733715772628784
Epoch: 58, Steps: 267 | Train Loss: 0.3228173 Vali Loss: 0.1649467 Test Loss: 0.2335958
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.5947080
	speed: 0.3828s/iter; left time: 4254.8822s
	iters: 200, epoch: 59 | loss: 0.3480722
	speed: 0.0716s/iter; left time: 788.7027s
Epoch: 59 cost time: 20.314411401748657
Epoch: 59, Steps: 267 | Train Loss: 0.3228483 Vali Loss: 0.1652147 Test Loss: 0.2335975
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.3070883
	speed: 0.3345s/iter; left time: 3629.1794s
	iters: 200, epoch: 60 | loss: 0.2959083
	speed: 0.0690s/iter; left time: 741.2400s
Epoch: 60 cost time: 20.100966215133667
Epoch: 60, Steps: 267 | Train Loss: 0.3228181 Vali Loss: 0.1651389 Test Loss: 0.2335976
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2546393
	speed: 0.3193s/iter; left time: 3378.5503s
	iters: 200, epoch: 61 | loss: 0.3586304
	speed: 0.0746s/iter; left time: 782.1769s
Epoch: 61 cost time: 19.93468952178955
Epoch: 61, Steps: 267 | Train Loss: 0.3228589 Vali Loss: 0.1651701 Test Loss: 0.2335923
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3735511
	speed: 0.3217s/iter; left time: 3317.6299s
	iters: 200, epoch: 62 | loss: 0.2197500
	speed: 0.0716s/iter; left time: 731.5614s
Epoch: 62 cost time: 19.720256805419922
Epoch: 62, Steps: 267 | Train Loss: 0.3228152 Vali Loss: 0.1651735 Test Loss: 0.2335914
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1955615
	speed: 0.3187s/iter; left time: 3202.2504s
	iters: 200, epoch: 63 | loss: 0.2184241
	speed: 0.0703s/iter; left time: 698.7986s
Epoch: 63 cost time: 19.721848964691162
Epoch: 63, Steps: 267 | Train Loss: 0.3226758 Vali Loss: 0.1652150 Test Loss: 0.2335887
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.3174923
	speed: 0.3292s/iter; left time: 3219.3640s
	iters: 200, epoch: 64 | loss: 0.2893465
	speed: 0.0718s/iter; left time: 694.8595s
Epoch: 64 cost time: 20.028249263763428
Epoch: 64, Steps: 267 | Train Loss: 0.3228458 Vali Loss: 0.1652104 Test Loss: 0.2335921
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2804461
	speed: 0.3277s/iter; left time: 3117.5871s
	iters: 200, epoch: 65 | loss: 0.3844865
	speed: 0.0727s/iter; left time: 684.7126s
Epoch: 65 cost time: 20.232967138290405
Epoch: 65, Steps: 267 | Train Loss: 0.3228069 Vali Loss: 0.1650645 Test Loss: 0.2335899
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.4235853
	speed: 0.3114s/iter; left time: 2879.4088s
	iters: 200, epoch: 66 | loss: 0.1984378
	speed: 0.0671s/iter; left time: 613.3206s
Epoch: 66 cost time: 18.537607431411743
Epoch: 66, Steps: 267 | Train Loss: 0.3226929 Vali Loss: 0.1653209 Test Loss: 0.2335859
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2563612
	speed: 0.3072s/iter; left time: 2758.0179s
	iters: 200, epoch: 67 | loss: 0.3079067
	speed: 0.0680s/iter; left time: 604.0829s
Epoch: 67 cost time: 18.872246980667114
Epoch: 67, Steps: 267 | Train Loss: 0.3228414 Vali Loss: 0.1651594 Test Loss: 0.2335876
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1912880
	speed: 0.3173s/iter; left time: 2763.9664s
	iters: 200, epoch: 68 | loss: 0.4170141
	speed: 0.0713s/iter; left time: 614.3010s
Epoch: 68 cost time: 19.562530517578125
Epoch: 68, Steps: 267 | Train Loss: 0.3227268 Vali Loss: 0.1651785 Test Loss: 0.2335835
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2690203
	speed: 0.3235s/iter; left time: 2732.1637s
	iters: 200, epoch: 69 | loss: 0.2556286
	speed: 0.0674s/iter; left time: 562.4246s
Epoch: 69 cost time: 19.112316370010376
Epoch: 69, Steps: 267 | Train Loss: 0.3226678 Vali Loss: 0.1651793 Test Loss: 0.2335839
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.3337071
	speed: 0.2921s/iter; left time: 2389.0028s
	iters: 200, epoch: 70 | loss: 0.2949219
	speed: 0.0644s/iter; left time: 520.2392s
Epoch: 70 cost time: 18.03919005393982
Epoch: 70, Steps: 267 | Train Loss: 0.3227439 Vali Loss: 0.1650007 Test Loss: 0.2335798
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.3029842
	speed: 0.3201s/iter; left time: 2532.1769s
	iters: 200, epoch: 71 | loss: 0.2869542
	speed: 0.0632s/iter; left time: 493.8161s
Epoch: 71 cost time: 19.09844183921814
Epoch: 71, Steps: 267 | Train Loss: 0.3227817 Vali Loss: 0.1651376 Test Loss: 0.2335837
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2687145
	speed: 0.3202s/iter; left time: 2447.2500s
	iters: 200, epoch: 72 | loss: 0.3050187
	speed: 0.0666s/iter; left time: 502.7740s
Epoch: 72 cost time: 19.14714527130127
Epoch: 72, Steps: 267 | Train Loss: 0.3227369 Vali Loss: 0.1649704 Test Loss: 0.2335806
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2343997061252594, mae:0.29807063937187195, rse:0.3918985426425934, corr:[0.5603835  0.5649438  0.5656069  0.5634862  0.5603945  0.55776757
 0.55634105 0.5560226  0.5563503  0.556799   0.55689126 0.55644935
 0.55550057 0.554227   0.55303884 0.55215764 0.551632   0.5513563
 0.5511718  0.55090535 0.55046314 0.54981506 0.54901683 0.5482175
 0.5475375  0.54700977 0.5466449  0.5463636  0.54606164 0.5456513
 0.54512763 0.5445492  0.54392433 0.5432971  0.5426781  0.5421273
 0.541608   0.5411431  0.5406971  0.54023015 0.5397434  0.5392288
 0.53866273 0.5380436  0.5373682  0.5367013  0.5360567  0.53543794
 0.5348188  0.5341631  0.5334441  0.5326922  0.53189874 0.5310791
 0.53032756 0.5297716  0.5293992  0.5292227  0.52915376 0.5291251
 0.52900356 0.5287887  0.528485   0.52810216 0.52772033 0.5274561
 0.5273162  0.5273069  0.52738065 0.52747965 0.5274955  0.52737546
 0.527147   0.5267972  0.5264459  0.52611417 0.52584386 0.52558863
 0.5253507  0.52508426 0.5247509  0.5243073  0.523798   0.52325195
 0.52270436 0.52223665 0.5218279  0.5215481  0.52135193 0.5211591
 0.52090657 0.52052647 0.51989543 0.5189626  0.51770973 0.51616675
 0.5144352  0.5127735  0.51127034 0.5098939  0.5085887  0.5073078
 0.5060298  0.5047784  0.5035287  0.50233513 0.5012502  0.50029916
 0.49938178 0.49826446 0.4970392  0.49570224 0.49440426 0.4932325
 0.49219307 0.49132052 0.4905551  0.48979577 0.48898655 0.48801628
 0.48690906 0.48576054 0.48470256 0.48376182 0.48291767 0.4821264
 0.48130938 0.48044953 0.4795612  0.47861323 0.47766167 0.47670993
 0.47582164 0.47497976 0.4743053  0.47384867 0.47353172 0.47334787
 0.47314087 0.47278643 0.47219485 0.4713639  0.4703891  0.4693465
 0.4683335  0.4674517  0.4667009  0.4661158  0.46569675 0.46527842
 0.4647921  0.4642939  0.46373016 0.46315342 0.4626031  0.46212444
 0.4617399  0.46145672 0.46112037 0.4607495  0.460321   0.4598645
 0.45949543 0.45917055 0.45905566 0.45910087 0.4592514  0.45948473
 0.45971933 0.4599306  0.46006265 0.46009463 0.4600794  0.4599302
 0.45974493 0.45952857 0.45938182 0.45931634 0.4592919  0.45930427
 0.4591745  0.45881176 0.45838356 0.4579667  0.45773154 0.45767432
 0.4578613  0.45830664 0.45876944 0.45881858 0.4577525  0.45491362]
