Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  650496.0
params:  759.0
Trainable parameters:  759
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1801258
	speed: 0.0173s/iter; left time: 460.7882s
	iters: 200, epoch: 1 | loss: 0.1832159
	speed: 0.0112s/iter; left time: 295.7698s
Epoch: 1 cost time: 3.603599786758423
Epoch: 1, Steps: 267 | Train Loss: 0.2069060 Vali Loss: 0.1586062 Test Loss: 0.2205669
Validation loss decreased (inf --> 0.158606).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1493921
	speed: 0.0622s/iter; left time: 1639.1437s
	iters: 200, epoch: 2 | loss: 0.1576202
	speed: 0.0103s/iter; left time: 269.5258s
Epoch: 2 cost time: 3.3899729251861572
Epoch: 2, Steps: 267 | Train Loss: 0.1383564 Vali Loss: 0.1431344 Test Loss: 0.2006502
Validation loss decreased (0.158606 --> 0.143134).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1439460
	speed: 0.0601s/iter; left time: 1565.5898s
	iters: 200, epoch: 3 | loss: 0.1165977
	speed: 0.0104s/iter; left time: 270.7332s
Epoch: 3 cost time: 3.376563787460327
Epoch: 3, Steps: 267 | Train Loss: 0.1153572 Vali Loss: 0.1368722 Test Loss: 0.1925656
Validation loss decreased (0.143134 --> 0.136872).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0929542
	speed: 0.0601s/iter; left time: 1551.8019s
	iters: 200, epoch: 4 | loss: 0.0885426
	speed: 0.0101s/iter; left time: 260.2456s
Epoch: 4 cost time: 3.2685024738311768
Epoch: 4, Steps: 267 | Train Loss: 0.1050935 Vali Loss: 0.1328495 Test Loss: 0.1872969
Validation loss decreased (0.136872 --> 0.132849).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1182541
	speed: 0.0598s/iter; left time: 1526.2639s
	iters: 200, epoch: 5 | loss: 0.0749671
	speed: 0.0100s/iter; left time: 254.6416s
Epoch: 5 cost time: 3.28375244140625
Epoch: 5, Steps: 267 | Train Loss: 0.0998799 Vali Loss: 0.1303479 Test Loss: 0.1836280
Validation loss decreased (0.132849 --> 0.130348).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1128423
	speed: 0.0596s/iter; left time: 1506.2103s
	iters: 200, epoch: 6 | loss: 0.1473417
	speed: 0.0107s/iter; left time: 268.1617s
Epoch: 6 cost time: 3.464930295944214
Epoch: 6, Steps: 267 | Train Loss: 0.0967483 Vali Loss: 0.1285699 Test Loss: 0.1809567
Validation loss decreased (0.130348 --> 0.128570).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0748206
	speed: 0.0596s/iter; left time: 1490.8617s
	iters: 200, epoch: 7 | loss: 0.1173310
	speed: 0.0118s/iter; left time: 293.5880s
Epoch: 7 cost time: 3.4492194652557373
Epoch: 7, Steps: 267 | Train Loss: 0.0948073 Vali Loss: 0.1274017 Test Loss: 0.1791916
Validation loss decreased (0.128570 --> 0.127402).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0921872
	speed: 0.0590s/iter; left time: 1458.1765s
	iters: 200, epoch: 8 | loss: 0.0637373
	speed: 0.0108s/iter; left time: 266.2106s
Epoch: 8 cost time: 3.385110855102539
Epoch: 8, Steps: 267 | Train Loss: 0.0937624 Vali Loss: 0.1268383 Test Loss: 0.1781737
Validation loss decreased (0.127402 --> 0.126838).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0943925
	speed: 0.0606s/iter; left time: 1483.6158s
	iters: 200, epoch: 9 | loss: 0.0953780
	speed: 0.0100s/iter; left time: 244.6846s
Epoch: 9 cost time: 3.2967076301574707
Epoch: 9, Steps: 267 | Train Loss: 0.0931023 Vali Loss: 0.1262789 Test Loss: 0.1774058
Validation loss decreased (0.126838 --> 0.126279).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0805103
	speed: 0.0580s/iter; left time: 1404.0770s
	iters: 200, epoch: 10 | loss: 0.1523178
	speed: 0.0106s/iter; left time: 254.8027s
Epoch: 10 cost time: 3.2419991493225098
Epoch: 10, Steps: 267 | Train Loss: 0.0926889 Vali Loss: 0.1260763 Test Loss: 0.1768059
Validation loss decreased (0.126279 --> 0.126076).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0808427
	speed: 0.0596s/iter; left time: 1427.0198s
	iters: 200, epoch: 11 | loss: 0.0631998
	speed: 0.0101s/iter; left time: 240.5662s
Epoch: 11 cost time: 3.3086435794830322
Epoch: 11, Steps: 267 | Train Loss: 0.0924441 Vali Loss: 0.1258316 Test Loss: 0.1766093
Validation loss decreased (0.126076 --> 0.125832).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0645639
	speed: 0.0592s/iter; left time: 1401.6689s
	iters: 200, epoch: 12 | loss: 0.1317390
	speed: 0.0102s/iter; left time: 240.7389s
Epoch: 12 cost time: 3.307027578353882
Epoch: 12, Steps: 267 | Train Loss: 0.0923254 Vali Loss: 0.1258276 Test Loss: 0.1764698
Validation loss decreased (0.125832 --> 0.125828).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1093962
	speed: 0.0595s/iter; left time: 1391.2830s
	iters: 200, epoch: 13 | loss: 0.1074930
	speed: 0.0102s/iter; left time: 237.0812s
Epoch: 13 cost time: 3.2845656871795654
Epoch: 13, Steps: 267 | Train Loss: 0.0922165 Vali Loss: 0.1258214 Test Loss: 0.1764355
Validation loss decreased (0.125828 --> 0.125821).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0620739
	speed: 0.0582s/iter; left time: 1346.6916s
	iters: 200, epoch: 14 | loss: 0.0783427
	speed: 0.0106s/iter; left time: 243.1824s
Epoch: 14 cost time: 3.296685218811035
Epoch: 14, Steps: 267 | Train Loss: 0.0921693 Vali Loss: 0.1258752 Test Loss: 0.1763217
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0584970
	speed: 0.0602s/iter; left time: 1376.7266s
	iters: 200, epoch: 15 | loss: 0.0890342
	speed: 0.0101s/iter; left time: 230.7558s
Epoch: 15 cost time: 3.3460988998413086
Epoch: 15, Steps: 267 | Train Loss: 0.0921758 Vali Loss: 0.1257712 Test Loss: 0.1762102
Validation loss decreased (0.125821 --> 0.125771).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0726900
	speed: 0.0595s/iter; left time: 1345.0420s
	iters: 200, epoch: 16 | loss: 0.0775715
	speed: 0.0102s/iter; left time: 229.8275s
Epoch: 16 cost time: 3.2850492000579834
Epoch: 16, Steps: 267 | Train Loss: 0.0922598 Vali Loss: 0.1259010 Test Loss: 0.1762744
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1145796
	speed: 0.0602s/iter; left time: 1344.0731s
	iters: 200, epoch: 17 | loss: 0.0814538
	speed: 0.0101s/iter; left time: 224.7827s
Epoch: 17 cost time: 3.3794469833374023
Epoch: 17, Steps: 267 | Train Loss: 0.0922250 Vali Loss: 0.1259716 Test Loss: 0.1763622
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0856845
	speed: 0.0603s/iter; left time: 1330.5975s
	iters: 200, epoch: 18 | loss: 0.0855930
	speed: 0.0102s/iter; left time: 224.4632s
Epoch: 18 cost time: 3.3171494007110596
Epoch: 18, Steps: 267 | Train Loss: 0.0921269 Vali Loss: 0.1259335 Test Loss: 0.1762892
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0850899
	speed: 0.0594s/iter; left time: 1294.5622s
	iters: 200, epoch: 19 | loss: 0.0990835
	speed: 0.0101s/iter; left time: 218.4657s
Epoch: 19 cost time: 3.332953929901123
Epoch: 19, Steps: 267 | Train Loss: 0.0922125 Vali Loss: 0.1260147 Test Loss: 0.1762790
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0971761
	speed: 0.0595s/iter; left time: 1280.6534s
	iters: 200, epoch: 20 | loss: 0.0822522
	speed: 0.0103s/iter; left time: 220.4362s
Epoch: 20 cost time: 3.265317678451538
Epoch: 20, Steps: 267 | Train Loss: 0.0921513 Vali Loss: 0.1260882 Test Loss: 0.1763207
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1687397
	speed: 0.0596s/iter; left time: 1266.4508s
	iters: 200, epoch: 21 | loss: 0.0637701
	speed: 0.0104s/iter; left time: 219.4466s
Epoch: 21 cost time: 3.430441379547119
Epoch: 21, Steps: 267 | Train Loss: 0.0921404 Vali Loss: 0.1258820 Test Loss: 0.1763545
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1083235
	speed: 0.0623s/iter; left time: 1307.8205s
	iters: 200, epoch: 22 | loss: 0.0973747
	speed: 0.0104s/iter; left time: 217.4304s
Epoch: 22 cost time: 3.4080586433410645
Epoch: 22, Steps: 267 | Train Loss: 0.0921413 Vali Loss: 0.1260292 Test Loss: 0.1763404
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1051501
	speed: 0.0596s/iter; left time: 1236.2965s
	iters: 200, epoch: 23 | loss: 0.1006329
	speed: 0.0101s/iter; left time: 208.8108s
Epoch: 23 cost time: 3.3255667686462402
Epoch: 23, Steps: 267 | Train Loss: 0.0921515 Vali Loss: 0.1260180 Test Loss: 0.1764423
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1034736
	speed: 0.0579s/iter; left time: 1184.2406s
	iters: 200, epoch: 24 | loss: 0.0958859
	speed: 0.0104s/iter; left time: 212.3223s
Epoch: 24 cost time: 3.314634084701538
Epoch: 24, Steps: 267 | Train Loss: 0.0919593 Vali Loss: 0.1260380 Test Loss: 0.1763924
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0792655
	speed: 0.0601s/iter; left time: 1214.2754s
	iters: 200, epoch: 25 | loss: 0.1019593
	speed: 0.0100s/iter; left time: 200.8429s
Epoch: 25 cost time: 3.3096587657928467
Epoch: 25, Steps: 267 | Train Loss: 0.0921476 Vali Loss: 0.1260454 Test Loss: 0.1763689
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0709571
	speed: 0.0602s/iter; left time: 1198.8306s
	iters: 200, epoch: 26 | loss: 0.0817814
	speed: 0.0105s/iter; left time: 207.4288s
Epoch: 26 cost time: 3.3930537700653076
Epoch: 26, Steps: 267 | Train Loss: 0.0920302 Vali Loss: 0.1260038 Test Loss: 0.1762982
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0671107
	speed: 0.0608s/iter; left time: 1196.1562s
	iters: 200, epoch: 27 | loss: 0.1091882
	speed: 0.0104s/iter; left time: 203.8974s
Epoch: 27 cost time: 3.2521471977233887
Epoch: 27, Steps: 267 | Train Loss: 0.0920162 Vali Loss: 0.1260079 Test Loss: 0.1763286
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0776011
	speed: 0.0582s/iter; left time: 1129.5270s
	iters: 200, epoch: 28 | loss: 0.0792671
	speed: 0.0101s/iter; left time: 194.9250s
Epoch: 28 cost time: 3.2529776096343994
Epoch: 28, Steps: 267 | Train Loss: 0.0921424 Vali Loss: 0.1259585 Test Loss: 0.1763441
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0643359
	speed: 0.0608s/iter; left time: 1163.4945s
	iters: 200, epoch: 29 | loss: 0.0912021
	speed: 0.0102s/iter; left time: 194.3703s
Epoch: 29 cost time: 4.5982890129089355
Epoch: 29, Steps: 267 | Train Loss: 0.0921842 Vali Loss: 0.1261191 Test Loss: 0.1763749
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0637283
	speed: 0.0705s/iter; left time: 1329.8563s
	iters: 200, epoch: 30 | loss: 0.0732781
	speed: 0.0100s/iter; left time: 188.3740s
Epoch: 30 cost time: 3.3948957920074463
Epoch: 30, Steps: 267 | Train Loss: 0.0921694 Vali Loss: 0.1260423 Test Loss: 0.1764298
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0653509
	speed: 0.0686s/iter; left time: 1276.2145s
	iters: 200, epoch: 31 | loss: 0.0760245
	speed: 0.0101s/iter; left time: 187.0084s
Epoch: 31 cost time: 3.216053009033203
Epoch: 31, Steps: 267 | Train Loss: 0.0920048 Vali Loss: 0.1261127 Test Loss: 0.1764198
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0668617
	speed: 0.0595s/iter; left time: 1090.8627s
	iters: 200, epoch: 32 | loss: 0.0606261
	speed: 0.0100s/iter; left time: 182.8696s
Epoch: 32 cost time: 3.2391350269317627
Epoch: 32, Steps: 267 | Train Loss: 0.0919742 Vali Loss: 0.1260303 Test Loss: 0.1764244
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0685259
	speed: 0.0609s/iter; left time: 1100.3239s
	iters: 200, epoch: 33 | loss: 0.0821974
	speed: 0.0104s/iter; left time: 186.2151s
Epoch: 33 cost time: 3.3833460807800293
Epoch: 33, Steps: 267 | Train Loss: 0.0921134 Vali Loss: 0.1260537 Test Loss: 0.1763817
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1012753
	speed: 0.0578s/iter; left time: 1029.0637s
	iters: 200, epoch: 34 | loss: 0.1160359
	speed: 0.0101s/iter; left time: 177.9976s
Epoch: 34 cost time: 3.2234747409820557
Epoch: 34, Steps: 267 | Train Loss: 0.0920152 Vali Loss: 0.1260609 Test Loss: 0.1763849
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0892899
	speed: 0.0602s/iter; left time: 1055.1331s
	iters: 200, epoch: 35 | loss: 0.1509977
	speed: 0.0101s/iter; left time: 175.2404s
Epoch: 35 cost time: 3.325357437133789
Epoch: 35, Steps: 267 | Train Loss: 0.0920704 Vali Loss: 0.1260506 Test Loss: 0.1764261
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  650496.0
params:  759.0
Trainable parameters:  759
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2264820
	speed: 0.0154s/iter; left time: 408.6029s
	iters: 200, epoch: 1 | loss: 0.2247380
	speed: 0.0103s/iter; left time: 273.5320s
Epoch: 1 cost time: 3.2922511100769043
Epoch: 1, Steps: 267 | Train Loss: 0.2339210 Vali Loss: 0.1249603 Test Loss: 0.1749184
Validation loss decreased (inf --> 0.124960).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1979898
	speed: 0.0603s/iter; left time: 1587.9516s
	iters: 200, epoch: 2 | loss: 0.2242070
	speed: 0.0103s/iter; left time: 270.0227s
Epoch: 2 cost time: 3.3093554973602295
Epoch: 2, Steps: 267 | Train Loss: 0.2324575 Vali Loss: 0.1243282 Test Loss: 0.1743750
Validation loss decreased (0.124960 --> 0.124328).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2323767
	speed: 0.0601s/iter; left time: 1567.8109s
	iters: 200, epoch: 3 | loss: 0.1402985
	speed: 0.0102s/iter; left time: 264.8453s
Epoch: 3 cost time: 3.3590660095214844
Epoch: 3, Steps: 267 | Train Loss: 0.2323185 Vali Loss: 0.1241787 Test Loss: 0.1741745
Validation loss decreased (0.124328 --> 0.124179).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2218977
	speed: 0.0574s/iter; left time: 1480.6204s
	iters: 200, epoch: 4 | loss: 0.1774518
	speed: 0.0101s/iter; left time: 258.4055s
Epoch: 4 cost time: 3.2021090984344482
Epoch: 4, Steps: 267 | Train Loss: 0.2315352 Vali Loss: 0.1242148 Test Loss: 0.1738484
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2157367
	speed: 0.0583s/iter; left time: 1489.8038s
	iters: 200, epoch: 5 | loss: 0.1644586
	speed: 0.0104s/iter; left time: 265.2679s
Epoch: 5 cost time: 3.3028271198272705
Epoch: 5, Steps: 267 | Train Loss: 0.2312686 Vali Loss: 0.1240832 Test Loss: 0.1738081
Validation loss decreased (0.124179 --> 0.124083).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2361104
	speed: 0.0611s/iter; left time: 1542.5607s
	iters: 200, epoch: 6 | loss: 0.1929586
	speed: 0.0107s/iter; left time: 269.7309s
Epoch: 6 cost time: 3.3354508876800537
Epoch: 6, Steps: 267 | Train Loss: 0.2313634 Vali Loss: 0.1240583 Test Loss: 0.1738017
Validation loss decreased (0.124083 --> 0.124058).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3037834
	speed: 0.0593s/iter; left time: 1482.5687s
	iters: 200, epoch: 7 | loss: 0.2757986
	speed: 0.0104s/iter; left time: 258.5361s
Epoch: 7 cost time: 3.266644239425659
Epoch: 7, Steps: 267 | Train Loss: 0.2307022 Vali Loss: 0.1239501 Test Loss: 0.1737721
Validation loss decreased (0.124058 --> 0.123950).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1902507
	speed: 0.0589s/iter; left time: 1457.8693s
	iters: 200, epoch: 8 | loss: 0.2951932
	speed: 0.0101s/iter; left time: 248.6454s
Epoch: 8 cost time: 3.263496160507202
Epoch: 8, Steps: 267 | Train Loss: 0.2305357 Vali Loss: 0.1239134 Test Loss: 0.1735917
Validation loss decreased (0.123950 --> 0.123913).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2030642
	speed: 0.0594s/iter; left time: 1453.3306s
	iters: 200, epoch: 9 | loss: 0.3391269
	speed: 0.0100s/iter; left time: 244.7138s
Epoch: 9 cost time: 3.2293856143951416
Epoch: 9, Steps: 267 | Train Loss: 0.2309418 Vali Loss: 0.1238061 Test Loss: 0.1735336
Validation loss decreased (0.123913 --> 0.123806).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2098421
	speed: 0.0617s/iter; left time: 1492.0515s
	iters: 200, epoch: 10 | loss: 0.2482785
	speed: 0.0110s/iter; left time: 263.9128s
Epoch: 10 cost time: 3.506093978881836
Epoch: 10, Steps: 267 | Train Loss: 0.2303457 Vali Loss: 0.1240320 Test Loss: 0.1734958
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1918058
	speed: 0.0592s/iter; left time: 1416.3820s
	iters: 200, epoch: 11 | loss: 0.1758962
	speed: 0.0101s/iter; left time: 241.0430s
Epoch: 11 cost time: 3.277618169784546
Epoch: 11, Steps: 267 | Train Loss: 0.2305727 Vali Loss: 0.1239298 Test Loss: 0.1735141
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1792112
	speed: 0.0583s/iter; left time: 1379.9878s
	iters: 200, epoch: 12 | loss: 0.1778849
	speed: 0.0103s/iter; left time: 243.4118s
Epoch: 12 cost time: 3.235438346862793
Epoch: 12, Steps: 267 | Train Loss: 0.2308152 Vali Loss: 0.1238392 Test Loss: 0.1736370
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2603340
	speed: 0.0583s/iter; left time: 1364.0993s
	iters: 200, epoch: 13 | loss: 0.2482392
	speed: 0.0100s/iter; left time: 232.8586s
Epoch: 13 cost time: 3.2595038414001465
Epoch: 13, Steps: 267 | Train Loss: 0.2306253 Vali Loss: 0.1239371 Test Loss: 0.1735651
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3212001
	speed: 0.0599s/iter; left time: 1384.6869s
	iters: 200, epoch: 14 | loss: 0.2230220
	speed: 0.0104s/iter; left time: 239.9903s
Epoch: 14 cost time: 3.337002754211426
Epoch: 14, Steps: 267 | Train Loss: 0.2307883 Vali Loss: 0.1238606 Test Loss: 0.1734076
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1551139
	speed: 0.0589s/iter; left time: 1346.7297s
	iters: 200, epoch: 15 | loss: 0.2803810
	speed: 0.0102s/iter; left time: 232.7369s
Epoch: 15 cost time: 3.2460947036743164
Epoch: 15, Steps: 267 | Train Loss: 0.2301425 Vali Loss: 0.1238923 Test Loss: 0.1734643
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3188673
	speed: 0.0598s/iter; left time: 1350.5874s
	iters: 200, epoch: 16 | loss: 0.2797007
	speed: 0.0101s/iter; left time: 226.6613s
Epoch: 16 cost time: 3.310983657836914
Epoch: 16, Steps: 267 | Train Loss: 0.2305647 Vali Loss: 0.1239247 Test Loss: 0.1736339
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2208226
	speed: 0.0592s/iter; left time: 1322.3187s
	iters: 200, epoch: 17 | loss: 0.1782334
	speed: 0.0105s/iter; left time: 232.6248s
Epoch: 17 cost time: 3.3004977703094482
Epoch: 17, Steps: 267 | Train Loss: 0.2302784 Vali Loss: 0.1239269 Test Loss: 0.1736217
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2419601
	speed: 0.0619s/iter; left time: 1366.3303s
	iters: 200, epoch: 18 | loss: 0.2532882
	speed: 0.0110s/iter; left time: 241.7871s
Epoch: 18 cost time: 3.7373147010803223
Epoch: 18, Steps: 267 | Train Loss: 0.2303273 Vali Loss: 0.1239793 Test Loss: 0.1735556
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2107196
	speed: 0.0605s/iter; left time: 1318.7466s
	iters: 200, epoch: 19 | loss: 0.3047752
	speed: 0.0140s/iter; left time: 303.9255s
Epoch: 19 cost time: 3.6566226482391357
Epoch: 19, Steps: 267 | Train Loss: 0.2304025 Vali Loss: 0.1240065 Test Loss: 0.1735187
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1943779
	speed: 0.0600s/iter; left time: 1292.1151s
	iters: 200, epoch: 20 | loss: 0.3160664
	speed: 0.0106s/iter; left time: 227.8478s
Epoch: 20 cost time: 3.3452446460723877
Epoch: 20, Steps: 267 | Train Loss: 0.2303030 Vali Loss: 0.1239714 Test Loss: 0.1734452
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2745122
	speed: 0.0607s/iter; left time: 1289.5498s
	iters: 200, epoch: 21 | loss: 0.1963212
	speed: 0.0107s/iter; left time: 225.4717s
Epoch: 21 cost time: 3.317392110824585
Epoch: 21, Steps: 267 | Train Loss: 0.2302354 Vali Loss: 0.1239232 Test Loss: 0.1734067
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2345371
	speed: 0.0597s/iter; left time: 1252.8801s
	iters: 200, epoch: 22 | loss: 0.2076227
	speed: 0.0105s/iter; left time: 219.7260s
Epoch: 22 cost time: 3.401508331298828
Epoch: 22, Steps: 267 | Train Loss: 0.2302663 Vali Loss: 0.1239256 Test Loss: 0.1734216
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1820700
	speed: 0.0601s/iter; left time: 1245.9962s
	iters: 200, epoch: 23 | loss: 0.2176698
	speed: 0.0102s/iter; left time: 211.4073s
Epoch: 23 cost time: 3.3089447021484375
Epoch: 23, Steps: 267 | Train Loss: 0.2304118 Vali Loss: 0.1239747 Test Loss: 0.1734561
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3094563
	speed: 0.0621s/iter; left time: 1270.8201s
	iters: 200, epoch: 24 | loss: 0.2384519
	speed: 0.0103s/iter; left time: 209.4972s
Epoch: 24 cost time: 3.377124786376953
Epoch: 24, Steps: 267 | Train Loss: 0.2303630 Vali Loss: 0.1238939 Test Loss: 0.1734691
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1651986
	speed: 0.0589s/iter; left time: 1190.2188s
	iters: 200, epoch: 25 | loss: 0.3021119
	speed: 0.0103s/iter; left time: 207.7724s
Epoch: 25 cost time: 3.3413031101226807
Epoch: 25, Steps: 267 | Train Loss: 0.2301597 Vali Loss: 0.1238724 Test Loss: 0.1734409
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1809088
	speed: 0.0598s/iter; left time: 1192.2012s
	iters: 200, epoch: 26 | loss: 0.2813054
	speed: 0.0101s/iter; left time: 199.3911s
Epoch: 26 cost time: 3.327484130859375
Epoch: 26, Steps: 267 | Train Loss: 0.2300067 Vali Loss: 0.1239552 Test Loss: 0.1734497
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1887361
	speed: 0.0598s/iter; left time: 1175.2406s
	iters: 200, epoch: 27 | loss: 0.3169472
	speed: 0.0104s/iter; left time: 202.5119s
Epoch: 27 cost time: 3.3295438289642334
Epoch: 27, Steps: 267 | Train Loss: 0.2304067 Vali Loss: 0.1239734 Test Loss: 0.1733949
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2223153
	speed: 0.0603s/iter; left time: 1170.0949s
	iters: 200, epoch: 28 | loss: 0.3311546
	speed: 0.0106s/iter; left time: 203.6185s
Epoch: 28 cost time: 3.3678035736083984
Epoch: 28, Steps: 267 | Train Loss: 0.2303424 Vali Loss: 0.1238475 Test Loss: 0.1734872
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1839946
	speed: 0.0595s/iter; left time: 1137.6354s
	iters: 200, epoch: 29 | loss: 0.2906806
	speed: 0.0102s/iter; left time: 194.3208s
Epoch: 29 cost time: 3.2528066635131836
Epoch: 29, Steps: 267 | Train Loss: 0.2300902 Vali Loss: 0.1238831 Test Loss: 0.1734245
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1742769032716751, mae:0.25998958945274353, rse:0.3384668231010437, corr:[0.56914306 0.5715933  0.57057405 0.567851   0.565205   0.5635639
 0.5630035  0.5629268  0.5627427  0.56217325 0.5612414  0.5602392
 0.559447   0.5589484  0.5587201  0.558507   0.5580881  0.55735016
 0.556384   0.5553847  0.55458134 0.5540582  0.55375147 0.5535229
 0.5531795  0.55260503 0.5518713  0.5510821  0.5503592  0.5497946
 0.54942167 0.5492307  0.54906726 0.5487805  0.5482714  0.5475883
 0.54678005 0.5460079  0.54532444 0.54475087 0.5443123  0.5439653
 0.543614   0.54317516 0.5426025  0.5419563  0.5412707  0.54057884
 0.5398581  0.539093   0.53829205 0.5375434  0.5368414  0.5361657
 0.535574   0.5351426  0.5347915  0.5345151  0.5342214  0.53390104
 0.5335035  0.5331436  0.5328757  0.53265023 0.53247744 0.5323954
 0.5323215  0.53221405 0.5320612  0.5319079  0.53174305 0.53158474
 0.53149545 0.53138524 0.53130776 0.5311573  0.5308953  0.5304659
 0.52992666 0.5293607  0.52881086 0.5283126  0.527897   0.52752435
 0.52712923 0.5266845  0.526128   0.5256098  0.5252053  0.52493125
 0.524856   0.52492326 0.5249384  0.5246631  0.5237839  0.52177644]
