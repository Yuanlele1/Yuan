Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3885040
	speed: 0.0182s/iter; left time: 485.2073s
	iters: 200, epoch: 1 | loss: 0.2123729
	speed: 0.0127s/iter; left time: 337.0886s
Epoch: 1 cost time: 3.9523401260375977
Epoch: 1, Steps: 267 | Train Loss: 0.3092068 Vali Loss: 0.2120654 Test Loss: 0.2931290
Validation loss decreased (inf --> 0.212065).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2365109
	speed: 0.0654s/iter; left time: 1721.3146s
	iters: 200, epoch: 2 | loss: 0.2057880
	speed: 0.0115s/iter; left time: 302.7947s
Epoch: 2 cost time: 3.7635467052459717
Epoch: 2, Steps: 267 | Train Loss: 0.2301502 Vali Loss: 0.1916552 Test Loss: 0.2679998
Validation loss decreased (0.212065 --> 0.191655).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2357736
	speed: 0.0822s/iter; left time: 2142.3912s
	iters: 200, epoch: 3 | loss: 0.2060818
	speed: 0.0269s/iter; left time: 699.4875s
Epoch: 3 cost time: 7.075172185897827
Epoch: 3, Steps: 267 | Train Loss: 0.2054573 Vali Loss: 0.1825530 Test Loss: 0.2568904
Validation loss decreased (0.191655 --> 0.182553).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1939644
	speed: 0.0637s/iter; left time: 1644.5545s
	iters: 200, epoch: 4 | loss: 0.2059751
	speed: 0.0113s/iter; left time: 291.1730s
Epoch: 4 cost time: 3.6849796772003174
Epoch: 4, Steps: 267 | Train Loss: 0.1939623 Vali Loss: 0.1770958 Test Loss: 0.2499906
Validation loss decreased (0.182553 --> 0.177096).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1955592
	speed: 0.0640s/iter; left time: 1632.8934s
	iters: 200, epoch: 5 | loss: 0.1831356
	speed: 0.0110s/iter; left time: 278.9222s
Epoch: 5 cost time: 3.636342763900757
Epoch: 5, Steps: 267 | Train Loss: 0.1874434 Vali Loss: 0.1734488 Test Loss: 0.2453553
Validation loss decreased (0.177096 --> 0.173449).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2530801
	speed: 0.0634s/iter; left time: 1600.7248s
	iters: 200, epoch: 6 | loss: 0.1443343
	speed: 0.0106s/iter; left time: 266.6082s
Epoch: 6 cost time: 3.5740463733673096
Epoch: 6, Steps: 267 | Train Loss: 0.1830989 Vali Loss: 0.1709624 Test Loss: 0.2420646
Validation loss decreased (0.173449 --> 0.170962).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1701581
	speed: 0.0631s/iter; left time: 1578.6590s
	iters: 200, epoch: 7 | loss: 0.1775526
	speed: 0.0124s/iter; left time: 308.2444s
Epoch: 7 cost time: 3.772761344909668
Epoch: 7, Steps: 267 | Train Loss: 0.1803473 Vali Loss: 0.1692909 Test Loss: 0.2397504
Validation loss decreased (0.170962 --> 0.169291).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1884794
	speed: 0.0655s/iter; left time: 1621.1781s
	iters: 200, epoch: 8 | loss: 0.1440854
	speed: 0.0105s/iter; left time: 258.3649s
Epoch: 8 cost time: 3.7185635566711426
Epoch: 8, Steps: 267 | Train Loss: 0.1784796 Vali Loss: 0.1681203 Test Loss: 0.2380701
Validation loss decreased (0.169291 --> 0.168120).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2240598
	speed: 0.0637s/iter; left time: 1557.7147s
	iters: 200, epoch: 9 | loss: 0.1591324
	speed: 0.0113s/iter; left time: 276.4285s
Epoch: 9 cost time: 3.5254013538360596
Epoch: 9, Steps: 267 | Train Loss: 0.1772343 Vali Loss: 0.1670268 Test Loss: 0.2367825
Validation loss decreased (0.168120 --> 0.167027).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1488699
	speed: 0.0605s/iter; left time: 1463.0882s
	iters: 200, epoch: 10 | loss: 0.1499500
	speed: 0.0105s/iter; left time: 253.6536s
Epoch: 10 cost time: 3.468233346939087
Epoch: 10, Steps: 267 | Train Loss: 0.1764885 Vali Loss: 0.1664348 Test Loss: 0.2360609
Validation loss decreased (0.167027 --> 0.166435).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1553547
	speed: 0.0651s/iter; left time: 1557.8106s
	iters: 200, epoch: 11 | loss: 0.1047740
	speed: 0.0112s/iter; left time: 267.0247s
Epoch: 11 cost time: 3.713857889175415
Epoch: 11, Steps: 267 | Train Loss: 0.1758143 Vali Loss: 0.1662312 Test Loss: 0.2355614
Validation loss decreased (0.166435 --> 0.166231).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1526143
	speed: 0.0636s/iter; left time: 1506.1583s
	iters: 200, epoch: 12 | loss: 0.1309294
	speed: 0.0107s/iter; left time: 251.7674s
Epoch: 12 cost time: 3.560596227645874
Epoch: 12, Steps: 267 | Train Loss: 0.1755912 Vali Loss: 0.1658333 Test Loss: 0.2350996
Validation loss decreased (0.166231 --> 0.165833).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1633632
	speed: 0.0616s/iter; left time: 1441.7093s
	iters: 200, epoch: 13 | loss: 0.1542832
	speed: 0.0113s/iter; left time: 263.8812s
Epoch: 13 cost time: 3.684647560119629
Epoch: 13, Steps: 267 | Train Loss: 0.1753693 Vali Loss: 0.1655694 Test Loss: 0.2348232
Validation loss decreased (0.165833 --> 0.165569).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1633668
	speed: 0.0627s/iter; left time: 1450.9557s
	iters: 200, epoch: 14 | loss: 0.1447679
	speed: 0.0108s/iter; left time: 249.5122s
Epoch: 14 cost time: 3.6468024253845215
Epoch: 14, Steps: 267 | Train Loss: 0.1752391 Vali Loss: 0.1655378 Test Loss: 0.2346559
Validation loss decreased (0.165569 --> 0.165538).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1777749
	speed: 0.0631s/iter; left time: 1442.4947s
	iters: 200, epoch: 15 | loss: 0.2379097
	speed: 0.0113s/iter; left time: 257.1209s
Epoch: 15 cost time: 3.6142873764038086
Epoch: 15, Steps: 267 | Train Loss: 0.1751408 Vali Loss: 0.1653199 Test Loss: 0.2344940
Validation loss decreased (0.165538 --> 0.165320).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3325740
	speed: 0.0645s/iter; left time: 1457.4611s
	iters: 200, epoch: 16 | loss: 0.1443417
	speed: 0.0108s/iter; left time: 243.5640s
Epoch: 16 cost time: 3.599276065826416
Epoch: 16, Steps: 267 | Train Loss: 0.1750356 Vali Loss: 0.1653831 Test Loss: 0.2343619
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1182160
	speed: 0.0629s/iter; left time: 1404.9495s
	iters: 200, epoch: 17 | loss: 0.1945417
	speed: 0.0114s/iter; left time: 253.9079s
Epoch: 17 cost time: 3.7213094234466553
Epoch: 17, Steps: 267 | Train Loss: 0.1750121 Vali Loss: 0.1653057 Test Loss: 0.2342649
Validation loss decreased (0.165320 --> 0.165306).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2004197
	speed: 0.0644s/iter; left time: 1421.8421s
	iters: 200, epoch: 18 | loss: 0.1667379
	speed: 0.0115s/iter; left time: 252.4130s
Epoch: 18 cost time: 3.775421619415283
Epoch: 18, Steps: 267 | Train Loss: 0.1749773 Vali Loss: 0.1652690 Test Loss: 0.2342078
Validation loss decreased (0.165306 --> 0.165269).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2318107
	speed: 0.0617s/iter; left time: 1344.7563s
	iters: 200, epoch: 19 | loss: 0.1251223
	speed: 0.0112s/iter; left time: 242.8723s
Epoch: 19 cost time: 3.5315399169921875
Epoch: 19, Steps: 267 | Train Loss: 0.1749594 Vali Loss: 0.1652884 Test Loss: 0.2341983
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1242138
	speed: 0.0630s/iter; left time: 1357.2578s
	iters: 200, epoch: 20 | loss: 0.2415087
	speed: 0.0109s/iter; left time: 233.0421s
Epoch: 20 cost time: 3.5443456172943115
Epoch: 20, Steps: 267 | Train Loss: 0.1749327 Vali Loss: 0.1652489 Test Loss: 0.2341056
Validation loss decreased (0.165269 --> 0.165249).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1259794
	speed: 0.0620s/iter; left time: 1318.7123s
	iters: 200, epoch: 21 | loss: 0.2529363
	speed: 0.0112s/iter; left time: 237.5444s
Epoch: 21 cost time: 3.59633207321167
Epoch: 21, Steps: 267 | Train Loss: 0.1748010 Vali Loss: 0.1653403 Test Loss: 0.2340809
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1379123
	speed: 0.0628s/iter; left time: 1317.7839s
	iters: 200, epoch: 22 | loss: 0.1563835
	speed: 0.0111s/iter; left time: 231.4059s
Epoch: 22 cost time: 3.4758570194244385
Epoch: 22, Steps: 267 | Train Loss: 0.1749167 Vali Loss: 0.1653689 Test Loss: 0.2340826
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1736005
	speed: 0.0640s/iter; left time: 1325.6176s
	iters: 200, epoch: 23 | loss: 0.1854960
	speed: 0.0111s/iter; left time: 229.7308s
Epoch: 23 cost time: 3.6369917392730713
Epoch: 23, Steps: 267 | Train Loss: 0.1749086 Vali Loss: 0.1652301 Test Loss: 0.2340726
Validation loss decreased (0.165249 --> 0.165230).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2219473
	speed: 0.0607s/iter; left time: 1242.1967s
	iters: 200, epoch: 24 | loss: 0.1933594
	speed: 0.0109s/iter; left time: 221.1518s
Epoch: 24 cost time: 3.49453067779541
Epoch: 24, Steps: 267 | Train Loss: 0.1747312 Vali Loss: 0.1652254 Test Loss: 0.2340782
Validation loss decreased (0.165230 --> 0.165225).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1434177
	speed: 0.0624s/iter; left time: 1260.3786s
	iters: 200, epoch: 25 | loss: 0.1574022
	speed: 0.0109s/iter; left time: 219.8900s
Epoch: 25 cost time: 3.545534133911133
Epoch: 25, Steps: 267 | Train Loss: 0.1748836 Vali Loss: 0.1652115 Test Loss: 0.2340343
Validation loss decreased (0.165225 --> 0.165211).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1881623
	speed: 0.0619s/iter; left time: 1233.3852s
	iters: 200, epoch: 26 | loss: 0.1477460
	speed: 0.0111s/iter; left time: 219.7445s
Epoch: 26 cost time: 3.5483245849609375
Epoch: 26, Steps: 267 | Train Loss: 0.1748172 Vali Loss: 0.1652000 Test Loss: 0.2340618
Validation loss decreased (0.165211 --> 0.165200).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2994790
	speed: 0.0810s/iter; left time: 1592.8593s
	iters: 200, epoch: 27 | loss: 0.2414472
	speed: 0.0494s/iter; left time: 966.6972s
Epoch: 27 cost time: 9.517136335372925
Epoch: 27, Steps: 267 | Train Loss: 0.1748136 Vali Loss: 0.1651120 Test Loss: 0.2340234
Validation loss decreased (0.165200 --> 0.165112).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1938917
	speed: 0.1353s/iter; left time: 2624.3207s
	iters: 200, epoch: 28 | loss: 0.1772893
	speed: 0.0536s/iter; left time: 1033.6694s
Epoch: 28 cost time: 11.051888465881348
Epoch: 28, Steps: 267 | Train Loss: 0.1747962 Vali Loss: 0.1651923 Test Loss: 0.2340090
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1120741
	speed: 0.1870s/iter; left time: 3576.4873s
	iters: 200, epoch: 29 | loss: 0.2006226
	speed: 0.0338s/iter; left time: 642.6510s
Epoch: 29 cost time: 13.834399223327637
Epoch: 29, Steps: 267 | Train Loss: 0.1748191 Vali Loss: 0.1652737 Test Loss: 0.2340030
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1468179
	speed: 0.1512s/iter; left time: 2851.8737s
	iters: 200, epoch: 30 | loss: 0.1257868
	speed: 0.0244s/iter; left time: 457.3554s
Epoch: 30 cost time: 5.870177268981934
Epoch: 30, Steps: 267 | Train Loss: 0.1747972 Vali Loss: 0.1653259 Test Loss: 0.2339691
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1423337
	speed: 0.1523s/iter; left time: 2832.2684s
	iters: 200, epoch: 31 | loss: 0.1708553
	speed: 0.0314s/iter; left time: 580.8271s
Epoch: 31 cost time: 9.727352857589722
Epoch: 31, Steps: 267 | Train Loss: 0.1748195 Vali Loss: 0.1651579 Test Loss: 0.2339970
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1606961
	speed: 0.1586s/iter; left time: 2906.1304s
	iters: 200, epoch: 32 | loss: 0.1178294
	speed: 0.0286s/iter; left time: 521.2894s
Epoch: 32 cost time: 11.832388162612915
Epoch: 32, Steps: 267 | Train Loss: 0.1748412 Vali Loss: 0.1651959 Test Loss: 0.2339668
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1795556
	speed: 0.1527s/iter; left time: 2756.8009s
	iters: 200, epoch: 33 | loss: 0.2158919
	speed: 0.0299s/iter; left time: 536.7328s
Epoch: 33 cost time: 11.938875675201416
Epoch: 33, Steps: 267 | Train Loss: 0.1748144 Vali Loss: 0.1652938 Test Loss: 0.2339985
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1755388
	speed: 0.1556s/iter; left time: 2768.1222s
	iters: 200, epoch: 34 | loss: 0.1624248
	speed: 0.0263s/iter; left time: 465.9097s
Epoch: 34 cost time: 9.606003522872925
Epoch: 34, Steps: 267 | Train Loss: 0.1747964 Vali Loss: 0.1652735 Test Loss: 0.2339905
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1380835
	speed: 0.1657s/iter; left time: 2903.9304s
	iters: 200, epoch: 35 | loss: 0.2465831
	speed: 0.0328s/iter; left time: 571.3884s
Epoch: 35 cost time: 11.855808019638062
Epoch: 35, Steps: 267 | Train Loss: 0.1748072 Vali Loss: 0.1652484 Test Loss: 0.2339930
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1202536
	speed: 0.1026s/iter; left time: 1771.1257s
	iters: 200, epoch: 36 | loss: 0.2319209
	speed: 0.0111s/iter; left time: 189.9800s
Epoch: 36 cost time: 3.6380698680877686
Epoch: 36, Steps: 267 | Train Loss: 0.1747066 Vali Loss: 0.1653332 Test Loss: 0.2339839
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1319597
	speed: 0.0639s/iter; left time: 1085.5277s
	iters: 200, epoch: 37 | loss: 0.2194254
	speed: 0.0112s/iter; left time: 189.1413s
Epoch: 37 cost time: 3.739830493927002
Epoch: 37, Steps: 267 | Train Loss: 0.1748027 Vali Loss: 0.1651810 Test Loss: 0.2339966
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1789769
	speed: 0.0637s/iter; left time: 1064.8155s
	iters: 200, epoch: 38 | loss: 0.1692671
	speed: 0.0108s/iter; left time: 179.3097s
Epoch: 38 cost time: 3.7691421508789062
Epoch: 38, Steps: 267 | Train Loss: 0.1746509 Vali Loss: 0.1652891 Test Loss: 0.2339817
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1343298
	speed: 0.0662s/iter; left time: 1089.0265s
	iters: 200, epoch: 39 | loss: 0.1413217
	speed: 0.0109s/iter; left time: 179.0648s
Epoch: 39 cost time: 3.603390693664551
Epoch: 39, Steps: 267 | Train Loss: 0.1747826 Vali Loss: 0.1652888 Test Loss: 0.2339819
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1520753
	speed: 0.0630s/iter; left time: 1020.1542s
	iters: 200, epoch: 40 | loss: 0.1879594
	speed: 0.0109s/iter; left time: 175.9139s
Epoch: 40 cost time: 3.583099603652954
Epoch: 40, Steps: 267 | Train Loss: 0.1748037 Vali Loss: 0.1652963 Test Loss: 0.2339912
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1754798
	speed: 0.0611s/iter; left time: 972.8225s
	iters: 200, epoch: 41 | loss: 0.1504330
	speed: 0.0112s/iter; left time: 177.2332s
Epoch: 41 cost time: 3.5601837635040283
Epoch: 41, Steps: 267 | Train Loss: 0.1747442 Vali Loss: 0.1652330 Test Loss: 0.2339940
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1388432
	speed: 0.0616s/iter; left time: 965.0472s
	iters: 200, epoch: 42 | loss: 0.1307490
	speed: 0.0129s/iter; left time: 199.8948s
Epoch: 42 cost time: 4.52104377746582
Epoch: 42, Steps: 267 | Train Loss: 0.1747976 Vali Loss: 0.1653184 Test Loss: 0.2339911
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2197055
	speed: 0.0708s/iter; left time: 1089.3127s
	iters: 200, epoch: 43 | loss: 0.1391381
	speed: 0.0113s/iter; left time: 173.2155s
Epoch: 43 cost time: 3.694018840789795
Epoch: 43, Steps: 267 | Train Loss: 0.1747848 Vali Loss: 0.1652660 Test Loss: 0.2339860
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2149312
	speed: 0.0640s/iter; left time: 966.9344s
	iters: 200, epoch: 44 | loss: 0.1689476
	speed: 0.0123s/iter; left time: 184.8036s
Epoch: 44 cost time: 3.8351449966430664
Epoch: 44, Steps: 267 | Train Loss: 0.1747721 Vali Loss: 0.1652970 Test Loss: 0.2339841
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2070921
	speed: 0.1391s/iter; left time: 2066.4361s
	iters: 200, epoch: 45 | loss: 0.1790566
	speed: 0.0290s/iter; left time: 428.2629s
Epoch: 45 cost time: 10.899593591690063
Epoch: 45, Steps: 267 | Train Loss: 0.1747569 Vali Loss: 0.1653062 Test Loss: 0.2339775
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1613049
	speed: 0.1674s/iter; left time: 2441.2759s
	iters: 200, epoch: 46 | loss: 0.1786288
	speed: 0.0560s/iter; left time: 811.1649s
Epoch: 46 cost time: 11.73094391822815
Epoch: 46, Steps: 267 | Train Loss: 0.1747609 Vali Loss: 0.1651571 Test Loss: 0.2339897
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1434578
	speed: 0.1843s/iter; left time: 2638.4595s
	iters: 200, epoch: 47 | loss: 0.1211870
	speed: 0.0287s/iter; left time: 408.2481s
Epoch: 47 cost time: 12.017339706420898
Epoch: 47, Steps: 267 | Train Loss: 0.1747445 Vali Loss: 0.1651829 Test Loss: 0.2339823
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2988565
	speed: 0.0570s/iter; left time: 1516.0167s
	iters: 200, epoch: 1 | loss: 0.4023334
	speed: 0.0366s/iter; left time: 969.1015s
Epoch: 1 cost time: 14.109549045562744
Epoch: 1, Steps: 267 | Train Loss: 0.3230372 Vali Loss: 0.1646253 Test Loss: 0.2332750
Validation loss decreased (inf --> 0.164625).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3199908
	speed: 0.1805s/iter; left time: 4752.5728s
	iters: 200, epoch: 2 | loss: 0.3465173
	speed: 0.0405s/iter; left time: 1061.5343s
Epoch: 2 cost time: 10.007179021835327
Epoch: 2, Steps: 267 | Train Loss: 0.3223444 Vali Loss: 0.1646315 Test Loss: 0.2331883
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2281466
	speed: 0.1670s/iter; left time: 4354.3984s
	iters: 200, epoch: 3 | loss: 0.3366596
	speed: 0.0376s/iter; left time: 976.4700s
Epoch: 3 cost time: 11.269567012786865
Epoch: 3, Steps: 267 | Train Loss: 0.3220197 Vali Loss: 0.1644900 Test Loss: 0.2330173
Validation loss decreased (0.164625 --> 0.164490).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3388979
	speed: 0.1822s/iter; left time: 4701.5547s
	iters: 200, epoch: 4 | loss: 0.2855031
	speed: 0.0377s/iter; left time: 968.8624s
Epoch: 4 cost time: 13.536666631698608
Epoch: 4, Steps: 267 | Train Loss: 0.3217464 Vali Loss: 0.1645911 Test Loss: 0.2328131
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2899499
	speed: 0.1602s/iter; left time: 4089.1866s
	iters: 200, epoch: 5 | loss: 0.2925472
	speed: 0.0286s/iter; left time: 726.6245s
Epoch: 5 cost time: 10.047924518585205
Epoch: 5, Steps: 267 | Train Loss: 0.3216246 Vali Loss: 0.1646640 Test Loss: 0.2328403
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3217866
	speed: 0.1068s/iter; left time: 2697.4294s
	iters: 200, epoch: 6 | loss: 0.3362349
	speed: 0.0119s/iter; left time: 300.0983s
Epoch: 6 cost time: 3.8864586353302
Epoch: 6, Steps: 267 | Train Loss: 0.3215016 Vali Loss: 0.1645384 Test Loss: 0.2327447
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3368247
	speed: 0.0648s/iter; left time: 1619.4230s
	iters: 200, epoch: 7 | loss: 0.5048879
	speed: 0.0115s/iter; left time: 287.0354s
Epoch: 7 cost time: 3.7335572242736816
Epoch: 7, Steps: 267 | Train Loss: 0.3214559 Vali Loss: 0.1643904 Test Loss: 0.2326984
Validation loss decreased (0.164490 --> 0.164390).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4801838
	speed: 0.0852s/iter; left time: 2107.8167s
	iters: 200, epoch: 8 | loss: 0.3055345
	speed: 0.0121s/iter; left time: 297.0964s
Epoch: 8 cost time: 3.9843177795410156
Epoch: 8, Steps: 267 | Train Loss: 0.3213333 Vali Loss: 0.1644772 Test Loss: 0.2327590
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2388030
	speed: 0.0698s/iter; left time: 1708.4260s
	iters: 200, epoch: 9 | loss: 0.3511654
	speed: 0.0114s/iter; left time: 277.3319s
Epoch: 9 cost time: 3.7621428966522217
Epoch: 9, Steps: 267 | Train Loss: 0.3212781 Vali Loss: 0.1643995 Test Loss: 0.2326736
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3014086
	speed: 0.0634s/iter; left time: 1534.4420s
	iters: 200, epoch: 10 | loss: 0.4153573
	speed: 0.0135s/iter; left time: 326.0357s
Epoch: 10 cost time: 3.948683023452759
Epoch: 10, Steps: 267 | Train Loss: 0.3212069 Vali Loss: 0.1643619 Test Loss: 0.2326143
Validation loss decreased (0.164390 --> 0.164362).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3720932
	speed: 0.0692s/iter; left time: 1656.5342s
	iters: 200, epoch: 11 | loss: 0.3916875
	speed: 0.0121s/iter; left time: 287.5278s
Epoch: 11 cost time: 4.0276970863342285
Epoch: 11, Steps: 267 | Train Loss: 0.3211509 Vali Loss: 0.1645410 Test Loss: 0.2326275
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2949286
	speed: 0.0670s/iter; left time: 1586.0398s
	iters: 200, epoch: 12 | loss: 0.2234925
	speed: 0.0115s/iter; left time: 271.7783s
Epoch: 12 cost time: 3.7319297790527344
Epoch: 12, Steps: 267 | Train Loss: 0.3211570 Vali Loss: 0.1643234 Test Loss: 0.2326861
Validation loss decreased (0.164362 --> 0.164323).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2614149
	speed: 0.0654s/iter; left time: 1531.0834s
	iters: 200, epoch: 13 | loss: 0.2401934
	speed: 0.0114s/iter; left time: 265.7087s
Epoch: 13 cost time: 3.8106727600097656
Epoch: 13, Steps: 267 | Train Loss: 0.3211239 Vali Loss: 0.1643393 Test Loss: 0.2326287
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.4731785
	speed: 0.0644s/iter; left time: 1489.5514s
	iters: 200, epoch: 14 | loss: 0.2647909
	speed: 0.0120s/iter; left time: 275.6519s
Epoch: 14 cost time: 3.8143081665039062
Epoch: 14, Steps: 267 | Train Loss: 0.3210318 Vali Loss: 0.1646204 Test Loss: 0.2327004
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.4689241
	speed: 0.0701s/iter; left time: 1601.8045s
	iters: 200, epoch: 15 | loss: 0.2375979
	speed: 0.0134s/iter; left time: 304.2486s
Epoch: 15 cost time: 4.136214733123779
Epoch: 15, Steps: 267 | Train Loss: 0.3209813 Vali Loss: 0.1642654 Test Loss: 0.2326435
Validation loss decreased (0.164323 --> 0.164265).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2454827
	speed: 0.0650s/iter; left time: 1468.8084s
	iters: 200, epoch: 16 | loss: 0.2705857
	speed: 0.0114s/iter; left time: 256.1190s
Epoch: 16 cost time: 3.6291840076446533
Epoch: 16, Steps: 267 | Train Loss: 0.3210193 Vali Loss: 0.1644958 Test Loss: 0.2325561
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4081115
	speed: 0.0656s/iter; left time: 1463.9087s
	iters: 200, epoch: 17 | loss: 0.3168623
	speed: 0.0119s/iter; left time: 265.0323s
Epoch: 17 cost time: 3.758737564086914
Epoch: 17, Steps: 267 | Train Loss: 0.3209887 Vali Loss: 0.1645788 Test Loss: 0.2326549
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3196203
	speed: 0.0670s/iter; left time: 1478.2689s
	iters: 200, epoch: 18 | loss: 0.3129531
	speed: 0.0124s/iter; left time: 272.7206s
Epoch: 18 cost time: 4.033397197723389
Epoch: 18, Steps: 267 | Train Loss: 0.3208067 Vali Loss: 0.1645100 Test Loss: 0.2326434
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4229478
	speed: 0.0649s/iter; left time: 1413.7105s
	iters: 200, epoch: 19 | loss: 0.4099421
	speed: 0.0113s/iter; left time: 244.3193s
Epoch: 19 cost time: 3.7405383586883545
Epoch: 19, Steps: 267 | Train Loss: 0.3209332 Vali Loss: 0.1645197 Test Loss: 0.2326211
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.4452471
	speed: 0.1314s/iter; left time: 2828.8554s
	iters: 200, epoch: 20 | loss: 0.4285414
	speed: 0.0338s/iter; left time: 723.9432s
Epoch: 20 cost time: 13.59483528137207
Epoch: 20, Steps: 267 | Train Loss: 0.3208984 Vali Loss: 0.1645180 Test Loss: 0.2326569
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4876998
	speed: 0.1859s/iter; left time: 3953.0680s
	iters: 200, epoch: 21 | loss: 0.2194414
	speed: 0.0568s/iter; left time: 1201.1690s
Epoch: 21 cost time: 12.035751581192017
Epoch: 21, Steps: 267 | Train Loss: 0.3209162 Vali Loss: 0.1646202 Test Loss: 0.2326750
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3915864
	speed: 0.1853s/iter; left time: 3890.0048s
	iters: 200, epoch: 22 | loss: 0.4035560
	speed: 0.0351s/iter; left time: 733.9012s
Epoch: 22 cost time: 14.045336484909058
Epoch: 22, Steps: 267 | Train Loss: 0.3208310 Vali Loss: 0.1645271 Test Loss: 0.2326156
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2668805
	speed: 0.1817s/iter; left time: 3766.5983s
	iters: 200, epoch: 23 | loss: 0.3585610
	speed: 0.0474s/iter; left time: 977.7388s
Epoch: 23 cost time: 12.164180755615234
Epoch: 23, Steps: 267 | Train Loss: 0.3209216 Vali Loss: 0.1645197 Test Loss: 0.2326395
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3831905
	speed: 0.1790s/iter; left time: 3661.5554s
	iters: 200, epoch: 24 | loss: 0.4566896
	speed: 0.0492s/iter; left time: 1001.6141s
Epoch: 24 cost time: 12.051435947418213
Epoch: 24, Steps: 267 | Train Loss: 0.3208407 Vali Loss: 0.1645797 Test Loss: 0.2325989
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3398626
	speed: 0.1638s/iter; left time: 3308.0632s
	iters: 200, epoch: 25 | loss: 0.3679700
	speed: 0.0318s/iter; left time: 638.6333s
Epoch: 25 cost time: 12.404771089553833
Epoch: 25, Steps: 267 | Train Loss: 0.3209124 Vali Loss: 0.1644771 Test Loss: 0.2326194
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1614646
	speed: 0.1803s/iter; left time: 3593.2034s
	iters: 200, epoch: 26 | loss: 0.4950350
	speed: 0.0443s/iter; left time: 878.7268s
Epoch: 26 cost time: 11.633548498153687
Epoch: 26, Steps: 267 | Train Loss: 0.3208480 Vali Loss: 0.1645393 Test Loss: 0.2326285
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.4847683
	speed: 0.1737s/iter; left time: 3414.2622s
	iters: 200, epoch: 27 | loss: 0.3055110
	speed: 0.0330s/iter; left time: 645.9356s
Epoch: 27 cost time: 9.54213285446167
Epoch: 27, Steps: 267 | Train Loss: 0.3208576 Vali Loss: 0.1643397 Test Loss: 0.2326070
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2621611
	speed: 0.0696s/iter; left time: 1348.7552s
	iters: 200, epoch: 28 | loss: 0.2899652
	speed: 0.0116s/iter; left time: 222.9225s
Epoch: 28 cost time: 3.8769378662109375
Epoch: 28, Steps: 267 | Train Loss: 0.3208349 Vali Loss: 0.1645374 Test Loss: 0.2326019
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3289423
	speed: 0.0676s/iter; left time: 1293.6869s
	iters: 200, epoch: 29 | loss: 0.2245733
	speed: 0.0141s/iter; left time: 268.9005s
Epoch: 29 cost time: 4.229623079299927
Epoch: 29, Steps: 267 | Train Loss: 0.3208323 Vali Loss: 0.1644631 Test Loss: 0.2325820
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2397573
	speed: 0.0686s/iter; left time: 1293.4549s
	iters: 200, epoch: 30 | loss: 0.3098210
	speed: 0.0132s/iter; left time: 248.2038s
Epoch: 30 cost time: 4.50935173034668
Epoch: 30, Steps: 267 | Train Loss: 0.3208009 Vali Loss: 0.1645997 Test Loss: 0.2325815
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2096726
	speed: 0.0715s/iter; left time: 1330.1616s
	iters: 200, epoch: 31 | loss: 0.1875774
	speed: 0.0125s/iter; left time: 230.3453s
Epoch: 31 cost time: 3.9983417987823486
Epoch: 31, Steps: 267 | Train Loss: 0.3208242 Vali Loss: 0.1646316 Test Loss: 0.2326102
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2379988
	speed: 0.0632s/iter; left time: 1157.1863s
	iters: 200, epoch: 32 | loss: 0.2333827
	speed: 0.0118s/iter; left time: 215.5775s
Epoch: 32 cost time: 3.9744515419006348
Epoch: 32, Steps: 267 | Train Loss: 0.3206503 Vali Loss: 0.1644749 Test Loss: 0.2326078
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2246631
	speed: 0.0674s/iter; left time: 1216.4217s
	iters: 200, epoch: 33 | loss: 0.5045446
	speed: 0.0125s/iter; left time: 225.0092s
Epoch: 33 cost time: 4.587564468383789
Epoch: 33, Steps: 267 | Train Loss: 0.3207465 Vali Loss: 0.1644345 Test Loss: 0.2326265
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2922227
	speed: 0.0738s/iter; left time: 1313.3056s
	iters: 200, epoch: 34 | loss: 0.2106672
	speed: 0.0126s/iter; left time: 222.6885s
Epoch: 34 cost time: 4.194846153259277
Epoch: 34, Steps: 267 | Train Loss: 0.3207628 Vali Loss: 0.1644989 Test Loss: 0.2326230
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2461590
	speed: 0.0704s/iter; left time: 1233.9803s
	iters: 200, epoch: 35 | loss: 0.6396021
	speed: 0.0147s/iter; left time: 255.8331s
Epoch: 35 cost time: 4.412446737289429
Epoch: 35, Steps: 267 | Train Loss: 0.3204692 Vali Loss: 0.1645430 Test Loss: 0.2326027
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2334282249212265, mae:0.2972443699836731, rse:0.39108556509017944, corr:[0.5658975  0.5676052  0.5660907  0.5631537  0.56053865 0.55901873
 0.5585462  0.5584514  0.55814946 0.5574466  0.5564211  0.5554071
 0.554671   0.55423564 0.55404437 0.5538215  0.5533439  0.5525324
 0.55150265 0.550462   0.5496406  0.5491232  0.5488293  0.54862255
 0.54832786 0.5478203  0.54715645 0.5464239  0.5457202  0.54510444
 0.5446403  0.54435384 0.544106   0.5437893  0.5433103  0.5427128
 0.541998   0.54127616 0.54059833 0.53999364 0.53950864 0.539126
 0.538786   0.5384047  0.53790987 0.53732824 0.5366667  0.53593963
 0.5351429  0.53429574 0.5334384  0.532678   0.532013   0.531402
 0.53086483 0.53045595 0.53009564 0.52979726 0.52951485 0.52926016
 0.52897936 0.52875644 0.5285998  0.52843785 0.5282742  0.52814
 0.5279782  0.5278037  0.52763313 0.5275098  0.52739066 0.5272732
 0.5271778  0.5270374  0.52689976 0.5267046  0.526449   0.5260894
 0.52567774 0.52524847 0.5248276  0.5244075  0.5240231  0.52364296
 0.523229   0.5227996  0.52231264 0.52188706 0.5215574  0.52130926
 0.52112097 0.52090704 0.52048594 0.519747   0.51861197 0.5170822
 0.5152781  0.51353306 0.5119788  0.5105859  0.5092881  0.5080219
 0.50675446 0.50549585 0.5042162  0.5029831  0.5018593  0.5008761
 0.49993291 0.49879217 0.4975998  0.49636614 0.49523592 0.4942495
 0.4933392  0.4924967  0.49163777 0.4906736  0.4896129  0.48842648
 0.48724183 0.48619258 0.48536944 0.4846941  0.4840319  0.4832464
 0.48226267 0.48114422 0.48001882 0.47895762 0.4780649  0.47729918
 0.47664896 0.47597632 0.47536814 0.47486702 0.4744232  0.4740989
 0.47379768 0.47341746 0.47289333 0.47221422 0.47143984 0.47056526
 0.46962622 0.4686895  0.4677541  0.46691242 0.4662456  0.4656321
 0.46507105 0.4646577  0.4642916  0.46392646 0.46349394 0.46296236
 0.46233585 0.46169555 0.46098518 0.4603747  0.45993862 0.45971066
 0.45971557 0.45974982 0.45986927 0.459945   0.45993522 0.45991325
 0.459924   0.4600474  0.46025482 0.46047756 0.46068498 0.46068573
 0.46055877 0.46033457 0.46018398 0.46017283 0.4602682  0.46042812
 0.46042854 0.46014318 0.4597592  0.45941475 0.45935297 0.4595499
 0.45995975 0.4604741  0.46080375 0.46062905 0.45953277 0.45727715]
