Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=42, out_features=47, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1768704.0
params:  2021.0
Trainable parameters:  2021
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2568638
	speed: 0.0548s/iter; left time: 1435.7604s
	iters: 200, epoch: 1 | loss: 0.2136068
	speed: 0.0523s/iter; left time: 1366.2820s
Epoch: 1 cost time: 14.086545705795288
Epoch: 1, Steps: 263 | Train Loss: 0.2571434 Vali Loss: 0.1750374 Test Loss: 0.2293289
Validation loss decreased (inf --> 0.175037).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1528775
	speed: 0.2188s/iter; left time: 5674.9239s
	iters: 200, epoch: 2 | loss: 0.1341188
	speed: 0.0523s/iter; left time: 1350.0733s
Epoch: 2 cost time: 14.181015968322754
Epoch: 2, Steps: 263 | Train Loss: 0.1480576 Vali Loss: 0.1569746 Test Loss: 0.2054164
Validation loss decreased (0.175037 --> 0.156975).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1022082
	speed: 0.2162s/iter; left time: 5551.7300s
	iters: 200, epoch: 3 | loss: 0.1067476
	speed: 0.0492s/iter; left time: 1258.4120s
Epoch: 3 cost time: 13.718914985656738
Epoch: 3, Steps: 263 | Train Loss: 0.1087791 Vali Loss: 0.1494054 Test Loss: 0.1966582
Validation loss decreased (0.156975 --> 0.149405).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0997431
	speed: 0.2195s/iter; left time: 5578.5896s
	iters: 200, epoch: 4 | loss: 0.0838859
	speed: 0.0542s/iter; left time: 1371.8819s
Epoch: 4 cost time: 14.30488920211792
Epoch: 4, Steps: 263 | Train Loss: 0.0877377 Vali Loss: 0.1439637 Test Loss: 0.1908788
Validation loss decreased (0.149405 --> 0.143964).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0683394
	speed: 0.2235s/iter; left time: 5620.2061s
	iters: 200, epoch: 5 | loss: 0.0637714
	speed: 0.0511s/iter; left time: 1280.1873s
Epoch: 5 cost time: 14.136512041091919
Epoch: 5, Steps: 263 | Train Loss: 0.0747862 Vali Loss: 0.1385596 Test Loss: 0.1856380
Validation loss decreased (0.143964 --> 0.138560).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0547557
	speed: 0.2215s/iter; left time: 5512.7739s
	iters: 200, epoch: 6 | loss: 0.0649471
	speed: 0.0492s/iter; left time: 1220.2181s
Epoch: 6 cost time: 13.806806564331055
Epoch: 6, Steps: 263 | Train Loss: 0.0664369 Vali Loss: 0.1345000 Test Loss: 0.1819049
Validation loss decreased (0.138560 --> 0.134500).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0574661
	speed: 0.2155s/iter; left time: 5305.8457s
	iters: 200, epoch: 7 | loss: 0.0636135
	speed: 0.0546s/iter; left time: 1338.5072s
Epoch: 7 cost time: 14.447110891342163
Epoch: 7, Steps: 263 | Train Loss: 0.0609134 Vali Loss: 0.1314973 Test Loss: 0.1792633
Validation loss decreased (0.134500 --> 0.131497).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0477604
	speed: 0.2149s/iter; left time: 5235.3774s
	iters: 200, epoch: 8 | loss: 0.0506512
	speed: 0.0501s/iter; left time: 1216.6374s
Epoch: 8 cost time: 13.640291452407837
Epoch: 8, Steps: 263 | Train Loss: 0.0574460 Vali Loss: 0.1294284 Test Loss: 0.1774947
Validation loss decreased (0.131497 --> 0.129428).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0537458
	speed: 0.2299s/iter; left time: 5539.6718s
	iters: 200, epoch: 9 | loss: 0.0551658
	speed: 0.0482s/iter; left time: 1157.7360s
Epoch: 9 cost time: 13.38351583480835
Epoch: 9, Steps: 263 | Train Loss: 0.0551635 Vali Loss: 0.1279123 Test Loss: 0.1764341
Validation loss decreased (0.129428 --> 0.127912).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0549890
	speed: 0.2217s/iter; left time: 5284.8306s
	iters: 200, epoch: 10 | loss: 0.0500143
	speed: 0.0501s/iter; left time: 1188.8826s
Epoch: 10 cost time: 13.705007791519165
Epoch: 10, Steps: 263 | Train Loss: 0.0536700 Vali Loss: 0.1265656 Test Loss: 0.1752892
Validation loss decreased (0.127912 --> 0.126566).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0695184
	speed: 0.2252s/iter; left time: 5309.0550s
	iters: 200, epoch: 11 | loss: 0.0468907
	speed: 0.0500s/iter; left time: 1174.5450s
Epoch: 11 cost time: 13.836371898651123
Epoch: 11, Steps: 263 | Train Loss: 0.0527269 Vali Loss: 0.1258607 Test Loss: 0.1750937
Validation loss decreased (0.126566 --> 0.125861).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0440322
	speed: 0.2257s/iter; left time: 5261.0042s
	iters: 200, epoch: 12 | loss: 0.0539187
	speed: 0.0490s/iter; left time: 1137.8235s
Epoch: 12 cost time: 13.49880838394165
Epoch: 12, Steps: 263 | Train Loss: 0.0521209 Vali Loss: 0.1246600 Test Loss: 0.1740308
Validation loss decreased (0.125861 --> 0.124660).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0514568
	speed: 0.2259s/iter; left time: 5205.6646s
	iters: 200, epoch: 13 | loss: 0.0490873
	speed: 0.0476s/iter; left time: 1092.1765s
Epoch: 13 cost time: 13.839945793151855
Epoch: 13, Steps: 263 | Train Loss: 0.0517521 Vali Loss: 0.1245512 Test Loss: 0.1741339
Validation loss decreased (0.124660 --> 0.124551).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0495863
	speed: 0.2254s/iter; left time: 5134.4599s
	iters: 200, epoch: 14 | loss: 0.0488261
	speed: 0.0511s/iter; left time: 1159.5941s
Epoch: 14 cost time: 13.776666641235352
Epoch: 14, Steps: 263 | Train Loss: 0.0515066 Vali Loss: 0.1238799 Test Loss: 0.1734594
Validation loss decreased (0.124551 --> 0.123880).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0472195
	speed: 0.2201s/iter; left time: 4955.7527s
	iters: 200, epoch: 15 | loss: 0.0422953
	speed: 0.0484s/iter; left time: 1085.6677s
Epoch: 15 cost time: 13.527039051055908
Epoch: 15, Steps: 263 | Train Loss: 0.0513518 Vali Loss: 0.1237007 Test Loss: 0.1734776
Validation loss decreased (0.123880 --> 0.123701).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0544978
	speed: 0.1466s/iter; left time: 3262.8568s
	iters: 200, epoch: 16 | loss: 0.0467568
	speed: 0.0158s/iter; left time: 350.9615s
Epoch: 16 cost time: 4.552794456481934
Epoch: 16, Steps: 263 | Train Loss: 0.0512512 Vali Loss: 0.1237606 Test Loss: 0.1735614
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0490931
	speed: 0.0619s/iter; left time: 1361.5251s
	iters: 200, epoch: 17 | loss: 0.0538581
	speed: 0.0147s/iter; left time: 322.1887s
Epoch: 17 cost time: 4.368758201599121
Epoch: 17, Steps: 263 | Train Loss: 0.0511485 Vali Loss: 0.1233885 Test Loss: 0.1732311
Validation loss decreased (0.123701 --> 0.123389).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0412652
	speed: 0.1079s/iter; left time: 2344.2616s
	iters: 200, epoch: 18 | loss: 0.0475467
	speed: 0.0479s/iter; left time: 1036.8247s
Epoch: 18 cost time: 12.35935640335083
Epoch: 18, Steps: 263 | Train Loss: 0.0511266 Vali Loss: 0.1233188 Test Loss: 0.1731834
Validation loss decreased (0.123389 --> 0.123319).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0494896
	speed: 0.1743s/iter; left time: 3742.0425s
	iters: 200, epoch: 19 | loss: 0.0483930
	speed: 0.0426s/iter; left time: 910.2862s
Epoch: 19 cost time: 11.582012176513672
Epoch: 19, Steps: 263 | Train Loss: 0.0510931 Vali Loss: 0.1233890 Test Loss: 0.1732783
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0539154
	speed: 0.0835s/iter; left time: 1770.9028s
	iters: 200, epoch: 20 | loss: 0.0552808
	speed: 0.0148s/iter; left time: 311.6470s
Epoch: 20 cost time: 4.341793775558472
Epoch: 20, Steps: 263 | Train Loss: 0.0510431 Vali Loss: 0.1233892 Test Loss: 0.1732034
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0532660
	speed: 0.0611s/iter; left time: 1278.9422s
	iters: 200, epoch: 21 | loss: 0.0469751
	speed: 0.0148s/iter; left time: 307.6651s
Epoch: 21 cost time: 4.3056416511535645
Epoch: 21, Steps: 263 | Train Loss: 0.0510218 Vali Loss: 0.1234497 Test Loss: 0.1733297
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0453742
	speed: 0.0595s/iter; left time: 1230.0217s
	iters: 200, epoch: 22 | loss: 0.0483628
	speed: 0.0147s/iter; left time: 303.5090s
Epoch: 22 cost time: 4.185532331466675
Epoch: 22, Steps: 263 | Train Loss: 0.0510446 Vali Loss: 0.1232096 Test Loss: 0.1731901
Validation loss decreased (0.123319 --> 0.123210).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0434182
	speed: 0.0601s/iter; left time: 1226.6610s
	iters: 200, epoch: 23 | loss: 0.0537046
	speed: 0.0139s/iter; left time: 282.6470s
Epoch: 23 cost time: 4.216150760650635
Epoch: 23, Steps: 263 | Train Loss: 0.0510457 Vali Loss: 0.1231440 Test Loss: 0.1730298
Validation loss decreased (0.123210 --> 0.123144).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0526092
	speed: 0.0612s/iter; left time: 1234.0182s
	iters: 200, epoch: 24 | loss: 0.0413639
	speed: 0.0145s/iter; left time: 290.0726s
Epoch: 24 cost time: 4.3478662967681885
Epoch: 24, Steps: 263 | Train Loss: 0.0510346 Vali Loss: 0.1231685 Test Loss: 0.1730732
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0437269
	speed: 0.0593s/iter; left time: 1178.6803s
	iters: 200, epoch: 25 | loss: 0.0583612
	speed: 0.0145s/iter; left time: 287.8083s
Epoch: 25 cost time: 4.16405725479126
Epoch: 25, Steps: 263 | Train Loss: 0.0510416 Vali Loss: 0.1231139 Test Loss: 0.1730781
Validation loss decreased (0.123144 --> 0.123114).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0488776
	speed: 0.0615s/iter; left time: 1207.9041s
	iters: 200, epoch: 26 | loss: 0.0405668
	speed: 0.0141s/iter; left time: 274.6935s
Epoch: 26 cost time: 4.290927410125732
Epoch: 26, Steps: 263 | Train Loss: 0.0510219 Vali Loss: 0.1232010 Test Loss: 0.1730862
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0456521
	speed: 0.0617s/iter; left time: 1194.8954s
	iters: 200, epoch: 27 | loss: 0.0459868
	speed: 0.0146s/iter; left time: 281.6728s
Epoch: 27 cost time: 4.2938618659973145
Epoch: 27, Steps: 263 | Train Loss: 0.0510088 Vali Loss: 0.1231054 Test Loss: 0.1730077
Validation loss decreased (0.123114 --> 0.123105).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0482524
	speed: 0.0593s/iter; left time: 1133.0518s
	iters: 200, epoch: 28 | loss: 0.0517681
	speed: 0.0150s/iter; left time: 285.8102s
Epoch: 28 cost time: 4.245451211929321
Epoch: 28, Steps: 263 | Train Loss: 0.0509916 Vali Loss: 0.1232945 Test Loss: 0.1732263
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0393817
	speed: 0.0597s/iter; left time: 1125.2401s
	iters: 200, epoch: 29 | loss: 0.0447612
	speed: 0.0144s/iter; left time: 269.8293s
Epoch: 29 cost time: 4.2599756717681885
Epoch: 29, Steps: 263 | Train Loss: 0.0510210 Vali Loss: 0.1231841 Test Loss: 0.1731324
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0487150
	speed: 0.0612s/iter; left time: 1137.4769s
	iters: 200, epoch: 30 | loss: 0.0507009
	speed: 0.0156s/iter; left time: 288.9695s
Epoch: 30 cost time: 4.466631174087524
Epoch: 30, Steps: 263 | Train Loss: 0.0510319 Vali Loss: 0.1231743 Test Loss: 0.1730749
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0503683
	speed: 0.0675s/iter; left time: 1236.8158s
	iters: 200, epoch: 31 | loss: 0.0468454
	speed: 0.0177s/iter; left time: 323.0656s
Epoch: 31 cost time: 4.774462938308716
Epoch: 31, Steps: 263 | Train Loss: 0.0510309 Vali Loss: 0.1230318 Test Loss: 0.1729740
Validation loss decreased (0.123105 --> 0.123032).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0471668
	speed: 0.0612s/iter; left time: 1103.6414s
	iters: 200, epoch: 32 | loss: 0.0483590
	speed: 0.0155s/iter; left time: 277.7527s
Epoch: 32 cost time: 4.431453704833984
Epoch: 32, Steps: 263 | Train Loss: 0.0509697 Vali Loss: 0.1231853 Test Loss: 0.1731070
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0512031
	speed: 0.0598s/iter; left time: 1064.0707s
	iters: 200, epoch: 33 | loss: 0.0403379
	speed: 0.0155s/iter; left time: 273.5132s
Epoch: 33 cost time: 4.353257417678833
Epoch: 33, Steps: 263 | Train Loss: 0.0510136 Vali Loss: 0.1230897 Test Loss: 0.1729734
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0484438
	speed: 0.0614s/iter; left time: 1076.1373s
	iters: 200, epoch: 34 | loss: 0.0641487
	speed: 0.0151s/iter; left time: 263.2049s
Epoch: 34 cost time: 4.349935054779053
Epoch: 34, Steps: 263 | Train Loss: 0.0510153 Vali Loss: 0.1231310 Test Loss: 0.1729841
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0501126
	speed: 0.0604s/iter; left time: 1042.9447s
	iters: 200, epoch: 35 | loss: 0.0392533
	speed: 0.0157s/iter; left time: 269.3066s
Epoch: 35 cost time: 4.374050855636597
Epoch: 35, Steps: 263 | Train Loss: 0.0510048 Vali Loss: 0.1231198 Test Loss: 0.1730596
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0537562
	speed: 0.0603s/iter; left time: 1024.1609s
	iters: 200, epoch: 36 | loss: 0.0460094
	speed: 0.0156s/iter; left time: 263.8086s
Epoch: 36 cost time: 4.478982448577881
Epoch: 36, Steps: 263 | Train Loss: 0.0509347 Vali Loss: 0.1230930 Test Loss: 0.1729629
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0522503
	speed: 0.0624s/iter; left time: 1043.4095s
	iters: 200, epoch: 37 | loss: 0.0421008
	speed: 0.0140s/iter; left time: 232.7579s
Epoch: 37 cost time: 4.129260301589966
Epoch: 37, Steps: 263 | Train Loss: 0.0510195 Vali Loss: 0.1231463 Test Loss: 0.1730014
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0503597
	speed: 0.0620s/iter; left time: 1020.9628s
	iters: 200, epoch: 38 | loss: 0.0446602
	speed: 0.0142s/iter; left time: 233.0325s
Epoch: 38 cost time: 4.408327341079712
Epoch: 38, Steps: 263 | Train Loss: 0.0510091 Vali Loss: 0.1230849 Test Loss: 0.1729805
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0435369
	speed: 0.0599s/iter; left time: 970.1156s
	iters: 200, epoch: 39 | loss: 0.0709148
	speed: 0.0153s/iter; left time: 246.6750s
Epoch: 39 cost time: 4.362497806549072
Epoch: 39, Steps: 263 | Train Loss: 0.0509908 Vali Loss: 0.1231641 Test Loss: 0.1730686
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0559412
	speed: 0.0602s/iter; left time: 959.7558s
	iters: 200, epoch: 40 | loss: 0.0461023
	speed: 0.0143s/iter; left time: 227.0952s
Epoch: 40 cost time: 4.223753452301025
Epoch: 40, Steps: 263 | Train Loss: 0.0510019 Vali Loss: 0.1230700 Test Loss: 0.1730835
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0521058
	speed: 0.0596s/iter; left time: 933.8399s
	iters: 200, epoch: 41 | loss: 0.0550736
	speed: 0.0150s/iter; left time: 233.9624s
Epoch: 41 cost time: 4.347347259521484
Epoch: 41, Steps: 263 | Train Loss: 0.0510131 Vali Loss: 0.1231805 Test Loss: 0.1730540
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0517251
	speed: 0.0590s/iter; left time: 910.1900s
	iters: 200, epoch: 42 | loss: 0.0529383
	speed: 0.0146s/iter; left time: 223.4210s
Epoch: 42 cost time: 4.304009675979614
Epoch: 42, Steps: 263 | Train Loss: 0.0510174 Vali Loss: 0.1231438 Test Loss: 0.1730224
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0521504
	speed: 0.0612s/iter; left time: 927.9902s
	iters: 200, epoch: 43 | loss: 0.0524655
	speed: 0.0143s/iter; left time: 214.6555s
Epoch: 43 cost time: 4.261750936508179
Epoch: 43, Steps: 263 | Train Loss: 0.0510012 Vali Loss: 0.1231082 Test Loss: 0.1729780
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0511160
	speed: 0.0585s/iter; left time: 871.9210s
	iters: 200, epoch: 44 | loss: 0.0480678
	speed: 0.0142s/iter; left time: 209.7932s
Epoch: 44 cost time: 4.1391191482543945
Epoch: 44, Steps: 263 | Train Loss: 0.0510104 Vali Loss: 0.1231674 Test Loss: 0.1730288
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0519247
	speed: 0.0589s/iter; left time: 862.2239s
	iters: 200, epoch: 45 | loss: 0.0566862
	speed: 0.0151s/iter; left time: 219.5708s
Epoch: 45 cost time: 4.347927808761597
Epoch: 45, Steps: 263 | Train Loss: 0.0510029 Vali Loss: 0.1231925 Test Loss: 0.1730190
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0473501
	speed: 0.0608s/iter; left time: 873.8579s
	iters: 200, epoch: 46 | loss: 0.0433082
	speed: 0.0151s/iter; left time: 215.6616s
Epoch: 46 cost time: 4.279578685760498
Epoch: 46, Steps: 263 | Train Loss: 0.0510007 Vali Loss: 0.1231749 Test Loss: 0.1730208
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.0476930
	speed: 0.0598s/iter; left time: 842.9004s
	iters: 200, epoch: 47 | loss: 0.0440172
	speed: 0.0147s/iter; left time: 206.3074s
Epoch: 47 cost time: 4.215306520462036
Epoch: 47, Steps: 263 | Train Loss: 0.0510128 Vali Loss: 0.1231438 Test Loss: 0.1730196
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.0466078
	speed: 0.0618s/iter; left time: 855.7116s
	iters: 200, epoch: 48 | loss: 0.0470235
	speed: 0.0159s/iter; left time: 218.1330s
Epoch: 48 cost time: 4.520968675613403
Epoch: 48, Steps: 263 | Train Loss: 0.0510044 Vali Loss: 0.1231574 Test Loss: 0.1730197
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.0395960
	speed: 0.0621s/iter; left time: 842.9962s
	iters: 200, epoch: 49 | loss: 0.0435089
	speed: 0.0148s/iter; left time: 199.4166s
Epoch: 49 cost time: 4.311943531036377
Epoch: 49, Steps: 263 | Train Loss: 0.0510191 Vali Loss: 0.1230837 Test Loss: 0.1729463
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.0594339
	speed: 0.0642s/iter; left time: 854.5531s
	iters: 200, epoch: 50 | loss: 0.0457025
	speed: 0.0151s/iter; left time: 199.9174s
Epoch: 50 cost time: 4.515775442123413
Epoch: 50, Steps: 263 | Train Loss: 0.0509631 Vali Loss: 0.1231319 Test Loss: 0.1730258
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.0524693
	speed: 0.0642s/iter; left time: 837.7593s
	iters: 200, epoch: 51 | loss: 0.0462355
	speed: 0.0160s/iter; left time: 207.2099s
Epoch: 51 cost time: 4.7959144115448
Epoch: 51, Steps: 263 | Train Loss: 0.0509993 Vali Loss: 0.1232161 Test Loss: 0.1730441
EarlyStopping counter: 20 out of 20
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=42, out_features=47, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1768704.0
params:  2021.0
Trainable parameters:  2021
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1802317
	speed: 0.0192s/iter; left time: 503.3624s
	iters: 200, epoch: 1 | loss: 0.2478342
	speed: 0.0147s/iter; left time: 383.1357s
Epoch: 1 cost time: 4.2704246044158936
Epoch: 1, Steps: 263 | Train Loss: 0.2211757 Vali Loss: 0.1190433 Test Loss: 0.1682407
Validation loss decreased (inf --> 0.119043).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1815532
	speed: 0.0606s/iter; left time: 1572.9418s
	iters: 200, epoch: 2 | loss: 0.1644182
	speed: 0.0145s/iter; left time: 375.2264s
Epoch: 2 cost time: 4.353430986404419
Epoch: 2, Steps: 263 | Train Loss: 0.2177058 Vali Loss: 0.1179651 Test Loss: 0.1671788
Validation loss decreased (0.119043 --> 0.117965).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2578917
	speed: 0.0596s/iter; left time: 1530.0792s
	iters: 200, epoch: 3 | loss: 0.1881009
	speed: 0.0150s/iter; left time: 383.4224s
Epoch: 3 cost time: 4.22773551940918
Epoch: 3, Steps: 263 | Train Loss: 0.2159673 Vali Loss: 0.1184478 Test Loss: 0.1674444
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1702658
	speed: 0.0605s/iter; left time: 1538.6203s
	iters: 200, epoch: 4 | loss: 0.2768386
	speed: 0.0150s/iter; left time: 379.2416s
Epoch: 4 cost time: 4.31463360786438
Epoch: 4, Steps: 263 | Train Loss: 0.2154102 Vali Loss: 0.1179513 Test Loss: 0.1667099
Validation loss decreased (0.117965 --> 0.117951).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1539237
	speed: 0.0587s/iter; left time: 1475.1348s
	iters: 200, epoch: 5 | loss: 0.3020924
	speed: 0.0145s/iter; left time: 362.9426s
Epoch: 5 cost time: 4.204253435134888
Epoch: 5, Steps: 263 | Train Loss: 0.2148849 Vali Loss: 0.1182269 Test Loss: 0.1668899
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1511943
	speed: 0.0610s/iter; left time: 1518.7477s
	iters: 200, epoch: 6 | loss: 0.2211792
	speed: 0.0140s/iter; left time: 348.1441s
Epoch: 6 cost time: 4.145984649658203
Epoch: 6, Steps: 263 | Train Loss: 0.2147144 Vali Loss: 0.1180377 Test Loss: 0.1665741
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2146281
	speed: 0.0594s/iter; left time: 1463.2984s
	iters: 200, epoch: 7 | loss: 0.2192246
	speed: 0.0149s/iter; left time: 366.2149s
Epoch: 7 cost time: 4.433714389801025
Epoch: 7, Steps: 263 | Train Loss: 0.2144151 Vali Loss: 0.1181653 Test Loss: 0.1664644
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2552991
	speed: 0.0602s/iter; left time: 1465.4586s
	iters: 200, epoch: 8 | loss: 0.1988673
	speed: 0.0149s/iter; left time: 361.2097s
Epoch: 8 cost time: 4.291851997375488
Epoch: 8, Steps: 263 | Train Loss: 0.2141044 Vali Loss: 0.1179866 Test Loss: 0.1666498
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2096564
	speed: 0.0605s/iter; left time: 1456.6750s
	iters: 200, epoch: 9 | loss: 0.1732481
	speed: 0.0146s/iter; left time: 351.4851s
Epoch: 9 cost time: 4.193854570388794
Epoch: 9, Steps: 263 | Train Loss: 0.2140049 Vali Loss: 0.1177903 Test Loss: 0.1660312
Validation loss decreased (0.117951 --> 0.117790).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1798308
	speed: 0.0601s/iter; left time: 1431.9164s
	iters: 200, epoch: 10 | loss: 0.1922995
	speed: 0.0146s/iter; left time: 347.1152s
Epoch: 10 cost time: 4.344570159912109
Epoch: 10, Steps: 263 | Train Loss: 0.2141085 Vali Loss: 0.1177910 Test Loss: 0.1661356
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1732632
	speed: 0.0595s/iter; left time: 1403.5026s
	iters: 200, epoch: 11 | loss: 0.2253743
	speed: 0.0146s/iter; left time: 342.3541s
Epoch: 11 cost time: 4.3446900844573975
Epoch: 11, Steps: 263 | Train Loss: 0.2138872 Vali Loss: 0.1179572 Test Loss: 0.1663199
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2072470
	speed: 0.0607s/iter; left time: 1414.3003s
	iters: 200, epoch: 12 | loss: 0.1859794
	speed: 0.0147s/iter; left time: 341.2691s
Epoch: 12 cost time: 4.336618185043335
Epoch: 12, Steps: 263 | Train Loss: 0.2137096 Vali Loss: 0.1180707 Test Loss: 0.1662835
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1976660
	speed: 0.0600s/iter; left time: 1383.3222s
	iters: 200, epoch: 13 | loss: 0.1501613
	speed: 0.0145s/iter; left time: 332.2010s
Epoch: 13 cost time: 4.2984840869903564
Epoch: 13, Steps: 263 | Train Loss: 0.2138070 Vali Loss: 0.1177923 Test Loss: 0.1663112
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1708589
	speed: 0.0611s/iter; left time: 1390.9340s
	iters: 200, epoch: 14 | loss: 0.1597582
	speed: 0.0144s/iter; left time: 326.4791s
Epoch: 14 cost time: 4.2985618114471436
Epoch: 14, Steps: 263 | Train Loss: 0.2137011 Vali Loss: 0.1178607 Test Loss: 0.1661138
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3239471
	speed: 0.0593s/iter; left time: 1336.0755s
	iters: 200, epoch: 15 | loss: 0.2469830
	speed: 0.0150s/iter; left time: 336.5555s
Epoch: 15 cost time: 4.317157983779907
Epoch: 15, Steps: 263 | Train Loss: 0.2135467 Vali Loss: 0.1178135 Test Loss: 0.1659875
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1577685
	speed: 0.0597s/iter; left time: 1328.4827s
	iters: 200, epoch: 16 | loss: 0.1811982
	speed: 0.0150s/iter; left time: 333.1934s
Epoch: 16 cost time: 4.32087779045105
Epoch: 16, Steps: 263 | Train Loss: 0.2134694 Vali Loss: 0.1179171 Test Loss: 0.1661457
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2789853
	speed: 0.0596s/iter; left time: 1310.2118s
	iters: 200, epoch: 17 | loss: 0.1643204
	speed: 0.0153s/iter; left time: 333.9259s
Epoch: 17 cost time: 4.278854131698608
Epoch: 17, Steps: 263 | Train Loss: 0.2134477 Vali Loss: 0.1178372 Test Loss: 0.1662629
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1998671
	speed: 0.0590s/iter; left time: 1281.7212s
	iters: 200, epoch: 18 | loss: 0.1729386
	speed: 0.0144s/iter; left time: 312.1154s
Epoch: 18 cost time: 4.2871153354644775
Epoch: 18, Steps: 263 | Train Loss: 0.2133715 Vali Loss: 0.1179783 Test Loss: 0.1662828
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1900728
	speed: 0.0599s/iter; left time: 1285.0904s
	iters: 200, epoch: 19 | loss: 0.2390667
	speed: 0.0144s/iter; left time: 308.0476s
Epoch: 19 cost time: 4.259791851043701
Epoch: 19, Steps: 263 | Train Loss: 0.2133807 Vali Loss: 0.1179957 Test Loss: 0.1661422
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2388761
	speed: 0.0590s/iter; left time: 1251.0219s
	iters: 200, epoch: 20 | loss: 0.2296303
	speed: 0.0148s/iter; left time: 312.1541s
Epoch: 20 cost time: 4.300658464431763
Epoch: 20, Steps: 263 | Train Loss: 0.2133657 Vali Loss: 0.1178793 Test Loss: 0.1661268
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2248154
	speed: 0.0600s/iter; left time: 1255.6479s
	iters: 200, epoch: 21 | loss: 0.1651830
	speed: 0.0145s/iter; left time: 302.2507s
Epoch: 21 cost time: 4.283138036727905
Epoch: 21, Steps: 263 | Train Loss: 0.2133694 Vali Loss: 0.1178652 Test Loss: 0.1662441
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2177863
	speed: 0.0591s/iter; left time: 1221.6771s
	iters: 200, epoch: 22 | loss: 0.1731528
	speed: 0.0146s/iter; left time: 299.7080s
Epoch: 22 cost time: 4.2185468673706055
Epoch: 22, Steps: 263 | Train Loss: 0.2131308 Vali Loss: 0.1179054 Test Loss: 0.1662385
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1492177
	speed: 0.0620s/iter; left time: 1266.3677s
	iters: 200, epoch: 23 | loss: 0.1466481
	speed: 0.0162s/iter; left time: 329.3600s
Epoch: 23 cost time: 4.642950534820557
Epoch: 23, Steps: 263 | Train Loss: 0.2132111 Vali Loss: 0.1178575 Test Loss: 0.1662212
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2637289
	speed: 0.0633s/iter; left time: 1275.1131s
	iters: 200, epoch: 24 | loss: 0.1733789
	speed: 0.0145s/iter; left time: 289.8879s
Epoch: 24 cost time: 4.199219226837158
Epoch: 24, Steps: 263 | Train Loss: 0.2134354 Vali Loss: 0.1178054 Test Loss: 0.1661039
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1834586
	speed: 0.0578s/iter; left time: 1148.6510s
	iters: 200, epoch: 25 | loss: 0.2560538
	speed: 0.0149s/iter; left time: 294.0671s
Epoch: 25 cost time: 4.254634618759155
Epoch: 25, Steps: 263 | Train Loss: 0.2132467 Vali Loss: 0.1179039 Test Loss: 0.1662300
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2552670
	speed: 0.0598s/iter; left time: 1173.0688s
	iters: 200, epoch: 26 | loss: 0.2744940
	speed: 0.0150s/iter; left time: 292.3100s
Epoch: 26 cost time: 4.330171823501587
Epoch: 26, Steps: 263 | Train Loss: 0.2133099 Vali Loss: 0.1178707 Test Loss: 0.1662144
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2498431
	speed: 0.0602s/iter; left time: 1165.0975s
	iters: 200, epoch: 27 | loss: 0.2399282
	speed: 0.0145s/iter; left time: 279.3742s
Epoch: 27 cost time: 4.352771997451782
Epoch: 27, Steps: 263 | Train Loss: 0.2131418 Vali Loss: 0.1178231 Test Loss: 0.1660674
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2310845
	speed: 0.0594s/iter; left time: 1134.1168s
	iters: 200, epoch: 28 | loss: 0.2517406
	speed: 0.0140s/iter; left time: 265.8649s
Epoch: 28 cost time: 4.144606113433838
Epoch: 28, Steps: 263 | Train Loss: 0.2131767 Vali Loss: 0.1179051 Test Loss: 0.1662304
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1746419
	speed: 0.0572s/iter; left time: 1076.8797s
	iters: 200, epoch: 29 | loss: 0.2604159
	speed: 0.0141s/iter; left time: 265.0928s
Epoch: 29 cost time: 4.136956691741943
Epoch: 29, Steps: 263 | Train Loss: 0.2130250 Vali Loss: 0.1178095 Test Loss: 0.1660958
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16649992763996124, mae:0.2572273313999176, rse:0.3308287262916565, corr:[0.56440693 0.56521577 0.56610745 0.566723   0.56687814 0.5666117
 0.5660259  0.5652496  0.5644224  0.5636626  0.5630241  0.56249845
 0.56208414 0.5617233  0.56140244 0.56104034 0.56064385 0.5601877
 0.5596598  0.5590314  0.5583376  0.5575851  0.5568226  0.55610883
 0.55543804 0.55481577 0.55425113 0.55373573 0.5532552  0.5528154
 0.55238813 0.5520406  0.55173695 0.55138826 0.5509536  0.55044794
 0.54986346 0.54922837 0.5485458  0.54783505 0.5471143  0.54638386
 0.54563516 0.5448712  0.54411906 0.5433851  0.5426994  0.54209805
 0.54151636 0.54089993 0.54021436 0.5394939  0.53872985 0.5379177
 0.5370633  0.5362493  0.5354835  0.53478396 0.53416646 0.5336678
 0.5332874  0.53307444 0.533017   0.5330598  0.53312284 0.53320515
 0.53322387 0.53316283 0.53303945 0.53282696 0.5324949  0.53201425
 0.5313725  0.5306084  0.5297531  0.5288946  0.5281053  0.5274156
 0.5268338  0.52641946 0.52604675 0.5257057  0.5253249  0.5248794
 0.5243771  0.52385247 0.52323776 0.52255625 0.521827   0.52109843
 0.52049536 0.5201377  0.5198876  0.51965904 0.51925045 0.5183332 ]
