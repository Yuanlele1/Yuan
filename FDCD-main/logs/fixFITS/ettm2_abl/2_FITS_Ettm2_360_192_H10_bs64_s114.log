Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=50, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_360_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_360_192_FITS_ETTm2_ftM_sl360_ll48_pl192_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34009
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=50, out_features=76, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3404800.0
params:  3876.0
Trainable parameters:  3876
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2950112
	speed: 0.0197s/iter; left time: 520.5331s
	iters: 200, epoch: 1 | loss: 0.2179206
	speed: 0.0142s/iter; left time: 373.0322s
Epoch: 1 cost time: 4.317336559295654
Epoch: 1, Steps: 265 | Train Loss: 0.2822056 Vali Loss: 0.2071099 Test Loss: 0.2764037
Validation loss decreased (inf --> 0.207110).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2782950
	speed: 0.0690s/iter; left time: 1802.2373s
	iters: 200, epoch: 2 | loss: 0.2024748
	speed: 0.0130s/iter; left time: 339.3847s
Epoch: 2 cost time: 3.999807357788086
Epoch: 2, Steps: 265 | Train Loss: 0.1851898 Vali Loss: 0.1860624 Test Loss: 0.2520607
Validation loss decreased (0.207110 --> 0.186062).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1715105
	speed: 0.0669s/iter; left time: 1731.2202s
	iters: 200, epoch: 3 | loss: 0.1136966
	speed: 0.0127s/iter; left time: 328.0177s
Epoch: 3 cost time: 3.9670450687408447
Epoch: 3, Steps: 265 | Train Loss: 0.1540982 Vali Loss: 0.1765371 Test Loss: 0.2411964
Validation loss decreased (0.186062 --> 0.176537).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1373189
	speed: 0.0667s/iter; left time: 1708.2486s
	iters: 200, epoch: 4 | loss: 0.1107859
	speed: 0.0128s/iter; left time: 325.9682s
Epoch: 4 cost time: 3.909459114074707
Epoch: 4, Steps: 265 | Train Loss: 0.1391049 Vali Loss: 0.1702142 Test Loss: 0.2342170
Validation loss decreased (0.176537 --> 0.170214).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1108169
	speed: 0.0658s/iter; left time: 1666.9523s
	iters: 200, epoch: 5 | loss: 0.1519502
	speed: 0.0129s/iter; left time: 324.6307s
Epoch: 5 cost time: 3.8870155811309814
Epoch: 5, Steps: 265 | Train Loss: 0.1303971 Vali Loss: 0.1663121 Test Loss: 0.2296807
Validation loss decreased (0.170214 --> 0.166312).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1309643
	speed: 0.0655s/iter; left time: 1642.7570s
	iters: 200, epoch: 6 | loss: 0.1058019
	speed: 0.0130s/iter; left time: 324.7363s
Epoch: 6 cost time: 3.907395601272583
Epoch: 6, Steps: 265 | Train Loss: 0.1252046 Vali Loss: 0.1634323 Test Loss: 0.2266471
Validation loss decreased (0.166312 --> 0.163432).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1288997
	speed: 0.0671s/iter; left time: 1664.8971s
	iters: 200, epoch: 7 | loss: 0.1038698
	speed: 0.0131s/iter; left time: 323.6595s
Epoch: 7 cost time: 3.9521260261535645
Epoch: 7, Steps: 265 | Train Loss: 0.1216311 Vali Loss: 0.1617290 Test Loss: 0.2250047
Validation loss decreased (0.163432 --> 0.161729).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0958663
	speed: 0.0674s/iter; left time: 1655.0431s
	iters: 200, epoch: 8 | loss: 0.1713423
	speed: 0.0137s/iter; left time: 335.4883s
Epoch: 8 cost time: 4.121870517730713
Epoch: 8, Steps: 265 | Train Loss: 0.1192994 Vali Loss: 0.1605430 Test Loss: 0.2239556
Validation loss decreased (0.161729 --> 0.160543).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0748615
	speed: 0.0660s/iter; left time: 1603.6500s
	iters: 200, epoch: 9 | loss: 0.1313491
	speed: 0.0130s/iter; left time: 314.9621s
Epoch: 9 cost time: 3.847611904144287
Epoch: 9, Steps: 265 | Train Loss: 0.1177784 Vali Loss: 0.1599426 Test Loss: 0.2230618
Validation loss decreased (0.160543 --> 0.159943).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1487660
	speed: 0.0684s/iter; left time: 1643.4101s
	iters: 200, epoch: 10 | loss: 0.1778924
	speed: 0.0131s/iter; left time: 313.1750s
Epoch: 10 cost time: 4.109072685241699
Epoch: 10, Steps: 265 | Train Loss: 0.1167938 Vali Loss: 0.1592832 Test Loss: 0.2227325
Validation loss decreased (0.159943 --> 0.159283).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0756772
	speed: 0.0663s/iter; left time: 1574.7602s
	iters: 200, epoch: 11 | loss: 0.0961250
	speed: 0.0125s/iter; left time: 296.3971s
Epoch: 11 cost time: 3.909052848815918
Epoch: 11, Steps: 265 | Train Loss: 0.1161063 Vali Loss: 0.1588465 Test Loss: 0.2225351
Validation loss decreased (0.159283 --> 0.158846).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1071179
	speed: 0.0660s/iter; left time: 1550.9811s
	iters: 200, epoch: 12 | loss: 0.1176524
	speed: 0.0133s/iter; left time: 311.6876s
Epoch: 12 cost time: 3.9988527297973633
Epoch: 12, Steps: 265 | Train Loss: 0.1157221 Vali Loss: 0.1587635 Test Loss: 0.2223371
Validation loss decreased (0.158846 --> 0.158763).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0967223
	speed: 0.0669s/iter; left time: 1553.9229s
	iters: 200, epoch: 13 | loss: 0.1742957
	speed: 0.0128s/iter; left time: 296.7039s
Epoch: 13 cost time: 3.896685838699341
Epoch: 13, Steps: 265 | Train Loss: 0.1152448 Vali Loss: 0.1583992 Test Loss: 0.2221516
Validation loss decreased (0.158763 --> 0.158399).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1257794
	speed: 0.0756s/iter; left time: 1735.7626s
	iters: 200, epoch: 14 | loss: 0.1306923
	speed: 0.0132s/iter; left time: 301.6869s
Epoch: 14 cost time: 3.976921319961548
Epoch: 14, Steps: 265 | Train Loss: 0.1152324 Vali Loss: 0.1583716 Test Loss: 0.2222428
Validation loss decreased (0.158399 --> 0.158372).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1100390
	speed: 0.0687s/iter; left time: 1558.6008s
	iters: 200, epoch: 15 | loss: 0.1157480
	speed: 0.0129s/iter; left time: 290.9091s
Epoch: 15 cost time: 4.016855955123901
Epoch: 15, Steps: 265 | Train Loss: 0.1150454 Vali Loss: 0.1582240 Test Loss: 0.2221306
Validation loss decreased (0.158372 --> 0.158224).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1698084
	speed: 0.0678s/iter; left time: 1520.6737s
	iters: 200, epoch: 16 | loss: 0.0756609
	speed: 0.0130s/iter; left time: 290.0864s
Epoch: 16 cost time: 4.146251440048218
Epoch: 16, Steps: 265 | Train Loss: 0.1149703 Vali Loss: 0.1580540 Test Loss: 0.2221140
Validation loss decreased (0.158224 --> 0.158054).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1272763
	speed: 0.0659s/iter; left time: 1461.0901s
	iters: 200, epoch: 17 | loss: 0.1274212
	speed: 0.0130s/iter; left time: 287.3553s
Epoch: 17 cost time: 3.922555446624756
Epoch: 17, Steps: 265 | Train Loss: 0.1148342 Vali Loss: 0.1581781 Test Loss: 0.2221228
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1042528
	speed: 0.0766s/iter; left time: 1677.3692s
	iters: 200, epoch: 18 | loss: 0.0799104
	speed: 0.0148s/iter; left time: 321.9478s
Epoch: 18 cost time: 4.381864547729492
Epoch: 18, Steps: 265 | Train Loss: 0.1148055 Vali Loss: 0.1580257 Test Loss: 0.2221033
Validation loss decreased (0.158054 --> 0.158026).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1391733
	speed: 0.0695s/iter; left time: 1504.3174s
	iters: 200, epoch: 19 | loss: 0.1386678
	speed: 0.0129s/iter; left time: 276.9892s
Epoch: 19 cost time: 4.223695755004883
Epoch: 19, Steps: 265 | Train Loss: 0.1148517 Vali Loss: 0.1581080 Test Loss: 0.2220497
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1220312
	speed: 0.0718s/iter; left time: 1534.5288s
	iters: 200, epoch: 20 | loss: 0.1178767
	speed: 0.0134s/iter; left time: 283.9317s
Epoch: 20 cost time: 3.9732584953308105
Epoch: 20, Steps: 265 | Train Loss: 0.1146119 Vali Loss: 0.1578773 Test Loss: 0.2221103
Validation loss decreased (0.158026 --> 0.157877).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0895654
	speed: 0.0679s/iter; left time: 1432.3892s
	iters: 200, epoch: 21 | loss: 0.0837243
	speed: 0.0130s/iter; left time: 272.0959s
Epoch: 21 cost time: 4.027207612991333
Epoch: 21, Steps: 265 | Train Loss: 0.1145665 Vali Loss: 0.1579490 Test Loss: 0.2219546
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1263623
	speed: 0.0671s/iter; left time: 1398.2955s
	iters: 200, epoch: 22 | loss: 0.1408891
	speed: 0.0128s/iter; left time: 264.4828s
Epoch: 22 cost time: 3.894606113433838
Epoch: 22, Steps: 265 | Train Loss: 0.1146766 Vali Loss: 0.1579319 Test Loss: 0.2218920
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0907688
	speed: 0.0670s/iter; left time: 1377.5836s
	iters: 200, epoch: 23 | loss: 0.0968465
	speed: 0.0130s/iter; left time: 266.8065s
Epoch: 23 cost time: 3.973921775817871
Epoch: 23, Steps: 265 | Train Loss: 0.1147287 Vali Loss: 0.1580393 Test Loss: 0.2220325
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0857891
	speed: 0.0662s/iter; left time: 1345.2518s
	iters: 200, epoch: 24 | loss: 0.1049111
	speed: 0.0128s/iter; left time: 258.6553s
Epoch: 24 cost time: 3.914116382598877
Epoch: 24, Steps: 265 | Train Loss: 0.1147541 Vali Loss: 0.1579375 Test Loss: 0.2219541
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1108462
	speed: 0.0666s/iter; left time: 1335.4059s
	iters: 200, epoch: 25 | loss: 0.0976354
	speed: 0.0132s/iter; left time: 263.7095s
Epoch: 25 cost time: 4.219574451446533
Epoch: 25, Steps: 265 | Train Loss: 0.1148056 Vali Loss: 0.1578241 Test Loss: 0.2219865
Validation loss decreased (0.157877 --> 0.157824).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1268111
	speed: 0.0695s/iter; left time: 1374.0938s
	iters: 200, epoch: 26 | loss: 0.1247151
	speed: 0.0129s/iter; left time: 253.1666s
Epoch: 26 cost time: 3.9285507202148438
Epoch: 26, Steps: 265 | Train Loss: 0.1146147 Vali Loss: 0.1579117 Test Loss: 0.2220136
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1025534
	speed: 0.0672s/iter; left time: 1311.2181s
	iters: 200, epoch: 27 | loss: 0.1581192
	speed: 0.0130s/iter; left time: 253.0500s
Epoch: 27 cost time: 3.9658100605010986
Epoch: 27, Steps: 265 | Train Loss: 0.1147486 Vali Loss: 0.1580122 Test Loss: 0.2219297
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0945646
	speed: 0.0682s/iter; left time: 1312.3962s
	iters: 200, epoch: 28 | loss: 0.1160683
	speed: 0.0132s/iter; left time: 252.5156s
Epoch: 28 cost time: 3.994722604751587
Epoch: 28, Steps: 265 | Train Loss: 0.1147212 Vali Loss: 0.1580201 Test Loss: 0.2219502
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0819027
	speed: 0.0668s/iter; left time: 1267.7687s
	iters: 200, epoch: 29 | loss: 0.0952951
	speed: 0.0150s/iter; left time: 283.6399s
Epoch: 29 cost time: 4.296666622161865
Epoch: 29, Steps: 265 | Train Loss: 0.1146461 Vali Loss: 0.1580589 Test Loss: 0.2219878
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0744008
	speed: 0.0682s/iter; left time: 1277.0241s
	iters: 200, epoch: 30 | loss: 0.1033873
	speed: 0.0127s/iter; left time: 236.2817s
Epoch: 30 cost time: 3.859419584274292
Epoch: 30, Steps: 265 | Train Loss: 0.1145583 Vali Loss: 0.1579342 Test Loss: 0.2219455
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1344424
	speed: 0.0667s/iter; left time: 1230.0711s
	iters: 200, epoch: 31 | loss: 0.1041869
	speed: 0.0125s/iter; left time: 229.1735s
Epoch: 31 cost time: 3.8761017322540283
Epoch: 31, Steps: 265 | Train Loss: 0.1147508 Vali Loss: 0.1579599 Test Loss: 0.2219862
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1071675
	speed: 0.0659s/iter; left time: 1198.8560s
	iters: 200, epoch: 32 | loss: 0.0858121
	speed: 0.0130s/iter; left time: 234.4384s
Epoch: 32 cost time: 3.974994659423828
Epoch: 32, Steps: 265 | Train Loss: 0.1147267 Vali Loss: 0.1578892 Test Loss: 0.2219346
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0816689
	speed: 0.0653s/iter; left time: 1170.5021s
	iters: 200, epoch: 33 | loss: 0.1180753
	speed: 0.0126s/iter; left time: 225.2154s
Epoch: 33 cost time: 3.8477375507354736
Epoch: 33, Steps: 265 | Train Loss: 0.1146733 Vali Loss: 0.1581597 Test Loss: 0.2219526
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0841306
	speed: 0.0682s/iter; left time: 1204.8434s
	iters: 200, epoch: 34 | loss: 0.1042387
	speed: 0.0132s/iter; left time: 230.8944s
Epoch: 34 cost time: 4.0077595710754395
Epoch: 34, Steps: 265 | Train Loss: 0.1147255 Vali Loss: 0.1580951 Test Loss: 0.2219621
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1166699
	speed: 0.0656s/iter; left time: 1141.1456s
	iters: 200, epoch: 35 | loss: 0.1107680
	speed: 0.0138s/iter; left time: 237.8470s
Epoch: 35 cost time: 4.043886184692383
Epoch: 35, Steps: 265 | Train Loss: 0.1145869 Vali Loss: 0.1579701 Test Loss: 0.2219574
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1114500
	speed: 0.0673s/iter; left time: 1153.2178s
	iters: 200, epoch: 36 | loss: 0.0813394
	speed: 0.0131s/iter; left time: 222.8897s
Epoch: 36 cost time: 3.9377875328063965
Epoch: 36, Steps: 265 | Train Loss: 0.1146512 Vali Loss: 0.1581083 Test Loss: 0.2219381
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0953780
	speed: 0.0686s/iter; left time: 1157.4757s
	iters: 200, epoch: 37 | loss: 0.1298834
	speed: 0.0154s/iter; left time: 258.5553s
Epoch: 37 cost time: 4.565821886062622
Epoch: 37, Steps: 265 | Train Loss: 0.1146489 Vali Loss: 0.1578984 Test Loss: 0.2219433
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0931170
	speed: 0.0725s/iter; left time: 1202.9566s
	iters: 200, epoch: 38 | loss: 0.1039125
	speed: 0.0148s/iter; left time: 243.9687s
Epoch: 38 cost time: 4.530920743942261
Epoch: 38, Steps: 265 | Train Loss: 0.1147027 Vali Loss: 0.1579707 Test Loss: 0.2219544
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1130537
	speed: 0.0729s/iter; left time: 1191.1892s
	iters: 200, epoch: 39 | loss: 0.1296395
	speed: 0.0153s/iter; left time: 248.5513s
Epoch: 39 cost time: 4.571701765060425
Epoch: 39, Steps: 265 | Train Loss: 0.1146755 Vali Loss: 0.1579141 Test Loss: 0.2219124
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1138436
	speed: 0.0673s/iter; left time: 1080.9224s
	iters: 200, epoch: 40 | loss: 0.1169353
	speed: 0.0134s/iter; left time: 214.1649s
Epoch: 40 cost time: 4.0467588901519775
Epoch: 40, Steps: 265 | Train Loss: 0.1146519 Vali Loss: 0.1580749 Test Loss: 0.2219234
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1644228
	speed: 0.0702s/iter; left time: 1108.5687s
	iters: 200, epoch: 41 | loss: 0.0908274
	speed: 0.0130s/iter; left time: 204.7872s
Epoch: 41 cost time: 4.206618547439575
Epoch: 41, Steps: 265 | Train Loss: 0.1146856 Vali Loss: 0.1580744 Test Loss: 0.2219355
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1010118
	speed: 0.0670s/iter; left time: 1041.2111s
	iters: 200, epoch: 42 | loss: 0.1083947
	speed: 0.0134s/iter; left time: 206.8952s
Epoch: 42 cost time: 3.994387626647949
Epoch: 42, Steps: 265 | Train Loss: 0.1147399 Vali Loss: 0.1580399 Test Loss: 0.2219145
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1061666
	speed: 0.0674s/iter; left time: 1028.7949s
	iters: 200, epoch: 43 | loss: 0.1135411
	speed: 0.0130s/iter; left time: 197.3094s
Epoch: 43 cost time: 3.9208948612213135
Epoch: 43, Steps: 265 | Train Loss: 0.1146609 Vali Loss: 0.1579425 Test Loss: 0.2219246
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1006258
	speed: 0.0675s/iter; left time: 1013.0937s
	iters: 200, epoch: 44 | loss: 0.1147966
	speed: 0.0127s/iter; left time: 189.4702s
Epoch: 44 cost time: 3.987457036972046
Epoch: 44, Steps: 265 | Train Loss: 0.1146724 Vali Loss: 0.1581032 Test Loss: 0.2219240
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0945946
	speed: 0.0665s/iter; left time: 979.8939s
	iters: 200, epoch: 45 | loss: 0.1180739
	speed: 0.0131s/iter; left time: 191.9768s
Epoch: 45 cost time: 3.899947166442871
Epoch: 45, Steps: 265 | Train Loss: 0.1147402 Vali Loss: 0.1580965 Test Loss: 0.2219194
EarlyStopping counter: 20 out of 20
Early stopping
train 34009
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=50, out_features=76, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3404800.0
params:  3876.0
Trainable parameters:  3876
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2216795
	speed: 0.0177s/iter; left time: 466.8533s
	iters: 200, epoch: 1 | loss: 0.3605913
	speed: 0.0128s/iter; left time: 336.4014s
Epoch: 1 cost time: 3.910069465637207
Epoch: 1, Steps: 265 | Train Loss: 0.3023207 Vali Loss: 0.1569456 Test Loss: 0.2208011
Validation loss decreased (inf --> 0.156946).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1828052
	speed: 0.0664s/iter; left time: 1736.7097s
	iters: 200, epoch: 2 | loss: 0.5294462
	speed: 0.0133s/iter; left time: 345.6907s
Epoch: 2 cost time: 3.8917927742004395
Epoch: 2, Steps: 265 | Train Loss: 0.3007965 Vali Loss: 0.1560394 Test Loss: 0.2202922
Validation loss decreased (0.156946 --> 0.156039).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2992906
	speed: 0.0675s/iter; left time: 1746.7140s
	iters: 200, epoch: 3 | loss: 0.2079956
	speed: 0.0132s/iter; left time: 341.3816s
Epoch: 3 cost time: 3.9746851921081543
Epoch: 3, Steps: 265 | Train Loss: 0.2998335 Vali Loss: 0.1559386 Test Loss: 0.2203132
Validation loss decreased (0.156039 --> 0.155939).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3135244
	speed: 0.0676s/iter; left time: 1732.0770s
	iters: 200, epoch: 4 | loss: 0.2908021
	speed: 0.0130s/iter; left time: 332.1228s
Epoch: 4 cost time: 3.9576501846313477
Epoch: 4, Steps: 265 | Train Loss: 0.2995225 Vali Loss: 0.1560043 Test Loss: 0.2197075
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2477667
	speed: 0.0678s/iter; left time: 1717.1236s
	iters: 200, epoch: 5 | loss: 0.3213013
	speed: 0.0129s/iter; left time: 325.3894s
Epoch: 5 cost time: 4.016857862472534
Epoch: 5, Steps: 265 | Train Loss: 0.2993901 Vali Loss: 0.1557815 Test Loss: 0.2197469
Validation loss decreased (0.155939 --> 0.155781).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3254636
	speed: 0.0693s/iter; left time: 1736.6005s
	iters: 200, epoch: 6 | loss: 0.2857403
	speed: 0.0151s/iter; left time: 378.3499s
Epoch: 6 cost time: 5.459445476531982
Epoch: 6, Steps: 265 | Train Loss: 0.2986430 Vali Loss: 0.1557557 Test Loss: 0.2196043
Validation loss decreased (0.155781 --> 0.155756).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3623817
	speed: 0.0780s/iter; left time: 1936.4364s
	iters: 200, epoch: 7 | loss: 0.3918095
	speed: 0.0125s/iter; left time: 310.0711s
Epoch: 7 cost time: 3.8729734420776367
Epoch: 7, Steps: 265 | Train Loss: 0.2990304 Vali Loss: 0.1554046 Test Loss: 0.2197665
Validation loss decreased (0.155756 --> 0.155405).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2246822
	speed: 0.0664s/iter; left time: 1629.1539s
	iters: 200, epoch: 8 | loss: 0.3451461
	speed: 0.0132s/iter; left time: 322.5087s
Epoch: 8 cost time: 4.024975776672363
Epoch: 8, Steps: 265 | Train Loss: 0.2985290 Vali Loss: 0.1556253 Test Loss: 0.2194573
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3978404
	speed: 0.0681s/iter; left time: 1653.4607s
	iters: 200, epoch: 9 | loss: 0.3284401
	speed: 0.0132s/iter; left time: 318.9653s
Epoch: 9 cost time: 4.023319244384766
Epoch: 9, Steps: 265 | Train Loss: 0.2984783 Vali Loss: 0.1557160 Test Loss: 0.2193996
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3102548
	speed: 0.0673s/iter; left time: 1615.6946s
	iters: 200, epoch: 10 | loss: 0.3154866
	speed: 0.0127s/iter; left time: 303.2404s
Epoch: 10 cost time: 3.900952100753784
Epoch: 10, Steps: 265 | Train Loss: 0.2980491 Vali Loss: 0.1557150 Test Loss: 0.2195477
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.4472108
	speed: 0.0680s/iter; left time: 1615.8686s
	iters: 200, epoch: 11 | loss: 0.2100195
	speed: 0.0134s/iter; left time: 316.8764s
Epoch: 11 cost time: 4.024169921875
Epoch: 11, Steps: 265 | Train Loss: 0.2984131 Vali Loss: 0.1555882 Test Loss: 0.2195191
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1853875
	speed: 0.0678s/iter; left time: 1591.6467s
	iters: 200, epoch: 12 | loss: 0.2806335
	speed: 0.0130s/iter; left time: 303.1918s
Epoch: 12 cost time: 3.995011329650879
Epoch: 12, Steps: 265 | Train Loss: 0.2979241 Vali Loss: 0.1556634 Test Loss: 0.2192134
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2585483
	speed: 0.0887s/iter; left time: 2059.0439s
	iters: 200, epoch: 13 | loss: 0.2242316
	speed: 0.0146s/iter; left time: 338.4819s
Epoch: 13 cost time: 4.397884845733643
Epoch: 13, Steps: 265 | Train Loss: 0.2980529 Vali Loss: 0.1558531 Test Loss: 0.2192184
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2624635
	speed: 0.0709s/iter; left time: 1626.5836s
	iters: 200, epoch: 14 | loss: 0.2705275
	speed: 0.0156s/iter; left time: 355.7484s
Epoch: 14 cost time: 4.568511247634888
Epoch: 14, Steps: 265 | Train Loss: 0.2982806 Vali Loss: 0.1558978 Test Loss: 0.2191890
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2417128
	speed: 0.0728s/iter; left time: 1650.9210s
	iters: 200, epoch: 15 | loss: 0.3378918
	speed: 0.0132s/iter; left time: 297.6991s
Epoch: 15 cost time: 4.142434597015381
Epoch: 15, Steps: 265 | Train Loss: 0.2980029 Vali Loss: 0.1556594 Test Loss: 0.2192690
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2054750
	speed: 0.0720s/iter; left time: 1615.4111s
	iters: 200, epoch: 16 | loss: 0.3318458
	speed: 0.0135s/iter; left time: 301.8339s
Epoch: 16 cost time: 4.22923731803894
Epoch: 16, Steps: 265 | Train Loss: 0.2980382 Vali Loss: 0.1556236 Test Loss: 0.2191383
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3926378
	speed: 0.0653s/iter; left time: 1448.1571s
	iters: 200, epoch: 17 | loss: 0.2374087
	speed: 0.0130s/iter; left time: 286.1820s
Epoch: 17 cost time: 3.8792622089385986
Epoch: 17, Steps: 265 | Train Loss: 0.2978927 Vali Loss: 0.1555312 Test Loss: 0.2190879
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2699111
	speed: 0.0668s/iter; left time: 1461.7022s
	iters: 200, epoch: 18 | loss: 0.4280521
	speed: 0.0132s/iter; left time: 286.9286s
Epoch: 18 cost time: 3.931281805038452
Epoch: 18, Steps: 265 | Train Loss: 0.2980105 Vali Loss: 0.1555669 Test Loss: 0.2192174
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2603094
	speed: 0.0667s/iter; left time: 1442.4889s
	iters: 200, epoch: 19 | loss: 0.2502640
	speed: 0.0129s/iter; left time: 277.2869s
Epoch: 19 cost time: 3.933906316757202
Epoch: 19, Steps: 265 | Train Loss: 0.2977768 Vali Loss: 0.1556187 Test Loss: 0.2191533
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3744464
	speed: 0.0670s/iter; left time: 1432.4515s
	iters: 200, epoch: 20 | loss: 0.2157160
	speed: 0.0134s/iter; left time: 284.1969s
Epoch: 20 cost time: 4.0502378940582275
Epoch: 20, Steps: 265 | Train Loss: 0.2975105 Vali Loss: 0.1556607 Test Loss: 0.2190711
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3320784
	speed: 0.0706s/iter; left time: 1490.5122s
	iters: 200, epoch: 21 | loss: 0.3621642
	speed: 0.0149s/iter; left time: 313.3071s
Epoch: 21 cost time: 4.468008756637573
Epoch: 21, Steps: 265 | Train Loss: 0.2978964 Vali Loss: 0.1556301 Test Loss: 0.2190923
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3536949
	speed: 0.0690s/iter; left time: 1437.2253s
	iters: 200, epoch: 22 | loss: 0.2340904
	speed: 0.0130s/iter; left time: 269.9674s
Epoch: 22 cost time: 4.010388612747192
Epoch: 22, Steps: 265 | Train Loss: 0.2978201 Vali Loss: 0.1556277 Test Loss: 0.2191577
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.4450082
	speed: 0.0666s/iter; left time: 1369.7828s
	iters: 200, epoch: 23 | loss: 0.2647200
	speed: 0.0131s/iter; left time: 267.8158s
Epoch: 23 cost time: 3.9427480697631836
Epoch: 23, Steps: 265 | Train Loss: 0.2979136 Vali Loss: 0.1556053 Test Loss: 0.2190622
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3422125
	speed: 0.0649s/iter; left time: 1318.6585s
	iters: 200, epoch: 24 | loss: 0.3179568
	speed: 0.0133s/iter; left time: 268.4137s
Epoch: 24 cost time: 3.937234401702881
Epoch: 24, Steps: 265 | Train Loss: 0.2978481 Vali Loss: 0.1555437 Test Loss: 0.2190734
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4161779
	speed: 0.0669s/iter; left time: 1341.0130s
	iters: 200, epoch: 25 | loss: 0.2974470
	speed: 0.0134s/iter; left time: 267.5369s
Epoch: 25 cost time: 3.9661142826080322
Epoch: 25, Steps: 265 | Train Loss: 0.2975818 Vali Loss: 0.1556630 Test Loss: 0.2191391
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3413889
	speed: 0.0680s/iter; left time: 1345.0473s
	iters: 200, epoch: 26 | loss: 0.2403903
	speed: 0.0129s/iter; left time: 254.1086s
Epoch: 26 cost time: 3.987330913543701
Epoch: 26, Steps: 265 | Train Loss: 0.2976865 Vali Loss: 0.1555893 Test Loss: 0.2191274
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2758576
	speed: 0.0679s/iter; left time: 1324.0180s
	iters: 200, epoch: 27 | loss: 0.2360616
	speed: 0.0130s/iter; left time: 252.1930s
Epoch: 27 cost time: 4.037113904953003
Epoch: 27, Steps: 265 | Train Loss: 0.2975315 Vali Loss: 0.1555953 Test Loss: 0.2191171
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_360_192_FITS_ETTm2_ftM_sl360_ll48_pl192_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.22051820158958435, mae:0.2917998731136322, rse:0.3801170289516449, corr:[0.56343377 0.56797105 0.5670194  0.56392723 0.5617588  0.5612575
 0.56177276 0.562117   0.5616235  0.5605538  0.5595758  0.55917764
 0.5593042  0.5594877  0.5592692  0.5584801  0.55744153 0.55656534
 0.5561109  0.5559955  0.55599934 0.55587494 0.55542374 0.5547685
 0.5541519  0.5537436  0.55352694 0.5533227  0.5529572  0.55234075
 0.5515979  0.5509621  0.5505431  0.5502808  0.54998505 0.5494978
 0.54877526 0.54791987 0.5471665  0.5466477  0.54635173 0.54617536
 0.5459179  0.5454235  0.5446661  0.5437467  0.54288006 0.5421472
 0.5414745  0.5407996  0.5400312  0.53921825 0.53836846 0.53756285
 0.5368839  0.5363655  0.5359179  0.535479   0.53502613 0.5345537
 0.53409857 0.5337549  0.53354853 0.5334252  0.5332876  0.5331066
 0.5328336  0.5325016  0.53222084 0.53206724 0.53201145 0.5319817
 0.5318737  0.53165495 0.5313083  0.53085476 0.53039676 0.52996
 0.5295723  0.5292025  0.52885705 0.52843755 0.5279577  0.52740407
 0.52684224 0.5263506  0.5258654  0.52543604 0.52505094 0.5246726
 0.5242763  0.52383775 0.52324045 0.52245533 0.52144235 0.5201534
 0.51862335 0.5170533  0.51559514 0.51426077 0.51302606 0.5118872
 0.51082385 0.5097458  0.50857997 0.50742257 0.5063707  0.5055039
 0.5047807  0.5040908  0.5034106  0.50269055 0.5019642  0.5012256
 0.5004993  0.4997988  0.49910635 0.49838847 0.49772564 0.49706978
 0.49643034 0.49577653 0.49522582 0.4947311  0.49420562 0.49362296
 0.49298912 0.49229527 0.49153605 0.4907322  0.4899697  0.4892451
 0.48857215 0.48797613 0.48742107 0.48690996 0.48626286 0.48559347
 0.48482916 0.48404503 0.48332283 0.4826987  0.48215675 0.48152262
 0.48067522 0.4795913  0.4784286  0.47736552 0.4765797  0.4760537
 0.47571188 0.47535124 0.4747696  0.47395742 0.47306368 0.47235838
 0.4718823  0.47154945 0.47108418 0.47047868 0.46962658 0.46870607
 0.46804532 0.46782202 0.46805874 0.46841452 0.46837065 0.46795496
 0.46726096 0.46670562 0.46660236 0.4669173  0.46727058 0.46724632
 0.46671999 0.4658985  0.4651785  0.46488374 0.46502012 0.4652402
 0.46501404 0.4640699  0.46280393 0.4617592  0.46139798 0.461651
 0.46182945 0.46146402 0.46044394 0.45943746 0.45994994 0.46114385]
