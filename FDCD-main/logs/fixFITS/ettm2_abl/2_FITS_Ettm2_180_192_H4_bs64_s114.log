Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2165751
	speed: 0.0741s/iter; left time: 1971.5809s
	iters: 200, epoch: 1 | loss: 0.3105901
	speed: 0.0743s/iter; left time: 1970.0279s
Epoch: 1 cost time: 19.350327968597412
Epoch: 1, Steps: 267 | Train Loss: 0.3318499 Vali Loss: 0.2181027 Test Loss: 0.2987974
Validation loss decreased (inf --> 0.218103).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2621916
	speed: 0.2674s/iter; left time: 7041.2191s
	iters: 200, epoch: 2 | loss: 0.1809965
	speed: 0.0597s/iter; left time: 1566.1839s
Epoch: 2 cost time: 16.28567624092102
Epoch: 2, Steps: 267 | Train Loss: 0.2467986 Vali Loss: 0.1954109 Test Loss: 0.2710388
Validation loss decreased (0.218103 --> 0.195411).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2279073
	speed: 0.2693s/iter; left time: 7020.1031s
	iters: 200, epoch: 3 | loss: 0.2107598
	speed: 0.0489s/iter; left time: 1268.5401s
Epoch: 3 cost time: 16.271777153015137
Epoch: 3, Steps: 267 | Train Loss: 0.2167954 Vali Loss: 0.1844938 Test Loss: 0.2584221
Validation loss decreased (0.195411 --> 0.184494).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1284952
	speed: 0.2281s/iter; left time: 5885.6377s
	iters: 200, epoch: 4 | loss: 0.1853078
	speed: 0.0576s/iter; left time: 1479.9013s
Epoch: 4 cost time: 15.481236457824707
Epoch: 4, Steps: 267 | Train Loss: 0.2023861 Vali Loss: 0.1782248 Test Loss: 0.2509166
Validation loss decreased (0.184494 --> 0.178225).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2838669
	speed: 0.1977s/iter; left time: 5047.9854s
	iters: 200, epoch: 5 | loss: 0.1432539
	speed: 0.0310s/iter; left time: 787.4080s
Epoch: 5 cost time: 9.878929615020752
Epoch: 5, Steps: 267 | Train Loss: 0.1938223 Vali Loss: 0.1740555 Test Loss: 0.2460360
Validation loss decreased (0.178225 --> 0.174056).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1433680
	speed: 0.1684s/iter; left time: 4253.9166s
	iters: 200, epoch: 6 | loss: 0.2670766
	speed: 0.0629s/iter; left time: 1582.1813s
Epoch: 6 cost time: 16.23124623298645
Epoch: 6, Steps: 267 | Train Loss: 0.1883112 Vali Loss: 0.1713294 Test Loss: 0.2426177
Validation loss decreased (0.174056 --> 0.171329).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2011417
	speed: 0.2854s/iter; left time: 7134.5963s
	iters: 200, epoch: 7 | loss: 0.1765588
	speed: 0.0643s/iter; left time: 1599.8666s
Epoch: 7 cost time: 17.7432804107666
Epoch: 7, Steps: 267 | Train Loss: 0.1845801 Vali Loss: 0.1696514 Test Loss: 0.2401175
Validation loss decreased (0.171329 --> 0.169651).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1669299
	speed: 0.2886s/iter; left time: 7136.7215s
	iters: 200, epoch: 8 | loss: 0.2133785
	speed: 0.0525s/iter; left time: 1292.7650s
Epoch: 8 cost time: 16.112812757492065
Epoch: 8, Steps: 267 | Train Loss: 0.1821145 Vali Loss: 0.1682728 Test Loss: 0.2385185
Validation loss decreased (0.169651 --> 0.168273).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1971972
	speed: 0.2430s/iter; left time: 5945.3423s
	iters: 200, epoch: 9 | loss: 0.1701453
	speed: 0.0525s/iter; left time: 1279.6740s
Epoch: 9 cost time: 14.071207284927368
Epoch: 9, Steps: 267 | Train Loss: 0.1804602 Vali Loss: 0.1676937 Test Loss: 0.2373856
Validation loss decreased (0.168273 --> 0.167694).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2527072
	speed: 0.2661s/iter; left time: 6438.2021s
	iters: 200, epoch: 10 | loss: 0.1810081
	speed: 0.0640s/iter; left time: 1543.1709s
Epoch: 10 cost time: 16.017738342285156
Epoch: 10, Steps: 267 | Train Loss: 0.1792132 Vali Loss: 0.1668674 Test Loss: 0.2365439
Validation loss decreased (0.167694 --> 0.166867).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1966993
	speed: 0.2638s/iter; left time: 6313.0252s
	iters: 200, epoch: 11 | loss: 0.1296920
	speed: 0.0577s/iter; left time: 1375.3052s
Epoch: 11 cost time: 16.502310752868652
Epoch: 11, Steps: 267 | Train Loss: 0.1786192 Vali Loss: 0.1666769 Test Loss: 0.2359509
Validation loss decreased (0.166867 --> 0.166677).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1682266
	speed: 0.2440s/iter; left time: 5774.4016s
	iters: 200, epoch: 12 | loss: 0.1711365
	speed: 0.0648s/iter; left time: 1527.2645s
Epoch: 12 cost time: 17.924062252044678
Epoch: 12, Steps: 267 | Train Loss: 0.1781821 Vali Loss: 0.1663898 Test Loss: 0.2356483
Validation loss decreased (0.166677 --> 0.166390).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1668169
	speed: 0.2587s/iter; left time: 6052.5457s
	iters: 200, epoch: 13 | loss: 0.2161769
	speed: 0.0647s/iter; left time: 1508.1166s
Epoch: 13 cost time: 17.001922130584717
Epoch: 13, Steps: 267 | Train Loss: 0.1779534 Vali Loss: 0.1659623 Test Loss: 0.2353998
Validation loss decreased (0.166390 --> 0.165962).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2679801
	speed: 0.2744s/iter; left time: 6346.6718s
	iters: 200, epoch: 14 | loss: 0.1610854
	speed: 0.0566s/iter; left time: 1304.5049s
Epoch: 14 cost time: 14.711271047592163
Epoch: 14, Steps: 267 | Train Loss: 0.1777786 Vali Loss: 0.1660626 Test Loss: 0.2352672
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1784674
	speed: 0.2511s/iter; left time: 5740.7174s
	iters: 200, epoch: 15 | loss: 0.2130286
	speed: 0.0587s/iter; left time: 1336.2861s
Epoch: 15 cost time: 17.3674533367157
Epoch: 15, Steps: 267 | Train Loss: 0.1775899 Vali Loss: 0.1658966 Test Loss: 0.2351895
Validation loss decreased (0.165962 --> 0.165897).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1382214
	speed: 0.2499s/iter; left time: 5645.7276s
	iters: 200, epoch: 16 | loss: 0.1439613
	speed: 0.0615s/iter; left time: 1383.7444s
Epoch: 16 cost time: 16.362245559692383
Epoch: 16, Steps: 267 | Train Loss: 0.1776024 Vali Loss: 0.1659891 Test Loss: 0.2350708
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1578254
	speed: 0.2283s/iter; left time: 5096.8273s
	iters: 200, epoch: 17 | loss: 0.1283099
	speed: 0.0513s/iter; left time: 1140.0367s
Epoch: 17 cost time: 13.758285760879517
Epoch: 17, Steps: 267 | Train Loss: 0.1775307 Vali Loss: 0.1658754 Test Loss: 0.2351178
Validation loss decreased (0.165897 --> 0.165875).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2399925
	speed: 0.1576s/iter; left time: 3476.4482s
	iters: 200, epoch: 18 | loss: 0.1959377
	speed: 0.0357s/iter; left time: 783.8072s
Epoch: 18 cost time: 11.771936416625977
Epoch: 18, Steps: 267 | Train Loss: 0.1774774 Vali Loss: 0.1657110 Test Loss: 0.2349557
Validation loss decreased (0.165875 --> 0.165711).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1241059
	speed: 0.2527s/iter; left time: 5507.7035s
	iters: 200, epoch: 19 | loss: 0.1381053
	speed: 0.0634s/iter; left time: 1376.2156s
Epoch: 19 cost time: 17.680456399917603
Epoch: 19, Steps: 267 | Train Loss: 0.1774310 Vali Loss: 0.1658154 Test Loss: 0.2349533
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1497615
	speed: 0.2649s/iter; left time: 5702.7889s
	iters: 200, epoch: 20 | loss: 0.1894740
	speed: 0.0617s/iter; left time: 1322.0539s
Epoch: 20 cost time: 16.526806116104126
Epoch: 20, Steps: 267 | Train Loss: 0.1774310 Vali Loss: 0.1658464 Test Loss: 0.2349994
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2063981
	speed: 0.2907s/iter; left time: 6180.4463s
	iters: 200, epoch: 21 | loss: 0.1733095
	speed: 0.0621s/iter; left time: 1314.6393s
Epoch: 21 cost time: 17.28160047531128
Epoch: 21, Steps: 267 | Train Loss: 0.1774291 Vali Loss: 0.1659731 Test Loss: 0.2349110
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2364144
	speed: 0.2270s/iter; left time: 4765.2096s
	iters: 200, epoch: 22 | loss: 0.2092035
	speed: 0.0418s/iter; left time: 873.3966s
Epoch: 22 cost time: 12.609793424606323
Epoch: 22, Steps: 267 | Train Loss: 0.1774110 Vali Loss: 0.1657903 Test Loss: 0.2348569
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2074286
	speed: 0.2823s/iter; left time: 5851.8105s
	iters: 200, epoch: 23 | loss: 0.1595966
	speed: 0.0535s/iter; left time: 1103.6711s
Epoch: 23 cost time: 16.829622268676758
Epoch: 23, Steps: 267 | Train Loss: 0.1773940 Vali Loss: 0.1657789 Test Loss: 0.2348687
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2127841
	speed: 0.2316s/iter; left time: 4738.3937s
	iters: 200, epoch: 24 | loss: 0.1501629
	speed: 0.0461s/iter; left time: 938.2545s
Epoch: 24 cost time: 13.34017562866211
Epoch: 24, Steps: 267 | Train Loss: 0.1773764 Vali Loss: 0.1658061 Test Loss: 0.2348342
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2349942
	speed: 0.2754s/iter; left time: 5560.4246s
	iters: 200, epoch: 25 | loss: 0.1612781
	speed: 0.0627s/iter; left time: 1260.1282s
Epoch: 25 cost time: 17.265950918197632
Epoch: 25, Steps: 267 | Train Loss: 0.1773347 Vali Loss: 0.1658638 Test Loss: 0.2348523
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1810695
	speed: 0.2523s/iter; left time: 5028.1313s
	iters: 200, epoch: 26 | loss: 0.2123527
	speed: 0.0538s/iter; left time: 1066.6071s
Epoch: 26 cost time: 13.998706340789795
Epoch: 26, Steps: 267 | Train Loss: 0.1773498 Vali Loss: 0.1660250 Test Loss: 0.2348363
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1521998
	speed: 0.2886s/iter; left time: 5672.7710s
	iters: 200, epoch: 27 | loss: 0.2081702
	speed: 0.0491s/iter; left time: 960.3977s
Epoch: 27 cost time: 13.69139552116394
Epoch: 27, Steps: 267 | Train Loss: 0.1773554 Vali Loss: 0.1659189 Test Loss: 0.2348086
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1780768
	speed: 0.1630s/iter; left time: 3160.8856s
	iters: 200, epoch: 28 | loss: 0.1534848
	speed: 0.0491s/iter; left time: 947.5075s
Epoch: 28 cost time: 14.630115270614624
Epoch: 28, Steps: 267 | Train Loss: 0.1773410 Vali Loss: 0.1658593 Test Loss: 0.2348171
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1284842
	speed: 0.1967s/iter; left time: 3761.6305s
	iters: 200, epoch: 29 | loss: 0.2080628
	speed: 0.0558s/iter; left time: 1061.0058s
Epoch: 29 cost time: 14.825433731079102
Epoch: 29, Steps: 267 | Train Loss: 0.1773367 Vali Loss: 0.1658996 Test Loss: 0.2348106
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1772338
	speed: 0.2405s/iter; left time: 4535.1780s
	iters: 200, epoch: 30 | loss: 0.1530359
	speed: 0.0582s/iter; left time: 1091.7220s
Epoch: 30 cost time: 14.87260103225708
Epoch: 30, Steps: 267 | Train Loss: 0.1773323 Vali Loss: 0.1658989 Test Loss: 0.2348093
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1747285
	speed: 0.2747s/iter; left time: 5107.3984s
	iters: 200, epoch: 31 | loss: 0.1858459
	speed: 0.0595s/iter; left time: 1100.5452s
Epoch: 31 cost time: 16.582343101501465
Epoch: 31, Steps: 267 | Train Loss: 0.1772669 Vali Loss: 0.1660557 Test Loss: 0.2348288
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1829045
	speed: 0.2961s/iter; left time: 5425.9193s
	iters: 200, epoch: 32 | loss: 0.2260106
	speed: 0.0484s/iter; left time: 881.8147s
Epoch: 32 cost time: 14.778254985809326
Epoch: 32, Steps: 267 | Train Loss: 0.1771533 Vali Loss: 0.1658000 Test Loss: 0.2348009
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1340880
	speed: 0.2395s/iter; left time: 4324.1720s
	iters: 200, epoch: 33 | loss: 0.1319015
	speed: 0.0659s/iter; left time: 1183.7293s
Epoch: 33 cost time: 17.612178564071655
Epoch: 33, Steps: 267 | Train Loss: 0.1772823 Vali Loss: 0.1659805 Test Loss: 0.2347835
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1802407
	speed: 0.2605s/iter; left time: 4634.2834s
	iters: 200, epoch: 34 | loss: 0.2256597
	speed: 0.0644s/iter; left time: 1139.7443s
Epoch: 34 cost time: 17.381248474121094
Epoch: 34, Steps: 267 | Train Loss: 0.1773120 Vali Loss: 0.1658385 Test Loss: 0.2347892
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1769535
	speed: 0.2468s/iter; left time: 4325.2471s
	iters: 200, epoch: 35 | loss: 0.1767027
	speed: 0.0573s/iter; left time: 999.1360s
Epoch: 35 cost time: 14.858046531677246
Epoch: 35, Steps: 267 | Train Loss: 0.1773056 Vali Loss: 0.1659462 Test Loss: 0.2347999
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2183058
	speed: 0.1809s/iter; left time: 3120.7506s
	iters: 200, epoch: 36 | loss: 0.1465689
	speed: 0.0309s/iter; left time: 529.5025s
Epoch: 36 cost time: 10.062097549438477
Epoch: 36, Steps: 267 | Train Loss: 0.1772036 Vali Loss: 0.1659781 Test Loss: 0.2347811
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2233886
	speed: 0.2235s/iter; left time: 3797.6386s
	iters: 200, epoch: 37 | loss: 0.1853225
	speed: 0.0627s/iter; left time: 1058.8824s
Epoch: 37 cost time: 17.2910897731781
Epoch: 37, Steps: 267 | Train Loss: 0.1772608 Vali Loss: 0.1658935 Test Loss: 0.2348061
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2270573
	speed: 0.2663s/iter; left time: 4453.2623s
	iters: 200, epoch: 38 | loss: 0.1731008
	speed: 0.0603s/iter; left time: 1002.9013s
Epoch: 38 cost time: 18.23548674583435
Epoch: 38, Steps: 267 | Train Loss: 0.1772282 Vali Loss: 0.1657961 Test Loss: 0.2347786
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4089993
	speed: 0.0691s/iter; left time: 1839.0375s
	iters: 200, epoch: 1 | loss: 0.2472704
	speed: 0.0654s/iter; left time: 1733.2099s
Epoch: 1 cost time: 18.366074800491333
Epoch: 1, Steps: 267 | Train Loss: 0.3247549 Vali Loss: 0.1652735 Test Loss: 0.2340932
Validation loss decreased (inf --> 0.165274).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4539429
	speed: 0.2596s/iter; left time: 6836.9041s
	iters: 200, epoch: 2 | loss: 0.3569579
	speed: 0.0582s/iter; left time: 1528.1180s
Epoch: 2 cost time: 16.408637046813965
Epoch: 2, Steps: 267 | Train Loss: 0.3239958 Vali Loss: 0.1652645 Test Loss: 0.2339144
Validation loss decreased (0.165274 --> 0.165265).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2283797
	speed: 0.2541s/iter; left time: 6622.6658s
	iters: 200, epoch: 3 | loss: 0.4446383
	speed: 0.0538s/iter; left time: 1397.0625s
Epoch: 3 cost time: 14.783103227615356
Epoch: 3, Steps: 267 | Train Loss: 0.3236795 Vali Loss: 0.1648966 Test Loss: 0.2337870
Validation loss decreased (0.165265 --> 0.164897).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2729710
	speed: 0.2188s/iter; left time: 5645.4545s
	iters: 200, epoch: 4 | loss: 0.2694441
	speed: 0.0539s/iter; left time: 1385.0435s
Epoch: 4 cost time: 17.247998476028442
Epoch: 4, Steps: 267 | Train Loss: 0.3234790 Vali Loss: 0.1650888 Test Loss: 0.2336877
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2684993
	speed: 0.3005s/iter; left time: 7672.5105s
	iters: 200, epoch: 5 | loss: 0.2994054
	speed: 0.0685s/iter; left time: 1742.3332s
Epoch: 5 cost time: 17.909841299057007
Epoch: 5, Steps: 267 | Train Loss: 0.3232615 Vali Loss: 0.1651370 Test Loss: 0.2334935
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4079804
	speed: 0.2751s/iter; left time: 6950.4409s
	iters: 200, epoch: 6 | loss: 0.3037479
	speed: 0.0589s/iter; left time: 1481.4329s
Epoch: 6 cost time: 16.79718780517578
Epoch: 6, Steps: 267 | Train Loss: 0.3231482 Vali Loss: 0.1650799 Test Loss: 0.2334979
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4239280
	speed: 0.2966s/iter; left time: 7414.6257s
	iters: 200, epoch: 7 | loss: 0.3542488
	speed: 0.0664s/iter; left time: 1652.2857s
Epoch: 7 cost time: 17.913484811782837
Epoch: 7, Steps: 267 | Train Loss: 0.3230256 Vali Loss: 0.1650358 Test Loss: 0.2334568
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4209715
	speed: 0.2289s/iter; left time: 5660.0418s
	iters: 200, epoch: 8 | loss: 0.3369558
	speed: 0.0575s/iter; left time: 1417.3583s
Epoch: 8 cost time: 15.329115629196167
Epoch: 8, Steps: 267 | Train Loss: 0.3229259 Vali Loss: 0.1651164 Test Loss: 0.2335051
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2584703
	speed: 0.2948s/iter; left time: 7212.3478s
	iters: 200, epoch: 9 | loss: 0.2593568
	speed: 0.0687s/iter; left time: 1673.8413s
Epoch: 9 cost time: 17.799439430236816
Epoch: 9, Steps: 267 | Train Loss: 0.3229033 Vali Loss: 0.1649248 Test Loss: 0.2334965
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2975108
	speed: 0.1951s/iter; left time: 4720.4382s
	iters: 200, epoch: 10 | loss: 0.3126903
	speed: 0.0635s/iter; left time: 1530.2122s
Epoch: 10 cost time: 16.49824070930481
Epoch: 10, Steps: 267 | Train Loss: 0.3228354 Vali Loss: 0.1650572 Test Loss: 0.2335006
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2284004
	speed: 0.2992s/iter; left time: 7160.1995s
	iters: 200, epoch: 11 | loss: 0.2832540
	speed: 0.0633s/iter; left time: 1508.8424s
Epoch: 11 cost time: 17.675323247909546
Epoch: 11, Steps: 267 | Train Loss: 0.3227405 Vali Loss: 0.1650804 Test Loss: 0.2335044
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2423198
	speed: 0.3178s/iter; left time: 7519.8686s
	iters: 200, epoch: 12 | loss: 0.2972118
	speed: 0.0738s/iter; left time: 1739.2045s
Epoch: 12 cost time: 19.97175908088684
Epoch: 12, Steps: 267 | Train Loss: 0.3227378 Vali Loss: 0.1650526 Test Loss: 0.2334314
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3419493
	speed: 0.3049s/iter; left time: 7134.0855s
	iters: 200, epoch: 13 | loss: 0.4663694
	speed: 0.0614s/iter; left time: 1431.5186s
Epoch: 13 cost time: 17.00379967689514
Epoch: 13, Steps: 267 | Train Loss: 0.3226406 Vali Loss: 0.1651088 Test Loss: 0.2334055
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3770779
	speed: 0.2789s/iter; left time: 6450.9117s
	iters: 200, epoch: 14 | loss: 0.2716349
	speed: 0.0590s/iter; left time: 1359.6336s
Epoch: 14 cost time: 16.747519493103027
Epoch: 14, Steps: 267 | Train Loss: 0.3226664 Vali Loss: 0.1650072 Test Loss: 0.2334333
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3114327
	speed: 0.2658s/iter; left time: 6075.9374s
	iters: 200, epoch: 15 | loss: 0.2939920
	speed: 0.0681s/iter; left time: 1550.2472s
Epoch: 15 cost time: 17.98273730278015
Epoch: 15, Steps: 267 | Train Loss: 0.3226127 Vali Loss: 0.1650149 Test Loss: 0.2334337
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3927665
	speed: 0.3002s/iter; left time: 6782.6214s
	iters: 200, epoch: 16 | loss: 0.3180278
	speed: 0.0676s/iter; left time: 1520.6944s
Epoch: 16 cost time: 18.916677951812744
Epoch: 16, Steps: 267 | Train Loss: 0.3225714 Vali Loss: 0.1650125 Test Loss: 0.2334325
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3504772
	speed: 0.3099s/iter; left time: 6919.3739s
	iters: 200, epoch: 17 | loss: 0.3063310
	speed: 0.0687s/iter; left time: 1527.1450s
Epoch: 17 cost time: 19.20016360282898
Epoch: 17, Steps: 267 | Train Loss: 0.3225485 Vali Loss: 0.1649518 Test Loss: 0.2333897
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.4368918
	speed: 0.2940s/iter; left time: 6487.1429s
	iters: 200, epoch: 18 | loss: 0.3289885
	speed: 0.0624s/iter; left time: 1369.5713s
Epoch: 18 cost time: 16.390311002731323
Epoch: 18, Steps: 267 | Train Loss: 0.3225538 Vali Loss: 0.1650751 Test Loss: 0.2333494
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2277129
	speed: 0.2452s/iter; left time: 5345.1353s
	iters: 200, epoch: 19 | loss: 0.3580797
	speed: 0.0652s/iter; left time: 1415.1051s
Epoch: 19 cost time: 16.686501502990723
Epoch: 19, Steps: 267 | Train Loss: 0.3224950 Vali Loss: 0.1651962 Test Loss: 0.2333770
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2909991
	speed: 0.3031s/iter; left time: 6525.0221s
	iters: 200, epoch: 20 | loss: 0.3235561
	speed: 0.0694s/iter; left time: 1487.7961s
Epoch: 20 cost time: 19.500675916671753
Epoch: 20, Steps: 267 | Train Loss: 0.3224630 Vali Loss: 0.1649829 Test Loss: 0.2333854
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3403961
	speed: 0.2856s/iter; left time: 6073.0032s
	iters: 200, epoch: 21 | loss: 0.2960250
	speed: 0.0579s/iter; left time: 1225.0007s
Epoch: 21 cost time: 16.173398971557617
Epoch: 21, Steps: 267 | Train Loss: 0.3224514 Vali Loss: 0.1649829 Test Loss: 0.2333404
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4445662
	speed: 0.3026s/iter; left time: 6353.8120s
	iters: 200, epoch: 22 | loss: 0.4628776
	speed: 0.0715s/iter; left time: 1493.6316s
Epoch: 22 cost time: 19.22712993621826
Epoch: 22, Steps: 267 | Train Loss: 0.3224629 Vali Loss: 0.1652617 Test Loss: 0.2334187
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3047222
	speed: 0.3107s/iter; left time: 6440.3293s
	iters: 200, epoch: 23 | loss: 0.3948575
	speed: 0.0720s/iter; left time: 1485.1822s
Epoch: 23 cost time: 19.76520800590515
Epoch: 23, Steps: 267 | Train Loss: 0.3224706 Vali Loss: 0.1650459 Test Loss: 0.2334082
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.23457248508930206, mae:0.2981473207473755, rse:0.39204293489456177, corr:[0.56149113 0.5644274  0.5652303  0.56420255 0.562091   0.5597195
 0.5577845  0.55662006 0.55623114 0.55639195 0.5567092  0.5568457
 0.5565838  0.55586094 0.5548861  0.5538614  0.5529775  0.5523123
 0.55187553 0.55155605 0.55124307 0.5508169  0.5502129  0.54946786
 0.5486677  0.5478963  0.5472619  0.54677916 0.546415   0.54608846
 0.545745   0.54536223 0.544867   0.5442394  0.54347706 0.54267734
 0.54189014 0.54120237 0.5406317  0.540149   0.53973824 0.53935355
 0.53892636 0.53840864 0.5377743  0.5370923  0.53640264 0.5357458
 0.53511417 0.5344847  0.5338285  0.5331529  0.5324196  0.53162366
 0.53084415 0.53021413 0.52975154 0.52949375 0.52937883 0.52934873
 0.52927625 0.52914494 0.52892905 0.52860796 0.5282357  0.5279238
 0.5276993  0.52759427 0.5275896  0.5276452  0.527662   0.5275857
 0.527414   0.52710885 0.5267658  0.52640396 0.5260748  0.5257523
 0.52545285 0.52514213 0.5247864  0.5243398  0.5238389  0.5233001
 0.5227471  0.5222584  0.52181625 0.5214873  0.5212339  0.5209856
 0.52067494 0.52024496 0.5195704  0.51860887 0.51734716 0.51582175
 0.51412594 0.5124923  0.5109943  0.5095931  0.508244   0.5069078
 0.505582   0.50429356 0.50303143 0.5018616  0.50083286 0.499954
 0.49909905 0.49802455 0.49681357 0.49548176 0.4941991  0.49305364
 0.4920484  0.4912023  0.49044654 0.48968896 0.48887572 0.48790854
 0.48681524 0.48568857 0.48465922 0.48375353 0.48294866 0.48220268
 0.48143014 0.48061633 0.47976378 0.47884357 0.47790736 0.47696474
 0.47607967 0.47523472 0.47454754 0.4740649  0.47370967 0.47348478
 0.47324625 0.47288096 0.47231287 0.47152752 0.4706075  0.46959767
 0.46857652 0.46762332 0.46674109 0.46598276 0.46538395 0.464831
 0.46429262 0.4638318  0.46338618 0.462969   0.46257132 0.4621999
 0.46185303 0.4615275  0.46110168 0.46062723 0.46012852 0.45966235
 0.45934513 0.45912406 0.4591253  0.45926556 0.45945638 0.4596623
 0.45981687 0.4599301  0.4599875  0.4599993  0.46002805 0.45997745
 0.45991325 0.45981157 0.45974234 0.45970398 0.45966238 0.45963398
 0.4594856  0.45916042 0.45882702 0.4585486  0.45845556 0.45849153
 0.45867613 0.45897844 0.45915782 0.45889193 0.4577322  0.45526183]
