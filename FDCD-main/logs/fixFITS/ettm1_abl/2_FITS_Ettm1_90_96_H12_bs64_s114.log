Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_96_FITS_ETTm1_ftM_sl90_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4778074
	speed: 0.0413s/iter; left time: 1101.7918s
	iters: 200, epoch: 1 | loss: 0.3935245
	speed: 0.0162s/iter; left time: 429.8263s
Epoch: 1 cost time: 6.885717868804932
Epoch: 1, Steps: 268 | Train Loss: 0.4699160 Vali Loss: 0.8412110 Test Loss: 0.7599855
Validation loss decreased (inf --> 0.841211).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3183241
	speed: 0.1290s/iter; left time: 3409.4692s
	iters: 200, epoch: 2 | loss: 0.3309999
	speed: 0.0226s/iter; left time: 593.8524s
Epoch: 2 cost time: 6.102798938751221
Epoch: 2, Steps: 268 | Train Loss: 0.3251942 Vali Loss: 0.7269148 Test Loss: 0.6478214
Validation loss decreased (0.841211 --> 0.726915).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2611908
	speed: 0.1043s/iter; left time: 2730.1028s
	iters: 200, epoch: 3 | loss: 0.2527590
	speed: 0.0172s/iter; left time: 447.5813s
Epoch: 3 cost time: 5.620342493057251
Epoch: 3, Steps: 268 | Train Loss: 0.2756075 Vali Loss: 0.6494035 Test Loss: 0.5726762
Validation loss decreased (0.726915 --> 0.649403).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2709499
	speed: 0.1019s/iter; left time: 2639.2068s
	iters: 200, epoch: 4 | loss: 0.2442090
	speed: 0.0261s/iter; left time: 672.8081s
Epoch: 4 cost time: 6.983747959136963
Epoch: 4, Steps: 268 | Train Loss: 0.2470721 Vali Loss: 0.5917004 Test Loss: 0.5179906
Validation loss decreased (0.649403 --> 0.591700).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2226225
	speed: 0.0833s/iter; left time: 2135.8371s
	iters: 200, epoch: 5 | loss: 0.2289035
	speed: 0.0163s/iter; left time: 416.7512s
Epoch: 5 cost time: 4.9200520515441895
Epoch: 5, Steps: 268 | Train Loss: 0.2273921 Vali Loss: 0.5467563 Test Loss: 0.4759274
Validation loss decreased (0.591700 --> 0.546756).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2050529
	speed: 0.1037s/iter; left time: 2628.9067s
	iters: 200, epoch: 6 | loss: 0.2219024
	speed: 0.0194s/iter; left time: 491.0946s
Epoch: 6 cost time: 8.588799715042114
Epoch: 6, Steps: 268 | Train Loss: 0.2135862 Vali Loss: 0.5150862 Test Loss: 0.4460641
Validation loss decreased (0.546756 --> 0.515086).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1958959
	speed: 0.1378s/iter; left time: 3458.1819s
	iters: 200, epoch: 7 | loss: 0.1977628
	speed: 0.0172s/iter; left time: 429.0346s
Epoch: 7 cost time: 5.08760404586792
Epoch: 7, Steps: 268 | Train Loss: 0.2040557 Vali Loss: 0.4902458 Test Loss: 0.4234462
Validation loss decreased (0.515086 --> 0.490246).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1812747
	speed: 0.1370s/iter; left time: 3401.0953s
	iters: 200, epoch: 8 | loss: 0.2038403
	speed: 0.0159s/iter; left time: 394.2260s
Epoch: 8 cost time: 6.517237186431885
Epoch: 8, Steps: 268 | Train Loss: 0.1974838 Vali Loss: 0.4713491 Test Loss: 0.4058358
Validation loss decreased (0.490246 --> 0.471349).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1820689
	speed: 0.1150s/iter; left time: 2824.9538s
	iters: 200, epoch: 9 | loss: 0.1948751
	speed: 0.0395s/iter; left time: 965.6365s
Epoch: 9 cost time: 10.064088344573975
Epoch: 9, Steps: 268 | Train Loss: 0.1931265 Vali Loss: 0.4589550 Test Loss: 0.3946700
Validation loss decreased (0.471349 --> 0.458955).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1958186
	speed: 0.1181s/iter; left time: 2868.4803s
	iters: 200, epoch: 10 | loss: 0.2093281
	speed: 0.0387s/iter; left time: 936.3059s
Epoch: 10 cost time: 9.735147476196289
Epoch: 10, Steps: 268 | Train Loss: 0.1902376 Vali Loss: 0.4475519 Test Loss: 0.3848312
Validation loss decreased (0.458955 --> 0.447552).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1804421
	speed: 0.1366s/iter; left time: 3280.2818s
	iters: 200, epoch: 11 | loss: 0.1690084
	speed: 0.0265s/iter; left time: 634.9310s
Epoch: 11 cost time: 8.89192819595337
Epoch: 11, Steps: 268 | Train Loss: 0.1884262 Vali Loss: 0.4398266 Test Loss: 0.3778276
Validation loss decreased (0.447552 --> 0.439827).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1828687
	speed: 0.0959s/iter; left time: 2277.5002s
	iters: 200, epoch: 12 | loss: 0.1876046
	speed: 0.0176s/iter; left time: 416.9185s
Epoch: 12 cost time: 5.230416774749756
Epoch: 12, Steps: 268 | Train Loss: 0.1873118 Vali Loss: 0.4347571 Test Loss: 0.3735224
Validation loss decreased (0.439827 --> 0.434757).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1825251
	speed: 0.1079s/iter; left time: 2533.5184s
	iters: 200, epoch: 13 | loss: 0.1855859
	speed: 0.0346s/iter; left time: 809.8244s
Epoch: 13 cost time: 10.097686290740967
Epoch: 13, Steps: 268 | Train Loss: 0.1865800 Vali Loss: 0.4307952 Test Loss: 0.3703169
Validation loss decreased (0.434757 --> 0.430795).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1694864
	speed: 0.1386s/iter; left time: 3216.8153s
	iters: 200, epoch: 14 | loss: 0.1845879
	speed: 0.0312s/iter; left time: 721.2505s
Epoch: 14 cost time: 8.173354148864746
Epoch: 14, Steps: 268 | Train Loss: 0.1863277 Vali Loss: 0.4274687 Test Loss: 0.3676755
Validation loss decreased (0.430795 --> 0.427469).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1702937
	speed: 0.1682s/iter; left time: 3860.2945s
	iters: 200, epoch: 15 | loss: 0.1671584
	speed: 0.0379s/iter; left time: 865.2486s
Epoch: 15 cost time: 9.838631629943848
Epoch: 15, Steps: 268 | Train Loss: 0.1860996 Vali Loss: 0.4254017 Test Loss: 0.3660721
Validation loss decreased (0.427469 --> 0.425402).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1892612
	speed: 0.1274s/iter; left time: 2889.1664s
	iters: 200, epoch: 16 | loss: 0.1839576
	speed: 0.0157s/iter; left time: 353.8901s
Epoch: 16 cost time: 6.091749429702759
Epoch: 16, Steps: 268 | Train Loss: 0.1859941 Vali Loss: 0.4236882 Test Loss: 0.3648355
Validation loss decreased (0.425402 --> 0.423688).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1944941
	speed: 0.0927s/iter; left time: 2078.2414s
	iters: 200, epoch: 17 | loss: 0.1924259
	speed: 0.0160s/iter; left time: 356.8292s
Epoch: 17 cost time: 5.701186418533325
Epoch: 17, Steps: 268 | Train Loss: 0.1859474 Vali Loss: 0.4235864 Test Loss: 0.3645446
Validation loss decreased (0.423688 --> 0.423586).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1944484
	speed: 0.1118s/iter; left time: 2475.6059s
	iters: 200, epoch: 18 | loss: 0.1918348
	speed: 0.0201s/iter; left time: 442.8014s
Epoch: 18 cost time: 7.026118755340576
Epoch: 18, Steps: 268 | Train Loss: 0.1859414 Vali Loss: 0.4227988 Test Loss: 0.3638847
Validation loss decreased (0.423586 --> 0.422799).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1727606
	speed: 0.0961s/iter; left time: 2102.5899s
	iters: 200, epoch: 19 | loss: 0.2005126
	speed: 0.0258s/iter; left time: 561.3329s
Epoch: 19 cost time: 7.04682469367981
Epoch: 19, Steps: 268 | Train Loss: 0.1859182 Vali Loss: 0.4224112 Test Loss: 0.3633354
Validation loss decreased (0.422799 --> 0.422411).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1847011
	speed: 0.1208s/iter; left time: 2609.6425s
	iters: 200, epoch: 20 | loss: 0.1730390
	speed: 0.0286s/iter; left time: 615.7067s
Epoch: 20 cost time: 8.04753041267395
Epoch: 20, Steps: 268 | Train Loss: 0.1858682 Vali Loss: 0.4223069 Test Loss: 0.3635985
Validation loss decreased (0.422411 --> 0.422307).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1783455
	speed: 0.1168s/iter; left time: 2492.1182s
	iters: 200, epoch: 21 | loss: 0.1818504
	speed: 0.0236s/iter; left time: 500.5902s
Epoch: 21 cost time: 5.908133268356323
Epoch: 21, Steps: 268 | Train Loss: 0.1858855 Vali Loss: 0.4218590 Test Loss: 0.3633237
Validation loss decreased (0.422307 --> 0.421859).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1745805
	speed: 0.1175s/iter; left time: 2475.6876s
	iters: 200, epoch: 22 | loss: 0.1798595
	speed: 0.0201s/iter; left time: 420.6222s
Epoch: 22 cost time: 5.46040940284729
Epoch: 22, Steps: 268 | Train Loss: 0.1858841 Vali Loss: 0.4217033 Test Loss: 0.3631938
Validation loss decreased (0.421859 --> 0.421703).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1781851
	speed: 0.0967s/iter; left time: 2012.6057s
	iters: 200, epoch: 23 | loss: 0.1779762
	speed: 0.0159s/iter; left time: 329.5894s
Epoch: 23 cost time: 5.6328771114349365
Epoch: 23, Steps: 268 | Train Loss: 0.1859160 Vali Loss: 0.4217807 Test Loss: 0.3631320
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1842643
	speed: 0.1102s/iter; left time: 2264.0931s
	iters: 200, epoch: 24 | loss: 0.2063109
	speed: 0.0171s/iter; left time: 348.4774s
Epoch: 24 cost time: 6.181677579879761
Epoch: 24, Steps: 268 | Train Loss: 0.1859189 Vali Loss: 0.4214682 Test Loss: 0.3631438
Validation loss decreased (0.421703 --> 0.421468).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1984881
	speed: 0.1026s/iter; left time: 2080.0500s
	iters: 200, epoch: 25 | loss: 0.2037762
	speed: 0.0241s/iter; left time: 487.0159s
Epoch: 25 cost time: 6.755979776382446
Epoch: 25, Steps: 268 | Train Loss: 0.1857800 Vali Loss: 0.4211932 Test Loss: 0.3631206
Validation loss decreased (0.421468 --> 0.421193).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1982822
	speed: 0.1420s/iter; left time: 2840.8779s
	iters: 200, epoch: 26 | loss: 0.1822444
	speed: 0.0195s/iter; left time: 388.2605s
Epoch: 26 cost time: 5.3549745082855225
Epoch: 26, Steps: 268 | Train Loss: 0.1858608 Vali Loss: 0.4211079 Test Loss: 0.3629458
Validation loss decreased (0.421193 --> 0.421108).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1812586
	speed: 0.1167s/iter; left time: 2302.2927s
	iters: 200, epoch: 27 | loss: 0.1834522
	speed: 0.0248s/iter; left time: 487.5635s
Epoch: 27 cost time: 9.031760215759277
Epoch: 27, Steps: 268 | Train Loss: 0.1858574 Vali Loss: 0.4222011 Test Loss: 0.3633051
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1785984
	speed: 0.1492s/iter; left time: 2904.6022s
	iters: 200, epoch: 28 | loss: 0.1894605
	speed: 0.0174s/iter; left time: 337.9046s
Epoch: 28 cost time: 6.922403335571289
Epoch: 28, Steps: 268 | Train Loss: 0.1859160 Vali Loss: 0.4219326 Test Loss: 0.3632601
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1795973
	speed: 0.1298s/iter; left time: 2492.2027s
	iters: 200, epoch: 29 | loss: 0.1951412
	speed: 0.0343s/iter; left time: 654.2743s
Epoch: 29 cost time: 11.534335851669312
Epoch: 29, Steps: 268 | Train Loss: 0.1858934 Vali Loss: 0.4219795 Test Loss: 0.3631099
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1914997
	speed: 0.1186s/iter; left time: 2245.1472s
	iters: 200, epoch: 30 | loss: 0.2045877
	speed: 0.0169s/iter; left time: 319.0796s
Epoch: 30 cost time: 5.994577407836914
Epoch: 30, Steps: 268 | Train Loss: 0.1858640 Vali Loss: 0.4217295 Test Loss: 0.3632868
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1816083
	speed: 0.0913s/iter; left time: 1704.2680s
	iters: 200, epoch: 31 | loss: 0.1997253
	speed: 0.0179s/iter; left time: 332.6172s
Epoch: 31 cost time: 5.549987554550171
Epoch: 31, Steps: 268 | Train Loss: 0.1858852 Vali Loss: 0.4216403 Test Loss: 0.3633947
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1928336
	speed: 0.1044s/iter; left time: 1919.3255s
	iters: 200, epoch: 32 | loss: 0.1817738
	speed: 0.0202s/iter; left time: 368.9053s
Epoch: 32 cost time: 5.930906534194946
Epoch: 32, Steps: 268 | Train Loss: 0.1858621 Vali Loss: 0.4217186 Test Loss: 0.3634079
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2007312
	speed: 0.1034s/iter; left time: 1874.7765s
	iters: 200, epoch: 33 | loss: 0.1773480
	speed: 0.0208s/iter; left time: 375.1411s
Epoch: 33 cost time: 6.799511909484863
Epoch: 33, Steps: 268 | Train Loss: 0.1858609 Vali Loss: 0.4214360 Test Loss: 0.3634636
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2010927
	speed: 0.1149s/iter; left time: 2051.3778s
	iters: 200, epoch: 34 | loss: 0.1861798
	speed: 0.0365s/iter; left time: 648.2085s
Epoch: 34 cost time: 7.676786422729492
Epoch: 34, Steps: 268 | Train Loss: 0.1858020 Vali Loss: 0.4216498 Test Loss: 0.3632930
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2024036
	speed: 0.1175s/iter; left time: 2067.0920s
	iters: 200, epoch: 35 | loss: 0.2094515
	speed: 0.0193s/iter; left time: 338.3167s
Epoch: 35 cost time: 6.611755609512329
Epoch: 35, Steps: 268 | Train Loss: 0.1858861 Vali Loss: 0.4219956 Test Loss: 0.3633408
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1875662
	speed: 0.0943s/iter; left time: 1632.9158s
	iters: 200, epoch: 36 | loss: 0.1915970
	speed: 0.0228s/iter; left time: 392.8126s
Epoch: 36 cost time: 5.524858236312866
Epoch: 36, Steps: 268 | Train Loss: 0.1858444 Vali Loss: 0.4216867 Test Loss: 0.3632824
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1893010
	speed: 0.0929s/iter; left time: 1584.5005s
	iters: 200, epoch: 37 | loss: 0.1828402
	speed: 0.0160s/iter; left time: 272.0834s
Epoch: 37 cost time: 5.763388156890869
Epoch: 37, Steps: 268 | Train Loss: 0.1858025 Vali Loss: 0.4221216 Test Loss: 0.3634228
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1878157
	speed: 0.0998s/iter; left time: 1675.0734s
	iters: 200, epoch: 38 | loss: 0.1669528
	speed: 0.0207s/iter; left time: 345.6178s
Epoch: 38 cost time: 5.819112777709961
Epoch: 38, Steps: 268 | Train Loss: 0.1858611 Vali Loss: 0.4217964 Test Loss: 0.3635588
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2061535
	speed: 0.0842s/iter; left time: 1391.1722s
	iters: 200, epoch: 39 | loss: 0.1909154
	speed: 0.0182s/iter; left time: 298.6458s
Epoch: 39 cost time: 5.009401798248291
Epoch: 39, Steps: 268 | Train Loss: 0.1858408 Vali Loss: 0.4220399 Test Loss: 0.3634396
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1910875
	speed: 0.1210s/iter; left time: 1965.3809s
	iters: 200, epoch: 40 | loss: 0.1873796
	speed: 0.0262s/iter; left time: 422.6737s
Epoch: 40 cost time: 6.509387731552124
Epoch: 40, Steps: 268 | Train Loss: 0.1858959 Vali Loss: 0.4220698 Test Loss: 0.3634689
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1993648
	speed: 0.1344s/iter; left time: 2147.2691s
	iters: 200, epoch: 41 | loss: 0.1887292
	speed: 0.0308s/iter; left time: 488.9616s
Epoch: 41 cost time: 9.598437070846558
Epoch: 41, Steps: 268 | Train Loss: 0.1858530 Vali Loss: 0.4215894 Test Loss: 0.3633633
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1836118
	speed: 0.1371s/iter; left time: 2154.2802s
	iters: 200, epoch: 42 | loss: 0.2008529
	speed: 0.0313s/iter; left time: 488.8137s
Epoch: 42 cost time: 8.55533480644226
Epoch: 42, Steps: 268 | Train Loss: 0.1857990 Vali Loss: 0.4217302 Test Loss: 0.3633684
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1871650
	speed: 0.1059s/iter; left time: 1635.4168s
	iters: 200, epoch: 43 | loss: 0.1666318
	speed: 0.0210s/iter; left time: 322.5846s
Epoch: 43 cost time: 5.576784610748291
Epoch: 43, Steps: 268 | Train Loss: 0.1859166 Vali Loss: 0.4217548 Test Loss: 0.3634232
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1784373
	speed: 0.0989s/iter; left time: 1501.2119s
	iters: 200, epoch: 44 | loss: 0.1826188
	speed: 0.0368s/iter; left time: 554.7861s
Epoch: 44 cost time: 7.507957935333252
Epoch: 44, Steps: 268 | Train Loss: 0.1858420 Vali Loss: 0.4221617 Test Loss: 0.3634545
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2067747
	speed: 0.0975s/iter; left time: 1454.0678s
	iters: 200, epoch: 45 | loss: 0.1875941
	speed: 0.0156s/iter; left time: 231.2243s
Epoch: 45 cost time: 4.77127742767334
Epoch: 45, Steps: 268 | Train Loss: 0.1858150 Vali Loss: 0.4220368 Test Loss: 0.3635287
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1748016
	speed: 0.1505s/iter; left time: 2202.9124s
	iters: 200, epoch: 46 | loss: 0.1917341
	speed: 0.0416s/iter; left time: 604.8690s
Epoch: 46 cost time: 12.064931392669678
Epoch: 46, Steps: 268 | Train Loss: 0.1858379 Vali Loss: 0.4218341 Test Loss: 0.3634420
EarlyStopping counter: 20 out of 20
Early stopping
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3216543
	speed: 0.0526s/iter; left time: 1403.9398s
	iters: 200, epoch: 1 | loss: 0.3798963
	speed: 0.0240s/iter; left time: 638.6943s
Epoch: 1 cost time: 8.9283447265625
Epoch: 1, Steps: 268 | Train Loss: 0.3482767 Vali Loss: 0.4212813 Test Loss: 0.3631049
Validation loss decreased (inf --> 0.421281).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3574271
	speed: 0.1346s/iter; left time: 3558.9977s
	iters: 200, epoch: 2 | loss: 0.3791302
	speed: 0.0284s/iter; left time: 749.0446s
Epoch: 2 cost time: 7.629225254058838
Epoch: 2, Steps: 268 | Train Loss: 0.3475955 Vali Loss: 0.4205013 Test Loss: 0.3628284
Validation loss decreased (0.421281 --> 0.420501).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3830301
	speed: 0.1117s/iter; left time: 2922.7592s
	iters: 200, epoch: 3 | loss: 0.3426883
	speed: 0.0156s/iter; left time: 406.1922s
Epoch: 3 cost time: 5.0782105922698975
Epoch: 3, Steps: 268 | Train Loss: 0.3474605 Vali Loss: 0.4202037 Test Loss: 0.3626211
Validation loss decreased (0.420501 --> 0.420204).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3273100
	speed: 0.1016s/iter; left time: 2632.1781s
	iters: 200, epoch: 4 | loss: 0.3417588
	speed: 0.0169s/iter; left time: 436.8450s
Epoch: 4 cost time: 5.939502716064453
Epoch: 4, Steps: 268 | Train Loss: 0.3472305 Vali Loss: 0.4204109 Test Loss: 0.3620020
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3396648
	speed: 0.1168s/iter; left time: 2994.4998s
	iters: 200, epoch: 5 | loss: 0.3401491
	speed: 0.0186s/iter; left time: 475.5248s
Epoch: 5 cost time: 6.134112119674683
Epoch: 5, Steps: 268 | Train Loss: 0.3471085 Vali Loss: 0.4186292 Test Loss: 0.3610212
Validation loss decreased (0.420204 --> 0.418629).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3526198
	speed: 0.1269s/iter; left time: 3217.3160s
	iters: 200, epoch: 6 | loss: 0.3418470
	speed: 0.0215s/iter; left time: 542.3476s
Epoch: 6 cost time: 7.204838752746582
Epoch: 6, Steps: 268 | Train Loss: 0.3469780 Vali Loss: 0.4194437 Test Loss: 0.3617691
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3630530
	speed: 0.1247s/iter; left time: 3129.9613s
	iters: 200, epoch: 7 | loss: 0.3315388
	speed: 0.0270s/iter; left time: 675.3094s
Epoch: 7 cost time: 7.5455498695373535
Epoch: 7, Steps: 268 | Train Loss: 0.3469146 Vali Loss: 0.4197780 Test Loss: 0.3620614
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3676137
	speed: 0.1349s/iter; left time: 3348.2234s
	iters: 200, epoch: 8 | loss: 0.3411359
	speed: 0.0192s/iter; left time: 474.1414s
Epoch: 8 cost time: 6.438127517700195
Epoch: 8, Steps: 268 | Train Loss: 0.3468621 Vali Loss: 0.4197586 Test Loss: 0.3614568
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3899663
	speed: 0.1163s/iter; left time: 2856.5438s
	iters: 200, epoch: 9 | loss: 0.3170873
	speed: 0.0180s/iter; left time: 441.3613s
Epoch: 9 cost time: 5.295368432998657
Epoch: 9, Steps: 268 | Train Loss: 0.3467987 Vali Loss: 0.4188586 Test Loss: 0.3611792
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3797465
	speed: 0.1010s/iter; left time: 2453.4206s
	iters: 200, epoch: 10 | loss: 0.3329189
	speed: 0.0156s/iter; left time: 377.5768s
Epoch: 10 cost time: 5.807135581970215
Epoch: 10, Steps: 268 | Train Loss: 0.3467371 Vali Loss: 0.4194035 Test Loss: 0.3612375
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3366188
	speed: 0.0885s/iter; left time: 2124.9589s
	iters: 200, epoch: 11 | loss: 0.3521100
	speed: 0.0199s/iter; left time: 475.1465s
Epoch: 11 cost time: 5.613907098770142
Epoch: 11, Steps: 268 | Train Loss: 0.3466782 Vali Loss: 0.4183686 Test Loss: 0.3608223
Validation loss decreased (0.418629 --> 0.418369).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3434593
	speed: 0.1145s/iter; left time: 2720.1577s
	iters: 200, epoch: 12 | loss: 0.3742668
	speed: 0.0179s/iter; left time: 423.4045s
Epoch: 12 cost time: 6.096317291259766
Epoch: 12, Steps: 268 | Train Loss: 0.3466256 Vali Loss: 0.4190879 Test Loss: 0.3616347
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3575199
	speed: 0.1016s/iter; left time: 2385.7296s
	iters: 200, epoch: 13 | loss: 0.2991869
	speed: 0.0150s/iter; left time: 351.5072s
Epoch: 13 cost time: 4.79871392250061
Epoch: 13, Steps: 268 | Train Loss: 0.3466457 Vali Loss: 0.4193015 Test Loss: 0.3614447
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3755737
	speed: 0.1314s/iter; left time: 3050.1459s
	iters: 200, epoch: 14 | loss: 0.3576808
	speed: 0.0165s/iter; left time: 381.4859s
Epoch: 14 cost time: 7.939077377319336
Epoch: 14, Steps: 268 | Train Loss: 0.3465128 Vali Loss: 0.4190831 Test Loss: 0.3616792
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3678344
	speed: 0.1647s/iter; left time: 3780.1302s
	iters: 200, epoch: 15 | loss: 0.3252812
	speed: 0.0251s/iter; left time: 574.4557s
Epoch: 15 cost time: 7.2925941944122314
Epoch: 15, Steps: 268 | Train Loss: 0.3465445 Vali Loss: 0.4189385 Test Loss: 0.3612256
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3849997
	speed: 0.0946s/iter; left time: 2145.3051s
	iters: 200, epoch: 16 | loss: 0.3543034
	speed: 0.0229s/iter; left time: 516.2629s
Epoch: 16 cost time: 6.474770545959473
Epoch: 16, Steps: 268 | Train Loss: 0.3466105 Vali Loss: 0.4192550 Test Loss: 0.3618893
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3363866
	speed: 0.0926s/iter; left time: 2076.3659s
	iters: 200, epoch: 17 | loss: 0.3406731
	speed: 0.0179s/iter; left time: 399.0936s
Epoch: 17 cost time: 4.9561381340026855
Epoch: 17, Steps: 268 | Train Loss: 0.3464557 Vali Loss: 0.4192423 Test Loss: 0.3610401
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3297582
	speed: 0.1125s/iter; left time: 2492.1356s
	iters: 200, epoch: 18 | loss: 0.3755540
	speed: 0.0285s/iter; left time: 628.6391s
Epoch: 18 cost time: 8.340455293655396
Epoch: 18, Steps: 268 | Train Loss: 0.3465063 Vali Loss: 0.4185231 Test Loss: 0.3606623
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3916026
	speed: 0.1173s/iter; left time: 2566.8636s
	iters: 200, epoch: 19 | loss: 0.3519084
	speed: 0.0266s/iter; left time: 578.9141s
Epoch: 19 cost time: 6.2327845096588135
Epoch: 19, Steps: 268 | Train Loss: 0.3465096 Vali Loss: 0.4192918 Test Loss: 0.3615465
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3323627
	speed: 0.1259s/iter; left time: 2721.5334s
	iters: 200, epoch: 20 | loss: 0.3500124
	speed: 0.0187s/iter; left time: 402.8090s
Epoch: 20 cost time: 6.342869997024536
Epoch: 20, Steps: 268 | Train Loss: 0.3465244 Vali Loss: 0.4195465 Test Loss: 0.3616494
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3558200
	speed: 0.1423s/iter; left time: 3037.4751s
	iters: 200, epoch: 21 | loss: 0.3697966
	speed: 0.0248s/iter; left time: 527.4528s
Epoch: 21 cost time: 7.508349180221558
Epoch: 21, Steps: 268 | Train Loss: 0.3462770 Vali Loss: 0.4190406 Test Loss: 0.3613705
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3753673
	speed: 0.0929s/iter; left time: 1956.6332s
	iters: 200, epoch: 22 | loss: 0.3347106
	speed: 0.0159s/iter; left time: 332.8252s
Epoch: 22 cost time: 5.0004706382751465
Epoch: 22, Steps: 268 | Train Loss: 0.3463532 Vali Loss: 0.4199793 Test Loss: 0.3617714
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3473472
	speed: 0.0915s/iter; left time: 1903.7849s
	iters: 200, epoch: 23 | loss: 0.3428952
	speed: 0.0204s/iter; left time: 421.9803s
Epoch: 23 cost time: 5.713005065917969
Epoch: 23, Steps: 268 | Train Loss: 0.3463808 Vali Loss: 0.4188575 Test Loss: 0.3612013
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3591919
	speed: 0.0894s/iter; left time: 1836.6172s
	iters: 200, epoch: 24 | loss: 0.3570074
	speed: 0.0389s/iter; left time: 794.6453s
Epoch: 24 cost time: 7.533682107925415
Epoch: 24, Steps: 268 | Train Loss: 0.3464552 Vali Loss: 0.4187966 Test Loss: 0.3609999
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3303035
	speed: 0.0997s/iter; left time: 2021.2975s
	iters: 200, epoch: 25 | loss: 0.3507267
	speed: 0.0166s/iter; left time: 335.5156s
Epoch: 25 cost time: 5.193988800048828
Epoch: 25, Steps: 268 | Train Loss: 0.3464094 Vali Loss: 0.4189159 Test Loss: 0.3610754
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3572216
	speed: 0.0956s/iter; left time: 1912.9970s
	iters: 200, epoch: 26 | loss: 0.3139645
	speed: 0.0229s/iter; left time: 455.7812s
Epoch: 26 cost time: 6.383184194564819
Epoch: 26, Steps: 268 | Train Loss: 0.3462531 Vali Loss: 0.4189602 Test Loss: 0.3615150
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3643059
	speed: 0.1194s/iter; left time: 2355.6224s
	iters: 200, epoch: 27 | loss: 0.3643570
	speed: 0.0400s/iter; left time: 786.0981s
Epoch: 27 cost time: 9.966700553894043
Epoch: 27, Steps: 268 | Train Loss: 0.3463807 Vali Loss: 0.4190956 Test Loss: 0.3614220
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3916258
	speed: 0.1293s/iter; left time: 2517.3962s
	iters: 200, epoch: 28 | loss: 0.3384326
	speed: 0.0266s/iter; left time: 514.2094s
Epoch: 28 cost time: 7.051130771636963
Epoch: 28, Steps: 268 | Train Loss: 0.3462544 Vali Loss: 0.4185754 Test Loss: 0.3611964
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3541065
	speed: 0.1296s/iter; left time: 2488.8047s
	iters: 200, epoch: 29 | loss: 0.3465960
	speed: 0.0296s/iter; left time: 564.4293s
Epoch: 29 cost time: 8.153106927871704
Epoch: 29, Steps: 268 | Train Loss: 0.3462939 Vali Loss: 0.4191234 Test Loss: 0.3611237
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3280291
	speed: 0.1401s/iter; left time: 2651.4730s
	iters: 200, epoch: 30 | loss: 0.3215517
	speed: 0.0193s/iter; left time: 362.7543s
Epoch: 30 cost time: 5.127835273742676
Epoch: 30, Steps: 268 | Train Loss: 0.3463988 Vali Loss: 0.4187896 Test Loss: 0.3613754
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3063717
	speed: 0.0999s/iter; left time: 1863.3178s
	iters: 200, epoch: 31 | loss: 0.3749710
	speed: 0.0170s/iter; left time: 315.1925s
Epoch: 31 cost time: 4.933407306671143
Epoch: 31, Steps: 268 | Train Loss: 0.3462966 Vali Loss: 0.4184770 Test Loss: 0.3609143
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_96_FITS_ETTm1_ftM_sl90_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.36336779594421387, mae:0.38089656829833984, rse:0.5735946893692017, corr:[0.5532165  0.55412817 0.5487581  0.5475571  0.54664    0.5434637
 0.54056966 0.53938115 0.5382107  0.53670263 0.53590965 0.53569436
 0.53491706 0.5332904  0.5308523  0.527616   0.5240799  0.5211334
 0.51850593 0.5154865  0.5120362  0.50880814 0.506148   0.503505
 0.500129   0.49621758 0.49307472 0.49117792 0.48971748 0.48786744
 0.48657417 0.48681185 0.48734406 0.48753467 0.48776224 0.4884534
 0.48876685 0.48858315 0.4882501  0.4881508  0.48829868 0.48812446
 0.48780486 0.4877764  0.48779026 0.48755008 0.48719943 0.48710775
 0.4874585  0.4880411  0.48846123 0.488396   0.48832855 0.48855078
 0.4891529  0.48957965 0.4897023  0.4896152  0.48939684 0.4893668
 0.48943043 0.48911318 0.48858714 0.48800454 0.4878974  0.48798528
 0.48771358 0.48729315 0.48746035 0.48820108 0.48866755 0.48872447
 0.48886687 0.48937193 0.49017128 0.490667   0.49111316 0.4919012
 0.49290946 0.49383026 0.49460703 0.4951223  0.4956073  0.49608126
 0.49683288 0.49762958 0.49818358 0.49873236 0.49967527 0.5007193
 0.5014776  0.50234157 0.5036617  0.5046335  0.505372   0.50576603]
