Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_336_FITS_ETTm1_ftM_sl360_ll48_pl336_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33865
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=34, out_features=65, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1980160.0
params:  2275.0
Trainable parameters:  2275
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4461943
	speed: 0.0315s/iter; left time: 829.2171s
	iters: 200, epoch: 1 | loss: 0.3627813
	speed: 0.0215s/iter; left time: 562.4845s
Epoch: 1 cost time: 6.891766548156738
Epoch: 1, Steps: 264 | Train Loss: 0.4484846 Vali Loss: 0.8653603 Test Loss: 0.5139937
Validation loss decreased (inf --> 0.865360).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2675990
	speed: 0.1273s/iter; left time: 3315.3400s
	iters: 200, epoch: 2 | loss: 0.2425890
	speed: 0.0226s/iter; left time: 586.8466s
Epoch: 2 cost time: 8.010217189788818
Epoch: 2, Steps: 264 | Train Loss: 0.2752120 Vali Loss: 0.7554939 Test Loss: 0.4336477
Validation loss decreased (0.865360 --> 0.755494).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2377395
	speed: 0.0892s/iter; left time: 2297.6937s
	iters: 200, epoch: 3 | loss: 0.2061569
	speed: 0.0153s/iter; left time: 392.9046s
Epoch: 3 cost time: 5.0669331550598145
Epoch: 3, Steps: 264 | Train Loss: 0.2267960 Vali Loss: 0.7136812 Test Loss: 0.4059401
Validation loss decreased (0.755494 --> 0.713681).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2216348
	speed: 0.0899s/iter; left time: 2293.7397s
	iters: 200, epoch: 4 | loss: 0.1936690
	speed: 0.0173s/iter; left time: 440.7271s
Epoch: 4 cost time: 5.703186988830566
Epoch: 4, Steps: 264 | Train Loss: 0.2067894 Vali Loss: 0.6936363 Test Loss: 0.3935207
Validation loss decreased (0.713681 --> 0.693636).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2154954
	speed: 0.0840s/iter; left time: 2119.6970s
	iters: 200, epoch: 5 | loss: 0.1896196
	speed: 0.0207s/iter; left time: 521.0504s
Epoch: 5 cost time: 6.105703830718994
Epoch: 5, Steps: 264 | Train Loss: 0.1969852 Vali Loss: 0.6819582 Test Loss: 0.3868262
Validation loss decreased (0.693636 --> 0.681958).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1969893
	speed: 0.0909s/iter; left time: 2270.3239s
	iters: 200, epoch: 6 | loss: 0.1920157
	speed: 0.0168s/iter; left time: 418.6940s
Epoch: 6 cost time: 6.458130359649658
Epoch: 6, Steps: 264 | Train Loss: 0.1916478 Vali Loss: 0.6763564 Test Loss: 0.3831034
Validation loss decreased (0.681958 --> 0.676356).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1768544
	speed: 0.1091s/iter; left time: 2696.5185s
	iters: 200, epoch: 7 | loss: 0.2000792
	speed: 0.0181s/iter; left time: 445.7761s
Epoch: 7 cost time: 5.874374628067017
Epoch: 7, Steps: 264 | Train Loss: 0.1884481 Vali Loss: 0.6721351 Test Loss: 0.3807199
Validation loss decreased (0.676356 --> 0.672135).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2038812
	speed: 0.0863s/iter; left time: 2110.4938s
	iters: 200, epoch: 8 | loss: 0.1873343
	speed: 0.0247s/iter; left time: 602.1065s
Epoch: 8 cost time: 6.529743432998657
Epoch: 8, Steps: 264 | Train Loss: 0.1865227 Vali Loss: 0.6699097 Test Loss: 0.3795513
Validation loss decreased (0.672135 --> 0.669910).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1887706
	speed: 0.0988s/iter; left time: 2388.9301s
	iters: 200, epoch: 9 | loss: 0.1860862
	speed: 0.0327s/iter; left time: 788.1506s
Epoch: 9 cost time: 7.819760799407959
Epoch: 9, Steps: 264 | Train Loss: 0.1853259 Vali Loss: 0.6674020 Test Loss: 0.3786042
Validation loss decreased (0.669910 --> 0.667402).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1666659
	speed: 0.1294s/iter; left time: 3096.6833s
	iters: 200, epoch: 10 | loss: 0.1717647
	speed: 0.0232s/iter; left time: 552.9171s
Epoch: 10 cost time: 8.446408987045288
Epoch: 10, Steps: 264 | Train Loss: 0.1845568 Vali Loss: 0.6669024 Test Loss: 0.3783437
Validation loss decreased (0.667402 --> 0.666902).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1790654
	speed: 0.1153s/iter; left time: 2727.1896s
	iters: 200, epoch: 11 | loss: 0.2085995
	speed: 0.0221s/iter; left time: 519.9678s
Epoch: 11 cost time: 6.484439849853516
Epoch: 11, Steps: 264 | Train Loss: 0.1839603 Vali Loss: 0.6662256 Test Loss: 0.3779720
Validation loss decreased (0.666902 --> 0.666226).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1847115
	speed: 0.1026s/iter; left time: 2401.1114s
	iters: 200, epoch: 12 | loss: 0.1810947
	speed: 0.0238s/iter; left time: 554.1159s
Epoch: 12 cost time: 6.7407753467559814
Epoch: 12, Steps: 264 | Train Loss: 0.1836107 Vali Loss: 0.6657979 Test Loss: 0.3778560
Validation loss decreased (0.666226 --> 0.665798).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1934602
	speed: 0.1046s/iter; left time: 2420.5468s
	iters: 200, epoch: 13 | loss: 0.1901489
	speed: 0.0240s/iter; left time: 552.3723s
Epoch: 13 cost time: 6.905104875564575
Epoch: 13, Steps: 264 | Train Loss: 0.1833713 Vali Loss: 0.6653557 Test Loss: 0.3775069
Validation loss decreased (0.665798 --> 0.665356).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1754097
	speed: 0.1095s/iter; left time: 2503.4496s
	iters: 200, epoch: 14 | loss: 0.1770463
	speed: 0.0543s/iter; left time: 1236.5400s
Epoch: 14 cost time: 10.011247396469116
Epoch: 14, Steps: 264 | Train Loss: 0.1832286 Vali Loss: 0.6661589 Test Loss: 0.3770204
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1995167
	speed: 0.1098s/iter; left time: 2481.0585s
	iters: 200, epoch: 15 | loss: 0.1818889
	speed: 0.0322s/iter; left time: 725.5490s
Epoch: 15 cost time: 7.44409441947937
Epoch: 15, Steps: 264 | Train Loss: 0.1830741 Vali Loss: 0.6652060 Test Loss: 0.3774773
Validation loss decreased (0.665356 --> 0.665206).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1873723
	speed: 0.0983s/iter; left time: 2195.4669s
	iters: 200, epoch: 16 | loss: 0.1819984
	speed: 0.0314s/iter; left time: 699.1586s
Epoch: 16 cost time: 8.251973628997803
Epoch: 16, Steps: 264 | Train Loss: 0.1830103 Vali Loss: 0.6648068 Test Loss: 0.3773567
Validation loss decreased (0.665206 --> 0.664807).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1719753
	speed: 0.1118s/iter; left time: 2468.0185s
	iters: 200, epoch: 17 | loss: 0.1759844
	speed: 0.0240s/iter; left time: 527.6565s
Epoch: 17 cost time: 7.4825279712677
Epoch: 17, Steps: 264 | Train Loss: 0.1829449 Vali Loss: 0.6660104 Test Loss: 0.3773123
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1865802
	speed: 0.1287s/iter; left time: 2807.6194s
	iters: 200, epoch: 18 | loss: 0.1792778
	speed: 0.0215s/iter; left time: 466.5225s
Epoch: 18 cost time: 7.477191209793091
Epoch: 18, Steps: 264 | Train Loss: 0.1828213 Vali Loss: 0.6656768 Test Loss: 0.3774844
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1889030
	speed: 0.1930s/iter; left time: 4159.6106s
	iters: 200, epoch: 19 | loss: 0.1750993
	speed: 0.0664s/iter; left time: 1424.6036s
Epoch: 19 cost time: 15.659596681594849
Epoch: 19, Steps: 264 | Train Loss: 0.1828452 Vali Loss: 0.6656608 Test Loss: 0.3773697
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1733596
	speed: 0.2245s/iter; left time: 4778.4463s
	iters: 200, epoch: 20 | loss: 0.1785388
	speed: 0.0652s/iter; left time: 1381.3363s
Epoch: 20 cost time: 18.584417581558228
Epoch: 20, Steps: 264 | Train Loss: 0.1827839 Vali Loss: 0.6653389 Test Loss: 0.3775253
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1946629
	speed: 0.2336s/iter; left time: 4910.6577s
	iters: 200, epoch: 21 | loss: 0.1702524
	speed: 0.0350s/iter; left time: 731.2408s
Epoch: 21 cost time: 11.975009202957153
Epoch: 21, Steps: 264 | Train Loss: 0.1828031 Vali Loss: 0.6653170 Test Loss: 0.3774927
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1945962
	speed: 0.1365s/iter; left time: 2833.7722s
	iters: 200, epoch: 22 | loss: 0.1803531
	speed: 0.0248s/iter; left time: 513.2718s
Epoch: 22 cost time: 6.793177127838135
Epoch: 22, Steps: 264 | Train Loss: 0.1827930 Vali Loss: 0.6651793 Test Loss: 0.3778298
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1758024
	speed: 0.0998s/iter; left time: 2046.1901s
	iters: 200, epoch: 23 | loss: 0.1846104
	speed: 0.0382s/iter; left time: 779.7303s
Epoch: 23 cost time: 8.085779905319214
Epoch: 23, Steps: 264 | Train Loss: 0.1827711 Vali Loss: 0.6656621 Test Loss: 0.3776472
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1738928
	speed: 0.0934s/iter; left time: 1888.7611s
	iters: 200, epoch: 24 | loss: 0.1688788
	speed: 0.0182s/iter; left time: 366.3320s
Epoch: 24 cost time: 6.0283637046813965
Epoch: 24, Steps: 264 | Train Loss: 0.1826967 Vali Loss: 0.6653131 Test Loss: 0.3776210
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1967478
	speed: 0.0842s/iter; left time: 1680.2057s
	iters: 200, epoch: 25 | loss: 0.2087251
	speed: 0.0210s/iter; left time: 416.3791s
Epoch: 25 cost time: 5.791215896606445
Epoch: 25, Steps: 264 | Train Loss: 0.1828339 Vali Loss: 0.6657149 Test Loss: 0.3774396
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1739777
	speed: 0.0831s/iter; left time: 1636.7733s
	iters: 200, epoch: 26 | loss: 0.1891673
	speed: 0.0204s/iter; left time: 399.2695s
Epoch: 26 cost time: 6.278269290924072
Epoch: 26, Steps: 264 | Train Loss: 0.1828096 Vali Loss: 0.6660050 Test Loss: 0.3775786
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1610293
	speed: 0.1004s/iter; left time: 1951.7051s
	iters: 200, epoch: 27 | loss: 0.1888001
	speed: 0.0168s/iter; left time: 325.8106s
Epoch: 27 cost time: 5.228034973144531
Epoch: 27, Steps: 264 | Train Loss: 0.1827959 Vali Loss: 0.6660177 Test Loss: 0.3776018
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1664401
	speed: 0.0824s/iter; left time: 1578.9978s
	iters: 200, epoch: 28 | loss: 0.1952753
	speed: 0.0224s/iter; left time: 427.6526s
Epoch: 28 cost time: 6.390284299850464
Epoch: 28, Steps: 264 | Train Loss: 0.1827941 Vali Loss: 0.6652079 Test Loss: 0.3774884
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1915489
	speed: 0.0996s/iter; left time: 1884.2400s
	iters: 200, epoch: 29 | loss: 0.1698923
	speed: 0.0202s/iter; left time: 379.4168s
Epoch: 29 cost time: 6.689004182815552
Epoch: 29, Steps: 264 | Train Loss: 0.1827390 Vali Loss: 0.6656693 Test Loss: 0.3774863
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1716910
	speed: 0.1213s/iter; left time: 2261.6921s
	iters: 200, epoch: 30 | loss: 0.1804155
	speed: 0.0312s/iter; left time: 577.8825s
Epoch: 30 cost time: 8.208373308181763
Epoch: 30, Steps: 264 | Train Loss: 0.1828161 Vali Loss: 0.6655971 Test Loss: 0.3776487
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1789948
	speed: 0.1119s/iter; left time: 2057.0488s
	iters: 200, epoch: 31 | loss: 0.1846394
	speed: 0.0191s/iter; left time: 349.0259s
Epoch: 31 cost time: 6.6244659423828125
Epoch: 31, Steps: 264 | Train Loss: 0.1828113 Vali Loss: 0.6658120 Test Loss: 0.3775176
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2081315
	speed: 0.0986s/iter; left time: 1785.5937s
	iters: 200, epoch: 32 | loss: 0.1778640
	speed: 0.0196s/iter; left time: 353.8307s
Epoch: 32 cost time: 6.722059488296509
Epoch: 32, Steps: 264 | Train Loss: 0.1827222 Vali Loss: 0.6654508 Test Loss: 0.3776324
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1818740
	speed: 0.1256s/iter; left time: 2241.8005s
	iters: 200, epoch: 33 | loss: 0.1996932
	speed: 0.0183s/iter; left time: 324.2239s
Epoch: 33 cost time: 7.0559821128845215
Epoch: 33, Steps: 264 | Train Loss: 0.1827350 Vali Loss: 0.6652731 Test Loss: 0.3775436
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1689831
	speed: 0.0858s/iter; left time: 1509.2319s
	iters: 200, epoch: 34 | loss: 0.1979675
	speed: 0.0189s/iter; left time: 329.8746s
Epoch: 34 cost time: 5.916821718215942
Epoch: 34, Steps: 264 | Train Loss: 0.1827633 Vali Loss: 0.6652750 Test Loss: 0.3777056
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1833029
	speed: 0.0903s/iter; left time: 1564.0828s
	iters: 200, epoch: 35 | loss: 0.1757088
	speed: 0.0176s/iter; left time: 303.4915s
Epoch: 35 cost time: 5.5404510498046875
Epoch: 35, Steps: 264 | Train Loss: 0.1827711 Vali Loss: 0.6654776 Test Loss: 0.3775891
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1749257
	speed: 0.0877s/iter; left time: 1496.6360s
	iters: 200, epoch: 36 | loss: 0.1761325
	speed: 0.0173s/iter; left time: 292.8352s
Epoch: 36 cost time: 6.165395736694336
Epoch: 36, Steps: 264 | Train Loss: 0.1827667 Vali Loss: 0.6653619 Test Loss: 0.3777545
EarlyStopping counter: 20 out of 20
Early stopping
train 33865
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=34, out_features=65, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1980160.0
params:  2275.0
Trainable parameters:  2275
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3423913
	speed: 0.0239s/iter; left time: 627.7801s
	iters: 200, epoch: 1 | loss: 0.3626171
	speed: 0.0212s/iter; left time: 556.2147s
Epoch: 1 cost time: 5.715044736862183
Epoch: 1, Steps: 264 | Train Loss: 0.3503718 Vali Loss: 0.6592634 Test Loss: 0.3743707
Validation loss decreased (inf --> 0.659263).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3856815
	speed: 0.0996s/iter; left time: 2594.3129s
	iters: 200, epoch: 2 | loss: 0.3531177
	speed: 0.0255s/iter; left time: 661.7285s
Epoch: 2 cost time: 6.22910213470459
Epoch: 2, Steps: 264 | Train Loss: 0.3493771 Vali Loss: 0.6584713 Test Loss: 0.3739960
Validation loss decreased (0.659263 --> 0.658471).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3754371
	speed: 0.1197s/iter; left time: 3085.5978s
	iters: 200, epoch: 3 | loss: 0.3724918
	speed: 0.0227s/iter; left time: 583.3029s
Epoch: 3 cost time: 7.159768104553223
Epoch: 3, Steps: 264 | Train Loss: 0.3489674 Vali Loss: 0.6569719 Test Loss: 0.3741442
Validation loss decreased (0.658471 --> 0.656972).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3556273
	speed: 0.0879s/iter; left time: 2242.5408s
	iters: 200, epoch: 4 | loss: 0.3639416
	speed: 0.0199s/iter; left time: 505.2537s
Epoch: 4 cost time: 6.05369234085083
Epoch: 4, Steps: 264 | Train Loss: 0.3488375 Vali Loss: 0.6560572 Test Loss: 0.3736105
Validation loss decreased (0.656972 --> 0.656057).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3352336
	speed: 0.0888s/iter; left time: 2240.6039s
	iters: 200, epoch: 5 | loss: 0.3611856
	speed: 0.0211s/iter; left time: 530.3205s
Epoch: 5 cost time: 6.68414044380188
Epoch: 5, Steps: 264 | Train Loss: 0.3486964 Vali Loss: 0.6561652 Test Loss: 0.3738216
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3357460
	speed: 0.1135s/iter; left time: 2835.8803s
	iters: 200, epoch: 6 | loss: 0.3823589
	speed: 0.0267s/iter; left time: 663.3516s
Epoch: 6 cost time: 7.623929977416992
Epoch: 6, Steps: 264 | Train Loss: 0.3486087 Vali Loss: 0.6567731 Test Loss: 0.3738382
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3484946
	speed: 0.0898s/iter; left time: 2219.9144s
	iters: 200, epoch: 7 | loss: 0.3670666
	speed: 0.0180s/iter; left time: 442.2992s
Epoch: 7 cost time: 5.153366804122925
Epoch: 7, Steps: 264 | Train Loss: 0.3485388 Vali Loss: 0.6558399 Test Loss: 0.3736028
Validation loss decreased (0.656057 --> 0.655840).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3607275
	speed: 0.0799s/iter; left time: 1953.8351s
	iters: 200, epoch: 8 | loss: 0.3597735
	speed: 0.0177s/iter; left time: 431.8430s
Epoch: 8 cost time: 4.9850146770477295
Epoch: 8, Steps: 264 | Train Loss: 0.3486354 Vali Loss: 0.6560588 Test Loss: 0.3734021
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3749920
	speed: 0.0876s/iter; left time: 2119.6196s
	iters: 200, epoch: 9 | loss: 0.3417476
	speed: 0.0180s/iter; left time: 432.6542s
Epoch: 9 cost time: 5.5513458251953125
Epoch: 9, Steps: 264 | Train Loss: 0.3484214 Vali Loss: 0.6558996 Test Loss: 0.3734030
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3419245
	speed: 0.0806s/iter; left time: 1928.0823s
	iters: 200, epoch: 10 | loss: 0.3483583
	speed: 0.0204s/iter; left time: 485.2499s
Epoch: 10 cost time: 6.4114110469818115
Epoch: 10, Steps: 264 | Train Loss: 0.3484682 Vali Loss: 0.6557052 Test Loss: 0.3735485
Validation loss decreased (0.655840 --> 0.655705).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3449838
	speed: 0.1126s/iter; left time: 2665.2493s
	iters: 200, epoch: 11 | loss: 0.3643543
	speed: 0.0204s/iter; left time: 480.5583s
Epoch: 11 cost time: 6.0837860107421875
Epoch: 11, Steps: 264 | Train Loss: 0.3484040 Vali Loss: 0.6550019 Test Loss: 0.3733496
Validation loss decreased (0.655705 --> 0.655002).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3648839
	speed: 0.1180s/iter; left time: 2761.0546s
	iters: 200, epoch: 12 | loss: 0.4126794
	speed: 0.0266s/iter; left time: 618.8859s
Epoch: 12 cost time: 6.674149990081787
Epoch: 12, Steps: 264 | Train Loss: 0.3483916 Vali Loss: 0.6554299 Test Loss: 0.3735681
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3633622
	speed: 0.1256s/iter; left time: 2906.1457s
	iters: 200, epoch: 13 | loss: 0.3534519
	speed: 0.0337s/iter; left time: 777.1779s
Epoch: 13 cost time: 8.658550262451172
Epoch: 13, Steps: 264 | Train Loss: 0.3483918 Vali Loss: 0.6550245 Test Loss: 0.3732974
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3433553
	speed: 0.1237s/iter; left time: 2828.2445s
	iters: 200, epoch: 14 | loss: 0.3135090
	speed: 0.0278s/iter; left time: 633.6529s
Epoch: 14 cost time: 7.402313947677612
Epoch: 14, Steps: 264 | Train Loss: 0.3483389 Vali Loss: 0.6551410 Test Loss: 0.3734896
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3379911
	speed: 0.0933s/iter; left time: 2108.2032s
	iters: 200, epoch: 15 | loss: 0.3476062
	speed: 0.0202s/iter; left time: 455.6198s
Epoch: 15 cost time: 6.183642625808716
Epoch: 15, Steps: 264 | Train Loss: 0.3484135 Vali Loss: 0.6551813 Test Loss: 0.3735219
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3695869
	speed: 0.0906s/iter; left time: 2025.1527s
	iters: 200, epoch: 16 | loss: 0.3442351
	speed: 0.0188s/iter; left time: 417.6700s
Epoch: 16 cost time: 5.664838075637817
Epoch: 16, Steps: 264 | Train Loss: 0.3483556 Vali Loss: 0.6544688 Test Loss: 0.3735455
Validation loss decreased (0.655002 --> 0.654469).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3092528
	speed: 0.0880s/iter; left time: 1942.6864s
	iters: 200, epoch: 17 | loss: 0.3316227
	speed: 0.0234s/iter; left time: 514.4790s
Epoch: 17 cost time: 6.089608669281006
Epoch: 17, Steps: 264 | Train Loss: 0.3482695 Vali Loss: 0.6550674 Test Loss: 0.3732448
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3257031
	speed: 0.0975s/iter; left time: 2127.1107s
	iters: 200, epoch: 18 | loss: 0.3294067
	speed: 0.0274s/iter; left time: 594.0636s
Epoch: 18 cost time: 6.430058240890503
Epoch: 18, Steps: 264 | Train Loss: 0.3483513 Vali Loss: 0.6550853 Test Loss: 0.3736115
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3498551
	speed: 0.1135s/iter; left time: 2444.9713s
	iters: 200, epoch: 19 | loss: 0.4090852
	speed: 0.0279s/iter; left time: 599.3756s
Epoch: 19 cost time: 8.104732513427734
Epoch: 19, Steps: 264 | Train Loss: 0.3483595 Vali Loss: 0.6551052 Test Loss: 0.3734122
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3422761
	speed: 0.1204s/iter; left time: 2563.3314s
	iters: 200, epoch: 20 | loss: 0.3377375
	speed: 0.0259s/iter; left time: 548.3934s
Epoch: 20 cost time: 6.67045521736145
Epoch: 20, Steps: 264 | Train Loss: 0.3482582 Vali Loss: 0.6542007 Test Loss: 0.3734046
Validation loss decreased (0.654469 --> 0.654201).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3472628
	speed: 0.1091s/iter; left time: 2294.0544s
	iters: 200, epoch: 21 | loss: 0.3333497
	speed: 0.0287s/iter; left time: 601.2688s
Epoch: 21 cost time: 7.722017288208008
Epoch: 21, Steps: 264 | Train Loss: 0.3482613 Vali Loss: 0.6542345 Test Loss: 0.3732951
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3135566
	speed: 0.1215s/iter; left time: 2522.2214s
	iters: 200, epoch: 22 | loss: 0.3256685
	speed: 0.0278s/iter; left time: 573.9001s
Epoch: 22 cost time: 7.4267942905426025
Epoch: 22, Steps: 264 | Train Loss: 0.3482268 Vali Loss: 0.6551270 Test Loss: 0.3732863
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3453328
	speed: 0.1039s/iter; left time: 2130.0780s
	iters: 200, epoch: 23 | loss: 0.3324087
	speed: 0.0329s/iter; left time: 671.2804s
Epoch: 23 cost time: 8.653426170349121
Epoch: 23, Steps: 264 | Train Loss: 0.3482132 Vali Loss: 0.6554633 Test Loss: 0.3735056
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3243241
	speed: 0.0985s/iter; left time: 1991.9046s
	iters: 200, epoch: 24 | loss: 0.3455836
	speed: 0.0199s/iter; left time: 400.8529s
Epoch: 24 cost time: 5.539822101593018
Epoch: 24, Steps: 264 | Train Loss: 0.3482680 Vali Loss: 0.6541544 Test Loss: 0.3734038
Validation loss decreased (0.654201 --> 0.654154).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3243934
	speed: 0.1166s/iter; left time: 2328.2226s
	iters: 200, epoch: 25 | loss: 0.3263140
	speed: 0.0185s/iter; left time: 368.0647s
Epoch: 25 cost time: 5.748071908950806
Epoch: 25, Steps: 264 | Train Loss: 0.3482692 Vali Loss: 0.6546599 Test Loss: 0.3734322
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3683996
	speed: 0.0878s/iter; left time: 1730.5521s
	iters: 200, epoch: 26 | loss: 0.3684588
	speed: 0.0170s/iter; left time: 333.8283s
Epoch: 26 cost time: 5.209157705307007
Epoch: 26, Steps: 264 | Train Loss: 0.3482835 Vali Loss: 0.6554402 Test Loss: 0.3734346
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3387927
	speed: 0.0853s/iter; left time: 1658.2169s
	iters: 200, epoch: 27 | loss: 0.3364345
	speed: 0.0377s/iter; left time: 728.7918s
Epoch: 27 cost time: 8.228437662124634
Epoch: 27, Steps: 264 | Train Loss: 0.3483143 Vali Loss: 0.6553447 Test Loss: 0.3733360
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3314230
	speed: 0.0972s/iter; left time: 1864.1397s
	iters: 200, epoch: 28 | loss: 0.3808806
	speed: 0.0189s/iter; left time: 359.9836s
Epoch: 28 cost time: 5.798734903335571
Epoch: 28, Steps: 264 | Train Loss: 0.3481738 Vali Loss: 0.6550139 Test Loss: 0.3732748
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3767565
	speed: 0.0883s/iter; left time: 1669.3814s
	iters: 200, epoch: 29 | loss: 0.3488395
	speed: 0.0208s/iter; left time: 391.0370s
Epoch: 29 cost time: 6.29979944229126
Epoch: 29, Steps: 264 | Train Loss: 0.3482384 Vali Loss: 0.6551393 Test Loss: 0.3734613
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3398421
	speed: 0.0985s/iter; left time: 1836.0286s
	iters: 200, epoch: 30 | loss: 0.3677697
	speed: 0.0209s/iter; left time: 387.0399s
Epoch: 30 cost time: 5.684056997299194
Epoch: 30, Steps: 264 | Train Loss: 0.3482602 Vali Loss: 0.6543584 Test Loss: 0.3734134
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3376741
	speed: 0.0914s/iter; left time: 1679.4807s
	iters: 200, epoch: 31 | loss: 0.3390415
	speed: 0.0244s/iter; left time: 445.4378s
Epoch: 31 cost time: 7.1076836585998535
Epoch: 31, Steps: 264 | Train Loss: 0.3481316 Vali Loss: 0.6543007 Test Loss: 0.3733670
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3695990
	speed: 0.1042s/iter; left time: 1888.1624s
	iters: 200, epoch: 32 | loss: 0.3451431
	speed: 0.0228s/iter; left time: 410.3866s
Epoch: 32 cost time: 6.535422086715698
Epoch: 32, Steps: 264 | Train Loss: 0.3481519 Vali Loss: 0.6543882 Test Loss: 0.3733860
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3019149
	speed: 0.1090s/iter; left time: 1945.8323s
	iters: 200, epoch: 33 | loss: 0.3521824
	speed: 0.0233s/iter; left time: 414.3581s
Epoch: 33 cost time: 7.971212148666382
Epoch: 33, Steps: 264 | Train Loss: 0.3482415 Vali Loss: 0.6550786 Test Loss: 0.3734337
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3459368
	speed: 0.0933s/iter; left time: 1640.9501s
	iters: 200, epoch: 34 | loss: 0.3668956
	speed: 0.0158s/iter; left time: 275.7321s
Epoch: 34 cost time: 5.222804307937622
Epoch: 34, Steps: 264 | Train Loss: 0.3481219 Vali Loss: 0.6553984 Test Loss: 0.3732566
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3531035
	speed: 0.0960s/iter; left time: 1662.5474s
	iters: 200, epoch: 35 | loss: 0.3294499
	speed: 0.0202s/iter; left time: 348.6822s
Epoch: 35 cost time: 6.018999338150024
Epoch: 35, Steps: 264 | Train Loss: 0.3480992 Vali Loss: 0.6553823 Test Loss: 0.3733588
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3403080
	speed: 0.0889s/iter; left time: 1517.0018s
	iters: 200, epoch: 36 | loss: 0.3541307
	speed: 0.0250s/iter; left time: 424.7295s
Epoch: 36 cost time: 6.111080646514893
Epoch: 36, Steps: 264 | Train Loss: 0.3481816 Vali Loss: 0.6545491 Test Loss: 0.3733364
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3266801
	speed: 0.0937s/iter; left time: 1573.2835s
	iters: 200, epoch: 37 | loss: 0.3767229
	speed: 0.0209s/iter; left time: 348.7955s
Epoch: 37 cost time: 6.440796375274658
Epoch: 37, Steps: 264 | Train Loss: 0.3482282 Vali Loss: 0.6548524 Test Loss: 0.3734569
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3514488
	speed: 0.1014s/iter; left time: 1676.9238s
	iters: 200, epoch: 38 | loss: 0.3020363
	speed: 0.0175s/iter; left time: 287.5588s
Epoch: 38 cost time: 6.356394052505493
Epoch: 38, Steps: 264 | Train Loss: 0.3481888 Vali Loss: 0.6549762 Test Loss: 0.3733639
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3499524
	speed: 0.0974s/iter; left time: 1585.0467s
	iters: 200, epoch: 39 | loss: 0.3526857
	speed: 0.0259s/iter; left time: 418.9661s
Epoch: 39 cost time: 6.698349475860596
Epoch: 39, Steps: 264 | Train Loss: 0.3482170 Vali Loss: 0.6550254 Test Loss: 0.3733200
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3523960
	speed: 0.1070s/iter; left time: 1713.2595s
	iters: 200, epoch: 40 | loss: 0.3301657
	speed: 0.0181s/iter; left time: 287.7450s
Epoch: 40 cost time: 6.056153059005737
Epoch: 40, Steps: 264 | Train Loss: 0.3481477 Vali Loss: 0.6546748 Test Loss: 0.3733234
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3408943
	speed: 0.0855s/iter; left time: 1345.4283s
	iters: 200, epoch: 41 | loss: 0.3656401
	speed: 0.0200s/iter; left time: 313.1896s
Epoch: 41 cost time: 6.150684833526611
Epoch: 41, Steps: 264 | Train Loss: 0.3480829 Vali Loss: 0.6544148 Test Loss: 0.3733259
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3578380
	speed: 0.0859s/iter; left time: 1329.8566s
	iters: 200, epoch: 42 | loss: 0.3751331
	speed: 0.0205s/iter; left time: 314.4971s
Epoch: 42 cost time: 5.403374195098877
Epoch: 42, Steps: 264 | Train Loss: 0.3481806 Vali Loss: 0.6546633 Test Loss: 0.3733892
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3573900
	speed: 0.0852s/iter; left time: 1296.5043s
	iters: 200, epoch: 43 | loss: 0.3938047
	speed: 0.0236s/iter; left time: 355.9398s
Epoch: 43 cost time: 5.893674612045288
Epoch: 43, Steps: 264 | Train Loss: 0.3481132 Vali Loss: 0.6545055 Test Loss: 0.3733655
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3497387
	speed: 0.1035s/iter; left time: 1547.0357s
	iters: 200, epoch: 44 | loss: 0.3553995
	speed: 0.0337s/iter; left time: 500.4851s
Epoch: 44 cost time: 8.389135599136353
Epoch: 44, Steps: 264 | Train Loss: 0.3481492 Vali Loss: 0.6550416 Test Loss: 0.3733312
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_336_FITS_ETTm1_ftM_sl360_ll48_pl336_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3731552064418793, mae:0.3859483599662781, rse:0.5812903046607971, corr:[0.54024357 0.5457208  0.54910177 0.55022985 0.5499654  0.54931957
 0.54897404 0.54918504 0.54978305 0.55051666 0.5512451  0.5515702
 0.5514523  0.5509744  0.55022526 0.5492559  0.5482096  0.5471925
 0.5460543  0.5447858  0.5433723  0.54202145 0.5406911  0.5395133
 0.53849673 0.537551   0.53676355 0.53622913 0.5359017  0.53559214
 0.53542453 0.53548205 0.53565764 0.5358712  0.5360281  0.5361855
 0.53632516 0.53638923 0.53634185 0.53614235 0.53582585 0.5354132
 0.5349521  0.53457785 0.534331   0.5342426  0.5343396  0.53446996
 0.5344674  0.53431576 0.5339733  0.5334957  0.5330506  0.5327128
 0.53254527 0.53256035 0.5326603  0.5327741  0.5328459  0.5327419
 0.5325259  0.53220123 0.53185534 0.5315328  0.53140503 0.531538
 0.5318558  0.5322418  0.5327052  0.5331057  0.53336644 0.5334509
 0.53343564 0.5334049  0.5333663  0.5333267  0.5332937  0.53328866
 0.53328514 0.5332633  0.5332069  0.5330868  0.53283197 0.5323992
 0.5318918  0.531336   0.53086704 0.5305047  0.5302811  0.53027344
 0.53045404 0.5306617  0.53073186 0.53060627 0.5302181  0.52958655
 0.52884007 0.52813447 0.52754855 0.52708215 0.52683693 0.52683586
 0.5270216  0.52722734 0.52750057 0.5278271  0.5280872  0.5283766
 0.5285969  0.5288369  0.5290281  0.52914906 0.5291272  0.5290674
 0.5289846  0.52894217 0.5289245  0.5289459  0.52898127 0.5291323
 0.5293192  0.52937126 0.52924776 0.5290745  0.52885425 0.5285557
 0.5282392  0.5279852  0.5278151  0.52775687 0.5277917  0.5278564
 0.52793205 0.52791864 0.52782494 0.5276186  0.5273196  0.5269027
 0.5264646  0.5260653  0.5257434  0.5255835  0.5255693  0.5256546
 0.525734   0.5257381  0.52560776 0.52538615 0.52517754 0.52496636
 0.5248252  0.52485543 0.5249914  0.5251768  0.52535456 0.5255256
 0.52563894 0.5256844  0.5256508  0.52560395 0.5256323  0.5257454
 0.5259684  0.5262698  0.52665854 0.52707887 0.52743405 0.52775204
 0.5279907  0.52816314 0.5283237  0.52849805 0.5286282  0.5287064
 0.5287127  0.5286721  0.5285781  0.52844566 0.52822655 0.52797735
 0.5276989  0.5274953  0.52731264 0.52720207 0.52715385 0.527156
 0.52717626 0.5271897  0.5271599  0.5270719  0.5268439  0.52651036
 0.52610725 0.5257885  0.5255424  0.5252593  0.52493167 0.5246699
 0.52438486 0.52399755 0.5235717  0.5231266  0.52265143 0.522215
 0.5218754  0.52155155 0.5213066  0.5210651  0.52082855 0.5205792
 0.5202282  0.5198206  0.5193403  0.5188776  0.5184262  0.51808614
 0.51784414 0.5176341  0.5173733  0.5171763  0.517004   0.51684856
 0.51679146 0.51679045 0.51680833 0.5168122  0.51681334 0.5167525
 0.5166572  0.51655585 0.51640946 0.5161949  0.51596147 0.51569605
 0.51549333 0.515372   0.5152728  0.5152769  0.51532567 0.5153608
 0.5153194  0.5151578  0.5149334  0.5146824  0.5144449  0.5143122
 0.51428044 0.5143286  0.51442635 0.5145571  0.5146237  0.5146352
 0.5145274  0.5144125  0.51430225 0.5142412  0.5142138  0.5143145
 0.51449084 0.5147399  0.51503885 0.5153387  0.5155345  0.5157192
 0.51588106 0.51603246 0.5161635  0.51634365 0.5165273  0.5166214
 0.5166733  0.51667327 0.5166117  0.51652145 0.5163739  0.5162664
 0.5161672  0.5161532  0.51610345 0.51607317 0.51599735 0.51588315
 0.51575214 0.51554775 0.5152704  0.51487255 0.5143637  0.5137525
 0.5130389  0.51237863 0.5118577  0.511311   0.51080453 0.5103537
 0.50996095 0.50951666 0.50911134 0.5087085  0.50836444 0.5080447
 0.50778115 0.50756955 0.50741535 0.50732636 0.5072446  0.5071395
 0.50704044 0.5068798  0.5067073  0.5065874  0.5065591  0.5065993
 0.50671846 0.50681496 0.50674003 0.5066415  0.5064704  0.50625324
 0.50599927 0.50570816 0.5053977  0.5051028  0.5048506  0.5046552
 0.5045292  0.50445276 0.5043479  0.50421405 0.5039794  0.5037256
 0.5035382  0.5035313  0.50374454 0.5041227  0.5044     0.5038828 ]
