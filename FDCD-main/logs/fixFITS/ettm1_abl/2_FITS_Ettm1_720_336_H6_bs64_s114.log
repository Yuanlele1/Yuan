Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=58, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=58, out_features=85, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4417280.0
params:  5015.0
Trainable parameters:  5015
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4328818
	speed: 0.0369s/iter; left time: 960.0305s
	iters: 200, epoch: 1 | loss: 0.3548647
	speed: 0.0284s/iter; left time: 736.2983s
Epoch: 1 cost time: 8.35910177230835
Epoch: 1, Steps: 261 | Train Loss: 0.4373468 Vali Loss: 0.9615501 Test Loss: 0.5542521
Validation loss decreased (inf --> 0.961550).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2726264
	speed: 0.1380s/iter; left time: 3552.4039s
	iters: 200, epoch: 2 | loss: 0.2395649
	speed: 0.0318s/iter; left time: 815.8222s
Epoch: 2 cost time: 8.895568370819092
Epoch: 2, Steps: 261 | Train Loss: 0.2564000 Vali Loss: 0.8184299 Test Loss: 0.4671846
Validation loss decreased (0.961550 --> 0.818430).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2012721
	speed: 0.1340s/iter; left time: 3414.9605s
	iters: 200, epoch: 3 | loss: 0.1860314
	speed: 0.0317s/iter; left time: 805.4259s
Epoch: 3 cost time: 8.833967924118042
Epoch: 3, Steps: 261 | Train Loss: 0.1959354 Vali Loss: 0.7551668 Test Loss: 0.4254317
Validation loss decreased (0.818430 --> 0.755167).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1634511
	speed: 0.1432s/iter; left time: 3612.3078s
	iters: 200, epoch: 4 | loss: 0.1609363
	speed: 0.0303s/iter; left time: 761.1755s
Epoch: 4 cost time: 9.290077209472656
Epoch: 4, Steps: 261 | Train Loss: 0.1681588 Vali Loss: 0.7244911 Test Loss: 0.4043198
Validation loss decreased (0.755167 --> 0.724491).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1539302
	speed: 0.1445s/iter; left time: 3606.7322s
	iters: 200, epoch: 5 | loss: 0.1530643
	speed: 0.0449s/iter; left time: 1115.5597s
Epoch: 5 cost time: 10.694579839706421
Epoch: 5, Steps: 261 | Train Loss: 0.1532817 Vali Loss: 0.7092861 Test Loss: 0.3925918
Validation loss decreased (0.724491 --> 0.709286).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1459653
	speed: 0.1439s/iter; left time: 3554.0562s
	iters: 200, epoch: 6 | loss: 0.1461954
	speed: 0.0363s/iter; left time: 892.9652s
Epoch: 6 cost time: 10.866454124450684
Epoch: 6, Steps: 261 | Train Loss: 0.1445051 Vali Loss: 0.6961986 Test Loss: 0.3838817
Validation loss decreased (0.709286 --> 0.696199).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1444944
	speed: 0.1419s/iter; left time: 3468.3394s
	iters: 200, epoch: 7 | loss: 0.1296061
	speed: 0.0334s/iter; left time: 812.0279s
Epoch: 7 cost time: 10.18996286392212
Epoch: 7, Steps: 261 | Train Loss: 0.1389533 Vali Loss: 0.6900077 Test Loss: 0.3792462
Validation loss decreased (0.696199 --> 0.690008).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1301993
	speed: 0.1346s/iter; left time: 3254.4267s
	iters: 200, epoch: 8 | loss: 0.1329668
	speed: 0.0369s/iter; left time: 888.0499s
Epoch: 8 cost time: 9.77178955078125
Epoch: 8, Steps: 261 | Train Loss: 0.1353442 Vali Loss: 0.6842542 Test Loss: 0.3755563
Validation loss decreased (0.690008 --> 0.684254).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1405722
	speed: 0.1289s/iter; left time: 3081.8375s
	iters: 200, epoch: 9 | loss: 0.1370536
	speed: 0.0316s/iter; left time: 753.6015s
Epoch: 9 cost time: 9.235275983810425
Epoch: 9, Steps: 261 | Train Loss: 0.1330265 Vali Loss: 0.6810538 Test Loss: 0.3735299
Validation loss decreased (0.684254 --> 0.681054).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1392677
	speed: 0.1475s/iter; left time: 3488.9917s
	iters: 200, epoch: 10 | loss: 0.1387198
	speed: 0.0309s/iter; left time: 727.2476s
Epoch: 10 cost time: 8.97640347480774
Epoch: 10, Steps: 261 | Train Loss: 0.1313234 Vali Loss: 0.6793044 Test Loss: 0.3723454
Validation loss decreased (0.681054 --> 0.679304).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1343817
	speed: 0.1428s/iter; left time: 3340.9689s
	iters: 200, epoch: 11 | loss: 0.1305423
	speed: 0.0297s/iter; left time: 692.1893s
Epoch: 11 cost time: 8.899343252182007
Epoch: 11, Steps: 261 | Train Loss: 0.1302217 Vali Loss: 0.6783590 Test Loss: 0.3716448
Validation loss decreased (0.679304 --> 0.678359).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1362886
	speed: 0.1552s/iter; left time: 3588.7912s
	iters: 200, epoch: 12 | loss: 0.1317311
	speed: 0.0353s/iter; left time: 813.7397s
Epoch: 12 cost time: 10.013413190841675
Epoch: 12, Steps: 261 | Train Loss: 0.1294449 Vali Loss: 0.6773162 Test Loss: 0.3716947
Validation loss decreased (0.678359 --> 0.677316).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1265814
	speed: 0.1394s/iter; left time: 3188.5969s
	iters: 200, epoch: 13 | loss: 0.1169484
	speed: 0.0340s/iter; left time: 774.5147s
Epoch: 13 cost time: 10.6191086769104
Epoch: 13, Steps: 261 | Train Loss: 0.1289185 Vali Loss: 0.6759788 Test Loss: 0.3714656
Validation loss decreased (0.677316 --> 0.675979).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1404829
	speed: 0.1347s/iter; left time: 3044.6835s
	iters: 200, epoch: 14 | loss: 0.1303062
	speed: 0.0311s/iter; left time: 700.7959s
Epoch: 14 cost time: 8.527189493179321
Epoch: 14, Steps: 261 | Train Loss: 0.1285254 Vali Loss: 0.6757448 Test Loss: 0.3718581
Validation loss decreased (0.675979 --> 0.675745).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1294035
	speed: 0.1408s/iter; left time: 3146.7378s
	iters: 200, epoch: 15 | loss: 0.1230003
	speed: 0.0273s/iter; left time: 607.1858s
Epoch: 15 cost time: 8.201238632202148
Epoch: 15, Steps: 261 | Train Loss: 0.1283341 Vali Loss: 0.6762972 Test Loss: 0.3719019
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1255640
	speed: 0.1389s/iter; left time: 3067.0815s
	iters: 200, epoch: 16 | loss: 0.1350479
	speed: 0.0350s/iter; left time: 768.5165s
Epoch: 16 cost time: 9.688072681427002
Epoch: 16, Steps: 261 | Train Loss: 0.1281079 Vali Loss: 0.6759676 Test Loss: 0.3726647
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1288603
	speed: 0.1467s/iter; left time: 3202.4600s
	iters: 200, epoch: 17 | loss: 0.1305487
	speed: 0.0309s/iter; left time: 672.0520s
Epoch: 17 cost time: 8.986801385879517
Epoch: 17, Steps: 261 | Train Loss: 0.1280241 Vali Loss: 0.6756531 Test Loss: 0.3727791
Validation loss decreased (0.675745 --> 0.675653).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1194813
	speed: 0.1543s/iter; left time: 3326.3059s
	iters: 200, epoch: 18 | loss: 0.1293886
	speed: 0.0442s/iter; left time: 949.0330s
Epoch: 18 cost time: 10.781852960586548
Epoch: 18, Steps: 261 | Train Loss: 0.1279452 Vali Loss: 0.6751129 Test Loss: 0.3732873
Validation loss decreased (0.675653 --> 0.675113).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1331513
	speed: 0.1386s/iter; left time: 2952.2740s
	iters: 200, epoch: 19 | loss: 0.1328347
	speed: 0.0321s/iter; left time: 681.2617s
Epoch: 19 cost time: 9.598220586776733
Epoch: 19, Steps: 261 | Train Loss: 0.1277913 Vali Loss: 0.6758869 Test Loss: 0.3733241
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1335876
	speed: 0.1374s/iter; left time: 2890.5026s
	iters: 200, epoch: 20 | loss: 0.1260646
	speed: 0.0288s/iter; left time: 603.2415s
Epoch: 20 cost time: 8.93862795829773
Epoch: 20, Steps: 261 | Train Loss: 0.1278571 Vali Loss: 0.6761054 Test Loss: 0.3737847
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1271930
	speed: 0.1299s/iter; left time: 2699.7610s
	iters: 200, epoch: 21 | loss: 0.1221487
	speed: 0.0319s/iter; left time: 659.0404s
Epoch: 21 cost time: 8.945358276367188
Epoch: 21, Steps: 261 | Train Loss: 0.1278492 Vali Loss: 0.6762995 Test Loss: 0.3739699
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1255675
	speed: 0.1393s/iter; left time: 2858.7319s
	iters: 200, epoch: 22 | loss: 0.1258972
	speed: 0.0338s/iter; left time: 690.5704s
Epoch: 22 cost time: 9.242306470870972
Epoch: 22, Steps: 261 | Train Loss: 0.1278065 Vali Loss: 0.6765137 Test Loss: 0.3739541
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1242035
	speed: 0.1338s/iter; left time: 2711.6559s
	iters: 200, epoch: 23 | loss: 0.1234669
	speed: 0.0331s/iter; left time: 667.5491s
Epoch: 23 cost time: 9.352426290512085
Epoch: 23, Steps: 261 | Train Loss: 0.1277963 Vali Loss: 0.6768632 Test Loss: 0.3743300
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1234556
	speed: 0.1425s/iter; left time: 2850.6317s
	iters: 200, epoch: 24 | loss: 0.1299035
	speed: 0.0292s/iter; left time: 581.4476s
Epoch: 24 cost time: 8.98051905632019
Epoch: 24, Steps: 261 | Train Loss: 0.1278009 Vali Loss: 0.6765662 Test Loss: 0.3742863
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1199531
	speed: 0.1349s/iter; left time: 2662.0208s
	iters: 200, epoch: 25 | loss: 0.1308099
	speed: 0.0262s/iter; left time: 515.0060s
Epoch: 25 cost time: 8.26416826248169
Epoch: 25, Steps: 261 | Train Loss: 0.1277712 Vali Loss: 0.6765614 Test Loss: 0.3743324
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1258513
	speed: 0.1290s/iter; left time: 2512.3592s
	iters: 200, epoch: 26 | loss: 0.1279074
	speed: 0.0257s/iter; left time: 498.1123s
Epoch: 26 cost time: 7.731985569000244
Epoch: 26, Steps: 261 | Train Loss: 0.1277830 Vali Loss: 0.6772919 Test Loss: 0.3745579
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1166910
	speed: 0.1290s/iter; left time: 2479.1802s
	iters: 200, epoch: 27 | loss: 0.1224341
	speed: 0.0334s/iter; left time: 639.2239s
Epoch: 27 cost time: 9.757517099380493
Epoch: 27, Steps: 261 | Train Loss: 0.1277870 Vali Loss: 0.6764117 Test Loss: 0.3745065
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1266426
	speed: 0.1308s/iter; left time: 2479.1565s
	iters: 200, epoch: 28 | loss: 0.1196776
	speed: 0.0318s/iter; left time: 598.6367s
Epoch: 28 cost time: 8.688772678375244
Epoch: 28, Steps: 261 | Train Loss: 0.1277882 Vali Loss: 0.6767040 Test Loss: 0.3744164
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1209082
	speed: 0.1461s/iter; left time: 2730.7985s
	iters: 200, epoch: 29 | loss: 0.1223154
	speed: 0.0363s/iter; left time: 674.3242s
Epoch: 29 cost time: 9.720057249069214
Epoch: 29, Steps: 261 | Train Loss: 0.1277557 Vali Loss: 0.6764807 Test Loss: 0.3744765
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1273490
	speed: 0.1366s/iter; left time: 2517.5776s
	iters: 200, epoch: 30 | loss: 0.1238772
	speed: 0.0416s/iter; left time: 762.9968s
Epoch: 30 cost time: 10.936229944229126
Epoch: 30, Steps: 261 | Train Loss: 0.1277787 Vali Loss: 0.6767061 Test Loss: 0.3747283
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1282778
	speed: 0.1474s/iter; left time: 2678.4692s
	iters: 200, epoch: 31 | loss: 0.1348587
	speed: 0.0328s/iter; left time: 591.9834s
Epoch: 31 cost time: 9.781740665435791
Epoch: 31, Steps: 261 | Train Loss: 0.1277704 Vali Loss: 0.6767700 Test Loss: 0.3744914
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1371104
	speed: 0.1455s/iter; left time: 2605.8663s
	iters: 200, epoch: 32 | loss: 0.1259849
	speed: 0.0334s/iter; left time: 594.8285s
Epoch: 32 cost time: 9.601415157318115
Epoch: 32, Steps: 261 | Train Loss: 0.1277528 Vali Loss: 0.6763155 Test Loss: 0.3743953
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1256355
	speed: 0.1328s/iter; left time: 2343.1643s
	iters: 200, epoch: 33 | loss: 0.1343538
	speed: 0.0348s/iter; left time: 610.7813s
Epoch: 33 cost time: 9.162231922149658
Epoch: 33, Steps: 261 | Train Loss: 0.1277458 Vali Loss: 0.6774074 Test Loss: 0.3745193
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1285455
	speed: 0.1456s/iter; left time: 2531.3320s
	iters: 200, epoch: 34 | loss: 0.1364577
	speed: 0.0383s/iter; left time: 662.5537s
Epoch: 34 cost time: 10.55389404296875
Epoch: 34, Steps: 261 | Train Loss: 0.1277414 Vali Loss: 0.6765340 Test Loss: 0.3746019
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1242316
	speed: 0.1309s/iter; left time: 2241.6349s
	iters: 200, epoch: 35 | loss: 0.1225596
	speed: 0.0301s/iter; left time: 512.1589s
Epoch: 35 cost time: 7.888266086578369
Epoch: 35, Steps: 261 | Train Loss: 0.1277668 Vali Loss: 0.6770954 Test Loss: 0.3745321
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1194860
	speed: 0.1477s/iter; left time: 2490.4112s
	iters: 200, epoch: 36 | loss: 0.1305011
	speed: 0.0268s/iter; left time: 449.6437s
Epoch: 36 cost time: 7.74105429649353
Epoch: 36, Steps: 261 | Train Loss: 0.1277626 Vali Loss: 0.6766295 Test Loss: 0.3746143
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1358507
	speed: 0.1506s/iter; left time: 2500.4186s
	iters: 200, epoch: 37 | loss: 0.1187011
	speed: 0.0316s/iter; left time: 521.7525s
Epoch: 37 cost time: 9.034378051757812
Epoch: 37, Steps: 261 | Train Loss: 0.1277439 Vali Loss: 0.6766508 Test Loss: 0.3747537
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1303711
	speed: 0.1380s/iter; left time: 2254.7723s
	iters: 200, epoch: 38 | loss: 0.1256731
	speed: 0.0360s/iter; left time: 584.7140s
Epoch: 38 cost time: 9.727227449417114
Epoch: 38, Steps: 261 | Train Loss: 0.1277646 Vali Loss: 0.6764378 Test Loss: 0.3746718
EarlyStopping counter: 20 out of 20
Early stopping
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=58, out_features=85, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4417280.0
params:  5015.0
Trainable parameters:  5015
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3413347
	speed: 0.0365s/iter; left time: 949.7681s
	iters: 200, epoch: 1 | loss: 0.3281541
	speed: 0.0299s/iter; left time: 774.5824s
Epoch: 1 cost time: 8.240410804748535
Epoch: 1, Steps: 261 | Train Loss: 0.3412961 Vali Loss: 0.6659198 Test Loss: 0.3710252
Validation loss decreased (inf --> 0.665920).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3480780
	speed: 0.1267s/iter; left time: 3261.9994s
	iters: 200, epoch: 2 | loss: 0.3204621
	speed: 0.0359s/iter; left time: 919.5864s
Epoch: 2 cost time: 10.00852084159851
Epoch: 2, Steps: 261 | Train Loss: 0.3402318 Vali Loss: 0.6632373 Test Loss: 0.3709336
Validation loss decreased (0.665920 --> 0.663237).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3803799
	speed: 0.1344s/iter; left time: 3424.6156s
	iters: 200, epoch: 3 | loss: 0.3290308
	speed: 0.0294s/iter; left time: 745.5482s
Epoch: 3 cost time: 8.294919967651367
Epoch: 3, Steps: 261 | Train Loss: 0.3395639 Vali Loss: 0.6607103 Test Loss: 0.3709705
Validation loss decreased (0.663237 --> 0.660710).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3131600
	speed: 0.1431s/iter; left time: 3607.4467s
	iters: 200, epoch: 4 | loss: 0.3017448
	speed: 0.0359s/iter; left time: 902.5757s
Epoch: 4 cost time: 9.592218160629272
Epoch: 4, Steps: 261 | Train Loss: 0.3392612 Vali Loss: 0.6596702 Test Loss: 0.3708127
Validation loss decreased (0.660710 --> 0.659670).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3343389
	speed: 0.1417s/iter; left time: 3535.7104s
	iters: 200, epoch: 5 | loss: 0.3385591
	speed: 0.0316s/iter; left time: 785.3514s
Epoch: 5 cost time: 9.048369884490967
Epoch: 5, Steps: 261 | Train Loss: 0.3391635 Vali Loss: 0.6589240 Test Loss: 0.3709348
Validation loss decreased (0.659670 --> 0.658924).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3618643
	speed: 0.1389s/iter; left time: 3430.7307s
	iters: 200, epoch: 6 | loss: 0.3623130
	speed: 0.0357s/iter; left time: 877.8680s
Epoch: 6 cost time: 10.076786756515503
Epoch: 6, Steps: 261 | Train Loss: 0.3390775 Vali Loss: 0.6585872 Test Loss: 0.3699852
Validation loss decreased (0.658924 --> 0.658587).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3339123
	speed: 0.1309s/iter; left time: 3199.4719s
	iters: 200, epoch: 7 | loss: 0.3241724
	speed: 0.0302s/iter; left time: 734.6411s
Epoch: 7 cost time: 8.897071361541748
Epoch: 7, Steps: 261 | Train Loss: 0.3389710 Vali Loss: 0.6571807 Test Loss: 0.3706474
Validation loss decreased (0.658587 --> 0.657181).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3353787
	speed: 0.1377s/iter; left time: 3327.7769s
	iters: 200, epoch: 8 | loss: 0.3472826
	speed: 0.0343s/iter; left time: 825.2986s
Epoch: 8 cost time: 9.453736782073975
Epoch: 8, Steps: 261 | Train Loss: 0.3388099 Vali Loss: 0.6577204 Test Loss: 0.3706714
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3382232
	speed: 0.1429s/iter; left time: 3417.3280s
	iters: 200, epoch: 9 | loss: 0.3225538
	speed: 0.0382s/iter; left time: 908.7258s
Epoch: 9 cost time: 10.566994667053223
Epoch: 9, Steps: 261 | Train Loss: 0.3388565 Vali Loss: 0.6580642 Test Loss: 0.3704836
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3254617
	speed: 0.1358s/iter; left time: 3212.6417s
	iters: 200, epoch: 10 | loss: 0.3331479
	speed: 0.0320s/iter; left time: 754.0445s
Epoch: 10 cost time: 8.881898641586304
Epoch: 10, Steps: 261 | Train Loss: 0.3388017 Vali Loss: 0.6583070 Test Loss: 0.3707102
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3449971
	speed: 0.1312s/iter; left time: 3069.7950s
	iters: 200, epoch: 11 | loss: 0.3410885
	speed: 0.0299s/iter; left time: 697.2024s
Epoch: 11 cost time: 8.451724290847778
Epoch: 11, Steps: 261 | Train Loss: 0.3388283 Vali Loss: 0.6572151 Test Loss: 0.3700150
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3626543
	speed: 0.1342s/iter; left time: 3104.5374s
	iters: 200, epoch: 12 | loss: 0.3101215
	speed: 0.0320s/iter; left time: 736.6737s
Epoch: 12 cost time: 9.471437931060791
Epoch: 12, Steps: 261 | Train Loss: 0.3387033 Vali Loss: 0.6583148 Test Loss: 0.3703908
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3622827
	speed: 0.1475s/iter; left time: 3372.7371s
	iters: 200, epoch: 13 | loss: 0.3399047
	speed: 0.0350s/iter; left time: 795.9368s
Epoch: 13 cost time: 9.54332971572876
Epoch: 13, Steps: 261 | Train Loss: 0.3386219 Vali Loss: 0.6568059 Test Loss: 0.3703968
Validation loss decreased (0.657181 --> 0.656806).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3317604
	speed: 0.1418s/iter; left time: 3206.5221s
	iters: 200, epoch: 14 | loss: 0.3108642
	speed: 0.0297s/iter; left time: 669.0100s
Epoch: 14 cost time: 8.534135341644287
Epoch: 14, Steps: 261 | Train Loss: 0.3386581 Vali Loss: 0.6579604 Test Loss: 0.3706102
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3364178
	speed: 0.1533s/iter; left time: 3425.1412s
	iters: 200, epoch: 15 | loss: 0.3092176
	speed: 0.0291s/iter; left time: 647.2229s
Epoch: 15 cost time: 9.795865535736084
Epoch: 15, Steps: 261 | Train Loss: 0.3386498 Vali Loss: 0.6580881 Test Loss: 0.3704347
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3947764
	speed: 0.1390s/iter; left time: 3069.1487s
	iters: 200, epoch: 16 | loss: 0.3287876
	speed: 0.0292s/iter; left time: 642.8117s
Epoch: 16 cost time: 8.120175838470459
Epoch: 16, Steps: 261 | Train Loss: 0.3385405 Vali Loss: 0.6565133 Test Loss: 0.3703548
Validation loss decreased (0.656806 --> 0.656513).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3576560
	speed: 0.1482s/iter; left time: 3235.4367s
	iters: 200, epoch: 17 | loss: 0.3282721
	speed: 0.0371s/iter; left time: 805.2127s
Epoch: 17 cost time: 9.998743057250977
Epoch: 17, Steps: 261 | Train Loss: 0.3385384 Vali Loss: 0.6566370 Test Loss: 0.3709646
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3081685
	speed: 0.1373s/iter; left time: 2961.4380s
	iters: 200, epoch: 18 | loss: 0.3150689
	speed: 0.0310s/iter; left time: 665.5097s
Epoch: 18 cost time: 8.968231678009033
Epoch: 18, Steps: 261 | Train Loss: 0.3384736 Vali Loss: 0.6573845 Test Loss: 0.3708848
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3411222
	speed: 0.1298s/iter; left time: 2764.1863s
	iters: 200, epoch: 19 | loss: 0.3659840
	speed: 0.0293s/iter; left time: 621.8737s
Epoch: 19 cost time: 7.858544588088989
Epoch: 19, Steps: 261 | Train Loss: 0.3384165 Vali Loss: 0.6569144 Test Loss: 0.3708014
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3539242
	speed: 0.1366s/iter; left time: 2874.1161s
	iters: 200, epoch: 20 | loss: 0.3464579
	speed: 0.0296s/iter; left time: 620.0738s
Epoch: 20 cost time: 8.375319242477417
Epoch: 20, Steps: 261 | Train Loss: 0.3385975 Vali Loss: 0.6577554 Test Loss: 0.3707263
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3230510
	speed: 0.1471s/iter; left time: 3056.9691s
	iters: 200, epoch: 21 | loss: 0.3376029
	speed: 0.0342s/iter; left time: 706.3560s
Epoch: 21 cost time: 9.413251638412476
Epoch: 21, Steps: 261 | Train Loss: 0.3384236 Vali Loss: 0.6571189 Test Loss: 0.3703862
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3447344
	speed: 0.1583s/iter; left time: 3247.7118s
	iters: 200, epoch: 22 | loss: 0.3471906
	speed: 0.0266s/iter; left time: 542.2326s
Epoch: 22 cost time: 8.849257946014404
Epoch: 22, Steps: 261 | Train Loss: 0.3384446 Vali Loss: 0.6568016 Test Loss: 0.3706518
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3233430
	speed: 0.1562s/iter; left time: 3165.2814s
	iters: 200, epoch: 23 | loss: 0.3372016
	speed: 0.0305s/iter; left time: 613.8851s
Epoch: 23 cost time: 9.445543766021729
Epoch: 23, Steps: 261 | Train Loss: 0.3383915 Vali Loss: 0.6573325 Test Loss: 0.3705977
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3308559
	speed: 0.1440s/iter; left time: 2879.6745s
	iters: 200, epoch: 24 | loss: 0.3651898
	speed: 0.0379s/iter; left time: 754.3804s
Epoch: 24 cost time: 10.189588069915771
Epoch: 24, Steps: 261 | Train Loss: 0.3383898 Vali Loss: 0.6574934 Test Loss: 0.3704283
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3499552
	speed: 0.1341s/iter; left time: 2646.7347s
	iters: 200, epoch: 25 | loss: 0.3088466
	speed: 0.0271s/iter; left time: 531.2436s
Epoch: 25 cost time: 7.946089029312134
Epoch: 25, Steps: 261 | Train Loss: 0.3384902 Vali Loss: 0.6573515 Test Loss: 0.3703739
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3314750
	speed: 0.1495s/iter; left time: 2911.6382s
	iters: 200, epoch: 26 | loss: 0.3221520
	speed: 0.0343s/iter; left time: 664.3477s
Epoch: 26 cost time: 8.98848819732666
Epoch: 26, Steps: 261 | Train Loss: 0.3382944 Vali Loss: 0.6569812 Test Loss: 0.3704475
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3169941
	speed: 0.1502s/iter; left time: 2886.4295s
	iters: 200, epoch: 27 | loss: 0.3273281
	speed: 0.0289s/iter; left time: 551.5604s
Epoch: 27 cost time: 8.751935958862305
Epoch: 27, Steps: 261 | Train Loss: 0.3384439 Vali Loss: 0.6573286 Test Loss: 0.3704417
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3535582
	speed: 0.1522s/iter; left time: 2885.2752s
	iters: 200, epoch: 28 | loss: 0.3524764
	speed: 0.0321s/iter; left time: 605.3294s
Epoch: 28 cost time: 9.667344808578491
Epoch: 28, Steps: 261 | Train Loss: 0.3383408 Vali Loss: 0.6567621 Test Loss: 0.3705993
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3233539
	speed: 0.1479s/iter; left time: 2765.5261s
	iters: 200, epoch: 29 | loss: 0.3316263
	speed: 0.0371s/iter; left time: 689.4573s
Epoch: 29 cost time: 10.14323902130127
Epoch: 29, Steps: 261 | Train Loss: 0.3382943 Vali Loss: 0.6572334 Test Loss: 0.3705259
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3358955
	speed: 0.1368s/iter; left time: 2522.2970s
	iters: 200, epoch: 30 | loss: 0.3531366
	speed: 0.0307s/iter; left time: 563.0896s
Epoch: 30 cost time: 9.436109066009521
Epoch: 30, Steps: 261 | Train Loss: 0.3382801 Vali Loss: 0.6577076 Test Loss: 0.3706949
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3323135
	speed: 0.1279s/iter; left time: 2323.9990s
	iters: 200, epoch: 31 | loss: 0.3405268
	speed: 0.0252s/iter; left time: 454.9778s
Epoch: 31 cost time: 7.525399923324585
Epoch: 31, Steps: 261 | Train Loss: 0.3383209 Vali Loss: 0.6575485 Test Loss: 0.3705742
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3766821
	speed: 0.1486s/iter; left time: 2661.1065s
	iters: 200, epoch: 32 | loss: 0.3422642
	speed: 0.0292s/iter; left time: 520.9369s
Epoch: 32 cost time: 9.164151906967163
Epoch: 32, Steps: 261 | Train Loss: 0.3383052 Vali Loss: 0.6574700 Test Loss: 0.3706504
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3526051
	speed: 0.1345s/iter; left time: 2373.7415s
	iters: 200, epoch: 33 | loss: 0.3253558
	speed: 0.0295s/iter; left time: 517.0446s
Epoch: 33 cost time: 9.028193950653076
Epoch: 33, Steps: 261 | Train Loss: 0.3382405 Vali Loss: 0.6574673 Test Loss: 0.3705893
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3173296
	speed: 0.1319s/iter; left time: 2293.0570s
	iters: 200, epoch: 34 | loss: 0.3206630
	speed: 0.0295s/iter; left time: 509.4607s
Epoch: 34 cost time: 9.094624042510986
Epoch: 34, Steps: 261 | Train Loss: 0.3382788 Vali Loss: 0.6580383 Test Loss: 0.3703870
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3179397
	speed: 0.1329s/iter; left time: 2275.3491s
	iters: 200, epoch: 35 | loss: 0.3472664
	speed: 0.0312s/iter; left time: 530.7133s
Epoch: 35 cost time: 9.630687952041626
Epoch: 35, Steps: 261 | Train Loss: 0.3382594 Vali Loss: 0.6571998 Test Loss: 0.3705628
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3633499
	speed: 0.1358s/iter; left time: 2290.0042s
	iters: 200, epoch: 36 | loss: 0.3619406
	speed: 0.0307s/iter; left time: 514.4909s
Epoch: 36 cost time: 8.72130823135376
Epoch: 36, Steps: 261 | Train Loss: 0.3383789 Vali Loss: 0.6571366 Test Loss: 0.3706331
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3698749542236328, mae:0.3878735899925232, rse:0.5787297487258911, corr:[0.53862846 0.5444519  0.5496909  0.55350304 0.55562824 0.5565172
 0.55669636 0.5566636  0.55678135 0.5571717  0.5578415  0.5585386
 0.55909204 0.5592706  0.5589481  0.55811584 0.5568661  0.5553076
 0.55350727 0.55157715 0.54967123 0.54786956 0.5462567  0.54499346
 0.54402405 0.5434163  0.5431609  0.54311454 0.54327565 0.5435919
 0.54396856 0.5443936  0.5447446  0.5450447  0.54519665 0.5453129
 0.5452902  0.54520494 0.54508257 0.5448499  0.544582   0.5442826
 0.5440022  0.54384816 0.5437803  0.5437408  0.543766   0.5438018
 0.54376274 0.54356146 0.5432889  0.54300475 0.54280716 0.5426414
 0.5425374  0.54246384 0.5423864  0.54225796 0.5420965  0.5418671
 0.54161066 0.5413904  0.54122543 0.5410868  0.5410538  0.541144
 0.54129386 0.54146034 0.54160863 0.5416813  0.5416682  0.5415499
 0.5412954  0.54093456 0.5405462  0.5401817  0.539854   0.53960913
 0.539457   0.5393963  0.5394016  0.5394261  0.5394442  0.5394095
 0.53935564 0.53927946 0.5392313  0.53920704 0.5392281  0.5393414
 0.53952104 0.5396965  0.5398104  0.5398342  0.53974974 0.53954655
 0.5392877  0.5391046  0.5389295  0.5387894  0.53868586 0.5386005
 0.5385351  0.53842914 0.5383089  0.53821695 0.53809774 0.5379846
 0.53783745 0.53767323 0.5374998  0.53729165 0.53703463 0.5367567
 0.5364739  0.53619736 0.53594536 0.5357152  0.53550744 0.5353559
 0.53523266 0.5351005  0.5348979  0.53467    0.5344474  0.53422904
 0.53403443 0.5339131  0.53384584 0.53384393 0.53382957 0.53376424
 0.533678   0.5335792  0.53343654 0.5332809  0.5331775  0.5330743
 0.5330247  0.5330802  0.53318185 0.53334606 0.53355277 0.5337689
 0.5339417  0.53396124 0.5338471  0.533618   0.53335583 0.53308827
 0.5328284  0.5326334  0.5325225  0.5324814  0.53248054 0.5325497
 0.5326526  0.53274435 0.5328436  0.5328921  0.5329603  0.5330541
 0.5331909  0.5333533  0.533533   0.53371066 0.53387666 0.53404033
 0.53414494 0.5341457  0.53410274 0.5340525  0.53398037 0.533901
 0.5338378  0.5338065  0.5338129  0.5338624  0.5339325  0.5340418
 0.53418714 0.53437775 0.5345785  0.5348279  0.53512967 0.5354633
 0.5358022  0.53612876 0.536422   0.53662664 0.5366744  0.5365723
 0.5363062  0.5360013  0.53561157 0.5350988  0.5344619  0.5337441
 0.53295094 0.53212434 0.5313013  0.5305433  0.5298769  0.5293075
 0.5288439  0.5284483  0.52806973 0.52769405 0.52726996 0.5267535
 0.52611214 0.52537084 0.52456933 0.5237712  0.52299154 0.5223317
 0.5218769  0.5216304  0.52157617 0.5216282  0.5217271  0.52186054
 0.5220409  0.5221895  0.5223207  0.5224399  0.5225228  0.52258545
 0.5226361  0.52269113 0.5227293  0.52269894 0.52260363 0.5224642
 0.5223221  0.5222671  0.5222363  0.5223177  0.52246135 0.5226718
 0.5228961  0.5229972  0.5229663  0.52284527 0.5227058  0.5225357
 0.522353   0.5221901  0.5220411  0.52194446 0.5218654  0.5218329
 0.52179146 0.52179646 0.52180314 0.52178746 0.52176565 0.52175754
 0.52177805 0.5218526  0.52196    0.52207047 0.52215934 0.52228427
 0.52237314 0.52242756 0.5224569  0.5224833  0.52250385 0.52248067
 0.522433   0.5223528  0.5222646  0.5221811  0.5221051  0.5220571
 0.5220263  0.52208066 0.5221721  0.52235144 0.5225619  0.5227611
 0.5229204  0.5229892  0.5229027  0.5226796  0.52231485 0.52179676
 0.521163   0.52055305 0.52001727 0.51949334 0.51896566 0.5184299
 0.5178965  0.5173349  0.51681316 0.5163198  0.5158646  0.51547235
 0.5151394  0.5148502  0.5146354  0.51445425 0.5142484  0.51395017
 0.51362467 0.5132378  0.51282966 0.512456   0.51221603 0.51212543
 0.51217866 0.5123658  0.51257676 0.5127385  0.5127994  0.5127746
 0.51266915 0.5124761  0.51223415 0.5120074  0.5118258  0.51169807
 0.5116067  0.5115769  0.5115679  0.5115858  0.51160794 0.51165575
 0.51179844 0.5119732  0.5120394  0.51180565 0.5109104  0.5087661 ]
