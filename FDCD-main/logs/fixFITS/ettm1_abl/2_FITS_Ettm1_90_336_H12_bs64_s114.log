Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_336_FITS_ETTm1_ftM_sl90_ll48_pl336_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34135
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=22, out_features=104, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2050048.0
params:  2392.0
Trainable parameters:  2392
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.7390215
	speed: 0.0450s/iter; left time: 1191.5174s
	iters: 200, epoch: 1 | loss: 0.5209448
	speed: 0.0193s/iter; left time: 510.0768s
Epoch: 1 cost time: 7.90875768661499
Epoch: 1, Steps: 266 | Train Loss: 0.6706645 Vali Loss: 0.9926276 Test Loss: 0.7250483
Validation loss decreased (inf --> 0.992628).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4031639
	speed: 0.1211s/iter; left time: 3177.3485s
	iters: 200, epoch: 2 | loss: 0.4025725
	speed: 0.0325s/iter; left time: 849.2345s
Epoch: 2 cost time: 7.8923938274383545
Epoch: 2, Steps: 266 | Train Loss: 0.4200079 Vali Loss: 0.8186630 Test Loss: 0.5526431
Validation loss decreased (0.992628 --> 0.818663).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3555513
	speed: 0.1388s/iter; left time: 3605.1804s
	iters: 200, epoch: 3 | loss: 0.3749110
	speed: 0.0193s/iter; left time: 498.4296s
Epoch: 3 cost time: 8.407034635543823
Epoch: 3, Steps: 266 | Train Loss: 0.3690680 Vali Loss: 0.7624604 Test Loss: 0.4986376
Validation loss decreased (0.818663 --> 0.762460).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3612123
	speed: 0.1672s/iter; left time: 4296.3419s
	iters: 200, epoch: 4 | loss: 0.3884586
	speed: 0.0273s/iter; left time: 699.8472s
Epoch: 4 cost time: 9.815819263458252
Epoch: 4, Steps: 266 | Train Loss: 0.3532371 Vali Loss: 0.7360665 Test Loss: 0.4720362
Validation loss decreased (0.762460 --> 0.736066).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3106529
	speed: 0.1373s/iter; left time: 3492.1248s
	iters: 200, epoch: 5 | loss: 0.3638473
	speed: 0.0365s/iter; left time: 925.0432s
Epoch: 5 cost time: 11.080910921096802
Epoch: 5, Steps: 266 | Train Loss: 0.3460661 Vali Loss: 0.7194617 Test Loss: 0.4567630
Validation loss decreased (0.736066 --> 0.719462).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3508848
	speed: 0.1347s/iter; left time: 3391.5504s
	iters: 200, epoch: 6 | loss: 0.3484994
	speed: 0.0194s/iter; left time: 486.0866s
Epoch: 6 cost time: 5.4638447761535645
Epoch: 6, Steps: 266 | Train Loss: 0.3426153 Vali Loss: 0.7111021 Test Loss: 0.4478114
Validation loss decreased (0.719462 --> 0.711102).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3526045
	speed: 0.1040s/iter; left time: 2590.2456s
	iters: 200, epoch: 7 | loss: 0.3777533
	speed: 0.0179s/iter; left time: 445.2446s
Epoch: 7 cost time: 6.185868740081787
Epoch: 7, Steps: 266 | Train Loss: 0.3408175 Vali Loss: 0.7065217 Test Loss: 0.4423751
Validation loss decreased (0.711102 --> 0.706522).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3694719
	speed: 0.1028s/iter; left time: 2534.0163s
	iters: 200, epoch: 8 | loss: 0.3595602
	speed: 0.0387s/iter; left time: 948.8980s
Epoch: 8 cost time: 7.863421440124512
Epoch: 8, Steps: 266 | Train Loss: 0.3399734 Vali Loss: 0.7033529 Test Loss: 0.4391111
Validation loss decreased (0.706522 --> 0.703353).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3399416
	speed: 0.1163s/iter; left time: 2833.7740s
	iters: 200, epoch: 9 | loss: 0.3806407
	speed: 0.0194s/iter; left time: 471.1960s
Epoch: 9 cost time: 5.966899394989014
Epoch: 9, Steps: 266 | Train Loss: 0.3395166 Vali Loss: 0.7011557 Test Loss: 0.4373069
Validation loss decreased (0.703353 --> 0.701156).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3607944
	speed: 0.1265s/iter; left time: 3048.6349s
	iters: 200, epoch: 10 | loss: 0.3703946
	speed: 0.0389s/iter; left time: 933.1528s
Epoch: 10 cost time: 8.70252513885498
Epoch: 10, Steps: 266 | Train Loss: 0.3392788 Vali Loss: 0.7008761 Test Loss: 0.4365732
Validation loss decreased (0.701156 --> 0.700876).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3509666
	speed: 0.1273s/iter; left time: 3035.8304s
	iters: 200, epoch: 11 | loss: 0.2880270
	speed: 0.0192s/iter; left time: 456.0783s
Epoch: 11 cost time: 6.0019752979278564
Epoch: 11, Steps: 266 | Train Loss: 0.3391091 Vali Loss: 0.7004673 Test Loss: 0.4353700
Validation loss decreased (0.700876 --> 0.700467).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3366087
	speed: 0.0993s/iter; left time: 2341.5920s
	iters: 200, epoch: 12 | loss: 0.3602547
	speed: 0.0176s/iter; left time: 413.9272s
Epoch: 12 cost time: 6.096864461898804
Epoch: 12, Steps: 266 | Train Loss: 0.3391093 Vali Loss: 0.6999367 Test Loss: 0.4347768
Validation loss decreased (0.700467 --> 0.699937).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3397231
	speed: 0.0974s/iter; left time: 2269.3668s
	iters: 200, epoch: 13 | loss: 0.3684660
	speed: 0.0200s/iter; left time: 464.9686s
Epoch: 13 cost time: 6.734305143356323
Epoch: 13, Steps: 266 | Train Loss: 0.3391412 Vali Loss: 0.6993961 Test Loss: 0.4347756
Validation loss decreased (0.699937 --> 0.699396).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3802797
	speed: 0.1621s/iter; left time: 3735.3176s
	iters: 200, epoch: 14 | loss: 0.3475488
	speed: 0.0259s/iter; left time: 593.5545s
Epoch: 14 cost time: 7.901112794876099
Epoch: 14, Steps: 266 | Train Loss: 0.3390068 Vali Loss: 0.6980260 Test Loss: 0.4342403
Validation loss decreased (0.699396 --> 0.698026).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3264778
	speed: 0.1414s/iter; left time: 3219.5964s
	iters: 200, epoch: 15 | loss: 0.3189014
	speed: 0.0586s/iter; left time: 1329.5125s
Epoch: 15 cost time: 13.974337100982666
Epoch: 15, Steps: 266 | Train Loss: 0.3390685 Vali Loss: 0.6991069 Test Loss: 0.4344523
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3341370
	speed: 0.1458s/iter; left time: 3281.7065s
	iters: 200, epoch: 16 | loss: 0.2963507
	speed: 0.0307s/iter; left time: 687.7841s
Epoch: 16 cost time: 8.713391780853271
Epoch: 16, Steps: 266 | Train Loss: 0.3391830 Vali Loss: 0.6994939 Test Loss: 0.4342792
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3126005
	speed: 0.1276s/iter; left time: 2837.4993s
	iters: 200, epoch: 17 | loss: 0.3266101
	speed: 0.0195s/iter; left time: 432.9164s
Epoch: 17 cost time: 7.647555112838745
Epoch: 17, Steps: 266 | Train Loss: 0.3390721 Vali Loss: 0.6997801 Test Loss: 0.4346675
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3601513
	speed: 0.1117s/iter; left time: 2455.4018s
	iters: 200, epoch: 18 | loss: 0.3774743
	speed: 0.0277s/iter; left time: 605.7122s
Epoch: 18 cost time: 6.746181964874268
Epoch: 18, Steps: 266 | Train Loss: 0.3389046 Vali Loss: 0.6992103 Test Loss: 0.4345247
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3458018
	speed: 0.1273s/iter; left time: 2764.9836s
	iters: 200, epoch: 19 | loss: 0.3333316
	speed: 0.0200s/iter; left time: 431.4338s
Epoch: 19 cost time: 7.8882269859313965
Epoch: 19, Steps: 266 | Train Loss: 0.3390568 Vali Loss: 0.6992361 Test Loss: 0.4345277
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3222969
	speed: 0.0982s/iter; left time: 2106.3385s
	iters: 200, epoch: 20 | loss: 0.3676485
	speed: 0.0208s/iter; left time: 443.9593s
Epoch: 20 cost time: 5.602368116378784
Epoch: 20, Steps: 266 | Train Loss: 0.3390489 Vali Loss: 0.6991371 Test Loss: 0.4346018
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3468020
	speed: 0.1094s/iter; left time: 2317.3171s
	iters: 200, epoch: 21 | loss: 0.3277425
	speed: 0.0207s/iter; left time: 436.0358s
Epoch: 21 cost time: 7.155419111251831
Epoch: 21, Steps: 266 | Train Loss: 0.3390145 Vali Loss: 0.6986750 Test Loss: 0.4346795
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3281730
	speed: 0.1130s/iter; left time: 2364.3115s
	iters: 200, epoch: 22 | loss: 0.3224744
	speed: 0.0304s/iter; left time: 632.2670s
Epoch: 22 cost time: 7.219391822814941
Epoch: 22, Steps: 266 | Train Loss: 0.3389842 Vali Loss: 0.6995147 Test Loss: 0.4345823
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3403288
	speed: 0.0968s/iter; left time: 1998.4621s
	iters: 200, epoch: 23 | loss: 0.3207751
	speed: 0.0252s/iter; left time: 517.5078s
Epoch: 23 cost time: 6.423659801483154
Epoch: 23, Steps: 266 | Train Loss: 0.3391163 Vali Loss: 0.6995252 Test Loss: 0.4345940
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3146946
	speed: 0.0943s/iter; left time: 1923.0836s
	iters: 200, epoch: 24 | loss: 0.3405019
	speed: 0.0175s/iter; left time: 354.8304s
Epoch: 24 cost time: 5.488399982452393
Epoch: 24, Steps: 266 | Train Loss: 0.3388381 Vali Loss: 0.6998625 Test Loss: 0.4344677
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3552935
	speed: 0.1042s/iter; left time: 2095.2217s
	iters: 200, epoch: 25 | loss: 0.3413694
	speed: 0.0182s/iter; left time: 364.5574s
Epoch: 25 cost time: 5.782871961593628
Epoch: 25, Steps: 266 | Train Loss: 0.3390862 Vali Loss: 0.6996726 Test Loss: 0.4345271
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3359117
	speed: 0.1167s/iter; left time: 2316.9636s
	iters: 200, epoch: 26 | loss: 0.2992921
	speed: 0.0321s/iter; left time: 634.7829s
Epoch: 26 cost time: 7.830265045166016
Epoch: 26, Steps: 266 | Train Loss: 0.3390019 Vali Loss: 0.6993608 Test Loss: 0.4345477
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3329745
	speed: 0.1376s/iter; left time: 2695.4301s
	iters: 200, epoch: 27 | loss: 0.3503378
	speed: 0.0200s/iter; left time: 390.4327s
Epoch: 27 cost time: 6.169422626495361
Epoch: 27, Steps: 266 | Train Loss: 0.3390073 Vali Loss: 0.6994672 Test Loss: 0.4346402
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3448482
	speed: 0.1283s/iter; left time: 2478.7309s
	iters: 200, epoch: 28 | loss: 0.3866509
	speed: 0.0264s/iter; left time: 507.1795s
Epoch: 28 cost time: 7.889937400817871
Epoch: 28, Steps: 266 | Train Loss: 0.3390810 Vali Loss: 0.7000020 Test Loss: 0.4345740
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3446502
	speed: 0.1130s/iter; left time: 2153.5298s
	iters: 200, epoch: 29 | loss: 0.3488076
	speed: 0.0195s/iter; left time: 369.6953s
Epoch: 29 cost time: 6.152379035949707
Epoch: 29, Steps: 266 | Train Loss: 0.3389922 Vali Loss: 0.6997382 Test Loss: 0.4347819
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3288233
	speed: 0.1023s/iter; left time: 1921.2658s
	iters: 200, epoch: 30 | loss: 0.3464932
	speed: 0.0197s/iter; left time: 367.7132s
Epoch: 30 cost time: 6.048347234725952
Epoch: 30, Steps: 266 | Train Loss: 0.3388801 Vali Loss: 0.7000243 Test Loss: 0.4347693
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3226930
	speed: 0.1206s/iter; left time: 2234.2816s
	iters: 200, epoch: 31 | loss: 0.3211847
	speed: 0.0378s/iter; left time: 695.8057s
Epoch: 31 cost time: 10.340055465698242
Epoch: 31, Steps: 266 | Train Loss: 0.3389588 Vali Loss: 0.6985382 Test Loss: 0.4346066
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3485305
	speed: 0.1468s/iter; left time: 2680.4894s
	iters: 200, epoch: 32 | loss: 0.3622456
	speed: 0.0313s/iter; left time: 567.3829s
Epoch: 32 cost time: 8.93994426727295
Epoch: 32, Steps: 266 | Train Loss: 0.3389930 Vali Loss: 0.6995209 Test Loss: 0.4345618
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3366911
	speed: 0.1240s/iter; left time: 2230.9484s
	iters: 200, epoch: 33 | loss: 0.3256207
	speed: 0.0200s/iter; left time: 358.2915s
Epoch: 33 cost time: 7.6839518547058105
Epoch: 33, Steps: 266 | Train Loss: 0.3389713 Vali Loss: 0.6991488 Test Loss: 0.4346224
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3504268
	speed: 0.1058s/iter; left time: 1875.8513s
	iters: 200, epoch: 34 | loss: 0.3145430
	speed: 0.0223s/iter; left time: 393.8161s
Epoch: 34 cost time: 6.478480577468872
Epoch: 34, Steps: 266 | Train Loss: 0.3388367 Vali Loss: 0.6996395 Test Loss: 0.4346889
EarlyStopping counter: 20 out of 20
Early stopping
train 34135
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=22, out_features=104, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2050048.0
params:  2392.0
Trainable parameters:  2392
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4209088
	speed: 0.0427s/iter; left time: 1131.9163s
	iters: 200, epoch: 1 | loss: 0.4576255
	speed: 0.0251s/iter; left time: 662.3339s
Epoch: 1 cost time: 8.097686529159546
Epoch: 1, Steps: 266 | Train Loss: 0.4242007 Vali Loss: 0.6950901 Test Loss: 0.4309671
Validation loss decreased (inf --> 0.695090).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4354891
	speed: 0.1588s/iter; left time: 4166.6982s
	iters: 200, epoch: 2 | loss: 0.4644904
	speed: 0.0191s/iter; left time: 498.2866s
Epoch: 2 cost time: 7.462246894836426
Epoch: 2, Steps: 266 | Train Loss: 0.4235079 Vali Loss: 0.6955714 Test Loss: 0.4310218
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4695374
	speed: 0.1653s/iter; left time: 4292.5016s
	iters: 200, epoch: 3 | loss: 0.4055241
	speed: 0.0198s/iter; left time: 512.2084s
Epoch: 3 cost time: 6.370004653930664
Epoch: 3, Steps: 266 | Train Loss: 0.4234855 Vali Loss: 0.6954411 Test Loss: 0.4314583
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4149718
	speed: 0.1212s/iter; left time: 3114.0323s
	iters: 200, epoch: 4 | loss: 0.4722967
	speed: 0.0175s/iter; left time: 447.3224s
Epoch: 4 cost time: 5.914674997329712
Epoch: 4, Steps: 266 | Train Loss: 0.4233308 Vali Loss: 0.6952915 Test Loss: 0.4306642
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4050275
	speed: 0.1029s/iter; left time: 2617.2809s
	iters: 200, epoch: 5 | loss: 0.3712751
	speed: 0.0341s/iter; left time: 864.7073s
Epoch: 5 cost time: 8.576571702957153
Epoch: 5, Steps: 266 | Train Loss: 0.4234990 Vali Loss: 0.6952318 Test Loss: 0.4310258
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4263879
	speed: 0.1246s/iter; left time: 3135.1856s
	iters: 200, epoch: 6 | loss: 0.3868786
	speed: 0.0278s/iter; left time: 696.6575s
Epoch: 6 cost time: 7.473022699356079
Epoch: 6, Steps: 266 | Train Loss: 0.4231611 Vali Loss: 0.6949206 Test Loss: 0.4311729
Validation loss decreased (0.695090 --> 0.694921).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4370810
	speed: 0.1521s/iter; left time: 3788.2383s
	iters: 200, epoch: 7 | loss: 0.4158765
	speed: 0.0199s/iter; left time: 493.8651s
Epoch: 7 cost time: 7.93000340461731
Epoch: 7, Steps: 266 | Train Loss: 0.4233459 Vali Loss: 0.6945813 Test Loss: 0.4309899
Validation loss decreased (0.694921 --> 0.694581).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4095494
	speed: 0.1093s/iter; left time: 2693.6968s
	iters: 200, epoch: 8 | loss: 0.4255072
	speed: 0.0237s/iter; left time: 580.8821s
Epoch: 8 cost time: 6.447201251983643
Epoch: 8, Steps: 266 | Train Loss: 0.4234323 Vali Loss: 0.6949446 Test Loss: 0.4313933
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3990479
	speed: 0.1084s/iter; left time: 2641.4839s
	iters: 200, epoch: 9 | loss: 0.3688572
	speed: 0.0212s/iter; left time: 514.4288s
Epoch: 9 cost time: 7.004431962966919
Epoch: 9, Steps: 266 | Train Loss: 0.4232051 Vali Loss: 0.6950278 Test Loss: 0.4315409
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.4445410
	speed: 0.1243s/iter; left time: 2996.6735s
	iters: 200, epoch: 10 | loss: 0.4341441
	speed: 0.0270s/iter; left time: 648.1888s
Epoch: 10 cost time: 6.8109331130981445
Epoch: 10, Steps: 266 | Train Loss: 0.4232817 Vali Loss: 0.6946905 Test Loss: 0.4311520
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.4082086
	speed: 0.1075s/iter; left time: 2562.0570s
	iters: 200, epoch: 11 | loss: 0.3787873
	speed: 0.0200s/iter; left time: 473.7998s
Epoch: 11 cost time: 6.97882342338562
Epoch: 11, Steps: 266 | Train Loss: 0.4232980 Vali Loss: 0.6946349 Test Loss: 0.4308515
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.4478985
	speed: 0.1375s/iter; left time: 3242.3816s
	iters: 200, epoch: 12 | loss: 0.3799343
	speed: 0.0282s/iter; left time: 662.7896s
Epoch: 12 cost time: 9.10214352607727
Epoch: 12, Steps: 266 | Train Loss: 0.4232987 Vali Loss: 0.6953950 Test Loss: 0.4314207
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4490853
	speed: 0.1222s/iter; left time: 2849.4047s
	iters: 200, epoch: 13 | loss: 0.4090183
	speed: 0.0213s/iter; left time: 493.8135s
Epoch: 13 cost time: 6.992053747177124
Epoch: 13, Steps: 266 | Train Loss: 0.4233078 Vali Loss: 0.6948951 Test Loss: 0.4310323
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.4528343
	speed: 0.1378s/iter; left time: 3174.6852s
	iters: 200, epoch: 14 | loss: 0.4028805
	speed: 0.0175s/iter; left time: 401.2112s
Epoch: 14 cost time: 6.002961874008179
Epoch: 14, Steps: 266 | Train Loss: 0.4234376 Vali Loss: 0.6944773 Test Loss: 0.4312121
Validation loss decreased (0.694581 --> 0.694477).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.4121223
	speed: 0.1438s/iter; left time: 3276.3521s
	iters: 200, epoch: 15 | loss: 0.4710171
	speed: 0.0292s/iter; left time: 662.9883s
Epoch: 15 cost time: 9.241584300994873
Epoch: 15, Steps: 266 | Train Loss: 0.4232299 Vali Loss: 0.6946620 Test Loss: 0.4311468
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4043326
	speed: 0.1767s/iter; left time: 3976.9124s
	iters: 200, epoch: 16 | loss: 0.4575961
	speed: 0.0320s/iter; left time: 716.6621s
Epoch: 16 cost time: 10.285231113433838
Epoch: 16, Steps: 266 | Train Loss: 0.4233357 Vali Loss: 0.6948813 Test Loss: 0.4309929
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4340187
	speed: 0.1733s/iter; left time: 3855.7712s
	iters: 200, epoch: 17 | loss: 0.3935564
	speed: 0.0284s/iter; left time: 629.1617s
Epoch: 17 cost time: 10.386952638626099
Epoch: 17, Steps: 266 | Train Loss: 0.4232267 Vali Loss: 0.6948028 Test Loss: 0.4312984
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.4172466
	speed: 0.1098s/iter; left time: 2412.6718s
	iters: 200, epoch: 18 | loss: 0.4289274
	speed: 0.0236s/iter; left time: 516.6151s
Epoch: 18 cost time: 7.309755802154541
Epoch: 18, Steps: 266 | Train Loss: 0.4233104 Vali Loss: 0.6951669 Test Loss: 0.4313072
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4116179
	speed: 0.1328s/iter; left time: 2883.3059s
	iters: 200, epoch: 19 | loss: 0.4933894
	speed: 0.0233s/iter; left time: 502.9153s
Epoch: 19 cost time: 8.510210752487183
Epoch: 19, Steps: 266 | Train Loss: 0.4232335 Vali Loss: 0.6954294 Test Loss: 0.4313240
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.4436874
	speed: 0.1408s/iter; left time: 3019.2876s
	iters: 200, epoch: 20 | loss: 0.4351116
	speed: 0.0281s/iter; left time: 600.6714s
Epoch: 20 cost time: 8.767589569091797
Epoch: 20, Steps: 266 | Train Loss: 0.4233044 Vali Loss: 0.6942127 Test Loss: 0.4312988
Validation loss decreased (0.694477 --> 0.694213).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4451252
	speed: 0.1282s/iter; left time: 2715.3162s
	iters: 200, epoch: 21 | loss: 0.4372682
	speed: 0.0217s/iter; left time: 457.7152s
Epoch: 21 cost time: 6.227713584899902
Epoch: 21, Steps: 266 | Train Loss: 0.4231670 Vali Loss: 0.6946543 Test Loss: 0.4315376
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4030143
	speed: 0.1630s/iter; left time: 3409.8639s
	iters: 200, epoch: 22 | loss: 0.3857761
	speed: 0.0205s/iter; left time: 426.0859s
Epoch: 22 cost time: 8.399268388748169
Epoch: 22, Steps: 266 | Train Loss: 0.4233614 Vali Loss: 0.6946943 Test Loss: 0.4311061
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.4766403
	speed: 0.1327s/iter; left time: 2740.5214s
	iters: 200, epoch: 23 | loss: 0.4210103
	speed: 0.0241s/iter; left time: 495.2599s
Epoch: 23 cost time: 7.705800771713257
Epoch: 23, Steps: 266 | Train Loss: 0.4231697 Vali Loss: 0.6946079 Test Loss: 0.4309633
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.4092287
	speed: 0.1225s/iter; left time: 2497.4383s
	iters: 200, epoch: 24 | loss: 0.3500961
	speed: 0.0266s/iter; left time: 540.4714s
Epoch: 24 cost time: 7.8957273960113525
Epoch: 24, Steps: 266 | Train Loss: 0.4232645 Vali Loss: 0.6940257 Test Loss: 0.4311036
Validation loss decreased (0.694213 --> 0.694026).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4168720
	speed: 0.1351s/iter; left time: 2718.4321s
	iters: 200, epoch: 25 | loss: 0.4291970
	speed: 0.0215s/iter; left time: 429.4088s
Epoch: 25 cost time: 7.354384422302246
Epoch: 25, Steps: 266 | Train Loss: 0.4231960 Vali Loss: 0.6940932 Test Loss: 0.4312305
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.4357515
	speed: 0.1432s/iter; left time: 2842.2245s
	iters: 200, epoch: 26 | loss: 0.4183773
	speed: 0.0335s/iter; left time: 660.9664s
Epoch: 26 cost time: 8.271779775619507
Epoch: 26, Steps: 266 | Train Loss: 0.4232859 Vali Loss: 0.6935296 Test Loss: 0.4311895
Validation loss decreased (0.694026 --> 0.693530).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.4227805
	speed: 0.1358s/iter; left time: 2659.1404s
	iters: 200, epoch: 27 | loss: 0.4424332
	speed: 0.0186s/iter; left time: 361.9805s
Epoch: 27 cost time: 6.876468181610107
Epoch: 27, Steps: 266 | Train Loss: 0.4231163 Vali Loss: 0.6947576 Test Loss: 0.4312742
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.4213494
	speed: 0.1172s/iter; left time: 2263.5193s
	iters: 200, epoch: 28 | loss: 0.4441541
	speed: 0.0208s/iter; left time: 400.5782s
Epoch: 28 cost time: 6.638221502304077
Epoch: 28, Steps: 266 | Train Loss: 0.4232754 Vali Loss: 0.6950712 Test Loss: 0.4310229
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.4439981
	speed: 0.1337s/iter; left time: 2546.8307s
	iters: 200, epoch: 29 | loss: 0.4429372
	speed: 0.0525s/iter; left time: 995.9725s
Epoch: 29 cost time: 10.522757530212402
Epoch: 29, Steps: 266 | Train Loss: 0.4232506 Vali Loss: 0.6952792 Test Loss: 0.4312410
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4102693
	speed: 0.1167s/iter; left time: 2192.0632s
	iters: 200, epoch: 30 | loss: 0.4144619
	speed: 0.0299s/iter; left time: 558.3598s
Epoch: 30 cost time: 9.71444058418274
Epoch: 30, Steps: 266 | Train Loss: 0.4233882 Vali Loss: 0.6946965 Test Loss: 0.4311797
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3947451
	speed: 0.1804s/iter; left time: 3340.4459s
	iters: 200, epoch: 31 | loss: 0.4269172
	speed: 0.0255s/iter; left time: 470.3031s
Epoch: 31 cost time: 8.391648054122925
Epoch: 31, Steps: 266 | Train Loss: 0.4231623 Vali Loss: 0.6949812 Test Loss: 0.4312131
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3990889
	speed: 0.1245s/iter; left time: 2272.1950s
	iters: 200, epoch: 32 | loss: 0.4552502
	speed: 0.0282s/iter; left time: 511.0869s
Epoch: 32 cost time: 7.122093439102173
Epoch: 32, Steps: 266 | Train Loss: 0.4232445 Vali Loss: 0.6943762 Test Loss: 0.4312491
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.4184390
	speed: 0.1328s/iter; left time: 2388.4904s
	iters: 200, epoch: 33 | loss: 0.4521465
	speed: 0.0221s/iter; left time: 395.7584s
Epoch: 33 cost time: 6.5730791091918945
Epoch: 33, Steps: 266 | Train Loss: 0.4230934 Vali Loss: 0.6945142 Test Loss: 0.4312551
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.4203979
	speed: 0.1468s/iter; left time: 2602.2145s
	iters: 200, epoch: 34 | loss: 0.4415525
	speed: 0.0222s/iter; left time: 390.9543s
Epoch: 34 cost time: 7.7435622215271
Epoch: 34, Steps: 266 | Train Loss: 0.4232771 Vali Loss: 0.6951185 Test Loss: 0.4312584
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.4377715
	speed: 0.1429s/iter; left time: 2495.3702s
	iters: 200, epoch: 35 | loss: 0.3832079
	speed: 0.0209s/iter; left time: 363.1725s
Epoch: 35 cost time: 6.488738536834717
Epoch: 35, Steps: 266 | Train Loss: 0.4231844 Vali Loss: 0.6955979 Test Loss: 0.4312805
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.4269064
	speed: 0.1290s/iter; left time: 2218.1974s
	iters: 200, epoch: 36 | loss: 0.4569080
	speed: 0.0419s/iter; left time: 715.8729s
Epoch: 36 cost time: 10.13010549545288
Epoch: 36, Steps: 266 | Train Loss: 0.4231985 Vali Loss: 0.6951438 Test Loss: 0.4311149
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.4304343
	speed: 0.1159s/iter; left time: 1962.3949s
	iters: 200, epoch: 37 | loss: 0.4075737
	speed: 0.0230s/iter; left time: 387.1639s
Epoch: 37 cost time: 8.071053266525269
Epoch: 37, Steps: 266 | Train Loss: 0.4232441 Vali Loss: 0.6943336 Test Loss: 0.4311485
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3608207
	speed: 0.1302s/iter; left time: 2169.0113s
	iters: 200, epoch: 38 | loss: 0.4359331
	speed: 0.0188s/iter; left time: 311.8003s
Epoch: 38 cost time: 6.681401491165161
Epoch: 38, Steps: 266 | Train Loss: 0.4232516 Vali Loss: 0.6948898 Test Loss: 0.4311662
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.4369489
	speed: 0.1312s/iter; left time: 2150.1333s
	iters: 200, epoch: 39 | loss: 0.4072694
	speed: 0.0234s/iter; left time: 382.0462s
Epoch: 39 cost time: 8.396490812301636
Epoch: 39, Steps: 266 | Train Loss: 0.4230795 Vali Loss: 0.6941184 Test Loss: 0.4312156
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.4567008
	speed: 0.1210s/iter; left time: 1952.0520s
	iters: 200, epoch: 40 | loss: 0.4559423
	speed: 0.0299s/iter; left time: 478.9710s
Epoch: 40 cost time: 6.995705604553223
Epoch: 40, Steps: 266 | Train Loss: 0.4232748 Vali Loss: 0.6950882 Test Loss: 0.4312225
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3735627
	speed: 0.1499s/iter; left time: 2378.0980s
	iters: 200, epoch: 41 | loss: 0.4085951
	speed: 0.0193s/iter; left time: 304.4540s
Epoch: 41 cost time: 8.515779972076416
Epoch: 41, Steps: 266 | Train Loss: 0.4232402 Vali Loss: 0.6945484 Test Loss: 0.4311719
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3943319
	speed: 0.1116s/iter; left time: 1740.4909s
	iters: 200, epoch: 42 | loss: 0.4072649
	speed: 0.0188s/iter; left time: 292.0661s
Epoch: 42 cost time: 5.9131669998168945
Epoch: 42, Steps: 266 | Train Loss: 0.4231312 Vali Loss: 0.6940647 Test Loss: 0.4312439
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3853399
	speed: 0.1060s/iter; left time: 1624.8683s
	iters: 200, epoch: 43 | loss: 0.4003837
	speed: 0.0173s/iter; left time: 263.2699s
Epoch: 43 cost time: 5.302179574966431
Epoch: 43, Steps: 266 | Train Loss: 0.4230790 Vali Loss: 0.6948323 Test Loss: 0.4312589
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.4372889
	speed: 0.1004s/iter; left time: 1511.8358s
	iters: 200, epoch: 44 | loss: 0.4727723
	speed: 0.0174s/iter; left time: 260.3304s
Epoch: 44 cost time: 5.403924465179443
Epoch: 44, Steps: 266 | Train Loss: 0.4231481 Vali Loss: 0.6945659 Test Loss: 0.4311639
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.3921032
	speed: 0.1154s/iter; left time: 1707.3628s
	iters: 200, epoch: 45 | loss: 0.4528069
	speed: 0.0194s/iter; left time: 285.8521s
Epoch: 45 cost time: 6.3359055519104
Epoch: 45, Steps: 266 | Train Loss: 0.4231146 Vali Loss: 0.6955513 Test Loss: 0.4311599
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.4146717
	speed: 0.1159s/iter; left time: 1684.8651s
	iters: 200, epoch: 46 | loss: 0.4052293
	speed: 0.0278s/iter; left time: 401.1032s
Epoch: 46 cost time: 9.018079280853271
Epoch: 46, Steps: 266 | Train Loss: 0.4230640 Vali Loss: 0.6952353 Test Loss: 0.4311400
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_336_FITS_ETTm1_ftM_sl90_ll48_pl336_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4312828481197357, mae:0.41899779438972473, rse:0.6249272227287292, corr:[0.5459096  0.545639   0.54136705 0.5402668  0.5378306  0.53394836
 0.53174263 0.53074354 0.52897716 0.5271857  0.52660435 0.52630985
 0.5252069  0.5233005  0.52083075 0.51757526 0.5140487  0.51098984
 0.50815713 0.5051058  0.50192255 0.49902704 0.49630278 0.49302745
 0.48910472 0.4851952  0.48225847 0.48005554 0.4779597  0.4757505
 0.4744808  0.47473323 0.47511563 0.47531474 0.47568718 0.47632498
 0.4762951  0.4759213  0.47580713 0.47595793 0.47604942 0.47568274
 0.47550923 0.47578147 0.47571784 0.4750317  0.4744079  0.47442287
 0.47493467 0.47547302 0.4758745  0.47608396 0.4763688  0.4765906
 0.47699443 0.47756717 0.4783026  0.47876227 0.47855747 0.47825176
 0.4781181  0.4777078  0.47727054 0.47693744 0.47701484 0.4769217
 0.47628388 0.47580448 0.47628573 0.4772613  0.47759867 0.477562
 0.4780523  0.47905314 0.48002055 0.48040178 0.48096856 0.48215964
 0.48336512 0.48399422 0.48417193 0.4843057  0.4848603  0.48540184
 0.48573148 0.48598224 0.48651084 0.48738277 0.48838264 0.48933342
 0.49018943 0.49087444 0.49128783 0.49141926 0.49138662 0.4911863
 0.49057055 0.48953715 0.48836553 0.48741168 0.48690563 0.48670325
 0.4865286  0.48615918 0.48573413 0.48527396 0.48476765 0.4842161
 0.48351887 0.48259857 0.48152965 0.48048913 0.47953755 0.47859713
 0.47756612 0.47669274 0.4759241  0.47499973 0.47380456 0.4725379
 0.47147766 0.47027078 0.4687761  0.46756285 0.46683002 0.4662905
 0.46568915 0.4650695  0.46470532 0.4646994  0.464896   0.46507528
 0.46501884 0.46496302 0.46486363 0.46472514 0.4645705  0.46442512
 0.46426767 0.46417195 0.4641232  0.46407673 0.46396017 0.46397093
 0.46414647 0.46440268 0.46457782 0.46458843 0.46489513 0.46528044
 0.46548113 0.4657133  0.46600315 0.46629047 0.4663058  0.46616665
 0.46600252 0.46603578 0.4661401  0.46607414 0.46587858 0.46569374
 0.4657608  0.46608388 0.46654478 0.4670362  0.46766883 0.46849284
 0.4693204  0.4699246  0.47037715 0.4710808  0.47189263 0.47263315
 0.4731672  0.4736059  0.47400078 0.47438702 0.474704   0.47504425
 0.47533008 0.47569364 0.47625366 0.47701412 0.4777623  0.47844988
 0.47930992 0.48020384 0.48063692 0.48049864 0.4803674  0.48068446
 0.48131835 0.48206595 0.48290887 0.48393035 0.48501804 0.48593548
 0.4864406  0.4864621  0.48634884 0.48613214 0.48559752 0.48475286
 0.48380908 0.4828763  0.48168224 0.48021373 0.47861704 0.47717798
 0.47584087 0.47456726 0.47341827 0.4721998  0.47069666 0.46902457
 0.4671918  0.46554202 0.46421233 0.46320614 0.46222714 0.46137837
 0.4608783  0.4608163  0.4606631  0.4603959  0.46062797 0.46088037
 0.46074244 0.46046013 0.46033266 0.46024108 0.46004936 0.45958668
 0.45919982 0.45905903 0.45878404 0.45846853 0.45853266 0.45883372
 0.4593032  0.4593603  0.45918357 0.45931366 0.45960715 0.45998514
 0.46026358 0.46057686 0.46091098 0.46130937 0.4614345  0.46154436
 0.46154886 0.46153864 0.4613326  0.46145636 0.46162474 0.46151432
 0.4613284  0.4615002  0.46192527 0.4625027  0.4629678  0.4632893
 0.46394232 0.46469462 0.4653076  0.46587008 0.46669254 0.4676601
 0.46867523 0.469394   0.4699281  0.4704539  0.4710733  0.47163638
 0.47207674 0.47255912 0.47311825 0.473821   0.47454578 0.475263
 0.47598934 0.4766177  0.4769715  0.4769131  0.47634685 0.47520205
 0.4733059  0.47087663 0.4687148  0.46740022 0.46670014 0.46618247
 0.46574205 0.46556872 0.46561888 0.46542507 0.46484962 0.46414036
 0.46339682 0.4623174  0.46079397 0.4592294  0.45814112 0.457404
 0.45677856 0.45602193 0.45527408 0.45453036 0.45369524 0.45275143
 0.4517429  0.4506966  0.4497165  0.44905418 0.44840485 0.44762468
 0.44672462 0.44618216 0.44619602 0.44611898 0.44539526 0.44472134
 0.4447155  0.44487578 0.44420254 0.4434226  0.44370446 0.44417167
 0.4436986  0.44332218 0.44475126 0.4460943  0.4459376  0.44842398]
