Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  650496.0
params:  759.0
Trainable parameters:  759
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3746028
	speed: 0.0170s/iter; left time: 452.0543s
	iters: 200, epoch: 1 | loss: 0.2748633
	speed: 0.0113s/iter; left time: 299.7937s
Epoch: 1 cost time: 3.6041641235351562
Epoch: 1, Steps: 267 | Train Loss: 0.3535586 Vali Loss: 0.6290385 Test Loss: 0.5097688
Validation loss decreased (inf --> 0.629038).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2214526
	speed: 0.0610s/iter; left time: 1605.2010s
	iters: 200, epoch: 2 | loss: 0.2050321
	speed: 0.0110s/iter; left time: 289.7170s
Epoch: 2 cost time: 3.4847567081451416
Epoch: 2, Steps: 267 | Train Loss: 0.2173832 Vali Loss: 0.5360386 Test Loss: 0.4258867
Validation loss decreased (0.629038 --> 0.536039).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1707037
	speed: 0.0602s/iter; left time: 1569.5135s
	iters: 200, epoch: 3 | loss: 0.1581350
	speed: 0.0132s/iter; left time: 341.5152s
Epoch: 3 cost time: 3.6396021842956543
Epoch: 3, Steps: 267 | Train Loss: 0.1723452 Vali Loss: 0.4952234 Test Loss: 0.3878427
Validation loss decreased (0.536039 --> 0.495223).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1528891
	speed: 0.0612s/iter; left time: 1578.0071s
	iters: 200, epoch: 4 | loss: 0.1480162
	speed: 0.0092s/iter; left time: 237.4167s
Epoch: 4 cost time: 3.269746780395508
Epoch: 4, Steps: 267 | Train Loss: 0.1504941 Vali Loss: 0.4675962 Test Loss: 0.3633965
Validation loss decreased (0.495223 --> 0.467596).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1347772
	speed: 0.0619s/iter; left time: 1581.4987s
	iters: 200, epoch: 5 | loss: 0.1407664
	speed: 0.0111s/iter; left time: 283.0721s
Epoch: 5 cost time: 3.519411087036133
Epoch: 5, Steps: 267 | Train Loss: 0.1376944 Vali Loss: 0.4512306 Test Loss: 0.3488802
Validation loss decreased (0.467596 --> 0.451231).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1271450
	speed: 0.0619s/iter; left time: 1564.3891s
	iters: 200, epoch: 6 | loss: 0.1244318
	speed: 0.0103s/iter; left time: 259.2250s
Epoch: 6 cost time: 3.6148252487182617
Epoch: 6, Steps: 267 | Train Loss: 0.1296715 Vali Loss: 0.4389225 Test Loss: 0.3384307
Validation loss decreased (0.451231 --> 0.438922).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1248568
	speed: 0.0556s/iter; left time: 1389.1774s
	iters: 200, epoch: 7 | loss: 0.1191424
	speed: 0.0117s/iter; left time: 292.0709s
Epoch: 7 cost time: 3.4704928398132324
Epoch: 7, Steps: 267 | Train Loss: 0.1246270 Vali Loss: 0.4315725 Test Loss: 0.3314902
Validation loss decreased (0.438922 --> 0.431573).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1118120
	speed: 0.0634s/iter; left time: 1569.0084s
	iters: 200, epoch: 8 | loss: 0.1117502
	speed: 0.0105s/iter; left time: 259.3024s
Epoch: 8 cost time: 3.480848550796509
Epoch: 8, Steps: 267 | Train Loss: 0.1215160 Vali Loss: 0.4259616 Test Loss: 0.3270021
Validation loss decreased (0.431573 --> 0.425962).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1179650
	speed: 0.0572s/iter; left time: 1400.4712s
	iters: 200, epoch: 9 | loss: 0.1194443
	speed: 0.0104s/iter; left time: 254.1269s
Epoch: 9 cost time: 3.3227617740631104
Epoch: 9, Steps: 267 | Train Loss: 0.1195424 Vali Loss: 0.4229008 Test Loss: 0.3238905
Validation loss decreased (0.425962 --> 0.422901).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1096906
	speed: 0.0603s/iter; left time: 1458.2670s
	iters: 200, epoch: 10 | loss: 0.1167676
	speed: 0.0104s/iter; left time: 251.4215s
Epoch: 10 cost time: 3.471567392349243
Epoch: 10, Steps: 267 | Train Loss: 0.1184261 Vali Loss: 0.4197371 Test Loss: 0.3214607
Validation loss decreased (0.422901 --> 0.419737).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1203530
	speed: 0.0613s/iter; left time: 1466.1776s
	iters: 200, epoch: 11 | loss: 0.1135924
	speed: 0.0110s/iter; left time: 262.1905s
Epoch: 11 cost time: 3.5172531604766846
Epoch: 11, Steps: 267 | Train Loss: 0.1177839 Vali Loss: 0.4165874 Test Loss: 0.3194993
Validation loss decreased (0.419737 --> 0.416587).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1115991
	speed: 0.0605s/iter; left time: 1432.8390s
	iters: 200, epoch: 12 | loss: 0.1226250
	speed: 0.0113s/iter; left time: 265.2238s
Epoch: 12 cost time: 3.56341290473938
Epoch: 12, Steps: 267 | Train Loss: 0.1174415 Vali Loss: 0.4158595 Test Loss: 0.3188651
Validation loss decreased (0.416587 --> 0.415859).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1166405
	speed: 0.0623s/iter; left time: 1458.0365s
	iters: 200, epoch: 13 | loss: 0.1149545
	speed: 0.0169s/iter; left time: 394.5269s
Epoch: 13 cost time: 4.018181562423706
Epoch: 13, Steps: 267 | Train Loss: 0.1172372 Vali Loss: 0.4158726 Test Loss: 0.3187297
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1198296
	speed: 0.0623s/iter; left time: 1441.6238s
	iters: 200, epoch: 14 | loss: 0.1021580
	speed: 0.0117s/iter; left time: 268.9010s
Epoch: 14 cost time: 3.6937742233276367
Epoch: 14, Steps: 267 | Train Loss: 0.1171911 Vali Loss: 0.4148700 Test Loss: 0.3180911
Validation loss decreased (0.415859 --> 0.414870).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1192668
	speed: 0.0624s/iter; left time: 1426.5934s
	iters: 200, epoch: 15 | loss: 0.1134980
	speed: 0.0105s/iter; left time: 238.2830s
Epoch: 15 cost time: 3.5771164894104004
Epoch: 15, Steps: 267 | Train Loss: 0.1171324 Vali Loss: 0.4138629 Test Loss: 0.3179845
Validation loss decreased (0.414870 --> 0.413863).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1233916
	speed: 0.0618s/iter; left time: 1396.6747s
	iters: 200, epoch: 16 | loss: 0.1191062
	speed: 0.0110s/iter; left time: 247.0690s
Epoch: 16 cost time: 3.555036783218384
Epoch: 16, Steps: 267 | Train Loss: 0.1170607 Vali Loss: 0.4140440 Test Loss: 0.3179105
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1038599
	speed: 0.0614s/iter; left time: 1370.7547s
	iters: 200, epoch: 17 | loss: 0.1242943
	speed: 0.0107s/iter; left time: 237.8867s
Epoch: 17 cost time: 3.5096404552459717
Epoch: 17, Steps: 267 | Train Loss: 0.1170908 Vali Loss: 0.4142899 Test Loss: 0.3173579
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1173326
	speed: 0.0569s/iter; left time: 1256.1615s
	iters: 200, epoch: 18 | loss: 0.1117342
	speed: 0.0108s/iter; left time: 236.3789s
Epoch: 18 cost time: 3.4147791862487793
Epoch: 18, Steps: 267 | Train Loss: 0.1170699 Vali Loss: 0.4141472 Test Loss: 0.3174215
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1119440
	speed: 0.0616s/iter; left time: 1342.5660s
	iters: 200, epoch: 19 | loss: 0.1298766
	speed: 0.0108s/iter; left time: 234.4156s
Epoch: 19 cost time: 3.5381667613983154
Epoch: 19, Steps: 267 | Train Loss: 0.1170534 Vali Loss: 0.4140442 Test Loss: 0.3171999
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1142501
	speed: 0.0586s/iter; left time: 1260.6254s
	iters: 200, epoch: 20 | loss: 0.1244647
	speed: 0.0108s/iter; left time: 230.7179s
Epoch: 20 cost time: 3.3945088386535645
Epoch: 20, Steps: 267 | Train Loss: 0.1170483 Vali Loss: 0.4138662 Test Loss: 0.3172486
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1184904
	speed: 0.0593s/iter; left time: 1260.2371s
	iters: 200, epoch: 21 | loss: 0.1185296
	speed: 0.0109s/iter; left time: 231.4018s
Epoch: 21 cost time: 3.4250078201293945
Epoch: 21, Steps: 267 | Train Loss: 0.1170165 Vali Loss: 0.4137764 Test Loss: 0.3173046
Validation loss decreased (0.413863 --> 0.413776).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1090358
	speed: 0.0619s/iter; left time: 1298.5509s
	iters: 200, epoch: 22 | loss: 0.1122166
	speed: 0.0110s/iter; left time: 230.4652s
Epoch: 22 cost time: 3.479733943939209
Epoch: 22, Steps: 267 | Train Loss: 0.1170861 Vali Loss: 0.4142736 Test Loss: 0.3175235
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1106105
	speed: 0.0622s/iter; left time: 1288.2427s
	iters: 200, epoch: 23 | loss: 0.1174904
	speed: 0.0109s/iter; left time: 223.8593s
Epoch: 23 cost time: 3.574262857437134
Epoch: 23, Steps: 267 | Train Loss: 0.1170667 Vali Loss: 0.4143998 Test Loss: 0.3173521
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1257172
	speed: 0.0620s/iter; left time: 1268.8747s
	iters: 200, epoch: 24 | loss: 0.1145853
	speed: 0.0110s/iter; left time: 224.1892s
Epoch: 24 cost time: 3.504042387008667
Epoch: 24, Steps: 267 | Train Loss: 0.1170581 Vali Loss: 0.4132763 Test Loss: 0.3173032
Validation loss decreased (0.413776 --> 0.413276).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1133151
	speed: 0.0613s/iter; left time: 1238.1765s
	iters: 200, epoch: 25 | loss: 0.1187308
	speed: 0.0117s/iter; left time: 234.6941s
Epoch: 25 cost time: 3.604316473007202
Epoch: 25, Steps: 267 | Train Loss: 0.1170883 Vali Loss: 0.4142062 Test Loss: 0.3175339
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1144580
	speed: 0.0612s/iter; left time: 1220.3173s
	iters: 200, epoch: 26 | loss: 0.1049078
	speed: 0.0102s/iter; left time: 202.9812s
Epoch: 26 cost time: 3.2556469440460205
Epoch: 26, Steps: 267 | Train Loss: 0.1170465 Vali Loss: 0.4140757 Test Loss: 0.3175245
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1114629
	speed: 0.0612s/iter; left time: 1202.2506s
	iters: 200, epoch: 27 | loss: 0.1141990
	speed: 0.0108s/iter; left time: 211.2935s
Epoch: 27 cost time: 3.5331053733825684
Epoch: 27, Steps: 267 | Train Loss: 0.1170331 Vali Loss: 0.4140775 Test Loss: 0.3172943
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1052010
	speed: 0.0629s/iter; left time: 1219.9021s
	iters: 200, epoch: 28 | loss: 0.1229407
	speed: 0.0113s/iter; left time: 217.5146s
Epoch: 28 cost time: 3.6062278747558594
Epoch: 28, Steps: 267 | Train Loss: 0.1170417 Vali Loss: 0.4138312 Test Loss: 0.3172731
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1132587
	speed: 0.0627s/iter; left time: 1198.9598s
	iters: 200, epoch: 29 | loss: 0.1198943
	speed: 0.0122s/iter; left time: 231.3789s
Epoch: 29 cost time: 3.8112857341766357
Epoch: 29, Steps: 267 | Train Loss: 0.1170521 Vali Loss: 0.4137873 Test Loss: 0.3172861
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1248544
	speed: 0.0689s/iter; left time: 1299.4618s
	iters: 200, epoch: 30 | loss: 0.1168136
	speed: 0.0120s/iter; left time: 224.5652s
Epoch: 30 cost time: 3.9091854095458984
Epoch: 30, Steps: 267 | Train Loss: 0.1170130 Vali Loss: 0.4139898 Test Loss: 0.3174722
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1311929
	speed: 0.0653s/iter; left time: 1214.1300s
	iters: 200, epoch: 31 | loss: 0.1251467
	speed: 0.0111s/iter; left time: 205.7227s
Epoch: 31 cost time: 3.653165578842163
Epoch: 31, Steps: 267 | Train Loss: 0.1170754 Vali Loss: 0.4134814 Test Loss: 0.3170438
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1264983
	speed: 0.0643s/iter; left time: 1179.0247s
	iters: 200, epoch: 32 | loss: 0.1158692
	speed: 0.0107s/iter; left time: 195.7078s
Epoch: 32 cost time: 3.7154653072357178
Epoch: 32, Steps: 267 | Train Loss: 0.1169946 Vali Loss: 0.4139733 Test Loss: 0.3174675
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1122572
	speed: 0.0637s/iter; left time: 1151.1240s
	iters: 200, epoch: 33 | loss: 0.1207178
	speed: 0.0107s/iter; left time: 191.5129s
Epoch: 33 cost time: 3.4936769008636475
Epoch: 33, Steps: 267 | Train Loss: 0.1170936 Vali Loss: 0.4141337 Test Loss: 0.3174924
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1083095
	speed: 0.0592s/iter; left time: 1052.5822s
	iters: 200, epoch: 34 | loss: 0.1143467
	speed: 0.0110s/iter; left time: 193.8047s
Epoch: 34 cost time: 3.3819425106048584
Epoch: 34, Steps: 267 | Train Loss: 0.1170326 Vali Loss: 0.4140357 Test Loss: 0.3173724
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1021075
	speed: 0.0608s/iter; left time: 1066.1528s
	iters: 200, epoch: 35 | loss: 0.1150068
	speed: 0.0107s/iter; left time: 185.6752s
Epoch: 35 cost time: 3.474501848220825
Epoch: 35, Steps: 267 | Train Loss: 0.1170664 Vali Loss: 0.4138602 Test Loss: 0.3171945
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1076799
	speed: 0.0617s/iter; left time: 1064.5662s
	iters: 200, epoch: 36 | loss: 0.1066691
	speed: 0.0107s/iter; left time: 183.9890s
Epoch: 36 cost time: 3.5150794982910156
Epoch: 36, Steps: 267 | Train Loss: 0.1170361 Vali Loss: 0.4135312 Test Loss: 0.3174692
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1140132
	speed: 0.0640s/iter; left time: 1086.8683s
	iters: 200, epoch: 37 | loss: 0.1222348
	speed: 0.0109s/iter; left time: 183.4525s
Epoch: 37 cost time: 3.6099343299865723
Epoch: 37, Steps: 267 | Train Loss: 0.1170553 Vali Loss: 0.4141989 Test Loss: 0.3174976
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1185874
	speed: 0.0616s/iter; left time: 1029.3491s
	iters: 200, epoch: 38 | loss: 0.1255857
	speed: 0.0124s/iter; left time: 206.7863s
Epoch: 38 cost time: 3.5722954273223877
Epoch: 38, Steps: 267 | Train Loss: 0.1169817 Vali Loss: 0.4142159 Test Loss: 0.3173780
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1145501
	speed: 0.0615s/iter; left time: 1012.2045s
	iters: 200, epoch: 39 | loss: 0.1179992
	speed: 0.0106s/iter; left time: 174.1805s
Epoch: 39 cost time: 3.4364635944366455
Epoch: 39, Steps: 267 | Train Loss: 0.1170705 Vali Loss: 0.4143851 Test Loss: 0.3174971
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1194586
	speed: 0.0623s/iter; left time: 1008.1569s
	iters: 200, epoch: 40 | loss: 0.1207263
	speed: 0.0109s/iter; left time: 175.2654s
Epoch: 40 cost time: 3.457005500793457
Epoch: 40, Steps: 267 | Train Loss: 0.1170494 Vali Loss: 0.4140635 Test Loss: 0.3174674
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1122394
	speed: 0.0616s/iter; left time: 980.4469s
	iters: 200, epoch: 41 | loss: 0.1170457
	speed: 0.0110s/iter; left time: 174.1236s
Epoch: 41 cost time: 3.5403237342834473
Epoch: 41, Steps: 267 | Train Loss: 0.1170397 Vali Loss: 0.4138680 Test Loss: 0.3173536
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1206834
	speed: 0.0666s/iter; left time: 1042.2819s
	iters: 200, epoch: 42 | loss: 0.1297479
	speed: 0.0113s/iter; left time: 175.4288s
Epoch: 42 cost time: 3.7559545040130615
Epoch: 42, Steps: 267 | Train Loss: 0.1170488 Vali Loss: 0.4138750 Test Loss: 0.3174996
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1306114
	speed: 0.0589s/iter; left time: 905.7734s
	iters: 200, epoch: 43 | loss: 0.1096716
	speed: 0.0113s/iter; left time: 172.3137s
Epoch: 43 cost time: 3.496946334838867
Epoch: 43, Steps: 267 | Train Loss: 0.1170460 Vali Loss: 0.4140293 Test Loss: 0.3175102
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1193747
	speed: 0.0623s/iter; left time: 941.6661s
	iters: 200, epoch: 44 | loss: 0.1210427
	speed: 0.0121s/iter; left time: 181.3089s
Epoch: 44 cost time: 3.656934976577759
Epoch: 44, Steps: 267 | Train Loss: 0.1170419 Vali Loss: 0.4142567 Test Loss: 0.3174799
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  650496.0
params:  759.0
Trainable parameters:  759
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2997985
	speed: 0.0185s/iter; left time: 492.7545s
	iters: 200, epoch: 1 | loss: 0.2825755
	speed: 0.0109s/iter; left time: 287.8723s
Epoch: 1 cost time: 3.6918587684631348
Epoch: 1, Steps: 267 | Train Loss: 0.2953614 Vali Loss: 0.4090530 Test Loss: 0.3129973
Validation loss decreased (inf --> 0.409053).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2954572
	speed: 0.0632s/iter; left time: 1663.5974s
	iters: 200, epoch: 2 | loss: 0.2857322
	speed: 0.0108s/iter; left time: 283.9585s
Epoch: 2 cost time: 3.6294162273406982
Epoch: 2, Steps: 267 | Train Loss: 0.2938620 Vali Loss: 0.4073585 Test Loss: 0.3123916
Validation loss decreased (0.409053 --> 0.407358).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3000283
	speed: 0.0625s/iter; left time: 1630.0021s
	iters: 200, epoch: 3 | loss: 0.3455370
	speed: 0.0102s/iter; left time: 265.9302s
Epoch: 3 cost time: 3.6287307739257812
Epoch: 3, Steps: 267 | Train Loss: 0.2930918 Vali Loss: 0.4058243 Test Loss: 0.3110962
Validation loss decreased (0.407358 --> 0.405824).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2737782
	speed: 0.0609s/iter; left time: 1570.0709s
	iters: 200, epoch: 4 | loss: 0.2960910
	speed: 0.0081s/iter; left time: 209.1683s
Epoch: 4 cost time: 3.2731125354766846
Epoch: 4, Steps: 267 | Train Loss: 0.2925874 Vali Loss: 0.4051985 Test Loss: 0.3114709
Validation loss decreased (0.405824 --> 0.405199).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2667757
	speed: 0.0640s/iter; left time: 1634.1295s
	iters: 200, epoch: 5 | loss: 0.2938183
	speed: 0.0113s/iter; left time: 288.5613s
Epoch: 5 cost time: 3.6408238410949707
Epoch: 5, Steps: 267 | Train Loss: 0.2924942 Vali Loss: 0.4066006 Test Loss: 0.3116676
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2841350
	speed: 0.0637s/iter; left time: 1609.2306s
	iters: 200, epoch: 6 | loss: 0.2805337
	speed: 0.0108s/iter; left time: 271.8575s
Epoch: 6 cost time: 3.459378719329834
Epoch: 6, Steps: 267 | Train Loss: 0.2922492 Vali Loss: 0.4052948 Test Loss: 0.3106157
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2661152
	speed: 0.0628s/iter; left time: 1570.7506s
	iters: 200, epoch: 7 | loss: 0.2895854
	speed: 0.0108s/iter; left time: 268.2936s
Epoch: 7 cost time: 3.5129401683807373
Epoch: 7, Steps: 267 | Train Loss: 0.2919750 Vali Loss: 0.4060480 Test Loss: 0.3116620
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2675340
	speed: 0.0638s/iter; left time: 1576.7103s
	iters: 200, epoch: 8 | loss: 0.2791089
	speed: 0.0120s/iter; left time: 296.1097s
Epoch: 8 cost time: 3.6360929012298584
Epoch: 8, Steps: 267 | Train Loss: 0.2918872 Vali Loss: 0.4057704 Test Loss: 0.3112080
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2807709
	speed: 0.0609s/iter; left time: 1489.7776s
	iters: 200, epoch: 9 | loss: 0.3182964
	speed: 0.0111s/iter; left time: 271.4203s
Epoch: 9 cost time: 3.513536214828491
Epoch: 9, Steps: 267 | Train Loss: 0.2918809 Vali Loss: 0.4045188 Test Loss: 0.3104591
Validation loss decreased (0.405199 --> 0.404519).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3344949
	speed: 0.0663s/iter; left time: 1603.8117s
	iters: 200, epoch: 10 | loss: 0.2659787
	speed: 0.0113s/iter; left time: 271.1104s
Epoch: 10 cost time: 3.6213650703430176
Epoch: 10, Steps: 267 | Train Loss: 0.2918700 Vali Loss: 0.4054191 Test Loss: 0.3109560
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2949308
	speed: 0.0620s/iter; left time: 1483.1858s
	iters: 200, epoch: 11 | loss: 0.2674987
	speed: 0.0114s/iter; left time: 271.0734s
Epoch: 11 cost time: 3.6044278144836426
Epoch: 11, Steps: 267 | Train Loss: 0.2916971 Vali Loss: 0.4049464 Test Loss: 0.3110911
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3117697
	speed: 0.0573s/iter; left time: 1355.4948s
	iters: 200, epoch: 12 | loss: 0.2742538
	speed: 0.0108s/iter; left time: 255.5442s
Epoch: 12 cost time: 3.55839204788208
Epoch: 12, Steps: 267 | Train Loss: 0.2916798 Vali Loss: 0.4043171 Test Loss: 0.3107232
Validation loss decreased (0.404519 --> 0.404317).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2939666
	speed: 0.0621s/iter; left time: 1452.6761s
	iters: 200, epoch: 13 | loss: 0.2990645
	speed: 0.0112s/iter; left time: 260.2301s
Epoch: 13 cost time: 3.583784580230713
Epoch: 13, Steps: 267 | Train Loss: 0.2915882 Vali Loss: 0.4033893 Test Loss: 0.3106361
Validation loss decreased (0.404317 --> 0.403389).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2804489
	speed: 0.0625s/iter; left time: 1446.0486s
	iters: 200, epoch: 14 | loss: 0.2667469
	speed: 0.0110s/iter; left time: 253.7505s
Epoch: 14 cost time: 3.6138315200805664
Epoch: 14, Steps: 267 | Train Loss: 0.2915209 Vali Loss: 0.4046968 Test Loss: 0.3109235
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2777322
	speed: 0.0622s/iter; left time: 1421.5105s
	iters: 200, epoch: 15 | loss: 0.3233299
	speed: 0.0108s/iter; left time: 246.6392s
Epoch: 15 cost time: 3.546488046646118
Epoch: 15, Steps: 267 | Train Loss: 0.2914755 Vali Loss: 0.4041033 Test Loss: 0.3108390
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2686869
	speed: 0.0639s/iter; left time: 1443.0523s
	iters: 200, epoch: 16 | loss: 0.2976161
	speed: 0.0112s/iter; left time: 251.7265s
Epoch: 16 cost time: 3.7639052867889404
Epoch: 16, Steps: 267 | Train Loss: 0.2915047 Vali Loss: 0.4043661 Test Loss: 0.3103525
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2929165
	speed: 0.0646s/iter; left time: 1441.9193s
	iters: 200, epoch: 17 | loss: 0.2914840
	speed: 0.0110s/iter; left time: 244.3934s
Epoch: 17 cost time: 3.645841121673584
Epoch: 17, Steps: 267 | Train Loss: 0.2914336 Vali Loss: 0.4045759 Test Loss: 0.3109768
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2935376
	speed: 0.0678s/iter; left time: 1495.2334s
	iters: 200, epoch: 18 | loss: 0.2527559
	speed: 0.0122s/iter; left time: 267.6040s
Epoch: 18 cost time: 3.7973809242248535
Epoch: 18, Steps: 267 | Train Loss: 0.2912538 Vali Loss: 0.4035276 Test Loss: 0.3104528
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2809102
	speed: 0.0642s/iter; left time: 1398.9567s
	iters: 200, epoch: 19 | loss: 0.3072367
	speed: 0.0111s/iter; left time: 240.0649s
Epoch: 19 cost time: 3.6018667221069336
Epoch: 19, Steps: 267 | Train Loss: 0.2913788 Vali Loss: 0.4038135 Test Loss: 0.3105338
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2950131
	speed: 0.0620s/iter; left time: 1335.1643s
	iters: 200, epoch: 20 | loss: 0.3081951
	speed: 0.0175s/iter; left time: 374.3429s
Epoch: 20 cost time: 4.024848461151123
Epoch: 20, Steps: 267 | Train Loss: 0.2915314 Vali Loss: 0.4036644 Test Loss: 0.3104238
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3136564
	speed: 0.0622s/iter; left time: 1322.5736s
	iters: 200, epoch: 21 | loss: 0.2847307
	speed: 0.0111s/iter; left time: 234.9438s
Epoch: 21 cost time: 3.5221526622772217
Epoch: 21, Steps: 267 | Train Loss: 0.2914893 Vali Loss: 0.4038515 Test Loss: 0.3104331
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3144602
	speed: 0.0607s/iter; left time: 1273.9684s
	iters: 200, epoch: 22 | loss: 0.3187365
	speed: 0.0206s/iter; left time: 430.5881s
Epoch: 22 cost time: 4.404788970947266
Epoch: 22, Steps: 267 | Train Loss: 0.2912982 Vali Loss: 0.4044272 Test Loss: 0.3104478
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2829573
	speed: 0.0600s/iter; left time: 1243.4856s
	iters: 200, epoch: 23 | loss: 0.2940020
	speed: 0.0112s/iter; left time: 231.4558s
Epoch: 23 cost time: 3.498511791229248
Epoch: 23, Steps: 267 | Train Loss: 0.2912642 Vali Loss: 0.4042106 Test Loss: 0.3103370
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3230325
	speed: 0.0615s/iter; left time: 1258.8119s
	iters: 200, epoch: 24 | loss: 0.2647538
	speed: 0.0108s/iter; left time: 220.4887s
Epoch: 24 cost time: 3.563122272491455
Epoch: 24, Steps: 267 | Train Loss: 0.2913710 Vali Loss: 0.4036779 Test Loss: 0.3103140
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3308659
	speed: 0.0626s/iter; left time: 1264.9110s
	iters: 200, epoch: 25 | loss: 0.2870291
	speed: 0.0110s/iter; left time: 221.7666s
Epoch: 25 cost time: 3.5621426105499268
Epoch: 25, Steps: 267 | Train Loss: 0.2913409 Vali Loss: 0.4034939 Test Loss: 0.3105203
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3179470
	speed: 0.0642s/iter; left time: 1278.4652s
	iters: 200, epoch: 26 | loss: 0.3060764
	speed: 0.0107s/iter; left time: 212.6687s
Epoch: 26 cost time: 4.131913900375366
Epoch: 26, Steps: 267 | Train Loss: 0.2911960 Vali Loss: 0.4043246 Test Loss: 0.3105488
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3089750
	speed: 0.0642s/iter; left time: 1262.9773s
	iters: 200, epoch: 27 | loss: 0.2838253
	speed: 0.0112s/iter; left time: 219.9918s
Epoch: 27 cost time: 3.5100390911102295
Epoch: 27, Steps: 267 | Train Loss: 0.2911331 Vali Loss: 0.4042441 Test Loss: 0.3105041
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3094509
	speed: 0.0602s/iter; left time: 1167.9932s
	iters: 200, epoch: 28 | loss: 0.3212427
	speed: 0.0114s/iter; left time: 219.0130s
Epoch: 28 cost time: 3.5077126026153564
Epoch: 28, Steps: 267 | Train Loss: 0.2913297 Vali Loss: 0.4039037 Test Loss: 0.3104823
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3094586
	speed: 0.0616s/iter; left time: 1178.7022s
	iters: 200, epoch: 29 | loss: 0.2979727
	speed: 0.0109s/iter; left time: 206.8338s
Epoch: 29 cost time: 3.905146360397339
Epoch: 29, Steps: 267 | Train Loss: 0.2913026 Vali Loss: 0.4038700 Test Loss: 0.3103543
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2806520
	speed: 0.0679s/iter; left time: 1280.3941s
	iters: 200, epoch: 30 | loss: 0.3105662
	speed: 0.0108s/iter; left time: 202.7902s
Epoch: 30 cost time: 3.6306610107421875
Epoch: 30, Steps: 267 | Train Loss: 0.2912360 Vali Loss: 0.4035367 Test Loss: 0.3101656
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2920732
	speed: 0.0629s/iter; left time: 1168.7405s
	iters: 200, epoch: 31 | loss: 0.2527712
	speed: 0.0108s/iter; left time: 200.3507s
Epoch: 31 cost time: 3.5015082359313965
Epoch: 31, Steps: 267 | Train Loss: 0.2912845 Vali Loss: 0.4039209 Test Loss: 0.3103104
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2895088
	speed: 0.0616s/iter; left time: 1128.0500s
	iters: 200, epoch: 32 | loss: 0.2797713
	speed: 0.0120s/iter; left time: 219.0026s
Epoch: 32 cost time: 3.6477763652801514
Epoch: 32, Steps: 267 | Train Loss: 0.2912940 Vali Loss: 0.4037905 Test Loss: 0.3103164
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2992284
	speed: 0.0652s/iter; left time: 1177.9180s
	iters: 200, epoch: 33 | loss: 0.3024400
	speed: 0.0114s/iter; left time: 204.9564s
Epoch: 33 cost time: 3.725890874862671
Epoch: 33, Steps: 267 | Train Loss: 0.2912505 Vali Loss: 0.4035039 Test Loss: 0.3103124
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3129531145095825, mae:0.34912899136543274, rse:0.5323184132575989, corr:[0.5506879  0.5562102  0.5571027  0.5550353  0.55249184 0.551184
 0.5512421  0.55217874 0.5530154  0.5534814  0.55371034 0.5534617
 0.55282736 0.55140746 0.5492428  0.54685324 0.5446725  0.54289174
 0.5413619  0.53980774 0.5380754  0.5360422  0.5337482  0.5313596
 0.5289866  0.52675843 0.5248764  0.52341    0.52250475 0.5222049
 0.52252305 0.5231368  0.52361417 0.52376777 0.5235544  0.5231656
 0.522752   0.52242863 0.52229667 0.5222114  0.52215123 0.52200675
 0.5218027  0.5216753  0.52167755 0.5218473  0.52218366 0.5225814
 0.5229316  0.52312535 0.5232039  0.5232612  0.5233698  0.5235068
 0.52362764 0.5236572  0.5236571  0.523547   0.5233687  0.5230994
 0.52283084 0.52261066 0.5224413  0.5223291  0.5222912  0.52241117
 0.52261734 0.5228113  0.52301973 0.5232046  0.52335346 0.52343667
 0.5234508  0.523409   0.5234038  0.523372   0.52333915 0.5232739
 0.5231533  0.52297086 0.52279127 0.5226056  0.5224124  0.52213365
 0.52181745 0.52159953 0.5215584  0.5215928  0.52162546 0.5217141
 0.5218434  0.52199835 0.5221638  0.52227104 0.52199906 0.5208371 ]
