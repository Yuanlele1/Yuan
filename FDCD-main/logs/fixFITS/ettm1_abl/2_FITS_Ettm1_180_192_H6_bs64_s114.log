Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5315232
	speed: 0.0197s/iter; left time: 523.1800s
	iters: 200, epoch: 1 | loss: 0.4117280
	speed: 0.0133s/iter; left time: 351.4960s
Epoch: 1 cost time: 4.2018232345581055
Epoch: 1, Steps: 267 | Train Loss: 0.5101535 Vali Loss: 0.9243866 Test Loss: 0.7103062
Validation loss decreased (inf --> 0.924387).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3441230
	speed: 0.0729s/iter; left time: 1920.8002s
	iters: 200, epoch: 2 | loss: 0.3134991
	speed: 0.0141s/iter; left time: 370.8233s
Epoch: 2 cost time: 4.438433408737183
Epoch: 2, Steps: 267 | Train Loss: 0.3285137 Vali Loss: 0.7540684 Test Loss: 0.5492094
Validation loss decreased (0.924387 --> 0.754068).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2670684
	speed: 0.0716s/iter; left time: 1867.3168s
	iters: 200, epoch: 3 | loss: 0.2458852
	speed: 0.0139s/iter; left time: 359.6837s
Epoch: 3 cost time: 4.270419597625732
Epoch: 3, Steps: 267 | Train Loss: 0.2682087 Vali Loss: 0.6757055 Test Loss: 0.4770360
Validation loss decreased (0.754068 --> 0.675705).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2495606
	speed: 0.0745s/iter; left time: 1921.1751s
	iters: 200, epoch: 4 | loss: 0.2507055
	speed: 0.0120s/iter; left time: 307.8114s
Epoch: 4 cost time: 4.052113056182861
Epoch: 4, Steps: 267 | Train Loss: 0.2387287 Vali Loss: 0.6299042 Test Loss: 0.4367034
Validation loss decreased (0.675705 --> 0.629904).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2172557
	speed: 0.0675s/iter; left time: 1723.9009s
	iters: 200, epoch: 5 | loss: 0.2129811
	speed: 0.0128s/iter; left time: 326.4518s
Epoch: 5 cost time: 4.069169998168945
Epoch: 5, Steps: 267 | Train Loss: 0.2207640 Vali Loss: 0.6005735 Test Loss: 0.4101247
Validation loss decreased (0.629904 --> 0.600574).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2028449
	speed: 0.0729s/iter; left time: 1840.8150s
	iters: 200, epoch: 6 | loss: 0.2127245
	speed: 0.0133s/iter; left time: 335.1577s
Epoch: 6 cost time: 4.3048810958862305
Epoch: 6, Steps: 267 | Train Loss: 0.2087932 Vali Loss: 0.5789143 Test Loss: 0.3923067
Validation loss decreased (0.600574 --> 0.578914).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2004407
	speed: 0.0724s/iter; left time: 1808.9104s
	iters: 200, epoch: 7 | loss: 0.1755411
	speed: 0.0137s/iter; left time: 342.2117s
Epoch: 7 cost time: 4.294758319854736
Epoch: 7, Steps: 267 | Train Loss: 0.2004959 Vali Loss: 0.5654007 Test Loss: 0.3805388
Validation loss decreased (0.578914 --> 0.565401).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1988962
	speed: 0.0701s/iter; left time: 1732.4767s
	iters: 200, epoch: 8 | loss: 0.2000178
	speed: 0.0165s/iter; left time: 406.4657s
Epoch: 8 cost time: 4.410713195800781
Epoch: 8, Steps: 267 | Train Loss: 0.1946875 Vali Loss: 0.5551663 Test Loss: 0.3719926
Validation loss decreased (0.565401 --> 0.555166).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1845066
	speed: 0.0663s/iter; left time: 1620.9196s
	iters: 200, epoch: 9 | loss: 0.1931884
	speed: 0.0134s/iter; left time: 326.6995s
Epoch: 9 cost time: 4.089106321334839
Epoch: 9, Steps: 267 | Train Loss: 0.1905317 Vali Loss: 0.5488477 Test Loss: 0.3660012
Validation loss decreased (0.555166 --> 0.548848).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1995507
	speed: 0.0713s/iter; left time: 1725.7795s
	iters: 200, epoch: 10 | loss: 0.1945529
	speed: 0.0148s/iter; left time: 357.5916s
Epoch: 10 cost time: 4.645606279373169
Epoch: 10, Steps: 267 | Train Loss: 0.1876941 Vali Loss: 0.5427232 Test Loss: 0.3615175
Validation loss decreased (0.548848 --> 0.542723).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1811197
	speed: 0.1227s/iter; left time: 2937.0641s
	iters: 200, epoch: 11 | loss: 0.1809371
	speed: 0.0139s/iter; left time: 332.1371s
Epoch: 11 cost time: 6.664402961730957
Epoch: 11, Steps: 267 | Train Loss: 0.1856869 Vali Loss: 0.5385702 Test Loss: 0.3582744
Validation loss decreased (0.542723 --> 0.538570).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1989280
	speed: 0.0707s/iter; left time: 1674.1463s
	iters: 200, epoch: 12 | loss: 0.1826411
	speed: 0.0123s/iter; left time: 288.8899s
Epoch: 12 cost time: 4.2951500415802
Epoch: 12, Steps: 267 | Train Loss: 0.1843548 Vali Loss: 0.5353851 Test Loss: 0.3558018
Validation loss decreased (0.538570 --> 0.535385).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2060702
	speed: 0.0664s/iter; left time: 1554.6432s
	iters: 200, epoch: 13 | loss: 0.2038555
	speed: 0.0131s/iter; left time: 304.2160s
Epoch: 13 cost time: 4.107959985733032
Epoch: 13, Steps: 267 | Train Loss: 0.1834695 Vali Loss: 0.5333619 Test Loss: 0.3543719
Validation loss decreased (0.535385 --> 0.533362).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1797597
	speed: 0.0795s/iter; left time: 1838.4489s
	iters: 200, epoch: 14 | loss: 0.1895933
	speed: 0.0134s/iter; left time: 307.6167s
Epoch: 14 cost time: 4.131244659423828
Epoch: 14, Steps: 267 | Train Loss: 0.1829256 Vali Loss: 0.5316072 Test Loss: 0.3531923
Validation loss decreased (0.533362 --> 0.531607).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2000314
	speed: 0.0693s/iter; left time: 1584.0508s
	iters: 200, epoch: 15 | loss: 0.1789802
	speed: 0.0113s/iter; left time: 256.9881s
Epoch: 15 cost time: 3.824326992034912
Epoch: 15, Steps: 267 | Train Loss: 0.1825389 Vali Loss: 0.5308102 Test Loss: 0.3528083
Validation loss decreased (0.531607 --> 0.530810).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1871777
	speed: 0.0730s/iter; left time: 1648.6513s
	iters: 200, epoch: 16 | loss: 0.1837117
	speed: 0.0149s/iter; left time: 335.8311s
Epoch: 16 cost time: 5.089733839035034
Epoch: 16, Steps: 267 | Train Loss: 0.1823568 Vali Loss: 0.5308414 Test Loss: 0.3521040
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1909113
	speed: 0.0712s/iter; left time: 1590.5125s
	iters: 200, epoch: 17 | loss: 0.1750149
	speed: 0.0131s/iter; left time: 291.3287s
Epoch: 17 cost time: 4.202398300170898
Epoch: 17, Steps: 267 | Train Loss: 0.1821976 Vali Loss: 0.5298975 Test Loss: 0.3519747
Validation loss decreased (0.530810 --> 0.529897).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2004823
	speed: 0.0685s/iter; left time: 1512.0417s
	iters: 200, epoch: 18 | loss: 0.1962519
	speed: 0.0124s/iter; left time: 272.8002s
Epoch: 18 cost time: 4.093811273574829
Epoch: 18, Steps: 267 | Train Loss: 0.1821560 Vali Loss: 0.5298161 Test Loss: 0.3518068
Validation loss decreased (0.529897 --> 0.529816).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1770819
	speed: 0.0651s/iter; left time: 1418.1497s
	iters: 200, epoch: 19 | loss: 0.1759679
	speed: 0.0137s/iter; left time: 296.4442s
Epoch: 19 cost time: 4.740712404251099
Epoch: 19, Steps: 267 | Train Loss: 0.1821169 Vali Loss: 0.5297096 Test Loss: 0.3516880
Validation loss decreased (0.529816 --> 0.529710).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1783529
	speed: 0.0722s/iter; left time: 1555.0889s
	iters: 200, epoch: 20 | loss: 0.1866154
	speed: 0.0124s/iter; left time: 265.0756s
Epoch: 20 cost time: 3.8354275226593018
Epoch: 20, Steps: 267 | Train Loss: 0.1820881 Vali Loss: 0.5288383 Test Loss: 0.3517002
Validation loss decreased (0.529710 --> 0.528838).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2045869
	speed: 0.0650s/iter; left time: 1380.9739s
	iters: 200, epoch: 21 | loss: 0.1875704
	speed: 0.0126s/iter; left time: 266.5376s
Epoch: 21 cost time: 4.135573625564575
Epoch: 21, Steps: 267 | Train Loss: 0.1820754 Vali Loss: 0.5294602 Test Loss: 0.3514598
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1716916
	speed: 0.0706s/iter; left time: 1481.2792s
	iters: 200, epoch: 22 | loss: 0.1760744
	speed: 0.0123s/iter; left time: 256.0837s
Epoch: 22 cost time: 4.099306583404541
Epoch: 22, Steps: 267 | Train Loss: 0.1820675 Vali Loss: 0.5287991 Test Loss: 0.3515345
Validation loss decreased (0.528838 --> 0.528799).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1788551
	speed: 0.0699s/iter; left time: 1448.7929s
	iters: 200, epoch: 23 | loss: 0.1793319
	speed: 0.0135s/iter; left time: 279.2999s
Epoch: 23 cost time: 4.262542486190796
Epoch: 23, Steps: 267 | Train Loss: 0.1820695 Vali Loss: 0.5292273 Test Loss: 0.3514810
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2029914
	speed: 0.0704s/iter; left time: 1440.6278s
	iters: 200, epoch: 24 | loss: 0.1813701
	speed: 0.0135s/iter; left time: 273.9011s
Epoch: 24 cost time: 4.294325113296509
Epoch: 24, Steps: 267 | Train Loss: 0.1820693 Vali Loss: 0.5291533 Test Loss: 0.3515136
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1888990
	speed: 0.0675s/iter; left time: 1362.9361s
	iters: 200, epoch: 25 | loss: 0.1744529
	speed: 0.0136s/iter; left time: 272.8483s
Epoch: 25 cost time: 4.192314863204956
Epoch: 25, Steps: 267 | Train Loss: 0.1820504 Vali Loss: 0.5285663 Test Loss: 0.3515254
Validation loss decreased (0.528799 --> 0.528566).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1784956
	speed: 0.0852s/iter; left time: 1696.9796s
	iters: 200, epoch: 26 | loss: 0.1796944
	speed: 0.0289s/iter; left time: 572.6316s
Epoch: 26 cost time: 6.833526849746704
Epoch: 26, Steps: 267 | Train Loss: 0.1820752 Vali Loss: 0.5284324 Test Loss: 0.3515285
Validation loss decreased (0.528566 --> 0.528432).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1780027
	speed: 0.1036s/iter; left time: 2036.0466s
	iters: 200, epoch: 27 | loss: 0.1869123
	speed: 0.0235s/iter; left time: 459.5118s
Epoch: 27 cost time: 8.173828363418579
Epoch: 27, Steps: 267 | Train Loss: 0.1820743 Vali Loss: 0.5285908 Test Loss: 0.3514826
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2114195
	speed: 0.1188s/iter; left time: 2303.1648s
	iters: 200, epoch: 28 | loss: 0.1951045
	speed: 0.0403s/iter; left time: 776.9876s
Epoch: 28 cost time: 7.994862794876099
Epoch: 28, Steps: 267 | Train Loss: 0.1820725 Vali Loss: 0.5289544 Test Loss: 0.3514416
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1880680
	speed: 0.0975s/iter; left time: 1864.1715s
	iters: 200, epoch: 29 | loss: 0.1725735
	speed: 0.0207s/iter; left time: 393.2552s
Epoch: 29 cost time: 6.407677412033081
Epoch: 29, Steps: 267 | Train Loss: 0.1820430 Vali Loss: 0.5287862 Test Loss: 0.3515140
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1816122
	speed: 0.0949s/iter; left time: 1790.2636s
	iters: 200, epoch: 30 | loss: 0.1805926
	speed: 0.0243s/iter; left time: 456.6475s
Epoch: 30 cost time: 7.575630187988281
Epoch: 30, Steps: 267 | Train Loss: 0.1820362 Vali Loss: 0.5287478 Test Loss: 0.3515271
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1686182
	speed: 0.0995s/iter; left time: 1849.1793s
	iters: 200, epoch: 31 | loss: 0.1877283
	speed: 0.0208s/iter; left time: 383.8551s
Epoch: 31 cost time: 6.076494932174683
Epoch: 31, Steps: 267 | Train Loss: 0.1820633 Vali Loss: 0.5296450 Test Loss: 0.3515473
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1771567
	speed: 0.0765s/iter; left time: 1401.4449s
	iters: 200, epoch: 32 | loss: 0.1909238
	speed: 0.0134s/iter; left time: 244.9146s
Epoch: 32 cost time: 4.17098069190979
Epoch: 32, Steps: 267 | Train Loss: 0.1820692 Vali Loss: 0.5286745 Test Loss: 0.3514682
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1987956
	speed: 0.0686s/iter; left time: 1238.5087s
	iters: 200, epoch: 33 | loss: 0.1769603
	speed: 0.0173s/iter; left time: 310.6270s
Epoch: 33 cost time: 4.9797399044036865
Epoch: 33, Steps: 267 | Train Loss: 0.1820648 Vali Loss: 0.5294025 Test Loss: 0.3515717
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1684529
	speed: 0.0804s/iter; left time: 1430.3056s
	iters: 200, epoch: 34 | loss: 0.2198233
	speed: 0.0148s/iter; left time: 261.9033s
Epoch: 34 cost time: 4.775045156478882
Epoch: 34, Steps: 267 | Train Loss: 0.1820513 Vali Loss: 0.5285425 Test Loss: 0.3515329
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1683630
	speed: 0.0640s/iter; left time: 1122.2045s
	iters: 200, epoch: 35 | loss: 0.1971068
	speed: 0.0133s/iter; left time: 232.3017s
Epoch: 35 cost time: 4.662266731262207
Epoch: 35, Steps: 267 | Train Loss: 0.1820427 Vali Loss: 0.5291401 Test Loss: 0.3516180
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1897941
	speed: 0.0722s/iter; left time: 1246.2669s
	iters: 200, epoch: 36 | loss: 0.1786209
	speed: 0.0174s/iter; left time: 298.5746s
Epoch: 36 cost time: 4.681238174438477
Epoch: 36, Steps: 267 | Train Loss: 0.1820616 Vali Loss: 0.5289679 Test Loss: 0.3515677
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1871503
	speed: 0.0677s/iter; left time: 1150.3679s
	iters: 200, epoch: 37 | loss: 0.1738846
	speed: 0.0128s/iter; left time: 216.8892s
Epoch: 37 cost time: 4.089189052581787
Epoch: 37, Steps: 267 | Train Loss: 0.1820537 Vali Loss: 0.5290943 Test Loss: 0.3515574
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1729778
	speed: 0.0688s/iter; left time: 1150.5746s
	iters: 200, epoch: 38 | loss: 0.1785072
	speed: 0.0131s/iter; left time: 217.1918s
Epoch: 38 cost time: 4.197537422180176
Epoch: 38, Steps: 267 | Train Loss: 0.1820521 Vali Loss: 0.5289838 Test Loss: 0.3514949
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1930617
	speed: 0.0727s/iter; left time: 1195.7169s
	iters: 200, epoch: 39 | loss: 0.1749369
	speed: 0.0119s/iter; left time: 194.1092s
Epoch: 39 cost time: 3.7765705585479736
Epoch: 39, Steps: 267 | Train Loss: 0.1820603 Vali Loss: 0.5290422 Test Loss: 0.3514977
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1709678
	speed: 0.0703s/iter; left time: 1138.6328s
	iters: 200, epoch: 40 | loss: 0.1987974
	speed: 0.0118s/iter; left time: 190.5893s
Epoch: 40 cost time: 3.954423427581787
Epoch: 40, Steps: 267 | Train Loss: 0.1820466 Vali Loss: 0.5289615 Test Loss: 0.3515119
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1699598
	speed: 0.0691s/iter; left time: 1099.4410s
	iters: 200, epoch: 41 | loss: 0.1698031
	speed: 0.0158s/iter; left time: 249.6626s
Epoch: 41 cost time: 4.498856544494629
Epoch: 41, Steps: 267 | Train Loss: 0.1820567 Vali Loss: 0.5289480 Test Loss: 0.3515341
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1810270
	speed: 0.0709s/iter; left time: 1110.4029s
	iters: 200, epoch: 42 | loss: 0.1799508
	speed: 0.0125s/iter; left time: 193.8312s
Epoch: 42 cost time: 4.267235279083252
Epoch: 42, Steps: 267 | Train Loss: 0.1820229 Vali Loss: 0.5292698 Test Loss: 0.3515303
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1717293
	speed: 0.0821s/iter; left time: 1263.0815s
	iters: 200, epoch: 43 | loss: 0.1846738
	speed: 0.0125s/iter; left time: 191.3879s
Epoch: 43 cost time: 4.18050479888916
Epoch: 43, Steps: 267 | Train Loss: 0.1820367 Vali Loss: 0.5287676 Test Loss: 0.3515367
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1605531
	speed: 0.0701s/iter; left time: 1060.0812s
	iters: 200, epoch: 44 | loss: 0.1663832
	speed: 0.0141s/iter; left time: 211.5478s
Epoch: 44 cost time: 4.361831903457642
Epoch: 44, Steps: 267 | Train Loss: 0.1820500 Vali Loss: 0.5293894 Test Loss: 0.3515177
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1981510
	speed: 0.0680s/iter; left time: 1009.5470s
	iters: 200, epoch: 45 | loss: 0.1910520
	speed: 0.0128s/iter; left time: 189.1495s
Epoch: 45 cost time: 4.02201247215271
Epoch: 45, Steps: 267 | Train Loss: 0.1820389 Vali Loss: 0.5288182 Test Loss: 0.3515587
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1623205
	speed: 0.0673s/iter; left time: 982.1918s
	iters: 200, epoch: 46 | loss: 0.1818379
	speed: 0.0129s/iter; left time: 186.6874s
Epoch: 46 cost time: 4.0194091796875
Epoch: 46, Steps: 267 | Train Loss: 0.1820499 Vali Loss: 0.5284817 Test Loss: 0.3515317
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3448777
	speed: 0.0274s/iter; left time: 729.7284s
	iters: 200, epoch: 1 | loss: 0.3327527
	speed: 0.0814s/iter; left time: 2157.0662s
Epoch: 1 cost time: 17.870757579803467
Epoch: 1, Steps: 267 | Train Loss: 0.3324237 Vali Loss: 0.5261455 Test Loss: 0.3489457
Validation loss decreased (inf --> 0.526146).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3041123
	speed: 0.3678s/iter; left time: 9686.8239s
	iters: 200, epoch: 2 | loss: 0.3173555
	speed: 0.0623s/iter; left time: 1633.8507s
Epoch: 2 cost time: 27.106451749801636
Epoch: 2, Steps: 267 | Train Loss: 0.3316146 Vali Loss: 0.5260857 Test Loss: 0.3489777
Validation loss decreased (0.526146 --> 0.526086).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4125359
	speed: 0.3249s/iter; left time: 8470.2682s
	iters: 200, epoch: 3 | loss: 0.3515711
	speed: 0.0742s/iter; left time: 1926.6208s
Epoch: 3 cost time: 17.940065145492554
Epoch: 3, Steps: 267 | Train Loss: 0.3313531 Vali Loss: 0.5243501 Test Loss: 0.3487634
Validation loss decreased (0.526086 --> 0.524350).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3469451
	speed: 0.2787s/iter; left time: 7189.6000s
	iters: 200, epoch: 4 | loss: 0.3278241
	speed: 0.1070s/iter; left time: 2749.0391s
Epoch: 4 cost time: 20.47673273086548
Epoch: 4, Steps: 267 | Train Loss: 0.3311358 Vali Loss: 0.5232700 Test Loss: 0.3485148
Validation loss decreased (0.524350 --> 0.523270).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3291919
	speed: 0.2237s/iter; left time: 5712.5933s
	iters: 200, epoch: 5 | loss: 0.2937956
	speed: 0.0129s/iter; left time: 327.2390s
Epoch: 5 cost time: 3.994997262954712
Epoch: 5, Steps: 267 | Train Loss: 0.3310450 Vali Loss: 0.5238674 Test Loss: 0.3479823
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3851306
	speed: 0.0678s/iter; left time: 1713.7336s
	iters: 200, epoch: 6 | loss: 0.3451525
	speed: 0.0128s/iter; left time: 321.2202s
Epoch: 6 cost time: 3.990065097808838
Epoch: 6, Steps: 267 | Train Loss: 0.3309453 Vali Loss: 0.5223615 Test Loss: 0.3480501
Validation loss decreased (0.523270 --> 0.522361).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3564850
	speed: 0.0669s/iter; left time: 1673.4714s
	iters: 200, epoch: 7 | loss: 0.3103510
	speed: 0.0120s/iter; left time: 297.7091s
Epoch: 7 cost time: 3.9142582416534424
Epoch: 7, Steps: 267 | Train Loss: 0.3309037 Vali Loss: 0.5229405 Test Loss: 0.3482005
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3324113
	speed: 0.0696s/iter; left time: 1722.1587s
	iters: 200, epoch: 8 | loss: 0.3234308
	speed: 0.0126s/iter; left time: 309.3345s
Epoch: 8 cost time: 4.05115818977356
Epoch: 8, Steps: 267 | Train Loss: 0.3308391 Vali Loss: 0.5234776 Test Loss: 0.3480129
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3310499
	speed: 0.0679s/iter; left time: 1661.6189s
	iters: 200, epoch: 9 | loss: 0.3418378
	speed: 0.0146s/iter; left time: 356.0122s
Epoch: 9 cost time: 4.246273756027222
Epoch: 9, Steps: 267 | Train Loss: 0.3307410 Vali Loss: 0.5232740 Test Loss: 0.3479099
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3285871
	speed: 0.0686s/iter; left time: 1659.9844s
	iters: 200, epoch: 10 | loss: 0.3321877
	speed: 0.0114s/iter; left time: 275.3028s
Epoch: 10 cost time: 3.8927764892578125
Epoch: 10, Steps: 267 | Train Loss: 0.3307794 Vali Loss: 0.5235882 Test Loss: 0.3481479
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3340878
	speed: 0.0662s/iter; left time: 1583.3596s
	iters: 200, epoch: 11 | loss: 0.3333496
	speed: 0.0139s/iter; left time: 330.9603s
Epoch: 11 cost time: 4.08658766746521
Epoch: 11, Steps: 267 | Train Loss: 0.3307229 Vali Loss: 0.5230259 Test Loss: 0.3481603
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3480599
	speed: 0.0698s/iter; left time: 1652.7466s
	iters: 200, epoch: 12 | loss: 0.2835470
	speed: 0.0128s/iter; left time: 302.3626s
Epoch: 12 cost time: 3.960430383682251
Epoch: 12, Steps: 267 | Train Loss: 0.3307024 Vali Loss: 0.5237699 Test Loss: 0.3480952
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3355730
	speed: 0.0658s/iter; left time: 1540.0234s
	iters: 200, epoch: 13 | loss: 0.3020172
	speed: 0.0128s/iter; left time: 298.3689s
Epoch: 13 cost time: 4.076980113983154
Epoch: 13, Steps: 267 | Train Loss: 0.3307110 Vali Loss: 0.5234194 Test Loss: 0.3482131
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3066447
	speed: 0.0654s/iter; left time: 1512.1812s
	iters: 200, epoch: 14 | loss: 0.3164496
	speed: 0.0126s/iter; left time: 289.9325s
Epoch: 14 cost time: 3.9152047634124756
Epoch: 14, Steps: 267 | Train Loss: 0.3306877 Vali Loss: 0.5229594 Test Loss: 0.3480857
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3023145
	speed: 0.0696s/iter; left time: 1591.8714s
	iters: 200, epoch: 15 | loss: 0.3572899
	speed: 0.0217s/iter; left time: 494.7456s
Epoch: 15 cost time: 5.376888990402222
Epoch: 15, Steps: 267 | Train Loss: 0.3306879 Vali Loss: 0.5227446 Test Loss: 0.3479328
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3136132
	speed: 0.0644s/iter; left time: 1455.9121s
	iters: 200, epoch: 16 | loss: 0.3760836
	speed: 0.0122s/iter; left time: 274.1387s
Epoch: 16 cost time: 3.9645564556121826
Epoch: 16, Steps: 267 | Train Loss: 0.3306677 Vali Loss: 0.5228096 Test Loss: 0.3479162
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3380869
	speed: 0.0617s/iter; left time: 1378.7182s
	iters: 200, epoch: 17 | loss: 0.3250553
	speed: 0.0125s/iter; left time: 278.6802s
Epoch: 17 cost time: 3.9101431369781494
Epoch: 17, Steps: 267 | Train Loss: 0.3306495 Vali Loss: 0.5226542 Test Loss: 0.3479950
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3317284
	speed: 0.0707s/iter; left time: 1559.0880s
	iters: 200, epoch: 18 | loss: 0.3826478
	speed: 0.0129s/iter; left time: 282.9505s
Epoch: 18 cost time: 4.710785150527954
Epoch: 18, Steps: 267 | Train Loss: 0.3305895 Vali Loss: 0.5231534 Test Loss: 0.3481904
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3065571
	speed: 0.0703s/iter; left time: 1531.8951s
	iters: 200, epoch: 19 | loss: 0.3277242
	speed: 0.0127s/iter; left time: 275.0323s
Epoch: 19 cost time: 4.091119050979614
Epoch: 19, Steps: 267 | Train Loss: 0.3305802 Vali Loss: 0.5229819 Test Loss: 0.3480595
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3419333
	speed: 0.0705s/iter; left time: 1517.8631s
	iters: 200, epoch: 20 | loss: 0.3188097
	speed: 0.0130s/iter; left time: 279.4066s
Epoch: 20 cost time: 4.611492872238159
Epoch: 20, Steps: 267 | Train Loss: 0.3305433 Vali Loss: 0.5230932 Test Loss: 0.3481477
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3344007
	speed: 0.0834s/iter; left time: 1772.8283s
	iters: 200, epoch: 21 | loss: 0.3015914
	speed: 0.0126s/iter; left time: 266.4028s
Epoch: 21 cost time: 4.368017673492432
Epoch: 21, Steps: 267 | Train Loss: 0.3305836 Vali Loss: 0.5227285 Test Loss: 0.3482620
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3378333
	speed: 0.0721s/iter; left time: 1513.8334s
	iters: 200, epoch: 22 | loss: 0.3807895
	speed: 0.0123s/iter; left time: 257.5664s
Epoch: 22 cost time: 3.6987521648406982
Epoch: 22, Steps: 267 | Train Loss: 0.3305528 Vali Loss: 0.5232525 Test Loss: 0.3480572
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3285403
	speed: 0.0657s/iter; left time: 1361.1472s
	iters: 200, epoch: 23 | loss: 0.3667521
	speed: 0.0117s/iter; left time: 241.6776s
Epoch: 23 cost time: 3.8569796085357666
Epoch: 23, Steps: 267 | Train Loss: 0.3305916 Vali Loss: 0.5229654 Test Loss: 0.3482339
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2967898
	speed: 0.0670s/iter; left time: 1371.4694s
	iters: 200, epoch: 24 | loss: 0.3088092
	speed: 0.0128s/iter; left time: 260.9600s
Epoch: 24 cost time: 4.089275598526001
Epoch: 24, Steps: 267 | Train Loss: 0.3305558 Vali Loss: 0.5229225 Test Loss: 0.3481697
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3349418
	speed: 0.0648s/iter; left time: 1308.0447s
	iters: 200, epoch: 25 | loss: 0.3461184
	speed: 0.0126s/iter; left time: 254.1039s
Epoch: 25 cost time: 3.943629741668701
Epoch: 25, Steps: 267 | Train Loss: 0.3305787 Vali Loss: 0.5232348 Test Loss: 0.3481070
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3340089
	speed: 0.0660s/iter; left time: 1314.7819s
	iters: 200, epoch: 26 | loss: 0.3288039
	speed: 0.0119s/iter; left time: 235.3183s
Epoch: 26 cost time: 3.9179649353027344
Epoch: 26, Steps: 267 | Train Loss: 0.3305421 Vali Loss: 0.5232632 Test Loss: 0.3479727
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.34824785590171814, mae:0.36905232071876526, rse:0.5617534518241882, corr:[0.5467981  0.55206585 0.5532048  0.5514266  0.5489287  0.5474592
 0.54736215 0.54826945 0.54922384 0.54985094 0.5501636  0.5498921
 0.54916024 0.5476722  0.545484   0.54302466 0.54068536 0.5387396
 0.5371456  0.5356457  0.53404045 0.5321648  0.5300213  0.52774835
 0.52545094 0.52329624 0.52151406 0.5201625  0.51935273 0.5191053
 0.5194274  0.52000403 0.52040315 0.52043307 0.52005106 0.51945597
 0.5188265  0.51832825 0.51810575 0.51801515 0.51800066 0.5179095
 0.5177413  0.5176126  0.51757145 0.5176566  0.5178775  0.51813924
 0.5183062  0.51825935 0.5180588  0.5178423  0.51773995 0.51777923
 0.51794547 0.5181536  0.51842    0.5185839  0.51861393 0.51843935
 0.5181533  0.51784474 0.5175649  0.5173635  0.5172866  0.5174287
 0.5177142  0.5180154  0.5183304  0.51860017 0.5188154  0.5189511
 0.5190259  0.51907974 0.5192292  0.51939064 0.51954156 0.51959693
 0.5195132  0.5192918  0.5190208  0.5187464  0.5185156  0.51825535
 0.5179587  0.51768345 0.51746076 0.5172232  0.51694953 0.5167326
 0.5165617  0.51637614 0.51611    0.5157629  0.51530325 0.5146421
 0.5138034  0.5128977  0.5120178  0.5112509  0.5108096  0.5108303
 0.5112739  0.51201904 0.5129464  0.5139669  0.5150004  0.5160061
 0.5169186  0.5176194  0.5180379  0.518308   0.5183789  0.5182922
 0.5180609  0.5177856  0.517438   0.5170386  0.51669455 0.5164424
 0.51631737 0.5161423  0.5158221  0.51540345 0.5148953  0.5143539
 0.51391995 0.51369065 0.5136429  0.5136945  0.51370525 0.5135585
 0.51324284 0.51291275 0.5126091  0.5123016  0.5120802  0.5118714
 0.5116194  0.51139206 0.511202   0.5111135  0.51116973 0.5113736
 0.5116149  0.5117941  0.51175374 0.51155984 0.5113882  0.51117176
 0.51100785 0.51096964 0.5109998  0.5110444  0.5109403  0.5107318
 0.5104687  0.51024354 0.51005894 0.5099991  0.5100605  0.5102386
 0.510492   0.5107721  0.5110173  0.5113082  0.5116165  0.5119361
 0.5122772  0.51253176 0.5126017  0.51258045 0.51242924 0.5121934
 0.51201355 0.51195186 0.5120736  0.51232487 0.5124802  0.51245105
 0.5121698  0.5117361  0.51133645 0.51120853 0.51147217 0.51202697
 0.5126181  0.51299083 0.513133   0.5134351  0.5143352  0.5157023 ]
