Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=42, out_features=61, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2295552.0
params:  2623.0
Trainable parameters:  2623
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4341682
	speed: 0.0189s/iter; left time: 492.1111s
	iters: 200, epoch: 1 | loss: 0.3431668
	speed: 0.0138s/iter; left time: 356.7700s
Epoch: 1 cost time: 4.079381942749023
Epoch: 1, Steps: 261 | Train Loss: 0.4308623 Vali Loss: 0.9438733 Test Loss: 0.5608778
Validation loss decreased (inf --> 0.943873).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2560409
	speed: 0.0573s/iter; left time: 1473.8029s
	iters: 200, epoch: 2 | loss: 0.2371213
	speed: 0.0138s/iter; left time: 352.8297s
Epoch: 2 cost time: 3.9195024967193604
Epoch: 2, Steps: 261 | Train Loss: 0.2582427 Vali Loss: 0.7980794 Test Loss: 0.4605610
Validation loss decreased (0.943873 --> 0.798079).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1932501
	speed: 0.0587s/iter; left time: 1495.2113s
	iters: 200, epoch: 3 | loss: 0.1898825
	speed: 0.0142s/iter; left time: 359.8938s
Epoch: 3 cost time: 4.150850772857666
Epoch: 3, Steps: 261 | Train Loss: 0.1983459 Vali Loss: 0.7413679 Test Loss: 0.4205590
Validation loss decreased (0.798079 --> 0.741368).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1657860
	speed: 0.0574s/iter; left time: 1448.0535s
	iters: 200, epoch: 4 | loss: 0.1649347
	speed: 0.0137s/iter; left time: 343.5420s
Epoch: 4 cost time: 4.014436721801758
Epoch: 4, Steps: 261 | Train Loss: 0.1713385 Vali Loss: 0.7128270 Test Loss: 0.3988960
Validation loss decreased (0.741368 --> 0.712827).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1534642
	speed: 0.0592s/iter; left time: 1476.9092s
	iters: 200, epoch: 5 | loss: 0.1532793
	speed: 0.0134s/iter; left time: 332.0721s
Epoch: 5 cost time: 4.030567646026611
Epoch: 5, Steps: 261 | Train Loss: 0.1573971 Vali Loss: 0.6997412 Test Loss: 0.3871340
Validation loss decreased (0.712827 --> 0.699741).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1473528
	speed: 0.0593s/iter; left time: 1465.4563s
	iters: 200, epoch: 6 | loss: 0.1573491
	speed: 0.0141s/iter; left time: 346.0406s
Epoch: 6 cost time: 4.0737457275390625
Epoch: 6, Steps: 261 | Train Loss: 0.1493688 Vali Loss: 0.6922142 Test Loss: 0.3822512
Validation loss decreased (0.699741 --> 0.692214).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1394816
	speed: 0.0592s/iter; left time: 1445.4103s
	iters: 200, epoch: 7 | loss: 0.1427811
	speed: 0.0137s/iter; left time: 333.9797s
Epoch: 7 cost time: 4.038157224655151
Epoch: 7, Steps: 261 | Train Loss: 0.1443284 Vali Loss: 0.6876659 Test Loss: 0.3775895
Validation loss decreased (0.692214 --> 0.687666).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1466600
	speed: 0.0575s/iter; left time: 1391.0753s
	iters: 200, epoch: 8 | loss: 0.1344952
	speed: 0.0139s/iter; left time: 334.0053s
Epoch: 8 cost time: 3.995713949203491
Epoch: 8, Steps: 261 | Train Loss: 0.1411130 Vali Loss: 0.6830034 Test Loss: 0.3752433
Validation loss decreased (0.687666 --> 0.683003).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1494740
	speed: 0.0603s/iter; left time: 1442.5273s
	iters: 200, epoch: 9 | loss: 0.1404785
	speed: 0.0140s/iter; left time: 332.5418s
Epoch: 9 cost time: 4.085663557052612
Epoch: 9, Steps: 261 | Train Loss: 0.1388887 Vali Loss: 0.6799299 Test Loss: 0.3737874
Validation loss decreased (0.683003 --> 0.679930).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1395325
	speed: 0.0590s/iter; left time: 1395.3020s
	iters: 200, epoch: 10 | loss: 0.1316745
	speed: 0.0137s/iter; left time: 323.5583s
Epoch: 10 cost time: 4.071633815765381
Epoch: 10, Steps: 261 | Train Loss: 0.1374258 Vali Loss: 0.6788763 Test Loss: 0.3733677
Validation loss decreased (0.679930 --> 0.678876).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1389075
	speed: 0.0584s/iter; left time: 1366.1971s
	iters: 200, epoch: 11 | loss: 0.1345139
	speed: 0.0137s/iter; left time: 318.9490s
Epoch: 11 cost time: 4.057257175445557
Epoch: 11, Steps: 261 | Train Loss: 0.1364414 Vali Loss: 0.6787907 Test Loss: 0.3735451
Validation loss decreased (0.678876 --> 0.678791).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1299796
	speed: 0.0578s/iter; left time: 1336.4650s
	iters: 200, epoch: 12 | loss: 0.1302332
	speed: 0.0141s/iter; left time: 323.7108s
Epoch: 12 cost time: 4.003005027770996
Epoch: 12, Steps: 261 | Train Loss: 0.1358017 Vali Loss: 0.6790925 Test Loss: 0.3736932
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1313211
	speed: 0.0577s/iter; left time: 1320.0484s
	iters: 200, epoch: 13 | loss: 0.1262996
	speed: 0.0142s/iter; left time: 323.9748s
Epoch: 13 cost time: 4.061661720275879
Epoch: 13, Steps: 261 | Train Loss: 0.1353177 Vali Loss: 0.6795021 Test Loss: 0.3736092
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1463579
	speed: 0.0596s/iter; left time: 1347.1818s
	iters: 200, epoch: 14 | loss: 0.1367065
	speed: 0.0147s/iter; left time: 329.9251s
Epoch: 14 cost time: 4.1087563037872314
Epoch: 14, Steps: 261 | Train Loss: 0.1349857 Vali Loss: 0.6787390 Test Loss: 0.3735806
Validation loss decreased (0.678791 --> 0.678739).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1306534
	speed: 0.0591s/iter; left time: 1321.7687s
	iters: 200, epoch: 15 | loss: 0.1318789
	speed: 0.0143s/iter; left time: 317.2921s
Epoch: 15 cost time: 3.9812729358673096
Epoch: 15, Steps: 261 | Train Loss: 0.1348285 Vali Loss: 0.6783491 Test Loss: 0.3745486
Validation loss decreased (0.678739 --> 0.678349).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1359516
	speed: 0.0577s/iter; left time: 1275.0472s
	iters: 200, epoch: 16 | loss: 0.1359024
	speed: 0.0141s/iter; left time: 309.1252s
Epoch: 16 cost time: 4.026658773422241
Epoch: 16, Steps: 261 | Train Loss: 0.1346206 Vali Loss: 0.6795902 Test Loss: 0.3750527
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1253897
	speed: 0.0590s/iter; left time: 1286.6110s
	iters: 200, epoch: 17 | loss: 0.1312370
	speed: 0.0135s/iter; left time: 292.2813s
Epoch: 17 cost time: 3.9701106548309326
Epoch: 17, Steps: 261 | Train Loss: 0.1345632 Vali Loss: 0.6784237 Test Loss: 0.3754536
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1442045
	speed: 0.0581s/iter; left time: 1253.0236s
	iters: 200, epoch: 18 | loss: 0.1375670
	speed: 0.0143s/iter; left time: 307.7274s
Epoch: 18 cost time: 4.103783369064331
Epoch: 18, Steps: 261 | Train Loss: 0.1344888 Vali Loss: 0.6785435 Test Loss: 0.3754472
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1375722
	speed: 0.0565s/iter; left time: 1203.8903s
	iters: 200, epoch: 19 | loss: 0.1316967
	speed: 0.0144s/iter; left time: 304.9023s
Epoch: 19 cost time: 3.975597620010376
Epoch: 19, Steps: 261 | Train Loss: 0.1344422 Vali Loss: 0.6792101 Test Loss: 0.3760005
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1250273
	speed: 0.0593s/iter; left time: 1246.7971s
	iters: 200, epoch: 20 | loss: 0.1329302
	speed: 0.0143s/iter; left time: 299.5716s
Epoch: 20 cost time: 4.106317758560181
Epoch: 20, Steps: 261 | Train Loss: 0.1344048 Vali Loss: 0.6786280 Test Loss: 0.3761524
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1421857
	speed: 0.0583s/iter; left time: 1211.1091s
	iters: 200, epoch: 21 | loss: 0.1219108
	speed: 0.0140s/iter; left time: 289.4006s
Epoch: 21 cost time: 4.060384035110474
Epoch: 21, Steps: 261 | Train Loss: 0.1343141 Vali Loss: 0.6786118 Test Loss: 0.3765729
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1239156
	speed: 0.0579s/iter; left time: 1188.8883s
	iters: 200, epoch: 22 | loss: 0.1359386
	speed: 0.0149s/iter; left time: 304.0704s
Epoch: 22 cost time: 4.250258922576904
Epoch: 22, Steps: 261 | Train Loss: 0.1342843 Vali Loss: 0.6793013 Test Loss: 0.3766739
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1418390
	speed: 0.0608s/iter; left time: 1231.7504s
	iters: 200, epoch: 23 | loss: 0.1358676
	speed: 0.0147s/iter; left time: 295.4914s
Epoch: 23 cost time: 4.14365291595459
Epoch: 23, Steps: 261 | Train Loss: 0.1343294 Vali Loss: 0.6792893 Test Loss: 0.3765951
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1285110
	speed: 0.0585s/iter; left time: 1169.4971s
	iters: 200, epoch: 24 | loss: 0.1393358
	speed: 0.0135s/iter; left time: 268.6585s
Epoch: 24 cost time: 3.9245188236236572
Epoch: 24, Steps: 261 | Train Loss: 0.1343182 Vali Loss: 0.6784706 Test Loss: 0.3770137
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1238011
	speed: 0.0588s/iter; left time: 1160.5488s
	iters: 200, epoch: 25 | loss: 0.1366834
	speed: 0.0137s/iter; left time: 268.1738s
Epoch: 25 cost time: 4.0543951988220215
Epoch: 25, Steps: 261 | Train Loss: 0.1343171 Vali Loss: 0.6790343 Test Loss: 0.3770474
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1319339
	speed: 0.0584s/iter; left time: 1137.7952s
	iters: 200, epoch: 26 | loss: 0.1297761
	speed: 0.0130s/iter; left time: 252.8542s
Epoch: 26 cost time: 3.9255263805389404
Epoch: 26, Steps: 261 | Train Loss: 0.1342977 Vali Loss: 0.6794767 Test Loss: 0.3768319
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1304719
	speed: 0.0587s/iter; left time: 1128.1904s
	iters: 200, epoch: 27 | loss: 0.1274264
	speed: 0.0129s/iter; left time: 246.7635s
Epoch: 27 cost time: 3.857034921646118
Epoch: 27, Steps: 261 | Train Loss: 0.1343029 Vali Loss: 0.6800497 Test Loss: 0.3773690
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1262821
	speed: 0.0578s/iter; left time: 1094.6758s
	iters: 200, epoch: 28 | loss: 0.1271813
	speed: 0.0142s/iter; left time: 268.0751s
Epoch: 28 cost time: 4.042156934738159
Epoch: 28, Steps: 261 | Train Loss: 0.1343364 Vali Loss: 0.6803515 Test Loss: 0.3770204
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1338038
	speed: 0.0600s/iter; left time: 1121.6461s
	iters: 200, epoch: 29 | loss: 0.1316037
	speed: 0.0142s/iter; left time: 264.0722s
Epoch: 29 cost time: 4.155603885650635
Epoch: 29, Steps: 261 | Train Loss: 0.1343088 Vali Loss: 0.6798721 Test Loss: 0.3770690
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1462164
	speed: 0.0584s/iter; left time: 1076.0183s
	iters: 200, epoch: 30 | loss: 0.1436212
	speed: 0.0137s/iter; left time: 251.9497s
Epoch: 30 cost time: 3.9330384731292725
Epoch: 30, Steps: 261 | Train Loss: 0.1343129 Vali Loss: 0.6793822 Test Loss: 0.3770736
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1404647
	speed: 0.0602s/iter; left time: 1094.5213s
	iters: 200, epoch: 31 | loss: 0.1448366
	speed: 0.0143s/iter; left time: 258.6403s
Epoch: 31 cost time: 4.150105953216553
Epoch: 31, Steps: 261 | Train Loss: 0.1343119 Vali Loss: 0.6797764 Test Loss: 0.3770504
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1415979
	speed: 0.0608s/iter; left time: 1088.7983s
	iters: 200, epoch: 32 | loss: 0.1426661
	speed: 0.0142s/iter; left time: 252.1282s
Epoch: 32 cost time: 4.165687799453735
Epoch: 32, Steps: 261 | Train Loss: 0.1343249 Vali Loss: 0.6795693 Test Loss: 0.3771701
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1246330
	speed: 0.0589s/iter; left time: 1039.9635s
	iters: 200, epoch: 33 | loss: 0.1242439
	speed: 0.0143s/iter; left time: 251.5771s
Epoch: 33 cost time: 4.11238956451416
Epoch: 33, Steps: 261 | Train Loss: 0.1343155 Vali Loss: 0.6796123 Test Loss: 0.3771084
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1465095
	speed: 0.0572s/iter; left time: 994.6089s
	iters: 200, epoch: 34 | loss: 0.1351385
	speed: 0.0137s/iter; left time: 237.5969s
Epoch: 34 cost time: 4.005108833312988
Epoch: 34, Steps: 261 | Train Loss: 0.1342889 Vali Loss: 0.6799677 Test Loss: 0.3771183
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1308566
	speed: 0.0580s/iter; left time: 993.7539s
	iters: 200, epoch: 35 | loss: 0.1266926
	speed: 0.0135s/iter; left time: 229.6268s
Epoch: 35 cost time: 3.970712900161743
Epoch: 35, Steps: 261 | Train Loss: 0.1342981 Vali Loss: 0.6805168 Test Loss: 0.3772577
EarlyStopping counter: 20 out of 20
Early stopping
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=42, out_features=61, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2295552.0
params:  2623.0
Trainable parameters:  2623
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3668296
	speed: 0.0210s/iter; left time: 546.1022s
	iters: 200, epoch: 1 | loss: 0.3533225
	speed: 0.0159s/iter; left time: 410.6231s
Epoch: 1 cost time: 4.604668378829956
Epoch: 1, Steps: 261 | Train Loss: 0.3451062 Vali Loss: 0.6667599 Test Loss: 0.3737428
Validation loss decreased (inf --> 0.666760).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3374261
	speed: 0.0658s/iter; left time: 1692.5313s
	iters: 200, epoch: 2 | loss: 0.3047151
	speed: 0.0140s/iter; left time: 358.0149s
Epoch: 2 cost time: 4.253331661224365
Epoch: 2, Steps: 261 | Train Loss: 0.3437761 Vali Loss: 0.6652675 Test Loss: 0.3738532
Validation loss decreased (0.666760 --> 0.665267).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3063615
	speed: 0.0606s/iter; left time: 1544.4566s
	iters: 200, epoch: 3 | loss: 0.3658703
	speed: 0.0138s/iter; left time: 350.9986s
Epoch: 3 cost time: 4.073374271392822
Epoch: 3, Steps: 261 | Train Loss: 0.3432669 Vali Loss: 0.6639689 Test Loss: 0.3740852
Validation loss decreased (0.665267 --> 0.663969).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3310818
	speed: 0.0602s/iter; left time: 1517.2951s
	iters: 200, epoch: 4 | loss: 0.3773275
	speed: 0.0144s/iter; left time: 360.4836s
Epoch: 4 cost time: 4.10563063621521
Epoch: 4, Steps: 261 | Train Loss: 0.3429714 Vali Loss: 0.6641279 Test Loss: 0.3740582
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3495910
	speed: 0.0607s/iter; left time: 1515.6856s
	iters: 200, epoch: 5 | loss: 0.3099101
	speed: 0.0137s/iter; left time: 340.2218s
Epoch: 5 cost time: 4.045256614685059
Epoch: 5, Steps: 261 | Train Loss: 0.3427113 Vali Loss: 0.6623025 Test Loss: 0.3735816
Validation loss decreased (0.663969 --> 0.662302).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3284685
	speed: 0.0587s/iter; left time: 1448.5373s
	iters: 200, epoch: 6 | loss: 0.3175581
	speed: 0.0134s/iter; left time: 329.3998s
Epoch: 6 cost time: 4.069374084472656
Epoch: 6, Steps: 261 | Train Loss: 0.3426346 Vali Loss: 0.6622192 Test Loss: 0.3733594
Validation loss decreased (0.662302 --> 0.662219).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3035028
	speed: 0.0645s/iter; left time: 1576.9341s
	iters: 200, epoch: 7 | loss: 0.3570865
	speed: 0.0135s/iter; left time: 328.1162s
Epoch: 7 cost time: 4.108224391937256
Epoch: 7, Steps: 261 | Train Loss: 0.3426175 Vali Loss: 0.6619045 Test Loss: 0.3732311
Validation loss decreased (0.662219 --> 0.661904).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3330559
	speed: 0.0599s/iter; left time: 1447.8057s
	iters: 200, epoch: 8 | loss: 0.3620741
	speed: 0.0138s/iter; left time: 331.8948s
Epoch: 8 cost time: 4.033966541290283
Epoch: 8, Steps: 261 | Train Loss: 0.3423833 Vali Loss: 0.6615155 Test Loss: 0.3729623
Validation loss decreased (0.661904 --> 0.661516).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3525706
	speed: 0.0587s/iter; left time: 1404.1710s
	iters: 200, epoch: 9 | loss: 0.3315272
	speed: 0.0137s/iter; left time: 325.2493s
Epoch: 9 cost time: 3.9645586013793945
Epoch: 9, Steps: 261 | Train Loss: 0.3424533 Vali Loss: 0.6611611 Test Loss: 0.3734145
Validation loss decreased (0.661516 --> 0.661161).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3484640
	speed: 0.0615s/iter; left time: 1454.6956s
	iters: 200, epoch: 10 | loss: 0.3598436
	speed: 0.0148s/iter; left time: 349.0274s
Epoch: 10 cost time: 4.2134809494018555
Epoch: 10, Steps: 261 | Train Loss: 0.3424018 Vali Loss: 0.6599247 Test Loss: 0.3734562
Validation loss decreased (0.661161 --> 0.659925).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3118834
	speed: 0.0589s/iter; left time: 1378.5488s
	iters: 200, epoch: 11 | loss: 0.3292035
	speed: 0.0137s/iter; left time: 320.0106s
Epoch: 11 cost time: 3.996126413345337
Epoch: 11, Steps: 261 | Train Loss: 0.3423864 Vali Loss: 0.6620820 Test Loss: 0.3728269
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3606826
	speed: 0.0575s/iter; left time: 1330.3013s
	iters: 200, epoch: 12 | loss: 0.3260892
	speed: 0.0136s/iter; left time: 312.4276s
Epoch: 12 cost time: 4.002435207366943
Epoch: 12, Steps: 261 | Train Loss: 0.3422984 Vali Loss: 0.6591326 Test Loss: 0.3734227
Validation loss decreased (0.659925 --> 0.659133).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3458638
	speed: 0.0555s/iter; left time: 1270.0295s
	iters: 200, epoch: 13 | loss: 0.3552370
	speed: 0.0130s/iter; left time: 295.2500s
Epoch: 13 cost time: 3.7729272842407227
Epoch: 13, Steps: 261 | Train Loss: 0.3422865 Vali Loss: 0.6620883 Test Loss: 0.3736709
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3400958
	speed: 0.0561s/iter; left time: 1267.8045s
	iters: 200, epoch: 14 | loss: 0.3459049
	speed: 0.0130s/iter; left time: 292.6152s
Epoch: 14 cost time: 3.8309741020202637
Epoch: 14, Steps: 261 | Train Loss: 0.3423143 Vali Loss: 0.6607672 Test Loss: 0.3732951
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3521652
	speed: 0.0572s/iter; left time: 1279.1800s
	iters: 200, epoch: 15 | loss: 0.3239948
	speed: 0.0137s/iter; left time: 304.0564s
Epoch: 15 cost time: 3.8863816261291504
Epoch: 15, Steps: 261 | Train Loss: 0.3421695 Vali Loss: 0.6617445 Test Loss: 0.3731780
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3478442
	speed: 0.0577s/iter; left time: 1273.8282s
	iters: 200, epoch: 16 | loss: 0.3262667
	speed: 0.0145s/iter; left time: 319.4189s
Epoch: 16 cost time: 4.151012897491455
Epoch: 16, Steps: 261 | Train Loss: 0.3421869 Vali Loss: 0.6599911 Test Loss: 0.3731825
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3464091
	speed: 0.0584s/iter; left time: 1274.7629s
	iters: 200, epoch: 17 | loss: 0.3656265
	speed: 0.0137s/iter; left time: 298.6460s
Epoch: 17 cost time: 4.156881332397461
Epoch: 17, Steps: 261 | Train Loss: 0.3422415 Vali Loss: 0.6610253 Test Loss: 0.3732743
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3077524
	speed: 0.0608s/iter; left time: 1310.6096s
	iters: 200, epoch: 18 | loss: 0.3396987
	speed: 0.0154s/iter; left time: 331.4954s
Epoch: 18 cost time: 4.314785957336426
Epoch: 18, Steps: 261 | Train Loss: 0.3421690 Vali Loss: 0.6601108 Test Loss: 0.3733947
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4053309
	speed: 0.0579s/iter; left time: 1232.7256s
	iters: 200, epoch: 19 | loss: 0.3532359
	speed: 0.0137s/iter; left time: 290.0677s
Epoch: 19 cost time: 3.959148645401001
Epoch: 19, Steps: 261 | Train Loss: 0.3421629 Vali Loss: 0.6610998 Test Loss: 0.3730171
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3288481
	speed: 0.0588s/iter; left time: 1237.0156s
	iters: 200, epoch: 20 | loss: 0.3761955
	speed: 0.0134s/iter; left time: 280.2689s
Epoch: 20 cost time: 3.964362859725952
Epoch: 20, Steps: 261 | Train Loss: 0.3421736 Vali Loss: 0.6606959 Test Loss: 0.3732010
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3658457
	speed: 0.0583s/iter; left time: 1212.0885s
	iters: 200, epoch: 21 | loss: 0.3646823
	speed: 0.0134s/iter; left time: 277.5415s
Epoch: 21 cost time: 3.9124643802642822
Epoch: 21, Steps: 261 | Train Loss: 0.3420559 Vali Loss: 0.6621539 Test Loss: 0.3729266
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3444187
	speed: 0.0590s/iter; left time: 1209.8597s
	iters: 200, epoch: 22 | loss: 0.3639044
	speed: 0.0131s/iter; left time: 268.4726s
Epoch: 22 cost time: 3.944888114929199
Epoch: 22, Steps: 261 | Train Loss: 0.3421707 Vali Loss: 0.6613764 Test Loss: 0.3732511
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3460186
	speed: 0.0585s/iter; left time: 1185.2648s
	iters: 200, epoch: 23 | loss: 0.3210973
	speed: 0.0129s/iter; left time: 260.5745s
Epoch: 23 cost time: 3.8743319511413574
Epoch: 23, Steps: 261 | Train Loss: 0.3421079 Vali Loss: 0.6605226 Test Loss: 0.3734278
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3445120
	speed: 0.0586s/iter; left time: 1172.2282s
	iters: 200, epoch: 24 | loss: 0.3276230
	speed: 0.0134s/iter; left time: 267.3164s
Epoch: 24 cost time: 3.9729411602020264
Epoch: 24, Steps: 261 | Train Loss: 0.3419020 Vali Loss: 0.6596357 Test Loss: 0.3732129
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3278479
	speed: 0.0579s/iter; left time: 1141.9374s
	iters: 200, epoch: 25 | loss: 0.2863216
	speed: 0.0140s/iter; left time: 274.9082s
Epoch: 25 cost time: 3.950880527496338
Epoch: 25, Steps: 261 | Train Loss: 0.3421039 Vali Loss: 0.6596203 Test Loss: 0.3730667
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3442116
	speed: 0.0572s/iter; left time: 1113.7430s
	iters: 200, epoch: 26 | loss: 0.3155600
	speed: 0.0132s/iter; left time: 256.5090s
Epoch: 26 cost time: 3.8852808475494385
Epoch: 26, Steps: 261 | Train Loss: 0.3421103 Vali Loss: 0.6606361 Test Loss: 0.3730405
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3340737
	speed: 0.0580s/iter; left time: 1114.4041s
	iters: 200, epoch: 27 | loss: 0.3403016
	speed: 0.0136s/iter; left time: 259.0893s
Epoch: 27 cost time: 4.050848722457886
Epoch: 27, Steps: 261 | Train Loss: 0.3420442 Vali Loss: 0.6612754 Test Loss: 0.3733189
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3441560
	speed: 0.0576s/iter; left time: 1090.9820s
	iters: 200, epoch: 28 | loss: 0.3208127
	speed: 0.0142s/iter; left time: 267.4741s
Epoch: 28 cost time: 4.06428599357605
Epoch: 28, Steps: 261 | Train Loss: 0.3418897 Vali Loss: 0.6608551 Test Loss: 0.3733061
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3560857
	speed: 0.0598s/iter; left time: 1118.3931s
	iters: 200, epoch: 29 | loss: 0.3391167
	speed: 0.0143s/iter; left time: 266.3903s
Epoch: 29 cost time: 4.107037782669067
Epoch: 29, Steps: 261 | Train Loss: 0.3418642 Vali Loss: 0.6598360 Test Loss: 0.3732754
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3492315
	speed: 0.0569s/iter; left time: 1048.2060s
	iters: 200, epoch: 30 | loss: 0.3490399
	speed: 0.0135s/iter; left time: 247.5866s
Epoch: 30 cost time: 3.810098648071289
Epoch: 30, Steps: 261 | Train Loss: 0.3420770 Vali Loss: 0.6607563 Test Loss: 0.3732439
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3559805
	speed: 0.0587s/iter; left time: 1066.4219s
	iters: 200, epoch: 31 | loss: 0.3545944
	speed: 0.0135s/iter; left time: 244.4642s
Epoch: 31 cost time: 4.0460827350616455
Epoch: 31, Steps: 261 | Train Loss: 0.3421180 Vali Loss: 0.6603974 Test Loss: 0.3734360
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3226228
	speed: 0.0598s/iter; left time: 1071.7965s
	iters: 200, epoch: 32 | loss: 0.3549259
	speed: 0.0139s/iter; left time: 247.6456s
Epoch: 32 cost time: 4.050944089889526
Epoch: 32, Steps: 261 | Train Loss: 0.3418708 Vali Loss: 0.6604562 Test Loss: 0.3733646
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3729780316352844, mae:0.3903126120567322, rse:0.5811522603034973, corr:[0.5415892  0.545179   0.54879874 0.5521412  0.5549189  0.5570737
 0.5585571  0.5594208  0.5598097  0.55984384 0.5596726  0.5592873
 0.5587633  0.5580749  0.5572033  0.5561393  0.5549161  0.5535402
 0.55201405 0.55038255 0.54875183 0.5471608  0.5456629  0.54440534
 0.5433819  0.5426916  0.5423688  0.5423238  0.54254925 0.54297143
 0.54347456 0.54400474 0.54442704 0.54474115 0.5448456  0.5448115
 0.54458606 0.5442465  0.54385966 0.5434074  0.54297084 0.54258215
 0.54228944 0.5421861  0.54224724 0.5424278  0.54273003 0.54307497
 0.5433514  0.5434345  0.5433381  0.5430737  0.54270375 0.54221475
 0.54168963 0.54117924 0.54073185 0.5403775  0.540152   0.5400387
 0.5400305  0.5401286  0.54027677 0.5403937  0.5404943  0.54056907
 0.540575   0.54051507 0.54040754 0.5402547  0.5400844  0.5399073
 0.53970164 0.53947663 0.53926516 0.5390766  0.5388904  0.53873324
 0.5385963  0.53848904 0.53839844 0.53832364 0.53826284 0.53819937
 0.53816056 0.53813386 0.53814304 0.5381537  0.5381629  0.53818834
 0.53821445 0.53819656 0.53810716 0.5379516  0.5377386  0.53747994
 0.53722936 0.5371055  0.53705364 0.53708565 0.5371831  0.53729516
 0.53739095 0.53740484 0.53733593 0.5372166  0.53701925 0.53678215
 0.53650403 0.5362235  0.53597033 0.5357422  0.5355324  0.5353525
 0.53519845 0.5350538  0.5349106  0.5347513  0.53456956 0.53439367
 0.5342141  0.5340166  0.53376836 0.5335137  0.533277   0.5330664
 0.5328853  0.53277314 0.53270906 0.5327091  0.53271294 0.5326919
 0.53266793 0.5326353  0.5325689  0.53248215 0.5324156  0.5323214
 0.53224313 0.53222096 0.53223026 0.53230387 0.5324497  0.53265834
 0.5328936  0.5330596  0.533147   0.53314245 0.53308445 0.5329678
 0.53279334 0.5325998  0.53240913 0.5322219  0.53204346 0.5319336
 0.53186405 0.5318234  0.53183573 0.5318555  0.53193    0.5320501
 0.53222454 0.53243387 0.53266436 0.532899   0.53313047 0.5333693
 0.5335559  0.533638   0.5336683  0.5336704  0.5336363  0.533576
 0.53351647 0.5334708  0.53345424 0.5334802  0.5335442  0.5336616
 0.53383577 0.5340723  0.5343293  0.5346228  0.5349419  0.5352538
 0.5355052  0.5356723  0.5357476  0.5356957  0.53547645 0.5351299
 0.53466815 0.53422916 0.53381056 0.53339076 0.5329629  0.5325441
 0.53210145 0.531632   0.5311128  0.53055567 0.529952   0.52929777
 0.528614   0.52790225 0.52716625 0.52643114 0.5257017  0.5249787
 0.524255   0.52355295 0.5228951  0.5223045  0.5217661  0.5213192
 0.52100587 0.52081263 0.5207229  0.52067614 0.5206361  0.52061003
 0.52061146 0.52059245 0.52057254 0.52055544 0.5205309  0.5205117
 0.52050465 0.52053356 0.520571   0.52060425 0.52063566 0.52066636
 0.52072245 0.5208513  0.5209907  0.5212008  0.5214288  0.5216815
 0.5219201  0.5220346  0.52202195 0.52191335 0.5217765  0.5215983
 0.5213995  0.5212104  0.5210257  0.52088064 0.52075565 0.52067566
 0.52059436 0.52056146 0.52054214 0.52051544 0.520494   0.5204895
 0.5205107  0.5205796  0.52068573 0.52080137 0.5209024  0.5210336
 0.5211202  0.52116024 0.5211617  0.52115446 0.5211522  0.52113557
 0.5211312  0.52114236 0.52117777 0.5212397  0.52132297 0.521426
 0.5215213  0.52164966 0.52175045 0.52186465 0.5219521  0.52198815
 0.52196664 0.52185184 0.5216055  0.5212608  0.52081966 0.5202785
 0.5196667  0.51909184 0.5185938  0.51812375 0.5176548  0.51718587
 0.51670754 0.5161862  0.5156634  0.51512074 0.5145624  0.5140198
 0.5135082  0.51304436 0.5126766  0.51240313 0.5121979  0.5120119
 0.51187295 0.5117168  0.51152015 0.5112949  0.51108015 0.5108846
 0.51071995 0.51060647 0.51050556 0.51040155 0.510288   0.5101858
 0.5100991  0.50999224 0.5098705  0.5097559  0.5096475  0.50955236
 0.50947577 0.50946915 0.50952137 0.5096364  0.5097686  0.50989264
 0.5100312  0.5101192  0.5100593  0.50972074 0.50887936 0.5072681 ]
