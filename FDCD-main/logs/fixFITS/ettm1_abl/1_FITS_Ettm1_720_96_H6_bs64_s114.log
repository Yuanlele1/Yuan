Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=58, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=58, out_features=65, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3377920.0
params:  3835.0
Trainable parameters:  3835
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3005871
	speed: 0.0290s/iter; left time: 758.8212s
	iters: 200, epoch: 1 | loss: 0.2694574
	speed: 0.0265s/iter; left time: 692.3088s
Epoch: 1 cost time: 7.375860214233398
Epoch: 1, Steps: 263 | Train Loss: 0.3304094 Vali Loss: 0.4482965 Test Loss: 0.3160644
Validation loss decreased (inf --> 0.448296).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2815681
	speed: 0.1426s/iter; left time: 3697.6480s
	iters: 200, epoch: 2 | loss: 0.2847405
	speed: 0.0300s/iter; left time: 775.7252s
Epoch: 2 cost time: 8.760474681854248
Epoch: 2, Steps: 263 | Train Loss: 0.2755382 Vali Loss: 0.4216250 Test Loss: 0.3139735
Validation loss decreased (0.448296 --> 0.421625).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2690383
	speed: 0.1324s/iter; left time: 3399.0472s
	iters: 200, epoch: 3 | loss: 0.2407226
	speed: 0.0296s/iter; left time: 757.4384s
Epoch: 3 cost time: 8.252306699752808
Epoch: 3, Steps: 263 | Train Loss: 0.2707373 Vali Loss: 0.4141201 Test Loss: 0.3139170
Validation loss decreased (0.421625 --> 0.414120).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2806140
	speed: 0.1307s/iter; left time: 3320.2284s
	iters: 200, epoch: 4 | loss: 0.2207029
	speed: 0.0330s/iter; left time: 835.3475s
Epoch: 4 cost time: 8.932024240493774
Epoch: 4, Steps: 263 | Train Loss: 0.2686085 Vali Loss: 0.4085465 Test Loss: 0.3132816
Validation loss decreased (0.414120 --> 0.408546).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2643469
	speed: 0.1240s/iter; left time: 3119.0129s
	iters: 200, epoch: 5 | loss: 0.2576794
	speed: 0.0311s/iter; left time: 779.1769s
Epoch: 5 cost time: 7.9377357959747314
Epoch: 5, Steps: 263 | Train Loss: 0.2676764 Vali Loss: 0.4069111 Test Loss: 0.3126477
Validation loss decreased (0.408546 --> 0.406911).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2556435
	speed: 0.1219s/iter; left time: 3032.5482s
	iters: 200, epoch: 6 | loss: 0.2508110
	speed: 0.0302s/iter; left time: 747.9767s
Epoch: 6 cost time: 8.218683242797852
Epoch: 6, Steps: 263 | Train Loss: 0.2673646 Vali Loss: 0.4073540 Test Loss: 0.3143201
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2979262
	speed: 0.1254s/iter; left time: 3086.6314s
	iters: 200, epoch: 7 | loss: 0.2510656
	speed: 0.0246s/iter; left time: 604.2496s
Epoch: 7 cost time: 6.911614656448364
Epoch: 7, Steps: 263 | Train Loss: 0.2669179 Vali Loss: 0.4043678 Test Loss: 0.3143583
Validation loss decreased (0.406911 --> 0.404368).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2465503
	speed: 0.1361s/iter; left time: 3314.9740s
	iters: 200, epoch: 8 | loss: 0.2638451
	speed: 0.0230s/iter; left time: 557.1043s
Epoch: 8 cost time: 7.040976047515869
Epoch: 8, Steps: 263 | Train Loss: 0.2667878 Vali Loss: 0.4045780 Test Loss: 0.3131133
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2683325
	speed: 0.1331s/iter; left time: 3207.5362s
	iters: 200, epoch: 9 | loss: 0.2635305
	speed: 0.0286s/iter; left time: 686.9887s
Epoch: 9 cost time: 7.752878904342651
Epoch: 9, Steps: 263 | Train Loss: 0.2665832 Vali Loss: 0.4027211 Test Loss: 0.3128606
Validation loss decreased (0.404368 --> 0.402721).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2700031
	speed: 0.1247s/iter; left time: 2971.4934s
	iters: 200, epoch: 10 | loss: 0.2661611
	speed: 0.0320s/iter; left time: 759.4903s
Epoch: 10 cost time: 8.724732875823975
Epoch: 10, Steps: 263 | Train Loss: 0.2662910 Vali Loss: 0.4014520 Test Loss: 0.3124974
Validation loss decreased (0.402721 --> 0.401452).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2790089
	speed: 0.1311s/iter; left time: 3089.6842s
	iters: 200, epoch: 11 | loss: 0.2867655
	speed: 0.0302s/iter; left time: 709.0114s
Epoch: 11 cost time: 8.472402572631836
Epoch: 11, Steps: 263 | Train Loss: 0.2661766 Vali Loss: 0.4025386 Test Loss: 0.3132257
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2462754
	speed: 0.1260s/iter; left time: 2937.3104s
	iters: 200, epoch: 12 | loss: 0.2792511
	speed: 0.0275s/iter; left time: 637.4443s
Epoch: 12 cost time: 8.52276611328125
Epoch: 12, Steps: 263 | Train Loss: 0.2661640 Vali Loss: 0.4013873 Test Loss: 0.3123033
Validation loss decreased (0.401452 --> 0.401387).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3105527
	speed: 0.1144s/iter; left time: 2637.4016s
	iters: 200, epoch: 13 | loss: 0.2560613
	speed: 0.0279s/iter; left time: 640.7627s
Epoch: 13 cost time: 7.921102523803711
Epoch: 13, Steps: 263 | Train Loss: 0.2660437 Vali Loss: 0.3975349 Test Loss: 0.3130485
Validation loss decreased (0.401387 --> 0.397535).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2710532
	speed: 0.1309s/iter; left time: 2981.0795s
	iters: 200, epoch: 14 | loss: 0.2960246
	speed: 0.0295s/iter; left time: 669.3578s
Epoch: 14 cost time: 8.400656938552856
Epoch: 14, Steps: 263 | Train Loss: 0.2659571 Vali Loss: 0.4017814 Test Loss: 0.3125497
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2712608
	speed: 0.1219s/iter; left time: 2745.7984s
	iters: 200, epoch: 15 | loss: 0.2542785
	speed: 0.0251s/iter; left time: 563.0482s
Epoch: 15 cost time: 7.31705641746521
Epoch: 15, Steps: 263 | Train Loss: 0.2658722 Vali Loss: 0.3993704 Test Loss: 0.3133485
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2633895
	speed: 0.1285s/iter; left time: 2860.1385s
	iters: 200, epoch: 16 | loss: 0.2558865
	speed: 0.0269s/iter; left time: 596.2633s
Epoch: 16 cost time: 8.650632858276367
Epoch: 16, Steps: 263 | Train Loss: 0.2658300 Vali Loss: 0.4032692 Test Loss: 0.3128969
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2582856
	speed: 0.1331s/iter; left time: 2927.0259s
	iters: 200, epoch: 17 | loss: 0.2555099
	speed: 0.0305s/iter; left time: 668.0498s
Epoch: 17 cost time: 9.058335542678833
Epoch: 17, Steps: 263 | Train Loss: 0.2656995 Vali Loss: 0.4019496 Test Loss: 0.3133570
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2932357
	speed: 0.1430s/iter; left time: 3106.9509s
	iters: 200, epoch: 18 | loss: 0.2647128
	speed: 0.0307s/iter; left time: 664.7107s
Epoch: 18 cost time: 8.65995979309082
Epoch: 18, Steps: 263 | Train Loss: 0.2657531 Vali Loss: 0.4014575 Test Loss: 0.3137254
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2633487
	speed: 0.1305s/iter; left time: 2802.1605s
	iters: 200, epoch: 19 | loss: 0.2488513
	speed: 0.0284s/iter; left time: 607.0999s
Epoch: 19 cost time: 8.518490076065063
Epoch: 19, Steps: 263 | Train Loss: 0.2656797 Vali Loss: 0.4002443 Test Loss: 0.3128934
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2675109
	speed: 0.1208s/iter; left time: 2562.0079s
	iters: 200, epoch: 20 | loss: 0.2872171
	speed: 0.0294s/iter; left time: 620.2490s
Epoch: 20 cost time: 8.36538577079773
Epoch: 20, Steps: 263 | Train Loss: 0.2656670 Vali Loss: 0.4003395 Test Loss: 0.3133253
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2476576
	speed: 0.1347s/iter; left time: 2821.1997s
	iters: 200, epoch: 21 | loss: 0.2614121
	speed: 0.0243s/iter; left time: 506.8471s
Epoch: 21 cost time: 7.625298261642456
Epoch: 21, Steps: 263 | Train Loss: 0.2656174 Vali Loss: 0.4000111 Test Loss: 0.3128724
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2544769
	speed: 0.1289s/iter; left time: 2666.2475s
	iters: 200, epoch: 22 | loss: 0.2694173
	speed: 0.0295s/iter; left time: 606.5646s
Epoch: 22 cost time: 8.502427577972412
Epoch: 22, Steps: 263 | Train Loss: 0.2655471 Vali Loss: 0.4008911 Test Loss: 0.3128635
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2698213
	speed: 0.1294s/iter; left time: 2641.3284s
	iters: 200, epoch: 23 | loss: 0.2480749
	speed: 0.0309s/iter; left time: 627.0373s
Epoch: 23 cost time: 8.824417114257812
Epoch: 23, Steps: 263 | Train Loss: 0.2655522 Vali Loss: 0.4000599 Test Loss: 0.3131769
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2701136
	speed: 0.1307s/iter; left time: 2633.2030s
	iters: 200, epoch: 24 | loss: 0.2606016
	speed: 0.0314s/iter; left time: 630.3158s
Epoch: 24 cost time: 8.333977699279785
Epoch: 24, Steps: 263 | Train Loss: 0.2654076 Vali Loss: 0.3993012 Test Loss: 0.3131327
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2858167
	speed: 0.1295s/iter; left time: 2575.7315s
	iters: 200, epoch: 25 | loss: 0.2598541
	speed: 0.0234s/iter; left time: 463.9561s
Epoch: 25 cost time: 6.885287284851074
Epoch: 25, Steps: 263 | Train Loss: 0.2654094 Vali Loss: 0.3989005 Test Loss: 0.3130956
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2780665
	speed: 0.1273s/iter; left time: 2498.8795s
	iters: 200, epoch: 26 | loss: 0.2582902
	speed: 0.0302s/iter; left time: 588.8687s
Epoch: 26 cost time: 9.36746072769165
Epoch: 26, Steps: 263 | Train Loss: 0.2653822 Vali Loss: 0.3991016 Test Loss: 0.3131852
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2812455
	speed: 0.1504s/iter; left time: 2911.7253s
	iters: 200, epoch: 27 | loss: 0.2513192
	speed: 0.0275s/iter; left time: 530.2539s
Epoch: 27 cost time: 8.815475702285767
Epoch: 27, Steps: 263 | Train Loss: 0.2653793 Vali Loss: 0.3992095 Test Loss: 0.3127263
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2761651
	speed: 0.1567s/iter; left time: 2992.1292s
	iters: 200, epoch: 28 | loss: 0.3001216
	speed: 0.0393s/iter; left time: 746.2609s
Epoch: 28 cost time: 11.75225043296814
Epoch: 28, Steps: 263 | Train Loss: 0.2653568 Vali Loss: 0.4010288 Test Loss: 0.3130825
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2647835
	speed: 0.1199s/iter; left time: 2258.8277s
	iters: 200, epoch: 29 | loss: 0.2485044
	speed: 0.0231s/iter; left time: 433.1831s
Epoch: 29 cost time: 6.883511543273926
Epoch: 29, Steps: 263 | Train Loss: 0.2653822 Vali Loss: 0.4000043 Test Loss: 0.3129914
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2658563
	speed: 0.1300s/iter; left time: 2413.7229s
	iters: 200, epoch: 30 | loss: 0.2647856
	speed: 0.0244s/iter; left time: 450.4919s
Epoch: 30 cost time: 7.106140851974487
Epoch: 30, Steps: 263 | Train Loss: 0.2652987 Vali Loss: 0.3999964 Test Loss: 0.3132485
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2789549
	speed: 0.1360s/iter; left time: 2490.6765s
	iters: 200, epoch: 31 | loss: 0.2565917
	speed: 0.0335s/iter; left time: 610.6486s
Epoch: 31 cost time: 9.12449860572815
Epoch: 31, Steps: 263 | Train Loss: 0.2652697 Vali Loss: 0.4003599 Test Loss: 0.3129618
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2305554
	speed: 0.1269s/iter; left time: 2289.7276s
	iters: 200, epoch: 32 | loss: 0.2552465
	speed: 0.0320s/iter; left time: 574.7718s
Epoch: 32 cost time: 8.755895137786865
Epoch: 32, Steps: 263 | Train Loss: 0.2652780 Vali Loss: 0.4003409 Test Loss: 0.3127984
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2822233
	speed: 0.1112s/iter; left time: 1977.7258s
	iters: 200, epoch: 33 | loss: 0.2684231
	speed: 0.0316s/iter; left time: 559.4135s
Epoch: 33 cost time: 8.43772554397583
Epoch: 33, Steps: 263 | Train Loss: 0.2652757 Vali Loss: 0.4000095 Test Loss: 0.3130319
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3146742582321167, mae:0.3565492331981659, rse:0.5337802767753601, corr:[0.5456133  0.5520616  0.55778474 0.5619705  0.56438595 0.5654975
 0.56584495 0.56591886 0.5660574  0.56637734 0.5668817  0.5673603
 0.5676933  0.567709   0.56731015 0.5665032  0.5653799  0.5640267
 0.5624857  0.5608259  0.5591623  0.5575437  0.55602944 0.55476725
 0.553708   0.5529391  0.5524893  0.5522507  0.55227166 0.55251145
 0.552874   0.5533139  0.5536657  0.5539222  0.5539743  0.5539374
 0.55372363 0.5534346  0.55313134 0.55276567 0.55243754 0.55215937
 0.55195946 0.5519324  0.55198556 0.5520251  0.5520632  0.55204475
 0.5518746  0.5514873  0.5510059  0.5505479  0.5502552  0.550101
 0.55011475 0.55024785 0.5504281  0.55053973 0.55057514 0.5504551
 0.5502292  0.549956   0.54969877 0.5494548  0.5493511  0.54943734
 0.54965615 0.5499523  0.5502722  0.550521   0.5506758  0.5506847
 0.5504984  0.5501252  0.5496602  0.5491461  0.548624   0.54815835
 0.5477692  0.5474658  0.54723114 0.54699177 0.54672074 0.54634583
 0.5459041  0.5454019  0.5449296  0.5445148  0.54424924 0.54425234
 0.544522   0.5449468  0.5453849  0.5456293  0.54543084 0.54445934]
