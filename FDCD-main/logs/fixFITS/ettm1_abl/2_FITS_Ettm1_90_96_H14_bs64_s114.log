Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=24, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_96_FITS_ETTm1_ftM_sl90_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=24, out_features=49, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1053696.0
params:  1225.0
Trainable parameters:  1225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4062793
	speed: 0.0285s/iter; left time: 760.1617s
	iters: 200, epoch: 1 | loss: 0.3148939
	speed: 0.0207s/iter; left time: 550.8124s
Epoch: 1 cost time: 6.168593883514404
Epoch: 1, Steps: 268 | Train Loss: 0.4079101 Vali Loss: 0.7108636 Test Loss: 0.6447201
Validation loss decreased (inf --> 0.710864).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2877732
	speed: 0.1202s/iter; left time: 3178.3247s
	iters: 200, epoch: 2 | loss: 0.2613279
	speed: 0.0169s/iter; left time: 444.9457s
Epoch: 2 cost time: 7.4065101146698
Epoch: 2, Steps: 268 | Train Loss: 0.2781341 Vali Loss: 0.6164010 Test Loss: 0.5539284
Validation loss decreased (0.710864 --> 0.616401).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2332279
	speed: 0.1381s/iter; left time: 3614.4689s
	iters: 200, epoch: 3 | loss: 0.2330106
	speed: 0.0173s/iter; left time: 451.0287s
Epoch: 3 cost time: 7.214464902877808
Epoch: 3, Steps: 268 | Train Loss: 0.2391909 Vali Loss: 0.5566528 Test Loss: 0.4957483
Validation loss decreased (0.616401 --> 0.556653).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2106992
	speed: 0.1149s/iter; left time: 2976.2509s
	iters: 200, epoch: 4 | loss: 0.2039351
	speed: 0.0256s/iter; left time: 660.6490s
Epoch: 4 cost time: 7.516238451004028
Epoch: 4, Steps: 268 | Train Loss: 0.2184772 Vali Loss: 0.5152692 Test Loss: 0.4551212
Validation loss decreased (0.556653 --> 0.515269).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2019614
	speed: 0.1018s/iter; left time: 2608.2125s
	iters: 200, epoch: 5 | loss: 0.2266352
	speed: 0.0205s/iter; left time: 522.7356s
Epoch: 5 cost time: 6.494096994400024
Epoch: 5, Steps: 268 | Train Loss: 0.2053797 Vali Loss: 0.4845289 Test Loss: 0.4258303
Validation loss decreased (0.515269 --> 0.484529).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2137316
	speed: 0.0991s/iter; left time: 2513.5911s
	iters: 200, epoch: 6 | loss: 0.2127748
	speed: 0.0223s/iter; left time: 563.4134s
Epoch: 6 cost time: 5.743862628936768
Epoch: 6, Steps: 268 | Train Loss: 0.1969485 Vali Loss: 0.4636493 Test Loss: 0.4054838
Validation loss decreased (0.484529 --> 0.463649).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2049676
	speed: 0.0903s/iter; left time: 2265.2587s
	iters: 200, epoch: 7 | loss: 0.1853835
	speed: 0.0158s/iter; left time: 394.5376s
Epoch: 7 cost time: 4.624494791030884
Epoch: 7, Steps: 268 | Train Loss: 0.1919001 Vali Loss: 0.4493563 Test Loss: 0.3911342
Validation loss decreased (0.463649 --> 0.449356).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1845298
	speed: 0.1072s/iter; left time: 2662.2241s
	iters: 200, epoch: 8 | loss: 0.1857247
	speed: 0.0307s/iter; left time: 759.2861s
Epoch: 8 cost time: 9.34909963607788
Epoch: 8, Steps: 268 | Train Loss: 0.1888375 Vali Loss: 0.4408170 Test Loss: 0.3820607
Validation loss decreased (0.449356 --> 0.440817).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1811443
	speed: 0.1476s/iter; left time: 3623.7219s
	iters: 200, epoch: 9 | loss: 0.1902735
	speed: 0.0304s/iter; left time: 744.4198s
Epoch: 9 cost time: 8.82358694076538
Epoch: 9, Steps: 268 | Train Loss: 0.1871491 Vali Loss: 0.4338036 Test Loss: 0.3754809
Validation loss decreased (0.440817 --> 0.433804).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1799915
	speed: 0.1004s/iter; left time: 2439.4707s
	iters: 200, epoch: 10 | loss: 0.1955463
	speed: 0.0235s/iter; left time: 568.3715s
Epoch: 10 cost time: 7.957168340682983
Epoch: 10, Steps: 268 | Train Loss: 0.1861716 Vali Loss: 0.4291689 Test Loss: 0.3704474
Validation loss decreased (0.433804 --> 0.429169).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1912175
	speed: 0.1266s/iter; left time: 3040.6074s
	iters: 200, epoch: 11 | loss: 0.2039745
	speed: 0.0269s/iter; left time: 643.7953s
Epoch: 11 cost time: 8.707412481307983
Epoch: 11, Steps: 268 | Train Loss: 0.1856397 Vali Loss: 0.4257634 Test Loss: 0.3676620
Validation loss decreased (0.429169 --> 0.425763).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1814005
	speed: 0.1032s/iter; left time: 2450.1858s
	iters: 200, epoch: 12 | loss: 0.1987418
	speed: 0.0168s/iter; left time: 396.7607s
Epoch: 12 cost time: 6.325685262680054
Epoch: 12, Steps: 268 | Train Loss: 0.1854107 Vali Loss: 0.4240501 Test Loss: 0.3661124
Validation loss decreased (0.425763 --> 0.424050).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1923991
	speed: 0.1026s/iter; left time: 2408.8508s
	iters: 200, epoch: 13 | loss: 0.1804661
	speed: 0.0191s/iter; left time: 447.0494s
Epoch: 13 cost time: 7.508737087249756
Epoch: 13, Steps: 268 | Train Loss: 0.1852698 Vali Loss: 0.4226331 Test Loss: 0.3644532
Validation loss decreased (0.424050 --> 0.422633).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2002973
	speed: 0.1402s/iter; left time: 3254.7590s
	iters: 200, epoch: 14 | loss: 0.1766401
	speed: 0.0221s/iter; left time: 511.6331s
Epoch: 14 cost time: 6.4116926193237305
Epoch: 14, Steps: 268 | Train Loss: 0.1852146 Vali Loss: 0.4217852 Test Loss: 0.3640366
Validation loss decreased (0.422633 --> 0.421785).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2005611
	speed: 0.1006s/iter; left time: 2308.4134s
	iters: 200, epoch: 15 | loss: 0.1852006
	speed: 0.0169s/iter; left time: 387.0636s
Epoch: 15 cost time: 5.692981958389282
Epoch: 15, Steps: 268 | Train Loss: 0.1851282 Vali Loss: 0.4210885 Test Loss: 0.3628314
Validation loss decreased (0.421785 --> 0.421088).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2018484
	speed: 0.1308s/iter; left time: 2967.7314s
	iters: 200, epoch: 16 | loss: 0.2088179
	speed: 0.0463s/iter; left time: 1045.8219s
Epoch: 16 cost time: 10.615495443344116
Epoch: 16, Steps: 268 | Train Loss: 0.1851992 Vali Loss: 0.4215801 Test Loss: 0.3630231
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1864010
	speed: 0.1176s/iter; left time: 2635.8748s
	iters: 200, epoch: 17 | loss: 0.1909153
	speed: 0.0137s/iter; left time: 306.6058s
Epoch: 17 cost time: 5.894991159439087
Epoch: 17, Steps: 268 | Train Loss: 0.1851518 Vali Loss: 0.4209523 Test Loss: 0.3625215
Validation loss decreased (0.421088 --> 0.420952).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1887886
	speed: 0.0893s/iter; left time: 1977.0893s
	iters: 200, epoch: 18 | loss: 0.1819082
	speed: 0.0212s/iter; left time: 467.7639s
Epoch: 18 cost time: 6.132327318191528
Epoch: 18, Steps: 268 | Train Loss: 0.1851067 Vali Loss: 0.4215781 Test Loss: 0.3628222
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1870822
	speed: 0.0838s/iter; left time: 1833.2625s
	iters: 200, epoch: 19 | loss: 0.1666619
	speed: 0.0182s/iter; left time: 397.0841s
Epoch: 19 cost time: 5.561318874359131
Epoch: 19, Steps: 268 | Train Loss: 0.1851621 Vali Loss: 0.4214531 Test Loss: 0.3632008
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2050128
	speed: 0.1069s/iter; left time: 2309.7087s
	iters: 200, epoch: 20 | loss: 0.1898229
	speed: 0.0181s/iter; left time: 390.0403s
Epoch: 20 cost time: 6.747307300567627
Epoch: 20, Steps: 268 | Train Loss: 0.1851385 Vali Loss: 0.4214588 Test Loss: 0.3628069
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1907554
	speed: 0.1319s/iter; left time: 2814.8475s
	iters: 200, epoch: 21 | loss: 0.1865288
	speed: 0.0253s/iter; left time: 537.3271s
Epoch: 21 cost time: 9.572275400161743
Epoch: 21, Steps: 268 | Train Loss: 0.1851899 Vali Loss: 0.4213082 Test Loss: 0.3626370
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1983834
	speed: 0.1750s/iter; left time: 3688.2485s
	iters: 200, epoch: 22 | loss: 0.1881406
	speed: 0.0201s/iter; left time: 420.8064s
Epoch: 22 cost time: 6.078917026519775
Epoch: 22, Steps: 268 | Train Loss: 0.1851443 Vali Loss: 0.4209425 Test Loss: 0.3626183
Validation loss decreased (0.420952 --> 0.420942).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1830105
	speed: 0.1225s/iter; left time: 2548.6105s
	iters: 200, epoch: 23 | loss: 0.2002569
	speed: 0.0127s/iter; left time: 262.4825s
Epoch: 23 cost time: 5.621934175491333
Epoch: 23, Steps: 268 | Train Loss: 0.1850921 Vali Loss: 0.4210019 Test Loss: 0.3627252
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1865334
	speed: 0.0987s/iter; left time: 2027.5139s
	iters: 200, epoch: 24 | loss: 0.1657117
	speed: 0.0225s/iter; left time: 459.5010s
Epoch: 24 cost time: 5.769126653671265
Epoch: 24, Steps: 268 | Train Loss: 0.1852054 Vali Loss: 0.4210054 Test Loss: 0.3627309
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1773188
	speed: 0.0720s/iter; left time: 1459.9719s
	iters: 200, epoch: 25 | loss: 0.1814132
	speed: 0.0188s/iter; left time: 378.7015s
Epoch: 25 cost time: 5.255194187164307
Epoch: 25, Steps: 268 | Train Loss: 0.1851313 Vali Loss: 0.4216446 Test Loss: 0.3629460
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2064061
	speed: 0.1406s/iter; left time: 2811.6264s
	iters: 200, epoch: 26 | loss: 0.1870158
	speed: 0.0410s/iter; left time: 815.7140s
Epoch: 26 cost time: 10.66508674621582
Epoch: 26, Steps: 268 | Train Loss: 0.1851034 Vali Loss: 0.4215996 Test Loss: 0.3629749
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1738216
	speed: 0.1292s/iter; left time: 2549.7058s
	iters: 200, epoch: 27 | loss: 0.1910577
	speed: 0.0259s/iter; left time: 508.2401s
Epoch: 27 cost time: 6.61993670463562
Epoch: 27, Steps: 268 | Train Loss: 0.1851237 Vali Loss: 0.4211967 Test Loss: 0.3627965
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1937313
	speed: 0.1000s/iter; left time: 1945.8768s
	iters: 200, epoch: 28 | loss: 0.1915731
	speed: 0.0216s/iter; left time: 418.0456s
Epoch: 28 cost time: 6.439994812011719
Epoch: 28, Steps: 268 | Train Loss: 0.1851015 Vali Loss: 0.4214281 Test Loss: 0.3628114
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1869997
	speed: 0.1286s/iter; left time: 2468.4146s
	iters: 200, epoch: 29 | loss: 0.1837443
	speed: 0.0430s/iter; left time: 821.2607s
Epoch: 29 cost time: 11.097226619720459
Epoch: 29, Steps: 268 | Train Loss: 0.1851562 Vali Loss: 0.4214817 Test Loss: 0.3628877
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1872093
	speed: 0.1125s/iter; left time: 2130.0190s
	iters: 200, epoch: 30 | loss: 0.1728887
	speed: 0.0153s/iter; left time: 288.2790s
Epoch: 30 cost time: 5.293334484100342
Epoch: 30, Steps: 268 | Train Loss: 0.1851164 Vali Loss: 0.4216013 Test Loss: 0.3629823
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1771563
	speed: 0.1030s/iter; left time: 1922.0437s
	iters: 200, epoch: 31 | loss: 0.1895999
	speed: 0.0184s/iter; left time: 341.3502s
Epoch: 31 cost time: 6.722919940948486
Epoch: 31, Steps: 268 | Train Loss: 0.1851537 Vali Loss: 0.4216053 Test Loss: 0.3631094
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1913547
	speed: 0.1202s/iter; left time: 2209.9738s
	iters: 200, epoch: 32 | loss: 0.1796464
	speed: 0.0416s/iter; left time: 761.8631s
Epoch: 32 cost time: 10.215729236602783
Epoch: 32, Steps: 268 | Train Loss: 0.1851091 Vali Loss: 0.4214168 Test Loss: 0.3629999
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1743981
	speed: 0.1228s/iter; left time: 2225.5589s
	iters: 200, epoch: 33 | loss: 0.1793595
	speed: 0.0277s/iter; left time: 500.0608s
Epoch: 33 cost time: 7.7323994636535645
Epoch: 33, Steps: 268 | Train Loss: 0.1850673 Vali Loss: 0.4215707 Test Loss: 0.3628107
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1851908
	speed: 0.1379s/iter; left time: 2462.0903s
	iters: 200, epoch: 34 | loss: 0.1722978
	speed: 0.0220s/iter; left time: 390.3616s
Epoch: 34 cost time: 8.493309736251831
Epoch: 34, Steps: 268 | Train Loss: 0.1850485 Vali Loss: 0.4215559 Test Loss: 0.3629594
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1979897
	speed: 0.1307s/iter; left time: 2298.4683s
	iters: 200, epoch: 35 | loss: 0.1758774
	speed: 0.0258s/iter; left time: 451.9685s
Epoch: 35 cost time: 6.895318031311035
Epoch: 35, Steps: 268 | Train Loss: 0.1851439 Vali Loss: 0.4217083 Test Loss: 0.3631854
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1861872
	speed: 0.0911s/iter; left time: 1578.6711s
	iters: 200, epoch: 36 | loss: 0.1714617
	speed: 0.0201s/iter; left time: 345.7911s
Epoch: 36 cost time: 6.387816429138184
Epoch: 36, Steps: 268 | Train Loss: 0.1851401 Vali Loss: 0.4215206 Test Loss: 0.3631277
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1975699
	speed: 0.1087s/iter; left time: 1853.4493s
	iters: 200, epoch: 37 | loss: 0.1820737
	speed: 0.0215s/iter; left time: 365.0119s
Epoch: 37 cost time: 5.861010789871216
Epoch: 37, Steps: 268 | Train Loss: 0.1851710 Vali Loss: 0.4214624 Test Loss: 0.3631187
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1945763
	speed: 0.0859s/iter; left time: 1442.4950s
	iters: 200, epoch: 38 | loss: 0.1781673
	speed: 0.0156s/iter; left time: 259.8008s
Epoch: 38 cost time: 6.9665350914001465
Epoch: 38, Steps: 268 | Train Loss: 0.1851980 Vali Loss: 0.4215667 Test Loss: 0.3631715
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1742538
	speed: 0.1142s/iter; left time: 1885.9874s
	iters: 200, epoch: 39 | loss: 0.1923815
	speed: 0.0250s/iter; left time: 410.8983s
Epoch: 39 cost time: 6.471499919891357
Epoch: 39, Steps: 268 | Train Loss: 0.1850490 Vali Loss: 0.4217410 Test Loss: 0.3632577
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2056711
	speed: 0.1347s/iter; left time: 2188.2822s
	iters: 200, epoch: 40 | loss: 0.1823446
	speed: 0.0224s/iter; left time: 362.3835s
Epoch: 40 cost time: 6.741128921508789
Epoch: 40, Steps: 268 | Train Loss: 0.1850780 Vali Loss: 0.4214537 Test Loss: 0.3630999
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1864120
	speed: 0.1245s/iter; left time: 1990.3305s
	iters: 200, epoch: 41 | loss: 0.1754888
	speed: 0.0162s/iter; left time: 257.3917s
Epoch: 41 cost time: 5.39692759513855
Epoch: 41, Steps: 268 | Train Loss: 0.1851067 Vali Loss: 0.4212871 Test Loss: 0.3630261
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1708957
	speed: 0.0864s/iter; left time: 1357.3316s
	iters: 200, epoch: 42 | loss: 0.1886975
	speed: 0.0170s/iter; left time: 265.5677s
Epoch: 42 cost time: 4.938055753707886
Epoch: 42, Steps: 268 | Train Loss: 0.1851115 Vali Loss: 0.4215245 Test Loss: 0.3630330
EarlyStopping counter: 20 out of 20
Early stopping
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=24, out_features=49, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1053696.0
params:  1225.0
Trainable parameters:  1225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3845690
	speed: 0.0249s/iter; left time: 664.2222s
	iters: 200, epoch: 1 | loss: 0.3557547
	speed: 0.0175s/iter; left time: 466.2107s
Epoch: 1 cost time: 5.854008436203003
Epoch: 1, Steps: 268 | Train Loss: 0.3480844 Vali Loss: 0.4211311 Test Loss: 0.3631704
Validation loss decreased (inf --> 0.421131).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3378445
	speed: 0.0987s/iter; left time: 2608.4867s
	iters: 200, epoch: 2 | loss: 0.3412838
	speed: 0.0237s/iter; left time: 624.8193s
Epoch: 2 cost time: 6.5079216957092285
Epoch: 2, Steps: 268 | Train Loss: 0.3473361 Vali Loss: 0.4203640 Test Loss: 0.3617009
Validation loss decreased (0.421131 --> 0.420364).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3296703
	speed: 0.1678s/iter; left time: 4389.4805s
	iters: 200, epoch: 3 | loss: 0.3766053
	speed: 0.0266s/iter; left time: 693.9349s
Epoch: 3 cost time: 9.09734320640564
Epoch: 3, Steps: 268 | Train Loss: 0.3471269 Vali Loss: 0.4178580 Test Loss: 0.3598423
Validation loss decreased (0.420364 --> 0.417858).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3920143
	speed: 0.1323s/iter; left time: 3426.4692s
	iters: 200, epoch: 4 | loss: 0.3518183
	speed: 0.0170s/iter; left time: 439.1290s
Epoch: 4 cost time: 7.549318075180054
Epoch: 4, Steps: 268 | Train Loss: 0.3469766 Vali Loss: 0.4197058 Test Loss: 0.3618928
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3329415
	speed: 0.0962s/iter; left time: 2466.7867s
	iters: 200, epoch: 5 | loss: 0.3508452
	speed: 0.0307s/iter; left time: 784.0298s
Epoch: 5 cost time: 7.7259180545806885
Epoch: 5, Steps: 268 | Train Loss: 0.3468903 Vali Loss: 0.4199749 Test Loss: 0.3619703
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3561497
	speed: 0.1342s/iter; left time: 3403.7545s
	iters: 200, epoch: 6 | loss: 0.3700062
	speed: 0.0290s/iter; left time: 733.4008s
Epoch: 6 cost time: 8.612101316452026
Epoch: 6, Steps: 268 | Train Loss: 0.3465489 Vali Loss: 0.4194417 Test Loss: 0.3617270
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3759589
	speed: 0.0968s/iter; left time: 2429.0249s
	iters: 200, epoch: 7 | loss: 0.3354038
	speed: 0.0430s/iter; left time: 1074.3170s
Epoch: 7 cost time: 8.494763851165771
Epoch: 7, Steps: 268 | Train Loss: 0.3465596 Vali Loss: 0.4210430 Test Loss: 0.3625067
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3467835
	speed: 0.1128s/iter; left time: 2799.9879s
	iters: 200, epoch: 8 | loss: 0.3431214
	speed: 0.0257s/iter; left time: 636.5023s
Epoch: 8 cost time: 6.909284591674805
Epoch: 8, Steps: 268 | Train Loss: 0.3465497 Vali Loss: 0.4183314 Test Loss: 0.3608749
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3589590
	speed: 0.1258s/iter; left time: 3088.5304s
	iters: 200, epoch: 9 | loss: 0.3575341
	speed: 0.0285s/iter; left time: 696.4045s
Epoch: 9 cost time: 6.2407989501953125
Epoch: 9, Steps: 268 | Train Loss: 0.3465755 Vali Loss: 0.4185880 Test Loss: 0.3607913
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3303330
	speed: 0.0976s/iter; left time: 2370.8848s
	iters: 200, epoch: 10 | loss: 0.3509552
	speed: 0.0282s/iter; left time: 682.9023s
Epoch: 10 cost time: 7.269963502883911
Epoch: 10, Steps: 268 | Train Loss: 0.3464914 Vali Loss: 0.4187905 Test Loss: 0.3608453
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3575276
	speed: 0.1097s/iter; left time: 2635.8845s
	iters: 200, epoch: 11 | loss: 0.3150223
	speed: 0.0291s/iter; left time: 695.2063s
Epoch: 11 cost time: 6.824498414993286
Epoch: 11, Steps: 268 | Train Loss: 0.3463042 Vali Loss: 0.4194968 Test Loss: 0.3618691
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3643266
	speed: 0.1103s/iter; left time: 2620.0697s
	iters: 200, epoch: 12 | loss: 0.3641129
	speed: 0.0293s/iter; left time: 692.0117s
Epoch: 12 cost time: 7.2735395431518555
Epoch: 12, Steps: 268 | Train Loss: 0.3464065 Vali Loss: 0.4192103 Test Loss: 0.3615226
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3909797
	speed: 0.1036s/iter; left time: 2432.7754s
	iters: 200, epoch: 13 | loss: 0.3376743
	speed: 0.0188s/iter; left time: 438.5454s
Epoch: 13 cost time: 5.195373058319092
Epoch: 13, Steps: 268 | Train Loss: 0.3462536 Vali Loss: 0.4188477 Test Loss: 0.3611463
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3547974
	speed: 0.0941s/iter; left time: 2184.1368s
	iters: 200, epoch: 14 | loss: 0.3470916
	speed: 0.0236s/iter; left time: 546.6767s
Epoch: 14 cost time: 6.51626443862915
Epoch: 14, Steps: 268 | Train Loss: 0.3462736 Vali Loss: 0.4189354 Test Loss: 0.3608645
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3268171
	speed: 0.0918s/iter; left time: 2107.3604s
	iters: 200, epoch: 15 | loss: 0.3211106
	speed: 0.0177s/iter; left time: 405.0644s
Epoch: 15 cost time: 5.4412758350372314
Epoch: 15, Steps: 268 | Train Loss: 0.3463616 Vali Loss: 0.4190531 Test Loss: 0.3615859
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3064584
	speed: 0.1096s/iter; left time: 2484.9021s
	iters: 200, epoch: 16 | loss: 0.3740736
	speed: 0.0221s/iter; left time: 499.1244s
Epoch: 16 cost time: 7.088449001312256
Epoch: 16, Steps: 268 | Train Loss: 0.3462403 Vali Loss: 0.4177437 Test Loss: 0.3602522
Validation loss decreased (0.417858 --> 0.417744).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3548703
	speed: 0.1398s/iter; left time: 3132.5274s
	iters: 200, epoch: 17 | loss: 0.3497171
	speed: 0.0237s/iter; left time: 527.7380s
Epoch: 17 cost time: 7.246908664703369
Epoch: 17, Steps: 268 | Train Loss: 0.3462789 Vali Loss: 0.4188170 Test Loss: 0.3607225
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3090186
	speed: 0.1195s/iter; left time: 2645.9810s
	iters: 200, epoch: 18 | loss: 0.3806377
	speed: 0.0216s/iter; left time: 475.2086s
Epoch: 18 cost time: 8.12418818473816
Epoch: 18, Steps: 268 | Train Loss: 0.3462574 Vali Loss: 0.4186557 Test Loss: 0.3609979
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3799781
	speed: 0.1344s/iter; left time: 2940.2560s
	iters: 200, epoch: 19 | loss: 0.3406085
	speed: 0.0302s/iter; left time: 657.4908s
Epoch: 19 cost time: 9.038783073425293
Epoch: 19, Steps: 268 | Train Loss: 0.3461438 Vali Loss: 0.4185248 Test Loss: 0.3609171
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3756350
	speed: 0.1226s/iter; left time: 2649.6640s
	iters: 200, epoch: 20 | loss: 0.3566102
	speed: 0.0239s/iter; left time: 513.3741s
Epoch: 20 cost time: 6.229875802993774
Epoch: 20, Steps: 268 | Train Loss: 0.3459875 Vali Loss: 0.4181546 Test Loss: 0.3604280
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3936798
	speed: 0.0992s/iter; left time: 2117.5321s
	iters: 200, epoch: 21 | loss: 0.3557545
	speed: 0.0225s/iter; left time: 478.7288s
Epoch: 21 cost time: 6.96441388130188
Epoch: 21, Steps: 268 | Train Loss: 0.3461370 Vali Loss: 0.4184696 Test Loss: 0.3608044
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3885969
	speed: 0.1001s/iter; left time: 2108.4676s
	iters: 200, epoch: 22 | loss: 0.3678005
	speed: 0.0190s/iter; left time: 398.4493s
Epoch: 22 cost time: 5.162564992904663
Epoch: 22, Steps: 268 | Train Loss: 0.3460597 Vali Loss: 0.4191412 Test Loss: 0.3614737
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3726734
	speed: 0.0982s/iter; left time: 2043.6152s
	iters: 200, epoch: 23 | loss: 0.3793909
	speed: 0.0174s/iter; left time: 361.2619s
Epoch: 23 cost time: 5.988860130310059
Epoch: 23, Steps: 268 | Train Loss: 0.3461767 Vali Loss: 0.4185137 Test Loss: 0.3608045
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3185834
	speed: 0.1037s/iter; left time: 2129.9319s
	iters: 200, epoch: 24 | loss: 0.3269410
	speed: 0.0239s/iter; left time: 488.6429s
Epoch: 24 cost time: 7.470003366470337
Epoch: 24, Steps: 268 | Train Loss: 0.3460258 Vali Loss: 0.4184072 Test Loss: 0.3607269
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2978481
	speed: 0.1951s/iter; left time: 3953.8468s
	iters: 200, epoch: 25 | loss: 0.3785168
	speed: 0.0280s/iter; left time: 563.8447s
Epoch: 25 cost time: 10.187569856643677
Epoch: 25, Steps: 268 | Train Loss: 0.3460797 Vali Loss: 0.4184783 Test Loss: 0.3609223
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3479727
	speed: 0.1753s/iter; left time: 3505.7543s
	iters: 200, epoch: 26 | loss: 0.4069010
	speed: 0.0269s/iter; left time: 535.5530s
Epoch: 26 cost time: 9.054047346115112
Epoch: 26, Steps: 268 | Train Loss: 0.3461887 Vali Loss: 0.4188224 Test Loss: 0.3608950
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3547019
	speed: 0.1779s/iter; left time: 3509.9654s
	iters: 200, epoch: 27 | loss: 0.3296918
	speed: 0.0225s/iter; left time: 442.0146s
Epoch: 27 cost time: 5.139244079589844
Epoch: 27, Steps: 268 | Train Loss: 0.3461402 Vali Loss: 0.4185583 Test Loss: 0.3608946
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3277932
	speed: 0.1072s/iter; left time: 2086.9445s
	iters: 200, epoch: 28 | loss: 0.3503632
	speed: 0.0411s/iter; left time: 795.8725s
Epoch: 28 cost time: 8.777151823043823
Epoch: 28, Steps: 268 | Train Loss: 0.3461363 Vali Loss: 0.4177534 Test Loss: 0.3603244
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3487933
	speed: 0.1080s/iter; left time: 2073.1143s
	iters: 200, epoch: 29 | loss: 0.3438551
	speed: 0.0161s/iter; left time: 306.5728s
Epoch: 29 cost time: 6.528402805328369
Epoch: 29, Steps: 268 | Train Loss: 0.3461312 Vali Loss: 0.4182401 Test Loss: 0.3605809
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3199284
	speed: 0.0914s/iter; left time: 1730.6046s
	iters: 200, epoch: 30 | loss: 0.3436132
	speed: 0.0209s/iter; left time: 393.2736s
Epoch: 30 cost time: 6.366405963897705
Epoch: 30, Steps: 268 | Train Loss: 0.3460948 Vali Loss: 0.4183495 Test Loss: 0.3608241
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3081624
	speed: 0.1282s/iter; left time: 2392.6435s
	iters: 200, epoch: 31 | loss: 0.3385714
	speed: 0.0491s/iter; left time: 911.7041s
Epoch: 31 cost time: 9.61359190940857
Epoch: 31, Steps: 268 | Train Loss: 0.3460923 Vali Loss: 0.4189642 Test Loss: 0.3609603
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3825841
	speed: 0.1126s/iter; left time: 2071.4634s
	iters: 200, epoch: 32 | loss: 0.3506329
	speed: 0.0265s/iter; left time: 483.8683s
Epoch: 32 cost time: 8.003132581710815
Epoch: 32, Steps: 268 | Train Loss: 0.3460108 Vali Loss: 0.4182289 Test Loss: 0.3607526
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3400064
	speed: 0.1462s/iter; left time: 2649.3404s
	iters: 200, epoch: 33 | loss: 0.3251876
	speed: 0.0372s/iter; left time: 671.0494s
Epoch: 33 cost time: 10.033780813217163
Epoch: 33, Steps: 268 | Train Loss: 0.3459957 Vali Loss: 0.4187341 Test Loss: 0.3607502
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3459943
	speed: 0.1403s/iter; left time: 2504.6232s
	iters: 200, epoch: 34 | loss: 0.3585908
	speed: 0.0347s/iter; left time: 616.0598s
Epoch: 34 cost time: 8.548110485076904
Epoch: 34, Steps: 268 | Train Loss: 0.3459744 Vali Loss: 0.4186009 Test Loss: 0.3605039
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3333924
	speed: 0.0967s/iter; left time: 1700.0701s
	iters: 200, epoch: 35 | loss: 0.3265567
	speed: 0.0164s/iter; left time: 286.4368s
Epoch: 35 cost time: 5.057379484176636
Epoch: 35, Steps: 268 | Train Loss: 0.3460588 Vali Loss: 0.4186234 Test Loss: 0.3607839
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3283828
	speed: 0.0913s/iter; left time: 1581.4092s
	iters: 200, epoch: 36 | loss: 0.3770793
	speed: 0.0127s/iter; left time: 219.1952s
Epoch: 36 cost time: 5.20866847038269
Epoch: 36, Steps: 268 | Train Loss: 0.3460747 Vali Loss: 0.4187558 Test Loss: 0.3607759
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_96_FITS_ETTm1_ftM_sl90_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3627954423427582, mae:0.3804476857185364, rse:0.5731427669525146, corr:[0.5534515  0.553698   0.54891753 0.54829323 0.5462122  0.5426486
 0.54098386 0.5401853  0.5384653  0.536857   0.5362306  0.5358871
 0.5351429  0.5336358  0.5309741  0.5275005  0.52421504 0.52125186
 0.51816624 0.5151168  0.5123267  0.50948113 0.5062322  0.5028471
 0.4997476  0.49657142 0.49343544 0.49089915 0.48927507 0.48782298
 0.48664454 0.48680428 0.48749822 0.48795214 0.4881858  0.48869133
 0.48886412 0.48867926 0.4885169  0.48853678 0.48861656 0.48830444
 0.48804235 0.4880802  0.48785332 0.48731935 0.48707634 0.48725608
 0.48745134 0.48758575 0.48792273 0.48820958 0.48839414 0.48858494
 0.48915645 0.48972002 0.48998895 0.48995116 0.489778   0.4897396
 0.48958167 0.48900208 0.4886047  0.488399   0.48828143 0.4880036
 0.4877817  0.48786205 0.48813364 0.48841205 0.48862243 0.48901224
 0.48947337 0.48964995 0.48993656 0.49050692 0.49138054 0.49220774
 0.4929534  0.4938138  0.49467304 0.4952056  0.49555048 0.49568912
 0.496124   0.4971178  0.49815336 0.4988642  0.49985784 0.50127167
 0.5021893  0.5027545  0.5039825  0.505115   0.5057166  0.5061889 ]
