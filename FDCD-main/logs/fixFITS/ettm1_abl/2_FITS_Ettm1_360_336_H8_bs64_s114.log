Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_336_FITS_ETTm1_ftM_sl360_ll48_pl336_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33865
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=42, out_features=81, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3048192.0
params:  3483.0
Trainable parameters:  3483
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4489350
	speed: 0.0219s/iter; left time: 576.8719s
	iters: 200, epoch: 1 | loss: 0.3888270
	speed: 0.0150s/iter; left time: 393.3070s
Epoch: 1 cost time: 4.6275904178619385
Epoch: 1, Steps: 264 | Train Loss: 0.4505037 Vali Loss: 0.8907783 Test Loss: 0.5412042
Validation loss decreased (inf --> 0.890778).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2788235
	speed: 0.0694s/iter; left time: 1805.6967s
	iters: 200, epoch: 2 | loss: 0.2508847
	speed: 0.0147s/iter; left time: 381.1259s
Epoch: 2 cost time: 4.280571460723877
Epoch: 2, Steps: 264 | Train Loss: 0.2783008 Vali Loss: 0.7690489 Test Loss: 0.4447842
Validation loss decreased (0.890778 --> 0.769049).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2422371
	speed: 0.0688s/iter; left time: 1774.1445s
	iters: 200, epoch: 3 | loss: 0.2433330
	speed: 0.0128s/iter; left time: 328.9240s
Epoch: 3 cost time: 4.014753341674805
Epoch: 3, Steps: 264 | Train Loss: 0.2294099 Vali Loss: 0.7204624 Test Loss: 0.4097508
Validation loss decreased (0.769049 --> 0.720462).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2193121
	speed: 0.0683s/iter; left time: 1741.2505s
	iters: 200, epoch: 4 | loss: 0.2049870
	speed: 0.0129s/iter; left time: 326.7319s
Epoch: 4 cost time: 3.9834280014038086
Epoch: 4, Steps: 264 | Train Loss: 0.2080879 Vali Loss: 0.6964379 Test Loss: 0.3941505
Validation loss decreased (0.720462 --> 0.696438).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2095858
	speed: 0.0694s/iter; left time: 1752.5586s
	iters: 200, epoch: 5 | loss: 0.1865127
	speed: 0.0138s/iter; left time: 346.1727s
Epoch: 5 cost time: 4.200046062469482
Epoch: 5, Steps: 264 | Train Loss: 0.1969583 Vali Loss: 0.6833621 Test Loss: 0.3860432
Validation loss decreased (0.696438 --> 0.683362).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1878866
	speed: 0.0689s/iter; left time: 1721.6416s
	iters: 200, epoch: 6 | loss: 0.1879930
	speed: 0.0136s/iter; left time: 337.5079s
Epoch: 6 cost time: 4.17403507232666
Epoch: 6, Steps: 264 | Train Loss: 0.1907250 Vali Loss: 0.6774588 Test Loss: 0.3818756
Validation loss decreased (0.683362 --> 0.677459).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1930417
	speed: 0.1072s/iter; left time: 2650.0651s
	iters: 200, epoch: 7 | loss: 0.1729393
	speed: 0.0129s/iter; left time: 316.4759s
Epoch: 7 cost time: 3.944842576980591
Epoch: 7, Steps: 264 | Train Loss: 0.1869683 Vali Loss: 0.6721884 Test Loss: 0.3793278
Validation loss decreased (0.677459 --> 0.672188).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1796382
	speed: 0.0667s/iter; left time: 1631.2553s
	iters: 200, epoch: 8 | loss: 0.1933133
	speed: 0.0134s/iter; left time: 325.5741s
Epoch: 8 cost time: 4.009268045425415
Epoch: 8, Steps: 264 | Train Loss: 0.1847871 Vali Loss: 0.6702671 Test Loss: 0.3779880
Validation loss decreased (0.672188 --> 0.670267).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1908081
	speed: 0.0683s/iter; left time: 1651.5904s
	iters: 200, epoch: 9 | loss: 0.1812809
	speed: 0.0139s/iter; left time: 334.7851s
Epoch: 9 cost time: 4.228581190109253
Epoch: 9, Steps: 264 | Train Loss: 0.1833653 Vali Loss: 0.6671734 Test Loss: 0.3773710
Validation loss decreased (0.670267 --> 0.667173).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1861947
	speed: 0.0721s/iter; left time: 1724.6582s
	iters: 200, epoch: 10 | loss: 0.1827951
	speed: 0.0139s/iter; left time: 331.1041s
Epoch: 10 cost time: 4.136441946029663
Epoch: 10, Steps: 264 | Train Loss: 0.1825153 Vali Loss: 0.6665060 Test Loss: 0.3767929
Validation loss decreased (0.667173 --> 0.666506).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1708073
	speed: 0.0685s/iter; left time: 1619.7913s
	iters: 200, epoch: 11 | loss: 0.1905240
	speed: 0.0133s/iter; left time: 312.9995s
Epoch: 11 cost time: 4.1002960205078125
Epoch: 11, Steps: 264 | Train Loss: 0.1819199 Vali Loss: 0.6654435 Test Loss: 0.3763109
Validation loss decreased (0.666506 --> 0.665443).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1810149
	speed: 0.0678s/iter; left time: 1587.3135s
	iters: 200, epoch: 12 | loss: 0.1820632
	speed: 0.0149s/iter; left time: 347.7217s
Epoch: 12 cost time: 4.320358753204346
Epoch: 12, Steps: 264 | Train Loss: 0.1815312 Vali Loss: 0.6645999 Test Loss: 0.3765143
Validation loss decreased (0.665443 --> 0.664600).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1824463
	speed: 0.0708s/iter; left time: 1638.3964s
	iters: 200, epoch: 13 | loss: 0.1825811
	speed: 0.0134s/iter; left time: 308.7624s
Epoch: 13 cost time: 4.007615804672241
Epoch: 13, Steps: 264 | Train Loss: 0.1812977 Vali Loss: 0.6647416 Test Loss: 0.3763330
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1811215
	speed: 0.0672s/iter; left time: 1535.8809s
	iters: 200, epoch: 14 | loss: 0.1768723
	speed: 0.0139s/iter; left time: 316.0280s
Epoch: 14 cost time: 4.0937957763671875
Epoch: 14, Steps: 264 | Train Loss: 0.1811086 Vali Loss: 0.6647108 Test Loss: 0.3763002
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1823092
	speed: 0.0690s/iter; left time: 1559.8915s
	iters: 200, epoch: 15 | loss: 0.2029882
	speed: 0.0133s/iter; left time: 299.3180s
Epoch: 15 cost time: 4.040694713592529
Epoch: 15, Steps: 264 | Train Loss: 0.1809951 Vali Loss: 0.6643475 Test Loss: 0.3761714
Validation loss decreased (0.664600 --> 0.664347).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1806255
	speed: 0.0681s/iter; left time: 1521.6475s
	iters: 200, epoch: 16 | loss: 0.1758824
	speed: 0.0135s/iter; left time: 300.7533s
Epoch: 16 cost time: 4.064610242843628
Epoch: 16, Steps: 264 | Train Loss: 0.1809349 Vali Loss: 0.6641276 Test Loss: 0.3761599
Validation loss decreased (0.664347 --> 0.664128).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1801084
	speed: 0.0670s/iter; left time: 1478.0603s
	iters: 200, epoch: 17 | loss: 0.1801203
	speed: 0.0150s/iter; left time: 330.6921s
Epoch: 17 cost time: 4.349989891052246
Epoch: 17, Steps: 264 | Train Loss: 0.1808554 Vali Loss: 0.6636415 Test Loss: 0.3762653
Validation loss decreased (0.664128 --> 0.663641).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1820744
	speed: 0.0699s/iter; left time: 1525.5087s
	iters: 200, epoch: 18 | loss: 0.1844653
	speed: 0.0129s/iter; left time: 279.0989s
Epoch: 18 cost time: 3.888840675354004
Epoch: 18, Steps: 264 | Train Loss: 0.1808184 Vali Loss: 0.6643310 Test Loss: 0.3764595
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1950970
	speed: 0.0712s/iter; left time: 1534.7640s
	iters: 200, epoch: 19 | loss: 0.1738342
	speed: 0.0139s/iter; left time: 297.1196s
Epoch: 19 cost time: 4.152056932449341
Epoch: 19, Steps: 264 | Train Loss: 0.1807931 Vali Loss: 0.6636495 Test Loss: 0.3762361
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1641503
	speed: 0.0674s/iter; left time: 1433.8647s
	iters: 200, epoch: 20 | loss: 0.1865509
	speed: 0.0134s/iter; left time: 284.8169s
Epoch: 20 cost time: 4.02044153213501
Epoch: 20, Steps: 264 | Train Loss: 0.1807102 Vali Loss: 0.6636323 Test Loss: 0.3761227
Validation loss decreased (0.663641 --> 0.663632).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1790474
	speed: 0.0698s/iter; left time: 1466.6441s
	iters: 200, epoch: 21 | loss: 0.1716753
	speed: 0.0161s/iter; left time: 336.4065s
Epoch: 21 cost time: 4.860772609710693
Epoch: 21, Steps: 264 | Train Loss: 0.1807636 Vali Loss: 0.6636257 Test Loss: 0.3762525
Validation loss decreased (0.663632 --> 0.663626).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1572900
	speed: 0.0738s/iter; left time: 1531.5427s
	iters: 200, epoch: 22 | loss: 0.1717799
	speed: 0.0134s/iter; left time: 277.0414s
Epoch: 22 cost time: 4.1061110496521
Epoch: 22, Steps: 264 | Train Loss: 0.1807317 Vali Loss: 0.6644799 Test Loss: 0.3762801
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1794552
	speed: 0.0709s/iter; left time: 1452.7288s
	iters: 200, epoch: 23 | loss: 0.1723157
	speed: 0.0147s/iter; left time: 298.9751s
Epoch: 23 cost time: 4.503390312194824
Epoch: 23, Steps: 264 | Train Loss: 0.1807244 Vali Loss: 0.6646038 Test Loss: 0.3763130
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1759062
	speed: 0.0750s/iter; left time: 1517.5752s
	iters: 200, epoch: 24 | loss: 0.1795538
	speed: 0.0130s/iter; left time: 262.0710s
Epoch: 24 cost time: 4.180677890777588
Epoch: 24, Steps: 264 | Train Loss: 0.1807143 Vali Loss: 0.6629036 Test Loss: 0.3764696
Validation loss decreased (0.663626 --> 0.662904).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1856094
	speed: 0.0681s/iter; left time: 1358.9588s
	iters: 200, epoch: 25 | loss: 0.1556824
	speed: 0.0130s/iter; left time: 258.6492s
Epoch: 25 cost time: 3.984478712081909
Epoch: 25, Steps: 264 | Train Loss: 0.1806963 Vali Loss: 0.6641541 Test Loss: 0.3765002
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1668503
	speed: 0.0663s/iter; left time: 1307.0692s
	iters: 200, epoch: 26 | loss: 0.1802625
	speed: 0.0130s/iter; left time: 255.1438s
Epoch: 26 cost time: 3.864206314086914
Epoch: 26, Steps: 264 | Train Loss: 0.1807708 Vali Loss: 0.6642802 Test Loss: 0.3763910
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1701588
	speed: 0.0680s/iter; left time: 1321.5369s
	iters: 200, epoch: 27 | loss: 0.1875954
	speed: 0.0129s/iter; left time: 249.1326s
Epoch: 27 cost time: 3.9226293563842773
Epoch: 27, Steps: 264 | Train Loss: 0.1806905 Vali Loss: 0.6647762 Test Loss: 0.3764483
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1944509
	speed: 0.0677s/iter; left time: 1297.1090s
	iters: 200, epoch: 28 | loss: 0.1629862
	speed: 0.0135s/iter; left time: 258.1054s
Epoch: 28 cost time: 4.066792011260986
Epoch: 28, Steps: 264 | Train Loss: 0.1806983 Vali Loss: 0.6645145 Test Loss: 0.3763891
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1986700
	speed: 0.0713s/iter; left time: 1348.0245s
	iters: 200, epoch: 29 | loss: 0.1861488
	speed: 0.0168s/iter; left time: 315.3286s
Epoch: 29 cost time: 4.798939943313599
Epoch: 29, Steps: 264 | Train Loss: 0.1807249 Vali Loss: 0.6642834 Test Loss: 0.3765075
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1763009
	speed: 0.0758s/iter; left time: 1412.7177s
	iters: 200, epoch: 30 | loss: 0.1665810
	speed: 0.0132s/iter; left time: 245.2349s
Epoch: 30 cost time: 4.366217613220215
Epoch: 30, Steps: 264 | Train Loss: 0.1807108 Vali Loss: 0.6640720 Test Loss: 0.3764090
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2191080
	speed: 0.0698s/iter; left time: 1283.5131s
	iters: 200, epoch: 31 | loss: 0.1726891
	speed: 0.0133s/iter; left time: 242.8146s
Epoch: 31 cost time: 4.120100498199463
Epoch: 31, Steps: 264 | Train Loss: 0.1807077 Vali Loss: 0.6643133 Test Loss: 0.3764269
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2005216
	speed: 0.0682s/iter; left time: 1235.0801s
	iters: 200, epoch: 32 | loss: 0.2141582
	speed: 0.0131s/iter; left time: 236.3150s
Epoch: 32 cost time: 4.031046628952026
Epoch: 32, Steps: 264 | Train Loss: 0.1807616 Vali Loss: 0.6644742 Test Loss: 0.3765017
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1678562
	speed: 0.0701s/iter; left time: 1251.2324s
	iters: 200, epoch: 33 | loss: 0.1713942
	speed: 0.0133s/iter; left time: 236.6869s
Epoch: 33 cost time: 4.109801530838013
Epoch: 33, Steps: 264 | Train Loss: 0.1806988 Vali Loss: 0.6639889 Test Loss: 0.3763464
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1642766
	speed: 0.0692s/iter; left time: 1216.8989s
	iters: 200, epoch: 34 | loss: 0.1963515
	speed: 0.0131s/iter; left time: 229.8528s
Epoch: 34 cost time: 4.105101823806763
Epoch: 34, Steps: 264 | Train Loss: 0.1807175 Vali Loss: 0.6641221 Test Loss: 0.3764457
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1787934
	speed: 0.0679s/iter; left time: 1176.4479s
	iters: 200, epoch: 35 | loss: 0.1875439
	speed: 0.0136s/iter; left time: 233.8571s
Epoch: 35 cost time: 4.010729074478149
Epoch: 35, Steps: 264 | Train Loss: 0.1807255 Vali Loss: 0.6638117 Test Loss: 0.3764104
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1723558
	speed: 0.0684s/iter; left time: 1166.9766s
	iters: 200, epoch: 36 | loss: 0.1846218
	speed: 0.0149s/iter; left time: 252.6234s
Epoch: 36 cost time: 4.329949617385864
Epoch: 36, Steps: 264 | Train Loss: 0.1806619 Vali Loss: 0.6641628 Test Loss: 0.3764794
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1749551
	speed: 0.0763s/iter; left time: 1281.7755s
	iters: 200, epoch: 37 | loss: 0.1672696
	speed: 0.0162s/iter; left time: 269.6987s
Epoch: 37 cost time: 5.161378383636475
Epoch: 37, Steps: 264 | Train Loss: 0.1806941 Vali Loss: 0.6645582 Test Loss: 0.3763664
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1896981
	speed: 0.0780s/iter; left time: 1289.0133s
	iters: 200, epoch: 38 | loss: 0.1694541
	speed: 0.0165s/iter; left time: 271.9273s
Epoch: 38 cost time: 4.6618993282318115
Epoch: 38, Steps: 264 | Train Loss: 0.1806840 Vali Loss: 0.6639361 Test Loss: 0.3765889
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1986108
	speed: 0.0678s/iter; left time: 1103.3863s
	iters: 200, epoch: 39 | loss: 0.1586985
	speed: 0.0131s/iter; left time: 212.4283s
Epoch: 39 cost time: 3.9266140460968018
Epoch: 39, Steps: 264 | Train Loss: 0.1806647 Vali Loss: 0.6643487 Test Loss: 0.3765069
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1804640
	speed: 0.0677s/iter; left time: 1084.1003s
	iters: 200, epoch: 40 | loss: 0.1469055
	speed: 0.0129s/iter; left time: 205.2990s
Epoch: 40 cost time: 4.144441366195679
Epoch: 40, Steps: 264 | Train Loss: 0.1806592 Vali Loss: 0.6647778 Test Loss: 0.3763902
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1670600
	speed: 0.0682s/iter; left time: 1072.8142s
	iters: 200, epoch: 41 | loss: 0.1948295
	speed: 0.0129s/iter; left time: 201.3195s
Epoch: 41 cost time: 3.9146952629089355
Epoch: 41, Steps: 264 | Train Loss: 0.1806570 Vali Loss: 0.6644974 Test Loss: 0.3763970
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1777162
	speed: 0.0684s/iter; left time: 1058.7142s
	iters: 200, epoch: 42 | loss: 0.1752333
	speed: 0.0154s/iter; left time: 237.2078s
Epoch: 42 cost time: 4.388553142547607
Epoch: 42, Steps: 264 | Train Loss: 0.1806880 Vali Loss: 0.6646464 Test Loss: 0.3764179
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1887384
	speed: 0.0679s/iter; left time: 1033.5813s
	iters: 200, epoch: 43 | loss: 0.1788851
	speed: 0.0136s/iter; left time: 206.1129s
Epoch: 43 cost time: 4.086395502090454
Epoch: 43, Steps: 264 | Train Loss: 0.1806765 Vali Loss: 0.6650214 Test Loss: 0.3764278
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1687402
	speed: 0.0700s/iter; left time: 1046.0282s
	iters: 200, epoch: 44 | loss: 0.1614235
	speed: 0.0135s/iter; left time: 200.9731s
Epoch: 44 cost time: 4.125335454940796
Epoch: 44, Steps: 264 | Train Loss: 0.1806663 Vali Loss: 0.6646358 Test Loss: 0.3764420
EarlyStopping counter: 20 out of 20
Early stopping
train 33865
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=42, out_features=81, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3048192.0
params:  3483.0
Trainable parameters:  3483
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3075469
	speed: 0.0187s/iter; left time: 491.7490s
	iters: 200, epoch: 1 | loss: 0.3282262
	speed: 0.0160s/iter; left time: 419.1832s
Epoch: 1 cost time: 4.4860100746154785
Epoch: 1, Steps: 264 | Train Loss: 0.3496480 Vali Loss: 0.6582870 Test Loss: 0.3732224
Validation loss decreased (inf --> 0.658287).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3579518
	speed: 0.0696s/iter; left time: 1813.0023s
	iters: 200, epoch: 2 | loss: 0.3500634
	speed: 0.0135s/iter; left time: 350.8957s
Epoch: 2 cost time: 4.019153594970703
Epoch: 2, Steps: 264 | Train Loss: 0.3488119 Vali Loss: 0.6580032 Test Loss: 0.3730080
Validation loss decreased (0.658287 --> 0.658003).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3441125
	speed: 0.0657s/iter; left time: 1694.5539s
	iters: 200, epoch: 3 | loss: 0.3617926
	speed: 0.0152s/iter; left time: 389.4263s
Epoch: 3 cost time: 4.339520454406738
Epoch: 3, Steps: 264 | Train Loss: 0.3483952 Vali Loss: 0.6573501 Test Loss: 0.3726931
Validation loss decreased (0.658003 --> 0.657350).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3551576
	speed: 0.0693s/iter; left time: 1767.3121s
	iters: 200, epoch: 4 | loss: 0.3507130
	speed: 0.0126s/iter; left time: 320.9275s
Epoch: 4 cost time: 4.020590305328369
Epoch: 4, Steps: 264 | Train Loss: 0.3482808 Vali Loss: 0.6552135 Test Loss: 0.3728755
Validation loss decreased (0.657350 --> 0.655213).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3393152
	speed: 0.0687s/iter; left time: 1735.0722s
	iters: 200, epoch: 5 | loss: 0.3588387
	speed: 0.0160s/iter; left time: 403.0764s
Epoch: 5 cost time: 4.58395528793335
Epoch: 5, Steps: 264 | Train Loss: 0.3481662 Vali Loss: 0.6549585 Test Loss: 0.3731167
Validation loss decreased (0.655213 --> 0.654958).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3452926
	speed: 0.0711s/iter; left time: 1775.9123s
	iters: 200, epoch: 6 | loss: 0.3757049
	speed: 0.0134s/iter; left time: 332.1654s
Epoch: 6 cost time: 4.169688940048218
Epoch: 6, Steps: 264 | Train Loss: 0.3480251 Vali Loss: 0.6546187 Test Loss: 0.3724937
Validation loss decreased (0.654958 --> 0.654619).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3617449
	speed: 0.0741s/iter; left time: 1830.9994s
	iters: 200, epoch: 7 | loss: 0.3380530
	speed: 0.0154s/iter; left time: 379.2904s
Epoch: 7 cost time: 4.705165863037109
Epoch: 7, Steps: 264 | Train Loss: 0.3479182 Vali Loss: 0.6541449 Test Loss: 0.3724421
Validation loss decreased (0.654619 --> 0.654145).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3073516
	speed: 0.0761s/iter; left time: 1860.4182s
	iters: 200, epoch: 8 | loss: 0.3701615
	speed: 0.0134s/iter; left time: 327.3043s
Epoch: 8 cost time: 4.292227745056152
Epoch: 8, Steps: 264 | Train Loss: 0.3478719 Vali Loss: 0.6542268 Test Loss: 0.3725518
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3507875
	speed: 0.0694s/iter; left time: 1679.3944s
	iters: 200, epoch: 9 | loss: 0.3615126
	speed: 0.0257s/iter; left time: 619.5940s
Epoch: 9 cost time: 5.476726531982422
Epoch: 9, Steps: 264 | Train Loss: 0.3477904 Vali Loss: 0.6531962 Test Loss: 0.3726163
Validation loss decreased (0.654145 --> 0.653196).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3601787
	speed: 0.0712s/iter; left time: 1703.4207s
	iters: 200, epoch: 10 | loss: 0.3531479
	speed: 0.0163s/iter; left time: 388.7822s
Epoch: 10 cost time: 4.621523141860962
Epoch: 10, Steps: 264 | Train Loss: 0.3478285 Vali Loss: 0.6545418 Test Loss: 0.3725008
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3313884
	speed: 0.0682s/iter; left time: 1613.1031s
	iters: 200, epoch: 11 | loss: 0.3230368
	speed: 0.0131s/iter; left time: 308.0581s
Epoch: 11 cost time: 4.042922019958496
Epoch: 11, Steps: 264 | Train Loss: 0.3476586 Vali Loss: 0.6545589 Test Loss: 0.3724482
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3304665
	speed: 0.0681s/iter; left time: 1593.6823s
	iters: 200, epoch: 12 | loss: 0.3709167
	speed: 0.0128s/iter; left time: 299.1474s
Epoch: 12 cost time: 3.988734245300293
Epoch: 12, Steps: 264 | Train Loss: 0.3477015 Vali Loss: 0.6541961 Test Loss: 0.3724436
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3272366
	speed: 0.0683s/iter; left time: 1580.4217s
	iters: 200, epoch: 13 | loss: 0.3261302
	speed: 0.0133s/iter; left time: 306.0487s
Epoch: 13 cost time: 4.117001295089722
Epoch: 13, Steps: 264 | Train Loss: 0.3477271 Vali Loss: 0.6537135 Test Loss: 0.3724646
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3698837
	speed: 0.0694s/iter; left time: 1585.9926s
	iters: 200, epoch: 14 | loss: 0.3848810
	speed: 0.0129s/iter; left time: 293.8015s
Epoch: 14 cost time: 3.9794328212738037
Epoch: 14, Steps: 264 | Train Loss: 0.3476937 Vali Loss: 0.6541002 Test Loss: 0.3724976
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3465758
	speed: 0.0668s/iter; left time: 1510.2701s
	iters: 200, epoch: 15 | loss: 0.3649733
	speed: 0.0134s/iter; left time: 301.8252s
Epoch: 15 cost time: 3.990424871444702
Epoch: 15, Steps: 264 | Train Loss: 0.3475958 Vali Loss: 0.6540019 Test Loss: 0.3725791
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3749490
	speed: 0.0658s/iter; left time: 1470.5660s
	iters: 200, epoch: 16 | loss: 0.3255517
	speed: 0.0131s/iter; left time: 291.3565s
Epoch: 16 cost time: 3.9806864261627197
Epoch: 16, Steps: 264 | Train Loss: 0.3478309 Vali Loss: 0.6550196 Test Loss: 0.3726276
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3742666
	speed: 0.0670s/iter; left time: 1480.0424s
	iters: 200, epoch: 17 | loss: 0.3462708
	speed: 0.0130s/iter; left time: 284.8691s
Epoch: 17 cost time: 4.046702861785889
Epoch: 17, Steps: 264 | Train Loss: 0.3476789 Vali Loss: 0.6537224 Test Loss: 0.3722476
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3569331
	speed: 0.0671s/iter; left time: 1463.5643s
	iters: 200, epoch: 18 | loss: 0.3513539
	speed: 0.0131s/iter; left time: 283.3892s
Epoch: 18 cost time: 4.043989896774292
Epoch: 18, Steps: 264 | Train Loss: 0.3477070 Vali Loss: 0.6546726 Test Loss: 0.3725154
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3661570
	speed: 0.0681s/iter; left time: 1467.4032s
	iters: 200, epoch: 19 | loss: 0.3366486
	speed: 0.0131s/iter; left time: 281.7097s
Epoch: 19 cost time: 4.034820318222046
Epoch: 19, Steps: 264 | Train Loss: 0.3477189 Vali Loss: 0.6541197 Test Loss: 0.3724279
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3504957
	speed: 0.0724s/iter; left time: 1541.3352s
	iters: 200, epoch: 20 | loss: 0.3177657
	speed: 0.0159s/iter; left time: 337.4719s
Epoch: 20 cost time: 4.731657266616821
Epoch: 20, Steps: 264 | Train Loss: 0.3476320 Vali Loss: 0.6536007 Test Loss: 0.3725676
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3464660
	speed: 0.0683s/iter; left time: 1436.0714s
	iters: 200, epoch: 21 | loss: 0.3412783
	speed: 0.0129s/iter; left time: 270.7345s
Epoch: 21 cost time: 3.912153720855713
Epoch: 21, Steps: 264 | Train Loss: 0.3477404 Vali Loss: 0.6537126 Test Loss: 0.3725648
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3300931
	speed: 0.0674s/iter; left time: 1398.7723s
	iters: 200, epoch: 22 | loss: 0.3871765
	speed: 0.0132s/iter; left time: 272.5822s
Epoch: 22 cost time: 4.059253454208374
Epoch: 22, Steps: 264 | Train Loss: 0.3476332 Vali Loss: 0.6536990 Test Loss: 0.3722793
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3344986
	speed: 0.0685s/iter; left time: 1403.4799s
	iters: 200, epoch: 23 | loss: 0.3798293
	speed: 0.0135s/iter; left time: 275.5025s
Epoch: 23 cost time: 4.077858924865723
Epoch: 23, Steps: 264 | Train Loss: 0.3476859 Vali Loss: 0.6541589 Test Loss: 0.3725302
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3885562
	speed: 0.0674s/iter; left time: 1363.8881s
	iters: 200, epoch: 24 | loss: 0.3237768
	speed: 0.0135s/iter; left time: 272.2924s
Epoch: 24 cost time: 4.028525114059448
Epoch: 24, Steps: 264 | Train Loss: 0.3476792 Vali Loss: 0.6543931 Test Loss: 0.3726395
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3557013
	speed: 0.0662s/iter; left time: 1321.2185s
	iters: 200, epoch: 25 | loss: 0.3233463
	speed: 0.0132s/iter; left time: 262.3244s
Epoch: 25 cost time: 3.9941179752349854
Epoch: 25, Steps: 264 | Train Loss: 0.3475795 Vali Loss: 0.6533665 Test Loss: 0.3724508
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3208868
	speed: 0.0673s/iter; left time: 1326.7206s
	iters: 200, epoch: 26 | loss: 0.3432277
	speed: 0.0132s/iter; left time: 258.8081s
Epoch: 26 cost time: 4.011650323867798
Epoch: 26, Steps: 264 | Train Loss: 0.3476414 Vali Loss: 0.6535075 Test Loss: 0.3723936
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3883884
	speed: 0.0687s/iter; left time: 1334.9404s
	iters: 200, epoch: 27 | loss: 0.3485146
	speed: 0.0129s/iter; left time: 250.1029s
Epoch: 27 cost time: 4.063914775848389
Epoch: 27, Steps: 264 | Train Loss: 0.3475113 Vali Loss: 0.6544774 Test Loss: 0.3725838
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3216768
	speed: 0.0691s/iter; left time: 1324.7155s
	iters: 200, epoch: 28 | loss: 0.3725638
	speed: 0.0130s/iter; left time: 247.6237s
Epoch: 28 cost time: 4.109933137893677
Epoch: 28, Steps: 264 | Train Loss: 0.3475308 Vali Loss: 0.6540148 Test Loss: 0.3725563
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3574086
	speed: 0.0699s/iter; left time: 1320.7947s
	iters: 200, epoch: 29 | loss: 0.3414181
	speed: 0.0130s/iter; left time: 245.4436s
Epoch: 29 cost time: 4.088082790374756
Epoch: 29, Steps: 264 | Train Loss: 0.3475352 Vali Loss: 0.6544865 Test Loss: 0.3725064
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_336_FITS_ETTm1_ftM_sl360_ll48_pl336_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.37232768535614014, mae:0.38528972864151, rse:0.5806453824043274, corr:[0.5397723  0.5473649  0.5512686  0.5516824  0.55060834 0.5497169
 0.5496787  0.5503412  0.55107933 0.55144316 0.55144864 0.55110097
 0.5507532  0.5505942  0.55043787 0.5499131  0.5489431  0.54768974
 0.5461921  0.54463345 0.5431153  0.5418661  0.5407932  0.5399097
 0.53908986 0.5381598  0.53722405 0.53646135 0.53595644 0.5356578
 0.5357177  0.5361304  0.53663296 0.53698874 0.5370298  0.5368962
 0.5366641  0.5363787  0.5361148  0.53588104 0.53569657 0.5355078
 0.53526574 0.53503865 0.53482026 0.5346536  0.53460133 0.53453755
 0.53434914 0.5340811  0.5337228  0.5333447  0.53311497 0.5330558
 0.53315663 0.5333497  0.53346765 0.5334384  0.5332729  0.5329256
 0.53258544 0.53231514 0.53221554 0.53223866 0.5324436  0.5327864
 0.5331071  0.53327626 0.5333993  0.5334491  0.53345644 0.5334429
 0.53348935 0.53361887 0.5337497  0.53380305 0.53375834 0.5336408
 0.5334749  0.5333054  0.533172   0.53305876 0.5328719  0.5325307
 0.5321054  0.53160423 0.53118306 0.53087515 0.53072816 0.5308337
 0.5311335  0.5314291  0.5315192  0.531346   0.53085953 0.53012276
 0.52931243 0.5286039  0.52804536 0.52758694 0.5273123  0.5272359
 0.5273187  0.5274182  0.52762824 0.5279363  0.52818054 0.52843136
 0.52854794 0.5286304  0.52863353 0.52859044 0.5284849  0.5284632
 0.52852386 0.5286765  0.5288383  0.5289594  0.5289967  0.52908957
 0.52919525 0.52917904 0.5290438  0.52892596 0.5287955  0.52858424
 0.52832735 0.52809966 0.5279315  0.527869   0.52789456 0.52792025
 0.5279156  0.52775544 0.5274791  0.5271071  0.5267489  0.5264466
 0.52632433 0.5263638  0.5264584  0.5265624  0.5265607  0.5264229
 0.52614343 0.52581185 0.52550066 0.5253229  0.5253542  0.5254358
 0.5255117  0.52558875 0.5255446  0.5253679  0.5251232  0.5249548
 0.5249281  0.5250556  0.52527225 0.5255317  0.5258036  0.52599627
 0.52610916 0.5261562  0.5262641  0.526486   0.5267938  0.52722055
 0.52765083 0.5279799  0.52815795 0.5281837  0.52802795 0.52781045
 0.52764386 0.5276577  0.527821   0.5280534  0.5281671  0.52811253
 0.5278469  0.52751374 0.5271301  0.5268621  0.5267756  0.52687746
 0.52710193 0.52737975 0.5276304  0.52779686 0.52776045 0.527503
 0.5270162  0.5264581  0.52583885 0.52511835 0.5244131  0.52393544
 0.52365315 0.52346367 0.52335346 0.52323204 0.52298677 0.5226284
 0.52222604 0.5217281  0.5212771  0.5208555  0.52050453 0.5202264
 0.5199053  0.5195696  0.5191617  0.5187379  0.5182659  0.51786244
 0.5175295  0.51723033 0.51691014 0.5167222  0.51661503 0.5165734
 0.516657   0.51679605 0.51694006 0.5170484  0.51715165 0.51718086
 0.5171661  0.5171316  0.5170249  0.51683193 0.5166207  0.51638436
 0.5162149  0.5160874  0.51585764 0.51562244 0.51536304 0.5151129
 0.5149261  0.5148214  0.5148359  0.51491207 0.5149731  0.51502836
 0.5150257  0.51495385 0.51485467 0.51480836 0.51477796 0.5148139
 0.51482767 0.5148913  0.51493955 0.514941   0.5148284  0.514733
 0.5146382  0.514619   0.51473933 0.5149994  0.5152912  0.5156872
 0.5160946  0.51641375 0.51656735 0.51664823 0.5166567  0.5165713
 0.51656735 0.51667976 0.51685303 0.51702267 0.51704973 0.5169741
 0.51676    0.51653993 0.5162717  0.51609486 0.5159681  0.5158984
 0.51589483 0.5158438  0.51569206 0.51536316 0.5148606  0.5142103
 0.5134442  0.5127768  0.51231027 0.5118242  0.5113694  0.5109357
 0.51051205 0.5099776  0.5094668  0.5089725  0.5085913  0.50828373
 0.5080473  0.50785196 0.50767446 0.5075194  0.50734425 0.5071558
 0.50703245 0.50694937 0.50695604 0.5070673  0.507235   0.5073391
 0.5073597  0.5071738  0.5066869  0.50621194 0.5058257  0.5056378
 0.5056392  0.5057132  0.5056808  0.5054355  0.5049441  0.5043271
 0.5038215  0.503612   0.5036866  0.5039578  0.50409174 0.50391144
 0.50339997 0.5028827  0.5027219  0.50307465 0.5035354  0.5026268 ]
