Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=66, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_96_FITS_ETTm1_ftM_sl360_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=66, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4908288.0
params:  5561.0
Trainable parameters:  5561
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3296886
	speed: 0.0177s/iter; left time: 468.1124s
	iters: 200, epoch: 1 | loss: 0.2771121
	speed: 0.0111s/iter; left time: 294.3573s
Epoch: 1 cost time: 3.5199170112609863
Epoch: 1, Steps: 266 | Train Loss: 0.3434695 Vali Loss: 0.6667797 Test Loss: 0.4832431
Validation loss decreased (inf --> 0.666780).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1985563
	speed: 0.0484s/iter; left time: 1271.0417s
	iters: 200, epoch: 2 | loss: 0.1753067
	speed: 0.0094s/iter; left time: 245.0776s
Epoch: 2 cost time: 3.0822625160217285
Epoch: 2, Steps: 266 | Train Loss: 0.1924817 Vali Loss: 0.5647453 Test Loss: 0.4148946
Validation loss decreased (0.666780 --> 0.564745).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1409129
	speed: 0.0498s/iter; left time: 1294.0010s
	iters: 200, epoch: 3 | loss: 0.1385424
	speed: 0.0097s/iter; left time: 251.7439s
Epoch: 3 cost time: 3.218803882598877
Epoch: 3, Steps: 266 | Train Loss: 0.1426372 Vali Loss: 0.5206566 Test Loss: 0.3888345
Validation loss decreased (0.564745 --> 0.520657).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1160083
	speed: 0.0515s/iter; left time: 1323.7587s
	iters: 200, epoch: 4 | loss: 0.1118135
	speed: 0.0105s/iter; left time: 267.7087s
Epoch: 4 cost time: 3.488190174102783
Epoch: 4, Steps: 266 | Train Loss: 0.1171259 Vali Loss: 0.4955753 Test Loss: 0.3725941
Validation loss decreased (0.520657 --> 0.495575).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0993710
	speed: 0.0510s/iter; left time: 1297.6385s
	iters: 200, epoch: 5 | loss: 0.1037593
	speed: 0.0107s/iter; left time: 271.9531s
Epoch: 5 cost time: 3.4902422428131104
Epoch: 5, Steps: 266 | Train Loss: 0.1019047 Vali Loss: 0.4766497 Test Loss: 0.3597842
Validation loss decreased (0.495575 --> 0.476650).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0870954
	speed: 0.0519s/iter; left time: 1305.8187s
	iters: 200, epoch: 6 | loss: 0.0893191
	speed: 0.0107s/iter; left time: 267.6868s
Epoch: 6 cost time: 3.389277935028076
Epoch: 6, Steps: 266 | Train Loss: 0.0921811 Vali Loss: 0.4611667 Test Loss: 0.3501941
Validation loss decreased (0.476650 --> 0.461167).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0890401
	speed: 0.0475s/iter; left time: 1183.9409s
	iters: 200, epoch: 7 | loss: 0.0751277
	speed: 0.0101s/iter; left time: 249.9619s
Epoch: 7 cost time: 3.2631759643554688
Epoch: 7, Steps: 266 | Train Loss: 0.0857260 Vali Loss: 0.4500811 Test Loss: 0.3423425
Validation loss decreased (0.461167 --> 0.450081).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0746410
	speed: 0.0495s/iter; left time: 1219.0885s
	iters: 200, epoch: 8 | loss: 0.0830585
	speed: 0.0099s/iter; left time: 243.0958s
Epoch: 8 cost time: 3.231621265411377
Epoch: 8, Steps: 266 | Train Loss: 0.0813339 Vali Loss: 0.4414033 Test Loss: 0.3363962
Validation loss decreased (0.450081 --> 0.441403).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0798760
	speed: 0.0486s/iter; left time: 1184.8725s
	iters: 200, epoch: 9 | loss: 0.0707837
	speed: 0.0098s/iter; left time: 237.3388s
Epoch: 9 cost time: 3.1401894092559814
Epoch: 9, Steps: 266 | Train Loss: 0.0782681 Vali Loss: 0.4341255 Test Loss: 0.3312451
Validation loss decreased (0.441403 --> 0.434125).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0781200
	speed: 0.0468s/iter; left time: 1129.3915s
	iters: 200, epoch: 10 | loss: 0.0765252
	speed: 0.0102s/iter; left time: 244.0720s
Epoch: 10 cost time: 3.127448797225952
Epoch: 10, Steps: 266 | Train Loss: 0.0760748 Vali Loss: 0.4275682 Test Loss: 0.3273498
Validation loss decreased (0.434125 --> 0.427568).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0718924
	speed: 0.0478s/iter; left time: 1138.9283s
	iters: 200, epoch: 11 | loss: 0.0811074
	speed: 0.0099s/iter; left time: 235.3454s
Epoch: 11 cost time: 3.056875705718994
Epoch: 11, Steps: 266 | Train Loss: 0.0744987 Vali Loss: 0.4240601 Test Loss: 0.3243400
Validation loss decreased (0.427568 --> 0.424060).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0739144
	speed: 0.0469s/iter; left time: 1104.8670s
	iters: 200, epoch: 12 | loss: 0.0756171
	speed: 0.0097s/iter; left time: 227.4399s
Epoch: 12 cost time: 3.0204832553863525
Epoch: 12, Steps: 266 | Train Loss: 0.0733225 Vali Loss: 0.4204793 Test Loss: 0.3219188
Validation loss decreased (0.424060 --> 0.420479).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0806276
	speed: 0.0466s/iter; left time: 1085.8073s
	iters: 200, epoch: 13 | loss: 0.0698695
	speed: 0.0101s/iter; left time: 235.1723s
Epoch: 13 cost time: 3.1880998611450195
Epoch: 13, Steps: 266 | Train Loss: 0.0724860 Vali Loss: 0.4168644 Test Loss: 0.3195251
Validation loss decreased (0.420479 --> 0.416864).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0680958
	speed: 0.0485s/iter; left time: 1118.7148s
	iters: 200, epoch: 14 | loss: 0.0733726
	speed: 0.0102s/iter; left time: 233.7148s
Epoch: 14 cost time: 3.263875722885132
Epoch: 14, Steps: 266 | Train Loss: 0.0718876 Vali Loss: 0.4146424 Test Loss: 0.3185212
Validation loss decreased (0.416864 --> 0.414642).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0777978
	speed: 0.0511s/iter; left time: 1162.9407s
	iters: 200, epoch: 15 | loss: 0.0654075
	speed: 0.0105s/iter; left time: 238.7041s
Epoch: 15 cost time: 3.2395317554473877
Epoch: 15, Steps: 266 | Train Loss: 0.0714593 Vali Loss: 0.4126571 Test Loss: 0.3169385
Validation loss decreased (0.414642 --> 0.412657).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0714925
	speed: 0.0486s/iter; left time: 1093.1721s
	iters: 200, epoch: 16 | loss: 0.0715291
	speed: 0.0101s/iter; left time: 226.0451s
Epoch: 16 cost time: 3.214778184890747
Epoch: 16, Steps: 266 | Train Loss: 0.0711839 Vali Loss: 0.4122824 Test Loss: 0.3163951
Validation loss decreased (0.412657 --> 0.412282).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0683302
	speed: 0.0486s/iter; left time: 1080.2677s
	iters: 200, epoch: 17 | loss: 0.0663172
	speed: 0.0101s/iter; left time: 223.2288s
Epoch: 17 cost time: 3.2356057167053223
Epoch: 17, Steps: 266 | Train Loss: 0.0709682 Vali Loss: 0.4106690 Test Loss: 0.3151267
Validation loss decreased (0.412282 --> 0.410669).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0703011
	speed: 0.0477s/iter; left time: 1047.6162s
	iters: 200, epoch: 18 | loss: 0.0740802
	speed: 0.0099s/iter; left time: 215.7032s
Epoch: 18 cost time: 3.0280497074127197
Epoch: 18, Steps: 266 | Train Loss: 0.0708366 Vali Loss: 0.4114696 Test Loss: 0.3145285
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0749517
	speed: 0.0473s/iter; left time: 1026.4167s
	iters: 200, epoch: 19 | loss: 0.0695416
	speed: 0.0093s/iter; left time: 200.6990s
Epoch: 19 cost time: 3.0289688110351562
Epoch: 19, Steps: 266 | Train Loss: 0.0707379 Vali Loss: 0.4092875 Test Loss: 0.3134206
Validation loss decreased (0.410669 --> 0.409288).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0722065
	speed: 0.0495s/iter; left time: 1061.9012s
	iters: 200, epoch: 20 | loss: 0.0773997
	speed: 0.0099s/iter; left time: 212.2788s
Epoch: 20 cost time: 3.130260705947876
Epoch: 20, Steps: 266 | Train Loss: 0.0706933 Vali Loss: 0.4106681 Test Loss: 0.3134143
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0698980
	speed: 0.0468s/iter; left time: 991.7156s
	iters: 200, epoch: 21 | loss: 0.0747684
	speed: 0.0101s/iter; left time: 213.0868s
Epoch: 21 cost time: 3.0937201976776123
Epoch: 21, Steps: 266 | Train Loss: 0.0706456 Vali Loss: 0.4095344 Test Loss: 0.3128563
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0739707
	speed: 0.0492s/iter; left time: 1028.9001s
	iters: 200, epoch: 22 | loss: 0.0745999
	speed: 0.0101s/iter; left time: 211.1271s
Epoch: 22 cost time: 3.2569141387939453
Epoch: 22, Steps: 266 | Train Loss: 0.0706348 Vali Loss: 0.4100899 Test Loss: 0.3129372
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0686175
	speed: 0.0486s/iter; left time: 1002.5707s
	iters: 200, epoch: 23 | loss: 0.0682946
	speed: 0.0098s/iter; left time: 201.1923s
Epoch: 23 cost time: 3.135218381881714
Epoch: 23, Steps: 266 | Train Loss: 0.0705950 Vali Loss: 0.4089274 Test Loss: 0.3123695
Validation loss decreased (0.409288 --> 0.408927).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0712283
	speed: 0.0512s/iter; left time: 1043.7510s
	iters: 200, epoch: 24 | loss: 0.0762445
	speed: 0.0105s/iter; left time: 212.6048s
Epoch: 24 cost time: 3.360136032104492
Epoch: 24, Steps: 266 | Train Loss: 0.0706265 Vali Loss: 0.4080777 Test Loss: 0.3125911
Validation loss decreased (0.408927 --> 0.408078).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0744623
	speed: 0.0488s/iter; left time: 981.9155s
	iters: 200, epoch: 25 | loss: 0.0646673
	speed: 0.0105s/iter; left time: 210.8207s
Epoch: 25 cost time: 3.316650152206421
Epoch: 25, Steps: 266 | Train Loss: 0.0706068 Vali Loss: 0.4099274 Test Loss: 0.3121475
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0733500
	speed: 0.0497s/iter; left time: 985.6435s
	iters: 200, epoch: 26 | loss: 0.0664407
	speed: 0.0103s/iter; left time: 202.7088s
Epoch: 26 cost time: 3.300379753112793
Epoch: 26, Steps: 266 | Train Loss: 0.0706110 Vali Loss: 0.4089515 Test Loss: 0.3123829
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0676623
	speed: 0.0474s/iter; left time: 927.7112s
	iters: 200, epoch: 27 | loss: 0.0762081
	speed: 0.0097s/iter; left time: 189.3069s
Epoch: 27 cost time: 3.055574655532837
Epoch: 27, Steps: 266 | Train Loss: 0.0706178 Vali Loss: 0.4088638 Test Loss: 0.3120458
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0723651
	speed: 0.0468s/iter; left time: 903.3596s
	iters: 200, epoch: 28 | loss: 0.0702493
	speed: 0.0102s/iter; left time: 195.3527s
Epoch: 28 cost time: 3.136322021484375
Epoch: 28, Steps: 266 | Train Loss: 0.0706126 Vali Loss: 0.4089263 Test Loss: 0.3120506
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0700521
	speed: 0.0475s/iter; left time: 904.2255s
	iters: 200, epoch: 29 | loss: 0.0737647
	speed: 0.0101s/iter; left time: 191.3574s
Epoch: 29 cost time: 3.139357328414917
Epoch: 29, Steps: 266 | Train Loss: 0.0706145 Vali Loss: 0.4090022 Test Loss: 0.3120584
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0697186
	speed: 0.0482s/iter; left time: 906.4614s
	iters: 200, epoch: 30 | loss: 0.0716574
	speed: 0.0105s/iter; left time: 196.6611s
Epoch: 30 cost time: 3.3142457008361816
Epoch: 30, Steps: 266 | Train Loss: 0.0705890 Vali Loss: 0.4089026 Test Loss: 0.3121254
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0757910
	speed: 0.0493s/iter; left time: 913.8462s
	iters: 200, epoch: 31 | loss: 0.0737785
	speed: 0.0100s/iter; left time: 184.5303s
Epoch: 31 cost time: 3.260941505432129
Epoch: 31, Steps: 266 | Train Loss: 0.0706060 Vali Loss: 0.4091592 Test Loss: 0.3122596
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0673686
	speed: 0.0501s/iter; left time: 915.3450s
	iters: 200, epoch: 32 | loss: 0.0736006
	speed: 0.0103s/iter; left time: 187.4457s
Epoch: 32 cost time: 3.264547109603882
Epoch: 32, Steps: 266 | Train Loss: 0.0705987 Vali Loss: 0.4095345 Test Loss: 0.3121510
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0764335
	speed: 0.0493s/iter; left time: 887.6392s
	iters: 200, epoch: 33 | loss: 0.0757624
	speed: 0.0097s/iter; left time: 173.6026s
Epoch: 33 cost time: 3.1717779636383057
Epoch: 33, Steps: 266 | Train Loss: 0.0705859 Vali Loss: 0.4093899 Test Loss: 0.3123240
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0674841
	speed: 0.0483s/iter; left time: 855.8113s
	iters: 200, epoch: 34 | loss: 0.0780702
	speed: 0.0100s/iter; left time: 175.6363s
Epoch: 34 cost time: 3.2423102855682373
Epoch: 34, Steps: 266 | Train Loss: 0.0706027 Vali Loss: 0.4089406 Test Loss: 0.3120587
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0813257
	speed: 0.0497s/iter; left time: 867.0455s
	iters: 200, epoch: 35 | loss: 0.0702908
	speed: 0.0102s/iter; left time: 177.0352s
Epoch: 35 cost time: 3.296457529067993
Epoch: 35, Steps: 266 | Train Loss: 0.0705863 Vali Loss: 0.4084072 Test Loss: 0.3120831
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0752182
	speed: 0.0486s/iter; left time: 835.9855s
	iters: 200, epoch: 36 | loss: 0.0707588
	speed: 0.0094s/iter; left time: 160.7389s
Epoch: 36 cost time: 3.122891426086426
Epoch: 36, Steps: 266 | Train Loss: 0.0706076 Vali Loss: 0.4085850 Test Loss: 0.3122833
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0717092
	speed: 0.0468s/iter; left time: 792.3593s
	iters: 200, epoch: 37 | loss: 0.0680625
	speed: 0.0095s/iter; left time: 160.0138s
Epoch: 37 cost time: 3.073622703552246
Epoch: 37, Steps: 266 | Train Loss: 0.0705897 Vali Loss: 0.4088452 Test Loss: 0.3122835
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0741274
	speed: 0.0480s/iter; left time: 799.4231s
	iters: 200, epoch: 38 | loss: 0.0726733
	speed: 0.0104s/iter; left time: 171.5582s
Epoch: 38 cost time: 3.272608757019043
Epoch: 38, Steps: 266 | Train Loss: 0.0705987 Vali Loss: 0.4090905 Test Loss: 0.3123235
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0719736
	speed: 0.0469s/iter; left time: 769.4935s
	iters: 200, epoch: 39 | loss: 0.0754045
	speed: 0.0100s/iter; left time: 163.0504s
Epoch: 39 cost time: 3.1419765949249268
Epoch: 39, Steps: 266 | Train Loss: 0.0705737 Vali Loss: 0.4089199 Test Loss: 0.3122437
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0664807
	speed: 0.0515s/iter; left time: 830.8743s
	iters: 200, epoch: 40 | loss: 0.0710793
	speed: 0.0101s/iter; left time: 162.0084s
Epoch: 40 cost time: 3.5920653343200684
Epoch: 40, Steps: 266 | Train Loss: 0.0705827 Vali Loss: 0.4092308 Test Loss: 0.3122422
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0676766
	speed: 0.0493s/iter; left time: 781.4811s
	iters: 200, epoch: 41 | loss: 0.0722185
	speed: 0.0100s/iter; left time: 157.2947s
Epoch: 41 cost time: 3.141749382019043
Epoch: 41, Steps: 266 | Train Loss: 0.0705634 Vali Loss: 0.4094178 Test Loss: 0.3125121
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0796790
	speed: 0.0466s/iter; left time: 726.6030s
	iters: 200, epoch: 42 | loss: 0.0739173
	speed: 0.0097s/iter; left time: 150.4443s
Epoch: 42 cost time: 2.9759745597839355
Epoch: 42, Steps: 266 | Train Loss: 0.0705829 Vali Loss: 0.4090767 Test Loss: 0.3122545
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0706717
	speed: 0.0474s/iter; left time: 726.5309s
	iters: 200, epoch: 43 | loss: 0.0688565
	speed: 0.0102s/iter; left time: 155.9413s
Epoch: 43 cost time: 3.158165693283081
Epoch: 43, Steps: 266 | Train Loss: 0.0705925 Vali Loss: 0.4087588 Test Loss: 0.3121276
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0757408
	speed: 0.0492s/iter; left time: 740.7837s
	iters: 200, epoch: 44 | loss: 0.0694700
	speed: 0.0097s/iter; left time: 144.5283s
Epoch: 44 cost time: 3.113250970840454
Epoch: 44, Steps: 266 | Train Loss: 0.0705850 Vali Loss: 0.4090776 Test Loss: 0.3123652
EarlyStopping counter: 20 out of 20
Early stopping
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=66, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4908288.0
params:  5561.0
Trainable parameters:  5561
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2696129
	speed: 0.0150s/iter; left time: 397.8498s
	iters: 200, epoch: 1 | loss: 0.2676593
	speed: 0.0100s/iter; left time: 265.1922s
Epoch: 1 cost time: 3.145874500274658
Epoch: 1, Steps: 266 | Train Loss: 0.2757297 Vali Loss: 0.3989542 Test Loss: 0.3044896
Validation loss decreased (inf --> 0.398954).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2628388
	speed: 0.0475s/iter; left time: 1246.7837s
	iters: 200, epoch: 2 | loss: 0.2547839
	speed: 0.0099s/iter; left time: 259.7734s
Epoch: 2 cost time: 3.1422576904296875
Epoch: 2, Steps: 266 | Train Loss: 0.2733376 Vali Loss: 0.3945161 Test Loss: 0.3021305
Validation loss decreased (0.398954 --> 0.394516).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2850178
	speed: 0.0487s/iter; left time: 1264.2042s
	iters: 200, epoch: 3 | loss: 0.2490746
	speed: 0.0102s/iter; left time: 264.5153s
Epoch: 3 cost time: 3.2244691848754883
Epoch: 3, Steps: 266 | Train Loss: 0.2724830 Vali Loss: 0.3950424 Test Loss: 0.3029076
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2437998
	speed: 0.0501s/iter; left time: 1287.1501s
	iters: 200, epoch: 4 | loss: 0.2642964
	speed: 0.0102s/iter; left time: 261.5396s
Epoch: 4 cost time: 3.1505610942840576
Epoch: 4, Steps: 266 | Train Loss: 0.2719103 Vali Loss: 0.3939165 Test Loss: 0.3021482
Validation loss decreased (0.394516 --> 0.393917).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2589113
	speed: 0.0459s/iter; left time: 1167.8334s
	iters: 200, epoch: 5 | loss: 0.2755829
	speed: 0.0096s/iter; left time: 244.4769s
Epoch: 5 cost time: 3.010652542114258
Epoch: 5, Steps: 266 | Train Loss: 0.2716326 Vali Loss: 0.3933512 Test Loss: 0.3017702
Validation loss decreased (0.393917 --> 0.393351).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2776893
	speed: 0.0486s/iter; left time: 1222.9718s
	iters: 200, epoch: 6 | loss: 0.2496938
	speed: 0.0110s/iter; left time: 274.6087s
Epoch: 6 cost time: 3.413888931274414
Epoch: 6, Steps: 266 | Train Loss: 0.2714541 Vali Loss: 0.3925869 Test Loss: 0.3023079
Validation loss decreased (0.393351 --> 0.392587).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3001953
	speed: 0.0503s/iter; left time: 1252.0784s
	iters: 200, epoch: 7 | loss: 0.2689645
	speed: 0.0097s/iter; left time: 241.3347s
Epoch: 7 cost time: 3.2187395095825195
Epoch: 7, Steps: 266 | Train Loss: 0.2713100 Vali Loss: 0.3919880 Test Loss: 0.3020275
Validation loss decreased (0.392587 --> 0.391988).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2609049
	speed: 0.0489s/iter; left time: 1204.7275s
	iters: 200, epoch: 8 | loss: 0.2465865
	speed: 0.0099s/iter; left time: 243.2532s
Epoch: 8 cost time: 3.1081204414367676
Epoch: 8, Steps: 266 | Train Loss: 0.2711361 Vali Loss: 0.3929850 Test Loss: 0.3021032
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3038015
	speed: 0.0522s/iter; left time: 1271.2363s
	iters: 200, epoch: 9 | loss: 0.3006313
	speed: 0.0097s/iter; left time: 234.7952s
Epoch: 9 cost time: 3.250187873840332
Epoch: 9, Steps: 266 | Train Loss: 0.2710083 Vali Loss: 0.3917664 Test Loss: 0.3018412
Validation loss decreased (0.391988 --> 0.391766).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2888819
	speed: 0.0509s/iter; left time: 1227.6951s
	iters: 200, epoch: 10 | loss: 0.2448143
	speed: 0.0093s/iter; left time: 222.4348s
Epoch: 10 cost time: 3.1643004417419434
Epoch: 10, Steps: 266 | Train Loss: 0.2708905 Vali Loss: 0.3929183 Test Loss: 0.3018895
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2829232
	speed: 0.0506s/iter; left time: 1205.8215s
	iters: 200, epoch: 11 | loss: 0.2520929
	speed: 0.0094s/iter; left time: 223.3447s
Epoch: 11 cost time: 3.097020387649536
Epoch: 11, Steps: 266 | Train Loss: 0.2708660 Vali Loss: 0.3925576 Test Loss: 0.3013784
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2587673
	speed: 0.0494s/iter; left time: 1165.7600s
	iters: 200, epoch: 12 | loss: 0.2522235
	speed: 0.0092s/iter; left time: 214.8410s
Epoch: 12 cost time: 3.0438289642333984
Epoch: 12, Steps: 266 | Train Loss: 0.2707159 Vali Loss: 0.3915924 Test Loss: 0.3018200
Validation loss decreased (0.391766 --> 0.391592).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3130784
	speed: 0.0465s/iter; left time: 1084.7131s
	iters: 200, epoch: 13 | loss: 0.2696579
	speed: 0.0087s/iter; left time: 201.3414s
Epoch: 13 cost time: 2.9045584201812744
Epoch: 13, Steps: 266 | Train Loss: 0.2706856 Vali Loss: 0.3915658 Test Loss: 0.3013957
Validation loss decreased (0.391592 --> 0.391566).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2831955
	speed: 0.0494s/iter; left time: 1137.7032s
	iters: 200, epoch: 14 | loss: 0.2560382
	speed: 0.0092s/iter; left time: 210.5720s
Epoch: 14 cost time: 3.048720598220825
Epoch: 14, Steps: 266 | Train Loss: 0.2706446 Vali Loss: 0.3906467 Test Loss: 0.3015007
Validation loss decreased (0.391566 --> 0.390647).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2683192
	speed: 0.0489s/iter; left time: 1113.4057s
	iters: 200, epoch: 15 | loss: 0.2366596
	speed: 0.0087s/iter; left time: 197.4146s
Epoch: 15 cost time: 2.876190662384033
Epoch: 15, Steps: 266 | Train Loss: 0.2706441 Vali Loss: 0.3924714 Test Loss: 0.3021706
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2842628
	speed: 0.0458s/iter; left time: 1030.4884s
	iters: 200, epoch: 16 | loss: 0.2790907
	speed: 0.0090s/iter; left time: 201.4048s
Epoch: 16 cost time: 2.906262159347534
Epoch: 16, Steps: 266 | Train Loss: 0.2706945 Vali Loss: 0.3919860 Test Loss: 0.3017252
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2884326
	speed: 0.0472s/iter; left time: 1049.5725s
	iters: 200, epoch: 17 | loss: 0.2725679
	speed: 0.0092s/iter; left time: 203.6119s
Epoch: 17 cost time: 3.1173434257507324
Epoch: 17, Steps: 266 | Train Loss: 0.2704913 Vali Loss: 0.3919256 Test Loss: 0.3018511
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2364947
	speed: 0.0464s/iter; left time: 1019.2097s
	iters: 200, epoch: 18 | loss: 0.2741531
	speed: 0.0098s/iter; left time: 214.6772s
Epoch: 18 cost time: 3.095747947692871
Epoch: 18, Steps: 266 | Train Loss: 0.2704943 Vali Loss: 0.3933615 Test Loss: 0.3015510
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2662068
	speed: 0.0483s/iter; left time: 1048.1195s
	iters: 200, epoch: 19 | loss: 0.2589555
	speed: 0.0094s/iter; left time: 203.9969s
Epoch: 19 cost time: 3.106952428817749
Epoch: 19, Steps: 266 | Train Loss: 0.2705743 Vali Loss: 0.3918949 Test Loss: 0.3016804
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2675209
	speed: 0.0506s/iter; left time: 1084.8409s
	iters: 200, epoch: 20 | loss: 0.2765037
	speed: 0.0098s/iter; left time: 209.0154s
Epoch: 20 cost time: 3.354198932647705
Epoch: 20, Steps: 266 | Train Loss: 0.2705141 Vali Loss: 0.3923067 Test Loss: 0.3016294
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2830492
	speed: 0.0516s/iter; left time: 1093.7201s
	iters: 200, epoch: 21 | loss: 0.2528956
	speed: 0.0096s/iter; left time: 202.9782s
Epoch: 21 cost time: 3.3081679344177246
Epoch: 21, Steps: 266 | Train Loss: 0.2703714 Vali Loss: 0.3918616 Test Loss: 0.3015626
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2750098
	speed: 0.0479s/iter; left time: 1001.6723s
	iters: 200, epoch: 22 | loss: 0.2519137
	speed: 0.0098s/iter; left time: 203.8467s
Epoch: 22 cost time: 3.1509225368499756
Epoch: 22, Steps: 266 | Train Loss: 0.2704380 Vali Loss: 0.3920856 Test Loss: 0.3014584
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2447468
	speed: 0.0468s/iter; left time: 967.1084s
	iters: 200, epoch: 23 | loss: 0.2539109
	speed: 0.0094s/iter; left time: 193.7272s
Epoch: 23 cost time: 2.94538950920105
Epoch: 23, Steps: 266 | Train Loss: 0.2704601 Vali Loss: 0.3915388 Test Loss: 0.3016909
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2643636
	speed: 0.0486s/iter; left time: 990.5114s
	iters: 200, epoch: 24 | loss: 0.2979887
	speed: 0.0094s/iter; left time: 189.9003s
Epoch: 24 cost time: 3.0952489376068115
Epoch: 24, Steps: 266 | Train Loss: 0.2704550 Vali Loss: 0.3922475 Test Loss: 0.3013290
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2717018
	speed: 0.0482s/iter; left time: 969.7970s
	iters: 200, epoch: 25 | loss: 0.2757437
	speed: 0.0092s/iter; left time: 183.6055s
Epoch: 25 cost time: 3.16568922996521
Epoch: 25, Steps: 266 | Train Loss: 0.2703307 Vali Loss: 0.3920832 Test Loss: 0.3017806
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2735983
	speed: 0.0478s/iter; left time: 949.2877s
	iters: 200, epoch: 26 | loss: 0.2583972
	speed: 0.0092s/iter; left time: 182.5400s
Epoch: 26 cost time: 3.1412293910980225
Epoch: 26, Steps: 266 | Train Loss: 0.2703432 Vali Loss: 0.3918240 Test Loss: 0.3014357
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2671232
	speed: 0.0485s/iter; left time: 949.0322s
	iters: 200, epoch: 27 | loss: 0.2632881
	speed: 0.0093s/iter; left time: 180.3698s
Epoch: 27 cost time: 3.154548406600952
Epoch: 27, Steps: 266 | Train Loss: 0.2703746 Vali Loss: 0.3920844 Test Loss: 0.3013594
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2738555
	speed: 0.0501s/iter; left time: 968.3504s
	iters: 200, epoch: 28 | loss: 0.2818392
	speed: 0.0094s/iter; left time: 180.7720s
Epoch: 28 cost time: 3.1927669048309326
Epoch: 28, Steps: 266 | Train Loss: 0.2702611 Vali Loss: 0.3915294 Test Loss: 0.3013350
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2669893
	speed: 0.0487s/iter; left time: 928.7036s
	iters: 200, epoch: 29 | loss: 0.2996006
	speed: 0.0093s/iter; left time: 176.9959s
Epoch: 29 cost time: 3.112626791000366
Epoch: 29, Steps: 266 | Train Loss: 0.2703795 Vali Loss: 0.3917355 Test Loss: 0.3015417
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2734985
	speed: 0.0482s/iter; left time: 905.9301s
	iters: 200, epoch: 30 | loss: 0.2891206
	speed: 0.0098s/iter; left time: 182.4913s
Epoch: 30 cost time: 3.0315113067626953
Epoch: 30, Steps: 266 | Train Loss: 0.2702592 Vali Loss: 0.3916429 Test Loss: 0.3016099
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2654342
	speed: 0.0473s/iter; left time: 875.6316s
	iters: 200, epoch: 31 | loss: 0.2653607
	speed: 0.0103s/iter; left time: 189.6421s
Epoch: 31 cost time: 3.315443515777588
Epoch: 31, Steps: 266 | Train Loss: 0.2703258 Vali Loss: 0.3920810 Test Loss: 0.3013192
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2821670
	speed: 0.0521s/iter; left time: 951.1193s
	iters: 200, epoch: 32 | loss: 0.2820168
	speed: 0.0099s/iter; left time: 179.1487s
Epoch: 32 cost time: 3.1830408573150635
Epoch: 32, Steps: 266 | Train Loss: 0.2702687 Vali Loss: 0.3913932 Test Loss: 0.3014913
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2679649
	speed: 0.0502s/iter; left time: 902.2456s
	iters: 200, epoch: 33 | loss: 0.2500471
	speed: 0.0102s/iter; left time: 182.8442s
Epoch: 33 cost time: 3.3125336170196533
Epoch: 33, Steps: 266 | Train Loss: 0.2703529 Vali Loss: 0.3919635 Test Loss: 0.3014662
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2553488
	speed: 0.0495s/iter; left time: 876.4557s
	iters: 200, epoch: 34 | loss: 0.2865517
	speed: 0.0097s/iter; left time: 171.5948s
Epoch: 34 cost time: 3.123972177505493
Epoch: 34, Steps: 266 | Train Loss: 0.2702815 Vali Loss: 0.3911514 Test Loss: 0.3013300
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_96_FITS_ETTm1_ftM_sl360_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3033503592014313, mae:0.3449934124946594, rse:0.5240879058837891, corr:[0.5465008  0.55647695 0.5569898  0.55637884 0.55773526 0.559344
 0.5594524  0.5585996  0.558228   0.5589376  0.56018656 0.5608375
 0.56093067 0.5608374  0.560517   0.5596197  0.5582791  0.55696565
 0.5557496  0.5546567  0.553561   0.55255    0.55141985 0.55021644
 0.5489124  0.5474765  0.5461941  0.545293   0.5447534  0.54439324
 0.54443425 0.5449676  0.54567564 0.54620045 0.5463291  0.5463004
 0.5461612  0.5459307  0.5457165  0.54555696 0.5453964  0.54510945
 0.5446783  0.5443431  0.54413414 0.54402006 0.5439639  0.54379666
 0.54355806 0.5434923  0.54350346 0.5434032  0.5432223  0.54305273
 0.5430679  0.54324025 0.54323715 0.54292977 0.5425863  0.54242116
 0.5426946  0.5430358  0.5431224  0.542773   0.5424423  0.5425218
 0.54292446 0.54325294 0.5433953  0.5432147  0.54292876 0.54274297
 0.5427923  0.54290736 0.54286546 0.5426375  0.5424107  0.5422529
 0.54205537 0.54176414 0.54154015 0.5415418  0.5416902  0.5416565
 0.5412799  0.54053307 0.5398337  0.5393892  0.53923064 0.53934187
 0.5395495  0.5396786  0.5397854  0.5401993  0.540874   0.54069364]
