Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=24, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_336_FITS_ETTm1_ftM_sl90_ll48_pl336_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34135
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=24, out_features=113, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2429952.0
params:  2825.0
Trainable parameters:  2825
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6516114
	speed: 0.0262s/iter; left time: 693.4625s
	iters: 200, epoch: 1 | loss: 0.5424524
	speed: 0.0288s/iter; left time: 761.1156s
Epoch: 1 cost time: 7.090841770172119
Epoch: 1, Steps: 266 | Train Loss: 0.6656646 Vali Loss: 0.9871092 Test Loss: 0.7313412
Validation loss decreased (inf --> 0.987109).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3930303
	speed: 0.1141s/iter; left time: 2993.8658s
	iters: 200, epoch: 2 | loss: 0.3925267
	speed: 0.0189s/iter; left time: 494.4786s
Epoch: 2 cost time: 6.223930835723877
Epoch: 2, Steps: 266 | Train Loss: 0.4226401 Vali Loss: 0.8273600 Test Loss: 0.5695208
Validation loss decreased (0.987109 --> 0.827360).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4085642
	speed: 0.1573s/iter; left time: 4085.5408s
	iters: 200, epoch: 3 | loss: 0.3762383
	speed: 0.0346s/iter; left time: 893.7907s
Epoch: 3 cost time: 11.501087188720703
Epoch: 3, Steps: 266 | Train Loss: 0.3734868 Vali Loss: 0.7723624 Test Loss: 0.5144371
Validation loss decreased (0.827360 --> 0.772362).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3833077
	speed: 0.1396s/iter; left time: 3587.9273s
	iters: 200, epoch: 4 | loss: 0.3701509
	speed: 0.0347s/iter; left time: 888.8140s
Epoch: 4 cost time: 7.654382228851318
Epoch: 4, Steps: 266 | Train Loss: 0.3570191 Vali Loss: 0.7426714 Test Loss: 0.4847255
Validation loss decreased (0.772362 --> 0.742671).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3837072
	speed: 0.1577s/iter; left time: 4011.0731s
	iters: 200, epoch: 5 | loss: 0.3669733
	speed: 0.0275s/iter; left time: 696.3165s
Epoch: 5 cost time: 9.33655595779419
Epoch: 5, Steps: 266 | Train Loss: 0.3491571 Vali Loss: 0.7258999 Test Loss: 0.4668421
Validation loss decreased (0.742671 --> 0.725900).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3562297
	speed: 0.1096s/iter; left time: 2758.2735s
	iters: 200, epoch: 6 | loss: 0.3608049
	speed: 0.0420s/iter; left time: 1052.7742s
Epoch: 6 cost time: 9.89408826828003
Epoch: 6, Steps: 266 | Train Loss: 0.3447092 Vali Loss: 0.7161081 Test Loss: 0.4559036
Validation loss decreased (0.725900 --> 0.716108).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3806831
	speed: 0.1162s/iter; left time: 2894.0824s
	iters: 200, epoch: 7 | loss: 0.3396393
	speed: 0.0224s/iter; left time: 554.5446s
Epoch: 7 cost time: 6.956888437271118
Epoch: 7, Steps: 266 | Train Loss: 0.3421661 Vali Loss: 0.7097034 Test Loss: 0.4485945
Validation loss decreased (0.716108 --> 0.709703).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3650911
	speed: 0.1268s/iter; left time: 3123.6500s
	iters: 200, epoch: 8 | loss: 0.3349998
	speed: 0.0286s/iter; left time: 702.3922s
Epoch: 8 cost time: 7.63744330406189
Epoch: 8, Steps: 266 | Train Loss: 0.3407441 Vali Loss: 0.7053069 Test Loss: 0.4439651
Validation loss decreased (0.709703 --> 0.705307).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3236890
	speed: 0.1162s/iter; left time: 2831.9929s
	iters: 200, epoch: 9 | loss: 0.3466200
	speed: 0.0425s/iter; left time: 1031.0683s
Epoch: 9 cost time: 9.369078636169434
Epoch: 9, Steps: 266 | Train Loss: 0.3400300 Vali Loss: 0.7032893 Test Loss: 0.4407729
Validation loss decreased (0.705307 --> 0.703289).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3469898
	speed: 0.1426s/iter; left time: 3438.2201s
	iters: 200, epoch: 10 | loss: 0.3258013
	speed: 0.0436s/iter; left time: 1047.6965s
Epoch: 10 cost time: 11.32968807220459
Epoch: 10, Steps: 266 | Train Loss: 0.3394452 Vali Loss: 0.7019926 Test Loss: 0.4385115
Validation loss decreased (0.703289 --> 0.701993).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3245016
	speed: 0.1330s/iter; left time: 3171.9209s
	iters: 200, epoch: 11 | loss: 0.3479813
	speed: 0.0241s/iter; left time: 572.3791s
Epoch: 11 cost time: 6.0973639488220215
Epoch: 11, Steps: 266 | Train Loss: 0.3391806 Vali Loss: 0.7008346 Test Loss: 0.4372254
Validation loss decreased (0.701993 --> 0.700835).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3221637
	speed: 0.1091s/iter; left time: 2573.1077s
	iters: 200, epoch: 12 | loss: 0.3044680
	speed: 0.0284s/iter; left time: 666.3553s
Epoch: 12 cost time: 7.699343919754028
Epoch: 12, Steps: 266 | Train Loss: 0.3387434 Vali Loss: 0.7004055 Test Loss: 0.4359921
Validation loss decreased (0.700835 --> 0.700406).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3416482
	speed: 0.1061s/iter; left time: 2472.3804s
	iters: 200, epoch: 13 | loss: 0.3518414
	speed: 0.0189s/iter; left time: 439.4187s
Epoch: 13 cost time: 6.4705657958984375
Epoch: 13, Steps: 266 | Train Loss: 0.3387896 Vali Loss: 0.6995702 Test Loss: 0.4354688
Validation loss decreased (0.700406 --> 0.699570).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3144304
	speed: 0.1752s/iter; left time: 4037.6860s
	iters: 200, epoch: 14 | loss: 0.3358319
	speed: 0.0225s/iter; left time: 517.3134s
Epoch: 14 cost time: 9.139488935470581
Epoch: 14, Steps: 266 | Train Loss: 0.3386971 Vali Loss: 0.6989650 Test Loss: 0.4350948
Validation loss decreased (0.699570 --> 0.698965).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3262329
	speed: 0.2024s/iter; left time: 4610.7553s
	iters: 200, epoch: 15 | loss: 0.3209043
	speed: 0.0426s/iter; left time: 966.2934s
Epoch: 15 cost time: 12.938588380813599
Epoch: 15, Steps: 266 | Train Loss: 0.3387763 Vali Loss: 0.6994858 Test Loss: 0.4344737
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3746616
	speed: 0.1771s/iter; left time: 3985.8818s
	iters: 200, epoch: 16 | loss: 0.2877568
	speed: 0.0408s/iter; left time: 914.4159s
Epoch: 16 cost time: 10.90304446220398
Epoch: 16, Steps: 266 | Train Loss: 0.3387202 Vali Loss: 0.6989233 Test Loss: 0.4344540
Validation loss decreased (0.698965 --> 0.698923).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3403866
	speed: 0.1093s/iter; left time: 2432.1236s
	iters: 200, epoch: 17 | loss: 0.3412266
	speed: 0.0191s/iter; left time: 422.5648s
Epoch: 17 cost time: 5.580812692642212
Epoch: 17, Steps: 266 | Train Loss: 0.3387220 Vali Loss: 0.6994741 Test Loss: 0.4342943
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3164003
	speed: 0.1004s/iter; left time: 2206.5855s
	iters: 200, epoch: 18 | loss: 0.3489027
	speed: 0.0164s/iter; left time: 358.6233s
Epoch: 18 cost time: 5.513868093490601
Epoch: 18, Steps: 266 | Train Loss: 0.3386281 Vali Loss: 0.6989226 Test Loss: 0.4343406
Validation loss decreased (0.698923 --> 0.698923).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3479719
	speed: 0.1036s/iter; left time: 2248.5913s
	iters: 200, epoch: 19 | loss: 0.3359620
	speed: 0.0282s/iter; left time: 609.5221s
Epoch: 19 cost time: 8.14471697807312
Epoch: 19, Steps: 266 | Train Loss: 0.3386741 Vali Loss: 0.6995026 Test Loss: 0.4345516
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3472447
	speed: 0.1822s/iter; left time: 3908.3347s
	iters: 200, epoch: 20 | loss: 0.3251989
	speed: 0.0331s/iter; left time: 706.9470s
Epoch: 20 cost time: 11.432592153549194
Epoch: 20, Steps: 266 | Train Loss: 0.3386043 Vali Loss: 0.6997381 Test Loss: 0.4342991
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3165018
	speed: 0.1513s/iter; left time: 3204.7541s
	iters: 200, epoch: 21 | loss: 0.3483689
	speed: 0.0431s/iter; left time: 907.6581s
Epoch: 21 cost time: 9.912477970123291
Epoch: 21, Steps: 266 | Train Loss: 0.3386300 Vali Loss: 0.6994469 Test Loss: 0.4343367
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3067120
	speed: 0.1237s/iter; left time: 2587.2775s
	iters: 200, epoch: 22 | loss: 0.3755576
	speed: 0.0196s/iter; left time: 408.3236s
Epoch: 22 cost time: 6.18821907043457
Epoch: 22, Steps: 266 | Train Loss: 0.3385742 Vali Loss: 0.6998001 Test Loss: 0.4342684
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3385135
	speed: 0.1092s/iter; left time: 2254.1604s
	iters: 200, epoch: 23 | loss: 0.3406415
	speed: 0.0204s/iter; left time: 419.3747s
Epoch: 23 cost time: 7.491070747375488
Epoch: 23, Steps: 266 | Train Loss: 0.3386790 Vali Loss: 0.6993698 Test Loss: 0.4343373
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3278068
	speed: 0.1333s/iter; left time: 2716.5496s
	iters: 200, epoch: 24 | loss: 0.3658796
	speed: 0.0255s/iter; left time: 517.6960s
Epoch: 24 cost time: 9.442394018173218
Epoch: 24, Steps: 266 | Train Loss: 0.3386079 Vali Loss: 0.6992831 Test Loss: 0.4344976
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3402705
	speed: 0.1456s/iter; left time: 2928.5955s
	iters: 200, epoch: 25 | loss: 0.3598563
	speed: 0.0270s/iter; left time: 540.4022s
Epoch: 25 cost time: 8.111619472503662
Epoch: 25, Steps: 266 | Train Loss: 0.3386658 Vali Loss: 0.6997809 Test Loss: 0.4344254
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3528487
	speed: 0.1991s/iter; left time: 3951.8816s
	iters: 200, epoch: 26 | loss: 0.3527912
	speed: 0.0293s/iter; left time: 579.2126s
Epoch: 26 cost time: 9.52199101448059
Epoch: 26, Steps: 266 | Train Loss: 0.3385465 Vali Loss: 0.7000023 Test Loss: 0.4344025
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3259543
	speed: 0.1310s/iter; left time: 2565.9016s
	iters: 200, epoch: 27 | loss: 0.3405429
	speed: 0.0238s/iter; left time: 462.9896s
Epoch: 27 cost time: 7.133865594863892
Epoch: 27, Steps: 266 | Train Loss: 0.3386518 Vali Loss: 0.6989161 Test Loss: 0.4344135
Validation loss decreased (0.698923 --> 0.698916).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3390423
	speed: 0.1113s/iter; left time: 2150.6203s
	iters: 200, epoch: 28 | loss: 0.3200125
	speed: 0.0202s/iter; left time: 387.9863s
Epoch: 28 cost time: 6.661054611206055
Epoch: 28, Steps: 266 | Train Loss: 0.3386253 Vali Loss: 0.6992610 Test Loss: 0.4342403
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3433494
	speed: 0.1264s/iter; left time: 2408.7305s
	iters: 200, epoch: 29 | loss: 0.3416728
	speed: 0.0253s/iter; left time: 480.4440s
Epoch: 29 cost time: 7.276090860366821
Epoch: 29, Steps: 266 | Train Loss: 0.3385974 Vali Loss: 0.6986313 Test Loss: 0.4342801
Validation loss decreased (0.698916 --> 0.698631).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3465671
	speed: 0.1211s/iter; left time: 2274.8031s
	iters: 200, epoch: 30 | loss: 0.3012243
	speed: 0.0545s/iter; left time: 1018.1150s
Epoch: 30 cost time: 12.829313516616821
Epoch: 30, Steps: 266 | Train Loss: 0.3386517 Vali Loss: 0.6993088 Test Loss: 0.4340051
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3198935
	speed: 0.1480s/iter; left time: 2740.4882s
	iters: 200, epoch: 31 | loss: 0.3210257
	speed: 0.0266s/iter; left time: 490.5820s
Epoch: 31 cost time: 7.088843107223511
Epoch: 31, Steps: 266 | Train Loss: 0.3386165 Vali Loss: 0.6991432 Test Loss: 0.4341993
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3200756
	speed: 0.1611s/iter; left time: 2940.6036s
	iters: 200, epoch: 32 | loss: 0.3275656
	speed: 0.0247s/iter; left time: 449.2833s
Epoch: 32 cost time: 6.546811103820801
Epoch: 32, Steps: 266 | Train Loss: 0.3386217 Vali Loss: 0.6996845 Test Loss: 0.4343977
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3348758
	speed: 0.1073s/iter; left time: 1931.0738s
	iters: 200, epoch: 33 | loss: 0.3094157
	speed: 0.0231s/iter; left time: 413.7750s
Epoch: 33 cost time: 6.652528762817383
Epoch: 33, Steps: 266 | Train Loss: 0.3385206 Vali Loss: 0.6994880 Test Loss: 0.4344182
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3088203
	speed: 0.0957s/iter; left time: 1696.7406s
	iters: 200, epoch: 34 | loss: 0.3748426
	speed: 0.0299s/iter; left time: 526.9429s
Epoch: 34 cost time: 6.700025320053101
Epoch: 34, Steps: 266 | Train Loss: 0.3385327 Vali Loss: 0.6991100 Test Loss: 0.4343774
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3102255
	speed: 0.1198s/iter; left time: 2092.0147s
	iters: 200, epoch: 35 | loss: 0.3497062
	speed: 0.0193s/iter; left time: 335.3773s
Epoch: 35 cost time: 8.773235559463501
Epoch: 35, Steps: 266 | Train Loss: 0.3384951 Vali Loss: 0.6992503 Test Loss: 0.4343793
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3355147
	speed: 0.1521s/iter; left time: 2614.8353s
	iters: 200, epoch: 36 | loss: 0.3487928
	speed: 0.0224s/iter; left time: 382.7109s
Epoch: 36 cost time: 7.485962390899658
Epoch: 36, Steps: 266 | Train Loss: 0.3385479 Vali Loss: 0.6990311 Test Loss: 0.4343428
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3296310
	speed: 0.1296s/iter; left time: 2192.9792s
	iters: 200, epoch: 37 | loss: 0.3293263
	speed: 0.0418s/iter; left time: 703.8596s
Epoch: 37 cost time: 11.579163074493408
Epoch: 37, Steps: 266 | Train Loss: 0.3385097 Vali Loss: 0.6997492 Test Loss: 0.4344605
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3292571
	speed: 0.1628s/iter; left time: 2712.6540s
	iters: 200, epoch: 38 | loss: 0.3205341
	speed: 0.0189s/iter; left time: 313.5657s
Epoch: 38 cost time: 6.344705581665039
Epoch: 38, Steps: 266 | Train Loss: 0.3386818 Vali Loss: 0.6994640 Test Loss: 0.4344414
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3581631
	speed: 0.0967s/iter; left time: 1584.5510s
	iters: 200, epoch: 39 | loss: 0.3409007
	speed: 0.0179s/iter; left time: 291.9603s
Epoch: 39 cost time: 5.733362197875977
Epoch: 39, Steps: 266 | Train Loss: 0.3386167 Vali Loss: 0.6998982 Test Loss: 0.4344293
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3418520
	speed: 0.1098s/iter; left time: 1771.2119s
	iters: 200, epoch: 40 | loss: 0.3528082
	speed: 0.0270s/iter; left time: 433.3564s
Epoch: 40 cost time: 7.646210432052612
Epoch: 40, Steps: 266 | Train Loss: 0.3385432 Vali Loss: 0.6991628 Test Loss: 0.4344579
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3338120
	speed: 0.1459s/iter; left time: 2313.6042s
	iters: 200, epoch: 41 | loss: 0.3253278
	speed: 0.0278s/iter; left time: 438.6641s
Epoch: 41 cost time: 8.098354578018188
Epoch: 41, Steps: 266 | Train Loss: 0.3385872 Vali Loss: 0.6998863 Test Loss: 0.4344096
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3140388
	speed: 0.1505s/iter; left time: 2346.9814s
	iters: 200, epoch: 42 | loss: 0.2914550
	speed: 0.0256s/iter; left time: 396.7834s
Epoch: 42 cost time: 8.833131551742554
Epoch: 42, Steps: 266 | Train Loss: 0.3385232 Vali Loss: 0.6995043 Test Loss: 0.4344432
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3223006
	speed: 0.1244s/iter; left time: 1907.0506s
	iters: 200, epoch: 43 | loss: 0.3712965
	speed: 0.0173s/iter; left time: 263.7769s
Epoch: 43 cost time: 6.9065258502960205
Epoch: 43, Steps: 266 | Train Loss: 0.3384472 Vali Loss: 0.6998053 Test Loss: 0.4344221
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3330432
	speed: 0.1287s/iter; left time: 1938.3225s
	iters: 200, epoch: 44 | loss: 0.3030989
	speed: 0.0218s/iter; left time: 326.2369s
Epoch: 44 cost time: 6.1357550621032715
Epoch: 44, Steps: 266 | Train Loss: 0.3386084 Vali Loss: 0.6992847 Test Loss: 0.4344701
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.3396257
	speed: 0.1206s/iter; left time: 1784.9123s
	iters: 200, epoch: 45 | loss: 0.3181589
	speed: 0.0410s/iter; left time: 603.1635s
Epoch: 45 cost time: 9.735620260238647
Epoch: 45, Steps: 266 | Train Loss: 0.3385674 Vali Loss: 0.6991649 Test Loss: 0.4344806
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3615676
	speed: 0.1062s/iter; left time: 1543.6116s
	iters: 200, epoch: 46 | loss: 0.3673974
	speed: 0.0211s/iter; left time: 304.2167s
Epoch: 46 cost time: 6.509934425354004
Epoch: 46, Steps: 266 | Train Loss: 0.3385775 Vali Loss: 0.6992757 Test Loss: 0.4344904
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3040686
	speed: 0.1557s/iter; left time: 2221.5877s
	iters: 200, epoch: 47 | loss: 0.3442693
	speed: 0.0514s/iter; left time: 728.4933s
Epoch: 47 cost time: 15.343339443206787
Epoch: 47, Steps: 266 | Train Loss: 0.3385313 Vali Loss: 0.6996472 Test Loss: 0.4344480
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3224143
	speed: 0.2099s/iter; left time: 2937.7565s
	iters: 200, epoch: 48 | loss: 0.3135823
	speed: 0.0383s/iter; left time: 531.7730s
Epoch: 48 cost time: 13.857639789581299
Epoch: 48, Steps: 266 | Train Loss: 0.3384866 Vali Loss: 0.6989868 Test Loss: 0.4344547
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.3419486
	speed: 0.1341s/iter; left time: 1841.0182s
	iters: 200, epoch: 49 | loss: 0.3276418
	speed: 0.0233s/iter; left time: 318.1106s
Epoch: 49 cost time: 7.786311626434326
Epoch: 49, Steps: 266 | Train Loss: 0.3384216 Vali Loss: 0.6992642 Test Loss: 0.4344387
EarlyStopping counter: 20 out of 20
Early stopping
train 34135
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=24, out_features=113, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2429952.0
params:  2825.0
Trainable parameters:  2825
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4519411
	speed: 0.0267s/iter; left time: 706.6755s
	iters: 200, epoch: 1 | loss: 0.4430028
	speed: 0.0270s/iter; left time: 711.8486s
Epoch: 1 cost time: 7.128523111343384
Epoch: 1, Steps: 266 | Train Loss: 0.4239781 Vali Loss: 0.6946315 Test Loss: 0.4311761
Validation loss decreased (inf --> 0.694632).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4093061
	speed: 0.1147s/iter; left time: 3009.3994s
	iters: 200, epoch: 2 | loss: 0.3863338
	speed: 0.0208s/iter; left time: 544.3590s
Epoch: 2 cost time: 6.852032661437988
Epoch: 2, Steps: 266 | Train Loss: 0.4235559 Vali Loss: 0.6943778 Test Loss: 0.4309268
Validation loss decreased (0.694632 --> 0.694378).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4075945
	speed: 0.1531s/iter; left time: 3975.8528s
	iters: 200, epoch: 3 | loss: 0.4008850
	speed: 0.0322s/iter; left time: 832.6837s
Epoch: 3 cost time: 9.635173082351685
Epoch: 3, Steps: 266 | Train Loss: 0.4234363 Vali Loss: 0.6952222 Test Loss: 0.4313109
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4604348
	speed: 0.1799s/iter; left time: 4623.7201s
	iters: 200, epoch: 4 | loss: 0.4697098
	speed: 0.0339s/iter; left time: 867.8827s
Epoch: 4 cost time: 9.266660928726196
Epoch: 4, Steps: 266 | Train Loss: 0.4234958 Vali Loss: 0.6944075 Test Loss: 0.4306881
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4270271
	speed: 0.1290s/iter; left time: 3281.5339s
	iters: 200, epoch: 5 | loss: 0.4090308
	speed: 0.0241s/iter; left time: 611.3290s
Epoch: 5 cost time: 8.322213172912598
Epoch: 5, Steps: 266 | Train Loss: 0.4231381 Vali Loss: 0.6942497 Test Loss: 0.4305572
Validation loss decreased (0.694378 --> 0.694250).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3966321
	speed: 0.0969s/iter; left time: 2438.8275s
	iters: 200, epoch: 6 | loss: 0.4273127
	speed: 0.0158s/iter; left time: 396.8498s
Epoch: 6 cost time: 6.633289337158203
Epoch: 6, Steps: 266 | Train Loss: 0.4232025 Vali Loss: 0.6950847 Test Loss: 0.4307766
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4513142
	speed: 0.1307s/iter; left time: 3256.0625s
	iters: 200, epoch: 7 | loss: 0.4361747
	speed: 0.0261s/iter; left time: 647.8540s
Epoch: 7 cost time: 8.270309448242188
Epoch: 7, Steps: 266 | Train Loss: 0.4233209 Vali Loss: 0.6952106 Test Loss: 0.4314049
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4565521
	speed: 0.1590s/iter; left time: 3918.3421s
	iters: 200, epoch: 8 | loss: 0.4497792
	speed: 0.0436s/iter; left time: 1070.9681s
Epoch: 8 cost time: 10.669826030731201
Epoch: 8, Steps: 266 | Train Loss: 0.4232166 Vali Loss: 0.6939144 Test Loss: 0.4309756
Validation loss decreased (0.694250 --> 0.693914).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4000967
	speed: 0.1356s/iter; left time: 3304.1593s
	iters: 200, epoch: 9 | loss: 0.4725192
	speed: 0.0300s/iter; left time: 728.0238s
Epoch: 9 cost time: 10.162000894546509
Epoch: 9, Steps: 266 | Train Loss: 0.4231716 Vali Loss: 0.6949025 Test Loss: 0.4311840
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3851853
	speed: 0.1458s/iter; left time: 3515.8869s
	iters: 200, epoch: 10 | loss: 0.4001056
	speed: 0.0344s/iter; left time: 826.5609s
Epoch: 10 cost time: 8.307576179504395
Epoch: 10, Steps: 266 | Train Loss: 0.4231197 Vali Loss: 0.6948179 Test Loss: 0.4314410
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.4244136
	speed: 0.1479s/iter; left time: 3526.5205s
	iters: 200, epoch: 11 | loss: 0.4413239
	speed: 0.0258s/iter; left time: 612.9616s
Epoch: 11 cost time: 7.520933389663696
Epoch: 11, Steps: 266 | Train Loss: 0.4231487 Vali Loss: 0.6943395 Test Loss: 0.4307653
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.4371278
	speed: 0.1216s/iter; left time: 2867.0671s
	iters: 200, epoch: 12 | loss: 0.4497661
	speed: 0.0263s/iter; left time: 617.9340s
Epoch: 12 cost time: 7.325541019439697
Epoch: 12, Steps: 266 | Train Loss: 0.4230362 Vali Loss: 0.6945410 Test Loss: 0.4312685
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4473255
	speed: 0.1555s/iter; left time: 3625.2096s
	iters: 200, epoch: 13 | loss: 0.4117847
	speed: 0.0228s/iter; left time: 530.0495s
Epoch: 13 cost time: 7.705944061279297
Epoch: 13, Steps: 266 | Train Loss: 0.4230914 Vali Loss: 0.6946294 Test Loss: 0.4309860
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.4227279
	speed: 0.1063s/iter; left time: 2449.5101s
	iters: 200, epoch: 14 | loss: 0.3992321
	speed: 0.0321s/iter; left time: 737.3799s
Epoch: 14 cost time: 8.581745624542236
Epoch: 14, Steps: 266 | Train Loss: 0.4231039 Vali Loss: 0.6947424 Test Loss: 0.4309784
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.4259275
	speed: 0.1414s/iter; left time: 3221.6100s
	iters: 200, epoch: 15 | loss: 0.3942695
	speed: 0.0220s/iter; left time: 499.6654s
Epoch: 15 cost time: 6.663402318954468
Epoch: 15, Steps: 266 | Train Loss: 0.4231546 Vali Loss: 0.6952932 Test Loss: 0.4314675
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4031699
	speed: 0.1056s/iter; left time: 2376.3097s
	iters: 200, epoch: 16 | loss: 0.4004288
	speed: 0.0234s/iter; left time: 523.7097s
Epoch: 16 cost time: 7.48803448677063
Epoch: 16, Steps: 266 | Train Loss: 0.4231396 Vali Loss: 0.6944244 Test Loss: 0.4308079
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4406329
	speed: 0.1076s/iter; left time: 2393.9176s
	iters: 200, epoch: 17 | loss: 0.4219010
	speed: 0.0251s/iter; left time: 556.1972s
Epoch: 17 cost time: 6.7242701053619385
Epoch: 17, Steps: 266 | Train Loss: 0.4231325 Vali Loss: 0.6941568 Test Loss: 0.4309725
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3943894
	speed: 0.1187s/iter; left time: 2609.1538s
	iters: 200, epoch: 18 | loss: 0.4440283
	speed: 0.0222s/iter; left time: 484.7298s
Epoch: 18 cost time: 7.202844858169556
Epoch: 18, Steps: 266 | Train Loss: 0.4231720 Vali Loss: 0.6943642 Test Loss: 0.4309883
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4308264
	speed: 0.1083s/iter; left time: 2351.6631s
	iters: 200, epoch: 19 | loss: 0.4198300
	speed: 0.0229s/iter; left time: 495.3375s
Epoch: 19 cost time: 7.43215012550354
Epoch: 19, Steps: 266 | Train Loss: 0.4231687 Vali Loss: 0.6948242 Test Loss: 0.4311889
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.4272576
	speed: 0.1260s/iter; left time: 2702.5990s
	iters: 200, epoch: 20 | loss: 0.4811623
	speed: 0.0499s/iter; left time: 1064.5915s
Epoch: 20 cost time: 11.393213748931885
Epoch: 20, Steps: 266 | Train Loss: 0.4230496 Vali Loss: 0.6944622 Test Loss: 0.4310960
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4131512
	speed: 0.1455s/iter; left time: 3081.8908s
	iters: 200, epoch: 21 | loss: 0.3901160
	speed: 0.0345s/iter; left time: 727.9482s
Epoch: 21 cost time: 9.858871936798096
Epoch: 21, Steps: 266 | Train Loss: 0.4229239 Vali Loss: 0.6944049 Test Loss: 0.4306958
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4182180
	speed: 0.1393s/iter; left time: 2913.5703s
	iters: 200, epoch: 22 | loss: 0.4577688
	speed: 0.0203s/iter; left time: 422.1819s
Epoch: 22 cost time: 8.411933183670044
Epoch: 22, Steps: 266 | Train Loss: 0.4230379 Vali Loss: 0.6945668 Test Loss: 0.4311123
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.4309180
	speed: 0.1630s/iter; left time: 3366.5254s
	iters: 200, epoch: 23 | loss: 0.3889388
	speed: 0.0212s/iter; left time: 436.5999s
Epoch: 23 cost time: 6.880108594894409
Epoch: 23, Steps: 266 | Train Loss: 0.4230195 Vali Loss: 0.6948513 Test Loss: 0.4310616
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.4463509
	speed: 0.1137s/iter; left time: 2316.8428s
	iters: 200, epoch: 24 | loss: 0.4055586
	speed: 0.0334s/iter; left time: 676.8719s
Epoch: 24 cost time: 8.246032953262329
Epoch: 24, Steps: 266 | Train Loss: 0.4232015 Vali Loss: 0.6949886 Test Loss: 0.4308997
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4271774
	speed: 0.1071s/iter; left time: 2154.7379s
	iters: 200, epoch: 25 | loss: 0.4313918
	speed: 0.0203s/iter; left time: 406.8835s
Epoch: 25 cost time: 6.764815807342529
Epoch: 25, Steps: 266 | Train Loss: 0.4231319 Vali Loss: 0.6950260 Test Loss: 0.4312459
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.4298066
	speed: 0.1228s/iter; left time: 2437.2180s
	iters: 200, epoch: 26 | loss: 0.3984064
	speed: 0.0261s/iter; left time: 516.0092s
Epoch: 26 cost time: 7.297592639923096
Epoch: 26, Steps: 266 | Train Loss: 0.4230270 Vali Loss: 0.6941063 Test Loss: 0.4311034
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3891177
	speed: 0.1310s/iter; left time: 2565.2307s
	iters: 200, epoch: 27 | loss: 0.4654164
	speed: 0.0290s/iter; left time: 565.5010s
Epoch: 27 cost time: 8.529036283493042
Epoch: 27, Steps: 266 | Train Loss: 0.4229274 Vali Loss: 0.6946662 Test Loss: 0.4313548
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.4346265
	speed: 0.1249s/iter; left time: 2412.7286s
	iters: 200, epoch: 28 | loss: 0.4156283
	speed: 0.0196s/iter; left time: 377.2172s
Epoch: 28 cost time: 7.217954635620117
Epoch: 28, Steps: 266 | Train Loss: 0.4230242 Vali Loss: 0.6941098 Test Loss: 0.4309368
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_336_FITS_ETTm1_ftM_sl90_ll48_pl336_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4310639798641205, mae:0.41879621148109436, rse:0.6247685551643372, corr:[0.5456039  0.54529995 0.54046506 0.53979164 0.53772664 0.534405
 0.53279763 0.531536   0.5293232  0.52755207 0.5269293  0.5263827
 0.52530366 0.5234598  0.5206138  0.51727974 0.5142937  0.51138616
 0.5081994  0.5052671  0.5027359  0.49985027 0.49632403 0.4928766
 0.48988852 0.48641765 0.48271322 0.4800556  0.47875068 0.47719726
 0.47522798 0.4746886  0.47526917 0.4759015  0.47621495 0.47678715
 0.47696415 0.47656733 0.476097   0.47609988 0.47637156 0.47589213
 0.47522685 0.47525987 0.47542182 0.475123   0.47478282 0.47493693
 0.4753384  0.4755316  0.47567466 0.47592288 0.47641993 0.47681242
 0.47730136 0.4777515  0.4781376  0.47830248 0.47816196 0.4781055
 0.47794947 0.47733438 0.47699344 0.47682285 0.47667876 0.47634828
 0.47611323 0.47629008 0.47677314 0.47715044 0.4771213  0.47721538
 0.4778042  0.47859526 0.47956902 0.48032618 0.48106697 0.48193237
 0.4828     0.48351705 0.48403257 0.48443487 0.48513523 0.48561797
 0.4857133  0.48578167 0.48636383 0.487354   0.4882901  0.48904762
 0.48978266 0.49050653 0.49111292 0.49144724 0.49139315 0.49101874
 0.4905369  0.49009815 0.48924246 0.48770168 0.4864298  0.48631355
 0.4867036  0.48644206 0.48575246 0.48523125 0.484788   0.48407355
 0.48319986 0.48235783 0.48144975 0.48044398 0.47957823 0.47885185
 0.4778933  0.476783   0.47570315 0.47478667 0.4737628  0.47236925
 0.47094202 0.46978232 0.46900415 0.4684099  0.46750602 0.466497
 0.4658616  0.4655405  0.46540976 0.46541998 0.46536037 0.46513695
 0.46490252 0.46501923 0.46498632 0.4645716  0.46421275 0.4642776
 0.46437335 0.46418986 0.46406153 0.46422237 0.46417284 0.46391052
 0.4639629  0.46450052 0.46484125 0.46466845 0.46495226 0.46559837
 0.4658573  0.46590033 0.4662398  0.4668455  0.46676064 0.46594483
 0.46530637 0.4654725  0.46577087 0.4656237  0.4655883  0.4659269
 0.46612093 0.4658187  0.46569347 0.46630454 0.46732908 0.4680973
 0.46862566 0.46933734 0.47022092 0.47111076 0.47181368 0.47249836
 0.47300375 0.4733192  0.473648   0.47407126 0.47436655 0.47466037
 0.47501782 0.47547728 0.4760696  0.477029   0.4781324  0.478841
 0.47935423 0.48021623 0.48108542 0.48117304 0.48075682 0.48089594
 0.48177427 0.48252857 0.4828567  0.48361042 0.4851285  0.48651484
 0.48687106 0.4865539  0.48661295 0.48684657 0.48639545 0.48516783
 0.48385158 0.482826   0.4816619  0.4802737  0.47878954 0.4773068
 0.475857   0.47478545 0.47401375 0.47276273 0.47073767 0.46857786
 0.4663961  0.46430427 0.46262583 0.46182305 0.46138722 0.46084222
 0.4603299  0.46045712 0.46075755 0.46067515 0.46062905 0.46069404
 0.46082845 0.46067327 0.4600309  0.45936543 0.45928955 0.45938078
 0.45934698 0.45932537 0.4592761  0.4593093  0.4595132  0.45957786
 0.4596108  0.45931953 0.45917362 0.4596401  0.46003756 0.4601282
 0.46019495 0.46064067 0.4610133  0.46109954 0.4609509  0.46119845
 0.46134913 0.46111783 0.46065822 0.46089014 0.46121982 0.46114093
 0.46119472 0.46179163 0.462213   0.46239042 0.4627935  0.4635374
 0.4643694  0.46472293 0.46505648 0.46600533 0.46733448 0.46824646
 0.46899405 0.46978965 0.470528   0.47088847 0.4711724  0.4716691
 0.47227335 0.47278953 0.4732035  0.4738184  0.47457397 0.4753477
 0.47611693 0.4767824  0.47711954 0.4770608  0.47666368 0.47582212
 0.4740582  0.4716052  0.4694995  0.4681602  0.4672372  0.46665832
 0.4663161  0.46604198 0.4659443  0.46596274 0.4657428  0.46493673
 0.4636803  0.4624542  0.4613839  0.46022037 0.45903963 0.4581422
 0.45764956 0.45687675 0.4557999  0.454954   0.45446128 0.4536102
 0.4520907  0.45068052 0.4500241  0.4496073  0.44863647 0.4477359
 0.44719076 0.44655338 0.4458896  0.44571984 0.44553748 0.44475502
 0.44409811 0.44445577 0.4444339  0.44335032 0.44297394 0.44379362
 0.44394433 0.44352993 0.44505867 0.44632998 0.44562382 0.44937292]
