Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=26, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=26, out_features=39, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  908544.0
params:  1053.0
Trainable parameters:  1053
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3721213
	speed: 0.0166s/iter; left time: 442.6224s
	iters: 200, epoch: 1 | loss: 0.3484976
	speed: 0.0108s/iter; left time: 286.0635s
Epoch: 1 cost time: 3.4579179286956787
Epoch: 1, Steps: 267 | Train Loss: 0.3842285 Vali Loss: 0.4698181 Test Loss: 0.3580522
Validation loss decreased (inf --> 0.469818).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3358177
	speed: 0.0587s/iter; left time: 1544.5865s
	iters: 200, epoch: 2 | loss: 0.2923869
	speed: 0.0099s/iter; left time: 258.5585s
Epoch: 2 cost time: 3.216310977935791
Epoch: 2, Steps: 267 | Train Loss: 0.3070626 Vali Loss: 0.4251509 Test Loss: 0.3223121
Validation loss decreased (0.469818 --> 0.425151).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3159531
	speed: 0.0696s/iter; left time: 1813.9916s
	iters: 200, epoch: 3 | loss: 0.3138637
	speed: 0.0101s/iter; left time: 261.7273s
Epoch: 3 cost time: 4.3931639194488525
Epoch: 3, Steps: 267 | Train Loss: 0.2970806 Vali Loss: 0.4125238 Test Loss: 0.3141927
Validation loss decreased (0.425151 --> 0.412524).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2809620
	speed: 0.0583s/iter; left time: 1503.9213s
	iters: 200, epoch: 4 | loss: 0.2851903
	speed: 0.0101s/iter; left time: 259.7990s
Epoch: 4 cost time: 3.260956287384033
Epoch: 4, Steps: 267 | Train Loss: 0.2945537 Vali Loss: 0.4095065 Test Loss: 0.3127072
Validation loss decreased (0.412524 --> 0.409506).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3132337
	speed: 0.0566s/iter; left time: 1445.7933s
	iters: 200, epoch: 5 | loss: 0.2950841
	speed: 0.0099s/iter; left time: 251.9435s
Epoch: 5 cost time: 3.1855196952819824
Epoch: 5, Steps: 267 | Train Loss: 0.2933313 Vali Loss: 0.4077899 Test Loss: 0.3109357
Validation loss decreased (0.409506 --> 0.407790).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2967862
	speed: 0.0590s/iter; left time: 1491.3646s
	iters: 200, epoch: 6 | loss: 0.2845560
	speed: 0.0100s/iter; left time: 252.1138s
Epoch: 6 cost time: 3.3813257217407227
Epoch: 6, Steps: 267 | Train Loss: 0.2925523 Vali Loss: 0.4047628 Test Loss: 0.3110230
Validation loss decreased (0.407790 --> 0.404763).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3316833
	speed: 0.0573s/iter; left time: 1432.5921s
	iters: 200, epoch: 7 | loss: 0.2839411
	speed: 0.0101s/iter; left time: 252.7029s
Epoch: 7 cost time: 3.5157968997955322
Epoch: 7, Steps: 267 | Train Loss: 0.2921005 Vali Loss: 0.4044760 Test Loss: 0.3108582
Validation loss decreased (0.404763 --> 0.404476).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2828422
	speed: 0.0630s/iter; left time: 1558.0524s
	iters: 200, epoch: 8 | loss: 0.2744041
	speed: 0.0099s/iter; left time: 244.9081s
Epoch: 8 cost time: 3.3297879695892334
Epoch: 8, Steps: 267 | Train Loss: 0.2917384 Vali Loss: 0.4040451 Test Loss: 0.3109104
Validation loss decreased (0.404476 --> 0.404045).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3391565
	speed: 0.0573s/iter; left time: 1401.0521s
	iters: 200, epoch: 9 | loss: 0.2958113
	speed: 0.0099s/iter; left time: 242.0129s
Epoch: 9 cost time: 3.2786474227905273
Epoch: 9, Steps: 267 | Train Loss: 0.2915953 Vali Loss: 0.4047436 Test Loss: 0.3106878
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3333607
	speed: 0.0598s/iter; left time: 1447.7107s
	iters: 200, epoch: 10 | loss: 0.2762423
	speed: 0.0099s/iter; left time: 238.0351s
Epoch: 10 cost time: 3.1840734481811523
Epoch: 10, Steps: 267 | Train Loss: 0.2914871 Vali Loss: 0.4041190 Test Loss: 0.3100920
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2768035
	speed: 0.0600s/iter; left time: 1435.4560s
	iters: 200, epoch: 11 | loss: 0.3334678
	speed: 0.0112s/iter; left time: 266.9324s
Epoch: 11 cost time: 3.407315731048584
Epoch: 11, Steps: 267 | Train Loss: 0.2913631 Vali Loss: 0.4044869 Test Loss: 0.3105092
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2390468
	speed: 0.0575s/iter; left time: 1359.8391s
	iters: 200, epoch: 12 | loss: 0.3510859
	speed: 0.0100s/iter; left time: 234.5637s
Epoch: 12 cost time: 3.220832586288452
Epoch: 12, Steps: 267 | Train Loss: 0.2912884 Vali Loss: 0.4037939 Test Loss: 0.3102476
Validation loss decreased (0.404045 --> 0.403794).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2990371
	speed: 0.0588s/iter; left time: 1376.7917s
	iters: 200, epoch: 13 | loss: 0.2801985
	speed: 0.0100s/iter; left time: 232.8018s
Epoch: 13 cost time: 3.2911341190338135
Epoch: 13, Steps: 267 | Train Loss: 0.2912440 Vali Loss: 0.4038165 Test Loss: 0.3095634
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3312092
	speed: 0.0567s/iter; left time: 1312.5962s
	iters: 200, epoch: 14 | loss: 0.3079675
	speed: 0.0100s/iter; left time: 229.9528s
Epoch: 14 cost time: 3.075800657272339
Epoch: 14, Steps: 267 | Train Loss: 0.2911320 Vali Loss: 0.4045435 Test Loss: 0.3103150
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3090616
	speed: 0.0591s/iter; left time: 1351.4027s
	iters: 200, epoch: 15 | loss: 0.2959646
	speed: 0.0099s/iter; left time: 225.8078s
Epoch: 15 cost time: 3.197506904602051
Epoch: 15, Steps: 267 | Train Loss: 0.2910966 Vali Loss: 0.4037373 Test Loss: 0.3100536
Validation loss decreased (0.403794 --> 0.403737).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2974851
	speed: 0.0582s/iter; left time: 1315.7190s
	iters: 200, epoch: 16 | loss: 0.2886700
	speed: 0.0098s/iter; left time: 220.8324s
Epoch: 16 cost time: 3.227269411087036
Epoch: 16, Steps: 267 | Train Loss: 0.2911233 Vali Loss: 0.4032048 Test Loss: 0.3098345
Validation loss decreased (0.403737 --> 0.403205).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3189818
	speed: 0.0577s/iter; left time: 1288.4866s
	iters: 200, epoch: 17 | loss: 0.2797047
	speed: 0.0098s/iter; left time: 218.2332s
Epoch: 17 cost time: 3.2038192749023438
Epoch: 17, Steps: 267 | Train Loss: 0.2910551 Vali Loss: 0.4030737 Test Loss: 0.3100333
Validation loss decreased (0.403205 --> 0.403074).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2659650
	speed: 0.0573s/iter; left time: 1265.0536s
	iters: 200, epoch: 18 | loss: 0.2908435
	speed: 0.0100s/iter; left time: 218.9368s
Epoch: 18 cost time: 3.1130192279815674
Epoch: 18, Steps: 267 | Train Loss: 0.2909049 Vali Loss: 0.4024803 Test Loss: 0.3096172
Validation loss decreased (0.403074 --> 0.402480).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3353862
	speed: 0.0572s/iter; left time: 1245.6309s
	iters: 200, epoch: 19 | loss: 0.3039358
	speed: 0.0103s/iter; left time: 222.8092s
Epoch: 19 cost time: 3.266012668609619
Epoch: 19, Steps: 267 | Train Loss: 0.2909891 Vali Loss: 0.4031190 Test Loss: 0.3098545
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2909137
	speed: 0.0575s/iter; left time: 1238.7818s
	iters: 200, epoch: 20 | loss: 0.3186271
	speed: 0.0099s/iter; left time: 212.8493s
Epoch: 20 cost time: 3.2889559268951416
Epoch: 20, Steps: 267 | Train Loss: 0.2909829 Vali Loss: 0.4034127 Test Loss: 0.3102710
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3035184
	speed: 0.0586s/iter; left time: 1246.7942s
	iters: 200, epoch: 21 | loss: 0.2757525
	speed: 0.0100s/iter; left time: 210.8354s
Epoch: 21 cost time: 3.2757086753845215
Epoch: 21, Steps: 267 | Train Loss: 0.2909015 Vali Loss: 0.4031843 Test Loss: 0.3100531
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3007939
	speed: 0.0593s/iter; left time: 1245.0750s
	iters: 200, epoch: 22 | loss: 0.2628634
	speed: 0.0102s/iter; left time: 212.4287s
Epoch: 22 cost time: 3.3226253986358643
Epoch: 22, Steps: 267 | Train Loss: 0.2909366 Vali Loss: 0.4032264 Test Loss: 0.3101028
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2666640
	speed: 0.0596s/iter; left time: 1235.0462s
	iters: 200, epoch: 23 | loss: 0.2968649
	speed: 0.0101s/iter; left time: 208.4228s
Epoch: 23 cost time: 3.289299964904785
Epoch: 23, Steps: 267 | Train Loss: 0.2908062 Vali Loss: 0.4032694 Test Loss: 0.3099929
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3002034
	speed: 0.0577s/iter; left time: 1181.1303s
	iters: 200, epoch: 24 | loss: 0.2688735
	speed: 0.0098s/iter; left time: 200.1398s
Epoch: 24 cost time: 3.151240825653076
Epoch: 24, Steps: 267 | Train Loss: 0.2907934 Vali Loss: 0.4032967 Test Loss: 0.3102406
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2957293
	speed: 0.0584s/iter; left time: 1178.5874s
	iters: 200, epoch: 25 | loss: 0.3191077
	speed: 0.0099s/iter; left time: 198.7375s
Epoch: 25 cost time: 3.1857080459594727
Epoch: 25, Steps: 267 | Train Loss: 0.2907995 Vali Loss: 0.4026442 Test Loss: 0.3101271
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2993062
	speed: 0.0592s/iter; left time: 1179.4148s
	iters: 200, epoch: 26 | loss: 0.2641502
	speed: 0.0102s/iter; left time: 202.7761s
Epoch: 26 cost time: 3.3155486583709717
Epoch: 26, Steps: 267 | Train Loss: 0.2907821 Vali Loss: 0.4027868 Test Loss: 0.3101087
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3248646
	speed: 0.0568s/iter; left time: 1116.4317s
	iters: 200, epoch: 27 | loss: 0.2802472
	speed: 0.0100s/iter; left time: 195.4930s
Epoch: 27 cost time: 3.2129621505737305
Epoch: 27, Steps: 267 | Train Loss: 0.2907270 Vali Loss: 0.4030950 Test Loss: 0.3099616
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2745895
	speed: 0.0594s/iter; left time: 1152.5820s
	iters: 200, epoch: 28 | loss: 0.2746267
	speed: 0.0099s/iter; left time: 190.8721s
Epoch: 28 cost time: 3.2052128314971924
Epoch: 28, Steps: 267 | Train Loss: 0.2907979 Vali Loss: 0.4027704 Test Loss: 0.3099058
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2693156
	speed: 0.0608s/iter; left time: 1163.1974s
	iters: 200, epoch: 29 | loss: 0.2978315
	speed: 0.0100s/iter; left time: 189.3640s
Epoch: 29 cost time: 3.328495502471924
Epoch: 29, Steps: 267 | Train Loss: 0.2906258 Vali Loss: 0.4029987 Test Loss: 0.3098595
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2740318
	speed: 0.0639s/iter; left time: 1204.5900s
	iters: 200, epoch: 30 | loss: 0.2911853
	speed: 0.0102s/iter; left time: 190.7244s
Epoch: 30 cost time: 3.5939841270446777
Epoch: 30, Steps: 267 | Train Loss: 0.2905927 Vali Loss: 0.4029692 Test Loss: 0.3099630
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2853884
	speed: 0.0585s/iter; left time: 1087.3652s
	iters: 200, epoch: 31 | loss: 0.2821664
	speed: 0.0100s/iter; left time: 184.4830s
Epoch: 31 cost time: 3.2447891235351562
Epoch: 31, Steps: 267 | Train Loss: 0.2907500 Vali Loss: 0.4032665 Test Loss: 0.3098114
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2563311
	speed: 0.0570s/iter; left time: 1044.2167s
	iters: 200, epoch: 32 | loss: 0.3237504
	speed: 0.0100s/iter; left time: 182.9995s
Epoch: 32 cost time: 3.112819194793701
Epoch: 32, Steps: 267 | Train Loss: 0.2907314 Vali Loss: 0.4024634 Test Loss: 0.3097148
Validation loss decreased (0.402480 --> 0.402463).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3124135
	speed: 0.0672s/iter; left time: 1213.5501s
	iters: 200, epoch: 33 | loss: 0.3020782
	speed: 0.0100s/iter; left time: 179.5596s
Epoch: 33 cost time: 3.205620050430298
Epoch: 33, Steps: 267 | Train Loss: 0.2905907 Vali Loss: 0.4031464 Test Loss: 0.3100170
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2820916
	speed: 0.0621s/iter; left time: 1104.1646s
	iters: 200, epoch: 34 | loss: 0.2935630
	speed: 0.0101s/iter; left time: 179.3502s
Epoch: 34 cost time: 3.4542970657348633
Epoch: 34, Steps: 267 | Train Loss: 0.2905836 Vali Loss: 0.4034927 Test Loss: 0.3099371
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2714931
	speed: 0.0578s/iter; left time: 1013.6995s
	iters: 200, epoch: 35 | loss: 0.2960505
	speed: 0.0099s/iter; left time: 172.2535s
Epoch: 35 cost time: 3.1863038539886475
Epoch: 35, Steps: 267 | Train Loss: 0.2907178 Vali Loss: 0.4030367 Test Loss: 0.3099388
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2610469
	speed: 0.0593s/iter; left time: 1023.2118s
	iters: 200, epoch: 36 | loss: 0.2938185
	speed: 0.0099s/iter; left time: 170.5731s
Epoch: 36 cost time: 3.2631008625030518
Epoch: 36, Steps: 267 | Train Loss: 0.2905793 Vali Loss: 0.4030370 Test Loss: 0.3098598
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2717783
	speed: 0.0591s/iter; left time: 1004.3586s
	iters: 200, epoch: 37 | loss: 0.2626673
	speed: 0.0101s/iter; left time: 170.9406s
Epoch: 37 cost time: 3.279996395111084
Epoch: 37, Steps: 267 | Train Loss: 0.2906316 Vali Loss: 0.4031254 Test Loss: 0.3097920
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2715534
	speed: 0.0578s/iter; left time: 966.0752s
	iters: 200, epoch: 38 | loss: 0.3208129
	speed: 0.0099s/iter; left time: 164.0728s
Epoch: 38 cost time: 3.183966636657715
Epoch: 38, Steps: 267 | Train Loss: 0.2906020 Vali Loss: 0.4028609 Test Loss: 0.3097790
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3122680
	speed: 0.0567s/iter; left time: 933.3839s
	iters: 200, epoch: 39 | loss: 0.3237772
	speed: 0.0098s/iter; left time: 159.6294s
Epoch: 39 cost time: 3.174389362335205
Epoch: 39, Steps: 267 | Train Loss: 0.2905625 Vali Loss: 0.4030760 Test Loss: 0.3099025
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2944365
	speed: 0.0554s/iter; left time: 896.7766s
	iters: 200, epoch: 40 | loss: 0.2871952
	speed: 0.0099s/iter; left time: 159.8537s
Epoch: 40 cost time: 3.1120667457580566
Epoch: 40, Steps: 267 | Train Loss: 0.2905813 Vali Loss: 0.4029728 Test Loss: 0.3099093
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2776328
	speed: 0.0569s/iter; left time: 906.1502s
	iters: 200, epoch: 41 | loss: 0.2881965
	speed: 0.0101s/iter; left time: 159.5433s
Epoch: 41 cost time: 3.2063915729522705
Epoch: 41, Steps: 267 | Train Loss: 0.2905903 Vali Loss: 0.4028613 Test Loss: 0.3098356
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2603677
	speed: 0.0578s/iter; left time: 904.0521s
	iters: 200, epoch: 42 | loss: 0.2540972
	speed: 0.0101s/iter; left time: 157.4456s
Epoch: 42 cost time: 3.2641677856445312
Epoch: 42, Steps: 267 | Train Loss: 0.2907024 Vali Loss: 0.4027229 Test Loss: 0.3099220
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2805355
	speed: 0.0584s/iter; left time: 897.9666s
	iters: 200, epoch: 43 | loss: 0.2948261
	speed: 0.0100s/iter; left time: 152.7073s
Epoch: 43 cost time: 3.3087081909179688
Epoch: 43, Steps: 267 | Train Loss: 0.2905272 Vali Loss: 0.4027448 Test Loss: 0.3098973
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2875796
	speed: 0.0583s/iter; left time: 881.2099s
	iters: 200, epoch: 44 | loss: 0.2819117
	speed: 0.0102s/iter; left time: 152.8619s
Epoch: 44 cost time: 3.1973607540130615
Epoch: 44, Steps: 267 | Train Loss: 0.2903550 Vali Loss: 0.4029904 Test Loss: 0.3098552
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2905905
	speed: 0.0602s/iter; left time: 893.4502s
	iters: 200, epoch: 45 | loss: 0.2955400
	speed: 0.0100s/iter; left time: 148.0894s
Epoch: 45 cost time: 3.214167594909668
Epoch: 45, Steps: 267 | Train Loss: 0.2904676 Vali Loss: 0.4029052 Test Loss: 0.3099169
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2694899
	speed: 0.0595s/iter; left time: 868.1158s
	iters: 200, epoch: 46 | loss: 0.2778319
	speed: 0.0099s/iter; left time: 144.0341s
Epoch: 46 cost time: 3.2420575618743896
Epoch: 46, Steps: 267 | Train Loss: 0.2906161 Vali Loss: 0.4024447 Test Loss: 0.3098823
Validation loss decreased (0.402463 --> 0.402445).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2587478
	speed: 0.0582s/iter; left time: 833.2406s
	iters: 200, epoch: 47 | loss: 0.2773632
	speed: 0.0100s/iter; left time: 141.9610s
Epoch: 47 cost time: 3.2184600830078125
Epoch: 47, Steps: 267 | Train Loss: 0.2905191 Vali Loss: 0.4030033 Test Loss: 0.3098147
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3018496
	speed: 0.0584s/iter; left time: 819.9728s
	iters: 200, epoch: 48 | loss: 0.3325409
	speed: 0.0101s/iter; left time: 140.2750s
Epoch: 48 cost time: 3.321878671646118
Epoch: 48, Steps: 267 | Train Loss: 0.2905658 Vali Loss: 0.4027509 Test Loss: 0.3098421
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2986588
	speed: 0.0591s/iter; left time: 814.3972s
	iters: 200, epoch: 49 | loss: 0.2978719
	speed: 0.0102s/iter; left time: 140.0241s
Epoch: 49 cost time: 3.2942025661468506
Epoch: 49, Steps: 267 | Train Loss: 0.2904912 Vali Loss: 0.4028741 Test Loss: 0.3098338
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2951917
	speed: 0.0566s/iter; left time: 764.8679s
	iters: 200, epoch: 50 | loss: 0.2585940
	speed: 0.0099s/iter; left time: 133.3334s
Epoch: 50 cost time: 3.233980417251587
Epoch: 50, Steps: 267 | Train Loss: 0.2906025 Vali Loss: 0.4030252 Test Loss: 0.3098686
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2685924
	speed: 0.0578s/iter; left time: 765.4710s
	iters: 200, epoch: 51 | loss: 0.2953182
	speed: 0.0100s/iter; left time: 132.0383s
Epoch: 51 cost time: 3.1892788410186768
Epoch: 51, Steps: 267 | Train Loss: 0.2906093 Vali Loss: 0.4026288 Test Loss: 0.3098094
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.3136473
	speed: 0.0577s/iter; left time: 748.7225s
	iters: 200, epoch: 52 | loss: 0.2793746
	speed: 0.0100s/iter; left time: 128.4872s
Epoch: 52 cost time: 3.174792528152466
Epoch: 52, Steps: 267 | Train Loss: 0.2905093 Vali Loss: 0.4027361 Test Loss: 0.3098510
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.3042748
	speed: 0.0579s/iter; left time: 736.7839s
	iters: 200, epoch: 53 | loss: 0.3068729
	speed: 0.0101s/iter; left time: 127.7608s
Epoch: 53 cost time: 3.210639238357544
Epoch: 53, Steps: 267 | Train Loss: 0.2904942 Vali Loss: 0.4027785 Test Loss: 0.3098640
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2804648
	speed: 0.0578s/iter; left time: 719.1529s
	iters: 200, epoch: 54 | loss: 0.2985271
	speed: 0.0099s/iter; left time: 122.7477s
Epoch: 54 cost time: 3.201172351837158
Epoch: 54, Steps: 267 | Train Loss: 0.2905183 Vali Loss: 0.4028440 Test Loss: 0.3098485
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2941219
	speed: 0.0581s/iter; left time: 708.0250s
	iters: 200, epoch: 55 | loss: 0.2792590
	speed: 0.0099s/iter; left time: 119.2856s
Epoch: 55 cost time: 3.1698124408721924
Epoch: 55, Steps: 267 | Train Loss: 0.2904940 Vali Loss: 0.4029100 Test Loss: 0.3098606
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2727234
	speed: 0.0576s/iter; left time: 686.6789s
	iters: 200, epoch: 56 | loss: 0.2873857
	speed: 0.0100s/iter; left time: 118.2848s
Epoch: 56 cost time: 3.2506234645843506
Epoch: 56, Steps: 267 | Train Loss: 0.2905594 Vali Loss: 0.4027424 Test Loss: 0.3098507
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3028966
	speed: 0.0577s/iter; left time: 672.5592s
	iters: 200, epoch: 57 | loss: 0.3097147
	speed: 0.0100s/iter; left time: 115.5677s
Epoch: 57 cost time: 3.176201105117798
Epoch: 57, Steps: 267 | Train Loss: 0.2905576 Vali Loss: 0.4028977 Test Loss: 0.3098335
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2778101
	speed: 0.0597s/iter; left time: 679.9279s
	iters: 200, epoch: 58 | loss: 0.2811791
	speed: 0.0098s/iter; left time: 110.4424s
Epoch: 58 cost time: 3.1840901374816895
Epoch: 58, Steps: 267 | Train Loss: 0.2905052 Vali Loss: 0.4028880 Test Loss: 0.3098575
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2923700
	speed: 0.0581s/iter; left time: 645.5328s
	iters: 200, epoch: 59 | loss: 0.2789996
	speed: 0.0100s/iter; left time: 109.9210s
Epoch: 59 cost time: 3.1948938369750977
Epoch: 59, Steps: 267 | Train Loss: 0.2905377 Vali Loss: 0.4029289 Test Loss: 0.3098678
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.3166374
	speed: 0.0602s/iter; left time: 652.8604s
	iters: 200, epoch: 60 | loss: 0.2724165
	speed: 0.0101s/iter; left time: 108.1824s
Epoch: 60 cost time: 3.271886110305786
Epoch: 60, Steps: 267 | Train Loss: 0.2905149 Vali Loss: 0.4027285 Test Loss: 0.3098521
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2641657
	speed: 0.0563s/iter; left time: 595.3899s
	iters: 200, epoch: 61 | loss: 0.2980320
	speed: 0.0101s/iter; left time: 106.3419s
Epoch: 61 cost time: 3.1364495754241943
Epoch: 61, Steps: 267 | Train Loss: 0.2904915 Vali Loss: 0.4029451 Test Loss: 0.3098169
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3033394
	speed: 0.0574s/iter; left time: 592.0850s
	iters: 200, epoch: 62 | loss: 0.2701786
	speed: 0.0100s/iter; left time: 102.3378s
Epoch: 62 cost time: 3.247854709625244
Epoch: 62, Steps: 267 | Train Loss: 0.2903286 Vali Loss: 0.4029359 Test Loss: 0.3098345
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.3114445
	speed: 0.0582s/iter; left time: 584.5639s
	iters: 200, epoch: 63 | loss: 0.2901910
	speed: 0.0100s/iter; left time: 99.8327s
Epoch: 63 cost time: 3.175931930541992
Epoch: 63, Steps: 267 | Train Loss: 0.2904043 Vali Loss: 0.4028159 Test Loss: 0.3098467
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.3273495
	speed: 0.0571s/iter; left time: 558.0475s
	iters: 200, epoch: 64 | loss: 0.3161293
	speed: 0.0099s/iter; left time: 95.9503s
Epoch: 64 cost time: 3.106158494949341
Epoch: 64, Steps: 267 | Train Loss: 0.2904366 Vali Loss: 0.4028112 Test Loss: 0.3098318
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2865025
	speed: 0.0582s/iter; left time: 553.6753s
	iters: 200, epoch: 65 | loss: 0.3189237
	speed: 0.0101s/iter; left time: 94.9371s
Epoch: 65 cost time: 3.193892478942871
Epoch: 65, Steps: 267 | Train Loss: 0.2903655 Vali Loss: 0.4027562 Test Loss: 0.3098371
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.3200145
	speed: 0.0590s/iter; left time: 545.6843s
	iters: 200, epoch: 66 | loss: 0.2826383
	speed: 0.0100s/iter; left time: 91.1600s
Epoch: 66 cost time: 3.2010092735290527
Epoch: 66, Steps: 267 | Train Loss: 0.2904727 Vali Loss: 0.4025954 Test Loss: 0.3098033
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31219154596328735, mae:0.34855857491493225, rse:0.5316703915596008, corr:[0.5522704  0.55654347 0.55538195 0.55269337 0.5512931  0.5515026
 0.5521357  0.55252075 0.5522941  0.5521466  0.5526282  0.5530258
 0.5527879  0.5514419  0.5494919  0.54759    0.5458443  0.5441656
 0.54239774 0.54046726 0.538427   0.5362907  0.5341223  0.53199315
 0.52983177 0.5276472  0.52565247 0.5239448  0.5227242  0.5221399
 0.5223551  0.52303296 0.52362055 0.52381295 0.523516   0.5229879
 0.5224488  0.52208227 0.52203554 0.52209115 0.5221524  0.52204895
 0.5218329  0.5217175  0.52177507 0.522018   0.52238023 0.5226969
 0.52284575 0.52277476 0.52264553 0.5226234  0.52278614 0.5230432
 0.5232801  0.52336556 0.5233428  0.5231671  0.5229703  0.5228046
 0.52276254 0.5227982  0.5227715  0.5225949  0.5223084  0.5221317
 0.52214783 0.5223522  0.52275205 0.5231754  0.52347267 0.5235413
 0.52340424 0.52318484 0.52310634 0.5231379  0.5232237  0.523209
 0.52299446 0.52260524 0.522228   0.5219946  0.5219516  0.52194005
 0.5218221  0.5215425  0.5211414  0.5207081  0.52047205 0.52067935
 0.5211767  0.5215293  0.5214101  0.5211323  0.52170753 0.5239001 ]
