Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_192_FITS_ETTm1_ftM_sl90_ll48_pl192_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=18, out_features=56, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  903168.0
params:  1064.0
Trainable parameters:  1064
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5536014
	speed: 0.0167s/iter; left time: 444.7206s
	iters: 200, epoch: 1 | loss: 0.4424357
	speed: 0.0113s/iter; left time: 299.9844s
Epoch: 1 cost time: 3.5784859657287598
Epoch: 1, Steps: 267 | Train Loss: 0.5441197 Vali Loss: 0.8676647 Test Loss: 0.7254873
Validation loss decreased (inf --> 0.867665).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3855964
	speed: 0.0620s/iter; left time: 1632.9737s
	iters: 200, epoch: 2 | loss: 0.3710935
	speed: 0.0101s/iter; left time: 265.7911s
Epoch: 2 cost time: 3.238081932067871
Epoch: 2, Steps: 267 | Train Loss: 0.3676069 Vali Loss: 0.7295616 Test Loss: 0.5888343
Validation loss decreased (0.867665 --> 0.729562).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3134115
	speed: 0.0581s/iter; left time: 1515.7168s
	iters: 200, epoch: 3 | loss: 0.3156350
	speed: 0.0101s/iter; left time: 262.1122s
Epoch: 3 cost time: 3.2266695499420166
Epoch: 3, Steps: 267 | Train Loss: 0.3184471 Vali Loss: 0.6703500 Test Loss: 0.5285735
Validation loss decreased (0.729562 --> 0.670350).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3076736
	speed: 0.0582s/iter; left time: 1502.7589s
	iters: 200, epoch: 4 | loss: 0.3298667
	speed: 0.0101s/iter; left time: 260.7080s
Epoch: 4 cost time: 3.2188589572906494
Epoch: 4, Steps: 267 | Train Loss: 0.2964570 Vali Loss: 0.6334807 Test Loss: 0.4912666
Validation loss decreased (0.670350 --> 0.633481).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2982249
	speed: 0.0601s/iter; left time: 1534.3131s
	iters: 200, epoch: 5 | loss: 0.2784531
	speed: 0.0109s/iter; left time: 276.7037s
Epoch: 5 cost time: 3.3547394275665283
Epoch: 5, Steps: 267 | Train Loss: 0.2833909 Vali Loss: 0.6069122 Test Loss: 0.4641559
Validation loss decreased (0.633481 --> 0.606912).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2971719
	speed: 0.0590s/iter; left time: 1491.6527s
	iters: 200, epoch: 6 | loss: 0.2907486
	speed: 0.0100s/iter; left time: 251.7636s
Epoch: 6 cost time: 3.243043899536133
Epoch: 6, Steps: 267 | Train Loss: 0.2749266 Vali Loss: 0.5886975 Test Loss: 0.4454384
Validation loss decreased (0.606912 --> 0.588697).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2894759
	speed: 0.0599s/iter; left time: 1498.5760s
	iters: 200, epoch: 7 | loss: 0.2504228
	speed: 0.0100s/iter; left time: 248.5802s
Epoch: 7 cost time: 3.336310863494873
Epoch: 7, Steps: 267 | Train Loss: 0.2696471 Vali Loss: 0.5750765 Test Loss: 0.4320998
Validation loss decreased (0.588697 --> 0.575076).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2620453
	speed: 0.0592s/iter; left time: 1463.8473s
	iters: 200, epoch: 8 | loss: 0.2677946
	speed: 0.0100s/iter; left time: 245.8938s
Epoch: 8 cost time: 3.23600172996521
Epoch: 8, Steps: 267 | Train Loss: 0.2660886 Vali Loss: 0.5664354 Test Loss: 0.4227799
Validation loss decreased (0.575076 --> 0.566435).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2499105
	speed: 0.0572s/iter; left time: 1399.7785s
	iters: 200, epoch: 9 | loss: 0.2705210
	speed: 0.0099s/iter; left time: 241.8926s
Epoch: 9 cost time: 3.0938947200775146
Epoch: 9, Steps: 267 | Train Loss: 0.2640437 Vali Loss: 0.5601189 Test Loss: 0.4159582
Validation loss decreased (0.566435 --> 0.560119).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2668958
	speed: 0.0582s/iter; left time: 1407.9008s
	iters: 200, epoch: 10 | loss: 0.2784153
	speed: 0.0099s/iter; left time: 239.4041s
Epoch: 10 cost time: 3.2964141368865967
Epoch: 10, Steps: 267 | Train Loss: 0.2626553 Vali Loss: 0.5553898 Test Loss: 0.4114526
Validation loss decreased (0.560119 --> 0.555390).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2898080
	speed: 0.0582s/iter; left time: 1392.2628s
	iters: 200, epoch: 11 | loss: 0.2654318
	speed: 0.0101s/iter; left time: 240.1114s
Epoch: 11 cost time: 3.269235372543335
Epoch: 11, Steps: 267 | Train Loss: 0.2617964 Vali Loss: 0.5515068 Test Loss: 0.4081550
Validation loss decreased (0.555390 --> 0.551507).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2497777
	speed: 0.0606s/iter; left time: 1433.7242s
	iters: 200, epoch: 12 | loss: 0.2424546
	speed: 0.0100s/iter; left time: 234.7905s
Epoch: 12 cost time: 3.559333086013794
Epoch: 12, Steps: 267 | Train Loss: 0.2612004 Vali Loss: 0.5508816 Test Loss: 0.4055959
Validation loss decreased (0.551507 --> 0.550882).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2465366
	speed: 0.0677s/iter; left time: 1584.0289s
	iters: 200, epoch: 13 | loss: 0.2911263
	speed: 0.0102s/iter; left time: 238.6980s
Epoch: 13 cost time: 3.321017265319824
Epoch: 13, Steps: 267 | Train Loss: 0.2608573 Vali Loss: 0.5492352 Test Loss: 0.4039710
Validation loss decreased (0.550882 --> 0.549235).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2555503
	speed: 0.0623s/iter; left time: 1441.8753s
	iters: 200, epoch: 14 | loss: 0.2552028
	speed: 0.0099s/iter; left time: 228.2370s
Epoch: 14 cost time: 3.378096580505371
Epoch: 14, Steps: 267 | Train Loss: 0.2606967 Vali Loss: 0.5481442 Test Loss: 0.4024228
Validation loss decreased (0.549235 --> 0.548144).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2666003
	speed: 0.0604s/iter; left time: 1381.1438s
	iters: 200, epoch: 15 | loss: 0.2695001
	speed: 0.0104s/iter; left time: 237.7060s
Epoch: 15 cost time: 3.3180630207061768
Epoch: 15, Steps: 267 | Train Loss: 0.2605950 Vali Loss: 0.5469425 Test Loss: 0.4016779
Validation loss decreased (0.548144 --> 0.546943).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2799111
	speed: 0.0606s/iter; left time: 1369.0330s
	iters: 200, epoch: 16 | loss: 0.2644576
	speed: 0.0102s/iter; left time: 228.5689s
Epoch: 16 cost time: 3.393202543258667
Epoch: 16, Steps: 267 | Train Loss: 0.2603588 Vali Loss: 0.5472994 Test Loss: 0.4012648
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2751553
	speed: 0.0598s/iter; left time: 1335.9485s
	iters: 200, epoch: 17 | loss: 0.2654386
	speed: 0.0104s/iter; left time: 232.1478s
Epoch: 17 cost time: 3.4082367420196533
Epoch: 17, Steps: 267 | Train Loss: 0.2603265 Vali Loss: 0.5471820 Test Loss: 0.4008110
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2522196
	speed: 0.0574s/iter; left time: 1265.6927s
	iters: 200, epoch: 18 | loss: 0.2621047
	speed: 0.0114s/iter; left time: 250.0417s
Epoch: 18 cost time: 3.4497885704040527
Epoch: 18, Steps: 267 | Train Loss: 0.2604352 Vali Loss: 0.5467529 Test Loss: 0.4005028
Validation loss decreased (0.546943 --> 0.546753).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2723636
	speed: 0.0605s/iter; left time: 1319.2626s
	iters: 200, epoch: 19 | loss: 0.2701326
	speed: 0.0108s/iter; left time: 233.8038s
Epoch: 19 cost time: 3.3930349349975586
Epoch: 19, Steps: 267 | Train Loss: 0.2603577 Vali Loss: 0.5473965 Test Loss: 0.4003948
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2662954
	speed: 0.0622s/iter; left time: 1339.0422s
	iters: 200, epoch: 20 | loss: 0.2284861
	speed: 0.0106s/iter; left time: 228.1710s
Epoch: 20 cost time: 3.521477699279785
Epoch: 20, Steps: 267 | Train Loss: 0.2602736 Vali Loss: 0.5475142 Test Loss: 0.4003072
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2465380
	speed: 0.0593s/iter; left time: 1261.5498s
	iters: 200, epoch: 21 | loss: 0.2502342
	speed: 0.0103s/iter; left time: 217.6509s
Epoch: 21 cost time: 3.2739479541778564
Epoch: 21, Steps: 267 | Train Loss: 0.2604052 Vali Loss: 0.5467190 Test Loss: 0.4000685
Validation loss decreased (0.546753 --> 0.546719).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2688850
	speed: 0.0614s/iter; left time: 1290.0648s
	iters: 200, epoch: 22 | loss: 0.2623660
	speed: 0.0102s/iter; left time: 212.3583s
Epoch: 22 cost time: 3.488154649734497
Epoch: 22, Steps: 267 | Train Loss: 0.2603545 Vali Loss: 0.5464975 Test Loss: 0.4001743
Validation loss decreased (0.546719 --> 0.546498).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2716665
	speed: 0.0624s/iter; left time: 1293.9764s
	iters: 200, epoch: 23 | loss: 0.2635057
	speed: 0.0103s/iter; left time: 212.3939s
Epoch: 23 cost time: 3.3375518321990967
Epoch: 23, Steps: 267 | Train Loss: 0.2603291 Vali Loss: 0.5466943 Test Loss: 0.4001922
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2564966
	speed: 0.0579s/iter; left time: 1183.7421s
	iters: 200, epoch: 24 | loss: 0.2491347
	speed: 0.0099s/iter; left time: 201.4865s
Epoch: 24 cost time: 3.191541910171509
Epoch: 24, Steps: 267 | Train Loss: 0.2602928 Vali Loss: 0.5457277 Test Loss: 0.3999735
Validation loss decreased (0.546498 --> 0.545728).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2714232
	speed: 0.0578s/iter; left time: 1166.1816s
	iters: 200, epoch: 25 | loss: 0.2789225
	speed: 0.0239s/iter; left time: 479.8125s
Epoch: 25 cost time: 4.803030014038086
Epoch: 25, Steps: 267 | Train Loss: 0.2602612 Vali Loss: 0.5457940 Test Loss: 0.4001629
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2437678
	speed: 0.0616s/iter; left time: 1227.4612s
	iters: 200, epoch: 26 | loss: 0.2713379
	speed: 0.0100s/iter; left time: 197.9895s
Epoch: 26 cost time: 3.2535946369171143
Epoch: 26, Steps: 267 | Train Loss: 0.2601840 Vali Loss: 0.5469458 Test Loss: 0.4001125
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2324390
	speed: 0.0607s/iter; left time: 1192.7627s
	iters: 200, epoch: 27 | loss: 0.2758351
	speed: 0.0106s/iter; left time: 207.5878s
Epoch: 27 cost time: 3.4013664722442627
Epoch: 27, Steps: 267 | Train Loss: 0.2602923 Vali Loss: 0.5466465 Test Loss: 0.4001794
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2824799
	speed: 0.0589s/iter; left time: 1142.3108s
	iters: 200, epoch: 28 | loss: 0.2806959
	speed: 0.0102s/iter; left time: 197.1789s
Epoch: 28 cost time: 3.2671313285827637
Epoch: 28, Steps: 267 | Train Loss: 0.2602707 Vali Loss: 0.5466191 Test Loss: 0.4000893
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2667703
	speed: 0.0606s/iter; left time: 1159.7667s
	iters: 200, epoch: 29 | loss: 0.2446280
	speed: 0.0102s/iter; left time: 193.3335s
Epoch: 29 cost time: 3.3262698650360107
Epoch: 29, Steps: 267 | Train Loss: 0.2602541 Vali Loss: 0.5472211 Test Loss: 0.4001186
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2482632
	speed: 0.0598s/iter; left time: 1127.0019s
	iters: 200, epoch: 30 | loss: 0.2353574
	speed: 0.0106s/iter; left time: 199.0701s
Epoch: 30 cost time: 3.362656593322754
Epoch: 30, Steps: 267 | Train Loss: 0.2603533 Vali Loss: 0.5467864 Test Loss: 0.4001611
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2736950
	speed: 0.0600s/iter; left time: 1115.4694s
	iters: 200, epoch: 31 | loss: 0.2734446
	speed: 0.0100s/iter; left time: 184.8218s
Epoch: 31 cost time: 3.184229850769043
Epoch: 31, Steps: 267 | Train Loss: 0.2603148 Vali Loss: 0.5462956 Test Loss: 0.4002818
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2635493
	speed: 0.0592s/iter; left time: 1083.8846s
	iters: 200, epoch: 32 | loss: 0.2449931
	speed: 0.0101s/iter; left time: 183.9627s
Epoch: 32 cost time: 3.2601845264434814
Epoch: 32, Steps: 267 | Train Loss: 0.2602486 Vali Loss: 0.5468025 Test Loss: 0.4001848
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2569333
	speed: 0.0590s/iter; left time: 1064.6482s
	iters: 200, epoch: 33 | loss: 0.2381000
	speed: 0.0099s/iter; left time: 178.1319s
Epoch: 33 cost time: 3.1576614379882812
Epoch: 33, Steps: 267 | Train Loss: 0.2602712 Vali Loss: 0.5466172 Test Loss: 0.4002259
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2795514
	speed: 0.0593s/iter; left time: 1055.1568s
	iters: 200, epoch: 34 | loss: 0.2569486
	speed: 0.0284s/iter; left time: 503.1132s
Epoch: 34 cost time: 5.660247802734375
Epoch: 34, Steps: 267 | Train Loss: 0.2603881 Vali Loss: 0.5463724 Test Loss: 0.4004019
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2506132
	speed: 0.0858s/iter; left time: 1503.2910s
	iters: 200, epoch: 35 | loss: 0.2759422
	speed: 0.0106s/iter; left time: 184.9019s
Epoch: 35 cost time: 3.5621345043182373
Epoch: 35, Steps: 267 | Train Loss: 0.2602721 Vali Loss: 0.5464378 Test Loss: 0.4004324
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2741753
	speed: 0.0630s/iter; left time: 1086.6592s
	iters: 200, epoch: 36 | loss: 0.2565399
	speed: 0.0104s/iter; left time: 178.6510s
Epoch: 36 cost time: 3.499354362487793
Epoch: 36, Steps: 267 | Train Loss: 0.2601836 Vali Loss: 0.5470380 Test Loss: 0.4002418
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2422342
	speed: 0.0652s/iter; left time: 1107.3308s
	iters: 200, epoch: 37 | loss: 0.2525369
	speed: 0.0115s/iter; left time: 194.6957s
Epoch: 37 cost time: 3.6444408893585205
Epoch: 37, Steps: 267 | Train Loss: 0.2602439 Vali Loss: 0.5463448 Test Loss: 0.4002106
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2663618
	speed: 0.0701s/iter; left time: 1172.0192s
	iters: 200, epoch: 38 | loss: 0.2372354
	speed: 0.0108s/iter; left time: 180.1451s
Epoch: 38 cost time: 4.119169473648071
Epoch: 38, Steps: 267 | Train Loss: 0.2603816 Vali Loss: 0.5460821 Test Loss: 0.4002208
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2686439
	speed: 0.0639s/iter; left time: 1051.3992s
	iters: 200, epoch: 39 | loss: 0.2712382
	speed: 0.0112s/iter; left time: 183.1622s
Epoch: 39 cost time: 3.815375328063965
Epoch: 39, Steps: 267 | Train Loss: 0.2602868 Vali Loss: 0.5465810 Test Loss: 0.4003386
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2574051
	speed: 0.0645s/iter; left time: 1044.8009s
	iters: 200, epoch: 40 | loss: 0.2656172
	speed: 0.0169s/iter; left time: 272.3346s
Epoch: 40 cost time: 4.178085803985596
Epoch: 40, Steps: 267 | Train Loss: 0.2603116 Vali Loss: 0.5467015 Test Loss: 0.4002257
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2649499
	speed: 0.0635s/iter; left time: 1011.0230s
	iters: 200, epoch: 41 | loss: 0.2467432
	speed: 0.0106s/iter; left time: 168.3422s
Epoch: 41 cost time: 3.4640889167785645
Epoch: 41, Steps: 267 | Train Loss: 0.2603664 Vali Loss: 0.5473046 Test Loss: 0.4003085
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2593798
	speed: 0.0607s/iter; left time: 949.8708s
	iters: 200, epoch: 42 | loss: 0.2548548
	speed: 0.0122s/iter; left time: 189.2428s
Epoch: 42 cost time: 3.7952959537506104
Epoch: 42, Steps: 267 | Train Loss: 0.2603230 Vali Loss: 0.5470151 Test Loss: 0.4002617
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2516528
	speed: 0.0680s/iter; left time: 1045.6841s
	iters: 200, epoch: 43 | loss: 0.2789327
	speed: 0.0110s/iter; left time: 168.3270s
Epoch: 43 cost time: 3.6579058170318604
Epoch: 43, Steps: 267 | Train Loss: 0.2601893 Vali Loss: 0.5468622 Test Loss: 0.4002207
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2514816
	speed: 0.0652s/iter; left time: 986.2569s
	iters: 200, epoch: 44 | loss: 0.2562401
	speed: 0.0114s/iter; left time: 171.1819s
Epoch: 44 cost time: 4.5838329792022705
Epoch: 44, Steps: 267 | Train Loss: 0.2602698 Vali Loss: 0.5458422 Test Loss: 0.4003026
EarlyStopping counter: 20 out of 20
Early stopping
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=18, out_features=56, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  903168.0
params:  1064.0
Trainable parameters:  1064
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3757008
	speed: 0.0165s/iter; left time: 438.8312s
	iters: 200, epoch: 1 | loss: 0.3598801
	speed: 0.0117s/iter; left time: 310.1304s
Epoch: 1 cost time: 3.5898561477661133
Epoch: 1, Steps: 267 | Train Loss: 0.3749965 Vali Loss: 0.5460551 Test Loss: 0.3996511
Validation loss decreased (inf --> 0.546055).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3632767
	speed: 0.0636s/iter; left time: 1675.4726s
	iters: 200, epoch: 2 | loss: 0.3537401
	speed: 0.0110s/iter; left time: 288.5705s
Epoch: 2 cost time: 3.56191086769104
Epoch: 2, Steps: 267 | Train Loss: 0.3747364 Vali Loss: 0.5457101 Test Loss: 0.3994391
Validation loss decreased (0.546055 --> 0.545710).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3771057
	speed: 0.0631s/iter; left time: 1644.4986s
	iters: 200, epoch: 3 | loss: 0.3827341
	speed: 0.0106s/iter; left time: 274.5926s
Epoch: 3 cost time: 3.456653594970703
Epoch: 3, Steps: 267 | Train Loss: 0.3746846 Vali Loss: 0.5461975 Test Loss: 0.4000757
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3526493
	speed: 0.0620s/iter; left time: 1598.9610s
	iters: 200, epoch: 4 | loss: 0.3515086
	speed: 0.0114s/iter; left time: 293.7372s
Epoch: 4 cost time: 3.5509185791015625
Epoch: 4, Steps: 267 | Train Loss: 0.3746286 Vali Loss: 0.5453147 Test Loss: 0.3994235
Validation loss decreased (0.545710 --> 0.545315).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3806690
	speed: 0.0621s/iter; left time: 1586.6775s
	iters: 200, epoch: 5 | loss: 0.3840115
	speed: 0.0116s/iter; left time: 295.7070s
Epoch: 5 cost time: 3.5390193462371826
Epoch: 5, Steps: 267 | Train Loss: 0.3743689 Vali Loss: 0.5451184 Test Loss: 0.3994499
Validation loss decreased (0.545315 --> 0.545118).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3758819
	speed: 0.0637s/iter; left time: 1610.1926s
	iters: 200, epoch: 6 | loss: 0.3701904
	speed: 0.0110s/iter; left time: 276.1032s
Epoch: 6 cost time: 3.531989574432373
Epoch: 6, Steps: 267 | Train Loss: 0.3744841 Vali Loss: 0.5458268 Test Loss: 0.3996860
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3643927
	speed: 0.0605s/iter; left time: 1512.1364s
	iters: 200, epoch: 7 | loss: 0.3605205
	speed: 0.0113s/iter; left time: 281.0640s
Epoch: 7 cost time: 3.5954911708831787
Epoch: 7, Steps: 267 | Train Loss: 0.3743092 Vali Loss: 0.5447676 Test Loss: 0.3991570
Validation loss decreased (0.545118 --> 0.544768).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3618669
	speed: 0.0639s/iter; left time: 1580.1582s
	iters: 200, epoch: 8 | loss: 0.3864131
	speed: 0.0108s/iter; left time: 266.5890s
Epoch: 8 cost time: 3.477076530456543
Epoch: 8, Steps: 267 | Train Loss: 0.3744071 Vali Loss: 0.5459718 Test Loss: 0.3996539
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4017121
	speed: 0.0804s/iter; left time: 1967.7047s
	iters: 200, epoch: 9 | loss: 0.3362119
	speed: 0.0111s/iter; left time: 270.1800s
Epoch: 9 cost time: 4.774058103561401
Epoch: 9, Steps: 267 | Train Loss: 0.3744274 Vali Loss: 0.5466724 Test Loss: 0.4003291
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.4070814
	speed: 0.0624s/iter; left time: 1508.8664s
	iters: 200, epoch: 10 | loss: 0.3534020
	speed: 0.0106s/iter; left time: 256.3196s
Epoch: 10 cost time: 3.568464994430542
Epoch: 10, Steps: 267 | Train Loss: 0.3744127 Vali Loss: 0.5444605 Test Loss: 0.3987775
Validation loss decreased (0.544768 --> 0.544461).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3540706
	speed: 0.0614s/iter; left time: 1469.9847s
	iters: 200, epoch: 11 | loss: 0.3762820
	speed: 0.0106s/iter; left time: 253.6136s
Epoch: 11 cost time: 3.4097254276275635
Epoch: 11, Steps: 267 | Train Loss: 0.3743559 Vali Loss: 0.5446420 Test Loss: 0.3991501
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3468787
	speed: 0.0609s/iter; left time: 1441.4981s
	iters: 200, epoch: 12 | loss: 0.3833951
	speed: 0.0106s/iter; left time: 250.6663s
Epoch: 12 cost time: 3.4766693115234375
Epoch: 12, Steps: 267 | Train Loss: 0.3742236 Vali Loss: 0.5444389 Test Loss: 0.3993633
Validation loss decreased (0.544461 --> 0.544439).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3813677
	speed: 0.0630s/iter; left time: 1474.5855s
	iters: 200, epoch: 13 | loss: 0.3823608
	speed: 0.0106s/iter; left time: 246.8159s
Epoch: 13 cost time: 3.600282907485962
Epoch: 13, Steps: 267 | Train Loss: 0.3741961 Vali Loss: 0.5449367 Test Loss: 0.3992481
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3837214
	speed: 0.0619s/iter; left time: 1432.3631s
	iters: 200, epoch: 14 | loss: 0.3815134
	speed: 0.0108s/iter; left time: 247.8179s
Epoch: 14 cost time: 3.500124216079712
Epoch: 14, Steps: 267 | Train Loss: 0.3742844 Vali Loss: 0.5449840 Test Loss: 0.3996714
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3393708
	speed: 0.0608s/iter; left time: 1389.0557s
	iters: 200, epoch: 15 | loss: 0.3880998
	speed: 0.0110s/iter; left time: 251.4154s
Epoch: 15 cost time: 3.729132652282715
Epoch: 15, Steps: 267 | Train Loss: 0.3744415 Vali Loss: 0.5452622 Test Loss: 0.3992150
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3612859
	speed: 0.0682s/iter; left time: 1540.4318s
	iters: 200, epoch: 16 | loss: 0.3655249
	speed: 0.0199s/iter; left time: 448.4606s
Epoch: 16 cost time: 4.8080055713653564
Epoch: 16, Steps: 267 | Train Loss: 0.3742034 Vali Loss: 0.5455805 Test Loss: 0.3995847
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4065447
	speed: 0.0612s/iter; left time: 1365.8954s
	iters: 200, epoch: 17 | loss: 0.3396012
	speed: 0.0123s/iter; left time: 272.6133s
Epoch: 17 cost time: 3.9707746505737305
Epoch: 17, Steps: 267 | Train Loss: 0.3742622 Vali Loss: 0.5446934 Test Loss: 0.3992403
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3402396
	speed: 0.0660s/iter; left time: 1455.6436s
	iters: 200, epoch: 18 | loss: 0.3321481
	speed: 0.0107s/iter; left time: 234.2397s
Epoch: 18 cost time: 3.867854356765747
Epoch: 18, Steps: 267 | Train Loss: 0.3743595 Vali Loss: 0.5454147 Test Loss: 0.3990176
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3552740
	speed: 0.0666s/iter; left time: 1450.7017s
	iters: 200, epoch: 19 | loss: 0.3934815
	speed: 0.0191s/iter; left time: 413.5205s
Epoch: 19 cost time: 4.288827180862427
Epoch: 19, Steps: 267 | Train Loss: 0.3744468 Vali Loss: 0.5448574 Test Loss: 0.3993535
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3971008
	speed: 0.0640s/iter; left time: 1378.1403s
	iters: 200, epoch: 20 | loss: 0.3546036
	speed: 0.0150s/iter; left time: 320.7477s
Epoch: 20 cost time: 4.081837892532349
Epoch: 20, Steps: 267 | Train Loss: 0.3743573 Vali Loss: 0.5454088 Test Loss: 0.3998474
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3712092
	speed: 0.0610s/iter; left time: 1296.2079s
	iters: 200, epoch: 21 | loss: 0.3548649
	speed: 0.0166s/iter; left time: 352.2521s
Epoch: 21 cost time: 4.3343892097473145
Epoch: 21, Steps: 267 | Train Loss: 0.3741863 Vali Loss: 0.5453672 Test Loss: 0.3995365
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3555025
	speed: 0.0634s/iter; left time: 1330.2998s
	iters: 200, epoch: 22 | loss: 0.3486023
	speed: 0.0104s/iter; left time: 216.5674s
Epoch: 22 cost time: 3.299598455429077
Epoch: 22, Steps: 267 | Train Loss: 0.3743619 Vali Loss: 0.5456461 Test Loss: 0.3997723
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3824289
	speed: 0.0731s/iter; left time: 1515.7262s
	iters: 200, epoch: 23 | loss: 0.3547466
	speed: 0.0107s/iter; left time: 220.3033s
Epoch: 23 cost time: 4.588348627090454
Epoch: 23, Steps: 267 | Train Loss: 0.3742820 Vali Loss: 0.5451050 Test Loss: 0.3993963
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3756505
	speed: 0.0656s/iter; left time: 1343.0349s
	iters: 200, epoch: 24 | loss: 0.3328359
	speed: 0.0104s/iter; left time: 212.6804s
Epoch: 24 cost time: 3.675326108932495
Epoch: 24, Steps: 267 | Train Loss: 0.3742366 Vali Loss: 0.5453166 Test Loss: 0.3998037
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3544128
	speed: 0.0759s/iter; left time: 1532.0931s
	iters: 200, epoch: 25 | loss: 0.3812270
	speed: 0.0105s/iter; left time: 210.8081s
Epoch: 25 cost time: 3.873267650604248
Epoch: 25, Steps: 267 | Train Loss: 0.3740944 Vali Loss: 0.5451807 Test Loss: 0.3996108
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3828790
	speed: 0.0660s/iter; left time: 1316.0032s
	iters: 200, epoch: 26 | loss: 0.4008602
	speed: 0.0109s/iter; left time: 215.3545s
Epoch: 26 cost time: 3.6533892154693604
Epoch: 26, Steps: 267 | Train Loss: 0.3742312 Vali Loss: 0.5449903 Test Loss: 0.3994996
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3853703
	speed: 0.0611s/iter; left time: 1201.0710s
	iters: 200, epoch: 27 | loss: 0.3968839
	speed: 0.0109s/iter; left time: 213.1487s
Epoch: 27 cost time: 3.650991439819336
Epoch: 27, Steps: 267 | Train Loss: 0.3741879 Vali Loss: 0.5458915 Test Loss: 0.3996873
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3462169
	speed: 0.0734s/iter; left time: 1423.6832s
	iters: 200, epoch: 28 | loss: 0.3520751
	speed: 0.0110s/iter; left time: 212.3488s
Epoch: 28 cost time: 3.9282524585723877
Epoch: 28, Steps: 267 | Train Loss: 0.3742161 Vali Loss: 0.5455320 Test Loss: 0.3995454
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3553195
	speed: 0.0678s/iter; left time: 1296.3499s
	iters: 200, epoch: 29 | loss: 0.3681987
	speed: 0.0120s/iter; left time: 228.3935s
Epoch: 29 cost time: 3.794342517852783
Epoch: 29, Steps: 267 | Train Loss: 0.3742358 Vali Loss: 0.5450451 Test Loss: 0.3993452
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3683579
	speed: 0.0607s/iter; left time: 1144.9047s
	iters: 200, epoch: 30 | loss: 0.3404175
	speed: 0.0108s/iter; left time: 202.5576s
Epoch: 30 cost time: 3.7164344787597656
Epoch: 30, Steps: 267 | Train Loss: 0.3742114 Vali Loss: 0.5449256 Test Loss: 0.3996021
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3405126
	speed: 0.0650s/iter; left time: 1208.8378s
	iters: 200, epoch: 31 | loss: 0.4199322
	speed: 0.0104s/iter; left time: 192.7132s
Epoch: 31 cost time: 3.7863621711730957
Epoch: 31, Steps: 267 | Train Loss: 0.3741698 Vali Loss: 0.5446737 Test Loss: 0.3994583
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.4389354
	speed: 0.0755s/iter; left time: 1384.0589s
	iters: 200, epoch: 32 | loss: 0.3881402
	speed: 0.0141s/iter; left time: 256.9119s
Epoch: 32 cost time: 3.884007453918457
Epoch: 32, Steps: 267 | Train Loss: 0.3741262 Vali Loss: 0.5448759 Test Loss: 0.3993174
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_192_FITS_ETTm1_ftM_sl90_ll48_pl192_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.40034663677215576, mae:0.3984823524951935, rse:0.6023094058036804, corr:[0.5490617  0.55130726 0.54681283 0.54346436 0.54245543 0.5412746
 0.53853446 0.5356582  0.5340512  0.53337467 0.53266233 0.531588
 0.5303782  0.5289083  0.52658165 0.5234016  0.5200468  0.5170471
 0.5143015  0.5113754  0.5082226  0.5050542  0.50198454 0.49877104
 0.4952224  0.4913995  0.48805687 0.48573086 0.4842042  0.48264682
 0.4811563  0.48072365 0.48117754 0.48190007 0.48236567 0.4826173
 0.48251495 0.48246425 0.48252904 0.48251984 0.4824537  0.48219752
 0.48206317 0.48218662 0.48217303 0.48188898 0.481544   0.48138386
 0.4815257  0.48191065 0.48237768 0.48263618 0.48289558 0.48322895
 0.4838289  0.4843975  0.48476443 0.48484778 0.4846621  0.4846212
 0.48475924 0.4845713  0.48413745 0.48358428 0.48342723 0.48351336
 0.48335752 0.48298612 0.4829206  0.483418   0.4840614  0.48460013
 0.4849882  0.48523334 0.4856854  0.48630396 0.48718688 0.48816893
 0.48893917 0.48948172 0.48991388 0.49020788 0.49061626 0.4910467
 0.49148807 0.49193454 0.49249518 0.49322012 0.49408612 0.4949537
 0.49566856 0.4961935  0.49662745 0.49695718 0.496978   0.4964651
 0.4954462  0.4942332  0.49304053 0.49207872 0.49168903 0.4917103
 0.49162483 0.49106783 0.49037543 0.48987463 0.48951396 0.48905483
 0.48834664 0.48742053 0.48640102 0.48540708 0.48450628 0.48373455
 0.48299825 0.4822705  0.48133692 0.48017916 0.47898138 0.47789064
 0.47692767 0.4758624  0.47474322 0.47391304 0.47333735 0.47282124
 0.472348   0.47200093 0.47184196 0.47184578 0.47197145 0.4722131
 0.47239307 0.47249296 0.47231403 0.47188127 0.47139472 0.47112235
 0.47110438 0.4711645  0.47109184 0.47097254 0.4709371  0.4710742
 0.4712163  0.4712966  0.47134677 0.4713822  0.47162023 0.4718707
 0.47199866 0.4721694  0.4723834  0.47259116 0.47265515 0.4726602
 0.47255284 0.47237974 0.47223195 0.4721893  0.47228077 0.47229117
 0.47220835 0.47219616 0.47243676 0.47288004 0.4734061  0.47390324
 0.47437295 0.47490576 0.47557914 0.4764407  0.4772308  0.47790894
 0.47846016 0.47899818 0.47955316 0.48017162 0.48079833 0.48147804
 0.48211673 0.48278704 0.4836208  0.48476186 0.48599157 0.4870742
 0.48828846 0.48998478 0.4915963  0.49231386 0.49336353 0.4985023 ]
