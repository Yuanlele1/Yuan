Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=26, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_192_FITS_ETTm1_ftM_sl360_ll48_pl192_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34009
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=26, out_features=39, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  908544.0
params:  1053.0
Trainable parameters:  1053
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3880706
	speed: 0.0558s/iter; left time: 1472.9418s
	iters: 200, epoch: 1 | loss: 0.3653044
	speed: 0.0502s/iter; left time: 1320.8113s
Epoch: 1 cost time: 12.912644863128662
Epoch: 1, Steps: 265 | Train Loss: 0.4098457 Vali Loss: 0.5775180 Test Loss: 0.3619176
Validation loss decreased (inf --> 0.577518).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3295780
	speed: 0.1901s/iter; left time: 4968.7350s
	iters: 200, epoch: 2 | loss: 0.3361280
	speed: 0.0566s/iter; left time: 1474.4103s
Epoch: 2 cost time: 14.082530498504639
Epoch: 2, Steps: 265 | Train Loss: 0.3262281 Vali Loss: 0.5423753 Test Loss: 0.3454906
Validation loss decreased (0.577518 --> 0.542375).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3236126
	speed: 0.2187s/iter; left time: 5657.0872s
	iters: 200, epoch: 3 | loss: 0.3601787
	speed: 0.0486s/iter; left time: 1252.1006s
Epoch: 3 cost time: 13.07368779182434
Epoch: 3, Steps: 265 | Train Loss: 0.3179374 Vali Loss: 0.5307053 Test Loss: 0.3424657
Validation loss decreased (0.542375 --> 0.530705).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3191698
	speed: 0.2261s/iter; left time: 5789.1475s
	iters: 200, epoch: 4 | loss: 0.3251158
	speed: 0.0636s/iter; left time: 1621.1455s
Epoch: 4 cost time: 16.205312490463257
Epoch: 4, Steps: 265 | Train Loss: 0.3152631 Vali Loss: 0.5243141 Test Loss: 0.3414700
Validation loss decreased (0.530705 --> 0.524314).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2876562
	speed: 0.2068s/iter; left time: 5241.6440s
	iters: 200, epoch: 5 | loss: 0.2921101
	speed: 0.0472s/iter; left time: 1191.1276s
Epoch: 5 cost time: 15.492972612380981
Epoch: 5, Steps: 265 | Train Loss: 0.3139412 Vali Loss: 0.5230465 Test Loss: 0.3405182
Validation loss decreased (0.524314 --> 0.523046).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2952928
	speed: 0.2024s/iter; left time: 5074.2934s
	iters: 200, epoch: 6 | loss: 0.3157061
	speed: 0.0564s/iter; left time: 1409.7874s
Epoch: 6 cost time: 14.177562952041626
Epoch: 6, Steps: 265 | Train Loss: 0.3132970 Vali Loss: 0.5195277 Test Loss: 0.3406968
Validation loss decreased (0.523046 --> 0.519528).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3499808
	speed: 0.1658s/iter; left time: 4114.4443s
	iters: 200, epoch: 7 | loss: 0.2939842
	speed: 0.0369s/iter; left time: 911.2050s
Epoch: 7 cost time: 11.720487833023071
Epoch: 7, Steps: 265 | Train Loss: 0.3126386 Vali Loss: 0.5184766 Test Loss: 0.3407998
Validation loss decreased (0.519528 --> 0.518477).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3110103
	speed: 0.1919s/iter; left time: 4711.1242s
	iters: 200, epoch: 8 | loss: 0.3309157
	speed: 0.0381s/iter; left time: 931.7866s
Epoch: 8 cost time: 11.925625085830688
Epoch: 8, Steps: 265 | Train Loss: 0.3123860 Vali Loss: 0.5181474 Test Loss: 0.3408792
Validation loss decreased (0.518477 --> 0.518147).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3187898
	speed: 0.1938s/iter; left time: 4704.7157s
	iters: 200, epoch: 9 | loss: 0.3029746
	speed: 0.0611s/iter; left time: 1477.9896s
Epoch: 9 cost time: 15.398857355117798
Epoch: 9, Steps: 265 | Train Loss: 0.3122837 Vali Loss: 0.5174065 Test Loss: 0.3412055
Validation loss decreased (0.518147 --> 0.517406).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3205766
	speed: 0.2351s/iter; left time: 5646.6199s
	iters: 200, epoch: 10 | loss: 0.3307211
	speed: 0.0504s/iter; left time: 1205.9443s
Epoch: 10 cost time: 15.064404487609863
Epoch: 10, Steps: 265 | Train Loss: 0.3120783 Vali Loss: 0.5167136 Test Loss: 0.3411369
Validation loss decreased (0.517406 --> 0.516714).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3294118
	speed: 0.1853s/iter; left time: 4401.7074s
	iters: 200, epoch: 11 | loss: 0.3502226
	speed: 0.0565s/iter; left time: 1337.2152s
Epoch: 11 cost time: 13.83825421333313
Epoch: 11, Steps: 265 | Train Loss: 0.3119990 Vali Loss: 0.5157558 Test Loss: 0.3410655
Validation loss decreased (0.516714 --> 0.515756).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3401873
	speed: 0.2122s/iter; left time: 4983.7858s
	iters: 200, epoch: 12 | loss: 0.3177956
	speed: 0.0392s/iter; left time: 917.0545s
Epoch: 12 cost time: 13.260940313339233
Epoch: 12, Steps: 265 | Train Loss: 0.3118691 Vali Loss: 0.5159258 Test Loss: 0.3411143
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3071882
	speed: 0.2099s/iter; left time: 4874.0498s
	iters: 200, epoch: 13 | loss: 0.3556860
	speed: 0.0549s/iter; left time: 1270.1398s
Epoch: 13 cost time: 14.33724069595337
Epoch: 13, Steps: 265 | Train Loss: 0.3117843 Vali Loss: 0.5155607 Test Loss: 0.3409127
Validation loss decreased (0.515756 --> 0.515561).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3349018
	speed: 0.1768s/iter; left time: 4059.1933s
	iters: 200, epoch: 14 | loss: 0.3210351
	speed: 0.0520s/iter; left time: 1187.4083s
Epoch: 14 cost time: 13.040652513504028
Epoch: 14, Steps: 265 | Train Loss: 0.3117205 Vali Loss: 0.5157524 Test Loss: 0.3413770
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3757097
	speed: 0.1803s/iter; left time: 4092.1868s
	iters: 200, epoch: 15 | loss: 0.3333485
	speed: 0.0660s/iter; left time: 1490.7096s
Epoch: 15 cost time: 15.25268292427063
Epoch: 15, Steps: 265 | Train Loss: 0.3116954 Vali Loss: 0.5153692 Test Loss: 0.3409968
Validation loss decreased (0.515561 --> 0.515369).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3158538
	speed: 0.1951s/iter; left time: 4375.7965s
	iters: 200, epoch: 16 | loss: 0.3240094
	speed: 0.0569s/iter; left time: 1271.1473s
Epoch: 16 cost time: 13.736894845962524
Epoch: 16, Steps: 265 | Train Loss: 0.3117302 Vali Loss: 0.5149292 Test Loss: 0.3413015
Validation loss decreased (0.515369 --> 0.514929).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3046125
	speed: 0.1785s/iter; left time: 3956.1502s
	iters: 200, epoch: 17 | loss: 0.3185822
	speed: 0.0388s/iter; left time: 854.8642s
Epoch: 17 cost time: 10.306162357330322
Epoch: 17, Steps: 265 | Train Loss: 0.3115462 Vali Loss: 0.5150707 Test Loss: 0.3412402
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3020593
	speed: 0.2033s/iter; left time: 4451.0851s
	iters: 200, epoch: 18 | loss: 0.3458541
	speed: 0.0483s/iter; left time: 1053.0656s
Epoch: 18 cost time: 15.442365169525146
Epoch: 18, Steps: 265 | Train Loss: 0.3116230 Vali Loss: 0.5144741 Test Loss: 0.3410620
Validation loss decreased (0.514929 --> 0.514474).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3378468
	speed: 0.3152s/iter; left time: 6818.2744s
	iters: 200, epoch: 19 | loss: 0.2831315
	speed: 0.0632s/iter; left time: 1360.2259s
Epoch: 19 cost time: 19.04169988632202
Epoch: 19, Steps: 265 | Train Loss: 0.3116573 Vali Loss: 0.5148449 Test Loss: 0.3413105
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3576947
	speed: 0.3362s/iter; left time: 7184.2413s
	iters: 200, epoch: 20 | loss: 0.3367367
	speed: 0.0608s/iter; left time: 1292.6149s
Epoch: 20 cost time: 18.07998776435852
Epoch: 20, Steps: 265 | Train Loss: 0.3115296 Vali Loss: 0.5153363 Test Loss: 0.3412068
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3282169
	speed: 0.2764s/iter; left time: 5832.0458s
	iters: 200, epoch: 21 | loss: 0.3469649
	speed: 0.0603s/iter; left time: 1265.5485s
Epoch: 21 cost time: 17.634114027023315
Epoch: 21, Steps: 265 | Train Loss: 0.3115708 Vali Loss: 0.5145466 Test Loss: 0.3413511
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3346988
	speed: 0.2808s/iter; left time: 5850.9138s
	iters: 200, epoch: 22 | loss: 0.2880576
	speed: 0.0728s/iter; left time: 1509.2960s
Epoch: 22 cost time: 18.748881816864014
Epoch: 22, Steps: 265 | Train Loss: 0.3115017 Vali Loss: 0.5143413 Test Loss: 0.3415081
Validation loss decreased (0.514474 --> 0.514341).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2902613
	speed: 0.3189s/iter; left time: 6560.0664s
	iters: 200, epoch: 23 | loss: 0.2823034
	speed: 0.0457s/iter; left time: 934.9255s
Epoch: 23 cost time: 17.19357705116272
Epoch: 23, Steps: 265 | Train Loss: 0.3114602 Vali Loss: 0.5146536 Test Loss: 0.3413538
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3029680
	speed: 0.3110s/iter; left time: 6315.2691s
	iters: 200, epoch: 24 | loss: 0.3015898
	speed: 0.0747s/iter; left time: 1510.3186s
Epoch: 24 cost time: 18.93339705467224
Epoch: 24, Steps: 265 | Train Loss: 0.3115443 Vali Loss: 0.5147531 Test Loss: 0.3414066
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3289106
	speed: 0.3228s/iter; left time: 6469.8077s
	iters: 200, epoch: 25 | loss: 0.2984039
	speed: 0.0763s/iter; left time: 1521.8008s
Epoch: 25 cost time: 21.050984144210815
Epoch: 25, Steps: 265 | Train Loss: 0.3112691 Vali Loss: 0.5145400 Test Loss: 0.3412480
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2901133
	speed: 0.3251s/iter; left time: 6428.7004s
	iters: 200, epoch: 26 | loss: 0.3109246
	speed: 0.0745s/iter; left time: 1465.3201s
Epoch: 26 cost time: 18.8865168094635
Epoch: 26, Steps: 265 | Train Loss: 0.3113584 Vali Loss: 0.5139952 Test Loss: 0.3413066
Validation loss decreased (0.514341 --> 0.513995).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3014805
	speed: 0.2838s/iter; left time: 5538.0438s
	iters: 200, epoch: 27 | loss: 0.2910402
	speed: 0.0796s/iter; left time: 1546.0354s
Epoch: 27 cost time: 20.544149160385132
Epoch: 27, Steps: 265 | Train Loss: 0.3113970 Vali Loss: 0.5145314 Test Loss: 0.3415331
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3266661
	speed: 0.2772s/iter; left time: 5334.8646s
	iters: 200, epoch: 28 | loss: 0.3104781
	speed: 0.0732s/iter; left time: 1401.0627s
Epoch: 28 cost time: 20.676409244537354
Epoch: 28, Steps: 265 | Train Loss: 0.3114306 Vali Loss: 0.5141792 Test Loss: 0.3413498
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3181680
	speed: 0.3392s/iter; left time: 6439.3034s
	iters: 200, epoch: 29 | loss: 0.3037815
	speed: 0.0793s/iter; left time: 1496.6592s
Epoch: 29 cost time: 21.645919799804688
Epoch: 29, Steps: 265 | Train Loss: 0.3114303 Vali Loss: 0.5144060 Test Loss: 0.3414097
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3253637
	speed: 0.2819s/iter; left time: 5276.5805s
	iters: 200, epoch: 30 | loss: 0.3044757
	speed: 0.0868s/iter; left time: 1615.6340s
Epoch: 30 cost time: 22.016502857208252
Epoch: 30, Steps: 265 | Train Loss: 0.3113180 Vali Loss: 0.5141882 Test Loss: 0.3412642
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3490373
	speed: 0.3837s/iter; left time: 7080.2211s
	iters: 200, epoch: 31 | loss: 0.3028563
	speed: 0.0846s/iter; left time: 1552.7543s
Epoch: 31 cost time: 24.216096878051758
Epoch: 31, Steps: 265 | Train Loss: 0.3112706 Vali Loss: 0.5145947 Test Loss: 0.3412826
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3755647
	speed: 0.4224s/iter; left time: 7681.4691s
	iters: 200, epoch: 32 | loss: 0.2898908
	speed: 0.1003s/iter; left time: 1813.5642s
Epoch: 32 cost time: 27.75667977333069
Epoch: 32, Steps: 265 | Train Loss: 0.3114491 Vali Loss: 0.5142692 Test Loss: 0.3413331
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3097398
	speed: 0.4168s/iter; left time: 7470.2569s
	iters: 200, epoch: 33 | loss: 0.2890046
	speed: 0.0999s/iter; left time: 1779.4456s
Epoch: 33 cost time: 25.74239993095398
Epoch: 33, Steps: 265 | Train Loss: 0.3114146 Vali Loss: 0.5142265 Test Loss: 0.3412760
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3360819
	speed: 0.4410s/iter; left time: 7785.5818s
	iters: 200, epoch: 34 | loss: 0.3138570
	speed: 0.1023s/iter; left time: 1795.5614s
Epoch: 34 cost time: 26.705825805664062
Epoch: 34, Steps: 265 | Train Loss: 0.3113599 Vali Loss: 0.5148146 Test Loss: 0.3413745
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3270520
	speed: 0.4427s/iter; left time: 7698.8949s
	iters: 200, epoch: 35 | loss: 0.3064091
	speed: 0.0952s/iter; left time: 1646.0722s
Epoch: 35 cost time: 27.35856008529663
Epoch: 35, Steps: 265 | Train Loss: 0.3113837 Vali Loss: 0.5142719 Test Loss: 0.3413702
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3145507
	speed: 0.4302s/iter; left time: 7366.8307s
	iters: 200, epoch: 36 | loss: 0.3139346
	speed: 0.0914s/iter; left time: 1556.3876s
Epoch: 36 cost time: 25.051416873931885
Epoch: 36, Steps: 265 | Train Loss: 0.3113364 Vali Loss: 0.5142744 Test Loss: 0.3413690
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2961371
	speed: 0.4361s/iter; left time: 7352.5366s
	iters: 200, epoch: 37 | loss: 0.2861810
	speed: 0.1001s/iter; left time: 1677.9311s
Epoch: 37 cost time: 25.784355640411377
Epoch: 37, Steps: 265 | Train Loss: 0.3113153 Vali Loss: 0.5139280 Test Loss: 0.3412809
Validation loss decreased (0.513995 --> 0.513928).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2737288
	speed: 0.4055s/iter; left time: 6729.8938s
	iters: 200, epoch: 38 | loss: 0.3486268
	speed: 0.0900s/iter; left time: 1484.3118s
Epoch: 38 cost time: 25.88978123664856
Epoch: 38, Steps: 265 | Train Loss: 0.3113954 Vali Loss: 0.5139952 Test Loss: 0.3413166
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2907822
	speed: 0.4049s/iter; left time: 6613.0000s
	iters: 200, epoch: 39 | loss: 0.3162428
	speed: 0.0912s/iter; left time: 1479.5885s
Epoch: 39 cost time: 24.441630840301514
Epoch: 39, Steps: 265 | Train Loss: 0.3112884 Vali Loss: 0.5141062 Test Loss: 0.3413461
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2924249
	speed: 0.4228s/iter; left time: 6792.0786s
	iters: 200, epoch: 40 | loss: 0.3328321
	speed: 0.0912s/iter; left time: 1456.1644s
Epoch: 40 cost time: 24.3004789352417
Epoch: 40, Steps: 265 | Train Loss: 0.3112206 Vali Loss: 0.5139398 Test Loss: 0.3412567
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3081654
	speed: 0.3850s/iter; left time: 6083.2965s
	iters: 200, epoch: 41 | loss: 0.3252680
	speed: 0.0830s/iter; left time: 1303.0322s
Epoch: 41 cost time: 22.036340713500977
Epoch: 41, Steps: 265 | Train Loss: 0.3111513 Vali Loss: 0.5138796 Test Loss: 0.3413037
Validation loss decreased (0.513928 --> 0.513880).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3019083
	speed: 0.3412s/iter; left time: 5301.1562s
	iters: 200, epoch: 42 | loss: 0.3107289
	speed: 0.0805s/iter; left time: 1242.6706s
Epoch: 42 cost time: 20.531679391860962
Epoch: 42, Steps: 265 | Train Loss: 0.3114031 Vali Loss: 0.5144143 Test Loss: 0.3412864
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3032581
	speed: 0.2647s/iter; left time: 4042.5052s
	iters: 200, epoch: 43 | loss: 0.2698898
	speed: 0.0419s/iter; left time: 635.6793s
Epoch: 43 cost time: 16.80656385421753
Epoch: 43, Steps: 265 | Train Loss: 0.3113231 Vali Loss: 0.5139368 Test Loss: 0.3413385
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3434276
	speed: 0.3155s/iter; left time: 4734.1950s
	iters: 200, epoch: 44 | loss: 0.3153258
	speed: 0.1701s/iter; left time: 2535.5420s
Epoch: 44 cost time: 37.54118824005127
Epoch: 44, Steps: 265 | Train Loss: 0.3112961 Vali Loss: 0.5141029 Test Loss: 0.3412890
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.3104149
	speed: 0.6817s/iter; left time: 10049.0322s
	iters: 200, epoch: 45 | loss: 0.3090737
	speed: 0.1760s/iter; left time: 2577.1120s
Epoch: 45 cost time: 45.09002351760864
Epoch: 45, Steps: 265 | Train Loss: 0.3114084 Vali Loss: 0.5137904 Test Loss: 0.3413168
Validation loss decreased (0.513880 --> 0.513790).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2897020
	speed: 0.6465s/iter; left time: 9359.2067s
	iters: 200, epoch: 46 | loss: 0.3329960
	speed: 0.0999s/iter; left time: 1435.4491s
Epoch: 46 cost time: 29.471964359283447
Epoch: 46, Steps: 265 | Train Loss: 0.3112058 Vali Loss: 0.5144908 Test Loss: 0.3413166
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2862293
	speed: 0.4513s/iter; left time: 6413.5042s
	iters: 200, epoch: 47 | loss: 0.3166606
	speed: 0.0864s/iter; left time: 1218.8301s
Epoch: 47 cost time: 23.051390171051025
Epoch: 47, Steps: 265 | Train Loss: 0.3113249 Vali Loss: 0.5140625 Test Loss: 0.3412775
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3725074
	speed: 0.4083s/iter; left time: 5693.4926s
	iters: 200, epoch: 48 | loss: 0.3269259
	speed: 0.0993s/iter; left time: 1374.9028s
Epoch: 48 cost time: 27.28178644180298
Epoch: 48, Steps: 265 | Train Loss: 0.3113705 Vali Loss: 0.5135551 Test Loss: 0.3412915
Validation loss decreased (0.513790 --> 0.513555).  Saving model ...
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2889308
	speed: 0.4422s/iter; left time: 6049.3588s
	iters: 200, epoch: 49 | loss: 0.2856532
	speed: 0.0974s/iter; left time: 1322.7839s
Epoch: 49 cost time: 26.653783321380615
Epoch: 49, Steps: 265 | Train Loss: 0.3113202 Vali Loss: 0.5137205 Test Loss: 0.3412831
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.3316729
	speed: 0.3971s/iter; left time: 5327.5735s
	iters: 200, epoch: 50 | loss: 0.2992934
	speed: 0.1029s/iter; left time: 1369.6316s
Epoch: 50 cost time: 26.936161756515503
Epoch: 50, Steps: 265 | Train Loss: 0.3113638 Vali Loss: 0.5136660 Test Loss: 0.3412834
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2696647
	speed: 0.4661s/iter; left time: 6129.7258s
	iters: 200, epoch: 51 | loss: 0.3076840
	speed: 0.0939s/iter; left time: 1225.4389s
Epoch: 51 cost time: 28.95919632911682
Epoch: 51, Steps: 265 | Train Loss: 0.3113347 Vali Loss: 0.5143808 Test Loss: 0.3413259
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.3114035
	speed: 0.4855s/iter; left time: 6255.8587s
	iters: 200, epoch: 52 | loss: 0.3208287
	speed: 0.1084s/iter; left time: 1385.3766s
Epoch: 52 cost time: 27.970210790634155
Epoch: 52, Steps: 265 | Train Loss: 0.3113205 Vali Loss: 0.5141116 Test Loss: 0.3413067
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.3090088
	speed: 0.4442s/iter; left time: 5606.4456s
	iters: 200, epoch: 53 | loss: 0.3561662
	speed: 0.1139s/iter; left time: 1426.3902s
Epoch: 53 cost time: 27.987330675125122
Epoch: 53, Steps: 265 | Train Loss: 0.3113552 Vali Loss: 0.5134287 Test Loss: 0.3413208
Validation loss decreased (0.513555 --> 0.513429).  Saving model ...
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.3097303
	speed: 0.4441s/iter; left time: 5487.4858s
	iters: 200, epoch: 54 | loss: 0.3143708
	speed: 0.1041s/iter; left time: 1276.1094s
Epoch: 54 cost time: 26.745526790618896
Epoch: 54, Steps: 265 | Train Loss: 0.3113317 Vali Loss: 0.5131044 Test Loss: 0.3413090
Validation loss decreased (0.513429 --> 0.513104).  Saving model ...
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2939537
	speed: 0.4739s/iter; left time: 5729.6996s
	iters: 200, epoch: 55 | loss: 0.3087732
	speed: 0.0994s/iter; left time: 1191.8505s
Epoch: 55 cost time: 28.585782051086426
Epoch: 55, Steps: 265 | Train Loss: 0.3113400 Vali Loss: 0.5142343 Test Loss: 0.3413305
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3032155
	speed: 0.4651s/iter; left time: 5500.1031s
	iters: 200, epoch: 56 | loss: 0.3402447
	speed: 0.1048s/iter; left time: 1228.5532s
Epoch: 56 cost time: 28.33663821220398
Epoch: 56, Steps: 265 | Train Loss: 0.3113549 Vali Loss: 0.5135937 Test Loss: 0.3413275
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3181504
	speed: 0.4560s/iter; left time: 5272.1442s
	iters: 200, epoch: 57 | loss: 0.3012661
	speed: 0.1121s/iter; left time: 1285.1006s
Epoch: 57 cost time: 28.427199125289917
Epoch: 57, Steps: 265 | Train Loss: 0.3112506 Vali Loss: 0.5139818 Test Loss: 0.3413160
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3173811
	speed: 0.4254s/iter; left time: 4804.7770s
	iters: 200, epoch: 58 | loss: 0.3105227
	speed: 0.1045s/iter; left time: 1169.9468s
Epoch: 58 cost time: 28.405837059020996
Epoch: 58, Steps: 265 | Train Loss: 0.3113139 Vali Loss: 0.5140331 Test Loss: 0.3413074
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2757687
	speed: 0.4472s/iter; left time: 4932.9760s
	iters: 200, epoch: 59 | loss: 0.2780551
	speed: 0.0955s/iter; left time: 1043.5214s
Epoch: 59 cost time: 26.50600576400757
Epoch: 59, Steps: 265 | Train Loss: 0.3112197 Vali Loss: 0.5133758 Test Loss: 0.3413347
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.3538456
	speed: 0.4601s/iter; left time: 4953.9393s
	iters: 200, epoch: 60 | loss: 0.3151736
	speed: 0.1118s/iter; left time: 1192.9144s
Epoch: 60 cost time: 28.017507076263428
Epoch: 60, Steps: 265 | Train Loss: 0.3112734 Vali Loss: 0.5139997 Test Loss: 0.3413377
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2870096
	speed: 0.4575s/iter; left time: 4804.7310s
	iters: 200, epoch: 61 | loss: 0.2917559
	speed: 0.1029s/iter; left time: 1070.1840s
Epoch: 61 cost time: 26.51599407196045
Epoch: 61, Steps: 265 | Train Loss: 0.3113035 Vali Loss: 0.5137710 Test Loss: 0.3413251
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3066674
	speed: 0.3595s/iter; left time: 3679.5313s
	iters: 200, epoch: 62 | loss: 0.3099364
	speed: 0.0680s/iter; left time: 689.2700s
Epoch: 62 cost time: 20.059720277786255
Epoch: 62, Steps: 265 | Train Loss: 0.3113121 Vali Loss: 0.5144192 Test Loss: 0.3413267
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2970675
	speed: 0.4337s/iter; left time: 4324.7450s
	iters: 200, epoch: 63 | loss: 0.3234850
	speed: 0.1092s/iter; left time: 1077.6294s
Epoch: 63 cost time: 28.02726697921753
Epoch: 63, Steps: 265 | Train Loss: 0.3112678 Vali Loss: 0.5140066 Test Loss: 0.3413399
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.3063878
	speed: 0.3179s/iter; left time: 3085.5179s
	iters: 200, epoch: 64 | loss: 0.2929263
	speed: 0.0879s/iter; left time: 843.8937s
Epoch: 64 cost time: 23.275715827941895
Epoch: 64, Steps: 265 | Train Loss: 0.3112216 Vali Loss: 0.5133647 Test Loss: 0.3413413
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2845508
	speed: 0.4655s/iter; left time: 4395.1304s
	iters: 200, epoch: 65 | loss: 0.3286128
	speed: 0.0766s/iter; left time: 715.4164s
Epoch: 65 cost time: 23.32944679260254
Epoch: 65, Steps: 265 | Train Loss: 0.3112786 Vali Loss: 0.5139455 Test Loss: 0.3413359
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.3016072
	speed: 0.3554s/iter; left time: 3260.7025s
	iters: 200, epoch: 66 | loss: 0.3018750
	speed: 0.0896s/iter; left time: 812.8551s
Epoch: 66 cost time: 23.789872884750366
Epoch: 66, Steps: 265 | Train Loss: 0.3112464 Vali Loss: 0.5141726 Test Loss: 0.3413277
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.3239806
	speed: 0.3486s/iter; left time: 3106.2465s
	iters: 200, epoch: 67 | loss: 0.2951379
	speed: 0.0910s/iter; left time: 801.7916s
Epoch: 67 cost time: 22.692077159881592
Epoch: 67, Steps: 265 | Train Loss: 0.3112778 Vali Loss: 0.5139461 Test Loss: 0.3413039
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2995606
	speed: 0.3537s/iter; left time: 3057.7363s
	iters: 200, epoch: 68 | loss: 0.2920682
	speed: 0.0783s/iter; left time: 669.0354s
Epoch: 68 cost time: 22.507734060287476
Epoch: 68, Steps: 265 | Train Loss: 0.3112184 Vali Loss: 0.5135178 Test Loss: 0.3413081
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.3415838
	speed: 0.3721s/iter; left time: 3118.9545s
	iters: 200, epoch: 69 | loss: 0.3166845
	speed: 0.0760s/iter; left time: 629.0830s
Epoch: 69 cost time: 21.557113885879517
Epoch: 69, Steps: 265 | Train Loss: 0.3112553 Vali Loss: 0.5139824 Test Loss: 0.3413178
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2961064
	speed: 0.3606s/iter; left time: 2926.6574s
	iters: 200, epoch: 70 | loss: 0.3145140
	speed: 0.0794s/iter; left time: 636.2562s
Epoch: 70 cost time: 22.309097290039062
Epoch: 70, Steps: 265 | Train Loss: 0.3111527 Vali Loss: 0.5146683 Test Loss: 0.3413090
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.3074735
	speed: 0.3683s/iter; left time: 2891.4755s
	iters: 200, epoch: 71 | loss: 0.2895673
	speed: 0.0783s/iter; left time: 607.2226s
Epoch: 71 cost time: 22.137381553649902
Epoch: 71, Steps: 265 | Train Loss: 0.3112387 Vali Loss: 0.5142245 Test Loss: 0.3413116
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.3226010
	speed: 0.3213s/iter; left time: 2437.6548s
	iters: 200, epoch: 72 | loss: 0.3124760
	speed: 0.0807s/iter; left time: 603.9993s
Epoch: 72 cost time: 23.447195291519165
Epoch: 72, Steps: 265 | Train Loss: 0.3113570 Vali Loss: 0.5140105 Test Loss: 0.3413163
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.3168111
	speed: 0.3275s/iter; left time: 2397.7191s
	iters: 200, epoch: 73 | loss: 0.2718389
	speed: 0.0719s/iter; left time: 519.4489s
Epoch: 73 cost time: 20.024108409881592
Epoch: 73, Steps: 265 | Train Loss: 0.3112937 Vali Loss: 0.5138525 Test Loss: 0.3413194
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.3016841
	speed: 0.3428s/iter; left time: 2418.7940s
	iters: 200, epoch: 74 | loss: 0.3085974
	speed: 0.0640s/iter; left time: 445.3160s
Epoch: 74 cost time: 20.590672969818115
Epoch: 74, Steps: 265 | Train Loss: 0.3111711 Vali Loss: 0.5141004 Test Loss: 0.3413188
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_192_FITS_ETTm1_ftM_sl360_ll48_pl192_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3422708511352539, mae:0.3693901598453522, rse:0.556911826133728, corr:[0.54635584 0.55004823 0.5526562  0.5539884  0.5543262  0.5541101
 0.5537616  0.5536055  0.55376756 0.5542757  0.55511415 0.5558768
 0.5563264  0.55627996 0.5556971  0.5545853  0.55315    0.5515988
 0.5499613  0.54830843 0.546695   0.5453175  0.5441529  0.54332274
 0.5427471  0.5422379  0.54178864 0.5414258  0.5411098  0.54072267
 0.5403491  0.5400989  0.53994656 0.5398919  0.53989506 0.53999376
 0.54013574 0.54024744 0.54028505 0.5401901  0.5399647  0.53959525
 0.5390916  0.5385559  0.538032   0.5375801  0.5373099  0.53720546
 0.5372213  0.5373566  0.5375256  0.5376593  0.5377242  0.53766924
 0.5374887  0.53721595 0.5368684  0.53650683 0.5362212  0.53600395
 0.535939   0.53599507 0.5361573  0.5363427  0.53657526 0.5368268
 0.53702813 0.5371322  0.5372474  0.53734916 0.5374611  0.5375742
 0.53770226 0.5378501  0.53798175 0.53805697 0.5380587  0.5379931
 0.5378491  0.5376297  0.5373594  0.53705746 0.5367164  0.5363381
 0.5359936  0.5356699  0.5354264  0.53522664 0.53505343 0.5349367
 0.53487396 0.5347693  0.53453404 0.5341695  0.5336521  0.53300005
 0.5323283  0.5317585  0.53132564 0.5310042  0.5308463  0.5308619
 0.5310223  0.5312243  0.5315096  0.5318682  0.53218675 0.5325042
 0.53272057 0.5329117  0.5330264  0.53306466 0.5329989  0.53291255
 0.5328217  0.5327706  0.5327463  0.5327618  0.5327947  0.532927
 0.5331024  0.53317386 0.5331114  0.5330139  0.5328899  0.532717
 0.5325318  0.5323869  0.5322842  0.53223544 0.53222466 0.53221965
 0.53222245 0.53219    0.53214926 0.532076   0.53197294 0.5317982
 0.5315832  0.53132945 0.5310376  0.53077793 0.53058493 0.530498
 0.53051066 0.53061426 0.5307598  0.53091073 0.5310545  0.5310876
 0.53098875 0.5308073  0.53054345 0.53022254 0.5299085  0.52969086
 0.52957916 0.52960026 0.5297282  0.5299482  0.530259   0.53058594
 0.5308842  0.5310998  0.53126335 0.53137547 0.5314211  0.531485
 0.5315411  0.53159696 0.5316835  0.5318061  0.53191304 0.5319813
 0.5319818  0.531937   0.5318448  0.53171206 0.5314805  0.53118855
 0.5308148  0.5304333  0.5299979  0.52957755 0.52922904 0.52903277
 0.52906376 0.5294008  0.53006035 0.5310346  0.53202033 0.53268677]
