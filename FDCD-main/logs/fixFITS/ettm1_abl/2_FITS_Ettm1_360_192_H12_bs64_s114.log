Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=58, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_192_FITS_ETTm1_ftM_sl360_ll48_pl192_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34009
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=58, out_features=88, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4573184.0
params:  5192.0
Trainable parameters:  5192
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3882384
	speed: 0.0420s/iter; left time: 1109.8857s
	iters: 200, epoch: 1 | loss: 0.2836072
	speed: 0.0281s/iter; left time: 738.5075s
Epoch: 1 cost time: 9.214029550552368
Epoch: 1, Steps: 265 | Train Loss: 0.3830281 Vali Loss: 0.7354112 Test Loss: 0.4847279
Validation loss decreased (inf --> 0.735411).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2368698
	speed: 0.1338s/iter; left time: 3496.9181s
	iters: 200, epoch: 2 | loss: 0.1996142
	speed: 0.0261s/iter; left time: 679.5599s
Epoch: 2 cost time: 8.80592942237854
Epoch: 2, Steps: 265 | Train Loss: 0.2258889 Vali Loss: 0.6367049 Test Loss: 0.4198674
Validation loss decreased (0.735411 --> 0.636705).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1892481
	speed: 0.2381s/iter; left time: 6160.3411s
	iters: 200, epoch: 3 | loss: 0.1686525
	speed: 0.0204s/iter; left time: 525.9563s
Epoch: 3 cost time: 7.513504266738892
Epoch: 3, Steps: 265 | Train Loss: 0.1788335 Vali Loss: 0.5933436 Test Loss: 0.3925557
Validation loss decreased (0.636705 --> 0.593344).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1551940
	speed: 0.1337s/iter; left time: 3424.0476s
	iters: 200, epoch: 4 | loss: 0.1565461
	speed: 0.0202s/iter; left time: 515.7985s
Epoch: 4 cost time: 6.585233688354492
Epoch: 4, Steps: 265 | Train Loss: 0.1563121 Vali Loss: 0.5699202 Test Loss: 0.3790719
Validation loss decreased (0.593344 --> 0.569920).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1429632
	speed: 0.1033s/iter; left time: 2617.1921s
	iters: 200, epoch: 5 | loss: 0.1397945
	speed: 0.0242s/iter; left time: 609.8953s
Epoch: 5 cost time: 7.88207483291626
Epoch: 5, Steps: 265 | Train Loss: 0.1436674 Vali Loss: 0.5577742 Test Loss: 0.3704816
Validation loss decreased (0.569920 --> 0.557774).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1320892
	speed: 0.1071s/iter; left time: 2686.6813s
	iters: 200, epoch: 6 | loss: 0.1457888
	speed: 0.0225s/iter; left time: 561.0022s
Epoch: 6 cost time: 7.185472726821899
Epoch: 6, Steps: 265 | Train Loss: 0.1359111 Vali Loss: 0.5464847 Test Loss: 0.3644017
Validation loss decreased (0.557774 --> 0.546485).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1311996
	speed: 0.1325s/iter; left time: 3286.4490s
	iters: 200, epoch: 7 | loss: 0.1223108
	speed: 0.0448s/iter; left time: 1108.2187s
Epoch: 7 cost time: 9.63090705871582
Epoch: 7, Steps: 265 | Train Loss: 0.1308559 Vali Loss: 0.5396180 Test Loss: 0.3600010
Validation loss decreased (0.546485 --> 0.539618).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1236342
	speed: 0.1401s/iter; left time: 3438.0722s
	iters: 200, epoch: 8 | loss: 0.1240684
	speed: 0.0293s/iter; left time: 717.4464s
Epoch: 8 cost time: 9.223318099975586
Epoch: 8, Steps: 265 | Train Loss: 0.1275196 Vali Loss: 0.5356281 Test Loss: 0.3572052
Validation loss decreased (0.539618 --> 0.535628).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1165818
	speed: 0.1306s/iter; left time: 3170.1591s
	iters: 200, epoch: 9 | loss: 0.1311583
	speed: 0.0340s/iter; left time: 821.2773s
Epoch: 9 cost time: 8.830316305160522
Epoch: 9, Steps: 265 | Train Loss: 0.1251795 Vali Loss: 0.5324642 Test Loss: 0.3546112
Validation loss decreased (0.535628 --> 0.532464).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1308081
	speed: 0.1131s/iter; left time: 2717.1153s
	iters: 200, epoch: 10 | loss: 0.1153800
	speed: 0.0201s/iter; left time: 479.9991s
Epoch: 10 cost time: 6.80068302154541
Epoch: 10, Steps: 265 | Train Loss: 0.1234759 Vali Loss: 0.5300159 Test Loss: 0.3524126
Validation loss decreased (0.532464 --> 0.530016).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1281284
	speed: 0.1022s/iter; left time: 2427.1672s
	iters: 200, epoch: 11 | loss: 0.1162560
	speed: 0.0259s/iter; left time: 612.9007s
Epoch: 11 cost time: 7.209481239318848
Epoch: 11, Steps: 265 | Train Loss: 0.1222953 Vali Loss: 0.5278726 Test Loss: 0.3506282
Validation loss decreased (0.530016 --> 0.527873).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1264272
	speed: 0.1425s/iter; left time: 3347.1392s
	iters: 200, epoch: 12 | loss: 0.1218265
	speed: 0.0348s/iter; left time: 812.7676s
Epoch: 12 cost time: 9.254106044769287
Epoch: 12, Steps: 265 | Train Loss: 0.1213569 Vali Loss: 0.5272253 Test Loss: 0.3488972
Validation loss decreased (0.527873 --> 0.527225).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1273964
	speed: 0.1402s/iter; left time: 3256.7231s
	iters: 200, epoch: 13 | loss: 0.1193423
	speed: 0.0371s/iter; left time: 857.7707s
Epoch: 13 cost time: 8.126863956451416
Epoch: 13, Steps: 265 | Train Loss: 0.1207001 Vali Loss: 0.5255085 Test Loss: 0.3476086
Validation loss decreased (0.527225 --> 0.525509).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1137763
	speed: 0.1286s/iter; left time: 2951.7204s
	iters: 200, epoch: 14 | loss: 0.1170095
	speed: 0.0199s/iter; left time: 454.7535s
Epoch: 14 cost time: 8.18469524383545
Epoch: 14, Steps: 265 | Train Loss: 0.1202404 Vali Loss: 0.5250897 Test Loss: 0.3468222
Validation loss decreased (0.525509 --> 0.525090).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1172054
	speed: 0.1147s/iter; left time: 2603.3919s
	iters: 200, epoch: 15 | loss: 0.1251444
	speed: 0.0204s/iter; left time: 460.5780s
Epoch: 15 cost time: 5.88191032409668
Epoch: 15, Steps: 265 | Train Loss: 0.1198982 Vali Loss: 0.5224197 Test Loss: 0.3457829
Validation loss decreased (0.525090 --> 0.522420).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1264368
	speed: 0.1029s/iter; left time: 2308.5179s
	iters: 200, epoch: 16 | loss: 0.1118430
	speed: 0.0250s/iter; left time: 557.2743s
Epoch: 16 cost time: 6.77463698387146
Epoch: 16, Steps: 265 | Train Loss: 0.1196255 Vali Loss: 0.5236752 Test Loss: 0.3448101
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1256257
	speed: 0.1146s/iter; left time: 2539.2235s
	iters: 200, epoch: 17 | loss: 0.1136978
	speed: 0.0241s/iter; left time: 531.4187s
Epoch: 17 cost time: 7.393084526062012
Epoch: 17, Steps: 265 | Train Loss: 0.1194368 Vali Loss: 0.5225821 Test Loss: 0.3444655
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1279136
	speed: 0.1297s/iter; left time: 2840.9372s
	iters: 200, epoch: 18 | loss: 0.1101416
	speed: 0.0240s/iter; left time: 523.5613s
Epoch: 18 cost time: 6.9945080280303955
Epoch: 18, Steps: 265 | Train Loss: 0.1193578 Vali Loss: 0.5232311 Test Loss: 0.3440060
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1123581
	speed: 0.1367s/iter; left time: 2957.2121s
	iters: 200, epoch: 19 | loss: 0.1306406
	speed: 0.0637s/iter; left time: 1371.5750s
Epoch: 19 cost time: 16.6167631149292
Epoch: 19, Steps: 265 | Train Loss: 0.1192404 Vali Loss: 0.5224352 Test Loss: 0.3438472
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1169166
	speed: 0.2134s/iter; left time: 4558.8661s
	iters: 200, epoch: 20 | loss: 0.1135641
	speed: 0.0200s/iter; left time: 425.9698s
Epoch: 20 cost time: 7.205580711364746
Epoch: 20, Steps: 265 | Train Loss: 0.1192500 Vali Loss: 0.5221310 Test Loss: 0.3438577
Validation loss decreased (0.522420 --> 0.522131).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1155943
	speed: 0.1079s/iter; left time: 2276.5595s
	iters: 200, epoch: 21 | loss: 0.1207390
	speed: 0.0205s/iter; left time: 431.1803s
Epoch: 21 cost time: 6.117860317230225
Epoch: 21, Steps: 265 | Train Loss: 0.1191841 Vali Loss: 0.5213984 Test Loss: 0.3434124
Validation loss decreased (0.522131 --> 0.521398).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1128630
	speed: 0.1223s/iter; left time: 2548.8197s
	iters: 200, epoch: 22 | loss: 0.1271567
	speed: 0.0221s/iter; left time: 459.0860s
Epoch: 22 cost time: 7.5546956062316895
Epoch: 22, Steps: 265 | Train Loss: 0.1192048 Vali Loss: 0.5228791 Test Loss: 0.3433488
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1172118
	speed: 0.1449s/iter; left time: 2980.0460s
	iters: 200, epoch: 23 | loss: 0.1230741
	speed: 0.0250s/iter; left time: 512.4495s
Epoch: 23 cost time: 9.515414476394653
Epoch: 23, Steps: 265 | Train Loss: 0.1191636 Vali Loss: 0.5219353 Test Loss: 0.3430265
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1109836
	speed: 0.1463s/iter; left time: 2971.4426s
	iters: 200, epoch: 24 | loss: 0.1135161
	speed: 0.0207s/iter; left time: 418.5402s
Epoch: 24 cost time: 7.352024078369141
Epoch: 24, Steps: 265 | Train Loss: 0.1191760 Vali Loss: 0.5215935 Test Loss: 0.3429685
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1382900
	speed: 0.1638s/iter; left time: 3282.0975s
	iters: 200, epoch: 25 | loss: 0.1193931
	speed: 0.0358s/iter; left time: 713.6602s
Epoch: 25 cost time: 10.420041561126709
Epoch: 25, Steps: 265 | Train Loss: 0.1191786 Vali Loss: 0.5213557 Test Loss: 0.3429368
Validation loss decreased (0.521398 --> 0.521356).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1200689
	speed: 0.1054s/iter; left time: 2085.0141s
	iters: 200, epoch: 26 | loss: 0.1103950
	speed: 0.0245s/iter; left time: 481.9046s
Epoch: 26 cost time: 6.399737596511841
Epoch: 26, Steps: 265 | Train Loss: 0.1191529 Vali Loss: 0.5218019 Test Loss: 0.3430139
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1186815
	speed: 0.1022s/iter; left time: 1994.7704s
	iters: 200, epoch: 27 | loss: 0.1217357
	speed: 0.0244s/iter; left time: 474.2181s
Epoch: 27 cost time: 7.291742324829102
Epoch: 27, Steps: 265 | Train Loss: 0.1191596 Vali Loss: 0.5215347 Test Loss: 0.3428665
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1140718
	speed: 0.1155s/iter; left time: 2222.1804s
	iters: 200, epoch: 28 | loss: 0.1178200
	speed: 0.0425s/iter; left time: 814.6332s
Epoch: 28 cost time: 9.608657360076904
Epoch: 28, Steps: 265 | Train Loss: 0.1191680 Vali Loss: 0.5216206 Test Loss: 0.3429358
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1231187
	speed: 0.1511s/iter; left time: 2868.7972s
	iters: 200, epoch: 29 | loss: 0.1255230
	speed: 0.0290s/iter; left time: 548.1370s
Epoch: 29 cost time: 9.355703353881836
Epoch: 29, Steps: 265 | Train Loss: 0.1191103 Vali Loss: 0.5213818 Test Loss: 0.3429841
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1179094
	speed: 0.1423s/iter; left time: 2663.8547s
	iters: 200, epoch: 30 | loss: 0.1198417
	speed: 0.0277s/iter; left time: 515.0217s
Epoch: 30 cost time: 7.88480544090271
Epoch: 30, Steps: 265 | Train Loss: 0.1191673 Vali Loss: 0.5214986 Test Loss: 0.3428608
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1244629
	speed: 0.1170s/iter; left time: 2158.9800s
	iters: 200, epoch: 31 | loss: 0.1144991
	speed: 0.0218s/iter; left time: 399.6446s
Epoch: 31 cost time: 6.997922897338867
Epoch: 31, Steps: 265 | Train Loss: 0.1191374 Vali Loss: 0.5218478 Test Loss: 0.3429621
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1147744
	speed: 0.1070s/iter; left time: 1946.0879s
	iters: 200, epoch: 32 | loss: 0.1096213
	speed: 0.0216s/iter; left time: 391.0779s
Epoch: 32 cost time: 7.536607503890991
Epoch: 32, Steps: 265 | Train Loss: 0.1191597 Vali Loss: 0.5219917 Test Loss: 0.3428823
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1171340
	speed: 0.1109s/iter; left time: 1987.2596s
	iters: 200, epoch: 33 | loss: 0.1104919
	speed: 0.0174s/iter; left time: 309.3277s
Epoch: 33 cost time: 5.663115501403809
Epoch: 33, Steps: 265 | Train Loss: 0.1191402 Vali Loss: 0.5220228 Test Loss: 0.3429487
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1281478
	speed: 0.1111s/iter; left time: 1961.0626s
	iters: 200, epoch: 34 | loss: 0.1233556
	speed: 0.0236s/iter; left time: 414.5879s
Epoch: 34 cost time: 8.196842193603516
Epoch: 34, Steps: 265 | Train Loss: 0.1191524 Vali Loss: 0.5216000 Test Loss: 0.3429522
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1166833
	speed: 0.1474s/iter; left time: 2564.1720s
	iters: 200, epoch: 35 | loss: 0.1191251
	speed: 0.0367s/iter; left time: 634.0042s
Epoch: 35 cost time: 9.691653728485107
Epoch: 35, Steps: 265 | Train Loss: 0.1191078 Vali Loss: 0.5218359 Test Loss: 0.3429165
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1144398
	speed: 0.2232s/iter; left time: 3822.0900s
	iters: 200, epoch: 36 | loss: 0.1147594
	speed: 0.0311s/iter; left time: 529.8685s
Epoch: 36 cost time: 12.696141958236694
Epoch: 36, Steps: 265 | Train Loss: 0.1191410 Vali Loss: 0.5216749 Test Loss: 0.3428860
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1158130
	speed: 0.1553s/iter; left time: 2617.7261s
	iters: 200, epoch: 37 | loss: 0.1231612
	speed: 0.0371s/iter; left time: 622.4089s
Epoch: 37 cost time: 9.154006242752075
Epoch: 37, Steps: 265 | Train Loss: 0.1191573 Vali Loss: 0.5221918 Test Loss: 0.3429444
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1210147
	speed: 0.1446s/iter; left time: 2400.3150s
	iters: 200, epoch: 38 | loss: 0.1154128
	speed: 0.0279s/iter; left time: 459.5517s
Epoch: 38 cost time: 10.048163175582886
Epoch: 38, Steps: 265 | Train Loss: 0.1191237 Vali Loss: 0.5222535 Test Loss: 0.3429306
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1081984
	speed: 0.1371s/iter; left time: 2239.0681s
	iters: 200, epoch: 39 | loss: 0.1216355
	speed: 0.0269s/iter; left time: 435.8818s
Epoch: 39 cost time: 7.320967435836792
Epoch: 39, Steps: 265 | Train Loss: 0.1191177 Vali Loss: 0.5219460 Test Loss: 0.3428260
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1224025
	speed: 0.1164s/iter; left time: 1870.5110s
	iters: 200, epoch: 40 | loss: 0.1159184
	speed: 0.0212s/iter; left time: 339.0622s
Epoch: 40 cost time: 6.150778770446777
Epoch: 40, Steps: 265 | Train Loss: 0.1191428 Vali Loss: 0.5217733 Test Loss: 0.3428920
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1269467
	speed: 0.1131s/iter; left time: 1787.8140s
	iters: 200, epoch: 41 | loss: 0.1289928
	speed: 0.0354s/iter; left time: 555.4345s
Epoch: 41 cost time: 8.839450597763062
Epoch: 41, Steps: 265 | Train Loss: 0.1191394 Vali Loss: 0.5218132 Test Loss: 0.3428338
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1265111
	speed: 0.1190s/iter; left time: 1849.2721s
	iters: 200, epoch: 42 | loss: 0.1261449
	speed: 0.0372s/iter; left time: 574.8517s
Epoch: 42 cost time: 8.666635751724243
Epoch: 42, Steps: 265 | Train Loss: 0.1191409 Vali Loss: 0.5214164 Test Loss: 0.3428563
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1156232
	speed: 0.1344s/iter; left time: 2052.0888s
	iters: 200, epoch: 43 | loss: 0.1267675
	speed: 0.0398s/iter; left time: 603.5205s
Epoch: 43 cost time: 9.349722146987915
Epoch: 43, Steps: 265 | Train Loss: 0.1191341 Vali Loss: 0.5218122 Test Loss: 0.3429379
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1171929
	speed: 0.1330s/iter; left time: 1995.9594s
	iters: 200, epoch: 44 | loss: 0.1159863
	speed: 0.0175s/iter; left time: 261.1094s
Epoch: 44 cost time: 6.3304877281188965
Epoch: 44, Steps: 265 | Train Loss: 0.1191276 Vali Loss: 0.5222434 Test Loss: 0.3428981
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1141076
	speed: 0.1401s/iter; left time: 2065.4893s
	iters: 200, epoch: 45 | loss: 0.1106079
	speed: 0.0279s/iter; left time: 407.7741s
Epoch: 45 cost time: 7.78613805770874
Epoch: 45, Steps: 265 | Train Loss: 0.1191059 Vali Loss: 0.5221961 Test Loss: 0.3428430
EarlyStopping counter: 20 out of 20
Early stopping
train 34009
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=58, out_features=88, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4573184.0
params:  5192.0
Trainable parameters:  5192
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3005760
	speed: 0.0306s/iter; left time: 808.6603s
	iters: 200, epoch: 1 | loss: 0.2800858
	speed: 0.0271s/iter; left time: 713.5273s
Epoch: 1 cost time: 7.511204957962036
Epoch: 1, Steps: 265 | Train Loss: 0.3095728 Vali Loss: 0.5131839 Test Loss: 0.3389932
Validation loss decreased (inf --> 0.513184).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3122479
	speed: 0.1204s/iter; left time: 3145.5977s
	iters: 200, epoch: 2 | loss: 0.3350863
	speed: 0.0228s/iter; left time: 594.1366s
Epoch: 2 cost time: 6.620883464813232
Epoch: 2, Steps: 265 | Train Loss: 0.3082117 Vali Loss: 0.5106322 Test Loss: 0.3377811
Validation loss decreased (0.513184 --> 0.510632).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2866580
	speed: 0.1247s/iter; left time: 3226.0776s
	iters: 200, epoch: 3 | loss: 0.3101457
	speed: 0.0298s/iter; left time: 768.7438s
Epoch: 3 cost time: 9.254806756973267
Epoch: 3, Steps: 265 | Train Loss: 0.3077695 Vali Loss: 0.5110459 Test Loss: 0.3374319
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3251448
	speed: 0.1193s/iter; left time: 3055.1869s
	iters: 200, epoch: 4 | loss: 0.2944336
	speed: 0.0264s/iter; left time: 673.5817s
Epoch: 4 cost time: 7.292021751403809
Epoch: 4, Steps: 265 | Train Loss: 0.3073593 Vali Loss: 0.5094426 Test Loss: 0.3369222
Validation loss decreased (0.510632 --> 0.509443).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2940500
	speed: 0.1208s/iter; left time: 3061.6146s
	iters: 200, epoch: 5 | loss: 0.3032860
	speed: 0.0230s/iter; left time: 581.1637s
Epoch: 5 cost time: 6.943957805633545
Epoch: 5, Steps: 265 | Train Loss: 0.3072252 Vali Loss: 0.5095467 Test Loss: 0.3369130
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3137320
	speed: 0.1336s/iter; left time: 3351.0224s
	iters: 200, epoch: 6 | loss: 0.2984300
	speed: 0.0330s/iter; left time: 824.3819s
Epoch: 6 cost time: 11.087286233901978
Epoch: 6, Steps: 265 | Train Loss: 0.3068607 Vali Loss: 0.5093240 Test Loss: 0.3364535
Validation loss decreased (0.509443 --> 0.509324).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3192382
	speed: 0.2302s/iter; left time: 5710.4623s
	iters: 200, epoch: 7 | loss: 0.2862056
	speed: 0.0336s/iter; left time: 829.9224s
Epoch: 7 cost time: 9.637831926345825
Epoch: 7, Steps: 265 | Train Loss: 0.3069939 Vali Loss: 0.5097523 Test Loss: 0.3366585
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2919087
	speed: 0.1415s/iter; left time: 3473.8462s
	iters: 200, epoch: 8 | loss: 0.2960821
	speed: 0.0330s/iter; left time: 806.2626s
Epoch: 8 cost time: 8.712110757827759
Epoch: 8, Steps: 265 | Train Loss: 0.3069044 Vali Loss: 0.5082340 Test Loss: 0.3368732
Validation loss decreased (0.509324 --> 0.508234).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2650508
	speed: 0.1203s/iter; left time: 2920.9133s
	iters: 200, epoch: 9 | loss: 0.2806189
	speed: 0.0205s/iter; left time: 496.1582s
Epoch: 9 cost time: 6.243152618408203
Epoch: 9, Steps: 265 | Train Loss: 0.3067762 Vali Loss: 0.5095665 Test Loss: 0.3369641
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3290723
	speed: 0.0957s/iter; left time: 2298.6626s
	iters: 200, epoch: 10 | loss: 0.3147338
	speed: 0.0228s/iter; left time: 545.3005s
Epoch: 10 cost time: 6.018955230712891
Epoch: 10, Steps: 265 | Train Loss: 0.3068131 Vali Loss: 0.5089669 Test Loss: 0.3369737
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2897150
	speed: 0.0963s/iter; left time: 2288.0118s
	iters: 200, epoch: 11 | loss: 0.3079242
	speed: 0.0197s/iter; left time: 465.9582s
Epoch: 11 cost time: 5.968520641326904
Epoch: 11, Steps: 265 | Train Loss: 0.3067342 Vali Loss: 0.5087626 Test Loss: 0.3368548
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3045873
	speed: 0.1314s/iter; left time: 3085.4859s
	iters: 200, epoch: 12 | loss: 0.3306184
	speed: 0.0308s/iter; left time: 719.8222s
Epoch: 12 cost time: 9.082957029342651
Epoch: 12, Steps: 265 | Train Loss: 0.3067925 Vali Loss: 0.5086982 Test Loss: 0.3370098
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2574964
	speed: 0.1251s/iter; left time: 2905.5071s
	iters: 200, epoch: 13 | loss: 0.3090033
	speed: 0.0306s/iter; left time: 707.4298s
Epoch: 13 cost time: 8.510493755340576
Epoch: 13, Steps: 265 | Train Loss: 0.3066416 Vali Loss: 0.5081725 Test Loss: 0.3366522
Validation loss decreased (0.508234 --> 0.508172).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3088994
	speed: 0.1183s/iter; left time: 2715.4761s
	iters: 200, epoch: 14 | loss: 0.3182303
	speed: 0.0221s/iter; left time: 504.9223s
Epoch: 14 cost time: 6.796092987060547
Epoch: 14, Steps: 265 | Train Loss: 0.3067034 Vali Loss: 0.5090606 Test Loss: 0.3369480
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2805999
	speed: 0.1069s/iter; left time: 2424.6082s
	iters: 200, epoch: 15 | loss: 0.3299823
	speed: 0.0280s/iter; left time: 632.4366s
Epoch: 15 cost time: 7.37686824798584
Epoch: 15, Steps: 265 | Train Loss: 0.3066079 Vali Loss: 0.5081868 Test Loss: 0.3370384
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3598477
	speed: 0.1165s/iter; left time: 2612.6702s
	iters: 200, epoch: 16 | loss: 0.2768387
	speed: 0.0206s/iter; left time: 459.0334s
Epoch: 16 cost time: 7.284669637680054
Epoch: 16, Steps: 265 | Train Loss: 0.3065736 Vali Loss: 0.5085397 Test Loss: 0.3368040
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2929271
	speed: 0.1457s/iter; left time: 3229.8862s
	iters: 200, epoch: 17 | loss: 0.2945400
	speed: 0.0284s/iter; left time: 627.5934s
Epoch: 17 cost time: 8.364839792251587
Epoch: 17, Steps: 265 | Train Loss: 0.3065473 Vali Loss: 0.5084894 Test Loss: 0.3370101
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2890260
	speed: 0.1311s/iter; left time: 2870.4048s
	iters: 200, epoch: 18 | loss: 0.3323735
	speed: 0.0269s/iter; left time: 586.7297s
Epoch: 18 cost time: 7.79764461517334
Epoch: 18, Steps: 265 | Train Loss: 0.3066349 Vali Loss: 0.5087996 Test Loss: 0.3368526
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3059497
	speed: 0.1151s/iter; left time: 2489.4653s
	iters: 200, epoch: 19 | loss: 0.3135450
	speed: 0.0271s/iter; left time: 583.9196s
Epoch: 19 cost time: 7.3789002895355225
Epoch: 19, Steps: 265 | Train Loss: 0.3065274 Vali Loss: 0.5086666 Test Loss: 0.3366780
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3002118
	speed: 0.1054s/iter; left time: 2252.3286s
	iters: 200, epoch: 20 | loss: 0.3208286
	speed: 0.0286s/iter; left time: 607.5315s
Epoch: 20 cost time: 6.945060729980469
Epoch: 20, Steps: 265 | Train Loss: 0.3065726 Vali Loss: 0.5085515 Test Loss: 0.3368045
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3114935
	speed: 0.1115s/iter; left time: 2353.7709s
	iters: 200, epoch: 21 | loss: 0.2656368
	speed: 0.0216s/iter; left time: 454.5660s
Epoch: 21 cost time: 6.694416522979736
Epoch: 21, Steps: 265 | Train Loss: 0.3065706 Vali Loss: 0.5084339 Test Loss: 0.3369454
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3051341
	speed: 0.1312s/iter; left time: 2732.8941s
	iters: 200, epoch: 22 | loss: 0.2903972
	speed: 0.0280s/iter; left time: 580.0047s
Epoch: 22 cost time: 7.197658538818359
Epoch: 22, Steps: 265 | Train Loss: 0.3064978 Vali Loss: 0.5082941 Test Loss: 0.3367929
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2910101
	speed: 0.1316s/iter; left time: 2707.5787s
	iters: 200, epoch: 23 | loss: 0.3166257
	speed: 0.0418s/iter; left time: 855.5866s
Epoch: 23 cost time: 11.788353681564331
Epoch: 23, Steps: 265 | Train Loss: 0.3065048 Vali Loss: 0.5086710 Test Loss: 0.3367740
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2948150
	speed: 0.2379s/iter; left time: 4830.3486s
	iters: 200, epoch: 24 | loss: 0.3113007
	speed: 0.0293s/iter; left time: 592.9473s
Epoch: 24 cost time: 10.114123582839966
Epoch: 24, Steps: 265 | Train Loss: 0.3064745 Vali Loss: 0.5084067 Test Loss: 0.3366417
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2801401
	speed: 0.1149s/iter; left time: 2302.4873s
	iters: 200, epoch: 25 | loss: 0.2879426
	speed: 0.0229s/iter; left time: 456.7292s
Epoch: 25 cost time: 6.493085622787476
Epoch: 25, Steps: 265 | Train Loss: 0.3065138 Vali Loss: 0.5081818 Test Loss: 0.3367549
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3097293
	speed: 0.1110s/iter; left time: 2195.3788s
	iters: 200, epoch: 26 | loss: 0.2868216
	speed: 0.0287s/iter; left time: 565.5286s
Epoch: 26 cost time: 7.068009376525879
Epoch: 26, Steps: 265 | Train Loss: 0.3065556 Vali Loss: 0.5083342 Test Loss: 0.3367785
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3141930
	speed: 0.1057s/iter; left time: 2062.3960s
	iters: 200, epoch: 27 | loss: 0.2858392
	speed: 0.0397s/iter; left time: 770.3697s
Epoch: 27 cost time: 7.764266014099121
Epoch: 27, Steps: 265 | Train Loss: 0.3063953 Vali Loss: 0.5089786 Test Loss: 0.3365012
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2927017
	speed: 0.1411s/iter; left time: 2716.4594s
	iters: 200, epoch: 28 | loss: 0.2963145
	speed: 0.0275s/iter; left time: 525.7844s
Epoch: 28 cost time: 7.906831502914429
Epoch: 28, Steps: 265 | Train Loss: 0.3064713 Vali Loss: 0.5087839 Test Loss: 0.3365955
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3382609
	speed: 0.1234s/iter; left time: 2342.6492s
	iters: 200, epoch: 29 | loss: 0.2928363
	speed: 0.0211s/iter; left time: 399.0620s
Epoch: 29 cost time: 6.807856559753418
Epoch: 29, Steps: 265 | Train Loss: 0.3064694 Vali Loss: 0.5081860 Test Loss: 0.3366105
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3071520
	speed: 0.1278s/iter; left time: 2392.0387s
	iters: 200, epoch: 30 | loss: 0.2895263
	speed: 0.0206s/iter; left time: 384.2719s
Epoch: 30 cost time: 7.5349647998809814
Epoch: 30, Steps: 265 | Train Loss: 0.3064808 Vali Loss: 0.5085554 Test Loss: 0.3365879
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2967053
	speed: 0.1164s/iter; left time: 2147.9473s
	iters: 200, epoch: 31 | loss: 0.2965879
	speed: 0.0264s/iter; left time: 484.6997s
Epoch: 31 cost time: 7.054920196533203
Epoch: 31, Steps: 265 | Train Loss: 0.3063884 Vali Loss: 0.5086750 Test Loss: 0.3366218
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3244592
	speed: 0.1247s/iter; left time: 2267.3206s
	iters: 200, epoch: 32 | loss: 0.2999611
	speed: 0.0261s/iter; left time: 471.6082s
Epoch: 32 cost time: 7.246820688247681
Epoch: 32, Steps: 265 | Train Loss: 0.3064138 Vali Loss: 0.5085502 Test Loss: 0.3366987
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2940438
	speed: 0.1181s/iter; left time: 2116.3466s
	iters: 200, epoch: 33 | loss: 0.2762085
	speed: 0.0231s/iter; left time: 411.6633s
Epoch: 33 cost time: 7.273255109786987
Epoch: 33, Steps: 265 | Train Loss: 0.3063803 Vali Loss: 0.5090175 Test Loss: 0.3367367
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_192_FITS_ETTm1_ftM_sl360_ll48_pl192_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.33759865164756775, mae:0.36542680859565735, rse:0.5530977249145508, corr:[0.54324883 0.55298084 0.5546331  0.5534751  0.5534743  0.5548559
 0.55608654 0.55616325 0.5555602  0.5554529  0.5564084  0.55751675
 0.5579154  0.5573665  0.5562666  0.55506164 0.5539807  0.55298793
 0.5518125  0.5505151  0.5491877  0.5480665  0.54698753 0.5459566
 0.5448699  0.54360974 0.5424612  0.5416781  0.5412426  0.5409448
 0.54092145 0.5412284  0.5416513  0.54197896 0.5420214  0.54190814
 0.54162925 0.54121065 0.5408491  0.5406683  0.54065126 0.5405881
 0.5403396  0.54002404 0.5397233  0.539552   0.53955495 0.539482
 0.53917485 0.5388325  0.53859496 0.5385493  0.5387043  0.53884417
 0.5388372  0.53871244 0.53850836 0.53832316 0.53823644 0.5380581
 0.53787625 0.5376475  0.5374934  0.53739816 0.5375072  0.53778756
 0.53806454 0.53824246 0.5385457  0.53893405 0.53935367 0.5396481
 0.5397844  0.53972894 0.53948474 0.53916925 0.53899586 0.5390478
 0.53920287 0.5392646  0.53911155 0.5387531  0.538279   0.53778404
 0.5374166  0.53708553 0.53681886 0.5365334  0.53627735 0.53624845
 0.536445   0.53666425 0.53671765 0.5365887  0.53625697 0.5357675
 0.5352337  0.53472173 0.5342275  0.53369766 0.5333001  0.5331252
 0.5331203  0.53308386 0.5331419  0.53334206 0.53357744 0.5339459
 0.5342318  0.5344817  0.5346096  0.53466195 0.5346462  0.5347065
 0.5347686  0.5347829  0.5346784  0.53452075 0.5344073  0.53457963
 0.53492737 0.5351466  0.5351361  0.53501374 0.53482145 0.53457403
 0.534372   0.5342662  0.53418607 0.5340827  0.53393304 0.53371984
 0.5335159  0.5332525  0.5330072  0.5327534  0.5325432  0.53233916
 0.53226477 0.53229064 0.53230953 0.5323409  0.5323282  0.5322824
 0.5321942  0.53211707 0.5320559  0.53210324 0.5323437  0.532573
 0.5326978  0.5326887  0.53238577 0.5318753  0.53143376 0.5313397
 0.5315748  0.5318878  0.5319625  0.5317407  0.5314097  0.53117615
 0.5312208  0.53145546 0.53175104 0.53190637 0.5318565  0.5318784
 0.5321295  0.5326153  0.53311867 0.53339493 0.5332539  0.53294474
 0.532793   0.53301376 0.5333856  0.5335632  0.5332652  0.53275913
 0.53235024 0.5323625  0.5325164  0.53254235 0.5322925  0.53204715
 0.5321459  0.53270656 0.5332747  0.53337145 0.53287446 0.5322094 ]
