Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=38, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=38, out_features=58, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1974784.0
params:  2262.0
Trainable parameters:  2262
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3843430
	speed: 0.0149s/iter; left time: 396.9081s
	iters: 200, epoch: 1 | loss: 0.3275841
	speed: 0.0104s/iter; left time: 274.9631s
Epoch: 1 cost time: 3.284205436706543
Epoch: 1, Steps: 267 | Train Loss: 0.3988155 Vali Loss: 0.4719325 Test Loss: 0.3652410
Validation loss decreased (inf --> 0.471933).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2800311
	speed: 0.0528s/iter; left time: 1389.9742s
	iters: 200, epoch: 2 | loss: 0.3069983
	speed: 0.0108s/iter; left time: 283.5811s
Epoch: 2 cost time: 3.53344464302063
Epoch: 2, Steps: 267 | Train Loss: 0.3083429 Vali Loss: 0.4238800 Test Loss: 0.3230644
Validation loss decreased (0.471933 --> 0.423880).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2622877
	speed: 0.0512s/iter; left time: 1333.9085s
	iters: 200, epoch: 3 | loss: 0.2740417
	speed: 0.0088s/iter; left time: 228.8157s
Epoch: 3 cost time: 2.931067943572998
Epoch: 3, Steps: 267 | Train Loss: 0.2969019 Vali Loss: 0.4124347 Test Loss: 0.3146827
Validation loss decreased (0.423880 --> 0.412435).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2921384
	speed: 0.0436s/iter; left time: 1125.2893s
	iters: 200, epoch: 4 | loss: 0.3068886
	speed: 0.0084s/iter; left time: 216.0276s
Epoch: 4 cost time: 2.70896315574646
Epoch: 4, Steps: 267 | Train Loss: 0.2936808 Vali Loss: 0.4081817 Test Loss: 0.3124933
Validation loss decreased (0.412435 --> 0.408182).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2687915
	speed: 0.0448s/iter; left time: 1142.8066s
	iters: 200, epoch: 5 | loss: 0.2839916
	speed: 0.0083s/iter; left time: 211.9057s
Epoch: 5 cost time: 2.895799160003662
Epoch: 5, Steps: 267 | Train Loss: 0.2923922 Vali Loss: 0.4053266 Test Loss: 0.3111402
Validation loss decreased (0.408182 --> 0.405327).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2784915
	speed: 0.0480s/iter; left time: 1212.9788s
	iters: 200, epoch: 6 | loss: 0.2585464
	speed: 0.0085s/iter; left time: 213.8256s
Epoch: 6 cost time: 2.7949507236480713
Epoch: 6, Steps: 267 | Train Loss: 0.2917306 Vali Loss: 0.4056298 Test Loss: 0.3106660
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2584279
	speed: 0.0425s/iter; left time: 1061.7155s
	iters: 200, epoch: 7 | loss: 0.3029690
	speed: 0.0084s/iter; left time: 209.2160s
Epoch: 7 cost time: 2.8112285137176514
Epoch: 7, Steps: 267 | Train Loss: 0.2912356 Vali Loss: 0.4039696 Test Loss: 0.3104716
Validation loss decreased (0.405327 --> 0.403970).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2722022
	speed: 0.0437s/iter; left time: 1080.3079s
	iters: 200, epoch: 8 | loss: 0.2973170
	speed: 0.0089s/iter; left time: 218.1700s
Epoch: 8 cost time: 2.888657569885254
Epoch: 8, Steps: 267 | Train Loss: 0.2908436 Vali Loss: 0.4034519 Test Loss: 0.3100376
Validation loss decreased (0.403970 --> 0.403452).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2813375
	speed: 0.0497s/iter; left time: 1216.2801s
	iters: 200, epoch: 9 | loss: 0.2951085
	speed: 0.0083s/iter; left time: 203.0052s
Epoch: 9 cost time: 2.7700793743133545
Epoch: 9, Steps: 267 | Train Loss: 0.2907044 Vali Loss: 0.4023400 Test Loss: 0.3092088
Validation loss decreased (0.403452 --> 0.402340).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2814991
	speed: 0.0450s/iter; left time: 1089.2660s
	iters: 200, epoch: 10 | loss: 0.3218859
	speed: 0.0071s/iter; left time: 172.2158s
Epoch: 10 cost time: 2.5195956230163574
Epoch: 10, Steps: 267 | Train Loss: 0.2905477 Vali Loss: 0.4023348 Test Loss: 0.3096268
Validation loss decreased (0.402340 --> 0.402335).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2715369
	speed: 0.0426s/iter; left time: 1018.9362s
	iters: 200, epoch: 11 | loss: 0.2648493
	speed: 0.0075s/iter; left time: 178.8564s
Epoch: 11 cost time: 2.6015303134918213
Epoch: 11, Steps: 267 | Train Loss: 0.2903644 Vali Loss: 0.4018096 Test Loss: 0.3099555
Validation loss decreased (0.402335 --> 0.401810).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3007729
	speed: 0.0473s/iter; left time: 1118.7965s
	iters: 200, epoch: 12 | loss: 0.2920989
	speed: 0.0083s/iter; left time: 196.1238s
Epoch: 12 cost time: 2.807823419570923
Epoch: 12, Steps: 267 | Train Loss: 0.2902450 Vali Loss: 0.4018118 Test Loss: 0.3091714
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3185498
	speed: 0.0458s/iter; left time: 1071.6602s
	iters: 200, epoch: 13 | loss: 0.2777890
	speed: 0.0087s/iter; left time: 202.7284s
Epoch: 13 cost time: 2.7995455265045166
Epoch: 13, Steps: 267 | Train Loss: 0.2901290 Vali Loss: 0.4019557 Test Loss: 0.3087728
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3350696
	speed: 0.0465s/iter; left time: 1075.4240s
	iters: 200, epoch: 14 | loss: 0.2615314
	speed: 0.0087s/iter; left time: 199.6934s
Epoch: 14 cost time: 3.046022653579712
Epoch: 14, Steps: 267 | Train Loss: 0.2901872 Vali Loss: 0.4018688 Test Loss: 0.3094386
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2845511
	speed: 0.0456s/iter; left time: 1042.7739s
	iters: 200, epoch: 15 | loss: 0.2883057
	speed: 0.0073s/iter; left time: 166.3343s
Epoch: 15 cost time: 2.5344090461730957
Epoch: 15, Steps: 267 | Train Loss: 0.2899992 Vali Loss: 0.4025739 Test Loss: 0.3097301
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3025303
	speed: 0.0412s/iter; left time: 929.8404s
	iters: 200, epoch: 16 | loss: 0.2634739
	speed: 0.0072s/iter; left time: 161.6054s
Epoch: 16 cost time: 2.4593210220336914
Epoch: 16, Steps: 267 | Train Loss: 0.2899569 Vali Loss: 0.4016522 Test Loss: 0.3092440
Validation loss decreased (0.401810 --> 0.401652).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2648933
	speed: 0.0403s/iter; left time: 899.2112s
	iters: 200, epoch: 17 | loss: 0.2833545
	speed: 0.0073s/iter; left time: 162.0052s
Epoch: 17 cost time: 2.4996511936187744
Epoch: 17, Steps: 267 | Train Loss: 0.2900520 Vali Loss: 0.4015004 Test Loss: 0.3093328
Validation loss decreased (0.401652 --> 0.401500).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2527745
	speed: 0.0421s/iter; left time: 929.2273s
	iters: 200, epoch: 18 | loss: 0.2857286
	speed: 0.0072s/iter; left time: 158.7943s
Epoch: 18 cost time: 2.513655185699463
Epoch: 18, Steps: 267 | Train Loss: 0.2899304 Vali Loss: 0.4012992 Test Loss: 0.3097070
Validation loss decreased (0.401500 --> 0.401299).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2753639
	speed: 0.0409s/iter; left time: 891.7739s
	iters: 200, epoch: 19 | loss: 0.2782149
	speed: 0.0083s/iter; left time: 179.7506s
Epoch: 19 cost time: 2.791246175765991
Epoch: 19, Steps: 267 | Train Loss: 0.2899036 Vali Loss: 0.4015219 Test Loss: 0.3089791
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2954747
	speed: 0.0442s/iter; left time: 952.4133s
	iters: 200, epoch: 20 | loss: 0.2807315
	speed: 0.0091s/iter; left time: 195.4832s
Epoch: 20 cost time: 2.8989644050598145
Epoch: 20, Steps: 267 | Train Loss: 0.2897491 Vali Loss: 0.4018961 Test Loss: 0.3092780
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2935522
	speed: 0.0455s/iter; left time: 966.7696s
	iters: 200, epoch: 21 | loss: 0.2957620
	speed: 0.0084s/iter; left time: 177.6518s
Epoch: 21 cost time: 2.8458681106567383
Epoch: 21, Steps: 267 | Train Loss: 0.2898227 Vali Loss: 0.4012471 Test Loss: 0.3093820
Validation loss decreased (0.401299 --> 0.401247).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2895142
	speed: 0.0443s/iter; left time: 930.6300s
	iters: 200, epoch: 22 | loss: 0.2575890
	speed: 0.0084s/iter; left time: 175.9736s
Epoch: 22 cost time: 2.8972997665405273
Epoch: 22, Steps: 267 | Train Loss: 0.2898091 Vali Loss: 0.4017194 Test Loss: 0.3091692
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2905163
	speed: 0.0469s/iter; left time: 971.6598s
	iters: 200, epoch: 23 | loss: 0.3020303
	speed: 0.0084s/iter; left time: 173.6071s
Epoch: 23 cost time: 2.775700092315674
Epoch: 23, Steps: 267 | Train Loss: 0.2897548 Vali Loss: 0.4016187 Test Loss: 0.3093578
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2761171
	speed: 0.0465s/iter; left time: 951.8333s
	iters: 200, epoch: 24 | loss: 0.2965856
	speed: 0.0073s/iter; left time: 148.0161s
Epoch: 24 cost time: 2.609158515930176
Epoch: 24, Steps: 267 | Train Loss: 0.2896751 Vali Loss: 0.4019885 Test Loss: 0.3093165
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3144085
	speed: 0.0413s/iter; left time: 833.8583s
	iters: 200, epoch: 25 | loss: 0.3042421
	speed: 0.0076s/iter; left time: 152.6017s
Epoch: 25 cost time: 2.5933878421783447
Epoch: 25, Steps: 267 | Train Loss: 0.2896579 Vali Loss: 0.4017635 Test Loss: 0.3090892
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2850909
	speed: 0.0420s/iter; left time: 837.3711s
	iters: 200, epoch: 26 | loss: 0.2604449
	speed: 0.0078s/iter; left time: 155.3837s
Epoch: 26 cost time: 2.6348180770874023
Epoch: 26, Steps: 267 | Train Loss: 0.2896955 Vali Loss: 0.4018045 Test Loss: 0.3092738
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2956079
	speed: 0.0431s/iter; left time: 847.8315s
	iters: 200, epoch: 27 | loss: 0.3064702
	speed: 0.0078s/iter; left time: 153.4254s
Epoch: 27 cost time: 2.7790656089782715
Epoch: 27, Steps: 267 | Train Loss: 0.2898012 Vali Loss: 0.4016446 Test Loss: 0.3092652
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2357143
	speed: 0.0452s/iter; left time: 876.6502s
	iters: 200, epoch: 28 | loss: 0.2923281
	speed: 0.0082s/iter; left time: 158.6057s
Epoch: 28 cost time: 2.823834180831909
Epoch: 28, Steps: 267 | Train Loss: 0.2896152 Vali Loss: 0.4019814 Test Loss: 0.3093397
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2587516
	speed: 0.0455s/iter; left time: 869.3422s
	iters: 200, epoch: 29 | loss: 0.2988912
	speed: 0.0079s/iter; left time: 151.0834s
Epoch: 29 cost time: 2.548567533493042
Epoch: 29, Steps: 267 | Train Loss: 0.2897536 Vali Loss: 0.4015068 Test Loss: 0.3091356
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2899921
	speed: 0.0474s/iter; left time: 894.3334s
	iters: 200, epoch: 30 | loss: 0.2930537
	speed: 0.0091s/iter; left time: 170.9631s
Epoch: 30 cost time: 2.9955368041992188
Epoch: 30, Steps: 267 | Train Loss: 0.2895565 Vali Loss: 0.4015329 Test Loss: 0.3090342
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2595152
	speed: 0.0466s/iter; left time: 866.1556s
	iters: 200, epoch: 31 | loss: 0.2797984
	speed: 0.0089s/iter; left time: 163.8591s
Epoch: 31 cost time: 2.9353299140930176
Epoch: 31, Steps: 267 | Train Loss: 0.2895458 Vali Loss: 0.4020284 Test Loss: 0.3092371
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2877617
	speed: 0.0460s/iter; left time: 843.6690s
	iters: 200, epoch: 32 | loss: 0.2915191
	speed: 0.0081s/iter; left time: 148.4483s
Epoch: 32 cost time: 2.940941095352173
Epoch: 32, Steps: 267 | Train Loss: 0.2894873 Vali Loss: 0.4012445 Test Loss: 0.3089134
Validation loss decreased (0.401247 --> 0.401245).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2673681
	speed: 0.0464s/iter; left time: 838.5429s
	iters: 200, epoch: 33 | loss: 0.2757143
	speed: 0.0073s/iter; left time: 131.0963s
Epoch: 33 cost time: 2.6494834423065186
Epoch: 33, Steps: 267 | Train Loss: 0.2895671 Vali Loss: 0.4015886 Test Loss: 0.3092804
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2858491
	speed: 0.0438s/iter; left time: 779.9928s
	iters: 200, epoch: 34 | loss: 0.2818372
	speed: 0.0072s/iter; left time: 127.3691s
Epoch: 34 cost time: 2.469268321990967
Epoch: 34, Steps: 267 | Train Loss: 0.2896262 Vali Loss: 0.4013521 Test Loss: 0.3090959
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2914087
	speed: 0.0412s/iter; left time: 721.7049s
	iters: 200, epoch: 35 | loss: 0.2589356
	speed: 0.0073s/iter; left time: 126.7593s
Epoch: 35 cost time: 2.5994699001312256
Epoch: 35, Steps: 267 | Train Loss: 0.2896547 Vali Loss: 0.4012084 Test Loss: 0.3090132
Validation loss decreased (0.401245 --> 0.401208).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3178898
	speed: 0.0449s/iter; left time: 775.4064s
	iters: 200, epoch: 36 | loss: 0.2651765
	speed: 0.0072s/iter; left time: 124.2939s
Epoch: 36 cost time: 2.596169948577881
Epoch: 36, Steps: 267 | Train Loss: 0.2895297 Vali Loss: 0.4017098 Test Loss: 0.3090504
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3261943
	speed: 0.0443s/iter; left time: 752.1385s
	iters: 200, epoch: 37 | loss: 0.2812051
	speed: 0.0086s/iter; left time: 145.3091s
Epoch: 37 cost time: 2.8832318782806396
Epoch: 37, Steps: 267 | Train Loss: 0.2895164 Vali Loss: 0.4014367 Test Loss: 0.3090979
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2724724
	speed: 0.0474s/iter; left time: 792.8921s
	iters: 200, epoch: 38 | loss: 0.2831835
	speed: 0.0084s/iter; left time: 139.4797s
Epoch: 38 cost time: 2.7264623641967773
Epoch: 38, Steps: 267 | Train Loss: 0.2894660 Vali Loss: 0.4016008 Test Loss: 0.3090007
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2964670
	speed: 0.0456s/iter; left time: 750.5649s
	iters: 200, epoch: 39 | loss: 0.2613224
	speed: 0.0085s/iter; left time: 138.9659s
Epoch: 39 cost time: 2.945556402206421
Epoch: 39, Steps: 267 | Train Loss: 0.2896265 Vali Loss: 0.4014819 Test Loss: 0.3089729
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3106586
	speed: 0.0439s/iter; left time: 710.4267s
	iters: 200, epoch: 40 | loss: 0.2893664
	speed: 0.0087s/iter; left time: 140.6943s
Epoch: 40 cost time: 2.793384075164795
Epoch: 40, Steps: 267 | Train Loss: 0.2894602 Vali Loss: 0.4015399 Test Loss: 0.3089831
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3000475
	speed: 0.0445s/iter; left time: 708.2263s
	iters: 200, epoch: 41 | loss: 0.2805829
	speed: 0.0075s/iter; left time: 119.0078s
Epoch: 41 cost time: 2.596953868865967
Epoch: 41, Steps: 267 | Train Loss: 0.2893685 Vali Loss: 0.4015647 Test Loss: 0.3090775
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2526920
	speed: 0.0420s/iter; left time: 657.3319s
	iters: 200, epoch: 42 | loss: 0.2842377
	speed: 0.0073s/iter; left time: 113.6284s
Epoch: 42 cost time: 2.609247922897339
Epoch: 42, Steps: 267 | Train Loss: 0.2894946 Vali Loss: 0.4014149 Test Loss: 0.3090079
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2746163
	speed: 0.0437s/iter; left time: 671.7878s
	iters: 200, epoch: 43 | loss: 0.2655634
	speed: 0.0077s/iter; left time: 117.8814s
Epoch: 43 cost time: 2.543926239013672
Epoch: 43, Steps: 267 | Train Loss: 0.2895891 Vali Loss: 0.4015228 Test Loss: 0.3090305
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2678749
	speed: 0.0424s/iter; left time: 641.2239s
	iters: 200, epoch: 44 | loss: 0.2803600
	speed: 0.0080s/iter; left time: 119.7572s
Epoch: 44 cost time: 2.655247688293457
Epoch: 44, Steps: 267 | Train Loss: 0.2894877 Vali Loss: 0.4010701 Test Loss: 0.3089907
Validation loss decreased (0.401208 --> 0.401070).  Saving model ...
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2994806
	speed: 0.0461s/iter; left time: 684.7173s
	iters: 200, epoch: 45 | loss: 0.2885543
	speed: 0.0084s/iter; left time: 124.4587s
Epoch: 45 cost time: 2.886650323867798
Epoch: 45, Steps: 267 | Train Loss: 0.2895480 Vali Loss: 0.4015752 Test Loss: 0.3089422
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3105394
	speed: 0.0428s/iter; left time: 624.4712s
	iters: 200, epoch: 46 | loss: 0.3699360
	speed: 0.0078s/iter; left time: 113.2147s
Epoch: 46 cost time: 2.670314073562622
Epoch: 46, Steps: 267 | Train Loss: 0.2895833 Vali Loss: 0.4012384 Test Loss: 0.3089815
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2909433
	speed: 0.0457s/iter; left time: 654.9518s
	iters: 200, epoch: 47 | loss: 0.2784588
	speed: 0.0082s/iter; left time: 115.9229s
Epoch: 47 cost time: 2.874238967895508
Epoch: 47, Steps: 267 | Train Loss: 0.2894777 Vali Loss: 0.4014431 Test Loss: 0.3090497
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2580704
	speed: 0.0461s/iter; left time: 647.3679s
	iters: 200, epoch: 48 | loss: 0.2965731
	speed: 0.0086s/iter; left time: 119.3870s
Epoch: 48 cost time: 2.836439609527588
Epoch: 48, Steps: 267 | Train Loss: 0.2895611 Vali Loss: 0.4013063 Test Loss: 0.3090037
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2954472
	speed: 0.0477s/iter; left time: 656.9266s
	iters: 200, epoch: 49 | loss: 0.2950075
	speed: 0.0085s/iter; left time: 116.9147s
Epoch: 49 cost time: 2.9621620178222656
Epoch: 49, Steps: 267 | Train Loss: 0.2894351 Vali Loss: 0.4013825 Test Loss: 0.3090863
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2871092
	speed: 0.0456s/iter; left time: 616.6208s
	iters: 200, epoch: 50 | loss: 0.2777824
	speed: 0.0082s/iter; left time: 110.4987s
Epoch: 50 cost time: 2.8330612182617188
Epoch: 50, Steps: 267 | Train Loss: 0.2895109 Vali Loss: 0.4012802 Test Loss: 0.3090243
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2792024
	speed: 0.0411s/iter; left time: 545.1402s
	iters: 200, epoch: 51 | loss: 0.3078054
	speed: 0.0074s/iter; left time: 97.6146s
Epoch: 51 cost time: 2.594299554824829
Epoch: 51, Steps: 267 | Train Loss: 0.2893534 Vali Loss: 0.4013854 Test Loss: 0.3090745
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2971539
	speed: 0.0468s/iter; left time: 607.6747s
	iters: 200, epoch: 52 | loss: 0.3178601
	speed: 0.0086s/iter; left time: 111.1362s
Epoch: 52 cost time: 2.882310628890991
Epoch: 52, Steps: 267 | Train Loss: 0.2895516 Vali Loss: 0.4010959 Test Loss: 0.3090682
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2860779
	speed: 0.0431s/iter; left time: 547.7001s
	iters: 200, epoch: 53 | loss: 0.3031591
	speed: 0.0080s/iter; left time: 101.4004s
Epoch: 53 cost time: 2.667833089828491
Epoch: 53, Steps: 267 | Train Loss: 0.2893963 Vali Loss: 0.4015867 Test Loss: 0.3090675
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.3309889
	speed: 0.0480s/iter; left time: 597.5038s
	iters: 200, epoch: 54 | loss: 0.3193152
	speed: 0.0086s/iter; left time: 105.7588s
Epoch: 54 cost time: 2.857329845428467
Epoch: 54, Steps: 267 | Train Loss: 0.2894018 Vali Loss: 0.4012577 Test Loss: 0.3090523
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2530330
	speed: 0.0441s/iter; left time: 536.9817s
	iters: 200, epoch: 55 | loss: 0.2961527
	speed: 0.0091s/iter; left time: 109.7601s
Epoch: 55 cost time: 2.927964925765991
Epoch: 55, Steps: 267 | Train Loss: 0.2895470 Vali Loss: 0.4012495 Test Loss: 0.3090301
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2765968
	speed: 0.0488s/iter; left time: 581.4152s
	iters: 200, epoch: 56 | loss: 0.3013951
	speed: 0.0088s/iter; left time: 104.1747s
Epoch: 56 cost time: 2.8847062587738037
Epoch: 56, Steps: 267 | Train Loss: 0.2893477 Vali Loss: 0.4015451 Test Loss: 0.3090071
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2860629
	speed: 0.0490s/iter; left time: 570.8444s
	iters: 200, epoch: 57 | loss: 0.2898664
	speed: 0.0086s/iter; left time: 99.4374s
Epoch: 57 cost time: 2.845069169998169
Epoch: 57, Steps: 267 | Train Loss: 0.2894716 Vali Loss: 0.4016910 Test Loss: 0.3090005
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2873999
	speed: 0.0482s/iter; left time: 548.2868s
	iters: 200, epoch: 58 | loss: 0.2829307
	speed: 0.0089s/iter; left time: 100.9173s
Epoch: 58 cost time: 3.0530052185058594
Epoch: 58, Steps: 267 | Train Loss: 0.2895282 Vali Loss: 0.4007624 Test Loss: 0.3089883
Validation loss decreased (0.401070 --> 0.400762).  Saving model ...
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2844992
	speed: 0.0481s/iter; left time: 534.6310s
	iters: 200, epoch: 59 | loss: 0.2876948
	speed: 0.0080s/iter; left time: 88.1204s
Epoch: 59 cost time: 2.676520824432373
Epoch: 59, Steps: 267 | Train Loss: 0.2893039 Vali Loss: 0.4014357 Test Loss: 0.3090336
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.3047554
	speed: 0.0450s/iter; left time: 487.9226s
	iters: 200, epoch: 60 | loss: 0.3077483
	speed: 0.0072s/iter; left time: 77.5749s
Epoch: 60 cost time: 3.062708854675293
Epoch: 60, Steps: 267 | Train Loss: 0.2894395 Vali Loss: 0.4013218 Test Loss: 0.3090065
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.3108914
	speed: 0.0505s/iter; left time: 533.8587s
	iters: 200, epoch: 61 | loss: 0.2829241
	speed: 0.0073s/iter; left time: 76.8231s
Epoch: 61 cost time: 2.4734644889831543
Epoch: 61, Steps: 267 | Train Loss: 0.2894763 Vali Loss: 0.4012887 Test Loss: 0.3090133
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3184337
	speed: 0.0477s/iter; left time: 492.0683s
	iters: 200, epoch: 62 | loss: 0.3205654
	speed: 0.0093s/iter; left time: 94.9576s
Epoch: 62 cost time: 3.222860336303711
Epoch: 62, Steps: 267 | Train Loss: 0.2894189 Vali Loss: 0.4017241 Test Loss: 0.3090048
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2952464
	speed: 0.0458s/iter; left time: 460.6043s
	iters: 200, epoch: 63 | loss: 0.3010774
	speed: 0.0081s/iter; left time: 80.6305s
Epoch: 63 cost time: 2.7215735912323
Epoch: 63, Steps: 267 | Train Loss: 0.2893791 Vali Loss: 0.4011224 Test Loss: 0.3090069
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.3026347
	speed: 0.0461s/iter; left time: 450.8212s
	iters: 200, epoch: 64 | loss: 0.2669001
	speed: 0.0090s/iter; left time: 87.3622s
Epoch: 64 cost time: 2.9541280269622803
Epoch: 64, Steps: 267 | Train Loss: 0.2894403 Vali Loss: 0.4011554 Test Loss: 0.3090243
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2966197
	speed: 0.0434s/iter; left time: 412.5741s
	iters: 200, epoch: 65 | loss: 0.2920924
	speed: 0.0072s/iter; left time: 67.9777s
Epoch: 65 cost time: 2.5330944061279297
Epoch: 65, Steps: 267 | Train Loss: 0.2893698 Vali Loss: 0.4010734 Test Loss: 0.3090156
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.3158634
	speed: 0.0457s/iter; left time: 422.7549s
	iters: 200, epoch: 66 | loss: 0.2861588
	speed: 0.0084s/iter; left time: 76.7946s
Epoch: 66 cost time: 2.905198574066162
Epoch: 66, Steps: 267 | Train Loss: 0.2894163 Vali Loss: 0.4013489 Test Loss: 0.3089808
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2638266
	speed: 0.0488s/iter; left time: 438.5506s
	iters: 200, epoch: 67 | loss: 0.2947005
	speed: 0.0079s/iter; left time: 69.9818s
Epoch: 67 cost time: 2.8084497451782227
Epoch: 67, Steps: 267 | Train Loss: 0.2893868 Vali Loss: 0.4010898 Test Loss: 0.3089984
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2606732
	speed: 0.0474s/iter; left time: 413.1496s
	iters: 200, epoch: 68 | loss: 0.2886659
	speed: 0.0091s/iter; left time: 78.2822s
Epoch: 68 cost time: 3.0020999908447266
Epoch: 68, Steps: 267 | Train Loss: 0.2893377 Vali Loss: 0.4012321 Test Loss: 0.3090000
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2809182
	speed: 0.0444s/iter; left time: 374.9875s
	iters: 200, epoch: 69 | loss: 0.2899559
	speed: 0.0084s/iter; left time: 69.8298s
Epoch: 69 cost time: 2.9390861988067627
Epoch: 69, Steps: 267 | Train Loss: 0.2893702 Vali Loss: 0.4008985 Test Loss: 0.3090144
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2852730
	speed: 0.0471s/iter; left time: 384.9132s
	iters: 200, epoch: 70 | loss: 0.2757656
	speed: 0.0085s/iter; left time: 68.6898s
Epoch: 70 cost time: 3.010129928588867
Epoch: 70, Steps: 267 | Train Loss: 0.2894307 Vali Loss: 0.4012291 Test Loss: 0.3089957
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.3407761
	speed: 0.0515s/iter; left time: 407.0442s
	iters: 200, epoch: 71 | loss: 0.3033708
	speed: 0.0084s/iter; left time: 65.3619s
Epoch: 71 cost time: 3.3028039932250977
Epoch: 71, Steps: 267 | Train Loss: 0.2894724 Vali Loss: 0.4012384 Test Loss: 0.3090000
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2864723
	speed: 0.0466s/iter; left time: 355.9853s
	iters: 200, epoch: 72 | loss: 0.2930691
	speed: 0.0081s/iter; left time: 60.8937s
Epoch: 72 cost time: 2.7236175537109375
Epoch: 72, Steps: 267 | Train Loss: 0.2894738 Vali Loss: 0.4014827 Test Loss: 0.3090143
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.2683746
	speed: 0.0487s/iter; left time: 359.5625s
	iters: 200, epoch: 73 | loss: 0.2723824
	speed: 0.0079s/iter; left time: 57.2927s
Epoch: 73 cost time: 2.7089264392852783
Epoch: 73, Steps: 267 | Train Loss: 0.2893332 Vali Loss: 0.4013688 Test Loss: 0.3090201
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.3236216
	speed: 0.0426s/iter; left time: 303.2246s
	iters: 200, epoch: 74 | loss: 0.2972169
	speed: 0.0083s/iter; left time: 58.3560s
Epoch: 74 cost time: 2.9088573455810547
Epoch: 74, Steps: 267 | Train Loss: 0.2894497 Vali Loss: 0.4008814 Test Loss: 0.3090218
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2570789
	speed: 0.0458s/iter; left time: 313.7489s
	iters: 200, epoch: 75 | loss: 0.2928742
	speed: 0.0075s/iter; left time: 50.7588s
Epoch: 75 cost time: 2.613178253173828
Epoch: 75, Steps: 267 | Train Loss: 0.2894699 Vali Loss: 0.4012128 Test Loss: 0.3090207
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.2895463
	speed: 0.0438s/iter; left time: 288.1326s
	iters: 200, epoch: 76 | loss: 0.2669438
	speed: 0.0081s/iter; left time: 52.3386s
Epoch: 76 cost time: 2.7100894451141357
Epoch: 76, Steps: 267 | Train Loss: 0.2894480 Vali Loss: 0.4012338 Test Loss: 0.3090146
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.3087005
	speed: 0.0487s/iter; left time: 307.1762s
	iters: 200, epoch: 77 | loss: 0.3212555
	speed: 0.0095s/iter; left time: 59.2561s
Epoch: 77 cost time: 3.221641778945923
Epoch: 77, Steps: 267 | Train Loss: 0.2893578 Vali Loss: 0.4015066 Test Loss: 0.3090156
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2634561
	speed: 0.0427s/iter; left time: 257.7733s
	iters: 200, epoch: 78 | loss: 0.2673275
	speed: 0.0074s/iter; left time: 43.9333s
Epoch: 78 cost time: 2.632636308670044
Epoch: 78, Steps: 267 | Train Loss: 0.2893426 Vali Loss: 0.4014248 Test Loss: 0.3090020
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31129196286201477, mae:0.3478095829486847, rse:0.5309038162231445, corr:[0.5532743  0.55528015 0.55290675 0.5530374  0.5532961  0.55208135
 0.55096    0.5515029  0.55222535 0.5523316  0.552448   0.5527515
 0.55277306 0.55163735 0.5499311  0.54826105 0.5465192  0.54459035
 0.54264617 0.54087085 0.53914124 0.53713995 0.53482544 0.53233767
 0.5298222  0.5275359  0.52567047 0.5241003  0.52283436 0.5219988
 0.52186435 0.522201   0.52264047 0.52306634 0.52334523 0.52348065
 0.5232197  0.5226616  0.5223544  0.52232635 0.52241355 0.5222286
 0.521885   0.5218374  0.52207506 0.5222873  0.5223     0.52221435
 0.52231395 0.5225629  0.5227915  0.5228485  0.52284116 0.5229006
 0.52308613 0.52321076 0.5232486  0.52312523 0.52307564 0.5230627
 0.5230004  0.52278626 0.52254003 0.522441   0.5224692  0.5225365
 0.52246135 0.5223556  0.5225909  0.52305543 0.52337563 0.5233345
 0.52316105 0.5231576  0.5233559  0.523334   0.5230871  0.52286524
 0.5228323  0.52278507 0.5225496  0.52220625 0.522038   0.5219586
 0.5217222  0.52132016 0.52103883 0.52100945 0.52101266 0.52082556
 0.5206089  0.52089655 0.52161324 0.52185667 0.5219115  0.5245461 ]
