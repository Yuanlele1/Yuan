Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_96_FITS_ETTm1_ftM_sl360_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=34, out_features=43, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1309952.0
params:  1505.0
Trainable parameters:  1505
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3752784
	speed: 0.0260s/iter; left time: 687.8633s
	iters: 200, epoch: 1 | loss: 0.2937169
	speed: 0.0168s/iter; left time: 444.3957s
Epoch: 1 cost time: 5.205942869186401
Epoch: 1, Steps: 266 | Train Loss: 0.3535704 Vali Loss: 0.4407852 Test Loss: 0.3195973
Validation loss decreased (inf --> 0.440785).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2512285
	speed: 0.0750s/iter; left time: 1968.7069s
	iters: 200, epoch: 2 | loss: 0.2972229
	speed: 0.0147s/iter; left time: 383.4674s
Epoch: 2 cost time: 4.4936017990112305
Epoch: 2, Steps: 266 | Train Loss: 0.2864099 Vali Loss: 0.4167631 Test Loss: 0.3078614
Validation loss decreased (0.440785 --> 0.416763).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2881022
	speed: 0.0807s/iter; left time: 2094.4659s
	iters: 200, epoch: 3 | loss: 0.2735801
	speed: 0.0179s/iter; left time: 463.8461s
Epoch: 3 cost time: 5.583462476730347
Epoch: 3, Steps: 266 | Train Loss: 0.2798333 Vali Loss: 0.4064375 Test Loss: 0.3057372
Validation loss decreased (0.416763 --> 0.406438).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2704472
	speed: 0.0710s/iter; left time: 1825.7576s
	iters: 200, epoch: 4 | loss: 0.2816162
	speed: 0.0142s/iter; left time: 362.5847s
Epoch: 4 cost time: 4.48305869102478
Epoch: 4, Steps: 266 | Train Loss: 0.2773238 Vali Loss: 0.4037324 Test Loss: 0.3049962
Validation loss decreased (0.406438 --> 0.403732).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2640838
	speed: 0.0714s/iter; left time: 1817.0120s
	iters: 200, epoch: 5 | loss: 0.2543220
	speed: 0.0150s/iter; left time: 379.1438s
Epoch: 5 cost time: 4.505510568618774
Epoch: 5, Steps: 266 | Train Loss: 0.2760561 Vali Loss: 0.4018703 Test Loss: 0.3051601
Validation loss decreased (0.403732 --> 0.401870).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2740091
	speed: 0.0745s/iter; left time: 1875.4380s
	iters: 200, epoch: 6 | loss: 0.3044256
	speed: 0.0161s/iter; left time: 403.8799s
Epoch: 6 cost time: 4.6923980712890625
Epoch: 6, Steps: 266 | Train Loss: 0.2753054 Vali Loss: 0.3988495 Test Loss: 0.3042182
Validation loss decreased (0.401870 --> 0.398849).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2726687
	speed: 0.0765s/iter; left time: 1905.6592s
	iters: 200, epoch: 7 | loss: 0.2665826
	speed: 0.0210s/iter; left time: 520.3741s
Epoch: 7 cost time: 5.124365329742432
Epoch: 7, Steps: 266 | Train Loss: 0.2746724 Vali Loss: 0.3984596 Test Loss: 0.3042943
Validation loss decreased (0.398849 --> 0.398460).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2922420
	speed: 0.0749s/iter; left time: 1844.6559s
	iters: 200, epoch: 8 | loss: 0.2994405
	speed: 0.0176s/iter; left time: 432.1952s
Epoch: 8 cost time: 4.940810918807983
Epoch: 8, Steps: 266 | Train Loss: 0.2744479 Vali Loss: 0.3991676 Test Loss: 0.3040176
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2847501
	speed: 0.0745s/iter; left time: 1815.9753s
	iters: 200, epoch: 9 | loss: 0.2895053
	speed: 0.0143s/iter; left time: 346.9760s
Epoch: 9 cost time: 4.693016052246094
Epoch: 9, Steps: 266 | Train Loss: 0.2742079 Vali Loss: 0.3978933 Test Loss: 0.3040026
Validation loss decreased (0.398460 --> 0.397893).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2627592
	speed: 0.0715s/iter; left time: 1724.3989s
	iters: 200, epoch: 10 | loss: 0.2558938
	speed: 0.0212s/iter; left time: 509.2642s
Epoch: 10 cost time: 5.304397821426392
Epoch: 10, Steps: 266 | Train Loss: 0.2740010 Vali Loss: 0.3980506 Test Loss: 0.3040647
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2406614
	speed: 0.0759s/iter; left time: 1809.0228s
	iters: 200, epoch: 11 | loss: 0.2615633
	speed: 0.0150s/iter; left time: 356.3908s
Epoch: 11 cost time: 4.779728889465332
Epoch: 11, Steps: 266 | Train Loss: 0.2738459 Vali Loss: 0.3972540 Test Loss: 0.3044166
Validation loss decreased (0.397893 --> 0.397254).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2710213
	speed: 0.0724s/iter; left time: 1706.6921s
	iters: 200, epoch: 12 | loss: 0.2613874
	speed: 0.0143s/iter; left time: 336.1419s
Epoch: 12 cost time: 4.595531463623047
Epoch: 12, Steps: 266 | Train Loss: 0.2736066 Vali Loss: 0.3970555 Test Loss: 0.3036751
Validation loss decreased (0.397254 --> 0.397056).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2546929
	speed: 0.0804s/iter; left time: 1874.3195s
	iters: 200, epoch: 13 | loss: 0.2834368
	speed: 0.0170s/iter; left time: 393.7224s
Epoch: 13 cost time: 5.065587520599365
Epoch: 13, Steps: 266 | Train Loss: 0.2735547 Vali Loss: 0.3951960 Test Loss: 0.3038430
Validation loss decreased (0.397056 --> 0.395196).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2499028
	speed: 0.0780s/iter; left time: 1796.4795s
	iters: 200, epoch: 14 | loss: 0.2668998
	speed: 0.0186s/iter; left time: 425.8127s
Epoch: 14 cost time: 4.985923528671265
Epoch: 14, Steps: 266 | Train Loss: 0.2734188 Vali Loss: 0.3954692 Test Loss: 0.3039750
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2394409
	speed: 0.0763s/iter; left time: 1738.4645s
	iters: 200, epoch: 15 | loss: 0.2725050
	speed: 0.0163s/iter; left time: 368.5322s
Epoch: 15 cost time: 5.035607576370239
Epoch: 15, Steps: 266 | Train Loss: 0.2734661 Vali Loss: 0.3961580 Test Loss: 0.3038540
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2937882
	speed: 0.0835s/iter; left time: 1878.7671s
	iters: 200, epoch: 16 | loss: 0.2801262
	speed: 0.0152s/iter; left time: 341.3884s
Epoch: 16 cost time: 5.441377639770508
Epoch: 16, Steps: 266 | Train Loss: 0.2733785 Vali Loss: 0.3960939 Test Loss: 0.3039249
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2502075
	speed: 0.0757s/iter; left time: 1684.7509s
	iters: 200, epoch: 17 | loss: 0.2946193
	speed: 0.0157s/iter; left time: 348.2501s
Epoch: 17 cost time: 5.08814001083374
Epoch: 17, Steps: 266 | Train Loss: 0.2732343 Vali Loss: 0.3965367 Test Loss: 0.3040574
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2667064
	speed: 0.0782s/iter; left time: 1718.0219s
	iters: 200, epoch: 18 | loss: 0.2694037
	speed: 0.0150s/iter; left time: 328.4706s
Epoch: 18 cost time: 4.601559400558472
Epoch: 18, Steps: 266 | Train Loss: 0.2732138 Vali Loss: 0.3962092 Test Loss: 0.3043249
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2850660
	speed: 0.0765s/iter; left time: 1661.3423s
	iters: 200, epoch: 19 | loss: 0.2521036
	speed: 0.0158s/iter; left time: 342.3931s
Epoch: 19 cost time: 5.122612237930298
Epoch: 19, Steps: 266 | Train Loss: 0.2731699 Vali Loss: 0.3962672 Test Loss: 0.3042270
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2425160
	speed: 0.0811s/iter; left time: 1739.8414s
	iters: 200, epoch: 20 | loss: 0.2680941
	speed: 0.0162s/iter; left time: 346.4857s
Epoch: 20 cost time: 5.174317836761475
Epoch: 20, Steps: 266 | Train Loss: 0.2732080 Vali Loss: 0.3962402 Test Loss: 0.3045028
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2748924
	speed: 0.0857s/iter; left time: 1815.1038s
	iters: 200, epoch: 21 | loss: 0.2522556
	speed: 0.0140s/iter; left time: 295.9475s
Epoch: 21 cost time: 4.512262344360352
Epoch: 21, Steps: 266 | Train Loss: 0.2731042 Vali Loss: 0.3961505 Test Loss: 0.3041460
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3262764
	speed: 0.0728s/iter; left time: 1522.4859s
	iters: 200, epoch: 22 | loss: 0.2970696
	speed: 0.0162s/iter; left time: 337.7030s
Epoch: 22 cost time: 4.693966627120972
Epoch: 22, Steps: 266 | Train Loss: 0.2731249 Vali Loss: 0.3960965 Test Loss: 0.3042417
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2840224
	speed: 0.0748s/iter; left time: 1544.5198s
	iters: 200, epoch: 23 | loss: 0.2528166
	speed: 0.0218s/iter; left time: 448.2491s
Epoch: 23 cost time: 5.156625509262085
Epoch: 23, Steps: 266 | Train Loss: 0.2730484 Vali Loss: 0.3960458 Test Loss: 0.3040385
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2765689
	speed: 0.0735s/iter; left time: 1498.3562s
	iters: 200, epoch: 24 | loss: 0.2698312
	speed: 0.0160s/iter; left time: 323.7607s
Epoch: 24 cost time: 4.935537099838257
Epoch: 24, Steps: 266 | Train Loss: 0.2730109 Vali Loss: 0.3954130 Test Loss: 0.3039531
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2906897
	speed: 0.0854s/iter; left time: 1718.8114s
	iters: 200, epoch: 25 | loss: 0.2548872
	speed: 0.0153s/iter; left time: 305.8004s
Epoch: 25 cost time: 5.534304857254028
Epoch: 25, Steps: 266 | Train Loss: 0.2730056 Vali Loss: 0.3962276 Test Loss: 0.3043362
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2704158
	speed: 0.0706s/iter; left time: 1401.8840s
	iters: 200, epoch: 26 | loss: 0.2629757
	speed: 0.0149s/iter; left time: 295.0247s
Epoch: 26 cost time: 4.4920265674591064
Epoch: 26, Steps: 266 | Train Loss: 0.2730217 Vali Loss: 0.3963943 Test Loss: 0.3042349
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2663466
	speed: 0.0770s/iter; left time: 1507.9130s
	iters: 200, epoch: 27 | loss: 0.2708419
	speed: 0.0149s/iter; left time: 290.4106s
Epoch: 27 cost time: 4.469090461730957
Epoch: 27, Steps: 266 | Train Loss: 0.2729346 Vali Loss: 0.3958445 Test Loss: 0.3041636
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2381303
	speed: 0.0878s/iter; left time: 1695.6873s
	iters: 200, epoch: 28 | loss: 0.2802013
	speed: 0.0150s/iter; left time: 289.0732s
Epoch: 28 cost time: 4.516167879104614
Epoch: 28, Steps: 266 | Train Loss: 0.2729540 Vali Loss: 0.3959339 Test Loss: 0.3042809
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2818426
	speed: 0.0750s/iter; left time: 1429.2404s
	iters: 200, epoch: 29 | loss: 0.2653658
	speed: 0.0195s/iter; left time: 369.6390s
Epoch: 29 cost time: 5.075937986373901
Epoch: 29, Steps: 266 | Train Loss: 0.2730097 Vali Loss: 0.3958942 Test Loss: 0.3041903
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2606822
	speed: 0.0767s/iter; left time: 1441.3593s
	iters: 200, epoch: 30 | loss: 0.2978800
	speed: 0.0148s/iter; left time: 277.3979s
Epoch: 30 cost time: 4.628772735595703
Epoch: 30, Steps: 266 | Train Loss: 0.2729434 Vali Loss: 0.3955063 Test Loss: 0.3041024
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2611956
	speed: 0.0743s/iter; left time: 1376.7495s
	iters: 200, epoch: 31 | loss: 0.2541966
	speed: 0.0222s/iter; left time: 409.0491s
Epoch: 31 cost time: 5.428741455078125
Epoch: 31, Steps: 266 | Train Loss: 0.2729346 Vali Loss: 0.3953334 Test Loss: 0.3040349
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2767621
	speed: 0.0772s/iter; left time: 1408.6687s
	iters: 200, epoch: 32 | loss: 0.2881185
	speed: 0.0143s/iter; left time: 258.7656s
Epoch: 32 cost time: 4.632642507553101
Epoch: 32, Steps: 266 | Train Loss: 0.2729033 Vali Loss: 0.3955184 Test Loss: 0.3040491
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2798376
	speed: 0.0738s/iter; left time: 1326.9943s
	iters: 200, epoch: 33 | loss: 0.2539672
	speed: 0.0145s/iter; left time: 259.0989s
Epoch: 33 cost time: 4.457582235336304
Epoch: 33, Steps: 266 | Train Loss: 0.2729616 Vali Loss: 0.3953227 Test Loss: 0.3044125
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_96_FITS_ETTm1_ftM_sl360_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3056846857070923, mae:0.34727638959884644, rse:0.5261005163192749, corr:[0.54672605 0.55365163 0.5581539  0.559968   0.5600046  0.5594255
 0.5590445  0.5591821  0.55968755 0.56030613 0.5608873  0.56105447
 0.56079924 0.5602165  0.5594132  0.5584562  0.55748314 0.55657005
 0.5555349  0.55432737 0.5529293  0.5515469  0.5501823  0.5489977
 0.5480134  0.5471348  0.5464204  0.5459395  0.54563874 0.5453515
 0.54517853 0.5451991  0.5453274  0.54550654 0.5456606  0.5458438
 0.5460148  0.54610413 0.54606205 0.54584134 0.5454726  0.54498285
 0.54442376 0.543954   0.54363877 0.54353756 0.5436932  0.54395956
 0.5441666  0.54427713 0.5442223  0.54402226 0.5437981  0.54359466
 0.54346067 0.5434255  0.54342675 0.5434299  0.54342705 0.5433144
 0.54316884 0.54297006 0.54277736 0.5425817  0.54251426 0.54261523
 0.54282266 0.54305035 0.54334897 0.543619   0.54382175 0.54392105
 0.54397225 0.5440065  0.5439927  0.54388493 0.54368    0.5433866
 0.54299957 0.54254884 0.5420889  0.5416367  0.5411736  0.5406677
 0.54021066 0.5397693  0.539401   0.53904474 0.53871536 0.53853416
 0.5385842  0.5388261  0.53919697 0.5396459  0.53990525 0.539533  ]
