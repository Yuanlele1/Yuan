Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=18, out_features=27, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  435456.0
params:  513.0
Trainable parameters:  513
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3750338
	speed: 0.0567s/iter; left time: 1508.3200s
	iters: 200, epoch: 1 | loss: 0.3177416
	speed: 0.0499s/iter; left time: 1321.4893s
Epoch: 1 cost time: 13.867923021316528
Epoch: 1, Steps: 267 | Train Loss: 0.3828453 Vali Loss: 0.7206337 Test Loss: 0.5811261
Validation loss decreased (inf --> 0.720634).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2590667
	speed: 0.2547s/iter; left time: 6707.0745s
	iters: 200, epoch: 2 | loss: 0.2151992
	speed: 0.0627s/iter; left time: 1644.2235s
Epoch: 2 cost time: 16.121640920639038
Epoch: 2, Steps: 267 | Train Loss: 0.2385058 Vali Loss: 0.5867062 Test Loss: 0.4609231
Validation loss decreased (0.720634 --> 0.586706).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1919318
	speed: 0.2220s/iter; left time: 5788.1326s
	iters: 200, epoch: 3 | loss: 0.1862583
	speed: 0.0339s/iter; left time: 880.6232s
Epoch: 3 cost time: 9.99131178855896
Epoch: 3, Steps: 267 | Train Loss: 0.1841642 Vali Loss: 0.5248784 Test Loss: 0.4081002
Validation loss decreased (0.586706 --> 0.524878).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1534541
	speed: 0.1780s/iter; left time: 4591.5245s
	iters: 200, epoch: 4 | loss: 0.1545744
	speed: 0.0482s/iter; left time: 1239.2615s
Epoch: 4 cost time: 12.79460883140564
Epoch: 4, Steps: 267 | Train Loss: 0.1576152 Vali Loss: 0.4871164 Test Loss: 0.3770474
Validation loss decreased (0.524878 --> 0.487116).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1344637
	speed: 0.1998s/iter; left time: 5100.5173s
	iters: 200, epoch: 5 | loss: 0.1473847
	speed: 0.0672s/iter; left time: 1709.3109s
Epoch: 5 cost time: 16.910664558410645
Epoch: 5, Steps: 267 | Train Loss: 0.1426649 Vali Loss: 0.4632490 Test Loss: 0.3570579
Validation loss decreased (0.487116 --> 0.463249).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1418992
	speed: 0.2420s/iter; left time: 6113.1792s
	iters: 200, epoch: 6 | loss: 0.1394693
	speed: 0.0542s/iter; left time: 1363.4520s
Epoch: 6 cost time: 14.562554359436035
Epoch: 6, Steps: 267 | Train Loss: 0.1336553 Vali Loss: 0.4487450 Test Loss: 0.3453496
Validation loss decreased (0.463249 --> 0.448745).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1216463
	speed: 0.2046s/iter; left time: 5114.1412s
	iters: 200, epoch: 7 | loss: 0.1442656
	speed: 0.0452s/iter; left time: 1124.8041s
Epoch: 7 cost time: 12.266900777816772
Epoch: 7, Steps: 267 | Train Loss: 0.1280943 Vali Loss: 0.4370716 Test Loss: 0.3362967
Validation loss decreased (0.448745 --> 0.437072).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1292391
	speed: 0.2173s/iter; left time: 5373.6939s
	iters: 200, epoch: 8 | loss: 0.1215200
	speed: 0.0605s/iter; left time: 1490.5579s
Epoch: 8 cost time: 17.344127655029297
Epoch: 8, Steps: 267 | Train Loss: 0.1246731 Vali Loss: 0.4305478 Test Loss: 0.3306130
Validation loss decreased (0.437072 --> 0.430548).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1236404
	speed: 0.2446s/iter; left time: 5984.2833s
	iters: 200, epoch: 9 | loss: 0.1274395
	speed: 0.0544s/iter; left time: 1325.8295s
Epoch: 9 cost time: 13.731244087219238
Epoch: 9, Steps: 267 | Train Loss: 0.1225213 Vali Loss: 0.4257360 Test Loss: 0.3265420
Validation loss decreased (0.430548 --> 0.425736).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1214079
	speed: 0.1939s/iter; left time: 4691.9052s
	iters: 200, epoch: 10 | loss: 0.1171455
	speed: 0.0485s/iter; left time: 1167.6293s
Epoch: 10 cost time: 13.788089990615845
Epoch: 10, Steps: 267 | Train Loss: 0.1211958 Vali Loss: 0.4233937 Test Loss: 0.3244792
Validation loss decreased (0.425736 --> 0.423394).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1202819
	speed: 0.2394s/iter; left time: 5729.1680s
	iters: 200, epoch: 11 | loss: 0.1198690
	speed: 0.0614s/iter; left time: 1463.9978s
Epoch: 11 cost time: 16.753084182739258
Epoch: 11, Steps: 267 | Train Loss: 0.1204018 Vali Loss: 0.4208964 Test Loss: 0.3220042
Validation loss decreased (0.423394 --> 0.420896).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1257687
	speed: 0.2441s/iter; left time: 5775.3377s
	iters: 200, epoch: 12 | loss: 0.1139441
	speed: 0.0385s/iter; left time: 907.8823s
Epoch: 12 cost time: 14.337992906570435
Epoch: 12, Steps: 267 | Train Loss: 0.1198970 Vali Loss: 0.4186088 Test Loss: 0.3208421
Validation loss decreased (0.420896 --> 0.418609).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1303676
	speed: 0.1965s/iter; left time: 4597.4081s
	iters: 200, epoch: 13 | loss: 0.1255632
	speed: 0.0471s/iter; left time: 1096.6778s
Epoch: 13 cost time: 12.970905303955078
Epoch: 13, Steps: 267 | Train Loss: 0.1196745 Vali Loss: 0.4180568 Test Loss: 0.3202887
Validation loss decreased (0.418609 --> 0.418057).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1218001
	speed: 0.1442s/iter; left time: 3335.2027s
	iters: 200, epoch: 14 | loss: 0.1170733
	speed: 0.0397s/iter; left time: 913.4216s
Epoch: 14 cost time: 11.727504968643188
Epoch: 14, Steps: 267 | Train Loss: 0.1195655 Vali Loss: 0.4167851 Test Loss: 0.3193565
Validation loss decreased (0.418057 --> 0.416785).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1225107
	speed: 0.2700s/iter; left time: 6172.6235s
	iters: 200, epoch: 15 | loss: 0.1263037
	speed: 0.0669s/iter; left time: 1523.0757s
Epoch: 15 cost time: 17.297793865203857
Epoch: 15, Steps: 267 | Train Loss: 0.1194594 Vali Loss: 0.4170432 Test Loss: 0.3193651
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1289053
	speed: 0.2511s/iter; left time: 5673.0111s
	iters: 200, epoch: 16 | loss: 0.1210538
	speed: 0.0503s/iter; left time: 1132.6266s
Epoch: 16 cost time: 15.580223560333252
Epoch: 16, Steps: 267 | Train Loss: 0.1194108 Vali Loss: 0.4164819 Test Loss: 0.3186356
Validation loss decreased (0.416785 --> 0.416482).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1258256
	speed: 0.2082s/iter; left time: 4648.7112s
	iters: 200, epoch: 17 | loss: 0.1376362
	speed: 0.0459s/iter; left time: 1020.1082s
Epoch: 17 cost time: 12.449888944625854
Epoch: 17, Steps: 267 | Train Loss: 0.1193858 Vali Loss: 0.4162719 Test Loss: 0.3184179
Validation loss decreased (0.416482 --> 0.416272).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1220405
	speed: 0.1660s/iter; left time: 3661.3130s
	iters: 200, epoch: 18 | loss: 0.1121995
	speed: 0.0396s/iter; left time: 869.3512s
Epoch: 18 cost time: 11.005639553070068
Epoch: 18, Steps: 267 | Train Loss: 0.1193906 Vali Loss: 0.4156423 Test Loss: 0.3182106
Validation loss decreased (0.416272 --> 0.415642).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1247194
	speed: 0.1728s/iter; left time: 3765.3891s
	iters: 200, epoch: 19 | loss: 0.1332932
	speed: 0.0514s/iter; left time: 1114.1175s
Epoch: 19 cost time: 14.745978355407715
Epoch: 19, Steps: 267 | Train Loss: 0.1193826 Vali Loss: 0.4157877 Test Loss: 0.3179052
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1248006
	speed: 0.1436s/iter; left time: 3091.0804s
	iters: 200, epoch: 20 | loss: 0.1124938
	speed: 0.0265s/iter; left time: 567.1166s
Epoch: 20 cost time: 9.07090711593628
Epoch: 20, Steps: 267 | Train Loss: 0.1193801 Vali Loss: 0.4154025 Test Loss: 0.3182099
Validation loss decreased (0.415642 --> 0.415403).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1160516
	speed: 0.1375s/iter; left time: 2922.5706s
	iters: 200, epoch: 21 | loss: 0.1123341
	speed: 0.0382s/iter; left time: 808.8273s
Epoch: 21 cost time: 10.404045581817627
Epoch: 21, Steps: 267 | Train Loss: 0.1193769 Vali Loss: 0.4163428 Test Loss: 0.3182043
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1022049
	speed: 0.1482s/iter; left time: 3111.7977s
	iters: 200, epoch: 22 | loss: 0.1167136
	speed: 0.0403s/iter; left time: 842.5344s
Epoch: 22 cost time: 9.558521270751953
Epoch: 22, Steps: 267 | Train Loss: 0.1193966 Vali Loss: 0.4155123 Test Loss: 0.3180269
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1340741
	speed: 0.0967s/iter; left time: 2003.5904s
	iters: 200, epoch: 23 | loss: 0.1096266
	speed: 0.0403s/iter; left time: 830.3815s
Epoch: 23 cost time: 8.892193794250488
Epoch: 23, Steps: 267 | Train Loss: 0.1193721 Vali Loss: 0.4162761 Test Loss: 0.3182005
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1175892
	speed: 0.1281s/iter; left time: 2621.1707s
	iters: 200, epoch: 24 | loss: 0.1154023
	speed: 0.0574s/iter; left time: 1168.8405s
Epoch: 24 cost time: 18.200162887573242
Epoch: 24, Steps: 267 | Train Loss: 0.1193363 Vali Loss: 0.4159900 Test Loss: 0.3181864
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1243328
	speed: 0.5720s/iter; left time: 11550.8670s
	iters: 200, epoch: 25 | loss: 0.1142065
	speed: 0.1397s/iter; left time: 2806.8833s
Epoch: 25 cost time: 36.984169483184814
Epoch: 25, Steps: 267 | Train Loss: 0.1193492 Vali Loss: 0.4160399 Test Loss: 0.3181199
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1114339
	speed: 0.6021s/iter; left time: 11997.7835s
	iters: 200, epoch: 26 | loss: 0.1252494
	speed: 0.1290s/iter; left time: 2557.8776s
Epoch: 26 cost time: 33.48747205734253
Epoch: 26, Steps: 267 | Train Loss: 0.1193638 Vali Loss: 0.4160525 Test Loss: 0.3181857
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1320852
	speed: 0.5624s/iter; left time: 11056.9836s
	iters: 200, epoch: 27 | loss: 0.1226212
	speed: 0.1303s/iter; left time: 2547.5689s
Epoch: 27 cost time: 36.35993051528931
Epoch: 27, Steps: 267 | Train Loss: 0.1193935 Vali Loss: 0.4154997 Test Loss: 0.3183154
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1222408
	speed: 0.5996s/iter; left time: 11627.4728s
	iters: 200, epoch: 28 | loss: 0.1178530
	speed: 0.1290s/iter; left time: 2489.1053s
Epoch: 28 cost time: 34.78523778915405
Epoch: 28, Steps: 267 | Train Loss: 0.1193996 Vali Loss: 0.4162622 Test Loss: 0.3187397
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1128372
	speed: 0.5828s/iter; left time: 11146.0741s
	iters: 200, epoch: 29 | loss: 0.1200187
	speed: 0.1203s/iter; left time: 2288.5399s
Epoch: 29 cost time: 34.325926542282104
Epoch: 29, Steps: 267 | Train Loss: 0.1193840 Vali Loss: 0.4158421 Test Loss: 0.3183191
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1168594
	speed: 0.5859s/iter; left time: 11048.8216s
	iters: 200, epoch: 30 | loss: 0.1125267
	speed: 0.1475s/iter; left time: 2766.3570s
Epoch: 30 cost time: 38.176117181777954
Epoch: 30, Steps: 267 | Train Loss: 0.1194177 Vali Loss: 0.4160520 Test Loss: 0.3181182
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1148632
	speed: 0.6378s/iter; left time: 11857.3017s
	iters: 200, epoch: 31 | loss: 0.1181725
	speed: 0.1339s/iter; left time: 2476.2097s
Epoch: 31 cost time: 36.797420024871826
Epoch: 31, Steps: 267 | Train Loss: 0.1194123 Vali Loss: 0.4156778 Test Loss: 0.3180144
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1186862
	speed: 0.5349s/iter; left time: 9800.9418s
	iters: 200, epoch: 32 | loss: 0.1280968
	speed: 0.1261s/iter; left time: 2297.6174s
Epoch: 32 cost time: 34.210065603256226
Epoch: 32, Steps: 267 | Train Loss: 0.1193395 Vali Loss: 0.4160815 Test Loss: 0.3184154
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1192764
	speed: 0.6140s/iter; left time: 11087.8370s
	iters: 200, epoch: 33 | loss: 0.1270041
	speed: 0.1333s/iter; left time: 2393.8944s
Epoch: 33 cost time: 36.504767417907715
Epoch: 33, Steps: 267 | Train Loss: 0.1193380 Vali Loss: 0.4161665 Test Loss: 0.3183849
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1289390
	speed: 0.5760s/iter; left time: 10247.2896s
	iters: 200, epoch: 34 | loss: 0.1218997
	speed: 0.1213s/iter; left time: 2146.0090s
Epoch: 34 cost time: 34.810253620147705
Epoch: 34, Steps: 267 | Train Loss: 0.1193775 Vali Loss: 0.4159844 Test Loss: 0.3181820
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1206065
	speed: 0.5816s/iter; left time: 10191.3782s
	iters: 200, epoch: 35 | loss: 0.1188771
	speed: 0.1346s/iter; left time: 2344.5106s
Epoch: 35 cost time: 35.29682183265686
Epoch: 35, Steps: 267 | Train Loss: 0.1193758 Vali Loss: 0.4160115 Test Loss: 0.3182621
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1293795
	speed: 0.5940s/iter; left time: 10249.8962s
	iters: 200, epoch: 36 | loss: 0.1231351
	speed: 0.1326s/iter; left time: 2274.6621s
Epoch: 36 cost time: 35.67316722869873
Epoch: 36, Steps: 267 | Train Loss: 0.1193347 Vali Loss: 0.4162213 Test Loss: 0.3183380
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1181965
	speed: 0.5518s/iter; left time: 9373.9752s
	iters: 200, epoch: 37 | loss: 0.1080286
	speed: 0.1282s/iter; left time: 2165.4168s
Epoch: 37 cost time: 32.5786292552948
Epoch: 37, Steps: 267 | Train Loss: 0.1193817 Vali Loss: 0.4159462 Test Loss: 0.3182767
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1377609
	speed: 0.5669s/iter; left time: 9480.2468s
	iters: 200, epoch: 38 | loss: 0.1215361
	speed: 0.1419s/iter; left time: 2358.8710s
Epoch: 38 cost time: 38.41867756843567
Epoch: 38, Steps: 267 | Train Loss: 0.1193598 Vali Loss: 0.4161231 Test Loss: 0.3184575
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1159732
	speed: 0.5917s/iter; left time: 9736.9363s
	iters: 200, epoch: 39 | loss: 0.1217607
	speed: 0.1296s/iter; left time: 2119.9834s
Epoch: 39 cost time: 35.617106199264526
Epoch: 39, Steps: 267 | Train Loss: 0.1193544 Vali Loss: 0.4155323 Test Loss: 0.3181993
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1271432
	speed: 0.5695s/iter; left time: 9219.6995s
	iters: 200, epoch: 40 | loss: 0.1318907
	speed: 0.1329s/iter; left time: 2138.3333s
Epoch: 40 cost time: 34.8065128326416
Epoch: 40, Steps: 267 | Train Loss: 0.1193706 Vali Loss: 0.4159195 Test Loss: 0.3180793
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=18, out_features=27, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  435456.0
params:  513.0
Trainable parameters:  513
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2993900
	speed: 0.1304s/iter; left time: 3468.8365s
	iters: 200, epoch: 1 | loss: 0.3054655
	speed: 0.1409s/iter; left time: 3732.8305s
Epoch: 1 cost time: 36.12498092651367
Epoch: 1, Steps: 267 | Train Loss: 0.2965924 Vali Loss: 0.4105018 Test Loss: 0.3137855
Validation loss decreased (inf --> 0.410502).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2749281
	speed: 0.6047s/iter; left time: 15924.5903s
	iters: 200, epoch: 2 | loss: 0.2828547
	speed: 0.1135s/iter; left time: 2977.5985s
Epoch: 2 cost time: 32.936421155929565
Epoch: 2, Steps: 267 | Train Loss: 0.2948926 Vali Loss: 0.4107433 Test Loss: 0.3130639
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2952598
	speed: 0.5552s/iter; left time: 14473.4193s
	iters: 200, epoch: 3 | loss: 0.3150640
	speed: 0.1280s/iter; left time: 3323.1410s
Epoch: 3 cost time: 35.8689751625061
Epoch: 3, Steps: 267 | Train Loss: 0.2942649 Vali Loss: 0.4082684 Test Loss: 0.3119060
Validation loss decreased (0.410502 --> 0.408268).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2950852
	speed: 0.6009s/iter; left time: 15503.0875s
	iters: 200, epoch: 4 | loss: 0.2936441
	speed: 0.1364s/iter; left time: 3506.1720s
Epoch: 4 cost time: 35.80219745635986
Epoch: 4, Steps: 267 | Train Loss: 0.2938732 Vali Loss: 0.4078001 Test Loss: 0.3116287
Validation loss decreased (0.408268 --> 0.407800).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2595796
	speed: 0.5832s/iter; left time: 14891.0160s
	iters: 200, epoch: 5 | loss: 0.3006587
	speed: 0.1303s/iter; left time: 3314.5995s
Epoch: 5 cost time: 35.596752882003784
Epoch: 5, Steps: 267 | Train Loss: 0.2935220 Vali Loss: 0.4083531 Test Loss: 0.3129430
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3031252
	speed: 0.5764s/iter; left time: 14563.7612s
	iters: 200, epoch: 6 | loss: 0.2691800
	speed: 0.1342s/iter; left time: 3376.7397s
Epoch: 6 cost time: 35.84294891357422
Epoch: 6, Steps: 267 | Train Loss: 0.2932292 Vali Loss: 0.4066084 Test Loss: 0.3117464
Validation loss decreased (0.407800 --> 0.406608).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3125984
	speed: 0.5633s/iter; left time: 14081.8793s
	iters: 200, epoch: 7 | loss: 0.2862834
	speed: 0.1350s/iter; left time: 3360.9832s
Epoch: 7 cost time: 35.77131724357605
Epoch: 7, Steps: 267 | Train Loss: 0.2931884 Vali Loss: 0.4069543 Test Loss: 0.3120478
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3431148
	speed: 0.5678s/iter; left time: 14043.9118s
	iters: 200, epoch: 8 | loss: 0.3103635
	speed: 0.1153s/iter; left time: 2839.2760s
Epoch: 8 cost time: 32.62361931800842
Epoch: 8, Steps: 267 | Train Loss: 0.2930831 Vali Loss: 0.4062888 Test Loss: 0.3112697
Validation loss decreased (0.406608 --> 0.406289).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2568990
	speed: 0.5689s/iter; left time: 13918.1918s
	iters: 200, epoch: 9 | loss: 0.3052118
	speed: 0.1365s/iter; left time: 3326.9132s
Epoch: 9 cost time: 36.097883462905884
Epoch: 9, Steps: 267 | Train Loss: 0.2928703 Vali Loss: 0.4051312 Test Loss: 0.3113023
Validation loss decreased (0.406289 --> 0.405131).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2869154
	speed: 0.5799s/iter; left time: 14032.7871s
	iters: 200, epoch: 10 | loss: 0.2979516
	speed: 0.1255s/iter; left time: 3025.4548s
Epoch: 10 cost time: 35.08905267715454
Epoch: 10, Steps: 267 | Train Loss: 0.2927032 Vali Loss: 0.4061180 Test Loss: 0.3110956
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3074403
	speed: 0.5571s/iter; left time: 13330.8982s
	iters: 200, epoch: 11 | loss: 0.3070664
	speed: 0.1296s/iter; left time: 3089.1027s
Epoch: 11 cost time: 34.11647629737854
Epoch: 11, Steps: 267 | Train Loss: 0.2927004 Vali Loss: 0.4065256 Test Loss: 0.3113612
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2903136
	speed: 0.5792s/iter; left time: 13705.3003s
	iters: 200, epoch: 12 | loss: 0.3198830
	speed: 0.1233s/iter; left time: 2904.6765s
Epoch: 12 cost time: 34.029895067214966
Epoch: 12, Steps: 267 | Train Loss: 0.2926687 Vali Loss: 0.4057970 Test Loss: 0.3114280
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3091367
	speed: 0.5557s/iter; left time: 13000.7002s
	iters: 200, epoch: 13 | loss: 0.2590190
	speed: 0.1201s/iter; left time: 2797.6467s
Epoch: 13 cost time: 33.927000761032104
Epoch: 13, Steps: 267 | Train Loss: 0.2926609 Vali Loss: 0.4055219 Test Loss: 0.3113576
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3114721
	speed: 0.5632s/iter; left time: 13025.6877s
	iters: 200, epoch: 14 | loss: 0.3116803
	speed: 0.1299s/iter; left time: 2991.5479s
Epoch: 14 cost time: 34.06654071807861
Epoch: 14, Steps: 267 | Train Loss: 0.2926002 Vali Loss: 0.4061803 Test Loss: 0.3117421
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2708645
	speed: 0.5938s/iter; left time: 13576.8668s
	iters: 200, epoch: 15 | loss: 0.3064663
	speed: 0.1374s/iter; left time: 3128.1609s
Epoch: 15 cost time: 36.791269063949585
Epoch: 15, Steps: 267 | Train Loss: 0.2924472 Vali Loss: 0.4060827 Test Loss: 0.3110928
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3195954
	speed: 0.5839s/iter; left time: 13194.3519s
	iters: 200, epoch: 16 | loss: 0.3047674
	speed: 0.1339s/iter; left time: 3011.6423s
Epoch: 16 cost time: 36.32027888298035
Epoch: 16, Steps: 267 | Train Loss: 0.2925630 Vali Loss: 0.4063259 Test Loss: 0.3115168
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2656507
	speed: 0.5804s/iter; left time: 12960.5793s
	iters: 200, epoch: 17 | loss: 0.2682624
	speed: 0.1288s/iter; left time: 2864.0268s
Epoch: 17 cost time: 35.07678008079529
Epoch: 17, Steps: 267 | Train Loss: 0.2925868 Vali Loss: 0.4062438 Test Loss: 0.3115337
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3313454
	speed: 0.5974s/iter; left time: 13180.5826s
	iters: 200, epoch: 18 | loss: 0.2953420
	speed: 0.1347s/iter; left time: 2958.9658s
Epoch: 18 cost time: 35.84883117675781
Epoch: 18, Steps: 267 | Train Loss: 0.2923993 Vali Loss: 0.4051842 Test Loss: 0.3109970
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2641979
	speed: 0.5411s/iter; left time: 11792.3852s
	iters: 200, epoch: 19 | loss: 0.2939587
	speed: 0.1050s/iter; left time: 2277.1734s
Epoch: 19 cost time: 30.777542114257812
Epoch: 19, Steps: 267 | Train Loss: 0.2924602 Vali Loss: 0.4056402 Test Loss: 0.3113882
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2819556
	speed: 0.5909s/iter; left time: 12721.8944s
	iters: 200, epoch: 20 | loss: 0.3233178
	speed: 0.1325s/iter; left time: 2838.7670s
Epoch: 20 cost time: 36.18811845779419
Epoch: 20, Steps: 267 | Train Loss: 0.2924514 Vali Loss: 0.4047639 Test Loss: 0.3110638
Validation loss decreased (0.405131 --> 0.404764).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2933033
	speed: 0.6011s/iter; left time: 12779.1886s
	iters: 200, epoch: 21 | loss: 0.3231119
	speed: 0.1219s/iter; left time: 2578.5018s
Epoch: 21 cost time: 33.43109107017517
Epoch: 21, Steps: 267 | Train Loss: 0.2924245 Vali Loss: 0.4058812 Test Loss: 0.3111216
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2774631
	speed: 0.5451s/iter; left time: 11443.8634s
	iters: 200, epoch: 22 | loss: 0.2608835
	speed: 0.1250s/iter; left time: 2612.2968s
Epoch: 22 cost time: 34.210808515548706
Epoch: 22, Steps: 267 | Train Loss: 0.2922600 Vali Loss: 0.4054642 Test Loss: 0.3113196
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2909620
	speed: 0.5639s/iter; left time: 11687.7463s
	iters: 200, epoch: 23 | loss: 0.2724648
	speed: 0.1216s/iter; left time: 2508.5201s
Epoch: 23 cost time: 32.58247208595276
Epoch: 23, Steps: 267 | Train Loss: 0.2924305 Vali Loss: 0.4057030 Test Loss: 0.3114208
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2927877
	speed: 0.5198s/iter; left time: 10636.0334s
	iters: 200, epoch: 24 | loss: 0.3169524
	speed: 0.1060s/iter; left time: 2157.6002s
Epoch: 24 cost time: 29.888642072677612
Epoch: 24, Steps: 267 | Train Loss: 0.2923636 Vali Loss: 0.4055928 Test Loss: 0.3112311
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2988190
	speed: 0.4877s/iter; left time: 9848.7796s
	iters: 200, epoch: 25 | loss: 0.2969935
	speed: 0.1106s/iter; left time: 2222.8861s
Epoch: 25 cost time: 28.072414875030518
Epoch: 25, Steps: 267 | Train Loss: 0.2922826 Vali Loss: 0.4055829 Test Loss: 0.3113634
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2510414
	speed: 0.4887s/iter; left time: 9737.1045s
	iters: 200, epoch: 26 | loss: 0.3366611
	speed: 0.1104s/iter; left time: 2188.0771s
Epoch: 26 cost time: 31.32506036758423
Epoch: 26, Steps: 267 | Train Loss: 0.2923096 Vali Loss: 0.4055305 Test Loss: 0.3110422
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3230524
	speed: 0.4853s/iter; left time: 9541.1716s
	iters: 200, epoch: 27 | loss: 0.2756203
	speed: 0.1111s/iter; left time: 2173.5990s
Epoch: 27 cost time: 28.581124782562256
Epoch: 27, Steps: 267 | Train Loss: 0.2922282 Vali Loss: 0.4058887 Test Loss: 0.3114173
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3227541
	speed: 0.4519s/iter; left time: 8762.8796s
	iters: 200, epoch: 28 | loss: 0.2694938
	speed: 0.1064s/iter; left time: 2052.7964s
Epoch: 28 cost time: 29.83637809753418
Epoch: 28, Steps: 267 | Train Loss: 0.2923729 Vali Loss: 0.4053184 Test Loss: 0.3112024
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3000887
	speed: 0.5437s/iter; left time: 10397.4457s
	iters: 200, epoch: 29 | loss: 0.3151749
	speed: 0.1143s/iter; left time: 2174.5311s
Epoch: 29 cost time: 32.364524841308594
Epoch: 29, Steps: 267 | Train Loss: 0.2922447 Vali Loss: 0.4056375 Test Loss: 0.3115403
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3272073
	speed: 0.4898s/iter; left time: 9236.8397s
	iters: 200, epoch: 30 | loss: 0.3005865
	speed: 0.0906s/iter; left time: 1698.7389s
Epoch: 30 cost time: 28.499693155288696
Epoch: 30, Steps: 267 | Train Loss: 0.2922172 Vali Loss: 0.4056661 Test Loss: 0.3112919
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3100394
	speed: 0.4725s/iter; left time: 8784.8548s
	iters: 200, epoch: 31 | loss: 0.2846311
	speed: 0.1261s/iter; left time: 2332.1780s
Epoch: 31 cost time: 31.684062719345093
Epoch: 31, Steps: 267 | Train Loss: 0.2923346 Vali Loss: 0.4054563 Test Loss: 0.3111546
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3129460
	speed: 0.4977s/iter; left time: 9119.6618s
	iters: 200, epoch: 32 | loss: 0.2944224
	speed: 0.1120s/iter; left time: 2040.7654s
Epoch: 32 cost time: 29.559622287750244
Epoch: 32, Steps: 267 | Train Loss: 0.2923593 Vali Loss: 0.4057200 Test Loss: 0.3112868
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2794852
	speed: 0.4818s/iter; left time: 8700.1035s
	iters: 200, epoch: 33 | loss: 0.2811386
	speed: 0.1037s/iter; left time: 1862.0614s
Epoch: 33 cost time: 28.904728412628174
Epoch: 33, Steps: 267 | Train Loss: 0.2922479 Vali Loss: 0.4054516 Test Loss: 0.3113068
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2913738
	speed: 0.4933s/iter; left time: 8776.2852s
	iters: 200, epoch: 34 | loss: 0.2914232
	speed: 0.1117s/iter; left time: 1976.4959s
Epoch: 34 cost time: 30.705616235733032
Epoch: 34, Steps: 267 | Train Loss: 0.2922654 Vali Loss: 0.4051209 Test Loss: 0.3112572
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2723027
	speed: 0.5080s/iter; left time: 8901.8583s
	iters: 200, epoch: 35 | loss: 0.2625978
	speed: 0.1092s/iter; left time: 1902.4575s
Epoch: 35 cost time: 30.878309965133667
Epoch: 35, Steps: 267 | Train Loss: 0.2922477 Vali Loss: 0.4052420 Test Loss: 0.3112144
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2919683
	speed: 0.4899s/iter; left time: 8453.0857s
	iters: 200, epoch: 36 | loss: 0.3009276
	speed: 0.1202s/iter; left time: 2061.5395s
Epoch: 36 cost time: 30.557496309280396
Epoch: 36, Steps: 267 | Train Loss: 0.2922775 Vali Loss: 0.4051574 Test Loss: 0.3111157
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2534509
	speed: 0.4871s/iter; left time: 8276.1091s
	iters: 200, epoch: 37 | loss: 0.2961918
	speed: 0.1062s/iter; left time: 1793.6737s
Epoch: 37 cost time: 30.87455940246582
Epoch: 37, Steps: 267 | Train Loss: 0.2921919 Vali Loss: 0.4059170 Test Loss: 0.3113180
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2704582
	speed: 0.5277s/iter; left time: 8824.4744s
	iters: 200, epoch: 38 | loss: 0.2650158
	speed: 0.1132s/iter; left time: 1880.8547s
Epoch: 38 cost time: 31.162928104400635
Epoch: 38, Steps: 267 | Train Loss: 0.2922610 Vali Loss: 0.4051419 Test Loss: 0.3112149
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3031730
	speed: 0.4605s/iter; left time: 7577.5095s
	iters: 200, epoch: 39 | loss: 0.3337634
	speed: 0.1018s/iter; left time: 1664.7611s
Epoch: 39 cost time: 28.07291054725647
Epoch: 39, Steps: 267 | Train Loss: 0.2922008 Vali Loss: 0.4055605 Test Loss: 0.3112930
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3297687
	speed: 0.4893s/iter; left time: 7920.2206s
	iters: 200, epoch: 40 | loss: 0.2964605
	speed: 0.1096s/iter; left time: 1763.8860s
Epoch: 40 cost time: 31.43967366218567
Epoch: 40, Steps: 267 | Train Loss: 0.2922141 Vali Loss: 0.4055152 Test Loss: 0.3113210
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31338226795196533, mae:0.3495832681655884, rse:0.5326833128929138, corr:[0.5506639  0.5550391  0.5564692  0.55553865 0.5535485  0.5519095
 0.55125254 0.5517359  0.5526969  0.55362827 0.55420685 0.553915
 0.55289674 0.5511326  0.54896057 0.5468101  0.54478127 0.5428875
 0.54107493 0.539267   0.5373963  0.535317   0.53301454 0.5306095
 0.5282651  0.5261945  0.5246405  0.52361745 0.5231007  0.5229725
 0.523186   0.5235301  0.52376676 0.5238357  0.5237097  0.5234623
 0.5230946  0.5226642  0.52230775 0.5220079  0.5218311  0.5217372
 0.5217327  0.521867   0.52210367 0.5224065  0.52273566 0.523027
 0.52323365 0.5233027  0.5232897  0.5232695  0.5232928  0.52334386
 0.523395   0.5233869  0.52335286 0.52322745 0.5230533  0.52282745
 0.5226161  0.52243817 0.52227753 0.52213436 0.52202946 0.5220459
 0.5221655  0.5223431  0.52261144 0.52291125 0.5231899  0.5233782
 0.5234312  0.52334255 0.52320474 0.52302665 0.52288145 0.5227823
 0.52270865 0.52261955 0.5224962  0.5223006  0.5220527  0.5217459
 0.5214415  0.5212244  0.5211293  0.52106935 0.52098954 0.5209214
 0.52089375 0.52094555 0.52112675 0.5214428  0.5216839  0.5213697 ]
