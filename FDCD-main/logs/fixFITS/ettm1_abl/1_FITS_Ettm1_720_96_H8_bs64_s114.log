Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=74, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  5503232.0
params:  6225.0
Trainable parameters:  6225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3331693
	speed: 0.0350s/iter; left time: 916.6192s
	iters: 200, epoch: 1 | loss: 0.2587074
	speed: 0.0333s/iter; left time: 868.6834s
Epoch: 1 cost time: 9.167980670928955
Epoch: 1, Steps: 263 | Train Loss: 0.3303434 Vali Loss: 0.4444095 Test Loss: 0.3150072
Validation loss decreased (inf --> 0.444409).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2637759
	speed: 0.1632s/iter; left time: 4231.8896s
	iters: 200, epoch: 2 | loss: 0.2492432
	speed: 0.0413s/iter; left time: 1067.7198s
Epoch: 2 cost time: 12.063665866851807
Epoch: 2, Steps: 263 | Train Loss: 0.2729097 Vali Loss: 0.4194557 Test Loss: 0.3120057
Validation loss decreased (0.444409 --> 0.419456).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3158017
	speed: 0.1646s/iter; left time: 4227.2773s
	iters: 200, epoch: 3 | loss: 0.2397878
	speed: 0.0334s/iter; left time: 854.6821s
Epoch: 3 cost time: 9.882895946502686
Epoch: 3, Steps: 263 | Train Loss: 0.2684817 Vali Loss: 0.4105325 Test Loss: 0.3113522
Validation loss decreased (0.419456 --> 0.410533).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2822985
	speed: 0.1521s/iter; left time: 3865.5096s
	iters: 200, epoch: 4 | loss: 0.2955792
	speed: 0.0276s/iter; left time: 698.7817s
Epoch: 4 cost time: 8.999916553497314
Epoch: 4, Steps: 263 | Train Loss: 0.2667741 Vali Loss: 0.4042054 Test Loss: 0.3111895
Validation loss decreased (0.410533 --> 0.404205).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2757605
	speed: 0.1430s/iter; left time: 3595.4422s
	iters: 200, epoch: 5 | loss: 0.2632269
	speed: 0.0349s/iter; left time: 873.4558s
Epoch: 5 cost time: 9.873680353164673
Epoch: 5, Steps: 263 | Train Loss: 0.2659274 Vali Loss: 0.4052054 Test Loss: 0.3103846
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2769343
	speed: 0.1285s/iter; left time: 3197.7258s
	iters: 200, epoch: 6 | loss: 0.2473607
	speed: 0.0226s/iter; left time: 559.9735s
Epoch: 6 cost time: 7.084163188934326
Epoch: 6, Steps: 263 | Train Loss: 0.2653520 Vali Loss: 0.4033640 Test Loss: 0.3101849
Validation loss decreased (0.404205 --> 0.403364).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2622855
	speed: 0.1438s/iter; left time: 3541.3038s
	iters: 200, epoch: 7 | loss: 0.2686526
	speed: 0.0328s/iter; left time: 805.3176s
Epoch: 7 cost time: 8.524542093276978
Epoch: 7, Steps: 263 | Train Loss: 0.2648961 Vali Loss: 0.4024751 Test Loss: 0.3101239
Validation loss decreased (0.403364 --> 0.402475).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2635998
	speed: 0.1343s/iter; left time: 3272.5777s
	iters: 200, epoch: 8 | loss: 0.2590291
	speed: 0.0378s/iter; left time: 918.1637s
Epoch: 8 cost time: 9.59026312828064
Epoch: 8, Steps: 263 | Train Loss: 0.2646269 Vali Loss: 0.3994615 Test Loss: 0.3102529
Validation loss decreased (0.402475 --> 0.399461).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2735099
	speed: 0.1458s/iter; left time: 3512.5355s
	iters: 200, epoch: 9 | loss: 0.2411426
	speed: 0.0292s/iter; left time: 699.7352s
Epoch: 9 cost time: 9.269872903823853
Epoch: 9, Steps: 263 | Train Loss: 0.2643094 Vali Loss: 0.3997370 Test Loss: 0.3095298
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2386620
	speed: 0.1839s/iter; left time: 4382.9615s
	iters: 200, epoch: 10 | loss: 0.2610515
	speed: 0.0343s/iter; left time: 814.1126s
Epoch: 10 cost time: 10.061944007873535
Epoch: 10, Steps: 263 | Train Loss: 0.2642065 Vali Loss: 0.3976556 Test Loss: 0.3096755
Validation loss decreased (0.399461 --> 0.397656).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2622706
	speed: 0.1491s/iter; left time: 3514.5754s
	iters: 200, epoch: 11 | loss: 0.2688733
	speed: 0.0327s/iter; left time: 767.5081s
Epoch: 11 cost time: 9.358577251434326
Epoch: 11, Steps: 263 | Train Loss: 0.2638398 Vali Loss: 0.3995096 Test Loss: 0.3102454
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2587908
	speed: 0.1230s/iter; left time: 2867.5448s
	iters: 200, epoch: 12 | loss: 0.2513128
	speed: 0.0268s/iter; left time: 622.1229s
Epoch: 12 cost time: 8.346577644348145
Epoch: 12, Steps: 263 | Train Loss: 0.2639287 Vali Loss: 0.3987702 Test Loss: 0.3093424
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2521906
	speed: 0.1428s/iter; left time: 3291.8940s
	iters: 200, epoch: 13 | loss: 0.2620020
	speed: 0.0282s/iter; left time: 647.9728s
Epoch: 13 cost time: 8.033678531646729
Epoch: 13, Steps: 263 | Train Loss: 0.2639030 Vali Loss: 0.4013948 Test Loss: 0.3098648
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2349768
	speed: 0.1248s/iter; left time: 2842.6454s
	iters: 200, epoch: 14 | loss: 0.2670191
	speed: 0.0353s/iter; left time: 801.2025s
Epoch: 14 cost time: 8.607492923736572
Epoch: 14, Steps: 263 | Train Loss: 0.2635978 Vali Loss: 0.3989509 Test Loss: 0.3098707
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2578951
	speed: 0.1280s/iter; left time: 2882.7908s
	iters: 200, epoch: 15 | loss: 0.2886944
	speed: 0.0316s/iter; left time: 708.6376s
Epoch: 15 cost time: 8.368406772613525
Epoch: 15, Steps: 263 | Train Loss: 0.2636123 Vali Loss: 0.3985476 Test Loss: 0.3101917
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2669719
	speed: 0.1371s/iter; left time: 3050.7468s
	iters: 200, epoch: 16 | loss: 0.2554619
	speed: 0.0306s/iter; left time: 677.2335s
Epoch: 16 cost time: 9.3443021774292
Epoch: 16, Steps: 263 | Train Loss: 0.2635913 Vali Loss: 0.3971347 Test Loss: 0.3100611
Validation loss decreased (0.397656 --> 0.397135).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2594750
	speed: 0.1554s/iter; left time: 3417.9513s
	iters: 200, epoch: 17 | loss: 0.2604972
	speed: 0.0318s/iter; left time: 696.9866s
Epoch: 17 cost time: 9.158935546875
Epoch: 17, Steps: 263 | Train Loss: 0.2635559 Vali Loss: 0.3977421 Test Loss: 0.3096166
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2994532
	speed: 0.1479s/iter; left time: 3213.1963s
	iters: 200, epoch: 18 | loss: 0.2873727
	speed: 0.0301s/iter; left time: 650.5680s
Epoch: 18 cost time: 9.017415523529053
Epoch: 18, Steps: 263 | Train Loss: 0.2634049 Vali Loss: 0.3969815 Test Loss: 0.3096974
Validation loss decreased (0.397135 --> 0.396982).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2487549
	speed: 0.1435s/iter; left time: 3081.1451s
	iters: 200, epoch: 19 | loss: 0.2579449
	speed: 0.0311s/iter; left time: 665.0142s
Epoch: 19 cost time: 9.672829627990723
Epoch: 19, Steps: 263 | Train Loss: 0.2634327 Vali Loss: 0.3969381 Test Loss: 0.3096947
Validation loss decreased (0.396982 --> 0.396938).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2640356
	speed: 0.1313s/iter; left time: 2784.5405s
	iters: 200, epoch: 20 | loss: 0.2539752
	speed: 0.0292s/iter; left time: 616.3305s
Epoch: 20 cost time: 10.430940389633179
Epoch: 20, Steps: 263 | Train Loss: 0.2634707 Vali Loss: 0.3959329 Test Loss: 0.3094676
Validation loss decreased (0.396938 --> 0.395933).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2776894
	speed: 0.1659s/iter; left time: 3473.7924s
	iters: 200, epoch: 21 | loss: 0.2826044
	speed: 0.0338s/iter; left time: 704.1458s
Epoch: 21 cost time: 8.867942571640015
Epoch: 21, Steps: 263 | Train Loss: 0.2632894 Vali Loss: 0.3977541 Test Loss: 0.3095284
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2391617
	speed: 0.1386s/iter; left time: 2865.3343s
	iters: 200, epoch: 22 | loss: 0.2982194
	speed: 0.0333s/iter; left time: 685.6503s
Epoch: 22 cost time: 9.334813356399536
Epoch: 22, Steps: 263 | Train Loss: 0.2632745 Vali Loss: 0.3972642 Test Loss: 0.3091720
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2497027
	speed: 0.1473s/iter; left time: 3006.2524s
	iters: 200, epoch: 23 | loss: 0.2586060
	speed: 0.0359s/iter; left time: 729.0847s
Epoch: 23 cost time: 8.894006729125977
Epoch: 23, Steps: 263 | Train Loss: 0.2633395 Vali Loss: 0.3972706 Test Loss: 0.3094219
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2546927
	speed: 0.1355s/iter; left time: 2729.6933s
	iters: 200, epoch: 24 | loss: 0.2742600
	speed: 0.0368s/iter; left time: 738.0932s
Epoch: 24 cost time: 8.737406969070435
Epoch: 24, Steps: 263 | Train Loss: 0.2632738 Vali Loss: 0.3966563 Test Loss: 0.3098597
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2664432
	speed: 0.1504s/iter; left time: 2990.3303s
	iters: 200, epoch: 25 | loss: 0.2671671
	speed: 0.0332s/iter; left time: 656.5552s
Epoch: 25 cost time: 10.591365337371826
Epoch: 25, Steps: 263 | Train Loss: 0.2632543 Vali Loss: 0.3986406 Test Loss: 0.3095019
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2758724
	speed: 0.1502s/iter; left time: 2947.7181s
	iters: 200, epoch: 26 | loss: 0.2772463
	speed: 0.0309s/iter; left time: 602.3815s
Epoch: 26 cost time: 8.921314477920532
Epoch: 26, Steps: 263 | Train Loss: 0.2632264 Vali Loss: 0.3976598 Test Loss: 0.3096540
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2676390
	speed: 0.1542s/iter; left time: 2985.0121s
	iters: 200, epoch: 27 | loss: 0.2637653
	speed: 0.0280s/iter; left time: 539.8597s
Epoch: 27 cost time: 8.580039024353027
Epoch: 27, Steps: 263 | Train Loss: 0.2631339 Vali Loss: 0.3965961 Test Loss: 0.3095679
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2748849
	speed: 0.1347s/iter; left time: 2573.4809s
	iters: 200, epoch: 28 | loss: 0.2603361
	speed: 0.0255s/iter; left time: 484.1449s
Epoch: 28 cost time: 8.107978105545044
Epoch: 28, Steps: 263 | Train Loss: 0.2630921 Vali Loss: 0.3977565 Test Loss: 0.3096354
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2575351
	speed: 0.1521s/iter; left time: 2864.8292s
	iters: 200, epoch: 29 | loss: 0.2381181
	speed: 0.0356s/iter; left time: 666.1993s
Epoch: 29 cost time: 10.266041278839111
Epoch: 29, Steps: 263 | Train Loss: 0.2631836 Vali Loss: 0.3980317 Test Loss: 0.3095401
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2336868
	speed: 0.1437s/iter; left time: 2669.8804s
	iters: 200, epoch: 30 | loss: 0.2504051
	speed: 0.0273s/iter; left time: 504.2612s
Epoch: 30 cost time: 8.647922039031982
Epoch: 30, Steps: 263 | Train Loss: 0.2629951 Vali Loss: 0.3963612 Test Loss: 0.3097132
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2807423
	speed: 0.1288s/iter; left time: 2358.0766s
	iters: 200, epoch: 31 | loss: 0.2406982
	speed: 0.0285s/iter; left time: 519.6141s
Epoch: 31 cost time: 8.319340705871582
Epoch: 31, Steps: 263 | Train Loss: 0.2631228 Vali Loss: 0.3966075 Test Loss: 0.3095976
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2567987
	speed: 0.1455s/iter; left time: 2626.2301s
	iters: 200, epoch: 32 | loss: 0.2483434
	speed: 0.0263s/iter; left time: 472.7025s
Epoch: 32 cost time: 8.18611478805542
Epoch: 32, Steps: 263 | Train Loss: 0.2632455 Vali Loss: 0.3966034 Test Loss: 0.3095518
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2657954
	speed: 0.1398s/iter; left time: 2486.7870s
	iters: 200, epoch: 33 | loss: 0.2610373
	speed: 0.0323s/iter; left time: 570.8302s
Epoch: 33 cost time: 9.80055284500122
Epoch: 33, Steps: 263 | Train Loss: 0.2631103 Vali Loss: 0.3972947 Test Loss: 0.3095049
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2698784
	speed: 0.1408s/iter; left time: 2467.1133s
	iters: 200, epoch: 34 | loss: 0.2691786
	speed: 0.0422s/iter; left time: 734.9645s
Epoch: 34 cost time: 10.762670278549194
Epoch: 34, Steps: 263 | Train Loss: 0.2630460 Vali Loss: 0.3970999 Test Loss: 0.3095158
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2673163
	speed: 0.1348s/iter; left time: 2326.1270s
	iters: 200, epoch: 35 | loss: 0.2674711
	speed: 0.0280s/iter; left time: 480.3475s
Epoch: 35 cost time: 8.642826080322266
Epoch: 35, Steps: 263 | Train Loss: 0.2630000 Vali Loss: 0.3972361 Test Loss: 0.3093932
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2809974
	speed: 0.1377s/iter; left time: 2340.4596s
	iters: 200, epoch: 36 | loss: 0.2470427
	speed: 0.0381s/iter; left time: 644.1544s
Epoch: 36 cost time: 10.255834817886353
Epoch: 36, Steps: 263 | Train Loss: 0.2630697 Vali Loss: 0.3975884 Test Loss: 0.3095207
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2834545
	speed: 0.1398s/iter; left time: 2339.6460s
	iters: 200, epoch: 37 | loss: 0.2504104
	speed: 0.0313s/iter; left time: 520.8545s
Epoch: 37 cost time: 8.936432600021362
Epoch: 37, Steps: 263 | Train Loss: 0.2631034 Vali Loss: 0.3972974 Test Loss: 0.3095475
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2452258
	speed: 0.1323s/iter; left time: 2178.3197s
	iters: 200, epoch: 38 | loss: 0.2628852
	speed: 0.0308s/iter; left time: 504.3013s
Epoch: 38 cost time: 8.94714069366455
Epoch: 38, Steps: 263 | Train Loss: 0.2630145 Vali Loss: 0.3964054 Test Loss: 0.3096570
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2600704
	speed: 0.1230s/iter; left time: 1993.2464s
	iters: 200, epoch: 39 | loss: 0.2629519
	speed: 0.0360s/iter; left time: 579.2813s
Epoch: 39 cost time: 9.77430009841919
Epoch: 39, Steps: 263 | Train Loss: 0.2630431 Vali Loss: 0.3974210 Test Loss: 0.3096657
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2399451
	speed: 0.1485s/iter; left time: 2368.2102s
	iters: 200, epoch: 40 | loss: 0.2741436
	speed: 0.0322s/iter; left time: 509.6564s
Epoch: 40 cost time: 8.23250675201416
Epoch: 40, Steps: 263 | Train Loss: 0.2630701 Vali Loss: 0.3968522 Test Loss: 0.3096130
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3110958933830261, mae:0.3534168004989624, rse:0.5307366251945496, corr:[0.5460723  0.55393815 0.559591   0.56242204 0.563327   0.56369454
 0.5643066  0.56543285 0.56697094 0.56849587 0.56962854 0.570059
 0.5698593  0.5692073  0.56829876 0.5672973  0.56632507 0.5653974
 0.56440294 0.56328255 0.56206566 0.5606995  0.5591759  0.5576869
 0.5562194  0.554994   0.55412316 0.553585   0.5534746  0.5537556
 0.5542948  0.55497926 0.55556583 0.5559854  0.5560807  0.556002
 0.55569875 0.55532473 0.5549874  0.5546608  0.5544541  0.5543106
 0.5542013  0.5541853  0.5541263  0.5539628  0.55378836 0.553639
 0.553477   0.553265   0.5531035  0.55300075 0.5529724  0.5528765
 0.5527016  0.552471   0.5522415  0.5520236  0.55191994 0.5518592
 0.55183434 0.55180585 0.5517193  0.55146164 0.5511411  0.5508707
 0.5507105  0.55071384 0.55089515 0.5511655  0.5514476  0.5516027
 0.5515192  0.5511889  0.55074114 0.5502592  0.5498195  0.5494843
 0.54926586 0.5491367  0.54903495 0.5488415  0.54853624 0.54808766
 0.5476204  0.54722196 0.5470076  0.5469483  0.5469933  0.54711545
 0.5472297  0.5473127  0.5474726  0.54784894 0.54845965 0.54897577]
