Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=144, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=True, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Weather_90_j336_H12', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=2021, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Weather_90_j336_H12_FITS_custom_ftM_sl90_ll48_pl336_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36462
val 4935
test 10204
Model(
  (freq_upsampler): ModuleList(
    (0): Linear(in_features=22, out_features=104, bias=True)
    (1): Linear(in_features=22, out_features=104, bias=True)
    (2): Linear(in_features=22, out_features=104, bias=True)
    (3): Linear(in_features=22, out_features=104, bias=True)
    (4): Linear(in_features=22, out_features=104, bias=True)
    (5): Linear(in_features=22, out_features=104, bias=True)
    (6): Linear(in_features=22, out_features=104, bias=True)
    (7): Linear(in_features=22, out_features=104, bias=True)
    (8): Linear(in_features=22, out_features=104, bias=True)
    (9): Linear(in_features=22, out_features=104, bias=True)
    (10): Linear(in_features=22, out_features=104, bias=True)
    (11): Linear(in_features=22, out_features=104, bias=True)
    (12): Linear(in_features=22, out_features=104, bias=True)
    (13): Linear(in_features=22, out_features=104, bias=True)
    (14): Linear(in_features=22, out_features=104, bias=True)
    (15): Linear(in_features=22, out_features=104, bias=True)
    (16): Linear(in_features=22, out_features=104, bias=True)
    (17): Linear(in_features=22, out_features=104, bias=True)
    (18): Linear(in_features=22, out_features=104, bias=True)
    (19): Linear(in_features=22, out_features=104, bias=True)
    (20): Linear(in_features=22, out_features=104, bias=True)
  )
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3075072.0
params:  50232.0
Trainable parameters:  50232
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.8492823
	speed: 0.3269s/iter; left time: 18569.3287s
	iters: 200, epoch: 1 | loss: 0.6519610
	speed: 0.2994s/iter; left time: 16978.1615s
	iters: 300, epoch: 1 | loss: 0.6934686
	speed: 0.3035s/iter; left time: 17178.2152s
	iters: 400, epoch: 1 | loss: 0.6291202
	speed: 0.3014s/iter; left time: 17029.4016s
	iters: 500, epoch: 1 | loss: 0.5518586
	speed: 0.2893s/iter; left time: 16315.1502s
Epoch: 1 cost time: 177.2728922367096
Epoch: 1, Steps: 569 | Train Loss: 0.7882998 Vali Loss: 0.6968215 Test Loss: 0.2947999
Validation loss decreased (inf --> 0.696822).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.6035580
	speed: 1.6401s/iter; left time: 92225.4123s
	iters: 200, epoch: 2 | loss: 0.4750224
	speed: 0.3009s/iter; left time: 16890.5569s
	iters: 300, epoch: 2 | loss: 0.7614056
	speed: 0.2820s/iter; left time: 15799.7382s
	iters: 400, epoch: 2 | loss: 0.4978778
	speed: 0.2957s/iter; left time: 16539.8085s
	iters: 500, epoch: 2 | loss: 0.4625054
	speed: 0.3071s/iter; left time: 17145.1224s
Epoch: 2 cost time: 169.10339450836182
Epoch: 2, Steps: 569 | Train Loss: 0.5683835 Vali Loss: 0.6381570 Test Loss: 0.2833586
Validation loss decreased (0.696822 --> 0.638157).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3871751
	speed: 1.4152s/iter; left time: 78771.7694s
	iters: 200, epoch: 3 | loss: 0.5441214
	speed: 0.2759s/iter; left time: 15328.7349s
	iters: 300, epoch: 3 | loss: 0.4086586
	speed: 0.2756s/iter; left time: 15285.4010s
	iters: 400, epoch: 3 | loss: 0.6858399
	speed: 0.2792s/iter; left time: 15460.0694s
	iters: 500, epoch: 3 | loss: 0.5437237
	speed: 0.2653s/iter; left time: 14661.8520s
Epoch: 3 cost time: 157.46619582176208
Epoch: 3, Steps: 569 | Train Loss: 0.5277775 Vali Loss: 0.6205998 Test Loss: 0.2797007
Validation loss decreased (0.638157 --> 0.620600).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.5337667
	speed: 1.5175s/iter; left time: 83605.8996s
	iters: 200, epoch: 4 | loss: 0.4522460
	speed: 0.2857s/iter; left time: 15710.6869s
	iters: 300, epoch: 4 | loss: 0.5669402
	speed: 0.2783s/iter; left time: 15276.9728s
	iters: 400, epoch: 4 | loss: 0.4492539
	speed: 0.2745s/iter; left time: 15041.8348s
	iters: 500, epoch: 4 | loss: 0.4151918
	speed: 0.2709s/iter; left time: 14819.1256s
Epoch: 4 cost time: 159.6177670955658
Epoch: 4, Steps: 569 | Train Loss: 0.5101011 Vali Loss: 0.6114116 Test Loss: 0.2778749
Validation loss decreased (0.620600 --> 0.611412).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4290828
	speed: 1.4936s/iter; left time: 81437.6426s
	iters: 200, epoch: 5 | loss: 0.3712975
	speed: 0.2782s/iter; left time: 15139.2074s
	iters: 300, epoch: 5 | loss: 0.4264064
	speed: 0.2715s/iter; left time: 14751.1964s
	iters: 400, epoch: 5 | loss: 0.4909052
	speed: 0.2745s/iter; left time: 14884.9969s
	iters: 500, epoch: 5 | loss: 0.5714893
	speed: 0.2738s/iter; left time: 14820.1414s
Epoch: 5 cost time: 156.46048140525818
Epoch: 5, Steps: 569 | Train Loss: 0.5007519 Vali Loss: 0.6064849 Test Loss: 0.2766922
Validation loss decreased (0.611412 --> 0.606485).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4479298
	speed: 1.4963s/iter; left time: 80733.6349s
	iters: 200, epoch: 6 | loss: 0.8047127
	speed: 0.2820s/iter; left time: 15187.7440s
	iters: 300, epoch: 6 | loss: 0.5229630
	speed: 0.2782s/iter; left time: 14952.6642s
	iters: 400, epoch: 6 | loss: 0.4193703
	speed: 0.2848s/iter; left time: 15280.8734s
	iters: 500, epoch: 6 | loss: 0.4453339
	speed: 0.2682s/iter; left time: 14363.3038s
Epoch: 6 cost time: 159.5380916595459
Epoch: 6, Steps: 569 | Train Loss: 0.4952496 Vali Loss: 0.6029987 Test Loss: 0.2762785
Validation loss decreased (0.606485 --> 0.602999).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4591087
	speed: 1.4792s/iter; left time: 78968.3825s
	iters: 200, epoch: 7 | loss: 0.3944445
	speed: 0.2772s/iter; left time: 14771.6659s
	iters: 300, epoch: 7 | loss: 0.5434450
	speed: 0.2685s/iter; left time: 14280.2097s
	iters: 400, epoch: 7 | loss: 0.6387449
	speed: 0.2690s/iter; left time: 14282.9528s
	iters: 500, epoch: 7 | loss: 0.4404241
	speed: 0.2740s/iter; left time: 14519.8968s
Epoch: 7 cost time: 155.5744333267212
Epoch: 7, Steps: 569 | Train Loss: 0.4928882 Vali Loss: 0.6006051 Test Loss: 0.2758230
Validation loss decreased (0.602999 --> 0.600605).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.6255740
	speed: 1.4754s/iter; left time: 77929.7814s
	iters: 200, epoch: 8 | loss: 0.8384656
	speed: 0.2702s/iter; left time: 14242.0304s
	iters: 300, epoch: 8 | loss: 0.4987105
	speed: 0.2810s/iter; left time: 14783.9639s
	iters: 400, epoch: 8 | loss: 0.4445668
	speed: 0.2645s/iter; left time: 13892.3850s
	iters: 500, epoch: 8 | loss: 0.4832426
	speed: 0.2804s/iter; left time: 14700.1874s
Epoch: 8 cost time: 157.38018155097961
Epoch: 8, Steps: 569 | Train Loss: 0.4911611 Vali Loss: 0.5995510 Test Loss: 0.2754370
Validation loss decreased (0.600605 --> 0.599551).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4231948
	speed: 1.4699s/iter; left time: 76799.3967s
	iters: 200, epoch: 9 | loss: 0.3909245
	speed: 0.2792s/iter; left time: 14560.4244s
	iters: 300, epoch: 9 | loss: 0.4046343
	speed: 0.2748s/iter; left time: 14303.9153s
	iters: 400, epoch: 9 | loss: 0.5054757
	speed: 0.2711s/iter; left time: 14082.9089s
	iters: 500, epoch: 9 | loss: 0.4124805
	speed: 0.2732s/iter; left time: 14163.1665s
Epoch: 9 cost time: 157.6362771987915
Epoch: 9, Steps: 569 | Train Loss: 0.4903042 Vali Loss: 0.5977761 Test Loss: 0.2751245
Validation loss decreased (0.599551 --> 0.597776).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.4895194
	speed: 1.4685s/iter; left time: 75891.8275s
	iters: 200, epoch: 10 | loss: 0.3756560
	speed: 0.2616s/iter; left time: 13494.2345s
	iters: 300, epoch: 10 | loss: 0.7510057
	speed: 0.2733s/iter; left time: 14070.0968s
	iters: 400, epoch: 10 | loss: 0.5331386
	speed: 0.2717s/iter; left time: 13960.4373s
	iters: 500, epoch: 10 | loss: 0.6429029
	speed: 0.2595s/iter; left time: 13306.8803s
Epoch: 10 cost time: 152.45336890220642
Epoch: 10, Steps: 569 | Train Loss: 0.4894772 Vali Loss: 0.5966913 Test Loss: 0.2747966
Validation loss decreased (0.597776 --> 0.596691).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.5346566
	speed: 1.4331s/iter; left time: 73245.1930s
	iters: 200, epoch: 11 | loss: 0.5477471
	speed: 0.2618s/iter; left time: 13357.2021s
	iters: 300, epoch: 11 | loss: 0.4192987
	speed: 0.2797s/iter; left time: 14242.2643s
	iters: 400, epoch: 11 | loss: 0.5393630
	speed: 0.2717s/iter; left time: 13803.7334s
	iters: 500, epoch: 11 | loss: 0.3970174
	speed: 0.2706s/iter; left time: 13719.9649s
Epoch: 11 cost time: 153.19393825531006
Epoch: 11, Steps: 569 | Train Loss: 0.4888470 Vali Loss: 0.5963205 Test Loss: 0.2745006
Validation loss decreased (0.596691 --> 0.596320).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.5310338
	speed: 1.4371s/iter; left time: 72634.6064s
	iters: 200, epoch: 12 | loss: 0.5321747
	speed: 0.2707s/iter; left time: 13656.1468s
	iters: 300, epoch: 12 | loss: 0.3782537
	speed: 0.2614s/iter; left time: 13157.0565s
	iters: 400, epoch: 12 | loss: 0.4676840
	speed: 0.2735s/iter; left time: 13739.4568s
	iters: 500, epoch: 12 | loss: 0.4206586
	speed: 0.2685s/iter; left time: 13460.9774s
Epoch: 12 cost time: 153.45701360702515
Epoch: 12, Steps: 569 | Train Loss: 0.4885965 Vali Loss: 0.5959367 Test Loss: 0.2742398
Validation loss decreased (0.596320 --> 0.595937).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.5050217
	speed: 1.4119s/iter; left time: 70558.7789s
	iters: 200, epoch: 13 | loss: 0.6271473
	speed: 0.2594s/iter; left time: 12934.7015s
	iters: 300, epoch: 13 | loss: 0.4127515
	speed: 0.2660s/iter; left time: 13242.0994s
	iters: 400, epoch: 13 | loss: 0.4128548
	speed: 0.2655s/iter; left time: 13189.4500s
	iters: 500, epoch: 13 | loss: 0.7137564
	speed: 0.2664s/iter; left time: 13204.9110s
Epoch: 13 cost time: 150.70643544197083
Epoch: 13, Steps: 569 | Train Loss: 0.4880565 Vali Loss: 0.5956185 Test Loss: 0.2740603
Validation loss decreased (0.595937 --> 0.595618).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.5322835
	speed: 1.3534s/iter; left time: 66861.4166s
	iters: 200, epoch: 14 | loss: 0.3957665
	speed: 0.2316s/iter; left time: 11417.2109s
	iters: 300, epoch: 14 | loss: 0.4447388
	speed: 0.2342s/iter; left time: 11525.9766s
	iters: 400, epoch: 14 | loss: 0.4113964
	speed: 0.2386s/iter; left time: 11714.4022s
	iters: 500, epoch: 14 | loss: 0.6450505
	speed: 0.2405s/iter; left time: 11787.6817s
Epoch: 14 cost time: 135.89406442642212
Epoch: 14, Steps: 569 | Train Loss: 0.4874066 Vali Loss: 0.5949594 Test Loss: 0.2737159
Validation loss decreased (0.595618 --> 0.594959).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.4950217
	speed: 1.2310s/iter; left time: 60115.9060s
	iters: 200, epoch: 15 | loss: 0.6109717
	speed: 0.2055s/iter; left time: 10016.4575s
	iters: 300, epoch: 15 | loss: 0.3635608
	speed: 0.1917s/iter; left time: 9323.7154s
	iters: 400, epoch: 15 | loss: 0.5564476
	speed: 0.2795s/iter; left time: 13567.4398s
	iters: 500, epoch: 15 | loss: 0.6552281
	speed: 0.3210s/iter; left time: 15549.3566s
Epoch: 15 cost time: 145.440979719162
Epoch: 15, Steps: 569 | Train Loss: 0.4874621 Vali Loss: 0.5942683 Test Loss: 0.2735222
Validation loss decreased (0.594959 --> 0.594268).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4108758
	speed: 1.8990s/iter; left time: 91658.7177s
	iters: 200, epoch: 16 | loss: 0.5095763
	speed: 0.3448s/iter; left time: 16608.2555s
	iters: 300, epoch: 16 | loss: 0.3756845
	speed: 0.3519s/iter; left time: 16915.4252s
	iters: 400, epoch: 16 | loss: 0.4020809
	speed: 0.3588s/iter; left time: 17209.2530s
	iters: 500, epoch: 16 | loss: 0.6048179
	speed: 0.3417s/iter; left time: 16356.6443s
Epoch: 16 cost time: 199.733980178833
Epoch: 16, Steps: 569 | Train Loss: 0.4869880 Vali Loss: 0.5938126 Test Loss: 0.2732762
Validation loss decreased (0.594268 --> 0.593813).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.5777507
	speed: 1.9071s/iter; left time: 90962.4576s
	iters: 200, epoch: 17 | loss: 0.4515734
	speed: 0.3522s/iter; left time: 16761.8767s
	iters: 300, epoch: 17 | loss: 0.4234306
	speed: 0.3638s/iter; left time: 17279.6264s
	iters: 400, epoch: 17 | loss: 0.4835616
	speed: 0.3447s/iter; left time: 16339.8924s
	iters: 500, epoch: 17 | loss: 0.4407589
	speed: 0.3624s/iter; left time: 17138.7142s
Epoch: 17 cost time: 202.18431973457336
Epoch: 17, Steps: 569 | Train Loss: 0.4868550 Vali Loss: 0.5928523 Test Loss: 0.2731293
Validation loss decreased (0.593813 --> 0.592852).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.8304428
	speed: 1.9030s/iter; left time: 89684.6485s
	iters: 200, epoch: 18 | loss: 0.5772110
	speed: 0.3602s/iter; left time: 16938.2009s
	iters: 300, epoch: 18 | loss: 0.3739081
	speed: 0.3426s/iter; left time: 16077.8808s
	iters: 400, epoch: 18 | loss: 0.4602041
	speed: 0.3371s/iter; left time: 15783.9491s
	iters: 500, epoch: 18 | loss: 0.4106074
	speed: 0.3569s/iter; left time: 16678.0830s
Epoch: 18 cost time: 199.50155067443848
Epoch: 18, Steps: 569 | Train Loss: 0.4864557 Vali Loss: 0.5927084 Test Loss: 0.2729006
Validation loss decreased (0.592852 --> 0.592708).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3911618
	speed: 1.8565s/iter; left time: 86436.1464s
	iters: 200, epoch: 19 | loss: 0.8285217
	speed: 0.3551s/iter; left time: 16496.2625s
	iters: 300, epoch: 19 | loss: 0.4037913
	speed: 0.3618s/iter; left time: 16771.1129s
	iters: 400, epoch: 19 | loss: 0.5877980
	speed: 0.3606s/iter; left time: 16679.9078s
	iters: 500, epoch: 19 | loss: 0.4011615
	speed: 0.3561s/iter; left time: 16438.4554s
Epoch: 19 cost time: 205.13358068466187
Epoch: 19, Steps: 569 | Train Loss: 0.4864451 Vali Loss: 0.5925989 Test Loss: 0.2727944
Validation loss decreased (0.592708 --> 0.592599).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.4224541
	speed: 1.8927s/iter; left time: 87043.6735s
	iters: 200, epoch: 20 | loss: 0.7333691
	speed: 0.3567s/iter; left time: 16367.3527s
	iters: 300, epoch: 20 | loss: 0.5150502
	speed: 0.3523s/iter; left time: 16131.7940s
	iters: 400, epoch: 20 | loss: 0.3949966
	speed: 0.3548s/iter; left time: 16212.8073s
	iters: 500, epoch: 20 | loss: 0.5142643
	speed: 0.3449s/iter; left time: 15725.5472s
Epoch: 20 cost time: 199.73348474502563
Epoch: 20, Steps: 569 | Train Loss: 0.4861300 Vali Loss: 0.5922715 Test Loss: 0.2726074
Validation loss decreased (0.592599 --> 0.592272).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3793226
	speed: 1.8603s/iter; left time: 84497.6701s
	iters: 200, epoch: 21 | loss: 0.5728347
	speed: 0.3547s/iter; left time: 16075.6955s
	iters: 300, epoch: 21 | loss: 0.5610764
	speed: 0.3466s/iter; left time: 15674.4170s
	iters: 400, epoch: 21 | loss: 0.4427190
	speed: 0.3444s/iter; left time: 15540.2226s
	iters: 500, epoch: 21 | loss: 0.4758967
	speed: 0.3401s/iter; left time: 15312.4122s
Epoch: 21 cost time: 198.43224120140076
Epoch: 21, Steps: 569 | Train Loss: 0.4859378 Vali Loss: 0.5917316 Test Loss: 0.2724648
Validation loss decreased (0.592272 --> 0.591732).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4278296
	speed: 1.8093s/iter; left time: 81149.0447s
	iters: 200, epoch: 22 | loss: 0.6815251
	speed: 0.3406s/iter; left time: 15243.0272s
	iters: 300, epoch: 22 | loss: 0.5332978
	speed: 0.3622s/iter; left time: 16172.7842s
	iters: 400, epoch: 22 | loss: 0.4353923
	speed: 0.3471s/iter; left time: 15463.9101s
	iters: 500, epoch: 22 | loss: 0.4325258
	speed: 0.3544s/iter; left time: 15755.1323s
Epoch: 22 cost time: 199.6906967163086
Epoch: 22, Steps: 569 | Train Loss: 0.4857652 Vali Loss: 0.5909070 Test Loss: 0.2723700
Validation loss decreased (0.591732 --> 0.590907).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.5277984
	speed: 1.8521s/iter; left time: 82017.8070s
	iters: 200, epoch: 23 | loss: 0.6708359
	speed: 0.3482s/iter; left time: 15382.9588s
	iters: 300, epoch: 23 | loss: 0.4596105
	speed: 0.3533s/iter; left time: 15576.5334s
	iters: 400, epoch: 23 | loss: 0.4881187
	speed: 0.3414s/iter; left time: 15017.7881s
	iters: 500, epoch: 23 | loss: 0.5580758
	speed: 0.3509s/iter; left time: 15399.0646s
Epoch: 23 cost time: 199.73235630989075
Epoch: 23, Steps: 569 | Train Loss: 0.4855915 Vali Loss: 0.5918461 Test Loss: 0.2722072
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.4853804
	speed: 1.8882s/iter; left time: 82541.1370s
	iters: 200, epoch: 24 | loss: 0.5038658
	speed: 0.3275s/iter; left time: 14284.0818s
	iters: 300, epoch: 24 | loss: 0.5057833
	speed: 0.3542s/iter; left time: 15413.6889s
	iters: 400, epoch: 24 | loss: 0.5891343
	speed: 0.3496s/iter; left time: 15179.4664s
	iters: 500, epoch: 24 | loss: 0.4771779
	speed: 0.3365s/iter; left time: 14573.3167s
Epoch: 24 cost time: 195.7799117565155
Epoch: 24, Steps: 569 | Train Loss: 0.4853134 Vali Loss: 0.5907286 Test Loss: 0.2720631
Validation loss decreased (0.590907 --> 0.590729).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4523685
	speed: 1.8199s/iter; left time: 78521.2027s
	iters: 200, epoch: 25 | loss: 0.3726446
	speed: 0.3509s/iter; left time: 15103.0697s
	iters: 300, epoch: 25 | loss: 0.4999999
	speed: 0.3492s/iter; left time: 14995.7449s
	iters: 400, epoch: 25 | loss: 0.5273390
	speed: 0.3455s/iter; left time: 14801.9501s
	iters: 500, epoch: 25 | loss: 0.5954535
	speed: 0.3514s/iter; left time: 15020.2729s
Epoch: 25 cost time: 197.455726146698
Epoch: 25, Steps: 569 | Train Loss: 0.4851203 Vali Loss: 0.5911033 Test Loss: 0.2720359
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.5107958
	speed: 1.8463s/iter; left time: 78607.4007s
	iters: 200, epoch: 26 | loss: 0.5750191
	speed: 0.3526s/iter; left time: 14977.9547s
	iters: 300, epoch: 26 | loss: 0.4994778
	speed: 0.3449s/iter; left time: 14616.7750s
	iters: 400, epoch: 26 | loss: 0.4073922
	speed: 0.3509s/iter; left time: 14835.7582s
	iters: 500, epoch: 26 | loss: 0.4136330
	speed: 0.3384s/iter; left time: 14270.6738s
Epoch: 26 cost time: 196.6550772190094
Epoch: 26, Steps: 569 | Train Loss: 0.4848215 Vali Loss: 0.5912371 Test Loss: 0.2719319
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.6613471
	speed: 1.9037s/iter; left time: 79968.8480s
	iters: 200, epoch: 27 | loss: 0.4339903
	speed: 0.3500s/iter; left time: 14666.7095s
	iters: 300, epoch: 27 | loss: 0.5060174
	speed: 0.3348s/iter; left time: 13996.9090s
	iters: 400, epoch: 27 | loss: 0.4178927
	speed: 0.3415s/iter; left time: 14241.6305s
	iters: 500, epoch: 27 | loss: 0.5106470
	speed: 0.3453s/iter; left time: 14366.9609s
Epoch: 27 cost time: 196.56229496002197
Epoch: 27, Steps: 569 | Train Loss: 0.4848714 Vali Loss: 0.5906490 Test Loss: 0.2718607
Validation loss decreased (0.590729 --> 0.590649).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.4659703
	speed: 1.8471s/iter; left time: 76541.5870s
	iters: 200, epoch: 28 | loss: 0.4291473
	speed: 0.3354s/iter; left time: 13864.1017s
	iters: 300, epoch: 28 | loss: 0.4226111
	speed: 0.3579s/iter; left time: 14759.0317s
	iters: 400, epoch: 28 | loss: 0.5136761
	speed: 0.3486s/iter; left time: 14342.5014s
	iters: 500, epoch: 28 | loss: 0.3916686
	speed: 0.3321s/iter; left time: 13630.7062s
Epoch: 28 cost time: 197.6793999671936
Epoch: 28, Steps: 569 | Train Loss: 0.4845983 Vali Loss: 0.5907823 Test Loss: 0.2717813
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3839737
	speed: 1.8374s/iter; left time: 75094.3459s
	iters: 200, epoch: 29 | loss: 0.4085063
	speed: 0.3426s/iter; left time: 13968.3115s
	iters: 300, epoch: 29 | loss: 0.4212490
	speed: 0.3398s/iter; left time: 13819.4010s
	iters: 400, epoch: 29 | loss: 0.4815595
	speed: 0.3369s/iter; left time: 13668.3111s
	iters: 500, epoch: 29 | loss: 0.6428351
	speed: 0.3447s/iter; left time: 13950.3895s
Epoch: 29 cost time: 194.18459630012512
Epoch: 29, Steps: 569 | Train Loss: 0.4846307 Vali Loss: 0.5903997 Test Loss: 0.2717029
Validation loss decreased (0.590649 --> 0.590400).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4844753
	speed: 1.7034s/iter; left time: 68648.6632s
	iters: 200, epoch: 30 | loss: 0.3618391
	speed: 0.2789s/iter; left time: 11210.1043s
	iters: 300, epoch: 30 | loss: 0.5769159
	speed: 0.2751s/iter; left time: 11031.5626s
	iters: 400, epoch: 30 | loss: 0.3638057
	speed: 0.2932s/iter; left time: 11726.9629s
	iters: 500, epoch: 30 | loss: 0.3945662
	speed: 0.2819s/iter; left time: 11249.7717s
Epoch: 30 cost time: 161.67712926864624
Epoch: 30, Steps: 569 | Train Loss: 0.4846228 Vali Loss: 0.5905482 Test Loss: 0.2716079
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3980356
	speed: 1.5276s/iter; left time: 60693.6833s
	iters: 200, epoch: 31 | loss: 0.4732813
	speed: 0.2969s/iter; left time: 11766.1617s
	iters: 300, epoch: 31 | loss: 0.4880825
	speed: 0.2831s/iter; left time: 11193.2014s
	iters: 400, epoch: 31 | loss: 0.4650891
	speed: 0.2751s/iter; left time: 10848.8867s
	iters: 500, epoch: 31 | loss: 0.3842908
	speed: 0.2827s/iter; left time: 11120.5521s
Epoch: 31 cost time: 162.6085045337677
Epoch: 31, Steps: 569 | Train Loss: 0.4845610 Vali Loss: 0.5901614 Test Loss: 0.2715890
Validation loss decreased (0.590400 --> 0.590161).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.6727889
	speed: 1.5253s/iter; left time: 59732.5907s
	iters: 200, epoch: 32 | loss: 0.4326207
	speed: 0.2894s/iter; left time: 11306.0710s
	iters: 300, epoch: 32 | loss: 0.5818879
	speed: 0.2923s/iter; left time: 11386.9891s
	iters: 400, epoch: 32 | loss: 0.4275643
	speed: 0.2804s/iter; left time: 10895.0952s
	iters: 500, epoch: 32 | loss: 0.4341632
	speed: 0.2715s/iter; left time: 10522.6599s
Epoch: 32 cost time: 160.978670835495
Epoch: 32, Steps: 569 | Train Loss: 0.4846289 Vali Loss: 0.5903003 Test Loss: 0.2715447
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.6496292
	speed: 1.4878s/iter; left time: 57417.9645s
	iters: 200, epoch: 33 | loss: 0.5295235
	speed: 0.2668s/iter; left time: 10271.7136s
	iters: 300, epoch: 33 | loss: 0.3823212
	speed: 0.2812s/iter; left time: 10794.6279s
	iters: 400, epoch: 33 | loss: 0.5185030
	speed: 0.2816s/iter; left time: 10781.4302s
	iters: 500, epoch: 33 | loss: 0.3652226
	speed: 0.2765s/iter; left time: 10559.3018s
Epoch: 33 cost time: 160.38114190101624
Epoch: 33, Steps: 569 | Train Loss: 0.4845893 Vali Loss: 0.5902721 Test Loss: 0.2714634
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.5040736
	speed: 1.5155s/iter; left time: 57625.7857s
	iters: 200, epoch: 34 | loss: 0.7330998
	speed: 0.2824s/iter; left time: 10709.9522s
	iters: 300, epoch: 34 | loss: 0.3970942
	speed: 0.2669s/iter; left time: 10096.1756s
	iters: 400, epoch: 34 | loss: 0.4303037
	speed: 0.2734s/iter; left time: 10312.0227s
	iters: 500, epoch: 34 | loss: 0.3653728
	speed: 0.2745s/iter; left time: 10326.3531s
Epoch: 34 cost time: 158.8756046295166
Epoch: 34, Steps: 569 | Train Loss: 0.4844237 Vali Loss: 0.5898044 Test Loss: 0.2713920
Validation loss decreased (0.590161 --> 0.589804).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3741266
	speed: 1.4853s/iter; left time: 55630.8020s
	iters: 200, epoch: 35 | loss: 0.4638321
	speed: 0.2949s/iter; left time: 11015.0911s
	iters: 300, epoch: 35 | loss: 0.4420630
	speed: 0.2955s/iter; left time: 11009.7348s
	iters: 400, epoch: 35 | loss: 0.4563248
	speed: 0.2721s/iter; left time: 10110.6885s
	iters: 500, epoch: 35 | loss: 0.5671145
	speed: 0.2807s/iter; left time: 10401.9746s
Epoch: 35 cost time: 161.88526439666748
Epoch: 35, Steps: 569 | Train Loss: 0.4843527 Vali Loss: 0.5891669 Test Loss: 0.2713453
Validation loss decreased (0.589804 --> 0.589167).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.5104032
	speed: 1.4935s/iter; left time: 55089.4125s
	iters: 200, epoch: 36 | loss: 0.4234562
	speed: 0.2760s/iter; left time: 10152.1471s
	iters: 300, epoch: 36 | loss: 0.5037771
	speed: 0.2794s/iter; left time: 10251.1904s
	iters: 400, epoch: 36 | loss: 0.5960308
	speed: 0.2707s/iter; left time: 9902.6076s
	iters: 500, epoch: 36 | loss: 0.3900871
	speed: 0.2942s/iter; left time: 10733.1246s
Epoch: 36 cost time: 158.98037886619568
Epoch: 36, Steps: 569 | Train Loss: 0.4843257 Vali Loss: 0.5892215 Test Loss: 0.2713078
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.4178238
	speed: 1.2488s/iter; left time: 45351.7117s
	iters: 200, epoch: 37 | loss: 0.5067638
	speed: 0.2352s/iter; left time: 8518.2437s
	iters: 300, epoch: 37 | loss: 0.4845673
	speed: 0.2328s/iter; left time: 8408.6347s
	iters: 400, epoch: 37 | loss: 0.4268575
	speed: 0.2394s/iter; left time: 8624.2311s
	iters: 500, epoch: 37 | loss: 0.5372033
	speed: 0.2291s/iter; left time: 8228.9022s
Epoch: 37 cost time: 133.57345247268677
Epoch: 37, Steps: 569 | Train Loss: 0.4842347 Vali Loss: 0.5899406 Test Loss: 0.2712641
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.4903732
	speed: 1.2367s/iter; left time: 44210.4060s
	iters: 200, epoch: 38 | loss: 0.4277064
	speed: 0.2309s/iter; left time: 8231.4111s
	iters: 300, epoch: 38 | loss: 0.5499052
	speed: 0.2211s/iter; left time: 7860.2352s
	iters: 400, epoch: 38 | loss: 0.3970515
	speed: 0.2249s/iter; left time: 7973.5543s
	iters: 500, epoch: 38 | loss: 0.4482010
	speed: 0.2521s/iter; left time: 8912.8716s
Epoch: 38 cost time: 132.1156222820282
Epoch: 38, Steps: 569 | Train Loss: 0.4838648 Vali Loss: 0.5895069 Test Loss: 0.2712310
EarlyStopping counter: 3 out of 3
Early stopping
train 36462
val 4935
test 10204
Model(
  (freq_upsampler): ModuleList(
    (0): Linear(in_features=22, out_features=104, bias=True)
    (1): Linear(in_features=22, out_features=104, bias=True)
    (2): Linear(in_features=22, out_features=104, bias=True)
    (3): Linear(in_features=22, out_features=104, bias=True)
    (4): Linear(in_features=22, out_features=104, bias=True)
    (5): Linear(in_features=22, out_features=104, bias=True)
    (6): Linear(in_features=22, out_features=104, bias=True)
    (7): Linear(in_features=22, out_features=104, bias=True)
    (8): Linear(in_features=22, out_features=104, bias=True)
    (9): Linear(in_features=22, out_features=104, bias=True)
    (10): Linear(in_features=22, out_features=104, bias=True)
    (11): Linear(in_features=22, out_features=104, bias=True)
    (12): Linear(in_features=22, out_features=104, bias=True)
    (13): Linear(in_features=22, out_features=104, bias=True)
    (14): Linear(in_features=22, out_features=104, bias=True)
    (15): Linear(in_features=22, out_features=104, bias=True)
    (16): Linear(in_features=22, out_features=104, bias=True)
    (17): Linear(in_features=22, out_features=104, bias=True)
    (18): Linear(in_features=22, out_features=104, bias=True)
    (19): Linear(in_features=22, out_features=104, bias=True)
    (20): Linear(in_features=22, out_features=104, bias=True)
  )
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3075072.0
params:  50232.0
Trainable parameters:  50232
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.7379510
	speed: 0.2407s/iter; left time: 13673.2242s
	iters: 200, epoch: 1 | loss: 0.7577180
	speed: 0.2243s/iter; left time: 12717.0957s
	iters: 300, epoch: 1 | loss: 0.5858880
	speed: 0.2320s/iter; left time: 13132.4432s
	iters: 400, epoch: 1 | loss: 0.6640134
	speed: 0.2449s/iter; left time: 13838.9348s
	iters: 500, epoch: 1 | loss: 0.4827871
	speed: 0.2419s/iter; left time: 13644.6296s
Epoch: 1 cost time: 134.23111605644226
Epoch: 1, Steps: 569 | Train Loss: 0.5961221 Vali Loss: 0.5881485 Test Loss: 0.2709734
Validation loss decreased (inf --> 0.588149).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5520988
	speed: 1.3022s/iter; left time: 73223.8255s
	iters: 200, epoch: 2 | loss: 0.7573772
	speed: 0.2457s/iter; left time: 13791.0813s
	iters: 300, epoch: 2 | loss: 0.7673106
	speed: 0.2352s/iter; left time: 13178.8329s
	iters: 400, epoch: 2 | loss: 0.7421587
	speed: 0.2350s/iter; left time: 13143.5813s
	iters: 500, epoch: 2 | loss: 0.5918067
	speed: 0.2370s/iter; left time: 13230.5415s
Epoch: 2 cost time: 135.52385306358337
Epoch: 2, Steps: 569 | Train Loss: 0.5951030 Vali Loss: 0.5872389 Test Loss: 0.2705499
Validation loss decreased (0.588149 --> 0.587239).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.6442617
	speed: 1.2146s/iter; left time: 67609.3142s
	iters: 200, epoch: 3 | loss: 0.6497452
	speed: 0.1916s/iter; left time: 10645.9571s
	iters: 300, epoch: 3 | loss: 0.5530796
	speed: 0.1884s/iter; left time: 10449.9534s
	iters: 400, epoch: 3 | loss: 0.4544021
	speed: 0.1976s/iter; left time: 10938.1305s
	iters: 500, epoch: 3 | loss: 0.5676401
	speed: 0.1950s/iter; left time: 10773.9048s
Epoch: 3 cost time: 114.18420720100403
Epoch: 3, Steps: 569 | Train Loss: 0.5943811 Vali Loss: 0.5867546 Test Loss: 0.2703282
Validation loss decreased (0.587239 --> 0.586755).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4596918
	speed: 1.0219s/iter; left time: 56301.4800s
	iters: 200, epoch: 4 | loss: 0.6009324
	speed: 0.1842s/iter; left time: 10129.1864s
	iters: 300, epoch: 4 | loss: 0.4097649
	speed: 0.1953s/iter; left time: 10719.1618s
	iters: 400, epoch: 4 | loss: 0.5621063
	speed: 0.2068s/iter; left time: 11330.1072s
	iters: 500, epoch: 4 | loss: 0.6788829
	speed: 0.1943s/iter; left time: 10624.3389s
Epoch: 4 cost time: 111.80464577674866
Epoch: 4, Steps: 569 | Train Loss: 0.5934982 Vali Loss: 0.5860571 Test Loss: 0.2700335
Validation loss decreased (0.586755 --> 0.586057).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.9199148
	speed: 1.0523s/iter; left time: 57375.8680s
	iters: 200, epoch: 5 | loss: 0.6943026
	speed: 0.2323s/iter; left time: 12642.6389s
	iters: 300, epoch: 5 | loss: 0.6449218
	speed: 0.2257s/iter; left time: 12260.8943s
	iters: 400, epoch: 5 | loss: 0.8762862
	speed: 0.2099s/iter; left time: 11379.6942s
	iters: 500, epoch: 5 | loss: 0.6105387
	speed: 0.2114s/iter; left time: 11441.7936s
Epoch: 5 cost time: 125.2302315235138
Epoch: 5, Steps: 569 | Train Loss: 0.5928456 Vali Loss: 0.5851634 Test Loss: 0.2698620
Validation loss decreased (0.586057 --> 0.585163).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4395448
	speed: 1.1111s/iter; left time: 59948.2499s
	iters: 200, epoch: 6 | loss: 0.4876935
	speed: 0.2030s/iter; left time: 10933.6694s
	iters: 300, epoch: 6 | loss: 0.6286861
	speed: 0.2003s/iter; left time: 10768.0107s
	iters: 400, epoch: 6 | loss: 0.5409023
	speed: 0.2181s/iter; left time: 11699.8046s
	iters: 500, epoch: 6 | loss: 0.5106905
	speed: 0.2140s/iter; left time: 11459.2742s
Epoch: 6 cost time: 116.46891760826111
Epoch: 6, Steps: 569 | Train Loss: 0.5926803 Vali Loss: 0.5852290 Test Loss: 0.2696397
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4870248
	speed: 1.5172s/iter; left time: 80999.5280s
	iters: 200, epoch: 7 | loss: 0.5447357
	speed: 0.3194s/iter; left time: 17018.0037s
	iters: 300, epoch: 7 | loss: 0.6600572
	speed: 0.3169s/iter; left time: 16855.1991s
	iters: 400, epoch: 7 | loss: 0.6486270
	speed: 0.3147s/iter; left time: 16706.9954s
	iters: 500, epoch: 7 | loss: 0.4958944
	speed: 0.3227s/iter; left time: 17099.3751s
Epoch: 7 cost time: 183.60919380187988
Epoch: 7, Steps: 569 | Train Loss: 0.5920507 Vali Loss: 0.5836784 Test Loss: 0.2694378
Validation loss decreased (0.585163 --> 0.583678).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.5246692
	speed: 1.7148s/iter; left time: 90572.2917s
	iters: 200, epoch: 8 | loss: 0.4706550
	speed: 0.3129s/iter; left time: 16497.4769s
	iters: 300, epoch: 8 | loss: 0.6908869
	speed: 0.3173s/iter; left time: 16697.7295s
	iters: 400, epoch: 8 | loss: 0.5017225
	speed: 0.3360s/iter; left time: 17645.6322s
	iters: 500, epoch: 8 | loss: 0.4377565
	speed: 0.3259s/iter; left time: 17082.5314s
Epoch: 8 cost time: 182.5580861568451
Epoch: 8, Steps: 569 | Train Loss: 0.5913891 Vali Loss: 0.5844065 Test Loss: 0.2692246
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.5784585
	speed: 1.7149s/iter; left time: 89599.2144s
	iters: 200, epoch: 9 | loss: 0.4894815
	speed: 0.3348s/iter; left time: 17457.4161s
	iters: 300, epoch: 9 | loss: 0.8103649
	speed: 0.3132s/iter; left time: 16299.9701s
	iters: 400, epoch: 9 | loss: 0.6858912
	speed: 0.3140s/iter; left time: 16309.9338s
	iters: 500, epoch: 9 | loss: 0.7613550
	speed: 0.3120s/iter; left time: 16175.9290s
Epoch: 9 cost time: 181.53611302375793
Epoch: 9, Steps: 569 | Train Loss: 0.5914582 Vali Loss: 0.5835995 Test Loss: 0.2690371
Validation loss decreased (0.583678 --> 0.583600).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.5269137
	speed: 1.7152s/iter; left time: 88643.0802s
	iters: 200, epoch: 10 | loss: 0.5199222
	speed: 0.3209s/iter; left time: 16554.0493s
	iters: 300, epoch: 10 | loss: 0.9196005
	speed: 0.3233s/iter; left time: 16642.4617s
	iters: 400, epoch: 10 | loss: 0.6394007
	speed: 0.3069s/iter; left time: 15770.7192s
	iters: 500, epoch: 10 | loss: 0.5699165
	speed: 0.3178s/iter; left time: 16297.7061s
Epoch: 10 cost time: 181.3793830871582
Epoch: 10, Steps: 569 | Train Loss: 0.5909906 Vali Loss: 0.5836627 Test Loss: 0.2689649
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.5330180
	speed: 1.7488s/iter; left time: 89383.4740s
	iters: 200, epoch: 11 | loss: 0.5593824
	speed: 0.3151s/iter; left time: 16073.6503s
	iters: 300, epoch: 11 | loss: 0.7892229
	speed: 0.3153s/iter; left time: 16051.7841s
	iters: 400, epoch: 11 | loss: 0.4870089
	speed: 0.3357s/iter; left time: 17054.9868s
	iters: 500, epoch: 11 | loss: 0.5535412
	speed: 0.3302s/iter; left time: 16744.5488s
Epoch: 11 cost time: 186.20839834213257
Epoch: 11, Steps: 569 | Train Loss: 0.5906258 Vali Loss: 0.5829751 Test Loss: 0.2687574
Validation loss decreased (0.583600 --> 0.582975).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.4663651
	speed: 1.7521s/iter; left time: 88554.7782s
	iters: 200, epoch: 12 | loss: 0.6464177
	speed: 0.3248s/iter; left time: 16384.0154s
	iters: 300, epoch: 12 | loss: 0.7332394
	speed: 0.3326s/iter; left time: 16743.2944s
	iters: 400, epoch: 12 | loss: 0.5284680
	speed: 0.3150s/iter; left time: 15823.8284s
	iters: 500, epoch: 12 | loss: 0.5931675
	speed: 0.3191s/iter; left time: 16001.8743s
Epoch: 12 cost time: 184.95890283584595
Epoch: 12, Steps: 569 | Train Loss: 0.5903708 Vali Loss: 0.5823509 Test Loss: 0.2687462
Validation loss decreased (0.582975 --> 0.582351).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.7857164
	speed: 1.7768s/iter; left time: 88793.0975s
	iters: 200, epoch: 13 | loss: 0.7270379
	speed: 0.3208s/iter; left time: 15999.0864s
	iters: 300, epoch: 13 | loss: 0.4637150
	speed: 0.3168s/iter; left time: 15768.1986s
	iters: 400, epoch: 13 | loss: 0.5925305
	speed: 0.3276s/iter; left time: 16273.7550s
	iters: 500, epoch: 13 | loss: 0.4697282
	speed: 0.3258s/iter; left time: 16151.6731s
Epoch: 13 cost time: 185.4128623008728
Epoch: 13, Steps: 569 | Train Loss: 0.5902476 Vali Loss: 0.5829301 Test Loss: 0.2685596
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.5387306
	speed: 1.7277s/iter; left time: 85357.6119s
	iters: 200, epoch: 14 | loss: 0.4515069
	speed: 0.3261s/iter; left time: 16077.2416s
	iters: 300, epoch: 14 | loss: 0.5335169
	speed: 0.3167s/iter; left time: 15583.2733s
	iters: 400, epoch: 14 | loss: 0.4873630
	speed: 0.3124s/iter; left time: 15340.5273s
	iters: 500, epoch: 14 | loss: 0.4763671
	speed: 0.3109s/iter; left time: 15235.8797s
Epoch: 14 cost time: 180.90520668029785
Epoch: 14, Steps: 569 | Train Loss: 0.5901368 Vali Loss: 0.5821044 Test Loss: 0.2685104
Validation loss decreased (0.582351 --> 0.582104).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.5832748
	speed: 1.7096s/iter; left time: 83488.6792s
	iters: 200, epoch: 15 | loss: 0.5298914
	speed: 0.3378s/iter; left time: 16462.4243s
	iters: 300, epoch: 15 | loss: 0.6112034
	speed: 0.3290s/iter; left time: 16002.9308s
	iters: 400, epoch: 15 | loss: 0.5488219
	speed: 0.3436s/iter; left time: 16677.4102s
	iters: 500, epoch: 15 | loss: 0.5595582
	speed: 0.3452s/iter; left time: 16720.3187s
Epoch: 15 cost time: 194.2031512260437
Epoch: 15, Steps: 569 | Train Loss: 0.5897886 Vali Loss: 0.5816834 Test Loss: 0.2683558
Validation loss decreased (0.582104 --> 0.581683).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.5446273
	speed: 1.8135s/iter; left time: 87532.2438s
	iters: 200, epoch: 16 | loss: 0.7000719
	speed: 0.3362s/iter; left time: 16193.6697s
	iters: 300, epoch: 16 | loss: 0.6013923
	speed: 0.3309s/iter; left time: 15905.8423s
	iters: 400, epoch: 16 | loss: 0.5245354
	speed: 0.3292s/iter; left time: 15788.3835s
	iters: 500, epoch: 16 | loss: 0.6303009
	speed: 0.3563s/iter; left time: 17053.6565s
Epoch: 16 cost time: 195.07244348526
Epoch: 16, Steps: 569 | Train Loss: 0.5897621 Vali Loss: 0.5817745 Test Loss: 0.2683360
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.6531154
	speed: 1.7890s/iter; left time: 85330.0546s
	iters: 200, epoch: 17 | loss: 0.5896925
	speed: 0.3392s/iter; left time: 16143.9633s
	iters: 300, epoch: 17 | loss: 0.5282400
	speed: 0.3471s/iter; left time: 16486.4148s
	iters: 400, epoch: 17 | loss: 0.5425733
	speed: 0.3468s/iter; left time: 16435.0616s
	iters: 500, epoch: 17 | loss: 0.4705959
	speed: 0.3261s/iter; left time: 15422.0050s
Epoch: 17 cost time: 192.1165428161621
Epoch: 17, Steps: 569 | Train Loss: 0.5896000 Vali Loss: 0.5810488 Test Loss: 0.2681869
Validation loss decreased (0.581683 --> 0.581049).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.7538249
	speed: 1.8047s/iter; left time: 85049.7813s
	iters: 200, epoch: 18 | loss: 0.5639475
	speed: 0.3406s/iter; left time: 16017.3245s
	iters: 300, epoch: 18 | loss: 0.6107267
	speed: 0.3409s/iter; left time: 15998.5730s
	iters: 400, epoch: 18 | loss: 0.5106884
	speed: 0.3404s/iter; left time: 15941.4380s
	iters: 500, epoch: 18 | loss: 0.4583808
	speed: 0.3436s/iter; left time: 16058.0261s
Epoch: 18 cost time: 194.94496941566467
Epoch: 18, Steps: 569 | Train Loss: 0.5893427 Vali Loss: 0.5812755 Test Loss: 0.2682050
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.5250095
	speed: 1.8521s/iter; left time: 86232.8993s
	iters: 200, epoch: 19 | loss: 0.6313713
	speed: 0.3571s/iter; left time: 16590.9658s
	iters: 300, epoch: 19 | loss: 0.5133786
	speed: 0.3339s/iter; left time: 15480.8943s
	iters: 400, epoch: 19 | loss: 0.4890878
	speed: 0.3175s/iter; left time: 14687.5521s
	iters: 500, epoch: 19 | loss: 0.5668991
	speed: 0.3311s/iter; left time: 15281.2399s
Epoch: 19 cost time: 190.09834837913513
Epoch: 19, Steps: 569 | Train Loss: 0.5892311 Vali Loss: 0.5809119 Test Loss: 0.2681001
Validation loss decreased (0.581049 --> 0.580912).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.7069825
	speed: 1.6424s/iter; left time: 75535.7356s
	iters: 200, epoch: 20 | loss: 0.5186147
	speed: 0.2932s/iter; left time: 13455.0511s
	iters: 300, epoch: 20 | loss: 0.6395931
	speed: 0.3028s/iter; left time: 13863.6711s
	iters: 400, epoch: 20 | loss: 0.4866762
	speed: 0.2945s/iter; left time: 13455.8892s
	iters: 500, epoch: 20 | loss: 0.6182930
	speed: 0.2993s/iter; left time: 13645.5684s
Epoch: 20 cost time: 173.1282675266266
Epoch: 20, Steps: 569 | Train Loss: 0.5887794 Vali Loss: 0.5809213 Test Loss: 0.2680665
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.8970782
	speed: 1.6453s/iter; left time: 74729.7393s
	iters: 200, epoch: 21 | loss: 0.4681144
	speed: 0.2982s/iter; left time: 13516.1758s
	iters: 300, epoch: 21 | loss: 0.9181290
	speed: 0.2960s/iter; left time: 13384.4328s
	iters: 400, epoch: 21 | loss: 0.4472479
	speed: 0.2962s/iter; left time: 13364.5510s
	iters: 500, epoch: 21 | loss: 0.6506360
	speed: 0.2974s/iter; left time: 13388.9125s
Epoch: 21 cost time: 169.97288274765015
Epoch: 21, Steps: 569 | Train Loss: 0.5885574 Vali Loss: 0.5809510 Test Loss: 0.2680183
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4561555
	speed: 1.5843s/iter; left time: 71061.2341s
	iters: 200, epoch: 22 | loss: 0.5086656
	speed: 0.2884s/iter; left time: 12907.3255s
	iters: 300, epoch: 22 | loss: 0.5417011
	speed: 0.2851s/iter; left time: 12730.4584s
	iters: 400, epoch: 22 | loss: 0.4217684
	speed: 0.2917s/iter; left time: 12996.1393s
	iters: 500, epoch: 22 | loss: 0.6412365
	speed: 0.2804s/iter; left time: 12463.6143s
Epoch: 22 cost time: 163.75218749046326
Epoch: 22, Steps: 569 | Train Loss: 0.5884846 Vali Loss: 0.5808588 Test Loss: 0.2679568
Validation loss decreased (0.580912 --> 0.580859).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.4928515
	speed: 1.4272s/iter; left time: 63202.2235s
	iters: 200, epoch: 23 | loss: 0.6529605
	speed: 0.2561s/iter; left time: 11314.4316s
	iters: 300, epoch: 23 | loss: 0.5657855
	speed: 0.2587s/iter; left time: 11406.2813s
	iters: 400, epoch: 23 | loss: 0.4606166
	speed: 0.2575s/iter; left time: 11325.3528s
	iters: 500, epoch: 23 | loss: 0.4635786
	speed: 0.2668s/iter; left time: 11708.9089s
Epoch: 23 cost time: 148.02161574363708
Epoch: 23, Steps: 569 | Train Loss: 0.5886242 Vali Loss: 0.5808570 Test Loss: 0.2679075
Validation loss decreased (0.580859 --> 0.580857).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.5246555
	speed: 1.3537s/iter; left time: 59175.8275s
	iters: 200, epoch: 24 | loss: 0.6224094
	speed: 0.2588s/iter; left time: 11287.4458s
	iters: 300, epoch: 24 | loss: 0.6419346
	speed: 0.2484s/iter; left time: 10808.5119s
	iters: 400, epoch: 24 | loss: 0.6501551
	speed: 0.2723s/iter; left time: 11820.8525s
	iters: 500, epoch: 24 | loss: 0.8578659
	speed: 0.2651s/iter; left time: 11481.9076s
Epoch: 24 cost time: 149.37897634506226
Epoch: 24, Steps: 569 | Train Loss: 0.5885200 Vali Loss: 0.5800419 Test Loss: 0.2678697
Validation loss decreased (0.580857 --> 0.580042).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.5621682
	speed: 1.4552s/iter; left time: 62784.6525s
	iters: 200, epoch: 25 | loss: 0.4628415
	speed: 0.2700s/iter; left time: 11622.5854s
	iters: 300, epoch: 25 | loss: 0.6048191
	speed: 0.2772s/iter; left time: 11904.2291s
	iters: 400, epoch: 25 | loss: 0.6592485
	speed: 0.2681s/iter; left time: 11485.0624s
	iters: 500, epoch: 25 | loss: 0.6847283
	speed: 0.2558s/iter; left time: 10933.8812s
Epoch: 25 cost time: 151.2999210357666
Epoch: 25, Steps: 569 | Train Loss: 0.5883924 Vali Loss: 0.5805780 Test Loss: 0.2678257
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.5381832
	speed: 1.3405s/iter; left time: 57075.1763s
	iters: 200, epoch: 26 | loss: 0.5656897
	speed: 0.2590s/iter; left time: 10999.4394s
	iters: 300, epoch: 26 | loss: 0.6655308
	speed: 0.2691s/iter; left time: 11404.8906s
	iters: 400, epoch: 26 | loss: 0.8314347
	speed: 0.2656s/iter; left time: 11228.7168s
	iters: 500, epoch: 26 | loss: 0.5096928
	speed: 0.2540s/iter; left time: 10711.5732s
Epoch: 26 cost time: 148.313729763031
Epoch: 26, Steps: 569 | Train Loss: 0.5883909 Vali Loss: 0.5797056 Test Loss: 0.2677676
Validation loss decreased (0.580042 --> 0.579706).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.5351730
	speed: 1.4298s/iter; left time: 60063.5060s
	iters: 200, epoch: 27 | loss: 0.6896628
	speed: 0.2688s/iter; left time: 11263.3998s
	iters: 300, epoch: 27 | loss: 0.5085506
	speed: 0.2633s/iter; left time: 11007.6911s
	iters: 400, epoch: 27 | loss: 0.6629277
	speed: 0.2614s/iter; left time: 10902.8195s
	iters: 500, epoch: 27 | loss: 0.7060809
	speed: 0.2642s/iter; left time: 10991.0222s
Epoch: 27 cost time: 152.2380256652832
Epoch: 27, Steps: 569 | Train Loss: 0.5882587 Vali Loss: 0.5799720 Test Loss: 0.2677402
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.5506372
	speed: 1.4133s/iter; left time: 58564.0473s
	iters: 200, epoch: 28 | loss: 0.5248871
	speed: 0.2763s/iter; left time: 11422.6070s
	iters: 300, epoch: 28 | loss: 0.4893637
	speed: 0.2566s/iter; left time: 10581.5632s
	iters: 400, epoch: 28 | loss: 0.5032170
	speed: 0.2670s/iter; left time: 10981.8495s
	iters: 500, epoch: 28 | loss: 0.4707226
	speed: 0.2762s/iter; left time: 11336.1066s
Epoch: 28 cost time: 152.5191032886505
Epoch: 28, Steps: 569 | Train Loss: 0.5881812 Vali Loss: 0.5797791 Test Loss: 0.2677118
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.6046559
	speed: 1.4400s/iter; left time: 58851.0986s
	iters: 200, epoch: 29 | loss: 0.4538536
	speed: 0.2621s/iter; left time: 10684.4180s
	iters: 300, epoch: 29 | loss: 0.5945927
	speed: 0.2446s/iter; left time: 9948.3131s
	iters: 400, epoch: 29 | loss: 0.5212670
	speed: 0.2571s/iter; left time: 10428.8594s
	iters: 500, epoch: 29 | loss: 0.6285036
	speed: 0.2593s/iter; left time: 10493.5932s
Epoch: 29 cost time: 148.25073409080505
Epoch: 29, Steps: 569 | Train Loss: 0.5877468 Vali Loss: 0.5802454 Test Loss: 0.2676559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_90_j336_H12_FITS_custom_ftM_sl90_ll48_pl336_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.26819920539855957, mae:0.2937788963317871, rse:0.6801649928092957, corr:[0.47650564 0.47757038 0.4757664  0.47542578 0.47458377 0.47255656
 0.47053435 0.4688433  0.46680635 0.4643542  0.4619336  0.45961258
 0.45704752 0.45433074 0.45174015 0.44907817 0.4463952  0.44337013
 0.4401928  0.4369976  0.43382162 0.43079388 0.4280228  0.42535022
 0.42291948 0.42068    0.41858378 0.4168406  0.41556135 0.414623
 0.4141121  0.41399845 0.4144916  0.4149775  0.41554132 0.41620734
 0.41709056 0.41803825 0.41893595 0.4196587  0.42026702 0.42081916
 0.42139655 0.42214203 0.42266276 0.42283392 0.42288807 0.4231553
 0.42337203 0.42350006 0.42343172 0.4232299  0.42305964 0.42298236
 0.42296246 0.4228913  0.42270803 0.42247444 0.42220083 0.42212096
 0.42232662 0.42251536 0.42240727 0.42200798 0.42172262 0.42154816
 0.42121437 0.42085433 0.42040598 0.42006063 0.41979286 0.4193415
 0.41902006 0.41880393 0.4186037  0.41817915 0.41771016 0.41737235
 0.41702837 0.41669723 0.41662106 0.41665584 0.4164019  0.41580573
 0.4152627  0.41473138 0.41431612 0.41379827 0.4134184  0.41317958
 0.4129341  0.41271636 0.41262537 0.41248247 0.41226518 0.41209275
 0.41191995 0.4116878  0.41146496 0.41117236 0.4110352  0.41098133
 0.41085204 0.41075128 0.4107437  0.4107634  0.41055742 0.4103015
 0.41000143 0.4098002  0.4096373  0.40945753 0.40926164 0.4092372
 0.409142   0.40897375 0.40887567 0.40885687 0.40876865 0.4084611
 0.40818584 0.40799958 0.40770304 0.40734926 0.40708396 0.40688837
 0.4066133  0.4061762  0.40577984 0.40538916 0.4048692  0.40409622
 0.40342888 0.40296572 0.4026308  0.40217033 0.40155306 0.40099996
 0.4004509  0.39972463 0.39888442 0.39806247 0.3973187  0.3965017
 0.3956145  0.3946651  0.39370978 0.39253962 0.3911979  0.38961735
 0.38782337 0.38575548 0.38370574 0.3816703  0.37943092 0.3771165
 0.37487143 0.37247044 0.36996254 0.36707687 0.36411896 0.36125052
 0.35843462 0.3556701  0.352773   0.3499587  0.347318   0.34494174
 0.34281102 0.34090117 0.33954582 0.33875617 0.33858737 0.33903804
 0.3399291  0.34145853 0.3432391  0.34507546 0.3469609  0.34894392
 0.35090807 0.35278586 0.35447112 0.35608113 0.35759598 0.35913634
 0.36063862 0.36209846 0.36342117 0.3646415  0.36574394 0.36681238
 0.3678851  0.36880526 0.36974722 0.3706837  0.37157977 0.37233344
 0.37294108 0.3734256  0.37398222 0.374575   0.37485027 0.374887
 0.37499484 0.3751618  0.3753123  0.37535888 0.37533545 0.3752341
 0.37518024 0.37510616 0.37508264 0.37499472 0.37472147 0.3743476
 0.3740808  0.37398273 0.3738867  0.37375152 0.3734674  0.37329504
 0.3730954  0.37285408 0.37266016 0.3724473  0.3721198  0.37172508
 0.37139678 0.37126413 0.37114874 0.3708987  0.37045014 0.37006792
 0.3696951  0.36918604 0.3686446  0.36818817 0.36776966 0.36739492
 0.36697197 0.36666507 0.36645234 0.36626002 0.36616558 0.36616802
 0.36630228 0.36633825 0.3660432  0.36582878 0.36576492 0.3658251
 0.36580554 0.3656544  0.36555523 0.36551967 0.3653732  0.36512
 0.36495197 0.36510113 0.3652214  0.36524704 0.36513945 0.3650306
 0.36500946 0.3647751  0.36446768 0.36428005 0.36425516 0.36413684
 0.363925   0.36363158 0.36349615 0.3633787  0.3631971  0.36283496
 0.36251247 0.36217606 0.36178997 0.3613683  0.36091766 0.3605087
 0.35999778 0.35930395 0.35843617 0.35756186 0.35659543 0.35553613
 0.35432628 0.35312018 0.3518044  0.35010687 0.34817353 0.34655097
 0.3449846  0.34311962 0.34085682 0.33856657 0.33624688 0.333946
 0.3314239  0.32875496 0.32594302 0.3228609  0.31981942 0.317103
 0.31456742 0.31161797 0.30882376 0.30666324 0.30493477 0.30317488
 0.30136746 0.30007708 0.2994272  0.29919273 0.29938784 0.3002848
 0.30153328 0.3025401  0.3036952  0.3055488  0.30762288 0.30928993
 0.3108082  0.31268874 0.31447464 0.31602067 0.317919   0.32026547
 0.32267168 0.32425192 0.32605964 0.32816094 0.32948118 0.32871726]
