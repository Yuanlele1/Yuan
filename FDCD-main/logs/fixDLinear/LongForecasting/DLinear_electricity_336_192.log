Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.1974715
	speed: 0.0702s/iter; left time: 777.2245s
	iters: 200, epoch: 1 | loss: 0.1908254
	speed: 0.0682s/iter; left time: 747.9946s
	iters: 300, epoch: 1 | loss: 0.1504994
	speed: 0.0665s/iter; left time: 722.4580s
	iters: 400, epoch: 1 | loss: 0.1775966
	speed: 0.0699s/iter; left time: 753.2275s
	iters: 500, epoch: 1 | loss: 0.1380864
	speed: 0.0682s/iter; left time: 727.3822s
	iters: 600, epoch: 1 | loss: 0.2131214
	speed: 0.0673s/iter; left time: 711.5883s
	iters: 700, epoch: 1 | loss: 0.1768472
	speed: 0.0641s/iter; left time: 671.0141s
	iters: 800, epoch: 1 | loss: 0.1895873
	speed: 0.0633s/iter; left time: 656.8766s
	iters: 900, epoch: 1 | loss: 0.1694925
	speed: 0.0673s/iter; left time: 691.2950s
	iters: 1000, epoch: 1 | loss: 0.1513334
	speed: 0.0679s/iter; left time: 690.4948s
	iters: 1100, epoch: 1 | loss: 0.1429701
	speed: 0.0661s/iter; left time: 665.1930s
Epoch: 1 cost time: 75.05354762077332
Epoch: 1, Steps: 1117 | Train Loss: 0.1773981 Vali Loss: 0.1379611 Test Loss: 0.1616859
Validation loss decreased (inf --> 0.137961).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1746171
	speed: 1.1354s/iter; left time: 11302.0810s
	iters: 200, epoch: 2 | loss: 0.1488737
	speed: 0.0596s/iter; left time: 587.3028s
	iters: 300, epoch: 2 | loss: 0.1560560
	speed: 0.0598s/iter; left time: 583.4113s
	iters: 400, epoch: 2 | loss: 0.1641269
	speed: 0.0596s/iter; left time: 575.7575s
	iters: 500, epoch: 2 | loss: 0.1893218
	speed: 0.0614s/iter; left time: 586.7884s
	iters: 600, epoch: 2 | loss: 0.1415942
	speed: 0.0590s/iter; left time: 557.4536s
	iters: 700, epoch: 2 | loss: 0.1397022
	speed: 0.0616s/iter; left time: 575.8177s
	iters: 800, epoch: 2 | loss: 0.1733258
	speed: 0.0634s/iter; left time: 587.1613s
	iters: 900, epoch: 2 | loss: 0.1256326
	speed: 0.0627s/iter; left time: 573.7465s
	iters: 1000, epoch: 2 | loss: 0.1497482
	speed: 0.0628s/iter; left time: 568.2262s
	iters: 1100, epoch: 2 | loss: 0.1829548
	speed: 0.0605s/iter; left time: 542.1588s
Epoch: 2 cost time: 69.57320165634155
Epoch: 2, Steps: 1117 | Train Loss: 0.1606563 Vali Loss: 0.1355557 Test Loss: 0.1603174
Validation loss decreased (0.137961 --> 0.135556).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1650162
	speed: 1.1504s/iter; left time: 10165.8059s
	iters: 200, epoch: 3 | loss: 0.1712654
	speed: 0.0665s/iter; left time: 581.4322s
	iters: 300, epoch: 3 | loss: 0.1335828
	speed: 0.0641s/iter; left time: 553.8254s
	iters: 400, epoch: 3 | loss: 0.1860717
	speed: 0.0675s/iter; left time: 575.9877s
	iters: 500, epoch: 3 | loss: 0.1852369
	speed: 0.0648s/iter; left time: 546.9205s
	iters: 600, epoch: 3 | loss: 0.1750053
	speed: 0.0643s/iter; left time: 536.1047s
	iters: 700, epoch: 3 | loss: 0.1946103
	speed: 0.0644s/iter; left time: 530.6347s
	iters: 800, epoch: 3 | loss: 0.1985624
	speed: 0.0654s/iter; left time: 532.5589s
	iters: 900, epoch: 3 | loss: 0.1760941
	speed: 0.0622s/iter; left time: 500.0362s
	iters: 1000, epoch: 3 | loss: 0.1414065
	speed: 0.0609s/iter; left time: 483.0922s
	iters: 1100, epoch: 3 | loss: 0.1550197
	speed: 0.0627s/iter; left time: 491.3336s
Epoch: 3 cost time: 73.35309314727783
Epoch: 3, Steps: 1117 | Train Loss: 0.1576157 Vali Loss: 0.1326941 Test Loss: 0.1563530
Validation loss decreased (0.135556 --> 0.132694).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1350380
	speed: 1.1038s/iter; left time: 8521.3950s
	iters: 200, epoch: 4 | loss: 0.1532088
	speed: 0.0630s/iter; left time: 479.8599s
	iters: 300, epoch: 4 | loss: 0.1572901
	speed: 0.0606s/iter; left time: 455.9669s
	iters: 400, epoch: 4 | loss: 0.1350753
	speed: 0.0607s/iter; left time: 450.4406s
	iters: 500, epoch: 4 | loss: 0.1656028
	speed: 0.0635s/iter; left time: 464.5510s
	iters: 600, epoch: 4 | loss: 0.1438490
	speed: 0.0599s/iter; left time: 432.4046s
	iters: 700, epoch: 4 | loss: 0.1775712
	speed: 0.0588s/iter; left time: 418.9109s
	iters: 800, epoch: 4 | loss: 0.1556634
	speed: 0.0631s/iter; left time: 443.1727s
	iters: 900, epoch: 4 | loss: 0.1413188
	speed: 0.0611s/iter; left time: 422.5695s
	iters: 1000, epoch: 4 | loss: 0.1456349
	speed: 0.0645s/iter; left time: 440.2068s
	iters: 1100, epoch: 4 | loss: 0.1780740
	speed: 0.0689s/iter; left time: 462.8151s
Epoch: 4 cost time: 71.19061422348022
Epoch: 4, Steps: 1117 | Train Loss: 0.1561641 Vali Loss: 0.1315142 Test Loss: 0.1552261
Validation loss decreased (0.132694 --> 0.131514).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1449983
	speed: 1.1265s/iter; left time: 7438.4102s
	iters: 200, epoch: 5 | loss: 0.1616801
	speed: 0.0593s/iter; left time: 385.4957s
	iters: 300, epoch: 5 | loss: 0.1519870
	speed: 0.0567s/iter; left time: 362.9223s
	iters: 400, epoch: 5 | loss: 0.1404072
	speed: 0.0634s/iter; left time: 399.9233s
	iters: 500, epoch: 5 | loss: 0.1358491
	speed: 0.0597s/iter; left time: 370.3930s
	iters: 600, epoch: 5 | loss: 0.1760972
	speed: 0.0599s/iter; left time: 365.4240s
	iters: 700, epoch: 5 | loss: 0.1769847
	speed: 0.0583s/iter; left time: 350.1904s
	iters: 800, epoch: 5 | loss: 0.1334415
	speed: 0.0574s/iter; left time: 338.7417s
	iters: 900, epoch: 5 | loss: 0.1478150
	speed: 0.0548s/iter; left time: 317.7254s
	iters: 1000, epoch: 5 | loss: 0.1563388
	speed: 0.0649s/iter; left time: 370.1559s
	iters: 1100, epoch: 5 | loss: 0.1544568
	speed: 0.0590s/iter; left time: 330.4821s
Epoch: 5 cost time: 67.53572726249695
Epoch: 5, Steps: 1117 | Train Loss: 0.1553958 Vali Loss: 0.1310541 Test Loss: 0.1544410
Validation loss decreased (0.131514 --> 0.131054).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1670784
	speed: 1.0526s/iter; left time: 5774.3911s
	iters: 200, epoch: 6 | loss: 0.1670981
	speed: 0.0595s/iter; left time: 320.2015s
	iters: 300, epoch: 6 | loss: 0.2016117
	speed: 0.0560s/iter; left time: 295.9809s
	iters: 400, epoch: 6 | loss: 0.1363764
	speed: 0.0555s/iter; left time: 287.6973s
	iters: 500, epoch: 6 | loss: 0.1303273
	speed: 0.0545s/iter; left time: 277.1856s
	iters: 600, epoch: 6 | loss: 0.1642426
	speed: 0.0562s/iter; left time: 280.3423s
	iters: 700, epoch: 6 | loss: 0.1482089
	speed: 0.0547s/iter; left time: 267.3878s
	iters: 800, epoch: 6 | loss: 0.1823724
	speed: 0.0597s/iter; left time: 285.7715s
	iters: 900, epoch: 6 | loss: 0.1460240
	speed: 0.0623s/iter; left time: 291.7435s
	iters: 1000, epoch: 6 | loss: 0.1620456
	speed: 0.0598s/iter; left time: 274.4606s
	iters: 1100, epoch: 6 | loss: 0.1654148
	speed: 0.0626s/iter; left time: 280.6194s
Epoch: 6 cost time: 66.12962698936462
Epoch: 6, Steps: 1117 | Train Loss: 0.1549372 Vali Loss: 0.1307964 Test Loss: 0.1546017
Validation loss decreased (0.131054 --> 0.130796).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1754239
	speed: 1.1447s/iter; left time: 5001.3352s
	iters: 200, epoch: 7 | loss: 0.1395367
	speed: 0.0605s/iter; left time: 258.1077s
	iters: 300, epoch: 7 | loss: 0.1466112
	speed: 0.0619s/iter; left time: 258.0618s
	iters: 400, epoch: 7 | loss: 0.1650235
	speed: 0.0608s/iter; left time: 247.4880s
	iters: 500, epoch: 7 | loss: 0.1709906
	speed: 0.0637s/iter; left time: 252.7016s
	iters: 600, epoch: 7 | loss: 0.1720053
	speed: 0.0541s/iter; left time: 209.1674s
	iters: 700, epoch: 7 | loss: 0.1300328
	speed: 0.0573s/iter; left time: 216.0436s
	iters: 800, epoch: 7 | loss: 0.1525830
	speed: 0.0579s/iter; left time: 212.3813s
	iters: 900, epoch: 7 | loss: 0.1672844
	speed: 0.0588s/iter; left time: 209.7153s
	iters: 1000, epoch: 7 | loss: 0.1590293
	speed: 0.0592s/iter; left time: 205.4748s
	iters: 1100, epoch: 7 | loss: 0.1458278
	speed: 0.0608s/iter; left time: 204.6928s
Epoch: 7 cost time: 67.45792698860168
Epoch: 7, Steps: 1117 | Train Loss: 0.1547408 Vali Loss: 0.1305680 Test Loss: 0.1541022
Validation loss decreased (0.130796 --> 0.130568).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1635983
	speed: 1.0776s/iter; left time: 3504.3868s
	iters: 200, epoch: 8 | loss: 0.1304121
	speed: 0.0613s/iter; left time: 193.2350s
	iters: 300, epoch: 8 | loss: 0.1791955
	speed: 0.0630s/iter; left time: 192.2656s
	iters: 400, epoch: 8 | loss: 0.1483823
	speed: 0.0604s/iter; left time: 178.2909s
	iters: 500, epoch: 8 | loss: 0.1614948
	speed: 0.0628s/iter; left time: 179.0230s
	iters: 600, epoch: 8 | loss: 0.1411476
	speed: 0.0587s/iter; left time: 161.5160s
	iters: 700, epoch: 8 | loss: 0.1518904
	speed: 0.0646s/iter; left time: 171.3822s
	iters: 800, epoch: 8 | loss: 0.1276341
	speed: 0.0584s/iter; left time: 148.9330s
	iters: 900, epoch: 8 | loss: 0.1459686
	speed: 0.0642s/iter; left time: 157.3075s
	iters: 1000, epoch: 8 | loss: 0.1390612
	speed: 0.0660s/iter; left time: 155.2066s
	iters: 1100, epoch: 8 | loss: 0.1624202
	speed: 0.0646s/iter; left time: 145.5432s
Epoch: 8 cost time: 70.7980546951294
Epoch: 8, Steps: 1117 | Train Loss: 0.1546057 Vali Loss: 0.1304341 Test Loss: 0.1539692
Validation loss decreased (0.130568 --> 0.130434).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1399655
	speed: 1.0343s/iter; left time: 2208.1944s
	iters: 200, epoch: 9 | loss: 0.1460236
	speed: 0.0581s/iter; left time: 118.3093s
	iters: 300, epoch: 9 | loss: 0.1665313
	speed: 0.0617s/iter; left time: 119.4245s
	iters: 400, epoch: 9 | loss: 0.1505476
	speed: 0.0548s/iter; left time: 100.6485s
	iters: 500, epoch: 9 | loss: 0.1545713
	speed: 0.0574s/iter; left time: 99.6017s
	iters: 600, epoch: 9 | loss: 0.1863172
	speed: 0.0571s/iter; left time: 93.3577s
	iters: 700, epoch: 9 | loss: 0.1358467
	speed: 0.0567s/iter; left time: 87.0067s
	iters: 800, epoch: 9 | loss: 0.1490196
	speed: 0.0617s/iter; left time: 88.5699s
	iters: 900, epoch: 9 | loss: 0.1600096
	speed: 0.0593s/iter; left time: 79.2100s
	iters: 1000, epoch: 9 | loss: 0.1519988
	speed: 0.0561s/iter; left time: 69.2827s
	iters: 1100, epoch: 9 | loss: 0.2012079
	speed: 0.0554s/iter; left time: 62.8890s
Epoch: 9 cost time: 65.44173789024353
Epoch: 9, Steps: 1117 | Train Loss: 0.1545708 Vali Loss: 0.1304439 Test Loss: 0.1540068
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1389855
	speed: 0.9904s/iter; left time: 1008.1988s
	iters: 200, epoch: 10 | loss: 0.1722542
	speed: 0.0579s/iter; left time: 53.1551s
	iters: 300, epoch: 10 | loss: 0.1506625
	speed: 0.0574s/iter; left time: 46.9470s
	iters: 400, epoch: 10 | loss: 0.1448188
	speed: 0.0599s/iter; left time: 43.0394s
	iters: 500, epoch: 10 | loss: 0.1264669
	speed: 0.0622s/iter; left time: 38.4244s
	iters: 600, epoch: 10 | loss: 0.1571180
	speed: 0.0614s/iter; left time: 31.7817s
	iters: 700, epoch: 10 | loss: 0.1651008
	speed: 0.0583s/iter; left time: 24.3585s
	iters: 800, epoch: 10 | loss: 0.1454073
	speed: 0.0575s/iter; left time: 18.2847s
	iters: 900, epoch: 10 | loss: 0.1822380
	speed: 0.0532s/iter; left time: 11.6016s
	iters: 1000, epoch: 10 | loss: 0.1631306
	speed: 0.0527s/iter; left time: 6.2140s
	iters: 1100, epoch: 10 | loss: 0.1523538
	speed: 0.0535s/iter; left time: 0.9631s
Epoch: 10 cost time: 66.09726810455322
Epoch: 10, Steps: 1117 | Train Loss: 0.1545497 Vali Loss: 0.1303567 Test Loss: 0.1539741
Validation loss decreased (0.130434 --> 0.130357).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.15379351377487183, mae:0.25049689412117004
