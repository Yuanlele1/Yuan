Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4130435
	speed: 0.1265s/iter; left time: 1326.8944s
	iters: 200, epoch: 1 | loss: 0.9550418
	speed: 0.1189s/iter; left time: 1235.7490s
	iters: 300, epoch: 1 | loss: 0.9241721
	speed: 0.1188s/iter; left time: 1222.1280s
	iters: 400, epoch: 1 | loss: 0.5855170
	speed: 0.1021s/iter; left time: 1040.0154s
	iters: 500, epoch: 1 | loss: 0.6976735
	speed: 0.1169s/iter; left time: 1179.9388s
	iters: 600, epoch: 1 | loss: 0.5348817
	speed: 0.1181s/iter; left time: 1179.7002s
	iters: 700, epoch: 1 | loss: 1.0094286
	speed: 0.1125s/iter; left time: 1112.5236s
	iters: 800, epoch: 1 | loss: 0.8928075
	speed: 0.1267s/iter; left time: 1240.7937s
	iters: 900, epoch: 1 | loss: 0.4107665
	speed: 0.1267s/iter; left time: 1227.7753s
	iters: 1000, epoch: 1 | loss: 0.3379224
	speed: 0.1278s/iter; left time: 1226.0442s
Epoch: 1 cost time: 127.14094877243042
Epoch: 1, Steps: 1059 | Train Loss: 0.5251266 Vali Loss: 0.8620259 Test Loss: 1.7035972
Validation loss decreased (inf --> 0.862026).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.4068895
	speed: 2.0199s/iter; left time: 19051.2788s
	iters: 200, epoch: 2 | loss: 1.6368943
	speed: 0.1185s/iter; left time: 1105.7321s
	iters: 300, epoch: 2 | loss: 0.5541487
	speed: 0.1232s/iter; left time: 1137.0023s
	iters: 400, epoch: 2 | loss: 0.7172408
	speed: 0.1217s/iter; left time: 1111.5870s
	iters: 500, epoch: 2 | loss: 0.4938241
	speed: 0.1206s/iter; left time: 1088.8368s
	iters: 600, epoch: 2 | loss: 0.3737578
	speed: 0.1210s/iter; left time: 1081.0573s
	iters: 700, epoch: 2 | loss: 0.7398651
	speed: 0.1183s/iter; left time: 1044.5221s
	iters: 800, epoch: 2 | loss: 0.5362211
	speed: 0.1161s/iter; left time: 1014.0882s
	iters: 900, epoch: 2 | loss: 0.4247661
	speed: 0.1142s/iter; left time: 985.8595s
	iters: 1000, epoch: 2 | loss: 0.7768342
	speed: 0.1128s/iter; left time: 962.7887s
Epoch: 2 cost time: 126.30945205688477
Epoch: 2, Steps: 1059 | Train Loss: 0.5165609 Vali Loss: 0.2664073 Test Loss: 0.3857882
Validation loss decreased (0.862026 --> 0.266407).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.3939327
	speed: 2.0593s/iter; left time: 17242.3924s
	iters: 200, epoch: 3 | loss: 0.4996204
	speed: 0.1169s/iter; left time: 966.9049s
	iters: 300, epoch: 3 | loss: 0.2843511
	speed: 0.1168s/iter; left time: 954.9360s
	iters: 400, epoch: 3 | loss: 0.2648510
	speed: 0.1210s/iter; left time: 976.5243s
	iters: 500, epoch: 3 | loss: 0.2629521
	speed: 0.1162s/iter; left time: 926.1530s
	iters: 600, epoch: 3 | loss: 0.5091883
	speed: 0.1194s/iter; left time: 939.9612s
	iters: 700, epoch: 3 | loss: 0.3864505
	speed: 0.1190s/iter; left time: 925.3258s
	iters: 800, epoch: 3 | loss: 0.5127082
	speed: 0.1203s/iter; left time: 922.9633s
	iters: 900, epoch: 3 | loss: 0.3974283
	speed: 0.1185s/iter; left time: 897.0715s
	iters: 1000, epoch: 3 | loss: 0.3361111
	speed: 0.1141s/iter; left time: 852.6945s
Epoch: 3 cost time: 125.85966491699219
Epoch: 3, Steps: 1059 | Train Loss: 0.4347618 Vali Loss: 0.2725727 Test Loss: 0.4115348
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.3357522
	speed: 2.0813s/iter; left time: 15222.7981s
	iters: 200, epoch: 4 | loss: 0.2573771
	speed: 0.1141s/iter; left time: 822.7782s
	iters: 300, epoch: 4 | loss: 0.1960581
	speed: 0.1140s/iter; left time: 810.6685s
	iters: 400, epoch: 4 | loss: 1.0166609
	speed: 0.1193s/iter; left time: 836.9617s
	iters: 500, epoch: 4 | loss: 0.3260484
	speed: 0.1157s/iter; left time: 799.8561s
	iters: 600, epoch: 4 | loss: 0.3470498
	speed: 0.1149s/iter; left time: 783.0583s
	iters: 700, epoch: 4 | loss: 0.2388441
	speed: 0.1088s/iter; left time: 730.2214s
	iters: 800, epoch: 4 | loss: 0.4014914
	speed: 0.1059s/iter; left time: 700.4606s
	iters: 900, epoch: 4 | loss: 0.3301264
	speed: 0.1232s/iter; left time: 802.3767s
	iters: 1000, epoch: 4 | loss: 0.2144633
	speed: 0.1244s/iter; left time: 798.1104s
Epoch: 4 cost time: 124.49933648109436
Epoch: 4, Steps: 1059 | Train Loss: 0.4033733 Vali Loss: 0.2392639 Test Loss: 0.3563945
Validation loss decreased (0.266407 --> 0.239264).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.2521937
	speed: 2.1451s/iter; left time: 13417.4885s
	iters: 200, epoch: 5 | loss: 0.2437073
	speed: 0.1287s/iter; left time: 791.9045s
	iters: 300, epoch: 5 | loss: 0.3936212
	speed: 0.1318s/iter; left time: 798.0874s
	iters: 400, epoch: 5 | loss: 0.4372032
	speed: 0.1226s/iter; left time: 730.1902s
	iters: 500, epoch: 5 | loss: 0.2226818
	speed: 0.1219s/iter; left time: 713.4807s
	iters: 600, epoch: 5 | loss: 0.2255583
	speed: 0.1212s/iter; left time: 697.4571s
	iters: 700, epoch: 5 | loss: 0.3218000
	speed: 0.1134s/iter; left time: 641.4298s
	iters: 800, epoch: 5 | loss: 0.2294131
	speed: 0.1123s/iter; left time: 623.7487s
	iters: 900, epoch: 5 | loss: 0.4520206
	speed: 0.1067s/iter; left time: 582.1086s
	iters: 1000, epoch: 5 | loss: 0.4773322
	speed: 0.1033s/iter; left time: 553.0096s
Epoch: 5 cost time: 126.0581111907959
Epoch: 5, Steps: 1059 | Train Loss: 0.3910111 Vali Loss: 0.2265478 Test Loss: 0.3302848
Validation loss decreased (0.239264 --> 0.226548).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.4103387
	speed: 1.9108s/iter; left time: 9928.5191s
	iters: 200, epoch: 6 | loss: 0.3815835
	speed: 0.1105s/iter; left time: 563.1430s
	iters: 300, epoch: 6 | loss: 0.2124048
	speed: 0.1221s/iter; left time: 610.1112s
	iters: 400, epoch: 6 | loss: 0.3672121
	speed: 0.1189s/iter; left time: 582.1850s
	iters: 500, epoch: 6 | loss: 0.9211347
	speed: 0.1217s/iter; left time: 583.5811s
	iters: 600, epoch: 6 | loss: 0.2930906
	speed: 0.1251s/iter; left time: 587.4209s
	iters: 700, epoch: 6 | loss: 0.3352970
	speed: 0.1217s/iter; left time: 559.2404s
	iters: 800, epoch: 6 | loss: 0.4868299
	speed: 0.1218s/iter; left time: 547.6380s
	iters: 900, epoch: 6 | loss: 0.2425651
	speed: 0.1206s/iter; left time: 530.0878s
	iters: 1000, epoch: 6 | loss: 0.3004681
	speed: 0.1169s/iter; left time: 502.3715s
Epoch: 6 cost time: 127.23103952407837
Epoch: 6, Steps: 1059 | Train Loss: 0.3800624 Vali Loss: 0.2153132 Test Loss: 0.3072881
Validation loss decreased (0.226548 --> 0.215313).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.6401190
	speed: 1.8558s/iter; left time: 7677.3334s
	iters: 200, epoch: 7 | loss: 0.3030828
	speed: 0.0962s/iter; left time: 388.2077s
	iters: 300, epoch: 7 | loss: 0.2988309
	speed: 0.0930s/iter; left time: 366.0437s
	iters: 400, epoch: 7 | loss: 0.3344589
	speed: 0.1071s/iter; left time: 411.0835s
	iters: 500, epoch: 7 | loss: 0.2409718
	speed: 0.0996s/iter; left time: 372.3664s
	iters: 600, epoch: 7 | loss: 0.1635687
	speed: 0.0901s/iter; left time: 327.8348s
	iters: 700, epoch: 7 | loss: 0.3144228
	speed: 0.0931s/iter; left time: 329.3213s
	iters: 800, epoch: 7 | loss: 0.2906921
	speed: 0.0942s/iter; left time: 323.7321s
	iters: 900, epoch: 7 | loss: 0.5583518
	speed: 0.0937s/iter; left time: 312.8053s
	iters: 1000, epoch: 7 | loss: 0.2450143
	speed: 0.0892s/iter; left time: 288.6292s
Epoch: 7 cost time: 101.15542268753052
Epoch: 7, Steps: 1059 | Train Loss: 0.3760139 Vali Loss: 0.2107805 Test Loss: 0.2947326
Validation loss decreased (0.215313 --> 0.210781).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.2003475
	speed: 1.6150s/iter; left time: 4971.0014s
	iters: 200, epoch: 8 | loss: 0.3001630
	speed: 0.1063s/iter; left time: 316.6398s
	iters: 300, epoch: 8 | loss: 0.2078670
	speed: 0.1047s/iter; left time: 301.3358s
	iters: 400, epoch: 8 | loss: 0.4893341
	speed: 0.1018s/iter; left time: 282.8197s
	iters: 500, epoch: 8 | loss: 0.2351485
	speed: 0.0997s/iter; left time: 266.9494s
	iters: 600, epoch: 8 | loss: 1.4216692
	speed: 0.1045s/iter; left time: 269.5193s
	iters: 700, epoch: 8 | loss: 0.3069033
	speed: 0.1044s/iter; left time: 258.6128s
	iters: 800, epoch: 8 | loss: 0.2606716
	speed: 0.1043s/iter; left time: 247.9089s
	iters: 900, epoch: 8 | loss: 0.3330349
	speed: 0.1037s/iter; left time: 236.3352s
	iters: 1000, epoch: 8 | loss: 0.3918608
	speed: 0.1043s/iter; left time: 227.0769s
Epoch: 8 cost time: 111.68880939483643
Epoch: 8, Steps: 1059 | Train Loss: 0.3739315 Vali Loss: 0.2247138 Test Loss: 0.3266226
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1968224
	speed: 1.7725s/iter; left time: 3578.7199s
	iters: 200, epoch: 9 | loss: 0.3119143
	speed: 0.1121s/iter; left time: 215.1676s
	iters: 300, epoch: 9 | loss: 0.1946193
	speed: 0.1150s/iter; left time: 209.1626s
	iters: 400, epoch: 9 | loss: 0.2675545
	speed: 0.1154s/iter; left time: 198.3964s
	iters: 500, epoch: 9 | loss: 0.3027417
	speed: 0.1144s/iter; left time: 185.2754s
	iters: 600, epoch: 9 | loss: 0.4571821
	speed: 0.1044s/iter; left time: 158.5784s
	iters: 700, epoch: 9 | loss: 0.2323719
	speed: 0.1060s/iter; left time: 150.4067s
	iters: 800, epoch: 9 | loss: 0.4187899
	speed: 0.1073s/iter; left time: 141.5507s
	iters: 900, epoch: 9 | loss: 0.6551098
	speed: 0.1057s/iter; left time: 128.8073s
	iters: 1000, epoch: 9 | loss: 0.2553217
	speed: 0.1029s/iter; left time: 115.1107s
Epoch: 9 cost time: 117.45802164077759
Epoch: 9, Steps: 1059 | Train Loss: 0.3720974 Vali Loss: 0.2439397 Test Loss: 0.3669872
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.2120777
	speed: 1.7446s/iter; left time: 1674.8300s
	iters: 200, epoch: 10 | loss: 0.1481365
	speed: 0.1124s/iter; left time: 96.6316s
	iters: 300, epoch: 10 | loss: 0.3465068
	speed: 0.1040s/iter; left time: 79.0555s
	iters: 400, epoch: 10 | loss: 0.1987282
	speed: 0.1059s/iter; left time: 69.8797s
	iters: 500, epoch: 10 | loss: 0.3096290
	speed: 0.1139s/iter; left time: 63.7803s
	iters: 600, epoch: 10 | loss: 0.3792028
	speed: 0.1243s/iter; left time: 57.1865s
	iters: 700, epoch: 10 | loss: 0.2500266
	speed: 0.1214s/iter; left time: 43.6890s
	iters: 800, epoch: 10 | loss: 0.1957675
	speed: 0.1330s/iter; left time: 34.5778s
	iters: 900, epoch: 10 | loss: 0.6825964
	speed: 0.1304s/iter; left time: 20.8616s
	iters: 1000, epoch: 10 | loss: 0.2899731
	speed: 0.1268s/iter; left time: 7.6062s
Epoch: 10 cost time: 126.4197587966919
Epoch: 10, Steps: 1059 | Train Loss: 0.3712264 Vali Loss: 0.2227169 Test Loss: 0.3230661
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2949976623058319, mae:0.3590204119682312
