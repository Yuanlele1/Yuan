Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='Electricity_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2161259
	speed: 0.0828s/iter; left time: 921.3194s
	iters: 200, epoch: 1 | loss: 0.1517004
	speed: 0.0716s/iter; left time: 790.2627s
	iters: 300, epoch: 1 | loss: 0.1472225
	speed: 0.0718s/iter; left time: 784.3668s
	iters: 400, epoch: 1 | loss: 0.2133907
	speed: 0.0737s/iter; left time: 798.5513s
	iters: 500, epoch: 1 | loss: 0.1373329
	speed: 0.0745s/iter; left time: 799.2784s
	iters: 600, epoch: 1 | loss: 0.1611070
	speed: 0.0757s/iter; left time: 805.1003s
	iters: 700, epoch: 1 | loss: 0.1324242
	speed: 0.0744s/iter; left time: 783.4457s
	iters: 800, epoch: 1 | loss: 0.1397707
	speed: 0.0756s/iter; left time: 788.7756s
	iters: 900, epoch: 1 | loss: 0.1736596
	speed: 0.0721s/iter; left time: 744.4722s
	iters: 1000, epoch: 1 | loss: 0.1726010
	speed: 0.0731s/iter; left time: 747.4950s
	iters: 1100, epoch: 1 | loss: 0.1540703
	speed: 0.0718s/iter; left time: 727.6979s
Epoch: 1 cost time: 83.39018654823303
Epoch: 1, Steps: 1123 | Train Loss: 0.1633313 Vali Loss: 0.1262928 Test Loss: 0.1468290
Validation loss decreased (inf --> 0.126293).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1458200
	speed: 1.2584s/iter; left time: 12593.8458s
	iters: 200, epoch: 2 | loss: 0.1353702
	speed: 0.0604s/iter; left time: 598.7725s
	iters: 300, epoch: 2 | loss: 0.1234029
	speed: 0.0697s/iter; left time: 684.0852s
	iters: 400, epoch: 2 | loss: 0.1159780
	speed: 0.0696s/iter; left time: 675.5237s
	iters: 500, epoch: 2 | loss: 0.1304136
	speed: 0.0700s/iter; left time: 673.0374s
	iters: 600, epoch: 2 | loss: 0.1405943
	speed: 0.0671s/iter; left time: 638.2127s
	iters: 700, epoch: 2 | loss: 0.1270020
	speed: 0.0687s/iter; left time: 646.5695s
	iters: 800, epoch: 2 | loss: 0.1329082
	speed: 0.0685s/iter; left time: 637.3396s
	iters: 900, epoch: 2 | loss: 0.1568952
	speed: 0.0704s/iter; left time: 648.0491s
	iters: 1000, epoch: 2 | loss: 0.1277298
	speed: 0.0691s/iter; left time: 629.4795s
	iters: 1100, epoch: 2 | loss: 0.1214451
	speed: 0.0711s/iter; left time: 640.0429s
Epoch: 2 cost time: 77.45538783073425
Epoch: 2, Steps: 1123 | Train Loss: 0.1463188 Vali Loss: 0.1243196 Test Loss: 0.1451004
Validation loss decreased (0.126293 --> 0.124320).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1484140
	speed: 1.2984s/iter; left time: 11535.9103s
	iters: 200, epoch: 3 | loss: 0.1341870
	speed: 0.0721s/iter; left time: 633.6809s
	iters: 300, epoch: 3 | loss: 0.1577827
	speed: 0.0726s/iter; left time: 630.8588s
	iters: 400, epoch: 3 | loss: 0.1216281
	speed: 0.0740s/iter; left time: 635.6937s
	iters: 500, epoch: 3 | loss: 0.1815834
	speed: 0.0730s/iter; left time: 619.1406s
	iters: 600, epoch: 3 | loss: 0.1311857
	speed: 0.0744s/iter; left time: 623.9884s
	iters: 700, epoch: 3 | loss: 0.1338979
	speed: 0.0725s/iter; left time: 600.5096s
	iters: 800, epoch: 3 | loss: 0.1315710
	speed: 0.0716s/iter; left time: 586.2550s
	iters: 900, epoch: 3 | loss: 0.1499571
	speed: 0.0788s/iter; left time: 636.8668s
	iters: 1000, epoch: 3 | loss: 0.1850138
	speed: 0.0756s/iter; left time: 603.7916s
	iters: 1100, epoch: 3 | loss: 0.1401231
	speed: 0.0737s/iter; left time: 581.1021s
Epoch: 3 cost time: 83.35497331619263
Epoch: 3, Steps: 1123 | Train Loss: 0.1431610 Vali Loss: 0.1216908 Test Loss: 0.1420687
Validation loss decreased (0.124320 --> 0.121691).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1475418
	speed: 1.3213s/iter; left time: 10255.6167s
	iters: 200, epoch: 4 | loss: 0.2159488
	speed: 0.0695s/iter; left time: 532.7067s
	iters: 300, epoch: 4 | loss: 0.1406189
	speed: 0.0721s/iter; left time: 545.2283s
	iters: 400, epoch: 4 | loss: 0.2050097
	speed: 0.0701s/iter; left time: 523.4562s
	iters: 500, epoch: 4 | loss: 0.1737762
	speed: 0.0665s/iter; left time: 489.3599s
	iters: 600, epoch: 4 | loss: 0.1382826
	speed: 0.0687s/iter; left time: 498.8274s
	iters: 700, epoch: 4 | loss: 0.1256785
	speed: 0.0712s/iter; left time: 509.7753s
	iters: 800, epoch: 4 | loss: 0.1205421
	speed: 0.0705s/iter; left time: 497.8191s
	iters: 900, epoch: 4 | loss: 0.1241355
	speed: 0.0715s/iter; left time: 497.9716s
	iters: 1000, epoch: 4 | loss: 0.1226181
	speed: 0.0705s/iter; left time: 483.7111s
	iters: 1100, epoch: 4 | loss: 0.1479216
	speed: 0.0712s/iter; left time: 481.5323s
Epoch: 4 cost time: 79.68548917770386
Epoch: 4, Steps: 1123 | Train Loss: 0.1418166 Vali Loss: 0.1213941 Test Loss: 0.1415933
Validation loss decreased (0.121691 --> 0.121394).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1523981
	speed: 1.2745s/iter; left time: 8461.4943s
	iters: 200, epoch: 5 | loss: 0.1204526
	speed: 0.0659s/iter; left time: 430.9112s
	iters: 300, epoch: 5 | loss: 0.1422949
	speed: 0.0656s/iter; left time: 422.2046s
	iters: 400, epoch: 5 | loss: 0.1215105
	speed: 0.0716s/iter; left time: 453.9041s
	iters: 500, epoch: 5 | loss: 0.1512609
	speed: 0.0650s/iter; left time: 405.2588s
	iters: 600, epoch: 5 | loss: 0.1543993
	speed: 0.0670s/iter; left time: 411.2140s
	iters: 700, epoch: 5 | loss: 0.1295740
	speed: 0.0710s/iter; left time: 428.8823s
	iters: 800, epoch: 5 | loss: 0.1502762
	speed: 0.0687s/iter; left time: 408.0704s
	iters: 900, epoch: 5 | loss: 0.1213522
	speed: 0.0692s/iter; left time: 404.2533s
	iters: 1000, epoch: 5 | loss: 0.1437739
	speed: 0.0719s/iter; left time: 412.6867s
	iters: 1100, epoch: 5 | loss: 0.1187024
	speed: 0.0677s/iter; left time: 381.5342s
Epoch: 5 cost time: 77.59334349632263
Epoch: 5, Steps: 1123 | Train Loss: 0.1411515 Vali Loss: 0.1206321 Test Loss: 0.1411340
Validation loss decreased (0.121394 --> 0.120632).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1488397
	speed: 1.1221s/iter; left time: 6189.7219s
	iters: 200, epoch: 6 | loss: 0.1373993
	speed: 0.0627s/iter; left time: 339.4078s
	iters: 300, epoch: 6 | loss: 0.1235628
	speed: 0.0620s/iter; left time: 329.4868s
	iters: 400, epoch: 6 | loss: 0.1215977
	speed: 0.0563s/iter; left time: 293.6030s
	iters: 500, epoch: 6 | loss: 0.1295795
	speed: 0.0604s/iter; left time: 308.9943s
	iters: 600, epoch: 6 | loss: 0.1831484
	speed: 0.0665s/iter; left time: 333.7145s
	iters: 700, epoch: 6 | loss: 0.1435665
	speed: 0.0746s/iter; left time: 366.8876s
	iters: 800, epoch: 6 | loss: 0.1335280
	speed: 0.0757s/iter; left time: 364.3793s
	iters: 900, epoch: 6 | loss: 0.1292027
	speed: 0.0697s/iter; left time: 328.6941s
	iters: 1000, epoch: 6 | loss: 0.1415047
	speed: 0.0730s/iter; left time: 336.8828s
	iters: 1100, epoch: 6 | loss: 0.1258515
	speed: 0.0731s/iter; left time: 329.9773s
Epoch: 6 cost time: 77.02584981918335
Epoch: 6, Steps: 1123 | Train Loss: 0.1407844 Vali Loss: 0.1199754 Test Loss: 0.1402934
Validation loss decreased (0.120632 --> 0.119975).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1258253
	speed: 1.2785s/iter; left time: 5616.6382s
	iters: 200, epoch: 7 | loss: 0.1179861
	speed: 0.0633s/iter; left time: 271.7936s
	iters: 300, epoch: 7 | loss: 0.1581395
	speed: 0.0655s/iter; left time: 274.8469s
	iters: 400, epoch: 7 | loss: 0.1508193
	speed: 0.0658s/iter; left time: 269.3635s
	iters: 500, epoch: 7 | loss: 0.1433547
	speed: 0.0631s/iter; left time: 251.9775s
	iters: 600, epoch: 7 | loss: 0.1369041
	speed: 0.0628s/iter; left time: 244.4636s
	iters: 700, epoch: 7 | loss: 0.1251685
	speed: 0.0626s/iter; left time: 237.2918s
	iters: 800, epoch: 7 | loss: 0.1433047
	speed: 0.0637s/iter; left time: 235.3655s
	iters: 900, epoch: 7 | loss: 0.1330499
	speed: 0.0629s/iter; left time: 226.0714s
	iters: 1000, epoch: 7 | loss: 0.1283845
	speed: 0.0640s/iter; left time: 223.6584s
	iters: 1100, epoch: 7 | loss: 0.1489984
	speed: 0.0638s/iter; left time: 216.3248s
Epoch: 7 cost time: 72.6351728439331
Epoch: 7, Steps: 1123 | Train Loss: 0.1405677 Vali Loss: 0.1197975 Test Loss: 0.1401071
Validation loss decreased (0.119975 --> 0.119797).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1255266
	speed: 1.2833s/iter; left time: 4196.5373s
	iters: 200, epoch: 8 | loss: 0.1377520
	speed: 0.0710s/iter; left time: 225.0537s
	iters: 300, epoch: 8 | loss: 0.1332951
	speed: 0.0667s/iter; left time: 204.7746s
	iters: 400, epoch: 8 | loss: 0.1665793
	speed: 0.0728s/iter; left time: 216.0775s
	iters: 500, epoch: 8 | loss: 0.1122138
	speed: 0.0688s/iter; left time: 197.5683s
	iters: 600, epoch: 8 | loss: 0.1306347
	speed: 0.0573s/iter; left time: 158.8138s
	iters: 700, epoch: 8 | loss: 0.1423670
	speed: 0.0650s/iter; left time: 173.6583s
	iters: 800, epoch: 8 | loss: 0.1400286
	speed: 0.0691s/iter; left time: 177.4962s
	iters: 900, epoch: 8 | loss: 0.1537085
	speed: 0.0627s/iter; left time: 154.7498s
	iters: 1000, epoch: 8 | loss: 0.1278992
	speed: 0.0628s/iter; left time: 148.7961s
	iters: 1100, epoch: 8 | loss: 0.1927326
	speed: 0.0644s/iter; left time: 146.2091s
Epoch: 8 cost time: 76.17447447776794
Epoch: 8, Steps: 1123 | Train Loss: 0.1404823 Vali Loss: 0.1196322 Test Loss: 0.1400928
Validation loss decreased (0.119797 --> 0.119632).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1448081
	speed: 1.2192s/iter; left time: 2617.5716s
	iters: 200, epoch: 9 | loss: 0.1122652
	speed: 0.0646s/iter; left time: 132.2029s
	iters: 300, epoch: 9 | loss: 0.1769328
	speed: 0.0536s/iter; left time: 104.3075s
	iters: 400, epoch: 9 | loss: 0.1290632
	speed: 0.0545s/iter; left time: 100.6848s
	iters: 500, epoch: 9 | loss: 0.1372297
	speed: 0.0509s/iter; left time: 89.0028s
	iters: 600, epoch: 9 | loss: 0.1562193
	speed: 0.0550s/iter; left time: 90.5087s
	iters: 700, epoch: 9 | loss: 0.1094461
	speed: 0.0671s/iter; left time: 103.8212s
	iters: 800, epoch: 9 | loss: 0.1207878
	speed: 0.0639s/iter; left time: 92.4888s
	iters: 900, epoch: 9 | loss: 0.1217790
	speed: 0.0660s/iter; left time: 88.8469s
	iters: 1000, epoch: 9 | loss: 0.1420484
	speed: 0.0640s/iter; left time: 79.7585s
	iters: 1100, epoch: 9 | loss: 0.1548681
	speed: 0.0659s/iter; left time: 75.6369s
Epoch: 9 cost time: 70.38870239257812
Epoch: 9, Steps: 1123 | Train Loss: 0.1404257 Vali Loss: 0.1196386 Test Loss: 0.1400566
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1125172
	speed: 1.2609s/iter; left time: 1291.1496s
	iters: 200, epoch: 10 | loss: 0.1120386
	speed: 0.0764s/iter; left time: 70.6104s
	iters: 300, epoch: 10 | loss: 0.1290214
	speed: 0.0776s/iter; left time: 63.9019s
	iters: 400, epoch: 10 | loss: 0.1525357
	speed: 0.0744s/iter; left time: 53.8989s
	iters: 500, epoch: 10 | loss: 0.1458532
	speed: 0.0798s/iter; left time: 49.7966s
	iters: 600, epoch: 10 | loss: 0.1350901
	speed: 0.0756s/iter; left time: 39.5903s
	iters: 700, epoch: 10 | loss: 0.1136381
	speed: 0.0734s/iter; left time: 31.1254s
	iters: 800, epoch: 10 | loss: 0.1349082
	speed: 0.0817s/iter; left time: 26.4707s
	iters: 900, epoch: 10 | loss: 0.1543773
	speed: 0.0771s/iter; left time: 17.2754s
	iters: 1000, epoch: 10 | loss: 0.1310026
	speed: 0.0757s/iter; left time: 9.3921s
	iters: 1100, epoch: 10 | loss: 0.1282632
	speed: 0.0789s/iter; left time: 1.8936s
Epoch: 10 cost time: 87.77797937393188
Epoch: 10, Steps: 1123 | Train Loss: 0.1403830 Vali Loss: 0.1195703 Test Loss: 0.1400842
Validation loss decreased (0.119632 --> 0.119570).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : Electricity_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.14007581770420074, mae:0.23739679157733917
