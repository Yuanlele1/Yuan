Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 1.1127552
	speed: 0.0870s/iter; left time: 1940.2702s
	iters: 200, epoch: 1 | loss: 0.6941733
	speed: 0.0808s/iter; left time: 1792.9975s
	iters: 300, epoch: 1 | loss: 0.6157358
	speed: 0.0782s/iter; left time: 1728.1561s
	iters: 400, epoch: 1 | loss: 0.6289188
	speed: 0.0859s/iter; left time: 1890.1038s
	iters: 500, epoch: 1 | loss: 0.5393567
	speed: 0.0848s/iter; left time: 1857.2200s
	iters: 600, epoch: 1 | loss: 0.6695098
	speed: 0.0833s/iter; left time: 1816.0001s
	iters: 700, epoch: 1 | loss: 0.5883189
	speed: 0.0795s/iter; left time: 1724.0272s
	iters: 800, epoch: 1 | loss: 0.4832700
	speed: 0.0804s/iter; left time: 1735.4425s
	iters: 900, epoch: 1 | loss: 0.4520254
	speed: 0.0825s/iter; left time: 1773.7605s
	iters: 1000, epoch: 1 | loss: 0.4451457
	speed: 0.0831s/iter; left time: 1778.2919s
	iters: 1100, epoch: 1 | loss: 0.5487228
	speed: 0.0832s/iter; left time: 1772.1967s
	iters: 1200, epoch: 1 | loss: 0.4295513
	speed: 0.0786s/iter; left time: 1665.9036s
	iters: 1300, epoch: 1 | loss: 0.6896636
	speed: 0.0801s/iter; left time: 1688.6506s
	iters: 1400, epoch: 1 | loss: 0.4998713
	speed: 0.0818s/iter; left time: 1717.1784s
	iters: 1500, epoch: 1 | loss: 0.8128324
	speed: 0.0786s/iter; left time: 1642.7514s
	iters: 1600, epoch: 1 | loss: 0.4680959
	speed: 0.0793s/iter; left time: 1647.8259s
	iters: 1700, epoch: 1 | loss: 0.8702123
	speed: 0.0828s/iter; left time: 1712.8709s
	iters: 1800, epoch: 1 | loss: 0.8522671
	speed: 0.0865s/iter; left time: 1780.6882s
	iters: 1900, epoch: 1 | loss: 0.6239871
	speed: 0.0779s/iter; left time: 1596.5201s
	iters: 2000, epoch: 1 | loss: 0.4654939
	speed: 0.0774s/iter; left time: 1579.0820s
	iters: 2100, epoch: 1 | loss: 0.7468454
	speed: 0.0770s/iter; left time: 1563.0092s
	iters: 2200, epoch: 1 | loss: 0.6207674
	speed: 0.0938s/iter; left time: 1893.6717s
Epoch: 1 cost time: 184.11917638778687
Epoch: 1, Steps: 2239 | Train Loss: 0.6428514 Vali Loss: 0.6190124 Test Loss: 0.3321811
Validation loss decreased (inf --> 0.619012).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5415991
	speed: 1.7931s/iter; left time: 35954.6892s
	iters: 200, epoch: 2 | loss: 0.4982917
	speed: 0.0792s/iter; left time: 1579.8296s
	iters: 300, epoch: 2 | loss: 0.5010323
	speed: 0.0807s/iter; left time: 1602.5611s
	iters: 400, epoch: 2 | loss: 0.4572669
	speed: 0.0750s/iter; left time: 1480.9735s
	iters: 500, epoch: 2 | loss: 0.5882158
	speed: 0.0772s/iter; left time: 1517.3010s
	iters: 600, epoch: 2 | loss: 0.5452543
	speed: 0.0780s/iter; left time: 1525.6692s
	iters: 700, epoch: 2 | loss: 0.4688641
	speed: 0.0842s/iter; left time: 1638.6232s
	iters: 800, epoch: 2 | loss: 0.7065485
	speed: 0.0789s/iter; left time: 1527.5046s
	iters: 900, epoch: 2 | loss: 0.5604410
	speed: 0.0797s/iter; left time: 1535.3230s
	iters: 1000, epoch: 2 | loss: 0.7138739
	speed: 0.0795s/iter; left time: 1522.9023s
	iters: 1100, epoch: 2 | loss: 0.8148078
	speed: 0.0841s/iter; left time: 1602.7299s
	iters: 1200, epoch: 2 | loss: 0.5242554
	speed: 0.0798s/iter; left time: 1512.4899s
	iters: 1300, epoch: 2 | loss: 0.6139554
	speed: 0.0773s/iter; left time: 1457.0238s
	iters: 1400, epoch: 2 | loss: 0.6589818
	speed: 0.0784s/iter; left time: 1469.9564s
	iters: 1500, epoch: 2 | loss: 0.8989030
	speed: 0.0822s/iter; left time: 1532.8458s
	iters: 1600, epoch: 2 | loss: 0.5477210
	speed: 0.0854s/iter; left time: 1585.1549s
	iters: 1700, epoch: 2 | loss: 0.5613828
	speed: 0.0764s/iter; left time: 1410.4583s
	iters: 1800, epoch: 2 | loss: 0.5148675
	speed: 0.0796s/iter; left time: 1461.2054s
	iters: 1900, epoch: 2 | loss: 0.7770852
	speed: 0.0877s/iter; left time: 1600.2245s
	iters: 2000, epoch: 2 | loss: 0.6472400
	speed: 0.0835s/iter; left time: 1516.3292s
	iters: 2100, epoch: 2 | loss: 0.7427663
	speed: 0.0811s/iter; left time: 1463.1856s
	iters: 2200, epoch: 2 | loss: 0.7121555
	speed: 0.0824s/iter; left time: 1478.7833s
Epoch: 2 cost time: 181.10973477363586
Epoch: 2, Steps: 2239 | Train Loss: 0.6114454 Vali Loss: 0.6227216 Test Loss: 0.3264740
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4379892
	speed: 2.0878s/iter; left time: 37189.7375s
	iters: 200, epoch: 3 | loss: 1.0375460
	speed: 0.1021s/iter; left time: 1807.8360s
	iters: 300, epoch: 3 | loss: 0.5589368
	speed: 0.1063s/iter; left time: 1872.0730s
	iters: 400, epoch: 3 | loss: 0.5393131
	speed: 0.1029s/iter; left time: 1801.9953s
	iters: 500, epoch: 3 | loss: 0.8672782
	speed: 0.0942s/iter; left time: 1640.4304s
	iters: 600, epoch: 3 | loss: 1.0497679
	speed: 0.1028s/iter; left time: 1780.1579s
	iters: 700, epoch: 3 | loss: 0.6117933
	speed: 0.1033s/iter; left time: 1778.2263s
	iters: 800, epoch: 3 | loss: 0.7671322
	speed: 0.0834s/iter; left time: 1426.6835s
	iters: 900, epoch: 3 | loss: 0.9652623
	speed: 0.0827s/iter; left time: 1407.1337s
	iters: 1000, epoch: 3 | loss: 0.4158788
	speed: 0.0837s/iter; left time: 1415.0025s
	iters: 1100, epoch: 3 | loss: 0.5559020
	speed: 0.0976s/iter; left time: 1640.1202s
	iters: 1200, epoch: 3 | loss: 0.5869050
	speed: 0.1083s/iter; left time: 1810.1383s
	iters: 1300, epoch: 3 | loss: 0.4883983
	speed: 0.1061s/iter; left time: 1763.0018s
	iters: 1400, epoch: 3 | loss: 0.3394288
	speed: 0.1028s/iter; left time: 1698.1812s
	iters: 1500, epoch: 3 | loss: 0.7511134
	speed: 0.1099s/iter; left time: 1803.7538s
	iters: 1600, epoch: 3 | loss: 0.9449733
	speed: 0.1056s/iter; left time: 1722.7917s
	iters: 1700, epoch: 3 | loss: 0.8054163
	speed: 0.1025s/iter; left time: 1661.4444s
	iters: 1800, epoch: 3 | loss: 0.4308570
	speed: 0.1082s/iter; left time: 1742.8494s
	iters: 1900, epoch: 3 | loss: 0.5294855
	speed: 0.1216s/iter; left time: 1947.2535s
	iters: 2000, epoch: 3 | loss: 0.5656846
	speed: 0.1229s/iter; left time: 1956.1524s
	iters: 2100, epoch: 3 | loss: 0.4440746
	speed: 0.1248s/iter; left time: 1972.7879s
	iters: 2200, epoch: 3 | loss: 0.5842701
	speed: 0.1218s/iter; left time: 1914.1763s
Epoch: 3 cost time: 235.1297619342804
Epoch: 3, Steps: 2239 | Train Loss: 0.6054165 Vali Loss: 0.6218892 Test Loss: 0.3243864
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.1479990
	speed: 2.0148s/iter; left time: 31379.1362s
	iters: 200, epoch: 4 | loss: 0.7994608
	speed: 0.0658s/iter; left time: 1018.8157s
	iters: 300, epoch: 4 | loss: 0.5369679
	speed: 0.0660s/iter; left time: 1014.0859s
	iters: 400, epoch: 4 | loss: 0.5989650
	speed: 0.0663s/iter; left time: 1012.7110s
	iters: 500, epoch: 4 | loss: 0.4625454
	speed: 0.0650s/iter; left time: 986.1030s
	iters: 600, epoch: 4 | loss: 0.4458775
	speed: 0.0665s/iter; left time: 1002.5128s
	iters: 700, epoch: 4 | loss: 0.4771900
	speed: 0.0637s/iter; left time: 953.2498s
	iters: 800, epoch: 4 | loss: 0.4689084
	speed: 0.0652s/iter; left time: 969.2179s
	iters: 900, epoch: 4 | loss: 0.5209966
	speed: 0.0666s/iter; left time: 984.1636s
	iters: 1000, epoch: 4 | loss: 0.6535431
	speed: 0.0693s/iter; left time: 1016.9687s
	iters: 1100, epoch: 4 | loss: 0.4370292
	speed: 0.0690s/iter; left time: 1005.7847s
	iters: 1200, epoch: 4 | loss: 0.4683892
	speed: 0.0699s/iter; left time: 1011.7634s
	iters: 1300, epoch: 4 | loss: 0.5337564
	speed: 0.0669s/iter; left time: 961.9676s
	iters: 1400, epoch: 4 | loss: 0.7135178
	speed: 0.0702s/iter; left time: 1001.9072s
	iters: 1500, epoch: 4 | loss: 0.5895878
	speed: 0.0630s/iter; left time: 893.6429s
	iters: 1600, epoch: 4 | loss: 0.4262137
	speed: 0.0665s/iter; left time: 935.9326s
	iters: 1700, epoch: 4 | loss: 0.4617049
	speed: 0.0693s/iter; left time: 968.2315s
	iters: 1800, epoch: 4 | loss: 0.6747551
	speed: 0.0709s/iter; left time: 983.6667s
	iters: 1900, epoch: 4 | loss: 0.5088955
	speed: 0.0701s/iter; left time: 965.3116s
	iters: 2000, epoch: 4 | loss: 0.5449833
	speed: 0.0634s/iter; left time: 866.2997s
	iters: 2100, epoch: 4 | loss: 0.4483274
	speed: 0.0647s/iter; left time: 877.8264s
	iters: 2200, epoch: 4 | loss: 0.5599624
	speed: 0.0802s/iter; left time: 1080.5895s
Epoch: 4 cost time: 150.75379824638367
Epoch: 4, Steps: 2239 | Train Loss: 0.6032493 Vali Loss: 0.6229585 Test Loss: 0.3246212
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3320838212966919, mae:0.3740018606185913
