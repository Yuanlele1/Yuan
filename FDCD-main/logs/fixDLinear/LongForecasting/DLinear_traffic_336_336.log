Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11609
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.3550904
	speed: 0.1451s/iter; left time: 1037.9053s
	iters: 200, epoch: 1 | loss: 0.3981052
	speed: 0.1177s/iter; left time: 830.0994s
	iters: 300, epoch: 1 | loss: 0.4913483
	speed: 0.1138s/iter; left time: 791.1339s
	iters: 400, epoch: 1 | loss: 0.6093441
	speed: 0.1094s/iter; left time: 749.2910s
	iters: 500, epoch: 1 | loss: 0.8640419
	speed: 0.1041s/iter; left time: 702.5330s
	iters: 600, epoch: 1 | loss: 0.6650436
	speed: 0.1138s/iter; left time: 757.0049s
	iters: 700, epoch: 1 | loss: 0.7638710
	speed: 0.1204s/iter; left time: 788.5566s
Epoch: 1 cost time: 85.367431640625
Epoch: 1, Steps: 725 | Train Loss: 0.9285262 Vali Loss: 0.8853893 Test Loss: 1.0692006
Validation loss decreased (inf --> 0.885389).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 1.0580591
	speed: 1.1731s/iter; left time: 7538.4549s
	iters: 200, epoch: 2 | loss: 1.4678996
	speed: 0.1139s/iter; left time: 720.6952s
	iters: 300, epoch: 2 | loss: 0.8240731
	speed: 0.1285s/iter; left time: 799.8034s
	iters: 400, epoch: 2 | loss: 0.9631969
	speed: 0.1184s/iter; left time: 725.4084s
	iters: 500, epoch: 2 | loss: 0.7591885
	speed: 0.1292s/iter; left time: 778.7805s
	iters: 600, epoch: 2 | loss: 1.2489229
	speed: 0.1313s/iter; left time: 778.1996s
	iters: 700, epoch: 2 | loss: 0.9448304
	speed: 0.1313s/iter; left time: 765.1874s
Epoch: 2 cost time: 92.85237383842468
Epoch: 2, Steps: 725 | Train Loss: 0.9798247 Vali Loss: 1.0162331 Test Loss: 1.2117187
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3359541
	speed: 1.2496s/iter; left time: 7123.6950s
	iters: 200, epoch: 3 | loss: 0.3262275
	speed: 0.1224s/iter; left time: 685.4278s
	iters: 300, epoch: 3 | loss: 0.3026129
	speed: 0.1166s/iter; left time: 641.5602s
	iters: 400, epoch: 3 | loss: 0.3671446
	speed: 0.1190s/iter; left time: 642.6976s
	iters: 500, epoch: 3 | loss: 0.3218567
	speed: 0.1119s/iter; left time: 593.4327s
	iters: 600, epoch: 3 | loss: 0.3553410
	speed: 0.1143s/iter; left time: 594.6962s
	iters: 700, epoch: 3 | loss: 0.3528633
	speed: 0.1080s/iter; left time: 551.1281s
Epoch: 3 cost time: 86.87504458427429
Epoch: 3, Steps: 725 | Train Loss: 0.3522197 Vali Loss: 0.4845252 Test Loss: 0.5862566
Validation loss decreased (0.885389 --> 0.484525).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3080987
	speed: 1.2849s/iter; left time: 6393.5656s
	iters: 200, epoch: 4 | loss: 0.3140054
	speed: 0.1175s/iter; left time: 573.0605s
	iters: 300, epoch: 4 | loss: 0.3036219
	speed: 0.1233s/iter; left time: 588.6648s
	iters: 400, epoch: 4 | loss: 0.2993640
	speed: 0.1214s/iter; left time: 567.6649s
	iters: 500, epoch: 4 | loss: 0.3329747
	speed: 0.1173s/iter; left time: 536.8595s
	iters: 600, epoch: 4 | loss: 0.3205041
	speed: 0.1201s/iter; left time: 537.3600s
	iters: 700, epoch: 4 | loss: 0.3039511
	speed: 0.1153s/iter; left time: 504.5077s
Epoch: 4 cost time: 90.74383068084717
Epoch: 4, Steps: 725 | Train Loss: 0.3035913 Vali Loss: 0.4192897 Test Loss: 0.5068795
Validation loss decreased (0.484525 --> 0.419290).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2848005
	speed: 1.1847s/iter; left time: 5036.0193s
	iters: 200, epoch: 5 | loss: 0.3164109
	speed: 0.1150s/iter; left time: 477.5601s
	iters: 300, epoch: 5 | loss: 0.2785754
	speed: 0.1072s/iter; left time: 434.2744s
	iters: 400, epoch: 5 | loss: 0.2867095
	speed: 0.1119s/iter; left time: 441.9352s
	iters: 500, epoch: 5 | loss: 0.2813699
	speed: 0.1113s/iter; left time: 428.4264s
	iters: 600, epoch: 5 | loss: 0.2752382
	speed: 0.1160s/iter; left time: 435.0341s
	iters: 700, epoch: 5 | loss: 0.3212506
	speed: 0.1167s/iter; left time: 426.0359s
Epoch: 5 cost time: 85.41081595420837
Epoch: 5, Steps: 725 | Train Loss: 0.2847636 Vali Loss: 0.3923592 Test Loss: 0.4742528
Validation loss decreased (0.419290 --> 0.392359).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2721413
	speed: 1.2936s/iter; left time: 4561.1550s
	iters: 200, epoch: 6 | loss: 0.2835374
	speed: 0.1114s/iter; left time: 381.5302s
	iters: 300, epoch: 6 | loss: 0.2924121
	speed: 0.1262s/iter; left time: 419.7116s
	iters: 400, epoch: 6 | loss: 0.2761286
	speed: 0.1268s/iter; left time: 409.0067s
	iters: 500, epoch: 6 | loss: 0.2828051
	speed: 0.1265s/iter; left time: 395.3717s
	iters: 600, epoch: 6 | loss: 0.2680596
	speed: 0.1174s/iter; left time: 355.3172s
	iters: 700, epoch: 6 | loss: 0.2692786
	speed: 0.1330s/iter; left time: 389.2019s
Epoch: 6 cost time: 92.08913707733154
Epoch: 6, Steps: 725 | Train Loss: 0.2750646 Vali Loss: 0.3773377 Test Loss: 0.4589710
Validation loss decreased (0.392359 --> 0.377338).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2838684
	speed: 1.1894s/iter; left time: 3331.4089s
	iters: 200, epoch: 7 | loss: 0.2526540
	speed: 0.1062s/iter; left time: 286.9148s
	iters: 300, epoch: 7 | loss: 0.2515331
	speed: 0.1094s/iter; left time: 284.4511s
	iters: 400, epoch: 7 | loss: 0.2649189
	speed: 0.1033s/iter; left time: 258.4277s
	iters: 500, epoch: 7 | loss: 0.2864081
	speed: 0.1102s/iter; left time: 264.5432s
	iters: 600, epoch: 7 | loss: 0.2650534
	speed: 0.1116s/iter; left time: 256.6831s
	iters: 700, epoch: 7 | loss: 0.2582237
	speed: 0.1092s/iter; left time: 240.2460s
Epoch: 7 cost time: 81.59297823905945
Epoch: 7, Steps: 725 | Train Loss: 0.2696296 Vali Loss: 0.3689711 Test Loss: 0.4484662
Validation loss decreased (0.377338 --> 0.368971).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2422956
	speed: 1.0812s/iter; left time: 2244.6000s
	iters: 200, epoch: 8 | loss: 0.2533317
	speed: 0.1011s/iter; left time: 199.7524s
	iters: 300, epoch: 8 | loss: 0.2391648
	speed: 0.1082s/iter; left time: 202.8907s
	iters: 400, epoch: 8 | loss: 0.2876857
	speed: 0.1076s/iter; left time: 191.1630s
	iters: 500, epoch: 8 | loss: 0.2501855
	speed: 0.1061s/iter; left time: 177.8623s
	iters: 600, epoch: 8 | loss: 0.2789614
	speed: 0.1111s/iter; left time: 175.1407s
	iters: 700, epoch: 8 | loss: 0.2651197
	speed: 0.1026s/iter; left time: 151.4295s
Epoch: 8 cost time: 78.53961133956909
Epoch: 8, Steps: 725 | Train Loss: 0.2662519 Vali Loss: 0.3693952 Test Loss: 0.4467099
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2407843
	speed: 1.0320s/iter; left time: 1394.2482s
	iters: 200, epoch: 9 | loss: 0.2913396
	speed: 0.1234s/iter; left time: 154.3575s
	iters: 300, epoch: 9 | loss: 0.2574480
	speed: 0.1136s/iter; left time: 130.7567s
	iters: 400, epoch: 9 | loss: 0.2439114
	speed: 0.1246s/iter; left time: 130.9192s
	iters: 500, epoch: 9 | loss: 0.2587149
	speed: 0.1105s/iter; left time: 105.0852s
	iters: 600, epoch: 9 | loss: 0.2850701
	speed: 0.1108s/iter; left time: 94.2764s
	iters: 700, epoch: 9 | loss: 0.2690903
	speed: 0.1112s/iter; left time: 83.5474s
Epoch: 9 cost time: 86.21253681182861
Epoch: 9, Steps: 725 | Train Loss: 0.2642827 Vali Loss: 0.3657689 Test Loss: 0.4412057
Validation loss decreased (0.368971 --> 0.365769).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2403192
	speed: 1.0912s/iter; left time: 683.0860s
	iters: 200, epoch: 10 | loss: 0.2366279
	speed: 0.1071s/iter; left time: 56.3581s
	iters: 300, epoch: 10 | loss: 0.2551025
	speed: 0.1039s/iter; left time: 44.2580s
	iters: 400, epoch: 10 | loss: 0.2603174
	speed: 0.1049s/iter; left time: 34.1819s
	iters: 500, epoch: 10 | loss: 0.2807817
	speed: 0.1063s/iter; left time: 24.0148s
	iters: 600, epoch: 10 | loss: 0.2511377
	speed: 0.1085s/iter; left time: 13.6676s
	iters: 700, epoch: 10 | loss: 0.2527739
	speed: 0.1058s/iter; left time: 2.7518s
Epoch: 10 cost time: 80.55673599243164
Epoch: 10, Steps: 725 | Train Loss: 0.2631912 Vali Loss: 0.3624367 Test Loss: 0.4386575
Validation loss decreased (0.365769 --> 0.362437).  Saving model ...
Updating learning rate to 9.765625e-05
>>>>>>>testing : traffic_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.4376174509525299, mae:0.29855477809906006
