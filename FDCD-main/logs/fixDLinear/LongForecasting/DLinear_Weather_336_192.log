Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.7395955
	speed: 0.0611s/iter; left time: 1381.3567s
	iters: 200, epoch: 1 | loss: 0.3960417
	speed: 0.0545s/iter; left time: 1227.0158s
	iters: 300, epoch: 1 | loss: 0.5029473
	speed: 0.0541s/iter; left time: 1213.7131s
	iters: 400, epoch: 1 | loss: 1.1339000
	speed: 0.0569s/iter; left time: 1270.0799s
	iters: 500, epoch: 1 | loss: 1.4278387
	speed: 0.0555s/iter; left time: 1232.4351s
	iters: 600, epoch: 1 | loss: 0.3263037
	speed: 0.0472s/iter; left time: 1043.3404s
	iters: 700, epoch: 1 | loss: 0.4691373
	speed: 0.0463s/iter; left time: 1019.6201s
	iters: 800, epoch: 1 | loss: 0.5519750
	speed: 0.0481s/iter; left time: 1054.5304s
	iters: 900, epoch: 1 | loss: 0.4645048
	speed: 0.0450s/iter; left time: 982.8362s
	iters: 1000, epoch: 1 | loss: 0.4646277
	speed: 0.0458s/iter; left time: 994.2418s
	iters: 1100, epoch: 1 | loss: 0.3781556
	speed: 0.0531s/iter; left time: 1148.2488s
	iters: 1200, epoch: 1 | loss: 0.4606468
	speed: 0.0539s/iter; left time: 1160.7567s
	iters: 1300, epoch: 1 | loss: 0.3653493
	speed: 0.0513s/iter; left time: 1099.2809s
	iters: 1400, epoch: 1 | loss: 0.4861887
	speed: 0.0562s/iter; left time: 1197.4177s
	iters: 1500, epoch: 1 | loss: 0.5597795
	speed: 0.0529s/iter; left time: 1121.6934s
	iters: 1600, epoch: 1 | loss: 0.3212423
	speed: 0.0504s/iter; left time: 1063.5866s
	iters: 1700, epoch: 1 | loss: 1.3756804
	speed: 0.0525s/iter; left time: 1103.1648s
	iters: 1800, epoch: 1 | loss: 0.4093468
	speed: 0.0402s/iter; left time: 840.0388s
	iters: 1900, epoch: 1 | loss: 0.3395757
	speed: 0.0472s/iter; left time: 983.2794s
	iters: 2000, epoch: 1 | loss: 0.4068940
	speed: 0.0511s/iter; left time: 1059.7017s
	iters: 2100, epoch: 1 | loss: 0.3290914
	speed: 0.0535s/iter; left time: 1103.4743s
	iters: 2200, epoch: 1 | loss: 0.3635786
	speed: 0.0527s/iter; left time: 1080.7900s
Epoch: 1 cost time: 116.82265090942383
Epoch: 1, Steps: 2272 | Train Loss: 0.5485234 Vali Loss: 0.4926958 Test Loss: 0.2177327
Validation loss decreased (inf --> 0.492696).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4787261
	speed: 1.7196s/iter; left time: 34991.5641s
	iters: 200, epoch: 2 | loss: 0.4410958
	speed: 0.0459s/iter; left time: 929.4366s
	iters: 300, epoch: 2 | loss: 0.3387714
	speed: 0.0434s/iter; left time: 873.6191s
	iters: 400, epoch: 2 | loss: 0.4720331
	speed: 0.0432s/iter; left time: 867.0667s
	iters: 500, epoch: 2 | loss: 0.4753244
	speed: 0.0417s/iter; left time: 831.4416s
	iters: 600, epoch: 2 | loss: 0.3885693
	speed: 0.0443s/iter; left time: 878.4746s
	iters: 700, epoch: 2 | loss: 0.4262610
	speed: 0.0505s/iter; left time: 997.6762s
	iters: 800, epoch: 2 | loss: 1.2089115
	speed: 0.0581s/iter; left time: 1142.5672s
	iters: 900, epoch: 2 | loss: 0.2831789
	speed: 0.0569s/iter; left time: 1112.7534s
	iters: 1000, epoch: 2 | loss: 0.3310499
	speed: 0.0587s/iter; left time: 1141.0058s
	iters: 1100, epoch: 2 | loss: 0.5400579
	speed: 0.0580s/iter; left time: 1121.7023s
	iters: 1200, epoch: 2 | loss: 0.3411755
	speed: 0.0573s/iter; left time: 1102.0143s
	iters: 1300, epoch: 2 | loss: 0.4760956
	speed: 0.0601s/iter; left time: 1151.1725s
	iters: 1400, epoch: 2 | loss: 0.4151622
	speed: 0.0577s/iter; left time: 1098.3715s
	iters: 1500, epoch: 2 | loss: 1.3525023
	speed: 0.0593s/iter; left time: 1124.6184s
	iters: 1600, epoch: 2 | loss: 1.3746930
	speed: 0.0583s/iter; left time: 1099.6794s
	iters: 1700, epoch: 2 | loss: 0.7046377
	speed: 0.0568s/iter; left time: 1065.0726s
	iters: 1800, epoch: 2 | loss: 0.5427182
	speed: 0.0559s/iter; left time: 1043.2447s
	iters: 1900, epoch: 2 | loss: 0.4733984
	speed: 0.0577s/iter; left time: 1069.7616s
	iters: 2000, epoch: 2 | loss: 0.4835840
	speed: 0.0592s/iter; left time: 1091.7941s
	iters: 2100, epoch: 2 | loss: 0.3763631
	speed: 0.0576s/iter; left time: 1056.7699s
	iters: 2200, epoch: 2 | loss: 0.8341379
	speed: 0.0585s/iter; left time: 1067.4116s
Epoch: 2 cost time: 123.64571046829224
Epoch: 2, Steps: 2272 | Train Loss: 0.5118568 Vali Loss: 0.4875573 Test Loss: 0.2175142
Validation loss decreased (0.492696 --> 0.487557).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4892406
	speed: 1.8055s/iter; left time: 32638.4563s
	iters: 200, epoch: 3 | loss: 1.3785574
	speed: 0.0495s/iter; left time: 889.2796s
	iters: 300, epoch: 3 | loss: 0.5311562
	speed: 0.0542s/iter; left time: 968.7640s
	iters: 400, epoch: 3 | loss: 0.4712793
	speed: 0.0537s/iter; left time: 954.1381s
	iters: 500, epoch: 3 | loss: 0.3975258
	speed: 0.0536s/iter; left time: 948.0433s
	iters: 600, epoch: 3 | loss: 0.6090068
	speed: 0.0543s/iter; left time: 953.5832s
	iters: 700, epoch: 3 | loss: 0.3967214
	speed: 0.0551s/iter; left time: 962.8144s
	iters: 800, epoch: 3 | loss: 0.4665767
	speed: 0.0476s/iter; left time: 827.3613s
	iters: 900, epoch: 3 | loss: 1.2898144
	speed: 0.0463s/iter; left time: 800.6885s
	iters: 1000, epoch: 3 | loss: 0.4982816
	speed: 0.0534s/iter; left time: 917.2067s
	iters: 1100, epoch: 3 | loss: 0.2793564
	speed: 0.0519s/iter; left time: 885.4821s
	iters: 1200, epoch: 3 | loss: 0.4075519
	speed: 0.0524s/iter; left time: 889.7131s
	iters: 1300, epoch: 3 | loss: 0.3171520
	speed: 0.0326s/iter; left time: 550.9378s
	iters: 1400, epoch: 3 | loss: 0.4430099
	speed: 0.0328s/iter; left time: 550.1500s
	iters: 1500, epoch: 3 | loss: 0.4571851
	speed: 0.0412s/iter; left time: 686.8983s
	iters: 1600, epoch: 3 | loss: 0.3403910
	speed: 0.0321s/iter; left time: 531.5859s
	iters: 1700, epoch: 3 | loss: 0.4920838
	speed: 0.0295s/iter; left time: 486.3391s
	iters: 1800, epoch: 3 | loss: 0.4610354
	speed: 0.0271s/iter; left time: 443.0614s
	iters: 1900, epoch: 3 | loss: 0.5797582
	speed: 0.0295s/iter; left time: 479.6285s
	iters: 2000, epoch: 3 | loss: 0.5529115
	speed: 0.0377s/iter; left time: 609.9687s
	iters: 2100, epoch: 3 | loss: 0.4269214
	speed: 0.0394s/iter; left time: 633.8193s
	iters: 2200, epoch: 3 | loss: 0.4225099
	speed: 0.0561s/iter; left time: 896.7322s
Epoch: 3 cost time: 103.0151481628418
Epoch: 3, Steps: 2272 | Train Loss: 0.5052608 Vali Loss: 0.4840105 Test Loss: 0.2171732
Validation loss decreased (0.487557 --> 0.484011).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6020877
	speed: 1.8705s/iter; left time: 29563.2069s
	iters: 200, epoch: 4 | loss: 1.4148183
	speed: 0.0545s/iter; left time: 856.6973s
	iters: 300, epoch: 4 | loss: 0.3243433
	speed: 0.0572s/iter; left time: 892.1475s
	iters: 400, epoch: 4 | loss: 0.3806683
	speed: 0.0551s/iter; left time: 854.5260s
	iters: 500, epoch: 4 | loss: 0.4156457
	speed: 0.0531s/iter; left time: 818.5924s
	iters: 600, epoch: 4 | loss: 0.4325197
	speed: 0.0542s/iter; left time: 829.7194s
	iters: 700, epoch: 4 | loss: 0.6908911
	speed: 0.0535s/iter; left time: 812.7190s
	iters: 800, epoch: 4 | loss: 0.2986511
	speed: 0.0544s/iter; left time: 821.3055s
	iters: 900, epoch: 4 | loss: 0.4325039
	speed: 0.0547s/iter; left time: 820.7757s
	iters: 1000, epoch: 4 | loss: 0.3360882
	speed: 0.0546s/iter; left time: 813.1805s
	iters: 1100, epoch: 4 | loss: 0.5816920
	speed: 0.0561s/iter; left time: 831.1943s
	iters: 1200, epoch: 4 | loss: 0.3054916
	speed: 0.0569s/iter; left time: 836.9037s
	iters: 1300, epoch: 4 | loss: 0.3181519
	speed: 0.0556s/iter; left time: 812.2568s
	iters: 1400, epoch: 4 | loss: 0.2810121
	speed: 0.0527s/iter; left time: 764.4233s
	iters: 1500, epoch: 4 | loss: 0.3668750
	speed: 0.0545s/iter; left time: 785.6109s
	iters: 1600, epoch: 4 | loss: 0.4461587
	speed: 0.0544s/iter; left time: 778.4941s
	iters: 1700, epoch: 4 | loss: 0.4371365
	speed: 0.0567s/iter; left time: 806.0130s
	iters: 1800, epoch: 4 | loss: 0.5747290
	speed: 0.0564s/iter; left time: 795.8710s
	iters: 1900, epoch: 4 | loss: 0.5271448
	speed: 0.0550s/iter; left time: 769.9294s
	iters: 2000, epoch: 4 | loss: 0.4044675
	speed: 0.0535s/iter; left time: 743.4319s
	iters: 2100, epoch: 4 | loss: 0.6042343
	speed: 0.0543s/iter; left time: 750.2137s
	iters: 2200, epoch: 4 | loss: 0.3236569
	speed: 0.0572s/iter; left time: 784.4569s
Epoch: 4 cost time: 126.00625014305115
Epoch: 4, Steps: 2272 | Train Loss: 0.5029399 Vali Loss: 0.4828124 Test Loss: 0.2176466
Validation loss decreased (0.484011 --> 0.482812).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4220819
	speed: 1.9048s/iter; left time: 25777.6441s
	iters: 200, epoch: 5 | loss: 0.2731189
	speed: 0.0539s/iter; left time: 724.4387s
	iters: 300, epoch: 5 | loss: 0.3024236
	speed: 0.0538s/iter; left time: 717.7065s
	iters: 400, epoch: 5 | loss: 0.2782978
	speed: 0.0541s/iter; left time: 716.4051s
	iters: 500, epoch: 5 | loss: 0.3180178
	speed: 0.0536s/iter; left time: 703.7677s
	iters: 600, epoch: 5 | loss: 0.4975254
	speed: 0.0532s/iter; left time: 692.9421s
	iters: 700, epoch: 5 | loss: 0.4355806
	speed: 0.0539s/iter; left time: 696.9371s
	iters: 800, epoch: 5 | loss: 0.4084377
	speed: 0.0525s/iter; left time: 673.1131s
	iters: 900, epoch: 5 | loss: 0.3455560
	speed: 0.0534s/iter; left time: 679.4517s
	iters: 1000, epoch: 5 | loss: 0.3304790
	speed: 0.0532s/iter; left time: 671.6721s
	iters: 1100, epoch: 5 | loss: 0.4964359
	speed: 0.0528s/iter; left time: 661.6510s
	iters: 1200, epoch: 5 | loss: 0.4145479
	speed: 0.0531s/iter; left time: 660.2282s
	iters: 1300, epoch: 5 | loss: 0.3700826
	speed: 0.0559s/iter; left time: 688.9175s
	iters: 1400, epoch: 5 | loss: 0.3376206
	speed: 0.0538s/iter; left time: 657.6600s
	iters: 1500, epoch: 5 | loss: 0.4273466
	speed: 0.0529s/iter; left time: 641.7253s
	iters: 1600, epoch: 5 | loss: 0.5961981
	speed: 0.0534s/iter; left time: 642.8301s
	iters: 1700, epoch: 5 | loss: 0.3031119
	speed: 0.0525s/iter; left time: 626.1621s
	iters: 1800, epoch: 5 | loss: 1.5621747
	speed: 0.0531s/iter; left time: 628.3450s
	iters: 1900, epoch: 5 | loss: 0.3478899
	speed: 0.0433s/iter; left time: 508.0303s
	iters: 2000, epoch: 5 | loss: 0.5402223
	speed: 0.0510s/iter; left time: 593.3550s
	iters: 2100, epoch: 5 | loss: 1.4950497
	speed: 0.0513s/iter; left time: 592.0339s
	iters: 2200, epoch: 5 | loss: 0.3955439
	speed: 0.0552s/iter; left time: 630.7178s
Epoch: 5 cost time: 120.37247824668884
Epoch: 5, Steps: 2272 | Train Loss: 0.5016725 Vali Loss: 0.4853352 Test Loss: 0.2155003
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4556802
	speed: 1.8345s/iter; left time: 20658.4164s
	iters: 200, epoch: 6 | loss: 0.4620751
	speed: 0.0503s/iter; left time: 561.1070s
	iters: 300, epoch: 6 | loss: 0.3556843
	speed: 0.0499s/iter; left time: 552.4346s
	iters: 400, epoch: 6 | loss: 0.5498594
	speed: 0.0497s/iter; left time: 545.2824s
	iters: 500, epoch: 6 | loss: 0.3775288
	speed: 0.0506s/iter; left time: 549.1686s
	iters: 600, epoch: 6 | loss: 0.5305961
	speed: 0.0507s/iter; left time: 545.3371s
	iters: 700, epoch: 6 | loss: 0.3216245
	speed: 0.0509s/iter; left time: 542.4617s
	iters: 800, epoch: 6 | loss: 1.4717909
	speed: 0.0462s/iter; left time: 487.8861s
	iters: 900, epoch: 6 | loss: 0.4707538
	speed: 0.0491s/iter; left time: 513.8130s
	iters: 1000, epoch: 6 | loss: 0.2990387
	speed: 0.0522s/iter; left time: 541.2152s
	iters: 1100, epoch: 6 | loss: 0.4393983
	speed: 0.0503s/iter; left time: 516.1715s
	iters: 1200, epoch: 6 | loss: 0.2855035
	speed: 0.0512s/iter; left time: 519.8589s
	iters: 1300, epoch: 6 | loss: 0.3119956
	speed: 0.0505s/iter; left time: 508.2962s
	iters: 1400, epoch: 6 | loss: 0.3551501
	speed: 0.0490s/iter; left time: 488.2648s
	iters: 1500, epoch: 6 | loss: 0.5346849
	speed: 0.0492s/iter; left time: 485.1371s
	iters: 1600, epoch: 6 | loss: 0.6272505
	speed: 0.0491s/iter; left time: 479.6549s
	iters: 1700, epoch: 6 | loss: 0.5516076
	speed: 0.0503s/iter; left time: 485.5110s
	iters: 1800, epoch: 6 | loss: 0.4991653
	speed: 0.0510s/iter; left time: 487.5182s
	iters: 1900, epoch: 6 | loss: 0.3668867
	speed: 0.0486s/iter; left time: 459.4351s
	iters: 2000, epoch: 6 | loss: 0.3385757
	speed: 0.0488s/iter; left time: 456.6908s
	iters: 2100, epoch: 6 | loss: 0.4990052
	speed: 0.0497s/iter; left time: 460.0596s
	iters: 2200, epoch: 6 | loss: 0.5124524
	speed: 0.0501s/iter; left time: 459.1810s
Epoch: 6 cost time: 114.70506715774536
Epoch: 6, Steps: 2272 | Train Loss: 0.5014741 Vali Loss: 0.4842764 Test Loss: 0.2159325
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2763481
	speed: 1.7110s/iter; left time: 15379.9521s
	iters: 200, epoch: 7 | loss: 0.3774684
	speed: 0.0545s/iter; left time: 484.5945s
	iters: 300, epoch: 7 | loss: 0.5800185
	speed: 0.0547s/iter; left time: 481.0264s
	iters: 400, epoch: 7 | loss: 0.2979642
	speed: 0.0534s/iter; left time: 463.9057s
	iters: 500, epoch: 7 | loss: 0.3769145
	speed: 0.0573s/iter; left time: 492.5325s
	iters: 600, epoch: 7 | loss: 0.3163226
	speed: 0.0545s/iter; left time: 462.3370s
	iters: 700, epoch: 7 | loss: 0.3224236
	speed: 0.0565s/iter; left time: 473.7575s
	iters: 800, epoch: 7 | loss: 0.4078630
	speed: 0.0561s/iter; left time: 464.6411s
	iters: 900, epoch: 7 | loss: 0.4951781
	speed: 0.0548s/iter; left time: 448.5779s
	iters: 1000, epoch: 7 | loss: 0.3852149
	speed: 0.0528s/iter; left time: 427.2396s
	iters: 1100, epoch: 7 | loss: 0.3819304
	speed: 0.0557s/iter; left time: 445.2113s
	iters: 1200, epoch: 7 | loss: 0.3048486
	speed: 0.0547s/iter; left time: 431.8171s
	iters: 1300, epoch: 7 | loss: 0.3635987
	speed: 0.0550s/iter; left time: 428.6040s
	iters: 1400, epoch: 7 | loss: 0.3582032
	speed: 0.0553s/iter; left time: 425.5569s
	iters: 1500, epoch: 7 | loss: 0.4155965
	speed: 0.0545s/iter; left time: 413.7524s
	iters: 1600, epoch: 7 | loss: 0.5164708
	speed: 0.0535s/iter; left time: 400.6519s
	iters: 1700, epoch: 7 | loss: 0.2814648
	speed: 0.0521s/iter; left time: 384.7606s
	iters: 1800, epoch: 7 | loss: 0.3974192
	speed: 0.0510s/iter; left time: 372.0416s
	iters: 1900, epoch: 7 | loss: 0.2703261
	speed: 0.0505s/iter; left time: 363.1329s
	iters: 2000, epoch: 7 | loss: 0.5296924
	speed: 0.0515s/iter; left time: 365.2215s
	iters: 2100, epoch: 7 | loss: 1.2906773
	speed: 0.0520s/iter; left time: 363.3722s
	iters: 2200, epoch: 7 | loss: 0.5295154
	speed: 0.0500s/iter; left time: 344.2528s
Epoch: 7 cost time: 123.06873154640198
Epoch: 7, Steps: 2272 | Train Loss: 0.5012529 Vali Loss: 0.4846520 Test Loss: 0.2156621
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.21768945455551147, mae:0.2777418792247772
