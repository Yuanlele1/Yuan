Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.3709127
	speed: 0.1550s/iter; left time: 1071.1900s
	iters: 200, epoch: 1 | loss: 0.3904448
	speed: 0.1535s/iter; left time: 1045.6624s
	iters: 300, epoch: 1 | loss: 0.5128317
	speed: 0.1515s/iter; left time: 1016.7630s
	iters: 400, epoch: 1 | loss: 0.6649622
	speed: 0.1596s/iter; left time: 1055.1272s
	iters: 500, epoch: 1 | loss: 0.8471725
	speed: 0.1500s/iter; left time: 976.6901s
	iters: 600, epoch: 1 | loss: 0.9862453
	speed: 0.1473s/iter; left time: 944.0829s
	iters: 700, epoch: 1 | loss: 0.9254908
	speed: 0.1541s/iter; left time: 972.7986s
Epoch: 1 cost time: 107.56606936454773
Epoch: 1, Steps: 701 | Train Loss: 1.0414636 Vali Loss: 1.3760905 Test Loss: 1.6284647
Validation loss decreased (inf --> 1.376091).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 0.7428101
	speed: 1.3196s/iter; left time: 8194.7121s
	iters: 200, epoch: 2 | loss: 0.9790177
	speed: 0.1517s/iter; left time: 926.6535s
	iters: 300, epoch: 2 | loss: 1.3097432
	speed: 0.1485s/iter; left time: 892.3240s
	iters: 400, epoch: 2 | loss: 1.6932350
	speed: 0.1519s/iter; left time: 897.9643s
	iters: 500, epoch: 2 | loss: 1.0637325
	speed: 0.1355s/iter; left time: 787.5319s
	iters: 600, epoch: 2 | loss: 0.9038745
	speed: 0.1272s/iter; left time: 726.0611s
	iters: 700, epoch: 2 | loss: 1.1868243
	speed: 0.1249s/iter; left time: 700.8975s
Epoch: 2 cost time: 100.17425417900085
Epoch: 2, Steps: 701 | Train Loss: 1.0270163 Vali Loss: 1.2851357 Test Loss: 1.5381681
Validation loss decreased (1.376091 --> 1.285136).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3096883
	speed: 1.2773s/iter; left time: 7036.8104s
	iters: 200, epoch: 3 | loss: 0.3464415
	speed: 0.1504s/iter; left time: 813.7184s
	iters: 300, epoch: 3 | loss: 0.3484944
	speed: 0.1431s/iter; left time: 759.8602s
	iters: 400, epoch: 3 | loss: 0.3614808
	speed: 0.1457s/iter; left time: 759.0939s
	iters: 500, epoch: 3 | loss: 0.3899867
	speed: 0.1564s/iter; left time: 799.2051s
	iters: 600, epoch: 3 | loss: 0.4020061
	speed: 0.1580s/iter; left time: 791.5186s
	iters: 700, epoch: 3 | loss: 0.3607605
	speed: 0.1606s/iter; left time: 788.2462s
Epoch: 3 cost time: 106.94354104995728
Epoch: 3, Steps: 701 | Train Loss: 0.3746637 Vali Loss: 0.5333996 Test Loss: 0.6256093
Validation loss decreased (1.285136 --> 0.533400).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.3144717
	speed: 1.4003s/iter; left time: 6732.6650s
	iters: 200, epoch: 4 | loss: 0.3230521
	speed: 0.1341s/iter; left time: 631.4374s
	iters: 300, epoch: 4 | loss: 0.3308857
	speed: 0.1483s/iter; left time: 683.3337s
	iters: 400, epoch: 4 | loss: 0.3076148
	speed: 0.1465s/iter; left time: 660.5254s
	iters: 500, epoch: 4 | loss: 0.3273369
	speed: 0.1563s/iter; left time: 689.1545s
	iters: 600, epoch: 4 | loss: 0.3409925
	speed: 0.1538s/iter; left time: 662.6500s
	iters: 700, epoch: 4 | loss: 0.3408152
	speed: 0.1468s/iter; left time: 617.5740s
Epoch: 4 cost time: 103.29067993164062
Epoch: 4, Steps: 701 | Train Loss: 0.3230292 Vali Loss: 0.4615418 Test Loss: 0.5306380
Validation loss decreased (0.533400 --> 0.461542).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.3153392
	speed: 1.2979s/iter; left time: 5330.3773s
	iters: 200, epoch: 5 | loss: 0.2928357
	speed: 0.1400s/iter; left time: 560.9076s
	iters: 300, epoch: 5 | loss: 0.3048242
	speed: 0.1351s/iter; left time: 527.6535s
	iters: 400, epoch: 5 | loss: 0.3080667
	speed: 0.1403s/iter; left time: 534.2379s
	iters: 500, epoch: 5 | loss: 0.2935903
	speed: 0.1340s/iter; left time: 496.8875s
	iters: 600, epoch: 5 | loss: 0.3308398
	speed: 0.1292s/iter; left time: 465.8513s
	iters: 700, epoch: 5 | loss: 0.2899766
	speed: 0.1334s/iter; left time: 467.8887s
Epoch: 5 cost time: 96.47475385665894
Epoch: 5, Steps: 701 | Train Loss: 0.3031766 Vali Loss: 0.4345127 Test Loss: 0.4982647
Validation loss decreased (0.461542 --> 0.434513).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2912426
	speed: 1.2296s/iter; left time: 4187.8787s
	iters: 200, epoch: 6 | loss: 0.2974170
	speed: 0.1517s/iter; left time: 501.4230s
	iters: 300, epoch: 6 | loss: 0.2927990
	speed: 0.1399s/iter; left time: 448.3693s
	iters: 400, epoch: 6 | loss: 0.2799735
	speed: 0.1432s/iter; left time: 444.9102s
	iters: 500, epoch: 6 | loss: 0.2780633
	speed: 0.1452s/iter; left time: 436.4430s
	iters: 600, epoch: 6 | loss: 0.2909456
	speed: 0.1428s/iter; left time: 415.0342s
	iters: 700, epoch: 6 | loss: 0.3039184
	speed: 0.1441s/iter; left time: 404.2152s
Epoch: 6 cost time: 103.22072052955627
Epoch: 6, Steps: 701 | Train Loss: 0.2933839 Vali Loss: 0.4243486 Test Loss: 0.4874201
Validation loss decreased (0.434513 --> 0.424349).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2853404
	speed: 1.2747s/iter; left time: 3447.9689s
	iters: 200, epoch: 7 | loss: 0.2847227
	speed: 0.1507s/iter; left time: 392.4875s
	iters: 300, epoch: 7 | loss: 0.2907187
	speed: 0.1467s/iter; left time: 367.3640s
	iters: 400, epoch: 7 | loss: 0.2719145
	speed: 0.1525s/iter; left time: 366.8335s
	iters: 500, epoch: 7 | loss: 0.2899695
	speed: 0.1477s/iter; left time: 340.4248s
	iters: 600, epoch: 7 | loss: 0.3041245
	speed: 0.1424s/iter; left time: 313.8928s
	iters: 700, epoch: 7 | loss: 0.2769983
	speed: 0.1528s/iter; left time: 321.7335s
Epoch: 7 cost time: 105.18169641494751
Epoch: 7, Steps: 701 | Train Loss: 0.2877444 Vali Loss: 0.4164540 Test Loss: 0.4797322
Validation loss decreased (0.424349 --> 0.416454).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2672849
	speed: 1.3364s/iter; left time: 2678.0922s
	iters: 200, epoch: 8 | loss: 0.2860460
	speed: 0.1480s/iter; left time: 281.8009s
	iters: 300, epoch: 8 | loss: 0.2923156
	speed: 0.1435s/iter; left time: 258.7884s
	iters: 400, epoch: 8 | loss: 0.2687092
	speed: 0.1447s/iter; left time: 246.5462s
	iters: 500, epoch: 8 | loss: 0.2990967
	speed: 0.1499s/iter; left time: 240.4268s
	iters: 600, epoch: 8 | loss: 0.2734517
	speed: 0.1469s/iter; left time: 220.9483s
	iters: 700, epoch: 8 | loss: 0.3011453
	speed: 0.1485s/iter; left time: 208.5426s
Epoch: 8 cost time: 104.41574573516846
Epoch: 8, Steps: 701 | Train Loss: 0.2842225 Vali Loss: 0.4119677 Test Loss: 0.4724378
Validation loss decreased (0.416454 --> 0.411968).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.3118551
	speed: 1.2082s/iter; left time: 1574.3247s
	iters: 200, epoch: 9 | loss: 0.2716271
	speed: 0.1415s/iter; left time: 170.1846s
	iters: 300, epoch: 9 | loss: 0.2887851
	speed: 0.1411s/iter; left time: 155.6860s
	iters: 400, epoch: 9 | loss: 0.2657373
	speed: 0.1483s/iter; left time: 148.7863s
	iters: 500, epoch: 9 | loss: 0.2701882
	speed: 0.1436s/iter; left time: 129.6498s
	iters: 600, epoch: 9 | loss: 0.2910794
	speed: 0.1418s/iter; left time: 113.8631s
	iters: 700, epoch: 9 | loss: 0.2849880
	speed: 0.1508s/iter; left time: 105.9955s
Epoch: 9 cost time: 102.40632963180542
Epoch: 9, Steps: 701 | Train Loss: 0.2822154 Vali Loss: 0.4081444 Test Loss: 0.4687087
Validation loss decreased (0.411968 --> 0.408144).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2859061
	speed: 1.3418s/iter; left time: 807.7514s
	iters: 200, epoch: 10 | loss: 0.2893475
	speed: 0.1650s/iter; left time: 82.8345s
	iters: 300, epoch: 10 | loss: 0.2631996
	speed: 0.1451s/iter; left time: 58.3256s
	iters: 400, epoch: 10 | loss: 0.2985598
	speed: 0.1423s/iter; left time: 42.9641s
	iters: 500, epoch: 10 | loss: 0.2561602
	speed: 0.1462s/iter; left time: 29.5425s
	iters: 600, epoch: 10 | loss: 0.2818236
	speed: 0.1450s/iter; left time: 14.7889s
	iters: 700, epoch: 10 | loss: 0.2731666
	speed: 0.1461s/iter; left time: 0.2922s
Epoch: 10 cost time: 107.45132160186768
Epoch: 10, Steps: 701 | Train Loss: 0.2809912 Vali Loss: 0.4061818 Test Loss: 0.4663178
Validation loss decreased (0.408144 --> 0.406182).  Saving model ...
Updating learning rate to 9.765625e-05
>>>>>>>testing : traffic_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.46616390347480774, mae:0.31573984026908875
