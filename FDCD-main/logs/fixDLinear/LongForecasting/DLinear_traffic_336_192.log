Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.3176690
	speed: 0.0940s/iter; left time: 680.6428s
	iters: 200, epoch: 1 | loss: 0.3497903
	speed: 0.0903s/iter; left time: 644.5905s
	iters: 300, epoch: 1 | loss: 0.4896107
	speed: 0.0885s/iter; left time: 623.1758s
	iters: 400, epoch: 1 | loss: 0.8344077
	speed: 0.0909s/iter; left time: 631.0931s
	iters: 500, epoch: 1 | loss: 0.6242692
	speed: 0.0886s/iter; left time: 606.4116s
	iters: 600, epoch: 1 | loss: 0.8381186
	speed: 0.0885s/iter; left time: 596.6187s
	iters: 700, epoch: 1 | loss: 0.4964931
	speed: 0.0993s/iter; left time: 659.7808s
Epoch: 1 cost time: 67.36258602142334
Epoch: 1, Steps: 734 | Train Loss: 0.9972311 Vali Loss: 0.9571582 Test Loss: 1.1467779
Validation loss decreased (inf --> 0.957158).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 1.5779598
	speed: 0.9769s/iter; left time: 6356.7284s
	iters: 200, epoch: 2 | loss: 1.7634728
	speed: 0.0839s/iter; left time: 537.4712s
	iters: 300, epoch: 2 | loss: 1.0978960
	speed: 0.0865s/iter; left time: 545.8365s
	iters: 400, epoch: 2 | loss: 0.5176550
	speed: 0.0848s/iter; left time: 526.4353s
	iters: 500, epoch: 2 | loss: 0.4873033
	speed: 0.0930s/iter; left time: 568.0970s
	iters: 600, epoch: 2 | loss: 0.7781699
	speed: 0.0955s/iter; left time: 573.7074s
	iters: 700, epoch: 2 | loss: 0.6622332
	speed: 0.0964s/iter; left time: 569.4216s
Epoch: 2 cost time: 67.82865715026855
Epoch: 2, Steps: 734 | Train Loss: 0.9321455 Vali Loss: 1.0921408 Test Loss: 1.3004740
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3264432
	speed: 0.9438s/iter; left time: 5448.4240s
	iters: 200, epoch: 3 | loss: 0.2993013
	speed: 0.1011s/iter; left time: 573.5743s
	iters: 300, epoch: 3 | loss: 0.3294232
	speed: 0.0977s/iter; left time: 544.5691s
	iters: 400, epoch: 3 | loss: 0.3150799
	speed: 0.0907s/iter; left time: 496.6639s
	iters: 500, epoch: 3 | loss: 0.3458165
	speed: 0.1009s/iter; left time: 542.1558s
	iters: 600, epoch: 3 | loss: 0.3529557
	speed: 0.0937s/iter; left time: 494.0033s
	iters: 700, epoch: 3 | loss: 0.3899061
	speed: 0.0874s/iter; left time: 452.0267s
Epoch: 3 cost time: 71.72385358810425
Epoch: 3, Steps: 734 | Train Loss: 0.3380022 Vali Loss: 0.4633104 Test Loss: 0.5662534
Validation loss decreased (0.957158 --> 0.463310).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.2699830
	speed: 0.9977s/iter; left time: 5027.3046s
	iters: 200, epoch: 4 | loss: 0.2787022
	speed: 0.0788s/iter; left time: 389.1229s
	iters: 300, epoch: 4 | loss: 0.2988147
	speed: 0.0785s/iter; left time: 379.8052s
	iters: 400, epoch: 4 | loss: 0.3543687
	speed: 0.0830s/iter; left time: 393.5581s
	iters: 500, epoch: 4 | loss: 0.3276000
	speed: 0.0823s/iter; left time: 381.9762s
	iters: 600, epoch: 4 | loss: 0.3133486
	speed: 0.0838s/iter; left time: 380.5689s
	iters: 700, epoch: 4 | loss: 0.3052547
	speed: 0.0864s/iter; left time: 383.3270s
Epoch: 4 cost time: 63.18427300453186
Epoch: 4, Steps: 734 | Train Loss: 0.2930918 Vali Loss: 0.4018627 Test Loss: 0.4917309
Validation loss decreased (0.463310 --> 0.401863).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2923145
	speed: 1.0447s/iter; left time: 4497.2750s
	iters: 200, epoch: 5 | loss: 0.2498111
	speed: 0.0935s/iter; left time: 393.1603s
	iters: 300, epoch: 5 | loss: 0.2715389
	speed: 0.0902s/iter; left time: 370.4237s
	iters: 400, epoch: 5 | loss: 0.2831803
	speed: 0.0938s/iter; left time: 375.7858s
	iters: 500, epoch: 5 | loss: 0.2641568
	speed: 0.0993s/iter; left time: 387.8084s
	iters: 600, epoch: 5 | loss: 0.2838144
	speed: 0.0938s/iter; left time: 356.8321s
	iters: 700, epoch: 5 | loss: 0.2761614
	speed: 0.0972s/iter; left time: 360.2639s
Epoch: 5 cost time: 72.24526596069336
Epoch: 5, Steps: 734 | Train Loss: 0.2733826 Vali Loss: 0.3740328 Test Loss: 0.4550919
Validation loss decreased (0.401863 --> 0.374033).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2497324
	speed: 1.0757s/iter; left time: 3841.2790s
	iters: 200, epoch: 6 | loss: 0.2606083
	speed: 0.0907s/iter; left time: 314.7963s
	iters: 300, epoch: 6 | loss: 0.2680415
	speed: 0.1033s/iter; left time: 348.2640s
	iters: 400, epoch: 6 | loss: 0.3082745
	speed: 0.0994s/iter; left time: 325.1821s
	iters: 500, epoch: 6 | loss: 0.3029063
	speed: 0.1032s/iter; left time: 327.1132s
	iters: 600, epoch: 6 | loss: 0.2853720
	speed: 0.0974s/iter; left time: 299.2092s
	iters: 700, epoch: 6 | loss: 0.2632088
	speed: 0.0922s/iter; left time: 273.9848s
Epoch: 6 cost time: 73.32717323303223
Epoch: 6, Steps: 734 | Train Loss: 0.2638595 Vali Loss: 0.3626134 Test Loss: 0.4427883
Validation loss decreased (0.374033 --> 0.362613).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2374457
	speed: 1.2565s/iter; left time: 3564.6064s
	iters: 200, epoch: 7 | loss: 0.2720896
	speed: 0.1334s/iter; left time: 365.1104s
	iters: 300, epoch: 7 | loss: 0.2493835
	speed: 0.1297s/iter; left time: 341.9861s
	iters: 400, epoch: 7 | loss: 0.2621359
	speed: 0.1435s/iter; left time: 364.0173s
	iters: 500, epoch: 7 | loss: 0.3280117
	speed: 0.1239s/iter; left time: 301.9424s
	iters: 600, epoch: 7 | loss: 0.2427164
	speed: 0.1218s/iter; left time: 284.5465s
	iters: 700, epoch: 7 | loss: 0.2533456
	speed: 0.1232s/iter; left time: 275.5970s
Epoch: 7 cost time: 96.75330686569214
Epoch: 7, Steps: 734 | Train Loss: 0.2587991 Vali Loss: 0.3543688 Test Loss: 0.4343126
Validation loss decreased (0.362613 --> 0.354369).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2576444
	speed: 1.3743s/iter; left time: 2890.1031s
	iters: 200, epoch: 8 | loss: 0.2482063
	speed: 0.1035s/iter; left time: 207.3456s
	iters: 300, epoch: 8 | loss: 0.2404701
	speed: 0.1125s/iter; left time: 214.0643s
	iters: 400, epoch: 8 | loss: 0.2550426
	speed: 0.1099s/iter; left time: 198.0912s
	iters: 500, epoch: 8 | loss: 0.2580766
	speed: 0.1145s/iter; left time: 195.0612s
	iters: 600, epoch: 8 | loss: 0.3073697
	speed: 0.1038s/iter; left time: 166.3663s
	iters: 700, epoch: 8 | loss: 0.2586231
	speed: 0.1099s/iter; left time: 165.1367s
Epoch: 8 cost time: 81.91956543922424
Epoch: 8, Steps: 734 | Train Loss: 0.2555416 Vali Loss: 0.3503924 Test Loss: 0.4296867
Validation loss decreased (0.354369 --> 0.350392).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2764036
	speed: 1.3041s/iter; left time: 1785.3229s
	iters: 200, epoch: 9 | loss: 0.2233785
	speed: 0.1124s/iter; left time: 142.6743s
	iters: 300, epoch: 9 | loss: 0.2647391
	speed: 0.1147s/iter; left time: 134.0798s
	iters: 400, epoch: 9 | loss: 0.2375786
	speed: 0.1113s/iter; left time: 118.9440s
	iters: 500, epoch: 9 | loss: 0.2528285
	speed: 0.1190s/iter; left time: 115.3545s
	iters: 600, epoch: 9 | loss: 0.2606123
	speed: 0.1093s/iter; left time: 94.9416s
	iters: 700, epoch: 9 | loss: 0.2586623
	speed: 0.1273s/iter; left time: 97.9095s
Epoch: 9 cost time: 87.83951616287231
Epoch: 9, Steps: 734 | Train Loss: 0.2536567 Vali Loss: 0.3478633 Test Loss: 0.4263866
Validation loss decreased (0.350392 --> 0.347863).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2646047
	speed: 1.2472s/iter; left time: 791.9587s
	iters: 200, epoch: 10 | loss: 0.2502536
	speed: 0.1103s/iter; left time: 59.0150s
	iters: 300, epoch: 10 | loss: 0.2416166
	speed: 0.1291s/iter; left time: 56.1795s
	iters: 400, epoch: 10 | loss: 0.2477910
	speed: 0.1242s/iter; left time: 41.5907s
	iters: 500, epoch: 10 | loss: 0.2552449
	speed: 0.1112s/iter; left time: 26.1397s
	iters: 600, epoch: 10 | loss: 0.2479283
	speed: 0.1106s/iter; left time: 14.9317s
	iters: 700, epoch: 10 | loss: 0.2934868
	speed: 0.1155s/iter; left time: 4.0423s
Epoch: 10 cost time: 87.53177881240845
Epoch: 10, Steps: 734 | Train Loss: 0.2525726 Vali Loss: 0.3463733 Test Loss: 0.4240661
Validation loss decreased (0.347863 --> 0.346373).  Saving model ...
Updating learning rate to 9.765625e-05
>>>>>>>testing : traffic_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.4237386882305145, mae:0.2898254692554474
