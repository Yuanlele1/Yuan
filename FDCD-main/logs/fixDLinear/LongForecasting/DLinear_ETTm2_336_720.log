Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.01, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5461740
	speed: 0.1281s/iter; left time: 1328.3837s
	iters: 200, epoch: 1 | loss: 0.5087904
	speed: 0.1190s/iter; left time: 1222.7343s
	iters: 300, epoch: 1 | loss: 0.9869810
	speed: 0.1207s/iter; left time: 1227.2356s
	iters: 400, epoch: 1 | loss: 1.0802125
	speed: 0.1211s/iter; left time: 1219.9093s
	iters: 500, epoch: 1 | loss: 0.6060780
	speed: 0.1290s/iter; left time: 1286.6850s
	iters: 600, epoch: 1 | loss: 0.7293807
	speed: 0.1312s/iter; left time: 1295.5489s
	iters: 700, epoch: 1 | loss: 1.1207808
	speed: 0.1225s/iter; left time: 1197.3272s
	iters: 800, epoch: 1 | loss: 0.5592701
	speed: 0.1262s/iter; left time: 1220.7023s
	iters: 900, epoch: 1 | loss: 0.5251045
	speed: 0.1127s/iter; left time: 1078.4495s
	iters: 1000, epoch: 1 | loss: 0.5940583
	speed: 0.1317s/iter; left time: 1247.7126s
Epoch: 1 cost time: 130.2297134399414
Epoch: 1, Steps: 1047 | Train Loss: 0.6320900 Vali Loss: 1.1571883 Test Loss: 2.3360450
Validation loss decreased (inf --> 1.157188).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.8814491
	speed: 2.0563s/iter; left time: 19173.3333s
	iters: 200, epoch: 2 | loss: 0.5612588
	speed: 0.1261s/iter; left time: 1162.7131s
	iters: 300, epoch: 2 | loss: 0.8115271
	speed: 0.1214s/iter; left time: 1107.7424s
	iters: 400, epoch: 2 | loss: 1.0094918
	speed: 0.1273s/iter; left time: 1148.4561s
	iters: 500, epoch: 2 | loss: 0.6575580
	speed: 0.1234s/iter; left time: 1100.9780s
	iters: 600, epoch: 2 | loss: 0.9433482
	speed: 0.1239s/iter; left time: 1092.9705s
	iters: 700, epoch: 2 | loss: 0.5218387
	speed: 0.1236s/iter; left time: 1078.4149s
	iters: 800, epoch: 2 | loss: 0.4079725
	speed: 0.1263s/iter; left time: 1089.4196s
	iters: 900, epoch: 2 | loss: 0.4566956
	speed: 0.1322s/iter; left time: 1126.5027s
	iters: 1000, epoch: 2 | loss: 0.3316068
	speed: 0.1210s/iter; left time: 1019.0463s
Epoch: 2 cost time: 132.16100430488586
Epoch: 2, Steps: 1047 | Train Loss: 0.6440387 Vali Loss: 0.4544317 Test Loss: 0.7398205
Validation loss decreased (1.157188 --> 0.454432).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.5400928
	speed: 1.9017s/iter; left time: 15740.0589s
	iters: 200, epoch: 3 | loss: 0.5804985
	speed: 0.1176s/iter; left time: 961.4925s
	iters: 300, epoch: 3 | loss: 0.5703451
	speed: 0.1124s/iter; left time: 907.7645s
	iters: 400, epoch: 3 | loss: 0.4848021
	speed: 0.1019s/iter; left time: 813.0756s
	iters: 500, epoch: 3 | loss: 0.6555641
	speed: 0.0881s/iter; left time: 693.8271s
	iters: 600, epoch: 3 | loss: 0.2455704
	speed: 0.0868s/iter; left time: 674.9433s
	iters: 700, epoch: 3 | loss: 0.4630555
	speed: 0.1008s/iter; left time: 773.6616s
	iters: 800, epoch: 3 | loss: 0.4312021
	speed: 0.1189s/iter; left time: 901.1607s
	iters: 900, epoch: 3 | loss: 0.5382477
	speed: 0.1214s/iter; left time: 907.9554s
	iters: 1000, epoch: 3 | loss: 0.6827905
	speed: 0.1184s/iter; left time: 873.6302s
Epoch: 3 cost time: 114.48824119567871
Epoch: 3, Steps: 1047 | Train Loss: 0.5457139 Vali Loss: 0.3526080 Test Loss: 0.5444301
Validation loss decreased (0.454432 --> 0.352608).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.6545177
	speed: 2.0096s/iter; left time: 14529.6509s
	iters: 200, epoch: 4 | loss: 0.3697657
	speed: 0.1196s/iter; left time: 852.7683s
	iters: 300, epoch: 4 | loss: 0.7042817
	speed: 0.1146s/iter; left time: 805.4032s
	iters: 400, epoch: 4 | loss: 0.6321928
	speed: 0.1166s/iter; left time: 807.8784s
	iters: 500, epoch: 4 | loss: 0.3835803
	speed: 0.1192s/iter; left time: 814.0102s
	iters: 600, epoch: 4 | loss: 0.5064515
	speed: 0.1173s/iter; left time: 789.4539s
	iters: 700, epoch: 4 | loss: 0.3566209
	speed: 0.1170s/iter; left time: 775.8588s
	iters: 800, epoch: 4 | loss: 0.4206151
	speed: 0.1195s/iter; left time: 780.2113s
	iters: 900, epoch: 4 | loss: 0.4336525
	speed: 0.1187s/iter; left time: 763.0205s
	iters: 1000, epoch: 4 | loss: 0.6629382
	speed: 0.1179s/iter; left time: 746.0257s
Epoch: 4 cost time: 123.0462257862091
Epoch: 4, Steps: 1047 | Train Loss: 0.5158586 Vali Loss: 0.3070740 Test Loss: 0.4399731
Validation loss decreased (0.352608 --> 0.307074).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.4300164
	speed: 1.4846s/iter; left time: 9179.2012s
	iters: 200, epoch: 5 | loss: 0.6331922
	speed: 0.0512s/iter; left time: 311.3991s
	iters: 300, epoch: 5 | loss: 0.4286341
	speed: 0.0505s/iter; left time: 302.2530s
	iters: 400, epoch: 5 | loss: 0.5909863
	speed: 0.0565s/iter; left time: 332.2114s
	iters: 500, epoch: 5 | loss: 0.6562847
	speed: 0.0607s/iter; left time: 351.2878s
	iters: 600, epoch: 5 | loss: 0.7785122
	speed: 0.0558s/iter; left time: 317.0271s
	iters: 700, epoch: 5 | loss: 0.7802320
	speed: 0.0499s/iter; left time: 278.4317s
	iters: 800, epoch: 5 | loss: 0.3857389
	speed: 0.0455s/iter; left time: 249.4041s
	iters: 900, epoch: 5 | loss: 0.5064232
	speed: 0.0489s/iter; left time: 263.0379s
	iters: 1000, epoch: 5 | loss: 0.6327288
	speed: 0.0529s/iter; left time: 279.3687s
Epoch: 5 cost time: 56.04268789291382
Epoch: 5, Steps: 1047 | Train Loss: 0.4991090 Vali Loss: 0.3007372 Test Loss: 0.4267462
Validation loss decreased (0.307074 --> 0.300737).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.3528009
	speed: 0.7526s/iter; left time: 3865.2137s
	iters: 200, epoch: 6 | loss: 0.4741190
	speed: 0.0591s/iter; left time: 297.4877s
	iters: 300, epoch: 6 | loss: 0.2992909
	speed: 0.0584s/iter; left time: 288.0879s
	iters: 400, epoch: 6 | loss: 0.3138750
	speed: 0.0613s/iter; left time: 296.2310s
	iters: 500, epoch: 6 | loss: 0.5654674
	speed: 0.0565s/iter; left time: 267.6354s
	iters: 600, epoch: 6 | loss: 0.3154432
	speed: 0.0528s/iter; left time: 244.7497s
	iters: 700, epoch: 6 | loss: 0.4130251
	speed: 0.0538s/iter; left time: 244.2152s
	iters: 800, epoch: 6 | loss: 0.3600065
	speed: 0.0566s/iter; left time: 250.9313s
	iters: 900, epoch: 6 | loss: 0.7042344
	speed: 0.0515s/iter; left time: 223.1857s
	iters: 1000, epoch: 6 | loss: 0.3984413
	speed: 0.0535s/iter; left time: 226.5102s
Epoch: 6 cost time: 60.19963836669922
Epoch: 6, Steps: 1047 | Train Loss: 0.4905629 Vali Loss: 0.3198417 Test Loss: 0.4741872
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.2909670
	speed: 0.8736s/iter; left time: 3572.2193s
	iters: 200, epoch: 7 | loss: 0.5129549
	speed: 0.0567s/iter; left time: 226.0473s
	iters: 300, epoch: 7 | loss: 0.4708884
	speed: 0.0580s/iter; left time: 225.6642s
	iters: 400, epoch: 7 | loss: 0.4714058
	speed: 0.0566s/iter; left time: 214.3678s
	iters: 500, epoch: 7 | loss: 0.2337008
	speed: 0.0561s/iter; left time: 206.8989s
	iters: 600, epoch: 7 | loss: 0.2820891
	speed: 0.0606s/iter; left time: 217.3661s
	iters: 700, epoch: 7 | loss: 0.2709449
	speed: 0.0540s/iter; left time: 188.4790s
	iters: 800, epoch: 7 | loss: 0.3283978
	speed: 0.0639s/iter; left time: 216.4703s
	iters: 900, epoch: 7 | loss: 0.5390427
	speed: 0.0649s/iter; left time: 213.4717s
	iters: 1000, epoch: 7 | loss: 0.3763219
	speed: 0.0607s/iter; left time: 193.6920s
Epoch: 7 cost time: 62.50840163230896
Epoch: 7, Steps: 1047 | Train Loss: 0.4849693 Vali Loss: 0.3143498 Test Loss: 0.4633138
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.4524224
	speed: 1.1218s/iter; left time: 3412.6242s
	iters: 200, epoch: 8 | loss: 0.2818613
	speed: 0.0804s/iter; left time: 236.4166s
	iters: 300, epoch: 8 | loss: 0.3217645
	speed: 0.0905s/iter; left time: 257.1786s
	iters: 400, epoch: 8 | loss: 0.5283822
	speed: 0.0844s/iter; left time: 231.4185s
	iters: 500, epoch: 8 | loss: 0.2792872
	speed: 0.0836s/iter; left time: 220.8202s
	iters: 600, epoch: 8 | loss: 0.5858073
	speed: 0.0848s/iter; left time: 215.6040s
	iters: 700, epoch: 8 | loss: 0.5735035
	speed: 0.0811s/iter; left time: 198.1380s
	iters: 800, epoch: 8 | loss: 0.2424708
	speed: 0.0801s/iter; left time: 187.6683s
	iters: 900, epoch: 8 | loss: 0.4709946
	speed: 0.0831s/iter; left time: 186.3587s
	iters: 1000, epoch: 8 | loss: 0.7378025
	speed: 0.0838s/iter; left time: 179.4788s
Epoch: 8 cost time: 89.26501035690308
Epoch: 8, Steps: 1047 | Train Loss: 0.4827529 Vali Loss: 0.3357261 Test Loss: 0.5102704
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.42652758955955505, mae:0.4393146336078644
