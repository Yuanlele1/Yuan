Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.05, loss='mse', lradj='type1', model='DLinear', model_id='traffic_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.3272274
	speed: 0.1026s/iter; left time: 749.2506s
	iters: 200, epoch: 1 | loss: 0.3630903
	speed: 0.0870s/iter; left time: 626.4838s
	iters: 300, epoch: 1 | loss: 0.4165102
	speed: 0.0802s/iter; left time: 569.6514s
	iters: 400, epoch: 1 | loss: 0.5617591
	speed: 0.0798s/iter; left time: 558.7681s
	iters: 500, epoch: 1 | loss: 0.5959999
	speed: 0.0796s/iter; left time: 549.1118s
	iters: 600, epoch: 1 | loss: 0.6465903
	speed: 0.0812s/iter; left time: 552.2877s
	iters: 700, epoch: 1 | loss: 0.7683989
	speed: 0.0820s/iter; left time: 549.7779s
Epoch: 1 cost time: 62.79556369781494
Epoch: 1, Steps: 740 | Train Loss: 0.9730979 Vali Loss: 2.6348889 Test Loss: 2.9894311
Validation loss decreased (inf --> 2.634889).  Saving model ...
Updating learning rate to 0.05
	iters: 100, epoch: 2 | loss: 1.0383047
	speed: 1.1167s/iter; left time: 7326.5261s
	iters: 200, epoch: 2 | loss: 0.7933322
	speed: 0.0751s/iter; left time: 485.2408s
	iters: 300, epoch: 2 | loss: 0.9466665
	speed: 0.0759s/iter; left time: 482.6004s
	iters: 400, epoch: 2 | loss: 0.6754577
	speed: 0.0884s/iter; left time: 553.2344s
	iters: 500, epoch: 2 | loss: 0.8364142
	speed: 0.0907s/iter; left time: 558.9045s
	iters: 600, epoch: 2 | loss: 1.2478321
	speed: 0.0886s/iter; left time: 536.7337s
	iters: 700, epoch: 2 | loss: 0.6892990
	speed: 0.0910s/iter; left time: 542.6341s
Epoch: 2 cost time: 64.52653217315674
Epoch: 2, Steps: 740 | Train Loss: 0.9347608 Vali Loss: 1.1432647 Test Loss: 1.3395177
Validation loss decreased (2.634889 --> 1.143265).  Saving model ...
Updating learning rate to 0.025
	iters: 100, epoch: 3 | loss: 0.3097183
	speed: 1.3294s/iter; left time: 7738.6384s
	iters: 200, epoch: 3 | loss: 0.3109230
	speed: 0.1208s/iter; left time: 691.0655s
	iters: 300, epoch: 3 | loss: 0.2976095
	speed: 0.1117s/iter; left time: 628.0692s
	iters: 400, epoch: 3 | loss: 0.3107792
	speed: 0.1095s/iter; left time: 604.5131s
	iters: 500, epoch: 3 | loss: 0.3525774
	speed: 0.1029s/iter; left time: 557.6793s
	iters: 600, epoch: 3 | loss: 0.3630267
	speed: 0.1005s/iter; left time: 534.8840s
	iters: 700, epoch: 3 | loss: 0.3289356
	speed: 0.0762s/iter; left time: 397.9898s
Epoch: 3 cost time: 77.88680672645569
Epoch: 3, Steps: 740 | Train Loss: 0.3287336 Vali Loss: 0.4450171 Test Loss: 0.5335352
Validation loss decreased (1.143265 --> 0.445017).  Saving model ...
Updating learning rate to 0.0125
	iters: 100, epoch: 4 | loss: 0.2733724
	speed: 1.1069s/iter; left time: 5623.9667s
	iters: 200, epoch: 4 | loss: 0.2985984
	speed: 0.0995s/iter; left time: 495.7083s
	iters: 300, epoch: 4 | loss: 0.2731705
	speed: 0.1021s/iter; left time: 498.5185s
	iters: 400, epoch: 4 | loss: 0.3575487
	speed: 0.0966s/iter; left time: 461.9670s
	iters: 500, epoch: 4 | loss: 0.2962250
	speed: 0.1013s/iter; left time: 474.3106s
	iters: 600, epoch: 4 | loss: 0.2680183
	speed: 0.0955s/iter; left time: 437.4017s
	iters: 700, epoch: 4 | loss: 0.2651969
	speed: 0.0884s/iter; left time: 396.0089s
Epoch: 4 cost time: 73.71023678779602
Epoch: 4, Steps: 740 | Train Loss: 0.2829194 Vali Loss: 0.4050328 Test Loss: 0.4851031
Validation loss decreased (0.445017 --> 0.405033).  Saving model ...
Updating learning rate to 0.00625
	iters: 100, epoch: 5 | loss: 0.2587754
	speed: 1.0482s/iter; left time: 4550.0475s
	iters: 200, epoch: 5 | loss: 0.2595550
	speed: 0.0916s/iter; left time: 388.4459s
	iters: 300, epoch: 5 | loss: 0.2776099
	speed: 0.0903s/iter; left time: 373.8219s
	iters: 400, epoch: 5 | loss: 0.2772156
	speed: 0.0928s/iter; left time: 375.0518s
	iters: 500, epoch: 5 | loss: 0.2936982
	speed: 0.0984s/iter; left time: 387.9273s
	iters: 600, epoch: 5 | loss: 0.2792913
	speed: 0.1521s/iter; left time: 584.1111s
	iters: 700, epoch: 5 | loss: 0.2758579
	speed: 0.1521s/iter; left time: 569.0846s
Epoch: 5 cost time: 81.79627227783203
Epoch: 5, Steps: 740 | Train Loss: 0.2659473 Vali Loss: 0.3642201 Test Loss: 0.4403367
Validation loss decreased (0.405033 --> 0.364220).  Saving model ...
Updating learning rate to 0.003125
	iters: 100, epoch: 6 | loss: 0.2649767
	speed: 1.4849s/iter; left time: 5347.1718s
	iters: 200, epoch: 6 | loss: 0.2632639
	speed: 0.1013s/iter; left time: 354.6866s
	iters: 300, epoch: 6 | loss: 0.2749763
	speed: 0.1005s/iter; left time: 341.6902s
	iters: 400, epoch: 6 | loss: 0.2590365
	speed: 0.1065s/iter; left time: 351.5884s
	iters: 500, epoch: 6 | loss: 0.2670715
	speed: 0.1208s/iter; left time: 386.7328s
	iters: 600, epoch: 6 | loss: 0.2525519
	speed: 0.1234s/iter; left time: 382.6719s
	iters: 700, epoch: 6 | loss: 0.3096811
	speed: 0.1437s/iter; left time: 431.2069s
Epoch: 6 cost time: 89.78390598297119
Epoch: 6, Steps: 740 | Train Loss: 0.2571668 Vali Loss: 0.3572796 Test Loss: 0.4319296
Validation loss decreased (0.364220 --> 0.357280).  Saving model ...
Updating learning rate to 0.0015625
	iters: 100, epoch: 7 | loss: 0.2441043
	speed: 1.8093s/iter; left time: 5176.5099s
	iters: 200, epoch: 7 | loss: 0.2688729
	speed: 0.1029s/iter; left time: 284.0969s
	iters: 300, epoch: 7 | loss: 0.2438341
	speed: 0.0994s/iter; left time: 264.4135s
	iters: 400, epoch: 7 | loss: 0.2664859
	speed: 0.1033s/iter; left time: 264.5721s
	iters: 500, epoch: 7 | loss: 0.2403391
	speed: 0.1135s/iter; left time: 279.4453s
	iters: 600, epoch: 7 | loss: 0.2521821
	speed: 0.1045s/iter; left time: 246.6867s
	iters: 700, epoch: 7 | loss: 0.2751149
	speed: 0.1022s/iter; left time: 231.1665s
Epoch: 7 cost time: 78.7380621433258
Epoch: 7, Steps: 740 | Train Loss: 0.2524067 Vali Loss: 0.3514586 Test Loss: 0.4241406
Validation loss decreased (0.357280 --> 0.351459).  Saving model ...
Updating learning rate to 0.00078125
	iters: 100, epoch: 8 | loss: 0.2725869
	speed: 1.2011s/iter; left time: 2547.5206s
	iters: 200, epoch: 8 | loss: 0.2625089
	speed: 0.1155s/iter; left time: 233.4023s
	iters: 300, epoch: 8 | loss: 0.2384150
	speed: 0.1034s/iter; left time: 198.6010s
	iters: 400, epoch: 8 | loss: 0.2651458
	speed: 0.1136s/iter; left time: 206.8134s
	iters: 500, epoch: 8 | loss: 0.2604706
	speed: 0.1043s/iter; left time: 179.4770s
	iters: 600, epoch: 8 | loss: 0.2360226
	speed: 0.1112s/iter; left time: 180.1743s
	iters: 700, epoch: 8 | loss: 0.2679015
	speed: 0.1203s/iter; left time: 183.0407s
Epoch: 8 cost time: 82.44522380828857
Epoch: 8, Steps: 740 | Train Loss: 0.2492499 Vali Loss: 0.3442400 Test Loss: 0.4157743
Validation loss decreased (0.351459 --> 0.344240).  Saving model ...
Updating learning rate to 0.000390625
	iters: 100, epoch: 9 | loss: 0.2656427
	speed: 1.2231s/iter; left time: 1689.0968s
	iters: 200, epoch: 9 | loss: 0.2268226
	speed: 0.0975s/iter; left time: 124.8860s
	iters: 300, epoch: 9 | loss: 0.2466546
	speed: 0.0961s/iter; left time: 113.5388s
	iters: 400, epoch: 9 | loss: 0.2689222
	speed: 0.1014s/iter; left time: 109.6008s
	iters: 500, epoch: 9 | loss: 0.2485995
	speed: 0.0972s/iter; left time: 95.3455s
	iters: 600, epoch: 9 | loss: 0.2417408
	speed: 0.0959s/iter; left time: 84.4965s
	iters: 700, epoch: 9 | loss: 0.2282080
	speed: 0.0961s/iter; left time: 75.0265s
Epoch: 9 cost time: 73.35003805160522
Epoch: 9, Steps: 740 | Train Loss: 0.2474214 Vali Loss: 0.3414178 Test Loss: 0.4127881
Validation loss decreased (0.344240 --> 0.341418).  Saving model ...
Updating learning rate to 0.0001953125
	iters: 100, epoch: 10 | loss: 0.2141791
	speed: 1.2143s/iter; left time: 778.3712s
	iters: 200, epoch: 10 | loss: 0.2235785
	speed: 0.1083s/iter; left time: 58.5739s
	iters: 300, epoch: 10 | loss: 0.2514605
	speed: 0.1099s/iter; left time: 48.4453s
	iters: 400, epoch: 10 | loss: 0.2461090
	speed: 0.1132s/iter; left time: 38.6096s
	iters: 500, epoch: 10 | loss: 0.2745634
	speed: 0.1042s/iter; left time: 25.1110s
	iters: 600, epoch: 10 | loss: 0.2411634
	speed: 0.1097s/iter; left time: 15.4638s
	iters: 700, epoch: 10 | loss: 0.2564572
	speed: 0.1136s/iter; left time: 4.6567s
Epoch: 10 cost time: 82.6759283542633
Epoch: 10, Steps: 740 | Train Loss: 0.2462828 Vali Loss: 0.3415498 Test Loss: 0.4127363
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-05
>>>>>>>testing : traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4130708873271942, mae:0.2870469093322754
