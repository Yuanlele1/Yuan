Args in experiment:
Namespace(activation='gelu', batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', model='DLinear', model_id='weather_336_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5590922
	speed: 0.0581s/iter; left time: 1308.7942s
	iters: 200, epoch: 1 | loss: 0.7041965
	speed: 0.0510s/iter; left time: 1143.1373s
	iters: 300, epoch: 1 | loss: 0.3753823
	speed: 0.0525s/iter; left time: 1171.3892s
	iters: 400, epoch: 1 | loss: 0.4711008
	speed: 0.0509s/iter; left time: 1132.2356s
	iters: 500, epoch: 1 | loss: 0.6586589
	speed: 0.0511s/iter; left time: 1129.8791s
	iters: 600, epoch: 1 | loss: 0.3742084
	speed: 0.0564s/iter; left time: 1242.4251s
	iters: 700, epoch: 1 | loss: 0.5025985
	speed: 0.0585s/iter; left time: 1283.1150s
	iters: 800, epoch: 1 | loss: 0.6222541
	speed: 0.0585s/iter; left time: 1276.5988s
	iters: 900, epoch: 1 | loss: 0.9449841
	speed: 0.0571s/iter; left time: 1239.8910s
	iters: 1000, epoch: 1 | loss: 0.3571054
	speed: 0.0579s/iter; left time: 1251.9944s
	iters: 1100, epoch: 1 | loss: 0.7190226
	speed: 0.0580s/iter; left time: 1249.7137s
	iters: 1200, epoch: 1 | loss: 0.5001782
	speed: 0.0580s/iter; left time: 1243.2462s
	iters: 1300, epoch: 1 | loss: 0.5193608
	speed: 0.0586s/iter; left time: 1249.3011s
	iters: 1400, epoch: 1 | loss: 0.4054087
	speed: 0.0578s/iter; left time: 1227.6100s
	iters: 1500, epoch: 1 | loss: 0.4949236
	speed: 0.0572s/iter; left time: 1209.2267s
	iters: 1600, epoch: 1 | loss: 0.6006993
	speed: 0.0587s/iter; left time: 1234.2507s
	iters: 1700, epoch: 1 | loss: 1.5354960
	speed: 0.0570s/iter; left time: 1193.3414s
	iters: 1800, epoch: 1 | loss: 0.6625461
	speed: 0.0571s/iter; left time: 1189.6463s
	iters: 1900, epoch: 1 | loss: 0.9065914
	speed: 0.0573s/iter; left time: 1188.2048s
	iters: 2000, epoch: 1 | loss: 0.5720407
	speed: 0.0578s/iter; left time: 1193.2434s
	iters: 2100, epoch: 1 | loss: 0.5545071
	speed: 0.0573s/iter; left time: 1176.6602s
	iters: 2200, epoch: 1 | loss: 0.9140155
	speed: 0.0540s/iter; left time: 1102.7323s
Epoch: 1 cost time: 127.48308372497559
Epoch: 1, Steps: 2263 | Train Loss: 0.5919799 Vali Loss: 0.5532584 Test Loss: 0.2656721
Validation loss decreased (inf --> 0.553258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.0041595
	speed: 1.7033s/iter; left time: 34521.5427s
	iters: 200, epoch: 2 | loss: 0.3662591
	speed: 0.0509s/iter; left time: 1026.5417s
	iters: 300, epoch: 2 | loss: 0.9080281
	speed: 0.0469s/iter; left time: 941.1098s
	iters: 400, epoch: 2 | loss: 0.4128895
	speed: 0.0499s/iter; left time: 996.7453s
	iters: 500, epoch: 2 | loss: 1.0316921
	speed: 0.0482s/iter; left time: 957.2627s
	iters: 600, epoch: 2 | loss: 0.4272259
	speed: 0.0493s/iter; left time: 973.6754s
	iters: 700, epoch: 2 | loss: 0.5010643
	speed: 0.0486s/iter; left time: 955.4304s
	iters: 800, epoch: 2 | loss: 0.4603052
	speed: 0.0485s/iter; left time: 948.5703s
	iters: 900, epoch: 2 | loss: 0.3466373
	speed: 0.0495s/iter; left time: 963.7359s
	iters: 1000, epoch: 2 | loss: 0.3573252
	speed: 0.0479s/iter; left time: 927.3120s
	iters: 1100, epoch: 2 | loss: 0.4367317
	speed: 0.0478s/iter; left time: 921.6381s
	iters: 1200, epoch: 2 | loss: 0.6681044
	speed: 0.0470s/iter; left time: 900.3473s
	iters: 1300, epoch: 2 | loss: 0.4057840
	speed: 0.0473s/iter; left time: 901.9694s
	iters: 1400, epoch: 2 | loss: 0.3842559
	speed: 0.0481s/iter; left time: 912.2984s
	iters: 1500, epoch: 2 | loss: 1.1496058
	speed: 0.0506s/iter; left time: 955.5818s
	iters: 1600, epoch: 2 | loss: 0.3980111
	speed: 0.0499s/iter; left time: 935.9270s
	iters: 1700, epoch: 2 | loss: 0.4061576
	speed: 0.0494s/iter; left time: 921.5380s
	iters: 1800, epoch: 2 | loss: 0.4477569
	speed: 0.0484s/iter; left time: 897.9990s
	iters: 1900, epoch: 2 | loss: 0.4080507
	speed: 0.0465s/iter; left time: 857.9123s
	iters: 2000, epoch: 2 | loss: 0.4873689
	speed: 0.0499s/iter; left time: 916.1107s
	iters: 2100, epoch: 2 | loss: 0.3471721
	speed: 0.0541s/iter; left time: 988.6302s
	iters: 2200, epoch: 2 | loss: 0.5112185
	speed: 0.0514s/iter; left time: 933.7312s
Epoch: 2 cost time: 112.2868103981018
Epoch: 2, Steps: 2263 | Train Loss: 0.5576640 Vali Loss: 0.5534904 Test Loss: 0.2619907
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5382193
	speed: 1.6283s/iter; left time: 29317.5795s
	iters: 200, epoch: 3 | loss: 0.6344519
	speed: 0.0370s/iter; left time: 661.7228s
	iters: 300, epoch: 3 | loss: 0.3729849
	speed: 0.0352s/iter; left time: 626.2996s
	iters: 400, epoch: 3 | loss: 0.3348005
	speed: 0.0332s/iter; left time: 588.6737s
	iters: 500, epoch: 3 | loss: 0.5492159
	speed: 0.0378s/iter; left time: 664.8582s
	iters: 600, epoch: 3 | loss: 0.4608704
	speed: 0.0361s/iter; left time: 632.4598s
	iters: 700, epoch: 3 | loss: 0.5375919
	speed: 0.0372s/iter; left time: 647.2989s
	iters: 800, epoch: 3 | loss: 0.4646343
	speed: 0.0449s/iter; left time: 776.5809s
	iters: 900, epoch: 3 | loss: 1.0256387
	speed: 0.0441s/iter; left time: 758.2340s
	iters: 1000, epoch: 3 | loss: 0.4671322
	speed: 0.0443s/iter; left time: 758.0179s
	iters: 1100, epoch: 3 | loss: 0.3465087
	speed: 0.0351s/iter; left time: 596.2542s
	iters: 1200, epoch: 3 | loss: 0.3996644
	speed: 0.0442s/iter; left time: 747.0345s
	iters: 1300, epoch: 3 | loss: 0.3565622
	speed: 0.0418s/iter; left time: 701.7312s
	iters: 1400, epoch: 3 | loss: 0.8961618
	speed: 0.0367s/iter; left time: 612.3233s
	iters: 1500, epoch: 3 | loss: 0.4838322
	speed: 0.0364s/iter; left time: 604.9630s
	iters: 1600, epoch: 3 | loss: 0.4140141
	speed: 0.0371s/iter; left time: 612.4896s
	iters: 1700, epoch: 3 | loss: 0.4229452
	speed: 0.0373s/iter; left time: 612.3401s
	iters: 1800, epoch: 3 | loss: 0.4651644
	speed: 0.0479s/iter; left time: 780.6685s
	iters: 1900, epoch: 3 | loss: 0.4072362
	speed: 0.0474s/iter; left time: 768.5341s
	iters: 2000, epoch: 3 | loss: 0.4888456
	speed: 0.0583s/iter; left time: 938.5447s
	iters: 2100, epoch: 3 | loss: 0.3502815
	speed: 0.0462s/iter; left time: 739.1340s
	iters: 2200, epoch: 3 | loss: 0.4254309
	speed: 0.0489s/iter; left time: 777.0187s
Epoch: 3 cost time: 94.13878989219666
Epoch: 3, Steps: 2263 | Train Loss: 0.5512246 Vali Loss: 0.5447842 Test Loss: 0.2625660
Validation loss decreased (0.553258 --> 0.544784).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3512967
	speed: 1.6073s/iter; left time: 25302.1669s
	iters: 200, epoch: 4 | loss: 1.4044441
	speed: 0.0528s/iter; left time: 826.0834s
	iters: 300, epoch: 4 | loss: 0.5547171
	speed: 0.0518s/iter; left time: 805.4365s
	iters: 400, epoch: 4 | loss: 0.5623999
	speed: 0.0525s/iter; left time: 810.5934s
	iters: 500, epoch: 4 | loss: 0.4158557
	speed: 0.0523s/iter; left time: 802.0236s
	iters: 600, epoch: 4 | loss: 1.1851460
	speed: 0.0517s/iter; left time: 788.5685s
	iters: 700, epoch: 4 | loss: 0.4140536
	speed: 0.0514s/iter; left time: 778.2181s
	iters: 800, epoch: 4 | loss: 0.5253300
	speed: 0.0485s/iter; left time: 729.1095s
	iters: 900, epoch: 4 | loss: 0.4499393
	speed: 0.0487s/iter; left time: 727.1262s
	iters: 1000, epoch: 4 | loss: 0.3319549
	speed: 0.0508s/iter; left time: 754.4097s
	iters: 1100, epoch: 4 | loss: 1.1137952
	speed: 0.0481s/iter; left time: 709.7281s
	iters: 1200, epoch: 4 | loss: 0.5272285
	speed: 0.0490s/iter; left time: 717.5023s
	iters: 1300, epoch: 4 | loss: 0.3661632
	speed: 0.0479s/iter; left time: 695.8504s
	iters: 1400, epoch: 4 | loss: 0.5221665
	speed: 0.0492s/iter; left time: 710.5550s
	iters: 1500, epoch: 4 | loss: 1.1421696
	speed: 0.0451s/iter; left time: 646.5472s
	iters: 1600, epoch: 4 | loss: 0.4145391
	speed: 0.0472s/iter; left time: 671.9304s
	iters: 1700, epoch: 4 | loss: 0.5427817
	speed: 0.0453s/iter; left time: 640.9953s
	iters: 1800, epoch: 4 | loss: 0.4216100
	speed: 0.0446s/iter; left time: 626.3663s
	iters: 1900, epoch: 4 | loss: 0.5410479
	speed: 0.0481s/iter; left time: 669.9719s
	iters: 2000, epoch: 4 | loss: 0.3576007
	speed: 0.0475s/iter; left time: 658.0044s
	iters: 2100, epoch: 4 | loss: 0.4308249
	speed: 0.0476s/iter; left time: 653.5018s
	iters: 2200, epoch: 4 | loss: 0.4087422
	speed: 0.0502s/iter; left time: 684.6710s
Epoch: 4 cost time: 111.97851300239563
Epoch: 4, Steps: 2263 | Train Loss: 0.5490861 Vali Loss: 0.5454027 Test Loss: 0.2630580
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5822595
	speed: 1.5589s/iter; left time: 21013.0356s
	iters: 200, epoch: 5 | loss: 0.4979978
	speed: 0.0484s/iter; left time: 647.7810s
	iters: 300, epoch: 5 | loss: 0.3391625
	speed: 0.0496s/iter; left time: 659.1381s
	iters: 400, epoch: 5 | loss: 0.4246167
	speed: 0.0482s/iter; left time: 634.7886s
	iters: 500, epoch: 5 | loss: 0.6170567
	speed: 0.0481s/iter; left time: 629.5841s
	iters: 600, epoch: 5 | loss: 0.5548715
	speed: 0.0480s/iter; left time: 623.1265s
	iters: 700, epoch: 5 | loss: 0.6468666
	speed: 0.0477s/iter; left time: 614.7811s
	iters: 800, epoch: 5 | loss: 0.3687846
	speed: 0.0458s/iter; left time: 584.9612s
	iters: 900, epoch: 5 | loss: 0.9995440
	speed: 0.0489s/iter; left time: 619.5225s
	iters: 1000, epoch: 5 | loss: 0.6523209
	speed: 0.0500s/iter; left time: 629.3371s
	iters: 1100, epoch: 5 | loss: 0.3968810
	speed: 0.0528s/iter; left time: 658.6365s
	iters: 1200, epoch: 5 | loss: 0.3848182
	speed: 0.0515s/iter; left time: 637.6126s
	iters: 1300, epoch: 5 | loss: 0.9600250
	speed: 0.0508s/iter; left time: 624.0064s
	iters: 1400, epoch: 5 | loss: 0.3084263
	speed: 0.0531s/iter; left time: 647.2169s
	iters: 1500, epoch: 5 | loss: 0.5599003
	speed: 0.0500s/iter; left time: 604.1678s
	iters: 1600, epoch: 5 | loss: 0.3600870
	speed: 0.0523s/iter; left time: 626.9580s
	iters: 1700, epoch: 5 | loss: 0.4795844
	speed: 0.0495s/iter; left time: 587.4521s
	iters: 1800, epoch: 5 | loss: 0.4460848
	speed: 0.0531s/iter; left time: 625.6913s
	iters: 1900, epoch: 5 | loss: 0.5327495
	speed: 0.0553s/iter; left time: 645.9641s
	iters: 2000, epoch: 5 | loss: 0.4986215
	speed: 0.0510s/iter; left time: 590.1337s
	iters: 2100, epoch: 5 | loss: 0.4508173
	speed: 0.0513s/iter; left time: 588.7090s
	iters: 2200, epoch: 5 | loss: 1.0416996
	speed: 0.0511s/iter; left time: 581.0262s
Epoch: 5 cost time: 114.77735447883606
Epoch: 5, Steps: 2263 | Train Loss: 0.5480694 Vali Loss: 0.5491487 Test Loss: 0.2607657
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5460462
	speed: 1.4954s/iter; left time: 16772.1467s
	iters: 200, epoch: 6 | loss: 0.5357195
	speed: 0.0464s/iter; left time: 515.9608s
	iters: 300, epoch: 6 | loss: 0.3575201
	speed: 0.0474s/iter; left time: 522.0463s
	iters: 400, epoch: 6 | loss: 1.0164065
	speed: 0.0463s/iter; left time: 505.3440s
	iters: 500, epoch: 6 | loss: 0.3908776
	speed: 0.0458s/iter; left time: 494.9335s
	iters: 600, epoch: 6 | loss: 0.6066831
	speed: 0.0460s/iter; left time: 493.0252s
	iters: 700, epoch: 6 | loss: 1.1512716
	speed: 0.0469s/iter; left time: 497.9936s
	iters: 800, epoch: 6 | loss: 0.4340931
	speed: 0.0464s/iter; left time: 487.9593s
	iters: 900, epoch: 6 | loss: 0.4127175
	speed: 0.0466s/iter; left time: 485.4097s
	iters: 1000, epoch: 6 | loss: 0.4220064
	speed: 0.0487s/iter; left time: 502.1931s
	iters: 1100, epoch: 6 | loss: 0.3679040
	speed: 0.0485s/iter; left time: 495.8889s
	iters: 1200, epoch: 6 | loss: 0.9972781
	speed: 0.0405s/iter; left time: 409.3984s
	iters: 1300, epoch: 6 | loss: 0.3897025
	speed: 0.0425s/iter; left time: 425.8713s
	iters: 1400, epoch: 6 | loss: 0.3308717
	speed: 0.0459s/iter; left time: 455.2246s
	iters: 1500, epoch: 6 | loss: 0.4282124
	speed: 0.0456s/iter; left time: 447.1306s
	iters: 1600, epoch: 6 | loss: 0.3393941
	speed: 0.0449s/iter; left time: 436.4280s
	iters: 1700, epoch: 6 | loss: 0.3580536
	speed: 0.0434s/iter; left time: 417.3433s
	iters: 1800, epoch: 6 | loss: 0.4870093
	speed: 0.0394s/iter; left time: 375.0408s
	iters: 1900, epoch: 6 | loss: 0.4182183
	speed: 0.0360s/iter; left time: 338.9614s
	iters: 2000, epoch: 6 | loss: 0.5539196
	speed: 0.0321s/iter; left time: 298.7800s
	iters: 2100, epoch: 6 | loss: 0.4566008
	speed: 0.0296s/iter; left time: 273.2312s
	iters: 2200, epoch: 6 | loss: 0.5363465
	speed: 0.0331s/iter; left time: 301.7314s
Epoch: 6 cost time: 98.32554960250854
Epoch: 6, Steps: 2263 | Train Loss: 0.5476468 Vali Loss: 0.5490043 Test Loss: 0.2605140
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2626113295555115, mae:0.31386420130729675
