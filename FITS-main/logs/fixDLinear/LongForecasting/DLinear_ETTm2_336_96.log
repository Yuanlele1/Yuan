Args in experiment:
Namespace(activation='gelu', batch_size=32, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, individual=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='mse', lradj='type1', model='DLinear', model_id='ETTm2_336_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seq_len=336, target='OT', test_flop=False, train_epochs=10, train_only=False, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3396243
	speed: 0.0737s/iter; left time: 778.8217s
	iters: 200, epoch: 1 | loss: 0.3089102
	speed: 0.0622s/iter; left time: 651.0173s
	iters: 300, epoch: 1 | loss: 0.1633680
	speed: 0.0618s/iter; left time: 639.8006s
	iters: 400, epoch: 1 | loss: 0.2918388
	speed: 0.0610s/iter; left time: 626.0656s
	iters: 500, epoch: 1 | loss: 0.2634735
	speed: 0.0643s/iter; left time: 653.0071s
	iters: 600, epoch: 1 | loss: 0.1940049
	speed: 0.0610s/iter; left time: 613.3584s
	iters: 700, epoch: 1 | loss: 0.1632549
	speed: 0.0642s/iter; left time: 639.9207s
	iters: 800, epoch: 1 | loss: 0.1667676
	speed: 0.0669s/iter; left time: 659.8237s
	iters: 900, epoch: 1 | loss: 0.2624200
	speed: 0.0629s/iter; left time: 614.0738s
	iters: 1000, epoch: 1 | loss: 0.3983586
	speed: 0.0663s/iter; left time: 640.5680s
Epoch: 1 cost time: 68.72953081130981
Epoch: 1, Steps: 1066 | Train Loss: 0.2315545 Vali Loss: 0.1237790 Test Loss: 0.1763636
Validation loss decreased (inf --> 0.123779).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3403787
	speed: 0.5868s/iter; left time: 5571.2340s
	iters: 200, epoch: 2 | loss: 0.1911801
	speed: 0.0636s/iter; left time: 597.2652s
	iters: 300, epoch: 2 | loss: 0.1685404
	speed: 0.0641s/iter; left time: 595.5627s
	iters: 400, epoch: 2 | loss: 0.1206337
	speed: 0.0640s/iter; left time: 588.8040s
	iters: 500, epoch: 2 | loss: 0.1355541
	speed: 0.0631s/iter; left time: 574.2848s
	iters: 600, epoch: 2 | loss: 0.2254464
	speed: 0.0649s/iter; left time: 583.3381s
	iters: 700, epoch: 2 | loss: 0.1786899
	speed: 0.0622s/iter; left time: 553.3184s
	iters: 800, epoch: 2 | loss: 0.1197735
	speed: 0.0624s/iter; left time: 548.7505s
	iters: 900, epoch: 2 | loss: 0.1571473
	speed: 0.0600s/iter; left time: 521.9156s
	iters: 1000, epoch: 2 | loss: 0.2410829
	speed: 0.0652s/iter; left time: 560.3673s
Epoch: 2 cost time: 68.10750675201416
Epoch: 2, Steps: 1066 | Train Loss: 0.2202690 Vali Loss: 0.1217899 Test Loss: 0.1715907
Validation loss decreased (0.123779 --> 0.121790).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1846980
	speed: 0.5628s/iter; left time: 4743.5505s
	iters: 200, epoch: 3 | loss: 0.2481711
	speed: 0.0616s/iter; left time: 513.4491s
	iters: 300, epoch: 3 | loss: 0.1099517
	speed: 0.0634s/iter; left time: 521.9330s
	iters: 400, epoch: 3 | loss: 0.3017220
	speed: 0.0633s/iter; left time: 514.6164s
	iters: 500, epoch: 3 | loss: 0.1800878
	speed: 0.0658s/iter; left time: 528.0868s
	iters: 600, epoch: 3 | loss: 0.1948609
	speed: 0.0609s/iter; left time: 482.6454s
	iters: 700, epoch: 3 | loss: 0.3036386
	speed: 0.0533s/iter; left time: 417.3964s
	iters: 800, epoch: 3 | loss: 0.2834868
	speed: 0.0612s/iter; left time: 473.1579s
	iters: 900, epoch: 3 | loss: 0.1892238
	speed: 0.0694s/iter; left time: 529.3999s
	iters: 1000, epoch: 3 | loss: 0.1855594
	speed: 0.0685s/iter; left time: 515.5344s
Epoch: 3 cost time: 68.82946562767029
Epoch: 3, Steps: 1066 | Train Loss: 0.2136989 Vali Loss: 0.1247497 Test Loss: 0.1815720
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1880939
	speed: 0.6364s/iter; left time: 4685.8467s
	iters: 200, epoch: 4 | loss: 0.4587253
	speed: 0.0710s/iter; left time: 515.5787s
	iters: 300, epoch: 4 | loss: 0.1699132
	speed: 0.0690s/iter; left time: 494.1768s
	iters: 400, epoch: 4 | loss: 0.2132009
	speed: 0.0724s/iter; left time: 511.3628s
	iters: 500, epoch: 4 | loss: 0.1797009
	speed: 0.0677s/iter; left time: 471.0707s
	iters: 600, epoch: 4 | loss: 0.1011455
	speed: 0.0630s/iter; left time: 432.1392s
	iters: 700, epoch: 4 | loss: 0.1735751
	speed: 0.0639s/iter; left time: 432.4809s
	iters: 800, epoch: 4 | loss: 0.1829588
	speed: 0.0645s/iter; left time: 429.7927s
	iters: 900, epoch: 4 | loss: 0.2033837
	speed: 0.0621s/iter; left time: 407.4677s
	iters: 1000, epoch: 4 | loss: 0.2717080
	speed: 0.0596s/iter; left time: 385.3980s
Epoch: 4 cost time: 71.28357720375061
Epoch: 4, Steps: 1066 | Train Loss: 0.2106387 Vali Loss: 0.1244247 Test Loss: 0.1803617
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3361154
	speed: 0.5206s/iter; left time: 3278.0978s
	iters: 200, epoch: 5 | loss: 0.1137104
	speed: 0.0573s/iter; left time: 355.1593s
	iters: 300, epoch: 5 | loss: 0.2827878
	speed: 0.0622s/iter; left time: 379.0974s
	iters: 400, epoch: 5 | loss: 0.1762527
	speed: 0.0633s/iter; left time: 379.3952s
	iters: 500, epoch: 5 | loss: 0.1053861
	speed: 0.0622s/iter; left time: 366.5084s
	iters: 600, epoch: 5 | loss: 0.2470596
	speed: 0.0648s/iter; left time: 375.8350s
	iters: 700, epoch: 5 | loss: 0.1338276
	speed: 0.0596s/iter; left time: 339.3877s
	iters: 800, epoch: 5 | loss: 0.1754482
	speed: 0.0610s/iter; left time: 341.3038s
	iters: 900, epoch: 5 | loss: 0.2478618
	speed: 0.0616s/iter; left time: 338.5461s
	iters: 1000, epoch: 5 | loss: 0.0900686
	speed: 0.0627s/iter; left time: 338.3122s
Epoch: 5 cost time: 65.55718445777893
Epoch: 5, Steps: 1066 | Train Loss: 0.2091454 Vali Loss: 0.1290592 Test Loss: 0.1897465
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_96_DLinear_ETTm2_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1718524694442749, mae:0.2671220600605011
