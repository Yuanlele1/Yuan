Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Traffic_180_j192_H8', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=10, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Traffic_180_j192_H8_FITS_custom_ftM_sl180_ll48_pl192_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11909
val 1565
test 3317
Model(
  (freq_upsampler): Linear(in_features=74, out_features=152, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1241059328.0
params:  11400.0
Trainable parameters:  11400
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 45.37696981430054
Epoch: 1, Steps: 93 | Train Loss: 1.0741747 Vali Loss: 1.0600065 Test Loss: 1.2705176
Validation loss decreased (inf --> 1.060006).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 40.57582902908325
Epoch: 2, Steps: 93 | Train Loss: 0.6615282 Vali Loss: 0.7963495 Test Loss: 0.9673418
Validation loss decreased (1.060006 --> 0.796350).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 44.323893785476685
Epoch: 3, Steps: 93 | Train Loss: 0.4941029 Vali Loss: 0.6766929 Test Loss: 0.8294588
Validation loss decreased (0.796350 --> 0.676693).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 43.7794930934906
Epoch: 4, Steps: 93 | Train Loss: 0.4073720 Vali Loss: 0.6109910 Test Loss: 0.7539800
Validation loss decreased (0.676693 --> 0.610991).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 43.44334387779236
Epoch: 5, Steps: 93 | Train Loss: 0.3556117 Vali Loss: 0.5717984 Test Loss: 0.7081277
Validation loss decreased (0.610991 --> 0.571798).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 43.180499792099
Epoch: 6, Steps: 93 | Train Loss: 0.3210890 Vali Loss: 0.5428085 Test Loss: 0.6740131
Validation loss decreased (0.571798 --> 0.542809).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 49.08479166030884
Epoch: 7, Steps: 93 | Train Loss: 0.2960011 Vali Loss: 0.5208163 Test Loss: 0.6479380
Validation loss decreased (0.542809 --> 0.520816).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 46.02229046821594
Epoch: 8, Steps: 93 | Train Loss: 0.2766473 Vali Loss: 0.5036613 Test Loss: 0.6261238
Validation loss decreased (0.520816 --> 0.503661).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 44.36340522766113
Epoch: 9, Steps: 93 | Train Loss: 0.2611300 Vali Loss: 0.4888587 Test Loss: 0.6083865
Validation loss decreased (0.503661 --> 0.488859).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 45.732197999954224
Epoch: 10, Steps: 93 | Train Loss: 0.2483610 Vali Loss: 0.4762203 Test Loss: 0.5928620
Validation loss decreased (0.488859 --> 0.476220).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 40.02865147590637
Epoch: 11, Steps: 93 | Train Loss: 0.2376481 Vali Loss: 0.4659117 Test Loss: 0.5795767
Validation loss decreased (0.476220 --> 0.465912).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 42.41872453689575
Epoch: 12, Steps: 93 | Train Loss: 0.2285818 Vali Loss: 0.4565113 Test Loss: 0.5683591
Validation loss decreased (0.465912 --> 0.456511).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 40.7815945148468
Epoch: 13, Steps: 93 | Train Loss: 0.2207944 Vali Loss: 0.4488997 Test Loss: 0.5585674
Validation loss decreased (0.456511 --> 0.448900).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 46.26269268989563
Epoch: 14, Steps: 93 | Train Loss: 0.2140841 Vali Loss: 0.4418550 Test Loss: 0.5497521
Validation loss decreased (0.448900 --> 0.441855).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 42.57354998588562
Epoch: 15, Steps: 93 | Train Loss: 0.2082569 Vali Loss: 0.4353700 Test Loss: 0.5423779
Validation loss decreased (0.441855 --> 0.435370).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 45.03948998451233
Epoch: 16, Steps: 93 | Train Loss: 0.2031325 Vali Loss: 0.4299863 Test Loss: 0.5355224
Validation loss decreased (0.435370 --> 0.429986).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 43.40349721908569
Epoch: 17, Steps: 93 | Train Loss: 0.1986608 Vali Loss: 0.4249032 Test Loss: 0.5294511
Validation loss decreased (0.429986 --> 0.424903).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 43.50692367553711
Epoch: 18, Steps: 93 | Train Loss: 0.1947111 Vali Loss: 0.4211964 Test Loss: 0.5243593
Validation loss decreased (0.424903 --> 0.421196).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 46.18539500236511
Epoch: 19, Steps: 93 | Train Loss: 0.1911858 Vali Loss: 0.4177313 Test Loss: 0.5195911
Validation loss decreased (0.421196 --> 0.417731).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 44.92638826370239
Epoch: 20, Steps: 93 | Train Loss: 0.1880616 Vali Loss: 0.4141912 Test Loss: 0.5152826
Validation loss decreased (0.417731 --> 0.414191).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 45.863951683044434
Epoch: 21, Steps: 93 | Train Loss: 0.1852579 Vali Loss: 0.4113384 Test Loss: 0.5117180
Validation loss decreased (0.414191 --> 0.411338).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 42.3540244102478
Epoch: 22, Steps: 93 | Train Loss: 0.1827556 Vali Loss: 0.4084478 Test Loss: 0.5082961
Validation loss decreased (0.411338 --> 0.408448).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 43.6617534160614
Epoch: 23, Steps: 93 | Train Loss: 0.1804970 Vali Loss: 0.4063871 Test Loss: 0.5053199
Validation loss decreased (0.408448 --> 0.406387).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 43.63614463806152
Epoch: 24, Steps: 93 | Train Loss: 0.1784512 Vali Loss: 0.4046976 Test Loss: 0.5025967
Validation loss decreased (0.406387 --> 0.404698).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 41.549083948135376
Epoch: 25, Steps: 93 | Train Loss: 0.1766044 Vali Loss: 0.4021653 Test Loss: 0.5000795
Validation loss decreased (0.404698 --> 0.402165).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 48.65454339981079
Epoch: 26, Steps: 93 | Train Loss: 0.1749379 Vali Loss: 0.4004733 Test Loss: 0.4977153
Validation loss decreased (0.402165 --> 0.400473).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 50.23128294944763
Epoch: 27, Steps: 93 | Train Loss: 0.1734149 Vali Loss: 0.3985568 Test Loss: 0.4958082
Validation loss decreased (0.400473 --> 0.398557).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 53.16217517852783
Epoch: 28, Steps: 93 | Train Loss: 0.1720226 Vali Loss: 0.3973229 Test Loss: 0.4938048
Validation loss decreased (0.398557 --> 0.397323).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 60.07134556770325
Epoch: 29, Steps: 93 | Train Loss: 0.1707607 Vali Loss: 0.3960864 Test Loss: 0.4921743
Validation loss decreased (0.397323 --> 0.396086).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 49.9678955078125
Epoch: 30, Steps: 93 | Train Loss: 0.1696073 Vali Loss: 0.3947316 Test Loss: 0.4906087
Validation loss decreased (0.396086 --> 0.394732).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 43.79254913330078
Epoch: 31, Steps: 93 | Train Loss: 0.1685459 Vali Loss: 0.3937496 Test Loss: 0.4892241
Validation loss decreased (0.394732 --> 0.393750).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 41.03431296348572
Epoch: 32, Steps: 93 | Train Loss: 0.1675535 Vali Loss: 0.3925731 Test Loss: 0.4878904
Validation loss decreased (0.393750 --> 0.392573).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 40.461206912994385
Epoch: 33, Steps: 93 | Train Loss: 0.1666644 Vali Loss: 0.3920712 Test Loss: 0.4866803
Validation loss decreased (0.392573 --> 0.392071).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 47.875492811203
Epoch: 34, Steps: 93 | Train Loss: 0.1658360 Vali Loss: 0.3906990 Test Loss: 0.4855388
Validation loss decreased (0.392071 --> 0.390699).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 41.038111209869385
Epoch: 35, Steps: 93 | Train Loss: 0.1650649 Vali Loss: 0.3899372 Test Loss: 0.4845464
Validation loss decreased (0.390699 --> 0.389937).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 44.50830149650574
Epoch: 36, Steps: 93 | Train Loss: 0.1643539 Vali Loss: 0.3891585 Test Loss: 0.4836092
Validation loss decreased (0.389937 --> 0.389159).  Saving model ...
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 60.597445011138916
Epoch: 37, Steps: 93 | Train Loss: 0.1637256 Vali Loss: 0.3885919 Test Loss: 0.4827141
Validation loss decreased (0.389159 --> 0.388592).  Saving model ...
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 48.623711824417114
Epoch: 38, Steps: 93 | Train Loss: 0.1631022 Vali Loss: 0.3877519 Test Loss: 0.4819487
Validation loss decreased (0.388592 --> 0.387752).  Saving model ...
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 44.9549195766449
Epoch: 39, Steps: 93 | Train Loss: 0.1625452 Vali Loss: 0.3874847 Test Loss: 0.4811988
Validation loss decreased (0.387752 --> 0.387485).  Saving model ...
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 39.93576216697693
Epoch: 40, Steps: 93 | Train Loss: 0.1620298 Vali Loss: 0.3869719 Test Loss: 0.4804814
Validation loss decreased (0.387485 --> 0.386972).  Saving model ...
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 43.97159671783447
Epoch: 41, Steps: 93 | Train Loss: 0.1615288 Vali Loss: 0.3862143 Test Loss: 0.4798187
Validation loss decreased (0.386972 --> 0.386214).  Saving model ...
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 43.838072299957275
Epoch: 42, Steps: 93 | Train Loss: 0.1611030 Vali Loss: 0.3858930 Test Loss: 0.4792586
Validation loss decreased (0.386214 --> 0.385893).  Saving model ...
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 39.60380959510803
Epoch: 43, Steps: 93 | Train Loss: 0.1606652 Vali Loss: 0.3856409 Test Loss: 0.4786862
Validation loss decreased (0.385893 --> 0.385641).  Saving model ...
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 40.43714356422424
Epoch: 44, Steps: 93 | Train Loss: 0.1602657 Vali Loss: 0.3854332 Test Loss: 0.4781964
Validation loss decreased (0.385641 --> 0.385433).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 46.529507875442505
Epoch: 45, Steps: 93 | Train Loss: 0.1599066 Vali Loss: 0.3847795 Test Loss: 0.4777078
Validation loss decreased (0.385433 --> 0.384779).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 43.42816972732544
Epoch: 46, Steps: 93 | Train Loss: 0.1595690 Vali Loss: 0.3837783 Test Loss: 0.4772490
Validation loss decreased (0.384779 --> 0.383778).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 44.84062314033508
Epoch: 47, Steps: 93 | Train Loss: 0.1592352 Vali Loss: 0.3838737 Test Loss: 0.4768750
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 41.208276987075806
Epoch: 48, Steps: 93 | Train Loss: 0.1589357 Vali Loss: 0.3834647 Test Loss: 0.4764575
Validation loss decreased (0.383778 --> 0.383465).  Saving model ...
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 44.85862374305725
Epoch: 49, Steps: 93 | Train Loss: 0.1586582 Vali Loss: 0.3844008 Test Loss: 0.4760823
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 42.140342473983765
Epoch: 50, Steps: 93 | Train Loss: 0.1583813 Vali Loss: 0.3830661 Test Loss: 0.4757589
Validation loss decreased (0.383465 --> 0.383066).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 41.59452438354492
Epoch: 51, Steps: 93 | Train Loss: 0.1581402 Vali Loss: 0.3827657 Test Loss: 0.4754461
Validation loss decreased (0.383066 --> 0.382766).  Saving model ...
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 42.24398732185364
Epoch: 52, Steps: 93 | Train Loss: 0.1579042 Vali Loss: 0.3825957 Test Loss: 0.4751555
Validation loss decreased (0.382766 --> 0.382596).  Saving model ...
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 39.76457142829895
Epoch: 53, Steps: 93 | Train Loss: 0.1576840 Vali Loss: 0.3825183 Test Loss: 0.4748661
Validation loss decreased (0.382596 --> 0.382518).  Saving model ...
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 40.012677907943726
Epoch: 54, Steps: 93 | Train Loss: 0.1574761 Vali Loss: 0.3827259 Test Loss: 0.4745955
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 49.649696588516235
Epoch: 55, Steps: 93 | Train Loss: 0.1572978 Vali Loss: 0.3820568 Test Loss: 0.4743829
Validation loss decreased (0.382518 --> 0.382057).  Saving model ...
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 47.11891984939575
Epoch: 56, Steps: 93 | Train Loss: 0.1571077 Vali Loss: 0.3819736 Test Loss: 0.4741412
Validation loss decreased (0.382057 --> 0.381974).  Saving model ...
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 49.86059069633484
Epoch: 57, Steps: 93 | Train Loss: 0.1569317 Vali Loss: 0.3815399 Test Loss: 0.4739003
Validation loss decreased (0.381974 --> 0.381540).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 44.53148531913757
Epoch: 58, Steps: 93 | Train Loss: 0.1567693 Vali Loss: 0.3818963 Test Loss: 0.4737165
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 42.781800746917725
Epoch: 59, Steps: 93 | Train Loss: 0.1566049 Vali Loss: 0.3811907 Test Loss: 0.4735040
Validation loss decreased (0.381540 --> 0.381191).  Saving model ...
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 44.26565217971802
Epoch: 60, Steps: 93 | Train Loss: 0.1564704 Vali Loss: 0.3813098 Test Loss: 0.4733464
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 41.86147212982178
Epoch: 61, Steps: 93 | Train Loss: 0.1563275 Vali Loss: 0.3813313 Test Loss: 0.4731788
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 41.33551478385925
Epoch: 62, Steps: 93 | Train Loss: 0.1562080 Vali Loss: 0.3814175 Test Loss: 0.4730107
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 41.051939249038696
Epoch: 63, Steps: 93 | Train Loss: 0.1560773 Vali Loss: 0.3805324 Test Loss: 0.4728520
Validation loss decreased (0.381191 --> 0.380532).  Saving model ...
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 37.618061780929565
Epoch: 64, Steps: 93 | Train Loss: 0.1559715 Vali Loss: 0.3807570 Test Loss: 0.4727296
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 35.240503787994385
Epoch: 65, Steps: 93 | Train Loss: 0.1558623 Vali Loss: 0.3809384 Test Loss: 0.4725836
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 34.020203828811646
Epoch: 66, Steps: 93 | Train Loss: 0.1557673 Vali Loss: 0.3806559 Test Loss: 0.4724510
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 37.362088441848755
Epoch: 67, Steps: 93 | Train Loss: 0.1556520 Vali Loss: 0.3810978 Test Loss: 0.4723336
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 33.758755683898926
Epoch: 68, Steps: 93 | Train Loss: 0.1555641 Vali Loss: 0.3804078 Test Loss: 0.4722411
Validation loss decreased (0.380532 --> 0.380408).  Saving model ...
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 34.9976601600647
Epoch: 69, Steps: 93 | Train Loss: 0.1554700 Vali Loss: 0.3801203 Test Loss: 0.4721173
Validation loss decreased (0.380408 --> 0.380120).  Saving model ...
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 35.08729290962219
Epoch: 70, Steps: 93 | Train Loss: 0.1553899 Vali Loss: 0.3802339 Test Loss: 0.4720160
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 35.027663230895996
Epoch: 71, Steps: 93 | Train Loss: 0.1553186 Vali Loss: 0.3803034 Test Loss: 0.4719168
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 33.562233686447144
Epoch: 72, Steps: 93 | Train Loss: 0.1552383 Vali Loss: 0.3799261 Test Loss: 0.4718295
Validation loss decreased (0.380120 --> 0.379926).  Saving model ...
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 34.684237003326416
Epoch: 73, Steps: 93 | Train Loss: 0.1551644 Vali Loss: 0.3799169 Test Loss: 0.4717619
Validation loss decreased (0.379926 --> 0.379917).  Saving model ...
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 33.335102558135986
Epoch: 74, Steps: 93 | Train Loss: 0.1551110 Vali Loss: 0.3799222 Test Loss: 0.4716688
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 35.3040075302124
