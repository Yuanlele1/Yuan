Args in experiment:
Namespace(H_order=5, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=50, d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_180_96_FITS_ETTh2_ftM_sl180_ll48_pl96_H5_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=50, out_features=76, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3404800.0
params:  3876.0
Trainable parameters:  3876
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.050959587097168
Epoch: 1, Steps: 65 | Train Loss: 0.4453604 Vali Loss: 0.2980398 Test Loss: 0.4059497
Validation loss decreased (inf --> 0.298040).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.9383654594421387
Epoch: 2, Steps: 65 | Train Loss: 0.3580532 Vali Loss: 0.2709873 Test Loss: 0.3677365
Validation loss decreased (0.298040 --> 0.270987).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 3.347592353820801
Epoch: 3, Steps: 65 | Train Loss: 0.3083830 Vali Loss: 0.2537308 Test Loss: 0.3462962
Validation loss decreased (0.270987 --> 0.253731).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 2.2369909286499023
Epoch: 4, Steps: 65 | Train Loss: 0.2746333 Vali Loss: 0.2460225 Test Loss: 0.3333542
Validation loss decreased (0.253731 --> 0.246023).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 3.4651269912719727
Epoch: 5, Steps: 65 | Train Loss: 0.2528315 Vali Loss: 0.2405589 Test Loss: 0.3250854
Validation loss decreased (0.246023 --> 0.240559).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 3.842698574066162
Epoch: 6, Steps: 65 | Train Loss: 0.2369494 Vali Loss: 0.2354772 Test Loss: 0.3193974
Validation loss decreased (0.240559 --> 0.235477).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 2.7645068168640137
Epoch: 7, Steps: 65 | Train Loss: 0.2249113 Vali Loss: 0.2318420 Test Loss: 0.3153341
Validation loss decreased (0.235477 --> 0.231842).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.6948997974395752
Epoch: 8, Steps: 65 | Train Loss: 0.2159880 Vali Loss: 0.2302574 Test Loss: 0.3122535
Validation loss decreased (0.231842 --> 0.230257).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.8764922618865967
Epoch: 9, Steps: 65 | Train Loss: 0.2079899 Vali Loss: 0.2277044 Test Loss: 0.3099151
Validation loss decreased (0.230257 --> 0.227704).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 2.4813153743743896
Epoch: 10, Steps: 65 | Train Loss: 0.2022574 Vali Loss: 0.2272840 Test Loss: 0.3078893
Validation loss decreased (0.227704 --> 0.227284).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 2.9075677394866943
Epoch: 11, Steps: 65 | Train Loss: 0.1973271 Vali Loss: 0.2262989 Test Loss: 0.3063237
Validation loss decreased (0.227284 --> 0.226299).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 3.29655385017395
Epoch: 12, Steps: 65 | Train Loss: 0.1923923 Vali Loss: 0.2244265 Test Loss: 0.3049503
Validation loss decreased (0.226299 --> 0.224426).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 4.598093271255493
Epoch: 13, Steps: 65 | Train Loss: 0.1894151 Vali Loss: 0.2233229 Test Loss: 0.3037215
Validation loss decreased (0.224426 --> 0.223323).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 3.2366299629211426
Epoch: 14, Steps: 65 | Train Loss: 0.1860931 Vali Loss: 0.2226659 Test Loss: 0.3027057
Validation loss decreased (0.223323 --> 0.222666).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 2.8328938484191895
Epoch: 15, Steps: 65 | Train Loss: 0.1830612 Vali Loss: 0.2226467 Test Loss: 0.3017470
Validation loss decreased (0.222666 --> 0.222647).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 3.4073238372802734
Epoch: 16, Steps: 65 | Train Loss: 0.1806488 Vali Loss: 0.2212894 Test Loss: 0.3009267
Validation loss decreased (0.222647 --> 0.221289).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 4.015427112579346
Epoch: 17, Steps: 65 | Train Loss: 0.1789282 Vali Loss: 0.2214666 Test Loss: 0.3001235
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 2.0281178951263428
Epoch: 18, Steps: 65 | Train Loss: 0.1769102 Vali Loss: 0.2203093 Test Loss: 0.2994981
Validation loss decreased (0.221289 --> 0.220309).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 3.58701229095459
Epoch: 19, Steps: 65 | Train Loss: 0.1753694 Vali Loss: 0.2186328 Test Loss: 0.2988795
Validation loss decreased (0.220309 --> 0.218633).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 3.23189115524292
Epoch: 20, Steps: 65 | Train Loss: 0.1733524 Vali Loss: 0.2177985 Test Loss: 0.2983258
Validation loss decreased (0.218633 --> 0.217799).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 2.7464277744293213
Epoch: 21, Steps: 65 | Train Loss: 0.1724268 Vali Loss: 0.2186940 Test Loss: 0.2977892
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 3.029857635498047
Epoch: 22, Steps: 65 | Train Loss: 0.1707517 Vali Loss: 0.2187247 Test Loss: 0.2973114
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 2.8375558853149414
Epoch: 23, Steps: 65 | Train Loss: 0.1703094 Vali Loss: 0.2184530 Test Loss: 0.2969073
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 2.3497796058654785
Epoch: 24, Steps: 65 | Train Loss: 0.1691181 Vali Loss: 0.2184014 Test Loss: 0.2965092
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 3.674015998840332
Epoch: 25, Steps: 65 | Train Loss: 0.1685595 Vali Loss: 0.2174648 Test Loss: 0.2961363
Validation loss decreased (0.217799 --> 0.217465).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 3.0161795616149902
Epoch: 26, Steps: 65 | Train Loss: 0.1677593 Vali Loss: 0.2163807 Test Loss: 0.2958595
Validation loss decreased (0.217465 --> 0.216381).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 3.9373934268951416
Epoch: 27, Steps: 65 | Train Loss: 0.1668634 Vali Loss: 0.2161165 Test Loss: 0.2955207
Validation loss decreased (0.216381 --> 0.216117).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 3.9100959300994873
Epoch: 28, Steps: 65 | Train Loss: 0.1662098 Vali Loss: 0.2166077 Test Loss: 0.2952487
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 6.679692268371582
Epoch: 29, Steps: 65 | Train Loss: 0.1660049 Vali Loss: 0.2163489 Test Loss: 0.2949855
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 2.6270928382873535
Epoch: 30, Steps: 65 | Train Loss: 0.1651699 Vali Loss: 0.2157538 Test Loss: 0.2947344
Validation loss decreased (0.216117 --> 0.215754).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 3.6557514667510986
Epoch: 31, Steps: 65 | Train Loss: 0.1644081 Vali Loss: 0.2163753 Test Loss: 0.2944998
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 2.282585382461548
Epoch: 32, Steps: 65 | Train Loss: 0.1639454 Vali Loss: 0.2149376 Test Loss: 0.2942919
Validation loss decreased (0.215754 --> 0.214938).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 2.7176342010498047
Epoch: 33, Steps: 65 | Train Loss: 0.1634331 Vali Loss: 0.2156340 Test Loss: 0.2941349
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 2.931234836578369
Epoch: 34, Steps: 65 | Train Loss: 0.1624396 Vali Loss: 0.2157062 Test Loss: 0.2939343
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 2.395089864730835
Epoch: 35, Steps: 65 | Train Loss: 0.1626337 Vali Loss: 0.2145613 Test Loss: 0.2937732
Validation loss decreased (0.214938 --> 0.214561).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 3.307068347930908
Epoch: 36, Steps: 65 | Train Loss: 0.1626365 Vali Loss: 0.2158226 Test Loss: 0.2936356
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 2.5394043922424316
Epoch: 37, Steps: 65 | Train Loss: 0.1624087 Vali Loss: 0.2149511 Test Loss: 0.2934655
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 3.756901264190674
Epoch: 38, Steps: 65 | Train Loss: 0.1620324 Vali Loss: 0.2149775 Test Loss: 0.2933494
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 3.492401599884033
Epoch: 39, Steps: 65 | Train Loss: 0.1617075 Vali Loss: 0.2149256 Test Loss: 0.2932262
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 3.101930856704712
Epoch: 40, Steps: 65 | Train Loss: 0.1612422 Vali Loss: 0.2135614 Test Loss: 0.2931131
Validation loss decreased (0.214561 --> 0.213561).  Saving model ...
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 4.069461345672607
Epoch: 41, Steps: 65 | Train Loss: 0.1611379 Vali Loss: 0.2146576 Test Loss: 0.2929987
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 3.842275857925415
Epoch: 42, Steps: 65 | Train Loss: 0.1603734 Vali Loss: 0.2156275 Test Loss: 0.2928849
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 3.2446043491363525
Epoch: 43, Steps: 65 | Train Loss: 0.1605381 Vali Loss: 0.2122799 Test Loss: 0.2928026
Validation loss decreased (0.213561 --> 0.212280).  Saving model ...
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 3.216312885284424
Epoch: 44, Steps: 65 | Train Loss: 0.1606078 Vali Loss: 0.2140747 Test Loss: 0.2927112
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.7117328643798828
Epoch: 45, Steps: 65 | Train Loss: 0.1604903 Vali Loss: 0.2144220 Test Loss: 0.2926358
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.9538445472717285
Epoch: 46, Steps: 65 | Train Loss: 0.1595657 Vali Loss: 0.2146326 Test Loss: 0.2925425
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 2.6161139011383057
Epoch: 47, Steps: 65 | Train Loss: 0.1595653 Vali Loss: 0.2143005 Test Loss: 0.2924799
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 2.2361435890197754
Epoch: 48, Steps: 65 | Train Loss: 0.1598082 Vali Loss: 0.2127447 Test Loss: 0.2923948
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 2.2781171798706055
Epoch: 49, Steps: 65 | Train Loss: 0.1594379 Vali Loss: 0.2141155 Test Loss: 0.2923388
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 2.7044758796691895
Epoch: 50, Steps: 65 | Train Loss: 0.1597109 Vali Loss: 0.2134024 Test Loss: 0.2922808
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 3.0663034915924072
Epoch: 51, Steps: 65 | Train Loss: 0.1594591 Vali Loss: 0.2134595 Test Loss: 0.2922285
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 3.547403573989868
Epoch: 52, Steps: 65 | Train Loss: 0.1594243 Vali Loss: 0.2138177 Test Loss: 0.2921806
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 3.111586332321167
Epoch: 53, Steps: 65 | Train Loss: 0.1584735 Vali Loss: 0.2122701 Test Loss: 0.2921192
Validation loss decreased (0.212280 --> 0.212270).  Saving model ...
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 2.4007086753845215
Epoch: 54, Steps: 65 | Train Loss: 0.1587844 Vali Loss: 0.2130745 Test Loss: 0.2920730
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 3.0652832984924316
Epoch: 55, Steps: 65 | Train Loss: 0.1584938 Vali Loss: 0.2140420 Test Loss: 0.2920267
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 2.0257439613342285
Epoch: 56, Steps: 65 | Train Loss: 0.1587107 Vali Loss: 0.2139006 Test Loss: 0.2919819
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 4.086374759674072
Epoch: 57, Steps: 65 | Train Loss: 0.1580974 Vali Loss: 0.2136546 Test Loss: 0.2919424
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 2.235417127609253
Epoch: 58, Steps: 65 | Train Loss: 0.1584648 Vali Loss: 0.2129011 Test Loss: 0.2919026
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 2.422792434692383
Epoch: 59, Steps: 65 | Train Loss: 0.1581572 Vali Loss: 0.2140254 Test Loss: 0.2918589
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 2.7124109268188477
Epoch: 60, Steps: 65 | Train Loss: 0.1586629 Vali Loss: 0.2126030 Test Loss: 0.2918305
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 2.340977430343628
Epoch: 61, Steps: 65 | Train Loss: 0.1582507 Vali Loss: 0.2128202 Test Loss: 0.2918071
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 2.644260883331299
Epoch: 62, Steps: 65 | Train Loss: 0.1585840 Vali Loss: 0.2134638 Test Loss: 0.2917722
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 3.902409076690674
Epoch: 63, Steps: 65 | Train Loss: 0.1585143 Vali Loss: 0.2133690 Test Loss: 0.2917489
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 3.3090295791625977
Epoch: 64, Steps: 65 | Train Loss: 0.1583354 Vali Loss: 0.2125150 Test Loss: 0.2917193
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 2.4695894718170166
Epoch: 65, Steps: 65 | Train Loss: 0.1578102 Vali Loss: 0.2122279 Test Loss: 0.2916875
Validation loss decreased (0.212270 --> 0.212228).  Saving model ...
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 3.211951494216919
Epoch: 66, Steps: 65 | Train Loss: 0.1574745 Vali Loss: 0.2129011 Test Loss: 0.2916656
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 2.9128031730651855
Epoch: 67, Steps: 65 | Train Loss: 0.1580391 Vali Loss: 0.2126756 Test Loss: 0.2916472
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 7.469283580780029
Epoch: 68, Steps: 65 | Train Loss: 0.1579506 Vali Loss: 0.2125202 Test Loss: 0.2916205
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 5.107507228851318
Epoch: 69, Steps: 65 | Train Loss: 0.1581293 Vali Loss: 0.2128752 Test Loss: 0.2916080
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 2.5567269325256348
Epoch: 70, Steps: 65 | Train Loss: 0.1579311 Vali Loss: 0.2127681 Test Loss: 0.2915849
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 2.0196475982666016
Epoch: 71, Steps: 65 | Train Loss: 0.1579770 Vali Loss: 0.2130151 Test Loss: 0.2915685
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 2.6414456367492676
Epoch: 72, Steps: 65 | Train Loss: 0.1573844 Vali Loss: 0.2123079 Test Loss: 0.2915490
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 3.129283905029297
Epoch: 73, Steps: 65 | Train Loss: 0.1578478 Vali Loss: 0.2129004 Test Loss: 0.2915341
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 2.812166690826416
Epoch: 74, Steps: 65 | Train Loss: 0.1576902 Vali Loss: 0.2130504 Test Loss: 0.2915234
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 2.1758430004119873
Epoch: 75, Steps: 65 | Train Loss: 0.1579320 Vali Loss: 0.2118895 Test Loss: 0.2915066
Validation loss decreased (0.212228 --> 0.211889).  Saving model ...
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 2.9427149295806885
Epoch: 76, Steps: 65 | Train Loss: 0.1578585 Vali Loss: 0.2126431 Test Loss: 0.2914933
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 3.383312463760376
Epoch: 77, Steps: 65 | Train Loss: 0.1577844 Vali Loss: 0.2113600 Test Loss: 0.2914768
Validation loss decreased (0.211889 --> 0.211360).  Saving model ...
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 3.2484986782073975
Epoch: 78, Steps: 65 | Train Loss: 0.1571501 Vali Loss: 0.2121713 Test Loss: 0.2914691
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 2.840881586074829
Epoch: 79, Steps: 65 | Train Loss: 0.1573401 Vali Loss: 0.2126960 Test Loss: 0.2914581
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 3.300116539001465
Epoch: 80, Steps: 65 | Train Loss: 0.1577807 Vali Loss: 0.2122010 Test Loss: 0.2914469
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 3.3022923469543457
Epoch: 81, Steps: 65 | Train Loss: 0.1578465 Vali Loss: 0.2125206 Test Loss: 0.2914381
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 3.061427593231201
Epoch: 82, Steps: 65 | Train Loss: 0.1578652 Vali Loss: 0.2118311 Test Loss: 0.2914283
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 4.207502126693726
Epoch: 83, Steps: 65 | Train Loss: 0.1576416 Vali Loss: 0.2126167 Test Loss: 0.2914161
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 1.9905667304992676
Epoch: 84, Steps: 65 | Train Loss: 0.1575907 Vali Loss: 0.2124433 Test Loss: 0.2914048
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 2.552772045135498
Epoch: 85, Steps: 65 | Train Loss: 0.1578099 Vali Loss: 0.2127763 Test Loss: 0.2914004
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 2.9600846767425537
Epoch: 86, Steps: 65 | Train Loss: 0.1575511 Vali Loss: 0.2117317 Test Loss: 0.2913907
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.389640937399644e-06
Epoch: 87 cost time: 2.018486738204956
Epoch: 87, Steps: 65 | Train Loss: 0.1574550 Vali Loss: 0.2119082 Test Loss: 0.2913861
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.070158890529662e-06
Epoch: 88 cost time: 2.696223020553589
Epoch: 88, Steps: 65 | Train Loss: 0.1575260 Vali Loss: 0.2126065 Test Loss: 0.2913769
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.766650946003179e-06
Epoch: 89 cost time: 3.089773654937744
Epoch: 89, Steps: 65 | Train Loss: 0.1576319 Vali Loss: 0.2129762 Test Loss: 0.2913718
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.47831839870302e-06
Epoch: 90 cost time: 2.9551501274108887
Epoch: 90, Steps: 65 | Train Loss: 0.1575231 Vali Loss: 0.2126105 Test Loss: 0.2913647
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.204402478767869e-06
Epoch: 91 cost time: 3.3872556686401367
Epoch: 91, Steps: 65 | Train Loss: 0.1566853 Vali Loss: 0.2118858 Test Loss: 0.2913559
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.944182354829475e-06
Epoch: 92 cost time: 2.8292489051818848
Epoch: 92, Steps: 65 | Train Loss: 0.1573854 Vali Loss: 0.2124139 Test Loss: 0.2913498
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.696973237088e-06
Epoch: 93 cost time: 3.4902915954589844
Epoch: 93, Steps: 65 | Train Loss: 0.1576663 Vali Loss: 0.2126458 Test Loss: 0.2913451
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.462124575233601e-06
Epoch: 94 cost time: 2.9651527404785156
Epoch: 94, Steps: 65 | Train Loss: 0.1574360 Vali Loss: 0.2129737 Test Loss: 0.2913389
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.239018346471921e-06
Epoch: 95 cost time: 2.5012357234954834
Epoch: 95, Steps: 65 | Train Loss: 0.1576632 Vali Loss: 0.2109688 Test Loss: 0.2913351
Validation loss decreased (0.211360 --> 0.210969).  Saving model ...
Updating learning rate to 4.027067429148324e-06
Epoch: 96 cost time: 3.659576416015625
Epoch: 96, Steps: 65 | Train Loss: 0.1576201 Vali Loss: 0.2122776 Test Loss: 0.2913306
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.825714057690908e-06
Epoch: 97 cost time: 2.3039329051971436
Epoch: 97, Steps: 65 | Train Loss: 0.1574798 Vali Loss: 0.2113398 Test Loss: 0.2913266
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.6344283548063623e-06
Epoch: 98 cost time: 2.7163546085357666
Epoch: 98, Steps: 65 | Train Loss: 0.1568951 Vali Loss: 0.2123455 Test Loss: 0.2913235
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.452706937066044e-06
Epoch: 99 cost time: 3.547962188720703
Epoch: 99, Steps: 65 | Train Loss: 0.1575576 Vali Loss: 0.2124530 Test Loss: 0.2913186
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.2800715902127414e-06
Epoch: 100 cost time: 2.021871566772461
Epoch: 100, Steps: 65 | Train Loss: 0.1573513 Vali Loss: 0.2123880 Test Loss: 0.2913156
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.1160680107021042e-06
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=50, out_features=76, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3404800.0
params:  3876.0
Trainable parameters:  3876
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.158719539642334
Epoch: 1, Steps: 65 | Train Loss: 0.4109172 Vali Loss: 0.2093597 Test Loss: 0.2891296
Validation loss decreased (inf --> 0.209360).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.2279891967773438
Epoch: 2, Steps: 65 | Train Loss: 0.4066626 Vali Loss: 0.2094453 Test Loss: 0.2882513
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
Epoch: 3 cost time: 2.403733968734741
Epoch: 3, Steps: 65 | Train Loss: 0.4068152 Vali Loss: 0.2078139 Test Loss: 0.2877611
Validation loss decreased (0.209360 --> 0.207814).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 2.252471446990967
Epoch: 4, Steps: 65 | Train Loss: 0.4062380 Vali Loss: 0.2071421 Test Loss: 0.2876082
Validation loss decreased (0.207814 --> 0.207142).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 3.137319803237915
Epoch: 5, Steps: 65 | Train Loss: 0.4050873 Vali Loss: 0.2075568 Test Loss: 0.2872815
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 2.03723406791687
Epoch: 6, Steps: 65 | Train Loss: 0.4048040 Vali Loss: 0.2065198 Test Loss: 0.2868885
Validation loss decreased (0.207142 --> 0.206520).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 3.385206699371338
Epoch: 7, Steps: 65 | Train Loss: 0.4045480 Vali Loss: 0.2057180 Test Loss: 0.2868794
Validation loss decreased (0.206520 --> 0.205718).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 7.545473337173462
Epoch: 8, Steps: 65 | Train Loss: 0.4045341 Vali Loss: 0.2062795 Test Loss: 0.2866909
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 2.7560904026031494
Epoch: 9, Steps: 65 | Train Loss: 0.4023759 Vali Loss: 0.2063218 Test Loss: 0.2865798
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 3.094679355621338
Epoch: 10, Steps: 65 | Train Loss: 0.4044216 Vali Loss: 0.2061765 Test Loss: 0.2865765
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 2.806274652481079
Epoch: 11, Steps: 65 | Train Loss: 0.4040159 Vali Loss: 0.2065127 Test Loss: 0.2864362
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 3.9260571002960205
Epoch: 12, Steps: 65 | Train Loss: 0.4036460 Vali Loss: 0.2075074 Test Loss: 0.2863680
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 3.825073003768921
Epoch: 13, Steps: 65 | Train Loss: 0.4030685 Vali Loss: 0.2059827 Test Loss: 0.2863036
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 3.7047572135925293
Epoch: 14, Steps: 65 | Train Loss: 0.4029755 Vali Loss: 0.2067101 Test Loss: 0.2862860
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 3.233175754547119
Epoch: 15, Steps: 65 | Train Loss: 0.4024621 Vali Loss: 0.2067167 Test Loss: 0.2861754
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 2.237293243408203
Epoch: 16, Steps: 65 | Train Loss: 0.4034469 Vali Loss: 0.2061667 Test Loss: 0.2861893
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.8969924449920654
Epoch: 17, Steps: 65 | Train Loss: 0.4016278 Vali Loss: 0.2065048 Test Loss: 0.2860581
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 2.9638237953186035
Epoch: 18, Steps: 65 | Train Loss: 0.4029030 Vali Loss: 0.2068716 Test Loss: 0.2860830
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 2.912447452545166
Epoch: 19, Steps: 65 | Train Loss: 0.4026985 Vali Loss: 0.2059993 Test Loss: 0.2859752
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 2.139321804046631
Epoch: 20, Steps: 65 | Train Loss: 0.4032873 Vali Loss: 0.2066218 Test Loss: 0.2860550
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 3.120368003845215
Epoch: 21, Steps: 65 | Train Loss: 0.4021918 Vali Loss: 0.2053813 Test Loss: 0.2860062
Validation loss decreased (0.205718 --> 0.205381).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 2.173992395401001
Epoch: 22, Steps: 65 | Train Loss: 0.4023834 Vali Loss: 0.2069159 Test Loss: 0.2859704
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 3.9002597332000732
Epoch: 23, Steps: 65 | Train Loss: 0.4019961 Vali Loss: 0.2065217 Test Loss: 0.2859260
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 3.0265328884124756
Epoch: 24, Steps: 65 | Train Loss: 0.4026823 Vali Loss: 0.2061720 Test Loss: 0.2858529
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 3.668745517730713
Epoch: 25, Steps: 65 | Train Loss: 0.4017058 Vali Loss: 0.2064935 Test Loss: 0.2858279
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 3.6829099655151367
Epoch: 26, Steps: 65 | Train Loss: 0.3994519 Vali Loss: 0.2060410 Test Loss: 0.2858166
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 3.0918123722076416
Epoch: 27, Steps: 65 | Train Loss: 0.4017533 Vali Loss: 0.2060974 Test Loss: 0.2858199
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 1.8082225322723389
Epoch: 28, Steps: 65 | Train Loss: 0.4022112 Vali Loss: 0.2060711 Test Loss: 0.2858173
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 2.75215744972229
Epoch: 29, Steps: 65 | Train Loss: 0.4018925 Vali Loss: 0.2064555 Test Loss: 0.2857635
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.9983887672424316
Epoch: 30, Steps: 65 | Train Loss: 0.4000140 Vali Loss: 0.2065488 Test Loss: 0.2857557
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 2.9811103343963623
Epoch: 31, Steps: 65 | Train Loss: 0.4010338 Vali Loss: 0.2058920 Test Loss: 0.2857797
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 3.230534076690674
Epoch: 32, Steps: 65 | Train Loss: 0.4022911 Vali Loss: 0.2064821 Test Loss: 0.2857396
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 2.6333889961242676
Epoch: 33, Steps: 65 | Train Loss: 0.3997469 Vali Loss: 0.2065082 Test Loss: 0.2857096
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 3.5822489261627197
Epoch: 34, Steps: 65 | Train Loss: 0.4022662 Vali Loss: 0.2050457 Test Loss: 0.2857549
Validation loss decreased (0.205381 --> 0.205046).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 2.7996020317077637
Epoch: 35, Steps: 65 | Train Loss: 0.4025718 Vali Loss: 0.2049100 Test Loss: 0.2857146
Validation loss decreased (0.205046 --> 0.204910).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 2.541567802429199
Epoch: 36, Steps: 65 | Train Loss: 0.3998395 Vali Loss: 0.2054545 Test Loss: 0.2857381
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 2.927669048309326
Epoch: 37, Steps: 65 | Train Loss: 0.4012338 Vali Loss: 0.2055515 Test Loss: 0.2856613
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 3.8426902294158936
Epoch: 38, Steps: 65 | Train Loss: 0.4013476 Vali Loss: 0.2055569 Test Loss: 0.2856941
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 2.4007856845855713
Epoch: 39, Steps: 65 | Train Loss: 0.4014793 Vali Loss: 0.2065368 Test Loss: 0.2856703
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 2.499988317489624
Epoch: 40, Steps: 65 | Train Loss: 0.4017889 Vali Loss: 0.2057921 Test Loss: 0.2856765
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 3.768362283706665
Epoch: 41, Steps: 65 | Train Loss: 0.4022960 Vali Loss: 0.2062386 Test Loss: 0.2856932
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 2.1710331439971924
Epoch: 42, Steps: 65 | Train Loss: 0.4018871 Vali Loss: 0.2058498 Test Loss: 0.2856678
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 2.0567262172698975
Epoch: 43, Steps: 65 | Train Loss: 0.4015082 Vali Loss: 0.2059105 Test Loss: 0.2856570
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 3.156095027923584
Epoch: 44, Steps: 65 | Train Loss: 0.4003391 Vali Loss: 0.2058035 Test Loss: 0.2856571
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 3.967965841293335
Epoch: 45, Steps: 65 | Train Loss: 0.4024228 Vali Loss: 0.2070015 Test Loss: 0.2856522
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 5.7183778285980225
Epoch: 46, Steps: 65 | Train Loss: 0.4011784 Vali Loss: 0.2051979 Test Loss: 0.2856648
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 3.567760467529297
Epoch: 47, Steps: 65 | Train Loss: 0.4011147 Vali Loss: 0.2062684 Test Loss: 0.2856589
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 3.8867905139923096
Epoch: 48, Steps: 65 | Train Loss: 0.4017027 Vali Loss: 0.2060501 Test Loss: 0.2856742
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 2.915426254272461
Epoch: 49, Steps: 65 | Train Loss: 0.3999846 Vali Loss: 0.2065039 Test Loss: 0.2856381
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 3.247074604034424
Epoch: 50, Steps: 65 | Train Loss: 0.4007519 Vali Loss: 0.2057728 Test Loss: 0.2856450
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 2.920197010040283
Epoch: 51, Steps: 65 | Train Loss: 0.4019290 Vali Loss: 0.2053717 Test Loss: 0.2856515
EarlyStopping counter: 16 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.8373897075653076
Epoch: 52, Steps: 65 | Train Loss: 0.4014347 Vali Loss: 0.2064285 Test Loss: 0.2856528
EarlyStopping counter: 17 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 2.2036385536193848
Epoch: 53, Steps: 65 | Train Loss: 0.4019359 Vali Loss: 0.2060310 Test Loss: 0.2856301
EarlyStopping counter: 18 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.733227014541626
Epoch: 54, Steps: 65 | Train Loss: 0.4013502 Vali Loss: 0.2063968 Test Loss: 0.2856420
EarlyStopping counter: 19 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 2.1077497005462646
Epoch: 55, Steps: 65 | Train Loss: 0.4014835 Vali Loss: 0.2056496 Test Loss: 0.2856366
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh2_180_96_FITS_ETTh2_ftM_sl180_ll48_pl96_H5_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.28552719950675964, mae:0.33918264508247375, rse:0.43063074350357056, corr:[0.27540988 0.27779505 0.27582556 0.27561024 0.27494007 0.27314082
 0.27209273 0.27146128 0.27044678 0.2690053  0.26791388 0.26651004
 0.26489064 0.26329067 0.26254797 0.26229474 0.26175934 0.26098356
 0.26035753 0.2593665  0.2578743  0.25678968 0.25599512 0.2539873
 0.25061342 0.24827789 0.24667068 0.24478371 0.24285674 0.2418574
 0.24047758 0.2380891  0.23607294 0.23505321 0.23368192 0.2318059
 0.23068179 0.22953476 0.22824697 0.22709285 0.22680211 0.22619131
 0.22521792 0.22439963 0.22367303 0.22241561 0.22113931 0.21972032
 0.2167465  0.21387345 0.21222636 0.21107702 0.20897567 0.20700556
 0.20543748 0.20332421 0.20109524 0.19973294 0.19916537 0.1976411
 0.19632    0.19586089 0.19648637 0.19603929 0.19539638 0.1950888
 0.1943236  0.1930837  0.19284652 0.19280465 0.19159892 0.19046459
 0.18890269 0.18718791 0.18561147 0.18497449 0.1840804  0.18308628
 0.18263036 0.18256994 0.18222742 0.18154798 0.18233165 0.18319948
 0.1828918  0.18238702 0.18369608 0.18392573 0.182943   0.18289961
 0.18316297 0.18150125 0.18168528 0.18322611 0.18127081 0.1810094 ]
