Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=58, d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_180_96_FITS_ETTh2_ftM_sl180_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=58, out_features=88, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4573184.0
params:  5192.0
Trainable parameters:  5192
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.435930013656616
Epoch: 1, Steps: 65 | Train Loss: 0.4598248 Vali Loss: 0.3043281 Test Loss: 0.4132748
Validation loss decreased (inf --> 0.304328).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.3804271221160889
Epoch: 2, Steps: 65 | Train Loss: 0.3668015 Vali Loss: 0.2747011 Test Loss: 0.3718465
Validation loss decreased (0.304328 --> 0.274701).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.6536152362823486
Epoch: 3, Steps: 65 | Train Loss: 0.3132751 Vali Loss: 0.2575678 Test Loss: 0.3491493
Validation loss decreased (0.274701 --> 0.257568).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.2984862327575684
Epoch: 4, Steps: 65 | Train Loss: 0.2795970 Vali Loss: 0.2467850 Test Loss: 0.3354711
Validation loss decreased (0.257568 --> 0.246785).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.6004371643066406
Epoch: 5, Steps: 65 | Train Loss: 0.2565130 Vali Loss: 0.2396976 Test Loss: 0.3265036
Validation loss decreased (0.246785 --> 0.239698).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.255946397781372
Epoch: 6, Steps: 65 | Train Loss: 0.2399047 Vali Loss: 0.2357784 Test Loss: 0.3206504
Validation loss decreased (0.239698 --> 0.235778).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.4021308422088623
Epoch: 7, Steps: 65 | Train Loss: 0.2267307 Vali Loss: 0.2336234 Test Loss: 0.3163407
Validation loss decreased (0.235778 --> 0.233623).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.384770393371582
Epoch: 8, Steps: 65 | Train Loss: 0.2168357 Vali Loss: 0.2295766 Test Loss: 0.3131937
Validation loss decreased (0.233623 --> 0.229577).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.2179458141326904
Epoch: 9, Steps: 65 | Train Loss: 0.2091536 Vali Loss: 0.2295630 Test Loss: 0.3107019
Validation loss decreased (0.229577 --> 0.229563).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.2476649284362793
Epoch: 10, Steps: 65 | Train Loss: 0.2033523 Vali Loss: 0.2255620 Test Loss: 0.3086025
Validation loss decreased (0.229563 --> 0.225562).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 2.0238986015319824
Epoch: 11, Steps: 65 | Train Loss: 0.1970720 Vali Loss: 0.2247837 Test Loss: 0.3068468
Validation loss decreased (0.225562 --> 0.224784).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.493468999862671
Epoch: 12, Steps: 65 | Train Loss: 0.1932346 Vali Loss: 0.2244970 Test Loss: 0.3054174
Validation loss decreased (0.224784 --> 0.224497).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.469590425491333
Epoch: 13, Steps: 65 | Train Loss: 0.1887521 Vali Loss: 0.2236003 Test Loss: 0.3041040
Validation loss decreased (0.224497 --> 0.223600).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.5255296230316162
Epoch: 14, Steps: 65 | Train Loss: 0.1857813 Vali Loss: 0.2221413 Test Loss: 0.3030327
Validation loss decreased (0.223600 --> 0.222141).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.6255238056182861
Epoch: 15, Steps: 65 | Train Loss: 0.1827533 Vali Loss: 0.2205651 Test Loss: 0.3020173
Validation loss decreased (0.222141 --> 0.220565).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.4142773151397705
Epoch: 16, Steps: 65 | Train Loss: 0.1796612 Vali Loss: 0.2204267 Test Loss: 0.3011116
Validation loss decreased (0.220565 --> 0.220427).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.3598120212554932
Epoch: 17, Steps: 65 | Train Loss: 0.1780178 Vali Loss: 0.2202520 Test Loss: 0.3003517
Validation loss decreased (0.220427 --> 0.220252).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.7969856262207031
Epoch: 18, Steps: 65 | Train Loss: 0.1761232 Vali Loss: 0.2194156 Test Loss: 0.2996281
Validation loss decreased (0.220252 --> 0.219416).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.8996391296386719
Epoch: 19, Steps: 65 | Train Loss: 0.1730852 Vali Loss: 0.2194121 Test Loss: 0.2989878
Validation loss decreased (0.219416 --> 0.219412).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.5565342903137207
Epoch: 20, Steps: 65 | Train Loss: 0.1726492 Vali Loss: 0.2187474 Test Loss: 0.2984256
Validation loss decreased (0.219412 --> 0.218747).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.5227506160736084
Epoch: 21, Steps: 65 | Train Loss: 0.1712787 Vali Loss: 0.2184678 Test Loss: 0.2978677
Validation loss decreased (0.218747 --> 0.218468).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.1239266395568848
Epoch: 22, Steps: 65 | Train Loss: 0.1696055 Vali Loss: 0.2179694 Test Loss: 0.2974198
Validation loss decreased (0.218468 --> 0.217969).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 1.6197516918182373
Epoch: 23, Steps: 65 | Train Loss: 0.1681310 Vali Loss: 0.2172668 Test Loss: 0.2969608
Validation loss decreased (0.217969 --> 0.217267).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.350639820098877
Epoch: 24, Steps: 65 | Train Loss: 0.1671768 Vali Loss: 0.2154368 Test Loss: 0.2965209
Validation loss decreased (0.217267 --> 0.215437).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 2.094836711883545
Epoch: 25, Steps: 65 | Train Loss: 0.1669508 Vali Loss: 0.2167085 Test Loss: 0.2961510
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 1.3520030975341797
Epoch: 26, Steps: 65 | Train Loss: 0.1661485 Vali Loss: 0.2167133 Test Loss: 0.2958264
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.3999767303466797
Epoch: 27, Steps: 65 | Train Loss: 0.1651976 Vali Loss: 0.2168930 Test Loss: 0.2954980
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 1.1252591609954834
Epoch: 28, Steps: 65 | Train Loss: 0.1643831 Vali Loss: 0.2163610 Test Loss: 0.2952204
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.4558048248291016
Epoch: 29, Steps: 65 | Train Loss: 0.1640490 Vali Loss: 0.2158432 Test Loss: 0.2949523
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.4488990306854248
Epoch: 30, Steps: 65 | Train Loss: 0.1633502 Vali Loss: 0.2154491 Test Loss: 0.2946906
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 0.9996647834777832
Epoch: 31, Steps: 65 | Train Loss: 0.1627677 Vali Loss: 0.2165297 Test Loss: 0.2944812
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.2474563121795654
Epoch: 32, Steps: 65 | Train Loss: 0.1621908 Vali Loss: 0.2157243 Test Loss: 0.2942745
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.003875732421875
Epoch: 33, Steps: 65 | Train Loss: 0.1619676 Vali Loss: 0.2152075 Test Loss: 0.2940608
Validation loss decreased (0.215437 --> 0.215208).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.2583973407745361
Epoch: 34, Steps: 65 | Train Loss: 0.1608633 Vali Loss: 0.2150992 Test Loss: 0.2938733
Validation loss decreased (0.215208 --> 0.215099).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.0956642627716064
Epoch: 35, Steps: 65 | Train Loss: 0.1607439 Vali Loss: 0.2141950 Test Loss: 0.2936783
Validation loss decreased (0.215099 --> 0.214195).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.2271389961242676
Epoch: 36, Steps: 65 | Train Loss: 0.1606953 Vali Loss: 0.2152998 Test Loss: 0.2935488
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.2740976810455322
Epoch: 37, Steps: 65 | Train Loss: 0.1603523 Vali Loss: 0.2147705 Test Loss: 0.2933629
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.675614595413208
Epoch: 38, Steps: 65 | Train Loss: 0.1596731 Vali Loss: 0.2142609 Test Loss: 0.2932439
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.4490699768066406
Epoch: 39, Steps: 65 | Train Loss: 0.1599104 Vali Loss: 0.2142934 Test Loss: 0.2931104
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.1478352546691895
Epoch: 40, Steps: 65 | Train Loss: 0.1592999 Vali Loss: 0.2131567 Test Loss: 0.2929889
Validation loss decreased (0.214195 --> 0.213157).  Saving model ...
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 1.4426801204681396
Epoch: 41, Steps: 65 | Train Loss: 0.1592798 Vali Loss: 0.2139415 Test Loss: 0.2928722
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.7491395473480225
Epoch: 42, Steps: 65 | Train Loss: 0.1584084 Vali Loss: 0.2136584 Test Loss: 0.2927616
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.6781151294708252
Epoch: 43, Steps: 65 | Train Loss: 0.1587291 Vali Loss: 0.2143732 Test Loss: 0.2926699
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.3759210109710693
Epoch: 44, Steps: 65 | Train Loss: 0.1585357 Vali Loss: 0.2142899 Test Loss: 0.2925644
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.2212393283843994
Epoch: 45, Steps: 65 | Train Loss: 0.1574843 Vali Loss: 0.2127096 Test Loss: 0.2924698
Validation loss decreased (0.213157 --> 0.212710).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 2.3885257244110107
Epoch: 46, Steps: 65 | Train Loss: 0.1583272 Vali Loss: 0.2143406 Test Loss: 0.2923872
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.206906795501709
Epoch: 47, Steps: 65 | Train Loss: 0.1578942 Vali Loss: 0.2133011 Test Loss: 0.2923006
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.2338826656341553
Epoch: 48, Steps: 65 | Train Loss: 0.1574068 Vali Loss: 0.2134662 Test Loss: 0.2922206
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.3149521350860596
Epoch: 49, Steps: 65 | Train Loss: 0.1578899 Vali Loss: 0.2130271 Test Loss: 0.2921645
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.1373193264007568
Epoch: 50, Steps: 65 | Train Loss: 0.1576246 Vali Loss: 0.2129439 Test Loss: 0.2920989
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.2601327896118164
Epoch: 51, Steps: 65 | Train Loss: 0.1567278 Vali Loss: 0.2126829 Test Loss: 0.2920416
Validation loss decreased (0.212710 --> 0.212683).  Saving model ...
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.0705516338348389
Epoch: 52, Steps: 65 | Train Loss: 0.1574488 Vali Loss: 0.2131340 Test Loss: 0.2919767
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.1290068626403809
Epoch: 53, Steps: 65 | Train Loss: 0.1570748 Vali Loss: 0.2130689 Test Loss: 0.2919359
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.0942206382751465
Epoch: 54, Steps: 65 | Train Loss: 0.1568333 Vali Loss: 0.2120180 Test Loss: 0.2918655
Validation loss decreased (0.212683 --> 0.212018).  Saving model ...
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 1.6983575820922852
Epoch: 55, Steps: 65 | Train Loss: 0.1564363 Vali Loss: 0.2130059 Test Loss: 0.2918283
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 1.315981149673462
Epoch: 56, Steps: 65 | Train Loss: 0.1567261 Vali Loss: 0.2123057 Test Loss: 0.2917802
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 1.180499792098999
Epoch: 57, Steps: 65 | Train Loss: 0.1569647 Vali Loss: 0.2122560 Test Loss: 0.2917469
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 1.0787315368652344
Epoch: 58, Steps: 65 | Train Loss: 0.1563497 Vali Loss: 0.2125291 Test Loss: 0.2917018
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.3860034942626953
Epoch: 59, Steps: 65 | Train Loss: 0.1566389 Vali Loss: 0.2129035 Test Loss: 0.2916654
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.794435739517212
Epoch: 60, Steps: 65 | Train Loss: 0.1564082 Vali Loss: 0.2123325 Test Loss: 0.2916333
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.9096322059631348
Epoch: 61, Steps: 65 | Train Loss: 0.1564351 Vali Loss: 0.2130725 Test Loss: 0.2915928
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.2642040252685547
Epoch: 62, Steps: 65 | Train Loss: 0.1561090 Vali Loss: 0.2124906 Test Loss: 0.2915672
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.069694995880127
Epoch: 63, Steps: 65 | Train Loss: 0.1564665 Vali Loss: 0.2132713 Test Loss: 0.2915456
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 1.090050220489502
Epoch: 64, Steps: 65 | Train Loss: 0.1565407 Vali Loss: 0.2121100 Test Loss: 0.2915041
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 1.2039127349853516
Epoch: 65, Steps: 65 | Train Loss: 0.1562607 Vali Loss: 0.2119359 Test Loss: 0.2914801
Validation loss decreased (0.212018 --> 0.211936).  Saving model ...
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.724736213684082
Epoch: 66, Steps: 65 | Train Loss: 0.1560025 Vali Loss: 0.2122475 Test Loss: 0.2914540
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 1.647017002105713
Epoch: 67, Steps: 65 | Train Loss: 0.1563399 Vali Loss: 0.2122533 Test Loss: 0.2914326
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.2422027587890625
Epoch: 68, Steps: 65 | Train Loss: 0.1561913 Vali Loss: 0.2124568 Test Loss: 0.2914060
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 1.3306939601898193
Epoch: 69, Steps: 65 | Train Loss: 0.1558700 Vali Loss: 0.2122286 Test Loss: 0.2913884
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 1.1624784469604492
Epoch: 70, Steps: 65 | Train Loss: 0.1548422 Vali Loss: 0.2115379 Test Loss: 0.2913663
Validation loss decreased (0.211936 --> 0.211538).  Saving model ...
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 1.2748112678527832
Epoch: 71, Steps: 65 | Train Loss: 0.1560601 Vali Loss: 0.2122544 Test Loss: 0.2913468
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 1.409027099609375
Epoch: 72, Steps: 65 | Train Loss: 0.1554654 Vali Loss: 0.2126149 Test Loss: 0.2913258
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 1.3415470123291016
Epoch: 73, Steps: 65 | Train Loss: 0.1551394 Vali Loss: 0.2121484 Test Loss: 0.2913076
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 1.9322805404663086
Epoch: 74, Steps: 65 | Train Loss: 0.1555891 Vali Loss: 0.2130416 Test Loss: 0.2912938
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 1.4787931442260742
Epoch: 75, Steps: 65 | Train Loss: 0.1557460 Vali Loss: 0.2118743 Test Loss: 0.2912754
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 1.1580612659454346
Epoch: 76, Steps: 65 | Train Loss: 0.1559336 Vali Loss: 0.2125640 Test Loss: 0.2912623
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 1.3476827144622803
Epoch: 77, Steps: 65 | Train Loss: 0.1555129 Vali Loss: 0.2122142 Test Loss: 0.2912481
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 1.1319332122802734
Epoch: 78, Steps: 65 | Train Loss: 0.1556426 Vali Loss: 0.2117175 Test Loss: 0.2912371
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 1.1726555824279785
Epoch: 79, Steps: 65 | Train Loss: 0.1556753 Vali Loss: 0.2124725 Test Loss: 0.2912209
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 1.3107924461364746
Epoch: 80, Steps: 65 | Train Loss: 0.1557195 Vali Loss: 0.2125040 Test Loss: 0.2912110
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 1.9704437255859375
Epoch: 81, Steps: 65 | Train Loss: 0.1555335 Vali Loss: 0.2119038 Test Loss: 0.2911968
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 1.572680950164795
Epoch: 82, Steps: 65 | Train Loss: 0.1559037 Vali Loss: 0.2124173 Test Loss: 0.2911861
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 1.790987491607666
Epoch: 83, Steps: 65 | Train Loss: 0.1556762 Vali Loss: 0.2116586 Test Loss: 0.2911800
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 1.0898916721343994
Epoch: 84, Steps: 65 | Train Loss: 0.1552205 Vali Loss: 0.2114787 Test Loss: 0.2911699
Validation loss decreased (0.211538 --> 0.211479).  Saving model ...
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 1.6267635822296143
Epoch: 85, Steps: 65 | Train Loss: 0.1547568 Vali Loss: 0.2116004 Test Loss: 0.2911574
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 1.4978501796722412
Epoch: 86, Steps: 65 | Train Loss: 0.1555429 Vali Loss: 0.2122712 Test Loss: 0.2911498
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.389640937399644e-06
Epoch: 87 cost time: 1.074352741241455
Epoch: 87, Steps: 65 | Train Loss: 0.1556887 Vali Loss: 0.2113890 Test Loss: 0.2911429
Validation loss decreased (0.211479 --> 0.211389).  Saving model ...
Updating learning rate to 6.070158890529662e-06
Epoch: 88 cost time: 1.5616660118103027
Epoch: 88, Steps: 65 | Train Loss: 0.1557419 Vali Loss: 0.2117436 Test Loss: 0.2911348
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.766650946003179e-06
Epoch: 89 cost time: 1.334907054901123
Epoch: 89, Steps: 65 | Train Loss: 0.1557229 Vali Loss: 0.2111659 Test Loss: 0.2911293
Validation loss decreased (0.211389 --> 0.211166).  Saving model ...
Updating learning rate to 5.47831839870302e-06
Epoch: 90 cost time: 2.19992995262146
Epoch: 90, Steps: 65 | Train Loss: 0.1553588 Vali Loss: 0.2122940 Test Loss: 0.2911202
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.204402478767869e-06
Epoch: 91 cost time: 1.4625575542449951
Epoch: 91, Steps: 65 | Train Loss: 0.1556725 Vali Loss: 0.2116668 Test Loss: 0.2911127
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.944182354829475e-06
Epoch: 92 cost time: 1.3912475109100342
Epoch: 92, Steps: 65 | Train Loss: 0.1554060 Vali Loss: 0.2126901 Test Loss: 0.2911061
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.696973237088e-06
Epoch: 93 cost time: 1.709657907485962
Epoch: 93, Steps: 65 | Train Loss: 0.1546820 Vali Loss: 0.2117829 Test Loss: 0.2911007
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.462124575233601e-06
Epoch: 94 cost time: 1.5982210636138916
Epoch: 94, Steps: 65 | Train Loss: 0.1553795 Vali Loss: 0.2115476 Test Loss: 0.2910941
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.239018346471921e-06
Epoch: 95 cost time: 1.3270812034606934
Epoch: 95, Steps: 65 | Train Loss: 0.1547274 Vali Loss: 0.2123699 Test Loss: 0.2910889
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.027067429148324e-06
Epoch: 96 cost time: 1.375420093536377
Epoch: 96, Steps: 65 | Train Loss: 0.1552867 Vali Loss: 0.2115677 Test Loss: 0.2910857
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.825714057690908e-06
Epoch: 97 cost time: 1.6868095397949219
Epoch: 97, Steps: 65 | Train Loss: 0.1543209 Vali Loss: 0.2119263 Test Loss: 0.2910801
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.6344283548063623e-06
Epoch: 98 cost time: 1.2827823162078857
Epoch: 98, Steps: 65 | Train Loss: 0.1556270 Vali Loss: 0.2127406 Test Loss: 0.2910755
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.452706937066044e-06
Epoch: 99 cost time: 1.40716552734375
Epoch: 99, Steps: 65 | Train Loss: 0.1555322 Vali Loss: 0.2117396 Test Loss: 0.2910705
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.2800715902127414e-06
Epoch: 100 cost time: 2.4036948680877686
Epoch: 100, Steps: 65 | Train Loss: 0.1555138 Vali Loss: 0.2122711 Test Loss: 0.2910677
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.1160680107021042e-06
train 8365
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=58, out_features=88, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4573184.0
params:  5192.0
Trainable parameters:  5192
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.1993823051452637
Epoch: 1, Steps: 65 | Train Loss: 0.4110538 Vali Loss: 0.2092243 Test Loss: 0.2889275
Validation loss decreased (inf --> 0.209224).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.9123070240020752
Epoch: 2, Steps: 65 | Train Loss: 0.4079202 Vali Loss: 0.2082877 Test Loss: 0.2882693
Validation loss decreased (0.209224 --> 0.208288).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.0595340728759766
Epoch: 3, Steps: 65 | Train Loss: 0.4047162 Vali Loss: 0.2076205 Test Loss: 0.2876655
Validation loss decreased (0.208288 --> 0.207620).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.9183173179626465
Epoch: 4, Steps: 65 | Train Loss: 0.4049463 Vali Loss: 0.2059996 Test Loss: 0.2874237
Validation loss decreased (0.207620 --> 0.206000).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.9496781826019287
Epoch: 5, Steps: 65 | Train Loss: 0.4034490 Vali Loss: 0.2066197 Test Loss: 0.2870579
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.1972630023956299
Epoch: 6, Steps: 65 | Train Loss: 0.4052794 Vali Loss: 0.2074696 Test Loss: 0.2869102
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.3747220039367676
Epoch: 7, Steps: 65 | Train Loss: 0.4045106 Vali Loss: 0.2063704 Test Loss: 0.2868524
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.6733393669128418
Epoch: 8, Steps: 65 | Train Loss: 0.4018429 Vali Loss: 0.2058624 Test Loss: 0.2865530
Validation loss decreased (0.206000 --> 0.205862).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.323293685913086
Epoch: 9, Steps: 65 | Train Loss: 0.4037415 Vali Loss: 0.2069339 Test Loss: 0.2864036
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.36179518699646
Epoch: 10, Steps: 65 | Train Loss: 0.4039816 Vali Loss: 0.2060347 Test Loss: 0.2865281
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.5914723873138428
Epoch: 11, Steps: 65 | Train Loss: 0.4026943 Vali Loss: 0.2071025 Test Loss: 0.2862798
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.162903070449829
Epoch: 12, Steps: 65 | Train Loss: 0.4021136 Vali Loss: 0.2066398 Test Loss: 0.2861431
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.7482459545135498
Epoch: 13, Steps: 65 | Train Loss: 0.4029653 Vali Loss: 0.2060537 Test Loss: 0.2862433
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.3104560375213623
Epoch: 14, Steps: 65 | Train Loss: 0.4021360 Vali Loss: 0.2058570 Test Loss: 0.2861673
Validation loss decreased (0.205862 --> 0.205857).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.2998359203338623
Epoch: 15, Steps: 65 | Train Loss: 0.4032450 Vali Loss: 0.2068375 Test Loss: 0.2861069
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.3486964702606201
Epoch: 16, Steps: 65 | Train Loss: 0.4018633 Vali Loss: 0.2064746 Test Loss: 0.2860079
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 1.531282901763916
Epoch: 17, Steps: 65 | Train Loss: 0.4011756 Vali Loss: 0.2061663 Test Loss: 0.2859975
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.4079501628875732
Epoch: 18, Steps: 65 | Train Loss: 0.4027551 Vali Loss: 0.2060645 Test Loss: 0.2860007
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.3570542335510254
Epoch: 19, Steps: 65 | Train Loss: 0.4025821 Vali Loss: 0.2058269 Test Loss: 0.2859316
Validation loss decreased (0.205857 --> 0.205827).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 1.336141586303711
Epoch: 20, Steps: 65 | Train Loss: 0.4018973 Vali Loss: 0.2059353 Test Loss: 0.2858668
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.4248545169830322
Epoch: 21, Steps: 65 | Train Loss: 0.4025039 Vali Loss: 0.2068042 Test Loss: 0.2858703
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.2839391231536865
Epoch: 22, Steps: 65 | Train Loss: 0.3999634 Vali Loss: 0.2063376 Test Loss: 0.2858617
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 1.3419971466064453
Epoch: 23, Steps: 65 | Train Loss: 0.4024027 Vali Loss: 0.2058469 Test Loss: 0.2857859
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.242213487625122
Epoch: 24, Steps: 65 | Train Loss: 0.4014167 Vali Loss: 0.2056746 Test Loss: 0.2858134
Validation loss decreased (0.205827 --> 0.205675).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.442739486694336
Epoch: 25, Steps: 65 | Train Loss: 0.4022368 Vali Loss: 0.2053270 Test Loss: 0.2857168
Validation loss decreased (0.205675 --> 0.205327).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 1.3973846435546875
Epoch: 26, Steps: 65 | Train Loss: 0.3989919 Vali Loss: 0.2059767 Test Loss: 0.2857653
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.4991588592529297
Epoch: 27, Steps: 65 | Train Loss: 0.4015386 Vali Loss: 0.2063571 Test Loss: 0.2857558
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 2.1361584663391113
Epoch: 28, Steps: 65 | Train Loss: 0.4021811 Vali Loss: 0.2055231 Test Loss: 0.2857173
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.3563971519470215
Epoch: 29, Steps: 65 | Train Loss: 0.4009540 Vali Loss: 0.2053495 Test Loss: 0.2856849
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.2029588222503662
Epoch: 30, Steps: 65 | Train Loss: 0.4004739 Vali Loss: 0.2051496 Test Loss: 0.2856697
Validation loss decreased (0.205327 --> 0.205150).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 1.2188687324523926
Epoch: 31, Steps: 65 | Train Loss: 0.4020535 Vali Loss: 0.2054192 Test Loss: 0.2856793
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.64609956741333
Epoch: 32, Steps: 65 | Train Loss: 0.4009195 Vali Loss: 0.2062282 Test Loss: 0.2856609
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.2107031345367432
Epoch: 33, Steps: 65 | Train Loss: 0.4019404 Vali Loss: 0.2057364 Test Loss: 0.2856686
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.249560832977295
Epoch: 34, Steps: 65 | Train Loss: 0.4012255 Vali Loss: 0.2064423 Test Loss: 0.2856110
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.6252710819244385
Epoch: 35, Steps: 65 | Train Loss: 0.4007234 Vali Loss: 0.2058435 Test Loss: 0.2855996
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.8179774284362793
Epoch: 36, Steps: 65 | Train Loss: 0.4019897 Vali Loss: 0.2066996 Test Loss: 0.2856273
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.5160048007965088
Epoch: 37, Steps: 65 | Train Loss: 0.4019773 Vali Loss: 0.2055937 Test Loss: 0.2856213
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.221787929534912
Epoch: 38, Steps: 65 | Train Loss: 0.4016989 Vali Loss: 0.2064994 Test Loss: 0.2856028
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.4319651126861572
Epoch: 39, Steps: 65 | Train Loss: 0.4019515 Vali Loss: 0.2047944 Test Loss: 0.2856160
Validation loss decreased (0.205150 --> 0.204794).  Saving model ...
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 2.0327322483062744
Epoch: 40, Steps: 65 | Train Loss: 0.4009935 Vali Loss: 0.2058649 Test Loss: 0.2856012
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 2.1400225162506104
Epoch: 41, Steps: 65 | Train Loss: 0.4005831 Vali Loss: 0.2058502 Test Loss: 0.2856031
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.247189998626709
Epoch: 42, Steps: 65 | Train Loss: 0.4000083 Vali Loss: 0.2052964 Test Loss: 0.2855808
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.2523179054260254
Epoch: 43, Steps: 65 | Train Loss: 0.4005034 Vali Loss: 0.2059205 Test Loss: 0.2855885
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.0950641632080078
Epoch: 44, Steps: 65 | Train Loss: 0.4020194 Vali Loss: 0.2056121 Test Loss: 0.2855816
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.6827483177185059
Epoch: 45, Steps: 65 | Train Loss: 0.4010619 Vali Loss: 0.2049397 Test Loss: 0.2855520
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.238673448562622
Epoch: 46, Steps: 65 | Train Loss: 0.4011635 Vali Loss: 0.2067765 Test Loss: 0.2855626
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.474869728088379
Epoch: 47, Steps: 65 | Train Loss: 0.4017424 Vali Loss: 0.2055710 Test Loss: 0.2855682
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.3375511169433594
Epoch: 48, Steps: 65 | Train Loss: 0.4018303 Vali Loss: 0.2053737 Test Loss: 0.2855586
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.3796379566192627
Epoch: 49, Steps: 65 | Train Loss: 0.3994217 Vali Loss: 0.2058214 Test Loss: 0.2855518
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.8684382438659668
Epoch: 50, Steps: 65 | Train Loss: 0.4016359 Vali Loss: 0.2061718 Test Loss: 0.2855525
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.3493247032165527
Epoch: 51, Steps: 65 | Train Loss: 0.4018914 Vali Loss: 0.2061906 Test Loss: 0.2855720
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.2067601680755615
Epoch: 52, Steps: 65 | Train Loss: 0.4008657 Vali Loss: 0.2042995 Test Loss: 0.2855619
Validation loss decreased (0.204794 --> 0.204299).  Saving model ...
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.1961958408355713
Epoch: 53, Steps: 65 | Train Loss: 0.4015356 Vali Loss: 0.2056265 Test Loss: 0.2855601
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.1761536598205566
Epoch: 54, Steps: 65 | Train Loss: 0.4011406 Vali Loss: 0.2058201 Test Loss: 0.2855415
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 2.1861989498138428
Epoch: 55, Steps: 65 | Train Loss: 0.4004561 Vali Loss: 0.2061849 Test Loss: 0.2855508
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 1.7538745403289795
Epoch: 56, Steps: 65 | Train Loss: 0.4005675 Vali Loss: 0.2055226 Test Loss: 0.2855459
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 1.1335687637329102
Epoch: 57, Steps: 65 | Train Loss: 0.4012891 Vali Loss: 0.2049171 Test Loss: 0.2855393
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 1.3088295459747314
Epoch: 58, Steps: 65 | Train Loss: 0.4003267 Vali Loss: 0.2057292 Test Loss: 0.2855308
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.1507534980773926
Epoch: 59, Steps: 65 | Train Loss: 0.4015120 Vali Loss: 0.2054798 Test Loss: 0.2855375
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.4751577377319336
Epoch: 60, Steps: 65 | Train Loss: 0.4002116 Vali Loss: 0.2061177 Test Loss: 0.2855372
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.6679317951202393
Epoch: 61, Steps: 65 | Train Loss: 0.4003670 Vali Loss: 0.2062339 Test Loss: 0.2855245
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.7255990505218506
Epoch: 62, Steps: 65 | Train Loss: 0.4009217 Vali Loss: 0.2057225 Test Loss: 0.2855307
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.5726048946380615
Epoch: 63, Steps: 65 | Train Loss: 0.3971053 Vali Loss: 0.2055803 Test Loss: 0.2855256
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 1.5201008319854736
Epoch: 64, Steps: 65 | Train Loss: 0.4006450 Vali Loss: 0.2050215 Test Loss: 0.2855253
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 1.5757975578308105
Epoch: 65, Steps: 65 | Train Loss: 0.4013755 Vali Loss: 0.2058655 Test Loss: 0.2855217
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.3963134288787842
Epoch: 66, Steps: 65 | Train Loss: 0.4019562 Vali Loss: 0.2054823 Test Loss: 0.2855190
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 2.199500322341919
Epoch: 67, Steps: 65 | Train Loss: 0.4007136 Vali Loss: 0.2062089 Test Loss: 0.2855199
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.4016633033752441
Epoch: 68, Steps: 65 | Train Loss: 0.4017242 Vali Loss: 0.2066462 Test Loss: 0.2855180
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 1.143343210220337
Epoch: 69, Steps: 65 | Train Loss: 0.4013826 Vali Loss: 0.2053867 Test Loss: 0.2855230
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 1.9900155067443848
Epoch: 70, Steps: 65 | Train Loss: 0.4014439 Vali Loss: 0.2063626 Test Loss: 0.2855178
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 1.0112721920013428
Epoch: 71, Steps: 65 | Train Loss: 0.4015025 Vali Loss: 0.2054477 Test Loss: 0.2855208
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 1.1495893001556396
Epoch: 72, Steps: 65 | Train Loss: 0.4005974 Vali Loss: 0.2051579 Test Loss: 0.2855217
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh2_180_96_FITS_ETTh2_ftM_sl180_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.2853837013244629, mae:0.33909186720848083, rse:0.43052253127098083, corr:[0.27536556 0.27723283 0.27555445 0.27604353 0.2745062  0.27293682
 0.27248362 0.27130416 0.27008307 0.26909274 0.26803014 0.26631945
 0.26477063 0.2634491  0.2625307  0.26202044 0.26176232 0.26110718
 0.26027727 0.2593701  0.25805715 0.2569211  0.25605345 0.25413874
 0.251101   0.24881633 0.24671811 0.24492402 0.24348323 0.24189098
 0.24014191 0.23875213 0.23675923 0.23464818 0.23364475 0.23244299
 0.23066933 0.2294537  0.22877431 0.22712737 0.22648382 0.22635946
 0.22546946 0.2244754  0.22386995 0.22247869 0.22127374 0.22007366
 0.21688762 0.21432294 0.21292695 0.21096252 0.20893449 0.2079386
 0.20567888 0.20282869 0.20169728 0.20018299 0.1983678  0.19752973
 0.19717497 0.19594148 0.19642223 0.19642325 0.19550624 0.19517905
 0.19477469 0.19336407 0.19309469 0.19307776 0.19160862 0.1907369
 0.18910702 0.18694016 0.18592426 0.18544748 0.18337692 0.18282756
 0.1834551  0.18230113 0.1816715  0.18245554 0.18270493 0.18241154
 0.18316074 0.18288784 0.18320577 0.18409991 0.18345805 0.18230024
 0.18307607 0.18183687 0.18120228 0.18314603 0.18073587 0.18105857]
