Args in experiment:
Namespace(H_order=2, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_90_96_FITS_ETTh2_ftM_sl90_ll48_pl96_H2_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8455
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 3.1207430362701416
Epoch: 1, Steps: 66 | Train Loss: 0.5094009 Vali Loss: 0.3174751 Test Loss: 0.4262499
Validation loss decreased (inf --> 0.317475).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.9393367767333984
Epoch: 2, Steps: 66 | Train Loss: 0.4400613 Vali Loss: 0.2925138 Test Loss: 0.3926252
Validation loss decreased (0.317475 --> 0.292514).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 1.7294280529022217
Epoch: 3, Steps: 66 | Train Loss: 0.3931500 Vali Loss: 0.2759571 Test Loss: 0.3697719
Validation loss decreased (0.292514 --> 0.275957).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.53511643409729
Epoch: 4, Steps: 66 | Train Loss: 0.3604736 Vali Loss: 0.2649759 Test Loss: 0.3541204
Validation loss decreased (0.275957 --> 0.264976).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.5750694274902344
Epoch: 5, Steps: 66 | Train Loss: 0.3373867 Vali Loss: 0.2565745 Test Loss: 0.3429103
Validation loss decreased (0.264976 --> 0.256574).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.3463845252990723
Epoch: 6, Steps: 66 | Train Loss: 0.3204274 Vali Loss: 0.2510788 Test Loss: 0.3347093
Validation loss decreased (0.256574 --> 0.251079).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.6222081184387207
Epoch: 7, Steps: 66 | Train Loss: 0.3076144 Vali Loss: 0.2451362 Test Loss: 0.3285873
Validation loss decreased (0.251079 --> 0.245136).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.4369571208953857
Epoch: 8, Steps: 66 | Train Loss: 0.2977104 Vali Loss: 0.2422821 Test Loss: 0.3240011
Validation loss decreased (0.245136 --> 0.242282).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 1.4299471378326416
Epoch: 9, Steps: 66 | Train Loss: 0.2898873 Vali Loss: 0.2383694 Test Loss: 0.3203300
Validation loss decreased (0.242282 --> 0.238369).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.970029592514038
Epoch: 10, Steps: 66 | Train Loss: 0.2833277 Vali Loss: 0.2355129 Test Loss: 0.3174467
Validation loss decreased (0.238369 --> 0.235513).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.9533228874206543
Epoch: 11, Steps: 66 | Train Loss: 0.2785204 Vali Loss: 0.2353880 Test Loss: 0.3150780
Validation loss decreased (0.235513 --> 0.235388).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.9186172485351562
Epoch: 12, Steps: 66 | Train Loss: 0.2743948 Vali Loss: 0.2323447 Test Loss: 0.3130906
Validation loss decreased (0.235388 --> 0.232345).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 2.114136219024658
Epoch: 13, Steps: 66 | Train Loss: 0.2708535 Vali Loss: 0.2318267 Test Loss: 0.3114042
Validation loss decreased (0.232345 --> 0.231827).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 2.7090983390808105
Epoch: 14, Steps: 66 | Train Loss: 0.2677771 Vali Loss: 0.2306973 Test Loss: 0.3099586
Validation loss decreased (0.231827 --> 0.230697).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 2.443567991256714
Epoch: 15, Steps: 66 | Train Loss: 0.2642303 Vali Loss: 0.2279280 Test Loss: 0.3087347
Validation loss decreased (0.230697 --> 0.227928).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 2.9982051849365234
Epoch: 16, Steps: 66 | Train Loss: 0.2626868 Vali Loss: 0.2270947 Test Loss: 0.3076049
Validation loss decreased (0.227928 --> 0.227095).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 2.204108715057373
Epoch: 17, Steps: 66 | Train Loss: 0.2604495 Vali Loss: 0.2279331 Test Loss: 0.3066381
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 2.8586997985839844
Epoch: 18, Steps: 66 | Train Loss: 0.2589977 Vali Loss: 0.2257769 Test Loss: 0.3057475
Validation loss decreased (0.227095 --> 0.225777).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 2.1039514541625977
Epoch: 19, Steps: 66 | Train Loss: 0.2572685 Vali Loss: 0.2252509 Test Loss: 0.3049762
Validation loss decreased (0.225777 --> 0.225251).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 2.264960527420044
Epoch: 20, Steps: 66 | Train Loss: 0.2558071 Vali Loss: 0.2259310 Test Loss: 0.3042848
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 2.6517860889434814
Epoch: 21, Steps: 66 | Train Loss: 0.2545984 Vali Loss: 0.2242966 Test Loss: 0.3036260
Validation loss decreased (0.225251 --> 0.224297).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.5454974174499512
Epoch: 22, Steps: 66 | Train Loss: 0.2533910 Vali Loss: 0.2242572 Test Loss: 0.3030546
Validation loss decreased (0.224297 --> 0.224257).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 1.504521131515503
Epoch: 23, Steps: 66 | Train Loss: 0.2520630 Vali Loss: 0.2239900 Test Loss: 0.3025237
Validation loss decreased (0.224257 --> 0.223990).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.3617792129516602
Epoch: 24, Steps: 66 | Train Loss: 0.2513374 Vali Loss: 0.2227953 Test Loss: 0.3020420
Validation loss decreased (0.223990 --> 0.222795).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.8933625221252441
Epoch: 25, Steps: 66 | Train Loss: 0.2504249 Vali Loss: 0.2219614 Test Loss: 0.3015795
Validation loss decreased (0.222795 --> 0.221961).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 1.3525714874267578
Epoch: 26, Steps: 66 | Train Loss: 0.2492452 Vali Loss: 0.2226400 Test Loss: 0.3011887
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.752521276473999
Epoch: 27, Steps: 66 | Train Loss: 0.2489159 Vali Loss: 0.2231758 Test Loss: 0.3008097
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 2.1748526096343994
Epoch: 28, Steps: 66 | Train Loss: 0.2481972 Vali Loss: 0.2220644 Test Loss: 0.3004640
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 1.3472888469696045
Epoch: 29, Steps: 66 | Train Loss: 0.2474101 Vali Loss: 0.2212700 Test Loss: 0.3001507
Validation loss decreased (0.221961 --> 0.221270).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 2.344350576400757
Epoch: 30, Steps: 66 | Train Loss: 0.2468425 Vali Loss: 0.2210287 Test Loss: 0.2998572
Validation loss decreased (0.221270 --> 0.221029).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 2.2368359565734863
Epoch: 31, Steps: 66 | Train Loss: 0.2463623 Vali Loss: 0.2207323 Test Loss: 0.2995808
Validation loss decreased (0.221029 --> 0.220732).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.5293457508087158
Epoch: 32, Steps: 66 | Train Loss: 0.2458489 Vali Loss: 0.2205262 Test Loss: 0.2993278
Validation loss decreased (0.220732 --> 0.220526).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.7955858707427979
Epoch: 33, Steps: 66 | Train Loss: 0.2454419 Vali Loss: 0.2215479 Test Loss: 0.2990749
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 2.2322778701782227
Epoch: 34, Steps: 66 | Train Loss: 0.2446754 Vali Loss: 0.2201098 Test Loss: 0.2988720
Validation loss decreased (0.220526 --> 0.220110).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 2.2863564491271973
Epoch: 35, Steps: 66 | Train Loss: 0.2445839 Vali Loss: 0.2192141 Test Loss: 0.2986672
Validation loss decreased (0.220110 --> 0.219214).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 3.0190787315368652
Epoch: 36, Steps: 66 | Train Loss: 0.2442327 Vali Loss: 0.2210167 Test Loss: 0.2984748
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.6451921463012695
Epoch: 37, Steps: 66 | Train Loss: 0.2438292 Vali Loss: 0.2197778 Test Loss: 0.2982957
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 2.070310592651367
Epoch: 38, Steps: 66 | Train Loss: 0.2434520 Vali Loss: 0.2198177 Test Loss: 0.2981320
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.9019081592559814
Epoch: 39, Steps: 66 | Train Loss: 0.2432094 Vali Loss: 0.2184434 Test Loss: 0.2979731
Validation loss decreased (0.219214 --> 0.218443).  Saving model ...
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.6153085231781006
Epoch: 40, Steps: 66 | Train Loss: 0.2428722 Vali Loss: 0.2181193 Test Loss: 0.2978318
Validation loss decreased (0.218443 --> 0.218119).  Saving model ...
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 2.7581446170806885
Epoch: 41, Steps: 66 | Train Loss: 0.2426176 Vali Loss: 0.2195893 Test Loss: 0.2976944
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.686950922012329
Epoch: 42, Steps: 66 | Train Loss: 0.2423753 Vali Loss: 0.2189622 Test Loss: 0.2975733
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 2.5028345584869385
Epoch: 43, Steps: 66 | Train Loss: 0.2421363 Vali Loss: 0.2189607 Test Loss: 0.2974492
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.6517412662506104
Epoch: 44, Steps: 66 | Train Loss: 0.2419254 Vali Loss: 0.2189351 Test Loss: 0.2973366
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.545546054840088
Epoch: 45, Steps: 66 | Train Loss: 0.2416508 Vali Loss: 0.2192228 Test Loss: 0.2972354
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.4432415962219238
Epoch: 46, Steps: 66 | Train Loss: 0.2414769 Vali Loss: 0.2177472 Test Loss: 0.2971303
Validation loss decreased (0.218119 --> 0.217747).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.7700016498565674
Epoch: 47, Steps: 66 | Train Loss: 0.2413165 Vali Loss: 0.2173566 Test Loss: 0.2970425
Validation loss decreased (0.217747 --> 0.217357).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.9893028736114502
Epoch: 48, Steps: 66 | Train Loss: 0.2410397 Vali Loss: 0.2181832 Test Loss: 0.2969543
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.6372106075286865
Epoch: 49, Steps: 66 | Train Loss: 0.2407554 Vali Loss: 0.2191101 Test Loss: 0.2968721
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.8861420154571533
Epoch: 50, Steps: 66 | Train Loss: 0.2408150 Vali Loss: 0.2191845 Test Loss: 0.2967953
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.508451223373413
Epoch: 51, Steps: 66 | Train Loss: 0.2405594 Vali Loss: 0.2184628 Test Loss: 0.2967169
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.6634869575500488
Epoch: 52, Steps: 66 | Train Loss: 0.2403631 Vali Loss: 0.2170572 Test Loss: 0.2966548
Validation loss decreased (0.217357 --> 0.217057).  Saving model ...
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 2.0524110794067383
Epoch: 53, Steps: 66 | Train Loss: 0.2396867 Vali Loss: 0.2184244 Test Loss: 0.2965863
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 2.0048422813415527
Epoch: 54, Steps: 66 | Train Loss: 0.2396731 Vali Loss: 0.2183319 Test Loss: 0.2965227
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 2.000331163406372
Epoch: 55, Steps: 66 | Train Loss: 0.2401185 Vali Loss: 0.2185678 Test Loss: 0.2964683
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 3.2560834884643555
Epoch: 56, Steps: 66 | Train Loss: 0.2399851 Vali Loss: 0.2182613 Test Loss: 0.2964104
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 2.1114697456359863
Epoch: 57, Steps: 66 | Train Loss: 0.2398966 Vali Loss: 0.2178848 Test Loss: 0.2963589
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 1.5459015369415283
Epoch: 58, Steps: 66 | Train Loss: 0.2397032 Vali Loss: 0.2179998 Test Loss: 0.2963101
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.4036054611206055
Epoch: 59, Steps: 66 | Train Loss: 0.2396717 Vali Loss: 0.2176816 Test Loss: 0.2962657
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.6003637313842773
Epoch: 60, Steps: 66 | Train Loss: 0.2396125 Vali Loss: 0.2175853 Test Loss: 0.2962222
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.856870412826538
Epoch: 61, Steps: 66 | Train Loss: 0.2394199 Vali Loss: 0.2180168 Test Loss: 0.2961773
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.7663426399230957
Epoch: 62, Steps: 66 | Train Loss: 0.2393595 Vali Loss: 0.2167471 Test Loss: 0.2961420
Validation loss decreased (0.217057 --> 0.216747).  Saving model ...
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.3770077228546143
Epoch: 63, Steps: 66 | Train Loss: 0.2390811 Vali Loss: 0.2179131 Test Loss: 0.2961023
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 1.8585400581359863
Epoch: 64, Steps: 66 | Train Loss: 0.2391830 Vali Loss: 0.2171812 Test Loss: 0.2960666
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 2.081068277359009
Epoch: 65, Steps: 66 | Train Loss: 0.2392291 Vali Loss: 0.2173444 Test Loss: 0.2960318
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.7373754978179932
Epoch: 66, Steps: 66 | Train Loss: 0.2390944 Vali Loss: 0.2162734 Test Loss: 0.2960000
Validation loss decreased (0.216747 --> 0.216273).  Saving model ...
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 2.285783052444458
Epoch: 67, Steps: 66 | Train Loss: 0.2389468 Vali Loss: 0.2174168 Test Loss: 0.2959706
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.5162763595581055
Epoch: 68, Steps: 66 | Train Loss: 0.2390220 Vali Loss: 0.2172471 Test Loss: 0.2959445
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 2.8440539836883545
Epoch: 69, Steps: 66 | Train Loss: 0.2389491 Vali Loss: 0.2169562 Test Loss: 0.2959131
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 2.4624404907226562
Epoch: 70, Steps: 66 | Train Loss: 0.2388524 Vali Loss: 0.2172931 Test Loss: 0.2958871
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 2.290426731109619
Epoch: 71, Steps: 66 | Train Loss: 0.2388363 Vali Loss: 0.2186914 Test Loss: 0.2958635
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 2.0194597244262695
Epoch: 72, Steps: 66 | Train Loss: 0.2388338 Vali Loss: 0.2172967 Test Loss: 0.2958383
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 2.5714800357818604
Epoch: 73, Steps: 66 | Train Loss: 0.2385945 Vali Loss: 0.2171209 Test Loss: 0.2958183
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 1.769871711730957
Epoch: 74, Steps: 66 | Train Loss: 0.2387645 Vali Loss: 0.2174045 Test Loss: 0.2957970
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 1.5847957134246826
Epoch: 75, Steps: 66 | Train Loss: 0.2386244 Vali Loss: 0.2184022 Test Loss: 0.2957765
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 1.725116491317749
Epoch: 76, Steps: 66 | Train Loss: 0.2385988 Vali Loss: 0.2174372 Test Loss: 0.2957575
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 1.7704122066497803
Epoch: 77, Steps: 66 | Train Loss: 0.2385100 Vali Loss: 0.2162311 Test Loss: 0.2957376
Validation loss decreased (0.216273 --> 0.216231).  Saving model ...
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 1.9626364707946777
Epoch: 78, Steps: 66 | Train Loss: 0.2385778 Vali Loss: 0.2172142 Test Loss: 0.2957215
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 1.769211769104004
Epoch: 79, Steps: 66 | Train Loss: 0.2385915 Vali Loss: 0.2172513 Test Loss: 0.2957056
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 1.9018347263336182
Epoch: 80, Steps: 66 | Train Loss: 0.2385406 Vali Loss: 0.2172262 Test Loss: 0.2956889
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 2.158628225326538
Epoch: 81, Steps: 66 | Train Loss: 0.2379999 Vali Loss: 0.2171331 Test Loss: 0.2956741
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 1.9889795780181885
Epoch: 82, Steps: 66 | Train Loss: 0.2383959 Vali Loss: 0.2172687 Test Loss: 0.2956598
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 1.553163766860962
Epoch: 83, Steps: 66 | Train Loss: 0.2383002 Vali Loss: 0.2164865 Test Loss: 0.2956458
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 1.6812036037445068
Epoch: 84, Steps: 66 | Train Loss: 0.2384181 Vali Loss: 0.2166273 Test Loss: 0.2956330
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 1.9204704761505127
Epoch: 85, Steps: 66 | Train Loss: 0.2383296 Vali Loss: 0.2170149 Test Loss: 0.2956224
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 1.7196605205535889
Epoch: 86, Steps: 66 | Train Loss: 0.2383010 Vali Loss: 0.2183644 Test Loss: 0.2956099
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.389640937399644e-06
Epoch: 87 cost time: 2.169731616973877
Epoch: 87, Steps: 66 | Train Loss: 0.2382069 Vali Loss: 0.2171682 Test Loss: 0.2955987
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.070158890529662e-06
Epoch: 88 cost time: 1.5305452346801758
Epoch: 88, Steps: 66 | Train Loss: 0.2383263 Vali Loss: 0.2162361 Test Loss: 0.2955887
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.766650946003179e-06
Epoch: 89 cost time: 1.5632200241088867
Epoch: 89, Steps: 66 | Train Loss: 0.2381044 Vali Loss: 0.2168108 Test Loss: 0.2955776
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.47831839870302e-06
Epoch: 90 cost time: 1.6956160068511963
Epoch: 90, Steps: 66 | Train Loss: 0.2382582 Vali Loss: 0.2172865 Test Loss: 0.2955691
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.204402478767869e-06
Epoch: 91 cost time: 1.6268823146820068
Epoch: 91, Steps: 66 | Train Loss: 0.2381389 Vali Loss: 0.2167606 Test Loss: 0.2955597
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.944182354829475e-06
Epoch: 92 cost time: 1.6711270809173584
Epoch: 92, Steps: 66 | Train Loss: 0.2382160 Vali Loss: 0.2169625 Test Loss: 0.2955514
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.696973237088e-06
Epoch: 93 cost time: 1.8291716575622559
Epoch: 93, Steps: 66 | Train Loss: 0.2381299 Vali Loss: 0.2177858 Test Loss: 0.2955424
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.462124575233601e-06
Epoch: 94 cost time: 2.2129194736480713
Epoch: 94, Steps: 66 | Train Loss: 0.2381491 Vali Loss: 0.2166045 Test Loss: 0.2955348
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.239018346471921e-06
Epoch: 95 cost time: 1.7592806816101074
Epoch: 95, Steps: 66 | Train Loss: 0.2381718 Vali Loss: 0.2167912 Test Loss: 0.2955272
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.027067429148324e-06
Epoch: 96 cost time: 1.3591692447662354
Epoch: 96, Steps: 66 | Train Loss: 0.2381898 Vali Loss: 0.2174650 Test Loss: 0.2955210
EarlyStopping counter: 19 out of 20
Updating learning rate to 3.825714057690908e-06
Epoch: 97 cost time: 2.793630361557007
Epoch: 97, Steps: 66 | Train Loss: 0.2380645 Vali Loss: 0.2170418 Test Loss: 0.2955136
EarlyStopping counter: 20 out of 20
Early stopping
train 8455
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.9513776302337646
Epoch: 1, Steps: 66 | Train Loss: 0.4290223 Vali Loss: 0.2150971 Test Loss: 0.2935005
Validation loss decreased (inf --> 0.215097).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.565199851989746
Epoch: 2, Steps: 66 | Train Loss: 0.4270193 Vali Loss: 0.2142644 Test Loss: 0.2926266
Validation loss decreased (0.215097 --> 0.214264).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 3.0180020332336426
Epoch: 3, Steps: 66 | Train Loss: 0.4257380 Vali Loss: 0.2141901 Test Loss: 0.2921647
Validation loss decreased (0.214264 --> 0.214190).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 1.6548352241516113
Epoch: 4, Steps: 66 | Train Loss: 0.4246166 Vali Loss: 0.2142826 Test Loss: 0.2919285
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 2.3700754642486572
Epoch: 5, Steps: 66 | Train Loss: 0.4238299 Vali Loss: 0.2139378 Test Loss: 0.2917280
Validation loss decreased (0.214190 --> 0.213938).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 2.044889450073242
Epoch: 6, Steps: 66 | Train Loss: 0.4234777 Vali Loss: 0.2123231 Test Loss: 0.2916057
Validation loss decreased (0.213938 --> 0.212323).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 2.448617458343506
Epoch: 7, Steps: 66 | Train Loss: 0.4231446 Vali Loss: 0.2131362 Test Loss: 0.2914968
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 1.6155095100402832
Epoch: 8, Steps: 66 | Train Loss: 0.4228475 Vali Loss: 0.2131940 Test Loss: 0.2914098
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 2.522578001022339
Epoch: 9, Steps: 66 | Train Loss: 0.4224085 Vali Loss: 0.2129626 Test Loss: 0.2913334
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 1.896136999130249
Epoch: 10, Steps: 66 | Train Loss: 0.4219090 Vali Loss: 0.2117011 Test Loss: 0.2913192
Validation loss decreased (0.212323 --> 0.211701).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.89327073097229
Epoch: 11, Steps: 66 | Train Loss: 0.4217518 Vali Loss: 0.2129017 Test Loss: 0.2912654
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 2.104410171508789
Epoch: 12, Steps: 66 | Train Loss: 0.4206135 Vali Loss: 0.2121510 Test Loss: 0.2912102
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 2.26816987991333
Epoch: 13, Steps: 66 | Train Loss: 0.4216696 Vali Loss: 0.2126852 Test Loss: 0.2911874
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 2.2882325649261475
Epoch: 14, Steps: 66 | Train Loss: 0.4214330 Vali Loss: 0.2123065 Test Loss: 0.2911658
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.6170547008514404
Epoch: 15, Steps: 66 | Train Loss: 0.4213987 Vali Loss: 0.2129674 Test Loss: 0.2911256
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.6569902896881104
Epoch: 16, Steps: 66 | Train Loss: 0.4209349 Vali Loss: 0.2119659 Test Loss: 0.2911216
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 2.0389513969421387
Epoch: 17, Steps: 66 | Train Loss: 0.4209732 Vali Loss: 0.2125713 Test Loss: 0.2910528
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 1.563511848449707
Epoch: 18, Steps: 66 | Train Loss: 0.4211158 Vali Loss: 0.2127187 Test Loss: 0.2910273
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.701632022857666
Epoch: 19, Steps: 66 | Train Loss: 0.4202490 Vali Loss: 0.2110029 Test Loss: 0.2910244
Validation loss decreased (0.211701 --> 0.211003).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 2.8081138134002686
Epoch: 20, Steps: 66 | Train Loss: 0.4208851 Vali Loss: 0.2112433 Test Loss: 0.2910040
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 2.0463101863861084
Epoch: 21, Steps: 66 | Train Loss: 0.4206308 Vali Loss: 0.2129359 Test Loss: 0.2909842
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 1.5807602405548096
Epoch: 22, Steps: 66 | Train Loss: 0.4195425 Vali Loss: 0.2132955 Test Loss: 0.2909760
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 2.3174402713775635
Epoch: 23, Steps: 66 | Train Loss: 0.4205781 Vali Loss: 0.2116213 Test Loss: 0.2909792
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 1.749798059463501
Epoch: 24, Steps: 66 | Train Loss: 0.4206487 Vali Loss: 0.2131406 Test Loss: 0.2909306
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 3.4093270301818848
Epoch: 25, Steps: 66 | Train Loss: 0.4206646 Vali Loss: 0.2123246 Test Loss: 0.2909423
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 2.4379076957702637
Epoch: 26, Steps: 66 | Train Loss: 0.4204747 Vali Loss: 0.2109770 Test Loss: 0.2909505
Validation loss decreased (0.211003 --> 0.210977).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 2.2714309692382812
Epoch: 27, Steps: 66 | Train Loss: 0.4193289 Vali Loss: 0.2125578 Test Loss: 0.2909389
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 3.324639081954956
Epoch: 28, Steps: 66 | Train Loss: 0.4202714 Vali Loss: 0.2120246 Test Loss: 0.2909274
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 3.1043665409088135
Epoch: 29, Steps: 66 | Train Loss: 0.4200862 Vali Loss: 0.2122748 Test Loss: 0.2909101
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 1.4614944458007812
Epoch: 30, Steps: 66 | Train Loss: 0.4203837 Vali Loss: 0.2120609 Test Loss: 0.2909220
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 1.489738941192627
Epoch: 31, Steps: 66 | Train Loss: 0.4202035 Vali Loss: 0.2124246 Test Loss: 0.2909137
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 1.8503482341766357
Epoch: 32, Steps: 66 | Train Loss: 0.4202306 Vali Loss: 0.2119437 Test Loss: 0.2909205
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 1.5342192649841309
Epoch: 33, Steps: 66 | Train Loss: 0.4202972 Vali Loss: 0.2120950 Test Loss: 0.2909070
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.5657496452331543
Epoch: 34, Steps: 66 | Train Loss: 0.4203577 Vali Loss: 0.2112207 Test Loss: 0.2909032
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 2.583706855773926
Epoch: 35, Steps: 66 | Train Loss: 0.4202080 Vali Loss: 0.2118852 Test Loss: 0.2909032
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.6543951034545898
Epoch: 36, Steps: 66 | Train Loss: 0.4202098 Vali Loss: 0.2115790 Test Loss: 0.2908917
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 2.030935764312744
Epoch: 37, Steps: 66 | Train Loss: 0.4201726 Vali Loss: 0.2115754 Test Loss: 0.2908963
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.5360174179077148
Epoch: 38, Steps: 66 | Train Loss: 0.4202083 Vali Loss: 0.2116141 Test Loss: 0.2908941
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 2.465337038040161
Epoch: 39, Steps: 66 | Train Loss: 0.4186042 Vali Loss: 0.2116902 Test Loss: 0.2908824
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.6447422504425049
Epoch: 40, Steps: 66 | Train Loss: 0.4198785 Vali Loss: 0.2122576 Test Loss: 0.2908816
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 2.477621555328369
Epoch: 41, Steps: 66 | Train Loss: 0.4199743 Vali Loss: 0.2122070 Test Loss: 0.2908759
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.549328088760376
Epoch: 42, Steps: 66 | Train Loss: 0.4198865 Vali Loss: 0.2113257 Test Loss: 0.2908737
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.6782069206237793
Epoch: 43, Steps: 66 | Train Loss: 0.4198786 Vali Loss: 0.2111491 Test Loss: 0.2908631
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.823068380355835
Epoch: 44, Steps: 66 | Train Loss: 0.4200178 Vali Loss: 0.2106002 Test Loss: 0.2908506
Validation loss decreased (0.210977 --> 0.210600).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.4578018188476562
Epoch: 45, Steps: 66 | Train Loss: 0.4185630 Vali Loss: 0.2114346 Test Loss: 0.2908570
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.9600162506103516
Epoch: 46, Steps: 66 | Train Loss: 0.4201143 Vali Loss: 0.2117929 Test Loss: 0.2908579
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 2.282482385635376
Epoch: 47, Steps: 66 | Train Loss: 0.4198325 Vali Loss: 0.2108746 Test Loss: 0.2908508
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 2.4458365440368652
Epoch: 48, Steps: 66 | Train Loss: 0.4200403 Vali Loss: 0.2110381 Test Loss: 0.2908570
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.8796486854553223
Epoch: 49, Steps: 66 | Train Loss: 0.4198256 Vali Loss: 0.2117081 Test Loss: 0.2908568
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.6940393447875977
Epoch: 50, Steps: 66 | Train Loss: 0.4198704 Vali Loss: 0.2122139 Test Loss: 0.2908445
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.855834722518921
Epoch: 51, Steps: 66 | Train Loss: 0.4199784 Vali Loss: 0.2118045 Test Loss: 0.2908489
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 2.102010726928711
Epoch: 52, Steps: 66 | Train Loss: 0.4199309 Vali Loss: 0.2113577 Test Loss: 0.2908494
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.3977093696594238
Epoch: 53, Steps: 66 | Train Loss: 0.4199917 Vali Loss: 0.2124888 Test Loss: 0.2908515
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.4681370258331299
Epoch: 54, Steps: 66 | Train Loss: 0.4198734 Vali Loss: 0.2120847 Test Loss: 0.2908450
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 2.472127914428711
Epoch: 55, Steps: 66 | Train Loss: 0.4192097 Vali Loss: 0.2114445 Test Loss: 0.2908438
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 3.250455141067505
Epoch: 56, Steps: 66 | Train Loss: 0.4198484 Vali Loss: 0.2122360 Test Loss: 0.2908494
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 3.02542781829834
Epoch: 57, Steps: 66 | Train Loss: 0.4198122 Vali Loss: 0.2110777 Test Loss: 0.2908436
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 2.6600306034088135
Epoch: 58, Steps: 66 | Train Loss: 0.4199075 Vali Loss: 0.2117398 Test Loss: 0.2908335
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 2.628201723098755
Epoch: 59, Steps: 66 | Train Loss: 0.4199493 Vali Loss: 0.2120589 Test Loss: 0.2908437
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.6599667072296143
Epoch: 60, Steps: 66 | Train Loss: 0.4198042 Vali Loss: 0.2120748 Test Loss: 0.2908445
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.4864654541015625
Epoch: 61, Steps: 66 | Train Loss: 0.4197464 Vali Loss: 0.2118777 Test Loss: 0.2908391
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 2.4922564029693604
Epoch: 62, Steps: 66 | Train Loss: 0.4198803 Vali Loss: 0.2117776 Test Loss: 0.2908373
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.8751325607299805
Epoch: 63, Steps: 66 | Train Loss: 0.4199868 Vali Loss: 0.2105062 Test Loss: 0.2908383
Validation loss decreased (0.210600 --> 0.210506).  Saving model ...
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 3.1549482345581055
Epoch: 64, Steps: 66 | Train Loss: 0.4199169 Vali Loss: 0.2122880 Test Loss: 0.2908351
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 1.5655171871185303
Epoch: 65, Steps: 66 | Train Loss: 0.4199487 Vali Loss: 0.2105692 Test Loss: 0.2908374
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.5473477840423584
Epoch: 66, Steps: 66 | Train Loss: 0.4199326 Vali Loss: 0.2103782 Test Loss: 0.2908316
Validation loss decreased (0.210506 --> 0.210378).  Saving model ...
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 1.4794840812683105
Epoch: 67, Steps: 66 | Train Loss: 0.4198716 Vali Loss: 0.2113207 Test Loss: 0.2908288
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.4124457836151123
Epoch: 68, Steps: 66 | Train Loss: 0.4198231 Vali Loss: 0.2114777 Test Loss: 0.2908347
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 1.4125146865844727
Epoch: 69, Steps: 66 | Train Loss: 0.4188790 Vali Loss: 0.2129131 Test Loss: 0.2908332
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 1.798194169998169
Epoch: 70, Steps: 66 | Train Loss: 0.4198821 Vali Loss: 0.2106140 Test Loss: 0.2908332
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 1.7649099826812744
Epoch: 71, Steps: 66 | Train Loss: 0.4199130 Vali Loss: 0.2119784 Test Loss: 0.2908320
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 3.1987338066101074
Epoch: 72, Steps: 66 | Train Loss: 0.4196611 Vali Loss: 0.2117512 Test Loss: 0.2908304
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.3102252957468109e-05
Epoch: 73 cost time: 2.659247636795044
Epoch: 73, Steps: 66 | Train Loss: 0.4199186 Vali Loss: 0.2116822 Test Loss: 0.2908298
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.2447140309594702e-05
Epoch: 74 cost time: 2.8004868030548096
Epoch: 74, Steps: 66 | Train Loss: 0.4197270 Vali Loss: 0.2120623 Test Loss: 0.2908309
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.1824783294114967e-05
Epoch: 75 cost time: 2.6169278621673584
Epoch: 75, Steps: 66 | Train Loss: 0.4187632 Vali Loss: 0.2119410 Test Loss: 0.2908299
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.1233544129409218e-05
Epoch: 76 cost time: 2.679802894592285
Epoch: 76, Steps: 66 | Train Loss: 0.4196442 Vali Loss: 0.2117390 Test Loss: 0.2908295
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.0671866922938755e-05
Epoch: 77 cost time: 1.6078450679779053
Epoch: 77, Steps: 66 | Train Loss: 0.4195925 Vali Loss: 0.2116165 Test Loss: 0.2908294
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.0138273576791817e-05
Epoch: 78 cost time: 2.3658719062805176
Epoch: 78, Steps: 66 | Train Loss: 0.4198845 Vali Loss: 0.2121113 Test Loss: 0.2908301
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.631359897952226e-06
Epoch: 79 cost time: 1.7218010425567627
Epoch: 79, Steps: 66 | Train Loss: 0.4198103 Vali Loss: 0.2115459 Test Loss: 0.2908287
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.149791903054614e-06
Epoch: 80 cost time: 1.6696176528930664
Epoch: 80, Steps: 66 | Train Loss: 0.4199170 Vali Loss: 0.2121247 Test Loss: 0.2908286
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.692302307901884e-06
Epoch: 81 cost time: 1.8652775287628174
Epoch: 81, Steps: 66 | Train Loss: 0.4196958 Vali Loss: 0.2113546 Test Loss: 0.2908297
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.25768719250679e-06
Epoch: 82 cost time: 1.5028393268585205
Epoch: 82, Steps: 66 | Train Loss: 0.4198134 Vali Loss: 0.2122087 Test Loss: 0.2908272
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.84480283288145e-06
Epoch: 83 cost time: 1.9434394836425781
Epoch: 83, Steps: 66 | Train Loss: 0.4197190 Vali Loss: 0.2118815 Test Loss: 0.2908293
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.452562691237377e-06
Epoch: 84 cost time: 1.9400811195373535
Epoch: 84, Steps: 66 | Train Loss: 0.4197230 Vali Loss: 0.2118507 Test Loss: 0.2908270
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.079934556675507e-06
Epoch: 85 cost time: 1.8813233375549316
Epoch: 85, Steps: 66 | Train Loss: 0.4187808 Vali Loss: 0.2121331 Test Loss: 0.2908265
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.725937828841732e-06
Epoch: 86 cost time: 1.8870255947113037
Epoch: 86, Steps: 66 | Train Loss: 0.4194451 Vali Loss: 0.2119526 Test Loss: 0.2908256
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh2_90_96_FITS_ETTh2_ftM_sl90_ll48_pl96_H2_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.29137134552001953, mae:0.3396840989589691, rse:0.4350154995918274, corr:[0.2748265  0.27742493 0.27594766 0.27414662 0.27344483 0.27306977
 0.27232492 0.27084872 0.2699914  0.26933157 0.26832423 0.26645523
 0.2643622  0.26310027 0.2623707  0.26188645 0.26132435 0.26081654
 0.2602687  0.25932935 0.2582793  0.25716344 0.25582913 0.25387526
 0.25089365 0.24836826 0.24620195 0.24460629 0.24334292 0.24208829
 0.24099933 0.23928301 0.23764394 0.23622023 0.2351652  0.23386942
 0.23226468 0.23093335 0.22980148 0.22888967 0.22845629 0.2283252
 0.22805254 0.22698383 0.22605966 0.22547688 0.22457133 0.22256956
 0.21896164 0.21604162 0.21393429 0.21248351 0.21106106 0.20923005
 0.20735186 0.20478162 0.20310879 0.20165853 0.2004975  0.19915223
 0.198071   0.1981811  0.19839369 0.19799185 0.19732359 0.19718343
 0.19733854 0.19669767 0.19583054 0.19527185 0.19477376 0.19378723
 0.19120468 0.18917662 0.18761723 0.18683925 0.18644382 0.18619205
 0.18574712 0.18394041 0.18321244 0.18334849 0.18329151 0.18232884
 0.18119533 0.18150721 0.18224029 0.18200435 0.18062063 0.17995358
 0.18049629 0.1801292  0.17879209 0.17779993 0.1793132  0.18115126]
