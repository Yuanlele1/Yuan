Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_180_j96_H4', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_180_j96_H4_FITS_custom_ftM_sl180_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18137
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=42, out_features=64, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  110444544.0
params:  2752.0
Trainable parameters:  2752
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3309148
	speed: 0.5040s/iter; left time: 7056.8594s
Epoch: 1 cost time: 71.66521120071411
Epoch: 1, Steps: 141 | Train Loss: 0.5074455 Vali Loss: 0.2405286 Test Loss: 0.2659489
Validation loss decreased (inf --> 0.240529).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2061804
	speed: 1.1093s/iter; left time: 15375.0242s
Epoch: 2 cost time: 62.53282189369202
Epoch: 2, Steps: 141 | Train Loss: 0.2288275 Vali Loss: 0.1782465 Test Loss: 0.2022459
Validation loss decreased (0.240529 --> 0.178247).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1846128
	speed: 1.0036s/iter; left time: 13768.0039s
Epoch: 3 cost time: 60.65668702125549
Epoch: 3, Steps: 141 | Train Loss: 0.1901837 Vali Loss: 0.1594003 Test Loss: 0.1835716
Validation loss decreased (0.178247 --> 0.159400).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1764296
	speed: 0.9802s/iter; left time: 13309.0830s
Epoch: 4 cost time: 59.90959978103638
Epoch: 4, Steps: 141 | Train Loss: 0.1769416 Vali Loss: 0.1519450 Test Loss: 0.1760647
Validation loss decreased (0.159400 --> 0.151945).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1659693
	speed: 0.9877s/iter; left time: 13272.1499s
Epoch: 5 cost time: 63.068115234375
Epoch: 5, Steps: 141 | Train Loss: 0.1713872 Vali Loss: 0.1491816 Test Loss: 0.1724235
Validation loss decreased (0.151945 --> 0.149182).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1640064
	speed: 1.0710s/iter; left time: 14240.3878s
Epoch: 6 cost time: 65.00432825088501
Epoch: 6, Steps: 141 | Train Loss: 0.1685599 Vali Loss: 0.1468620 Test Loss: 0.1702961
Validation loss decreased (0.149182 --> 0.146862).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1666817
	speed: 1.0059s/iter; left time: 13232.0379s
Epoch: 7 cost time: 62.343512296676636
Epoch: 7, Steps: 141 | Train Loss: 0.1669040 Vali Loss: 0.1455063 Test Loss: 0.1689061
Validation loss decreased (0.146862 --> 0.145506).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1630346
	speed: 1.0584s/iter; left time: 13774.2483s
Epoch: 8 cost time: 64.72788691520691
Epoch: 8, Steps: 141 | Train Loss: 0.1657287 Vali Loss: 0.1443782 Test Loss: 0.1679621
Validation loss decreased (0.145506 --> 0.144378).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1623884
	speed: 1.0712s/iter; left time: 13789.2043s
Epoch: 9 cost time: 63.46653366088867
Epoch: 9, Steps: 141 | Train Loss: 0.1649035 Vali Loss: 0.1439728 Test Loss: 0.1672687
Validation loss decreased (0.144378 --> 0.143973).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1757420
	speed: 0.9218s/iter; left time: 11736.4748s
Epoch: 10 cost time: 54.3176953792572
Epoch: 10, Steps: 141 | Train Loss: 0.1643545 Vali Loss: 0.1434457 Test Loss: 0.1667370
Validation loss decreased (0.143973 --> 0.143446).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1626122
	speed: 0.9385s/iter; left time: 11816.4737s
Epoch: 11 cost time: 58.33121871948242
Epoch: 11, Steps: 141 | Train Loss: 0.1639369 Vali Loss: 0.1430375 Test Loss: 0.1663412
Validation loss decreased (0.143446 --> 0.143038).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1680059
	speed: 0.9648s/iter; left time: 12012.2600s
Epoch: 12 cost time: 58.750303506851196
Epoch: 12, Steps: 141 | Train Loss: 0.1635646 Vali Loss: 0.1425965 Test Loss: 0.1660501
Validation loss decreased (0.143038 --> 0.142596).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1646573
	speed: 0.9618s/iter; left time: 11838.4490s
Epoch: 13 cost time: 58.68846917152405
Epoch: 13, Steps: 141 | Train Loss: 0.1632944 Vali Loss: 0.1427337 Test Loss: 0.1658222
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1620105
	speed: 1.0196s/iter; left time: 12406.6838s
Epoch: 14 cost time: 63.32909679412842
Epoch: 14, Steps: 141 | Train Loss: 0.1631663 Vali Loss: 0.1422593 Test Loss: 0.1656464
Validation loss decreased (0.142596 --> 0.142259).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1516493
	speed: 1.0602s/iter; left time: 12750.5091s
Epoch: 15 cost time: 63.43019461631775
Epoch: 15, Steps: 141 | Train Loss: 0.1630020 Vali Loss: 0.1422993 Test Loss: 0.1654846
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1550017
	speed: 1.0072s/iter; left time: 11971.5353s
Epoch: 16 cost time: 58.59700536727905
Epoch: 16, Steps: 141 | Train Loss: 0.1628799 Vali Loss: 0.1420083 Test Loss: 0.1653726
Validation loss decreased (0.142259 --> 0.142008).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1556325
	speed: 0.9738s/iter; left time: 11437.6183s
Epoch: 17 cost time: 63.620731353759766
Epoch: 17, Steps: 141 | Train Loss: 0.1627330 Vali Loss: 0.1422783 Test Loss: 0.1652783
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1611805
	speed: 1.0936s/iter; left time: 12689.8907s
Epoch: 18 cost time: 73.61569547653198
Epoch: 18, Steps: 141 | Train Loss: 0.1627035 Vali Loss: 0.1420587 Test Loss: 0.1652035
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1621406
	speed: 1.3385s/iter; left time: 15343.4861s
Epoch: 19 cost time: 77.82622814178467
Epoch: 19, Steps: 141 | Train Loss: 0.1624912 Vali Loss: 0.1418653 Test Loss: 0.1651415
Validation loss decreased (0.142008 --> 0.141865).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1557658
	speed: 1.3234s/iter; left time: 14983.7543s
Epoch: 20 cost time: 81.41071724891663
Epoch: 20, Steps: 141 | Train Loss: 0.1625977 Vali Loss: 0.1420048 Test Loss: 0.1650838
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1571738
	speed: 1.2902s/iter; left time: 14425.8657s
Epoch: 21 cost time: 78.79723048210144
Epoch: 21, Steps: 141 | Train Loss: 0.1626047 Vali Loss: 0.1418400 Test Loss: 0.1650297
Validation loss decreased (0.141865 --> 0.141840).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1560000
	speed: 1.3090s/iter; left time: 14451.2690s
Epoch: 22 cost time: 78.49541306495667
Epoch: 22, Steps: 141 | Train Loss: 0.1624874 Vali Loss: 0.1415625 Test Loss: 0.1649865
Validation loss decreased (0.141840 --> 0.141562).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1647243
	speed: 1.3004s/iter; left time: 14173.1196s
Epoch: 23 cost time: 78.62705326080322
Epoch: 23, Steps: 141 | Train Loss: 0.1624653 Vali Loss: 0.1417087 Test Loss: 0.1649558
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1542951
	speed: 1.2996s/iter; left time: 13980.9552s
Epoch: 24 cost time: 76.45137214660645
Epoch: 24, Steps: 141 | Train Loss: 0.1624818 Vali Loss: 0.1418997 Test Loss: 0.1649320
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1631380
	speed: 1.0705s/iter; left time: 11364.9696s
Epoch: 25 cost time: 59.46503567695618
Epoch: 25, Steps: 141 | Train Loss: 0.1624413 Vali Loss: 0.1417198 Test Loss: 0.1648983
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1676049
	speed: 1.1173s/iter; left time: 11705.2007s
Epoch: 26 cost time: 72.57960486412048
Epoch: 26, Steps: 141 | Train Loss: 0.1623877 Vali Loss: 0.1415075 Test Loss: 0.1648769
Validation loss decreased (0.141562 --> 0.141508).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1654087
	speed: 1.1524s/iter; left time: 11910.0573s
Epoch: 27 cost time: 68.9362256526947
Epoch: 27, Steps: 141 | Train Loss: 0.1623779 Vali Loss: 0.1416078 Test Loss: 0.1648511
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1622527
	speed: 1.1501s/iter; left time: 11723.8687s
Epoch: 28 cost time: 71.82791781425476
Epoch: 28, Steps: 141 | Train Loss: 0.1624093 Vali Loss: 0.1417307 Test Loss: 0.1648373
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1607170
	speed: 1.1445s/iter; left time: 11505.8507s
Epoch: 29 cost time: 68.11828541755676
Epoch: 29, Steps: 141 | Train Loss: 0.1623530 Vali Loss: 0.1416817 Test Loss: 0.1648204
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1590037
	speed: 1.1423s/iter; left time: 11322.2756s
Epoch: 30 cost time: 71.67073702812195
Epoch: 30, Steps: 141 | Train Loss: 0.1623163 Vali Loss: 0.1417911 Test Loss: 0.1648053
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1601796
	speed: 1.1482s/iter; left time: 11219.0892s
Epoch: 31 cost time: 70.51973056793213
Epoch: 31, Steps: 141 | Train Loss: 0.1623270 Vali Loss: 0.1415379 Test Loss: 0.1647962
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1790016
	speed: 1.3038s/iter; left time: 12555.4261s
Epoch: 32 cost time: 78.18370294570923
Epoch: 32, Steps: 141 | Train Loss: 0.1622804 Vali Loss: 0.1416252 Test Loss: 0.1647788
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1758966
	speed: 1.2871s/iter; left time: 12212.8512s
Epoch: 33 cost time: 72.78105449676514
Epoch: 33, Steps: 141 | Train Loss: 0.1622735 Vali Loss: 0.1414712 Test Loss: 0.1647791
Validation loss decreased (0.141508 --> 0.141471).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1564253
	speed: 1.0613s/iter; left time: 9920.6720s
Epoch: 34 cost time: 63.39376211166382
Epoch: 34, Steps: 141 | Train Loss: 0.1622315 Vali Loss: 0.1415273 Test Loss: 0.1647588
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1541021
	speed: 1.1132s/iter; left time: 10248.9879s
Epoch: 35 cost time: 70.29709506034851
Epoch: 35, Steps: 141 | Train Loss: 0.1622944 Vali Loss: 0.1415724 Test Loss: 0.1647447
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1610825
	speed: 1.0815s/iter; left time: 9804.6902s
Epoch: 36 cost time: 61.83612942695618
Epoch: 36, Steps: 141 | Train Loss: 0.1622080 Vali Loss: 0.1417201 Test Loss: 0.1647457
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1536200
	speed: 1.0771s/iter; left time: 9613.3631s
Epoch: 37 cost time: 66.41595315933228
Epoch: 37, Steps: 141 | Train Loss: 0.1622349 Vali Loss: 0.1415900 Test Loss: 0.1647410
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1673100
	speed: 1.0740s/iter; left time: 9434.2655s
Epoch: 38 cost time: 64.86929559707642
Epoch: 38, Steps: 141 | Train Loss: 0.1621976 Vali Loss: 0.1414824 Test Loss: 0.1647191
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1642507
	speed: 0.9969s/iter; left time: 8616.2242s
Epoch: 39 cost time: 56.56131076812744
Epoch: 39, Steps: 141 | Train Loss: 0.1622438 Vali Loss: 0.1415797 Test Loss: 0.1647179
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1629684
	speed: 0.8923s/iter; left time: 7586.1814s
Epoch: 40 cost time: 56.36728072166443
Epoch: 40, Steps: 141 | Train Loss: 0.1622375 Vali Loss: 0.1414310 Test Loss: 0.1647137
Validation loss decreased (0.141471 --> 0.141431).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1552701
	speed: 0.8961s/iter; left time: 7491.9427s
Epoch: 41 cost time: 54.40652561187744
Epoch: 41, Steps: 141 | Train Loss: 0.1623111 Vali Loss: 0.1413985 Test Loss: 0.1647102
Validation loss decreased (0.141431 --> 0.141398).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1672879
	speed: 0.8622s/iter; left time: 7087.5911s
Epoch: 42 cost time: 53.686686515808105
Epoch: 42, Steps: 141 | Train Loss: 0.1622832 Vali Loss: 0.1417586 Test Loss: 0.1646965
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1625362
	speed: 0.9122s/iter; left time: 7369.3044s
Epoch: 43 cost time: 54.28049325942993
Epoch: 43, Steps: 141 | Train Loss: 0.1622825 Vali Loss: 0.1415831 Test Loss: 0.1646941
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1616890
	speed: 0.8516s/iter; left time: 6759.6191s
Epoch: 44 cost time: 50.92858076095581
Epoch: 44, Steps: 141 | Train Loss: 0.1621913 Vali Loss: 0.1418677 Test Loss: 0.1646921
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1578263
	speed: 0.9193s/iter; left time: 7167.9006s
Epoch: 45 cost time: 56.09424614906311
Epoch: 45, Steps: 141 | Train Loss: 0.1622402 Vali Loss: 0.1416170 Test Loss: 0.1646931
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1599584
	speed: 0.8634s/iter; left time: 6610.3085s
Epoch: 46 cost time: 53.11629557609558
Epoch: 46, Steps: 141 | Train Loss: 0.1622289 Vali Loss: 0.1415059 Test Loss: 0.1646874
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1626364
	speed: 0.8877s/iter; left time: 6670.7453s
Epoch: 47 cost time: 54.385385513305664
Epoch: 47, Steps: 141 | Train Loss: 0.1622267 Vali Loss: 0.1413649 Test Loss: 0.1646806
Validation loss decreased (0.141398 --> 0.141365).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1643992
	speed: 0.9018s/iter; left time: 6649.8392s
Epoch: 48 cost time: 53.42761182785034
Epoch: 48, Steps: 141 | Train Loss: 0.1622359 Vali Loss: 0.1417766 Test Loss: 0.1646742
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1587707
	speed: 0.8569s/iter; left time: 6198.2754s
Epoch: 49 cost time: 55.02806878089905
Epoch: 49, Steps: 141 | Train Loss: 0.1622512 Vali Loss: 0.1416778 Test Loss: 0.1646730
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1628768
	speed: 0.9272s/iter; left time: 6575.9324s
Epoch: 50 cost time: 55.170114517211914
Epoch: 50, Steps: 141 | Train Loss: 0.1622274 Vali Loss: 0.1413130 Test Loss: 0.1646656
Validation loss decreased (0.141365 --> 0.141313).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1537756
	speed: 0.9147s/iter; left time: 6358.2503s
Epoch: 51 cost time: 54.725549936294556
Epoch: 51, Steps: 141 | Train Loss: 0.1622051 Vali Loss: 0.1414033 Test Loss: 0.1646681
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1666017
	speed: 0.9222s/iter; left time: 6279.9333s
Epoch: 52 cost time: 60.544631004333496
Epoch: 52, Steps: 141 | Train Loss: 0.1622506 Vali Loss: 0.1414663 Test Loss: 0.1646589
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1585576
	speed: 0.9286s/iter; left time: 6192.6320s
Epoch: 53 cost time: 55.25617170333862
Epoch: 53, Steps: 141 | Train Loss: 0.1622025 Vali Loss: 0.1414019 Test Loss: 0.1646631
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1651929
	speed: 0.9096s/iter; left time: 5937.7654s
Epoch: 54 cost time: 56.05533790588379
Epoch: 54, Steps: 141 | Train Loss: 0.1621839 Vali Loss: 0.1413262 Test Loss: 0.1646568
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1663492
	speed: 0.9302s/iter; left time: 5940.9933s
Epoch: 55 cost time: 54.419050455093384
Epoch: 55, Steps: 141 | Train Loss: 0.1621629 Vali Loss: 0.1417160 Test Loss: 0.1646566
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1628054
	speed: 0.8615s/iter; left time: 5380.8076s
Epoch: 56 cost time: 53.72228765487671
Epoch: 56, Steps: 141 | Train Loss: 0.1621577 Vali Loss: 0.1413201 Test Loss: 0.1646547
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1636691
	speed: 0.9117s/iter; left time: 5565.6961s
Epoch: 57 cost time: 55.80264687538147
Epoch: 57, Steps: 141 | Train Loss: 0.1621965 Vali Loss: 0.1412295 Test Loss: 0.1646513
Validation loss decreased (0.141313 --> 0.141229).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1655586
	speed: 0.8788s/iter; left time: 5241.1286s
Epoch: 58 cost time: 54.50487971305847
Epoch: 58, Steps: 141 | Train Loss: 0.1621489 Vali Loss: 0.1414543 Test Loss: 0.1646475
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1698919
	speed: 0.8934s/iter; left time: 5202.2270s
Epoch: 59 cost time: 54.4868905544281
Epoch: 59, Steps: 141 | Train Loss: 0.1621749 Vali Loss: 0.1413331 Test Loss: 0.1646470
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1638554
	speed: 0.8856s/iter; left time: 5032.2289s
Epoch: 60 cost time: 52.05816149711609
Epoch: 60, Steps: 141 | Train Loss: 0.1620920 Vali Loss: 0.1410596 Test Loss: 0.1646488
Validation loss decreased (0.141229 --> 0.141060).  Saving model ...
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1631231
	speed: 0.8989s/iter; left time: 4981.0618s
Epoch: 61 cost time: 54.78862953186035
Epoch: 61, Steps: 141 | Train Loss: 0.1621924 Vali Loss: 0.1416425 Test Loss: 0.1646463
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1727635
	speed: 0.8554s/iter; left time: 4619.0438s
Epoch: 62 cost time: 52.51486849784851
Epoch: 62, Steps: 141 | Train Loss: 0.1621291 Vali Loss: 0.1415997 Test Loss: 0.1646410
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1591705
	speed: 0.8841s/iter; left time: 4649.7074s
Epoch: 63 cost time: 52.95388889312744
Epoch: 63, Steps: 141 | Train Loss: 0.1621277 Vali Loss: 0.1418414 Test Loss: 0.1646408
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1606407
	speed: 0.9037s/iter; left time: 4624.9436s
Epoch: 64 cost time: 54.44608688354492
Epoch: 64, Steps: 141 | Train Loss: 0.1621553 Vali Loss: 0.1417083 Test Loss: 0.1646406
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1502024
	speed: 0.9437s/iter; left time: 4696.6767s
Epoch: 65 cost time: 61.604116439819336
Epoch: 65, Steps: 141 | Train Loss: 0.1621986 Vali Loss: 0.1417161 Test Loss: 0.1646381
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1613047
	speed: 0.9387s/iter; left time: 4539.4184s
Epoch: 66 cost time: 54.128257513046265
Epoch: 66, Steps: 141 | Train Loss: 0.1621502 Vali Loss: 0.1412326 Test Loss: 0.1646373
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1769522
	speed: 0.9726s/iter; left time: 4566.2730s
Epoch: 67 cost time: 59.050174951553345
Epoch: 67, Steps: 141 | Train Loss: 0.1622024 Vali Loss: 0.1417243 Test Loss: 0.1646377
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1544781
	speed: 0.9568s/iter; left time: 4357.3110s
Epoch: 68 cost time: 58.66305732727051
Epoch: 68, Steps: 141 | Train Loss: 0.1621361 Vali Loss: 0.1416489 Test Loss: 0.1646417
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1536399
	speed: 1.0011s/iter; left time: 4417.9029s
Epoch: 69 cost time: 60.71338725090027
Epoch: 69, Steps: 141 | Train Loss: 0.1621640 Vali Loss: 0.1415498 Test Loss: 0.1646372
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1598051
	speed: 0.9412s/iter; left time: 4020.8889s
Epoch: 70 cost time: 56.267338037490845
Epoch: 70, Steps: 141 | Train Loss: 0.1622448 Vali Loss: 0.1414728 Test Loss: 0.1646344
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1515506
	speed: 0.9903s/iter; left time: 4090.8871s
Epoch: 71 cost time: 60.60800647735596
Epoch: 71, Steps: 141 | Train Loss: 0.1622036 Vali Loss: 0.1415091 Test Loss: 0.1646315
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1597926
	speed: 0.9501s/iter; left time: 3790.7601s
Epoch: 72 cost time: 58.03131103515625
Epoch: 72, Steps: 141 | Train Loss: 0.1622228 Vali Loss: 0.1416426 Test Loss: 0.1646327
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1628267
	speed: 0.9795s/iter; left time: 3770.2849s
Epoch: 73 cost time: 59.489957332611084
Epoch: 73, Steps: 141 | Train Loss: 0.1621858 Vali Loss: 0.1413335 Test Loss: 0.1646322
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1660165
	speed: 0.9598s/iter; left time: 3558.9028s
Epoch: 74 cost time: 56.732630491256714
Epoch: 74, Steps: 141 | Train Loss: 0.1622324 Vali Loss: 0.1410925 Test Loss: 0.1646308
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1614992
	speed: 0.9215s/iter; left time: 3287.0768s
Epoch: 75 cost time: 54.4493613243103
Epoch: 75, Steps: 141 | Train Loss: 0.1621791 Vali Loss: 0.1414665 Test Loss: 0.1646304
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1597820
	speed: 0.8623s/iter; left time: 2954.3474s
Epoch: 76 cost time: 54.04714775085449
Epoch: 76, Steps: 141 | Train Loss: 0.1621559 Vali Loss: 0.1414891 Test Loss: 0.1646300
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1561799
	speed: 0.8714s/iter; left time: 2862.6052s
Epoch: 77 cost time: 52.27255606651306
Epoch: 77, Steps: 141 | Train Loss: 0.1621917 Vali Loss: 0.1414702 Test Loss: 0.1646276
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1629344
	speed: 0.8414s/iter; left time: 2645.3413s
Epoch: 78 cost time: 51.483295917510986
Epoch: 78, Steps: 141 | Train Loss: 0.1621491 Vali Loss: 0.1413545 Test Loss: 0.1646271
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1470660
	speed: 0.8978s/iter; left time: 2696.2309s
Epoch: 79 cost time: 55.21559691429138
Epoch: 79, Steps: 141 | Train Loss: 0.1621826 Vali Loss: 0.1417944 Test Loss: 0.1646283
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1623049
	speed: 0.8833s/iter; left time: 2527.8861s
Epoch: 80 cost time: 53.00425577163696
Epoch: 80, Steps: 141 | Train Loss: 0.1621102 Vali Loss: 0.1417466 Test Loss: 0.1646268
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_180_j96_H4_FITS_custom_ftM_sl180_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.1646125614643097, mae:0.26439231634140015, rse:0.40325090289115906, corr:[0.46532667 0.46725878 0.46780062 0.4678698  0.4680807  0.46808422
 0.4677635  0.46760553 0.46768463 0.46741205 0.46684402 0.46664977
 0.46673605 0.4662995  0.46599296 0.46601653 0.46602264 0.46599638
 0.46603113 0.46605426 0.4661362  0.4665435  0.46690497 0.46667045
 0.46605375 0.46588695 0.4657837  0.4655937  0.46547964 0.46543875
 0.46527204 0.4650695  0.465046   0.46505377 0.46483788 0.4646392
 0.46471038 0.46454254 0.4643766  0.46431223 0.46429306 0.4643084
 0.46432608 0.46424708 0.4641431  0.46421534 0.46438572 0.4644065
 0.4641685  0.46409696 0.4640033  0.4639055  0.4638773  0.46388453
 0.46384174 0.46379265 0.4638169  0.4638503  0.46377754 0.46364856
 0.46367332 0.4635687  0.46354988 0.46352986 0.46342075 0.4633663
 0.46334147 0.46321577 0.46308014 0.46314657 0.46323955 0.46316323
 0.4629644  0.46300718 0.4629393  0.46281332 0.46285507 0.46291247
 0.46281713 0.46271056 0.46277225 0.4628166  0.46276638 0.46273455
 0.4627693  0.4625532  0.46253195 0.46267676 0.46258858 0.46234122
 0.4622405  0.4622396  0.462248   0.46236563 0.4625769  0.46259198]
