Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=106, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_360_j96_H6', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_360_j96_H6_FITS_custom_ftM_sl360_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17957
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=106, out_features=134, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  583613952.0
params:  14338.0
Trainable parameters:  14338
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4542749
	speed: 0.5728s/iter; left time: 7962.1886s
Epoch: 1 cost time: 80.1317629814148
Epoch: 1, Steps: 140 | Train Loss: 0.6501794 Vali Loss: 0.2797715 Test Loss: 0.3254478
Validation loss decreased (inf --> 0.279772).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1983278
	speed: 1.2204s/iter; left time: 16794.1804s
Epoch: 2 cost time: 72.6508481502533
Epoch: 2, Steps: 140 | Train Loss: 0.2332846 Vali Loss: 0.1482474 Test Loss: 0.1747387
Validation loss decreased (0.279772 --> 0.148247).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1463605
	speed: 1.1076s/iter; left time: 15086.1624s
Epoch: 3 cost time: 68.16753816604614
Epoch: 3, Steps: 140 | Train Loss: 0.1608487 Vali Loss: 0.1297500 Test Loss: 0.1520909
Validation loss decreased (0.148247 --> 0.129750).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1532835
	speed: 1.1438s/iter; left time: 15419.9141s
Epoch: 4 cost time: 71.0277943611145
Epoch: 4, Steps: 140 | Train Loss: 0.1508798 Vali Loss: 0.1275696 Test Loss: 0.1488782
Validation loss decreased (0.129750 --> 0.127570).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1539138
	speed: 1.1325s/iter; left time: 15108.8175s
Epoch: 5 cost time: 72.80483889579773
Epoch: 5, Steps: 140 | Train Loss: 0.1491034 Vali Loss: 0.1267355 Test Loss: 0.1478996
Validation loss decreased (0.127570 --> 0.126735).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1526010
	speed: 1.1479s/iter; left time: 15153.4743s
Epoch: 6 cost time: 67.61778402328491
Epoch: 6, Steps: 140 | Train Loss: 0.1484431 Vali Loss: 0.1262645 Test Loss: 0.1473739
Validation loss decreased (0.126735 --> 0.126264).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1524778
	speed: 1.1494s/iter; left time: 15011.8411s
Epoch: 7 cost time: 71.77090096473694
Epoch: 7, Steps: 140 | Train Loss: 0.1479620 Vali Loss: 0.1259145 Test Loss: 0.1470150
Validation loss decreased (0.126264 --> 0.125915).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1520547
	speed: 1.1626s/iter; left time: 15022.4270s
Epoch: 8 cost time: 76.21875929832458
Epoch: 8, Steps: 140 | Train Loss: 0.1476413 Vali Loss: 0.1258579 Test Loss: 0.1468084
Validation loss decreased (0.125915 --> 0.125858).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1437743
	speed: 1.1715s/iter; left time: 14973.4040s
Epoch: 9 cost time: 71.89236831665039
Epoch: 9, Steps: 140 | Train Loss: 0.1474201 Vali Loss: 0.1257771 Test Loss: 0.1465423
Validation loss decreased (0.125858 --> 0.125777).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1480459
	speed: 1.1741s/iter; left time: 14841.8807s
Epoch: 10 cost time: 72.4428985118866
Epoch: 10, Steps: 140 | Train Loss: 0.1471536 Vali Loss: 0.1252348 Test Loss: 0.1464234
Validation loss decreased (0.125777 --> 0.125235).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1523467
	speed: 1.1954s/iter; left time: 14944.1135s
Epoch: 11 cost time: 74.499929189682
Epoch: 11, Steps: 140 | Train Loss: 0.1470415 Vali Loss: 0.1254864 Test Loss: 0.1462770
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1647478
	speed: 1.1231s/iter; left time: 13882.2525s
Epoch: 12 cost time: 68.79511022567749
Epoch: 12, Steps: 140 | Train Loss: 0.1469253 Vali Loss: 0.1251008 Test Loss: 0.1461968
Validation loss decreased (0.125235 --> 0.125101).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1418170
	speed: 1.1879s/iter; left time: 14517.1035s
Epoch: 13 cost time: 72.5547297000885
Epoch: 13, Steps: 140 | Train Loss: 0.1468642 Vali Loss: 0.1252753 Test Loss: 0.1461456
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1398178
	speed: 1.1371s/iter; left time: 13737.8980s
Epoch: 14 cost time: 71.67298126220703
Epoch: 14, Steps: 140 | Train Loss: 0.1467524 Vali Loss: 0.1250369 Test Loss: 0.1460767
Validation loss decreased (0.125101 --> 0.125037).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1418716
	speed: 1.2002s/iter; left time: 14331.8144s
Epoch: 15 cost time: 74.15908885002136
Epoch: 15, Steps: 140 | Train Loss: 0.1467218 Vali Loss: 0.1251886 Test Loss: 0.1459987
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1472110
	speed: 1.1753s/iter; left time: 13869.7215s
Epoch: 16 cost time: 70.76047277450562
Epoch: 16, Steps: 140 | Train Loss: 0.1466753 Vali Loss: 0.1251734 Test Loss: 0.1460020
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1469471
	speed: 1.1778s/iter; left time: 13734.1678s
Epoch: 17 cost time: 74.29767727851868
Epoch: 17, Steps: 140 | Train Loss: 0.1466048 Vali Loss: 0.1251574 Test Loss: 0.1459201
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1426022
	speed: 1.1422s/iter; left time: 13159.1883s
Epoch: 18 cost time: 69.34662652015686
Epoch: 18, Steps: 140 | Train Loss: 0.1465334 Vali Loss: 0.1248682 Test Loss: 0.1458966
Validation loss decreased (0.125037 --> 0.124868).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1431029
	speed: 1.1237s/iter; left time: 12789.3817s
Epoch: 19 cost time: 67.91756653785706
Epoch: 19, Steps: 140 | Train Loss: 0.1465193 Vali Loss: 0.1250800 Test Loss: 0.1458644
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1392753
	speed: 1.0646s/iter; left time: 11967.1271s
Epoch: 20 cost time: 67.88577795028687
Epoch: 20, Steps: 140 | Train Loss: 0.1464715 Vali Loss: 0.1249450 Test Loss: 0.1458174
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1576074
	speed: 1.0887s/iter; left time: 12085.2002s
Epoch: 21 cost time: 68.80868172645569
Epoch: 21, Steps: 140 | Train Loss: 0.1464189 Vali Loss: 0.1252250 Test Loss: 0.1458202
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1460408
	speed: 1.0952s/iter; left time: 12004.4421s
Epoch: 22 cost time: 68.97439861297607
Epoch: 22, Steps: 140 | Train Loss: 0.1463659 Vali Loss: 0.1250043 Test Loss: 0.1457691
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1351206
	speed: 1.1472s/iter; left time: 12413.3488s
Epoch: 23 cost time: 72.58360600471497
Epoch: 23, Steps: 140 | Train Loss: 0.1464486 Vali Loss: 0.1253645 Test Loss: 0.1457882
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1547271
	speed: 1.1128s/iter; left time: 11885.4620s
Epoch: 24 cost time: 69.39573860168457
Epoch: 24, Steps: 140 | Train Loss: 0.1464041 Vali Loss: 0.1250743 Test Loss: 0.1457604
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1427787
	speed: 1.1543s/iter; left time: 12167.0850s
Epoch: 25 cost time: 69.72275876998901
Epoch: 25, Steps: 140 | Train Loss: 0.1463780 Vali Loss: 0.1250598 Test Loss: 0.1457336
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1423340
	speed: 1.0939s/iter; left time: 11378.0521s
Epoch: 26 cost time: 68.48481178283691
Epoch: 26, Steps: 140 | Train Loss: 0.1463294 Vali Loss: 0.1250837 Test Loss: 0.1457210
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1549552
	speed: 1.1187s/iter; left time: 11478.5649s
Epoch: 27 cost time: 69.88229942321777
Epoch: 27, Steps: 140 | Train Loss: 0.1463094 Vali Loss: 0.1249138 Test Loss: 0.1456952
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1419904
	speed: 1.1169s/iter; left time: 11303.6483s
Epoch: 28 cost time: 69.00940656661987
Epoch: 28, Steps: 140 | Train Loss: 0.1463513 Vali Loss: 0.1248869 Test Loss: 0.1456833
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1451280
	speed: 1.1484s/iter; left time: 11462.0300s
Epoch: 29 cost time: 69.32216477394104
Epoch: 29, Steps: 140 | Train Loss: 0.1463407 Vali Loss: 0.1248619 Test Loss: 0.1457087
Validation loss decreased (0.124868 --> 0.124862).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1576661
	speed: 1.0696s/iter; left time: 10526.0097s
Epoch: 30 cost time: 69.00301098823547
Epoch: 30, Steps: 140 | Train Loss: 0.1462711 Vali Loss: 0.1251362 Test Loss: 0.1456753
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1397121
	speed: 1.1310s/iter; left time: 10971.4684s
Epoch: 31 cost time: 67.3131456375122
Epoch: 31, Steps: 140 | Train Loss: 0.1462881 Vali Loss: 0.1247001 Test Loss: 0.1456513
Validation loss decreased (0.124862 --> 0.124700).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1542406
	speed: 1.0896s/iter; left time: 10417.6447s
Epoch: 32 cost time: 69.2556893825531
Epoch: 32, Steps: 140 | Train Loss: 0.1462662 Vali Loss: 0.1247996 Test Loss: 0.1456574
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1531907
	speed: 1.1645s/iter; left time: 10970.8693s
Epoch: 33 cost time: 73.08616995811462
Epoch: 33, Steps: 140 | Train Loss: 0.1462782 Vali Loss: 0.1250192 Test Loss: 0.1456283
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1532976
	speed: 1.1622s/iter; left time: 10786.1791s
Epoch: 34 cost time: 76.08872723579407
Epoch: 34, Steps: 140 | Train Loss: 0.1462376 Vali Loss: 0.1249991 Test Loss: 0.1456232
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1431484
	speed: 1.1926s/iter; left time: 10901.9195s
Epoch: 35 cost time: 68.12369894981384
Epoch: 35, Steps: 140 | Train Loss: 0.1462293 Vali Loss: 0.1250208 Test Loss: 0.1456275
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1344694
	speed: 1.1481s/iter; left time: 10333.6599s
Epoch: 36 cost time: 71.92890095710754
Epoch: 36, Steps: 140 | Train Loss: 0.1462065 Vali Loss: 0.1249283 Test Loss: 0.1456176
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1409365
	speed: 1.0738s/iter; left time: 9515.3644s
Epoch: 37 cost time: 66.43088245391846
Epoch: 37, Steps: 140 | Train Loss: 0.1461727 Vali Loss: 0.1250555 Test Loss: 0.1456014
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1493223
	speed: 1.0609s/iter; left time: 9252.4975s
Epoch: 38 cost time: 66.97110533714294
Epoch: 38, Steps: 140 | Train Loss: 0.1461956 Vali Loss: 0.1247563 Test Loss: 0.1456144
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1442154
	speed: 1.0839s/iter; left time: 9301.1622s
Epoch: 39 cost time: 64.98203873634338
Epoch: 39, Steps: 140 | Train Loss: 0.1461997 Vali Loss: 0.1248391 Test Loss: 0.1456088
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1403805
	speed: 1.0453s/iter; left time: 8823.0207s
Epoch: 40 cost time: 66.75012540817261
Epoch: 40, Steps: 140 | Train Loss: 0.1462363 Vali Loss: 0.1247057 Test Loss: 0.1455890
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1465012
	speed: 1.0972s/iter; left time: 9107.7280s
Epoch: 41 cost time: 65.1568992137909
Epoch: 41, Steps: 140 | Train Loss: 0.1462415 Vali Loss: 0.1246364 Test Loss: 0.1455843
Validation loss decreased (0.124700 --> 0.124636).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1498372
	speed: 1.0613s/iter; left time: 8661.1275s
Epoch: 42 cost time: 66.74977135658264
Epoch: 42, Steps: 140 | Train Loss: 0.1461756 Vali Loss: 0.1249195 Test Loss: 0.1455802
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1373710
	speed: 1.0533s/iter; left time: 8448.7052s
Epoch: 43 cost time: 63.91457962989807
Epoch: 43, Steps: 140 | Train Loss: 0.1462029 Vali Loss: 0.1249889 Test Loss: 0.1455869
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1394670
	speed: 1.0351s/iter; left time: 8157.9272s
Epoch: 44 cost time: 66.05082988739014
Epoch: 44, Steps: 140 | Train Loss: 0.1461810 Vali Loss: 0.1249581 Test Loss: 0.1455780
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1399588
	speed: 1.0982s/iter; left time: 8501.2232s
Epoch: 45 cost time: 66.03478479385376
Epoch: 45, Steps: 140 | Train Loss: 0.1461310 Vali Loss: 0.1251245 Test Loss: 0.1455771
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1472986
	speed: 1.0321s/iter; left time: 7844.7332s
Epoch: 46 cost time: 66.28155851364136
Epoch: 46, Steps: 140 | Train Loss: 0.1461118 Vali Loss: 0.1249842 Test Loss: 0.1455647
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1435475
	speed: 1.0724s/iter; left time: 8001.1938s
Epoch: 47 cost time: 62.61491918563843
Epoch: 47, Steps: 140 | Train Loss: 0.1461300 Vali Loss: 0.1248280 Test Loss: 0.1455670
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1475578
	speed: 1.0807s/iter; left time: 7911.8446s
Epoch: 48 cost time: 66.3031210899353
Epoch: 48, Steps: 140 | Train Loss: 0.1461971 Vali Loss: 0.1250191 Test Loss: 0.1455557
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1510991
	speed: 1.0662s/iter; left time: 7656.5049s
Epoch: 49 cost time: 65.58752369880676
Epoch: 49, Steps: 140 | Train Loss: 0.1461665 Vali Loss: 0.1250095 Test Loss: 0.1455517
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1369872
	speed: 1.0489s/iter; left time: 7385.5634s
Epoch: 50 cost time: 65.89858555793762
Epoch: 50, Steps: 140 | Train Loss: 0.1461596 Vali Loss: 0.1247420 Test Loss: 0.1455354
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1404618
	speed: 1.0266s/iter; left time: 7084.5221s
Epoch: 51 cost time: 63.102479457855225
Epoch: 51, Steps: 140 | Train Loss: 0.1461514 Vali Loss: 0.1248810 Test Loss: 0.1455497
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1570410
	speed: 1.0667s/iter; left time: 7212.2190s
Epoch: 52 cost time: 66.08790135383606
Epoch: 52, Steps: 140 | Train Loss: 0.1461644 Vali Loss: 0.1250512 Test Loss: 0.1455490
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1579612
	speed: 1.0152s/iter; left time: 6721.7492s
Epoch: 53 cost time: 60.46934795379639
Epoch: 53, Steps: 140 | Train Loss: 0.1461771 Vali Loss: 0.1247085 Test Loss: 0.1455484
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1409454
	speed: 1.0798s/iter; left time: 6998.2822s
Epoch: 54 cost time: 66.40042662620544
Epoch: 54, Steps: 140 | Train Loss: 0.1461471 Vali Loss: 0.1246844 Test Loss: 0.1455415
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1468902
	speed: 1.0377s/iter; left time: 6580.3194s
Epoch: 55 cost time: 65.82224655151367
Epoch: 55, Steps: 140 | Train Loss: 0.1461435 Vali Loss: 0.1247622 Test Loss: 0.1455431
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1475886
	speed: 1.0839s/iter; left time: 6721.4260s
Epoch: 56 cost time: 67.65245985984802
Epoch: 56, Steps: 140 | Train Loss: 0.1461002 Vali Loss: 0.1249812 Test Loss: 0.1455426
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1396856
	speed: 1.0853s/iter; left time: 6578.1240s
Epoch: 57 cost time: 64.40209937095642
Epoch: 57, Steps: 140 | Train Loss: 0.1461326 Vali Loss: 0.1245683 Test Loss: 0.1455365
Validation loss decreased (0.124636 --> 0.124568).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1442286
	speed: 1.1314s/iter; left time: 6698.8113s
Epoch: 58 cost time: 71.6458203792572
Epoch: 58, Steps: 140 | Train Loss: 0.1461456 Vali Loss: 0.1247814 Test Loss: 0.1455300
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1363872
	speed: 1.0855s/iter; left time: 6274.9984s
Epoch: 59 cost time: 63.719881772994995
Epoch: 59, Steps: 140 | Train Loss: 0.1460872 Vali Loss: 0.1248792 Test Loss: 0.1455299
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1472082
	speed: 1.0839s/iter; left time: 6114.3319s
Epoch: 60 cost time: 68.68720483779907
Epoch: 60, Steps: 140 | Train Loss: 0.1460891 Vali Loss: 0.1249515 Test Loss: 0.1455296
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1468468
	speed: 1.1150s/iter; left time: 6133.6850s
Epoch: 61 cost time: 69.35334062576294
Epoch: 61, Steps: 140 | Train Loss: 0.1461435 Vali Loss: 0.1246165 Test Loss: 0.1455259
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1462402
	speed: 1.0177s/iter; left time: 5456.0042s
Epoch: 62 cost time: 57.07068753242493
Epoch: 62, Steps: 140 | Train Loss: 0.1461257 Vali Loss: 0.1248732 Test Loss: 0.1455285
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1465654
	speed: 0.8597s/iter; left time: 4488.2872s
Epoch: 63 cost time: 52.39153218269348
Epoch: 63, Steps: 140 | Train Loss: 0.1461210 Vali Loss: 0.1247068 Test Loss: 0.1455316
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1428872
	speed: 0.8784s/iter; left time: 4463.3575s
Epoch: 64 cost time: 52.41080451011658
Epoch: 64, Steps: 140 | Train Loss: 0.1461226 Vali Loss: 0.1248470 Test Loss: 0.1455298
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1446728
	speed: 0.8050s/iter; left time: 3977.5997s
Epoch: 65 cost time: 51.29445123672485
Epoch: 65, Steps: 140 | Train Loss: 0.1460826 Vali Loss: 0.1248250 Test Loss: 0.1455280
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1362037
	speed: 0.8303s/iter; left time: 3986.4950s
Epoch: 66 cost time: 50.86368227005005
Epoch: 66, Steps: 140 | Train Loss: 0.1461107 Vali Loss: 0.1248254 Test Loss: 0.1455223
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1490860
	speed: 0.7988s/iter; left time: 3723.2572s
Epoch: 67 cost time: 47.097808837890625
Epoch: 67, Steps: 140 | Train Loss: 0.1461195 Vali Loss: 0.1246465 Test Loss: 0.1455309
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1433160
	speed: 0.7873s/iter; left time: 3559.3822s
Epoch: 68 cost time: 47.32383966445923
Epoch: 68, Steps: 140 | Train Loss: 0.1461138 Vali Loss: 0.1246538 Test Loss: 0.1455230
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1407641
	speed: 0.7398s/iter; left time: 3241.1491s
Epoch: 69 cost time: 47.08817768096924
Epoch: 69, Steps: 140 | Train Loss: 0.1460803 Vali Loss: 0.1248759 Test Loss: 0.1455224
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1487075
	speed: 0.8222s/iter; left time: 3487.0649s
Epoch: 70 cost time: 47.17486619949341
Epoch: 70, Steps: 140 | Train Loss: 0.1461264 Vali Loss: 0.1248600 Test Loss: 0.1455193
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1449757
	speed: 0.7987s/iter; left time: 3275.4788s
Epoch: 71 cost time: 49.95400547981262
Epoch: 71, Steps: 140 | Train Loss: 0.1461316 Vali Loss: 0.1243110 Test Loss: 0.1455199
Validation loss decreased (0.124568 --> 0.124311).  Saving model ...
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1481977
	speed: 0.8067s/iter; left time: 3195.1631s
Epoch: 72 cost time: 50.50578331947327
Epoch: 72, Steps: 140 | Train Loss: 0.1461316 Vali Loss: 0.1247738 Test Loss: 0.1455251
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1479099
	speed: 0.7971s/iter; left time: 3045.7072s
Epoch: 73 cost time: 49.55152082443237
Epoch: 73, Steps: 140 | Train Loss: 0.1461184 Vali Loss: 0.1245169 Test Loss: 0.1455203
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1452940
	speed: 0.8180s/iter; left time: 3010.9148s
Epoch: 74 cost time: 47.57720160484314
Epoch: 74, Steps: 140 | Train Loss: 0.1461152 Vali Loss: 0.1248348 Test Loss: 0.1455153
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1367782
	speed: 0.8116s/iter; left time: 2873.9521s
Epoch: 75 cost time: 53.184300899505615
Epoch: 75, Steps: 140 | Train Loss: 0.1461191 Vali Loss: 0.1247177 Test Loss: 0.1455190
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1529100
	speed: 0.7856s/iter; left time: 2671.7247s
Epoch: 76 cost time: 47.528762102127075
Epoch: 76, Steps: 140 | Train Loss: 0.1461094 Vali Loss: 0.1246429 Test Loss: 0.1455181
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1456536
	speed: 0.8225s/iter; left time: 2682.1533s
Epoch: 77 cost time: 52.39107847213745
Epoch: 77, Steps: 140 | Train Loss: 0.1461136 Vali Loss: 0.1246894 Test Loss: 0.1455151
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1469509
	speed: 0.8182s/iter; left time: 2553.6533s
Epoch: 78 cost time: 47.7030348777771
Epoch: 78, Steps: 140 | Train Loss: 0.1460996 Vali Loss: 0.1246274 Test Loss: 0.1455155
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1424062
	speed: 0.7789s/iter; left time: 2321.9448s
Epoch: 79 cost time: 50.3566677570343
Epoch: 79, Steps: 140 | Train Loss: 0.1461093 Vali Loss: 0.1249117 Test Loss: 0.1455151
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1530176
	speed: 0.7924s/iter; left time: 2251.3161s
Epoch: 80 cost time: 46.877421617507935
Epoch: 80, Steps: 140 | Train Loss: 0.1461331 Vali Loss: 0.1248131 Test Loss: 0.1455164
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.1470927
	speed: 0.8130s/iter; left time: 2196.0139s
Epoch: 81 cost time: 50.72252607345581
Epoch: 81, Steps: 140 | Train Loss: 0.1461120 Vali Loss: 0.1249055 Test Loss: 0.1455142
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1425211
	speed: 0.8102s/iter; left time: 2074.9041s
Epoch: 82 cost time: 49.24300217628479
Epoch: 82, Steps: 140 | Train Loss: 0.1460629 Vali Loss: 0.1244778 Test Loss: 0.1455148
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1397906
	speed: 0.7872s/iter; left time: 1905.9244s
Epoch: 83 cost time: 49.16714406013489
Epoch: 83, Steps: 140 | Train Loss: 0.1460988 Vali Loss: 0.1248389 Test Loss: 0.1455157
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.1677599
	speed: 0.8382s/iter; left time: 1911.8412s
Epoch: 84 cost time: 50.28976082801819
Epoch: 84, Steps: 140 | Train Loss: 0.1460596 Vali Loss: 0.1247597 Test Loss: 0.1455128
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1437043
	speed: 0.8289s/iter; left time: 1774.6002s
Epoch: 85 cost time: 52.45604467391968
Epoch: 85, Steps: 140 | Train Loss: 0.1461221 Vali Loss: 0.1251283 Test Loss: 0.1455139
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.1481323
	speed: 0.8118s/iter; left time: 1624.3321s
Epoch: 86 cost time: 48.82887125015259
Epoch: 86, Steps: 140 | Train Loss: 0.1461090 Vali Loss: 0.1249571 Test Loss: 0.1455136
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.1324426
	speed: 0.8653s/iter; left time: 1610.3605s
Epoch: 87 cost time: 51.887611627578735
Epoch: 87, Steps: 140 | Train Loss: 0.1460565 Vali Loss: 0.1246839 Test Loss: 0.1455136
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.1419255
	speed: 0.8238s/iter; left time: 1417.8158s
Epoch: 88 cost time: 51.77301621437073
Epoch: 88, Steps: 140 | Train Loss: 0.1461266 Vali Loss: 0.1247793 Test Loss: 0.1455126
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.1492726
	speed: 0.8512s/iter; left time: 1345.7126s
Epoch: 89 cost time: 50.10923910140991
Epoch: 89, Steps: 140 | Train Loss: 0.1460701 Vali Loss: 0.1245906 Test Loss: 0.1455123
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.1428994
	speed: 0.8168s/iter; left time: 1177.0183s
Epoch: 90 cost time: 50.89962816238403
Epoch: 90, Steps: 140 | Train Loss: 0.1461242 Vali Loss: 0.1247978 Test Loss: 0.1455122
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.1505382
	speed: 0.8465s/iter; left time: 1101.2947s
Epoch: 91 cost time: 50.906527042388916
Epoch: 91, Steps: 140 | Train Loss: 0.1460958 Vali Loss: 0.1246918 Test Loss: 0.1455126
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_360_j96_H6_FITS_custom_ftM_sl360_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.14522188901901245, mae:0.24492226541042328, rse:0.3787563443183899, corr:[0.4656156  0.46706903 0.46864954 0.46918136 0.46913424 0.4697137
 0.4698485  0.4694706  0.46940696 0.46938097 0.46909449 0.4689098
 0.46885687 0.46873346 0.46862236 0.46856233 0.4684778  0.46840844
 0.46834964 0.46828708 0.46831474 0.46837234 0.4684188  0.4686303
 0.46882862 0.4688793  0.4687402  0.4686913  0.46865642 0.46847036
 0.4682607  0.46820533 0.4681581  0.46801248 0.46786627 0.46781555
 0.4678003  0.46773443 0.4676652  0.467645   0.4676536  0.4676467
 0.46760276 0.46751812 0.46747175 0.46740314 0.4674094  0.4676112
 0.46771178 0.46768332 0.46767822 0.46767315 0.46754274 0.46738237
 0.46736285 0.46735507 0.46723592 0.4671239  0.46710634 0.46712008
 0.4670693  0.4669842  0.46699053 0.4670637  0.46706313 0.46701363
 0.4669826  0.46687073 0.4666889  0.46653914 0.46657035 0.46668455
 0.46661752 0.4665796  0.4666464  0.46658933 0.46640933 0.46637678
 0.46644464 0.46638453 0.4662609  0.4662814  0.46634966 0.46631226
 0.46624458 0.46630886 0.46646914 0.46640927 0.4661787  0.46621624
 0.4662134  0.46564746 0.465528   0.46603644 0.46574676 0.46682262]
