Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_360_j96_H4', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_360_j96_H4_FITS_custom_ftM_sl360_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17957
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=74, out_features=93, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  282767616.0
params:  6975.0
Trainable parameters:  6975
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3302000
	speed: 0.6512s/iter; left time: 9051.9518s
Epoch: 1 cost time: 89.02123856544495
Epoch: 1, Steps: 140 | Train Loss: 0.5116050 Vali Loss: 0.2220931 Test Loss: 0.2528187
Validation loss decreased (inf --> 0.222093).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1785596
	speed: 1.3215s/iter; left time: 18185.1836s
Epoch: 2 cost time: 74.74290943145752
Epoch: 2, Steps: 140 | Train Loss: 0.2010519 Vali Loss: 0.1469691 Test Loss: 0.1702729
Validation loss decreased (0.222093 --> 0.146969).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1645318
	speed: 1.2534s/iter; left time: 17073.2171s
Epoch: 3 cost time: 77.40388369560242
Epoch: 3, Steps: 140 | Train Loss: 0.1648807 Vali Loss: 0.1385341 Test Loss: 0.1607885
Validation loss decreased (0.146969 --> 0.138534).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1612919
	speed: 1.2799s/iter; left time: 17254.2592s
Epoch: 4 cost time: 80.10881972312927
Epoch: 4, Steps: 140 | Train Loss: 0.1603606 Vali Loss: 0.1373381 Test Loss: 0.1590446
Validation loss decreased (0.138534 --> 0.137338).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1621981
	speed: 1.2959s/iter; left time: 17288.6524s
Epoch: 5 cost time: 79.34229373931885
Epoch: 5, Steps: 140 | Train Loss: 0.1592420 Vali Loss: 0.1365483 Test Loss: 0.1583428
Validation loss decreased (0.137338 --> 0.136548).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1587909
	speed: 1.3109s/iter; left time: 17305.6394s
Epoch: 6 cost time: 82.59464812278748
Epoch: 6, Steps: 140 | Train Loss: 0.1586362 Vali Loss: 0.1363592 Test Loss: 0.1579328
Validation loss decreased (0.136548 --> 0.136359).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1469381
	speed: 1.3295s/iter; left time: 17365.0014s
Epoch: 7 cost time: 80.4259934425354
Epoch: 7, Steps: 140 | Train Loss: 0.1582565 Vali Loss: 0.1358892 Test Loss: 0.1576551
Validation loss decreased (0.136359 --> 0.135889).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1622607
	speed: 1.2387s/iter; left time: 16005.4414s
Epoch: 8 cost time: 76.18066763877869
Epoch: 8, Steps: 140 | Train Loss: 0.1579980 Vali Loss: 0.1359407 Test Loss: 0.1574580
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1561973
	speed: 1.3086s/iter; left time: 16725.3863s
Epoch: 9 cost time: 79.47664904594421
Epoch: 9, Steps: 140 | Train Loss: 0.1578064 Vali Loss: 0.1355956 Test Loss: 0.1573690
Validation loss decreased (0.135889 --> 0.135596).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1660107
	speed: 1.2953s/iter; left time: 16374.1981s
Epoch: 10 cost time: 81.58855319023132
Epoch: 10, Steps: 140 | Train Loss: 0.1576396 Vali Loss: 0.1356806 Test Loss: 0.1572476
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1591245
	speed: 1.2991s/iter; left time: 16240.6046s
Epoch: 11 cost time: 81.8677008152008
Epoch: 11, Steps: 140 | Train Loss: 0.1574998 Vali Loss: 0.1355527 Test Loss: 0.1571391
Validation loss decreased (0.135596 --> 0.135553).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1563963
	speed: 1.3594s/iter; left time: 16803.8830s
Epoch: 12 cost time: 83.94233536720276
Epoch: 12, Steps: 140 | Train Loss: 0.1574508 Vali Loss: 0.1355034 Test Loss: 0.1570693
Validation loss decreased (0.135553 --> 0.135503).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1560201
	speed: 1.3373s/iter; left time: 16342.9775s
Epoch: 13 cost time: 76.03271532058716
Epoch: 13, Steps: 140 | Train Loss: 0.1573558 Vali Loss: 0.1354383 Test Loss: 0.1569987
Validation loss decreased (0.135503 --> 0.135438).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1492717
	speed: 1.3291s/iter; left time: 16056.6662s
Epoch: 14 cost time: 80.70412540435791
Epoch: 14, Steps: 140 | Train Loss: 0.1573384 Vali Loss: 0.1350998 Test Loss: 0.1569553
Validation loss decreased (0.135438 --> 0.135100).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1572130
	speed: 1.2448s/iter; left time: 14863.8611s
Epoch: 15 cost time: 78.25023317337036
Epoch: 15, Steps: 140 | Train Loss: 0.1572113 Vali Loss: 0.1352968 Test Loss: 0.1569241
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1562121
	speed: 1.2763s/iter; left time: 15062.1574s
Epoch: 16 cost time: 78.9458110332489
Epoch: 16, Steps: 140 | Train Loss: 0.1572325 Vali Loss: 0.1349171 Test Loss: 0.1568855
Validation loss decreased (0.135100 --> 0.134917).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1764737
	speed: 1.2424s/iter; left time: 14487.8772s
Epoch: 17 cost time: 75.72553372383118
Epoch: 17, Steps: 140 | Train Loss: 0.1570731 Vali Loss: 0.1352655 Test Loss: 0.1569121
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1486560
	speed: 1.3030s/iter; left time: 15012.0877s
Epoch: 18 cost time: 78.58134961128235
Epoch: 18, Steps: 140 | Train Loss: 0.1571795 Vali Loss: 0.1349343 Test Loss: 0.1568416
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1533067
	speed: 1.1833s/iter; left time: 13467.4657s
Epoch: 19 cost time: 74.42850136756897
Epoch: 19, Steps: 140 | Train Loss: 0.1571586 Vali Loss: 0.1351749 Test Loss: 0.1568411
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1545502
	speed: 1.2632s/iter; left time: 14200.1313s
Epoch: 20 cost time: 76.12929487228394
Epoch: 20, Steps: 140 | Train Loss: 0.1570943 Vali Loss: 0.1353137 Test Loss: 0.1568028
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1647744
	speed: 1.2192s/iter; left time: 13534.7317s
Epoch: 21 cost time: 74.02038979530334
Epoch: 21, Steps: 140 | Train Loss: 0.1570559 Vali Loss: 0.1350604 Test Loss: 0.1568260
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1565955
	speed: 1.1886s/iter; left time: 13028.2092s
Epoch: 22 cost time: 77.77616143226624
Epoch: 22, Steps: 140 | Train Loss: 0.1570794 Vali Loss: 0.1351231 Test Loss: 0.1568157
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1701944
	speed: 1.3271s/iter; left time: 14361.0433s
Epoch: 23 cost time: 80.97027564048767
Epoch: 23, Steps: 140 | Train Loss: 0.1570725 Vali Loss: 0.1352183 Test Loss: 0.1568075
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1530896
	speed: 1.3277s/iter; left time: 14181.3832s
Epoch: 24 cost time: 82.54667782783508
Epoch: 24, Steps: 140 | Train Loss: 0.1570448 Vali Loss: 0.1351631 Test Loss: 0.1567595
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1501245
	speed: 1.3072s/iter; left time: 13778.7218s
Epoch: 25 cost time: 79.10463428497314
Epoch: 25, Steps: 140 | Train Loss: 0.1570175 Vali Loss: 0.1350648 Test Loss: 0.1567830
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1428541
	speed: 1.2718s/iter; left time: 13227.8762s
Epoch: 26 cost time: 78.86890959739685
Epoch: 26, Steps: 140 | Train Loss: 0.1570129 Vali Loss: 0.1351366 Test Loss: 0.1567343
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1582790
	speed: 1.3121s/iter; left time: 13463.9403s
Epoch: 27 cost time: 80.4114739894867
Epoch: 27, Steps: 140 | Train Loss: 0.1569792 Vali Loss: 0.1350334 Test Loss: 0.1567436
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1612527
	speed: 1.3303s/iter; left time: 13463.7828s
Epoch: 28 cost time: 81.59013438224792
Epoch: 28, Steps: 140 | Train Loss: 0.1569727 Vali Loss: 0.1351233 Test Loss: 0.1567272
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1595509
	speed: 1.3295s/iter; left time: 13269.8862s
Epoch: 29 cost time: 80.24466156959534
Epoch: 29, Steps: 140 | Train Loss: 0.1569671 Vali Loss: 0.1352114 Test Loss: 0.1567370
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1633076
	speed: 1.2791s/iter; left time: 12587.8780s
Epoch: 30 cost time: 76.3022472858429
Epoch: 30, Steps: 140 | Train Loss: 0.1569604 Vali Loss: 0.1351524 Test Loss: 0.1567275
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1568916
	speed: 1.2508s/iter; left time: 12133.6139s
Epoch: 31 cost time: 77.44988226890564
Epoch: 31, Steps: 140 | Train Loss: 0.1569400 Vali Loss: 0.1349096 Test Loss: 0.1567095
Validation loss decreased (0.134917 --> 0.134910).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1463136
	speed: 1.3041s/iter; left time: 12468.7886s
Epoch: 32 cost time: 77.78414368629456
Epoch: 32, Steps: 140 | Train Loss: 0.1569539 Vali Loss: 0.1350563 Test Loss: 0.1567337
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1460589
	speed: 1.2509s/iter; left time: 11784.9387s
Epoch: 33 cost time: 77.5250916481018
Epoch: 33, Steps: 140 | Train Loss: 0.1569595 Vali Loss: 0.1349497 Test Loss: 0.1567225
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1673318
	speed: 1.2615s/iter; left time: 11708.2779s
Epoch: 34 cost time: 78.5257465839386
Epoch: 34, Steps: 140 | Train Loss: 0.1569231 Vali Loss: 0.1353966 Test Loss: 0.1567057
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1580927
	speed: 1.2876s/iter; left time: 11769.9697s
Epoch: 35 cost time: 78.69317150115967
Epoch: 35, Steps: 140 | Train Loss: 0.1569384 Vali Loss: 0.1350480 Test Loss: 0.1567167
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1644605
	speed: 1.2351s/iter; left time: 11116.7933s
Epoch: 36 cost time: 72.81332921981812
Epoch: 36, Steps: 140 | Train Loss: 0.1569150 Vali Loss: 0.1349940 Test Loss: 0.1567056
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1599404
	speed: 1.2652s/iter; left time: 11210.6208s
Epoch: 37 cost time: 79.30704426765442
Epoch: 37, Steps: 140 | Train Loss: 0.1569288 Vali Loss: 0.1351984 Test Loss: 0.1566900
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1481190
	speed: 1.3261s/iter; left time: 11565.1316s
Epoch: 38 cost time: 77.56921815872192
Epoch: 38, Steps: 140 | Train Loss: 0.1569346 Vali Loss: 0.1349775 Test Loss: 0.1566904
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1581167
	speed: 1.2792s/iter; left time: 10976.8293s
Epoch: 39 cost time: 80.43376731872559
Epoch: 39, Steps: 140 | Train Loss: 0.1569259 Vali Loss: 0.1349416 Test Loss: 0.1566836
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1594867
	speed: 1.2845s/iter; left time: 10842.6450s
Epoch: 40 cost time: 79.90583753585815
Epoch: 40, Steps: 140 | Train Loss: 0.1569167 Vali Loss: 0.1349753 Test Loss: 0.1566815
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1516390
	speed: 1.2639s/iter; left time: 10491.3179s
Epoch: 41 cost time: 75.3992772102356
Epoch: 41, Steps: 140 | Train Loss: 0.1568930 Vali Loss: 0.1350154 Test Loss: 0.1566922
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1419467
	speed: 1.3077s/iter; left time: 10672.4258s
Epoch: 42 cost time: 79.24559545516968
Epoch: 42, Steps: 140 | Train Loss: 0.1569229 Vali Loss: 0.1351362 Test Loss: 0.1566819
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1565689
	speed: 1.2736s/iter; left time: 10215.8305s
Epoch: 43 cost time: 73.8468930721283
Epoch: 43, Steps: 140 | Train Loss: 0.1569509 Vali Loss: 0.1349880 Test Loss: 0.1566846
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1539868
	speed: 1.1753s/iter; left time: 9262.5870s
Epoch: 44 cost time: 73.23773860931396
Epoch: 44, Steps: 140 | Train Loss: 0.1568936 Vali Loss: 0.1348837 Test Loss: 0.1566854
Validation loss decreased (0.134910 --> 0.134884).  Saving model ...
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1460593
	speed: 1.1911s/iter; left time: 9219.9348s
Epoch: 45 cost time: 70.01878523826599
Epoch: 45, Steps: 140 | Train Loss: 0.1568955 Vali Loss: 0.1352995 Test Loss: 0.1566756
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1500445
	speed: 1.1776s/iter; left time: 8950.8734s
Epoch: 46 cost time: 71.3269989490509
Epoch: 46, Steps: 140 | Train Loss: 0.1569016 Vali Loss: 0.1350120 Test Loss: 0.1566744
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1463338
	speed: 1.2218s/iter; left time: 9116.0065s
Epoch: 47 cost time: 88.10043859481812
Epoch: 47, Steps: 140 | Train Loss: 0.1568903 Vali Loss: 0.1350788 Test Loss: 0.1566721
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1693392
	speed: 1.7196s/iter; left time: 12589.0240s
Epoch: 48 cost time: 105.37577533721924
Epoch: 48, Steps: 140 | Train Loss: 0.1569083 Vali Loss: 0.1349376 Test Loss: 0.1566676
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1682845
	speed: 1.6608s/iter; left time: 11926.4332s
Epoch: 49 cost time: 99.41069650650024
Epoch: 49, Steps: 140 | Train Loss: 0.1568561 Vali Loss: 0.1350944 Test Loss: 0.1566764
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1545512
	speed: 1.6084s/iter; left time: 11324.8441s
Epoch: 50 cost time: 97.72153425216675
Epoch: 50, Steps: 140 | Train Loss: 0.1568805 Vali Loss: 0.1350109 Test Loss: 0.1566777
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1582298
	speed: 1.5878s/iter; left time: 10957.5296s
Epoch: 51 cost time: 96.2390627861023
Epoch: 51, Steps: 140 | Train Loss: 0.1568908 Vali Loss: 0.1351075 Test Loss: 0.1566640
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1516860
	speed: 1.5906s/iter; left time: 10753.7456s
Epoch: 52 cost time: 100.64488792419434
Epoch: 52, Steps: 140 | Train Loss: 0.1568578 Vali Loss: 0.1350412 Test Loss: 0.1566689
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1604350
	speed: 1.6340s/iter; left time: 10818.8598s
Epoch: 53 cost time: 98.03254842758179
Epoch: 53, Steps: 140 | Train Loss: 0.1568949 Vali Loss: 0.1350852 Test Loss: 0.1566668
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1644191
	speed: 1.5744s/iter; left time: 10203.4245s
Epoch: 54 cost time: 95.17025995254517
Epoch: 54, Steps: 140 | Train Loss: 0.1569001 Vali Loss: 0.1351742 Test Loss: 0.1566609
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1670585
	speed: 1.5490s/iter; left time: 9822.3329s
Epoch: 55 cost time: 95.04058003425598
Epoch: 55, Steps: 140 | Train Loss: 0.1568976 Vali Loss: 0.1350003 Test Loss: 0.1566626
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1537565
	speed: 1.6038s/iter; left time: 9945.4660s
Epoch: 56 cost time: 98.36029314994812
Epoch: 56, Steps: 140 | Train Loss: 0.1568921 Vali Loss: 0.1350099 Test Loss: 0.1566602
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1591322
	speed: 1.5721s/iter; left time: 9528.3461s
Epoch: 57 cost time: 94.021311044693
Epoch: 57, Steps: 140 | Train Loss: 0.1568899 Vali Loss: 0.1348234 Test Loss: 0.1566606
Validation loss decreased (0.134884 --> 0.134823).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1665172
	speed: 1.5861s/iter; left time: 9391.4930s
Epoch: 58 cost time: 96.84488081932068
Epoch: 58, Steps: 140 | Train Loss: 0.1568962 Vali Loss: 0.1350722 Test Loss: 0.1566540
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1574644
	speed: 1.6459s/iter; left time: 9514.9479s
Epoch: 59 cost time: 100.87678050994873
Epoch: 59, Steps: 140 | Train Loss: 0.1568909 Vali Loss: 0.1351222 Test Loss: 0.1566607
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1584515
	speed: 1.5757s/iter; left time: 8888.4041s
Epoch: 60 cost time: 94.60378837585449
Epoch: 60, Steps: 140 | Train Loss: 0.1568689 Vali Loss: 0.1349298 Test Loss: 0.1566607
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1632770
	speed: 1.5663s/iter; left time: 8616.4421s
Epoch: 61 cost time: 95.87582421302795
Epoch: 61, Steps: 140 | Train Loss: 0.1568795 Vali Loss: 0.1348771 Test Loss: 0.1566576
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1613802
	speed: 1.5504s/iter; left time: 8311.6888s
Epoch: 62 cost time: 94.71376657485962
Epoch: 62, Steps: 140 | Train Loss: 0.1568650 Vali Loss: 0.1350042 Test Loss: 0.1566533
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1653704
	speed: 1.5658s/iter; left time: 8174.7819s
Epoch: 63 cost time: 93.92147445678711
Epoch: 63, Steps: 140 | Train Loss: 0.1568746 Vali Loss: 0.1349978 Test Loss: 0.1566647
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1574724
	speed: 1.5873s/iter; left time: 8065.1170s
Epoch: 64 cost time: 95.45247268676758
Epoch: 64, Steps: 140 | Train Loss: 0.1568655 Vali Loss: 0.1351240 Test Loss: 0.1566584
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1625238
	speed: 1.5116s/iter; left time: 7468.9359s
Epoch: 65 cost time: 92.55736303329468
Epoch: 65, Steps: 140 | Train Loss: 0.1568417 Vali Loss: 0.1348775 Test Loss: 0.1566581
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1507431
	speed: 1.4401s/iter; left time: 6913.8392s
Epoch: 66 cost time: 86.1425576210022
Epoch: 66, Steps: 140 | Train Loss: 0.1568650 Vali Loss: 0.1351531 Test Loss: 0.1566557
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1557498
	speed: 1.3439s/iter; left time: 6263.8254s
Epoch: 67 cost time: 83.1687684059143
Epoch: 67, Steps: 140 | Train Loss: 0.1568455 Vali Loss: 0.1346316 Test Loss: 0.1566548
Validation loss decreased (0.134823 --> 0.134632).  Saving model ...
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1557916
	speed: 1.4740s/iter; left time: 6664.0058s
Epoch: 68 cost time: 92.32838296890259
Epoch: 68, Steps: 140 | Train Loss: 0.1568615 Vali Loss: 0.1348444 Test Loss: 0.1566531
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1631982
	speed: 1.4358s/iter; left time: 6290.3270s
Epoch: 69 cost time: 82.53774619102478
Epoch: 69, Steps: 140 | Train Loss: 0.1568421 Vali Loss: 0.1352135 Test Loss: 0.1566551
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1519848
	speed: 1.3986s/iter; left time: 5931.2916s
Epoch: 70 cost time: 86.94297885894775
Epoch: 70, Steps: 140 | Train Loss: 0.1568568 Vali Loss: 0.1354091 Test Loss: 0.1566518
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1618358
	speed: 1.4206s/iter; left time: 5825.6951s
Epoch: 71 cost time: 86.78203821182251
Epoch: 71, Steps: 140 | Train Loss: 0.1568385 Vali Loss: 0.1350724 Test Loss: 0.1566523
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1681178
	speed: 1.3913s/iter; left time: 5511.1200s
Epoch: 72 cost time: 87.4677038192749
Epoch: 72, Steps: 140 | Train Loss: 0.1568617 Vali Loss: 0.1350753 Test Loss: 0.1566521
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1703065
	speed: 1.4327s/iter; left time: 5474.2765s
Epoch: 73 cost time: 89.47796416282654
Epoch: 73, Steps: 140 | Train Loss: 0.1568407 Vali Loss: 0.1348750 Test Loss: 0.1566518
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1597363
	speed: 1.4372s/iter; left time: 5290.5002s
Epoch: 74 cost time: 85.63944411277771
Epoch: 74, Steps: 140 | Train Loss: 0.1568541 Vali Loss: 0.1350027 Test Loss: 0.1566509
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1568370
	speed: 1.4229s/iter; left time: 5038.6015s
Epoch: 75 cost time: 87.37800765037537
Epoch: 75, Steps: 140 | Train Loss: 0.1567862 Vali Loss: 0.1349240 Test Loss: 0.1566499
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1527433
	speed: 1.3766s/iter; left time: 4681.8610s
Epoch: 76 cost time: 84.08466291427612
Epoch: 76, Steps: 140 | Train Loss: 0.1568527 Vali Loss: 0.1350772 Test Loss: 0.1566501
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1677862
	speed: 1.4198s/iter; left time: 4630.0185s
Epoch: 77 cost time: 89.36433243751526
Epoch: 77, Steps: 140 | Train Loss: 0.1568739 Vali Loss: 0.1350659 Test Loss: 0.1566508
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1714942
	speed: 1.3558s/iter; left time: 4231.4240s
Epoch: 78 cost time: 81.11763286590576
Epoch: 78, Steps: 140 | Train Loss: 0.1568721 Vali Loss: 0.1349304 Test Loss: 0.1566485
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1611800
	speed: 1.2205s/iter; left time: 3638.2175s
Epoch: 79 cost time: 74.17604970932007
Epoch: 79, Steps: 140 | Train Loss: 0.1568302 Vali Loss: 0.1348759 Test Loss: 0.1566499
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1530783
	speed: 1.2838s/iter; left time: 3647.2020s
Epoch: 80 cost time: 76.87932181358337
Epoch: 80, Steps: 140 | Train Loss: 0.1568173 Vali Loss: 0.1349126 Test Loss: 0.1566492
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.1704540
	speed: 1.1794s/iter; left time: 3185.5786s
Epoch: 81 cost time: 70.67719149589539
Epoch: 81, Steps: 140 | Train Loss: 0.1568339 Vali Loss: 0.1351075 Test Loss: 0.1566479
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1488520
	speed: 1.2114s/iter; left time: 3102.3111s
Epoch: 82 cost time: 75.4373414516449
Epoch: 82, Steps: 140 | Train Loss: 0.1567943 Vali Loss: 0.1349723 Test Loss: 0.1566478
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1560575
	speed: 1.2501s/iter; left time: 3026.3804s
Epoch: 83 cost time: 74.85702395439148
Epoch: 83, Steps: 140 | Train Loss: 0.1568855 Vali Loss: 0.1351780 Test Loss: 0.1566487
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.1563971
	speed: 1.2697s/iter; left time: 2896.0773s
Epoch: 84 cost time: 78.61639761924744
Epoch: 84, Steps: 140 | Train Loss: 0.1568339 Vali Loss: 0.1350395 Test Loss: 0.1566496
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1526348
	speed: 1.2467s/iter; left time: 2669.1908s
Epoch: 85 cost time: 77.43209767341614
Epoch: 85, Steps: 140 | Train Loss: 0.1568183 Vali Loss: 0.1350767 Test Loss: 0.1566485
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.1596063
	speed: 1.2875s/iter; left time: 2576.2293s
Epoch: 86 cost time: 76.40018272399902
Epoch: 86, Steps: 140 | Train Loss: 0.1567988 Vali Loss: 0.1349263 Test Loss: 0.1566476
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.1518649
	speed: 1.2679s/iter; left time: 2359.5310s
Epoch: 87 cost time: 77.95651984214783
Epoch: 87, Steps: 140 | Train Loss: 0.1568211 Vali Loss: 0.1351648 Test Loss: 0.1566485
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_360_j96_H4_FITS_custom_ftM_sl360_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.156359001994133, mae:0.2620915174484253, rse:0.39301154017448425, corr:[0.464746   0.46723482 0.46739444 0.46818066 0.4688439  0.4687744
 0.4685064  0.46845874 0.46848136 0.46834052 0.46811268 0.46798903
 0.46797466 0.4679165  0.4677964  0.46769804 0.46764973 0.46762156
 0.46756935 0.46747357 0.46741194 0.4674883  0.4676739  0.4678231
 0.46784815 0.4679439  0.467977   0.46787098 0.46766815 0.46750113
 0.46741036 0.4673724  0.46731195 0.46721092 0.4671013  0.46702456
 0.46696597 0.466888   0.46682864 0.46681356 0.46682036 0.46681413
 0.46675956 0.46663234 0.46652228 0.466519   0.46660504 0.4667089
 0.46677026 0.46685302 0.46687406 0.46677536 0.4666355  0.46654528
 0.4665374  0.4665491  0.4665204  0.4664329  0.4663218  0.46623284
 0.46617794 0.4661417  0.46614388 0.4661763  0.466198   0.46618974
 0.46611124 0.46593848 0.46576992 0.46569592 0.46569565 0.4657382
 0.46578002 0.46583837 0.4658224  0.4657125  0.46560767 0.4655976
 0.4656431  0.46564955 0.46556172 0.4654435  0.4653546  0.465313
 0.46531543 0.4653566  0.46543726 0.46547678 0.46538714 0.465234
 0.46515223 0.4651285  0.46507004 0.46490037 0.4650815  0.4658791 ]
