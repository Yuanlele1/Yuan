Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=26, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_90_j720_H4', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=720, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_90_j720_H4_FITS_custom_ftM_sl90_ll48_pl720_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17603
val 1913
test 4541
Model(
  (freq_upsampler): Linear(in_features=26, out_features=234, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  249979392.0
params:  6318.0
Trainable parameters:  6318
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 1.3308828
	speed: 0.5658s/iter; left time: 7695.6466s
Epoch: 1 cost time: 76.60454654693604
Epoch: 1, Steps: 137 | Train Loss: 1.8654953 Vali Loss: 0.9865226 Test Loss: 1.0900630
Validation loss decreased (inf --> 0.986523).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.7556739
	speed: 1.4399s/iter; left time: 19387.2895s
Epoch: 2 cost time: 83.70608401298523
Epoch: 2, Steps: 137 | Train Loss: 0.8500016 Vali Loss: 0.6020731 Test Loss: 0.6734655
Validation loss decreased (0.986523 --> 0.602073).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.5450682
	speed: 1.3631s/iter; left time: 18165.5981s
Epoch: 3 cost time: 81.43648052215576
Epoch: 3, Steps: 137 | Train Loss: 0.5802352 Vali Loss: 0.4585408 Test Loss: 0.5177612
Validation loss decreased (0.602073 --> 0.458541).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4488130
	speed: 1.4732s/iter; left time: 19431.5726s
Epoch: 4 cost time: 83.04868626594543
Epoch: 4, Steps: 137 | Train Loss: 0.4623720 Vali Loss: 0.3830599 Test Loss: 0.4352220
Validation loss decreased (0.458541 --> 0.383060).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3967824
	speed: 1.4611s/iter; left time: 19071.7735s
Epoch: 5 cost time: 82.76281094551086
Epoch: 5, Steps: 137 | Train Loss: 0.3957503 Vali Loss: 0.3383568 Test Loss: 0.3849809
Validation loss decreased (0.383060 --> 0.338357).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3366574
	speed: 1.5159s/iter; left time: 19579.0892s
Epoch: 6 cost time: 89.06344628334045
Epoch: 6, Steps: 137 | Train Loss: 0.3540795 Vali Loss: 0.3102275 Test Loss: 0.3527195
Validation loss decreased (0.338357 --> 0.310228).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3299952
	speed: 1.4443s/iter; left time: 18457.0827s
Epoch: 7 cost time: 84.04244136810303
Epoch: 7, Steps: 137 | Train Loss: 0.3270320 Vali Loss: 0.2910275 Test Loss: 0.3313357
Validation loss decreased (0.310228 --> 0.291027).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3134805
	speed: 1.4332s/iter; left time: 18119.0896s
Epoch: 8 cost time: 84.68852090835571
Epoch: 8, Steps: 137 | Train Loss: 0.3089414 Vali Loss: 0.2785141 Test Loss: 0.3165458
Validation loss decreased (0.291027 --> 0.278514).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2968437
	speed: 1.4024s/iter; left time: 17536.9915s
Epoch: 9 cost time: 79.72508192062378
Epoch: 9, Steps: 137 | Train Loss: 0.2964136 Vali Loss: 0.2695076 Test Loss: 0.3063529
Validation loss decreased (0.278514 --> 0.269508).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2786547
	speed: 1.4360s/iter; left time: 17760.4698s
Epoch: 10 cost time: 80.3845853805542
Epoch: 10, Steps: 137 | Train Loss: 0.2875815 Vali Loss: 0.2635656 Test Loss: 0.2989340
Validation loss decreased (0.269508 --> 0.263566).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2708985
	speed: 1.4150s/iter; left time: 17306.5072s
Epoch: 11 cost time: 82.22609376907349
Epoch: 11, Steps: 137 | Train Loss: 0.2812045 Vali Loss: 0.2584629 Test Loss: 0.2935201
Validation loss decreased (0.263566 --> 0.258463).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2935632
	speed: 1.4201s/iter; left time: 17174.7703s
Epoch: 12 cost time: 83.1326072216034
Epoch: 12, Steps: 137 | Train Loss: 0.2763877 Vali Loss: 0.2551545 Test Loss: 0.2894216
Validation loss decreased (0.258463 --> 0.255155).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2780516
	speed: 1.4419s/iter; left time: 17240.4064s
Epoch: 13 cost time: 79.47476315498352
Epoch: 13, Steps: 137 | Train Loss: 0.2728212 Vali Loss: 0.2518850 Test Loss: 0.2862493
Validation loss decreased (0.255155 --> 0.251885).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2659526
	speed: 1.4631s/iter; left time: 17294.2590s
Epoch: 14 cost time: 83.0691909790039
Epoch: 14, Steps: 137 | Train Loss: 0.2699286 Vali Loss: 0.2502289 Test Loss: 0.2837161
Validation loss decreased (0.251885 --> 0.250229).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2733753
	speed: 1.4471s/iter; left time: 16906.8686s
Epoch: 15 cost time: 85.66629719734192
Epoch: 15, Steps: 137 | Train Loss: 0.2676204 Vali Loss: 0.2483425 Test Loss: 0.2817079
Validation loss decreased (0.250229 --> 0.248343).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2556637
	speed: 1.4556s/iter; left time: 16806.4018s
Epoch: 16 cost time: 85.23366451263428
Epoch: 16, Steps: 137 | Train Loss: 0.2658426 Vali Loss: 0.2468063 Test Loss: 0.2800560
Validation loss decreased (0.248343 --> 0.246806).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2585720
	speed: 1.4399s/iter; left time: 16427.5076s
Epoch: 17 cost time: 83.16058826446533
Epoch: 17, Steps: 137 | Train Loss: 0.2642761 Vali Loss: 0.2455324 Test Loss: 0.2786660
Validation loss decreased (0.246806 --> 0.245532).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2580424
	speed: 1.3656s/iter; left time: 15392.8091s
Epoch: 18 cost time: 74.4434723854065
Epoch: 18, Steps: 137 | Train Loss: 0.2629820 Vali Loss: 0.2448431 Test Loss: 0.2774834
Validation loss decreased (0.245532 --> 0.244843).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2644346
	speed: 1.4523s/iter; left time: 16171.1631s
Epoch: 19 cost time: 104.38919878005981
Epoch: 19, Steps: 137 | Train Loss: 0.2618709 Vali Loss: 0.2439035 Test Loss: 0.2765014
Validation loss decreased (0.244843 --> 0.243904).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2509877
	speed: 2.1638s/iter; left time: 23797.8067s
Epoch: 20 cost time: 126.13085150718689
Epoch: 20, Steps: 137 | Train Loss: 0.2609849 Vali Loss: 0.2430385 Test Loss: 0.2756484
Validation loss decreased (0.243904 --> 0.243038).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2670722
	speed: 2.2612s/iter; left time: 24558.4161s
Epoch: 21 cost time: 127.83641028404236
Epoch: 21, Steps: 137 | Train Loss: 0.2601332 Vali Loss: 0.2415947 Test Loss: 0.2749541
Validation loss decreased (0.243038 --> 0.241595).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2688617
	speed: 2.1864s/iter; left time: 23447.3420s
Epoch: 22 cost time: 124.27538561820984
Epoch: 22, Steps: 137 | Train Loss: 0.2594167 Vali Loss: 0.2415725 Test Loss: 0.2742547
Validation loss decreased (0.241595 --> 0.241573).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2588446
	speed: 2.1990s/iter; left time: 23280.7213s
Epoch: 23 cost time: 125.42861223220825
Epoch: 23, Steps: 137 | Train Loss: 0.2587175 Vali Loss: 0.2410351 Test Loss: 0.2737032
Validation loss decreased (0.241573 --> 0.241035).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2555712
	speed: 2.1811s/iter; left time: 22792.4002s
Epoch: 24 cost time: 121.62707710266113
Epoch: 24, Steps: 137 | Train Loss: 0.2582613 Vali Loss: 0.2408904 Test Loss: 0.2732019
Validation loss decreased (0.241035 --> 0.240890).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2517220
	speed: 2.2295s/iter; left time: 22992.6715s
Epoch: 25 cost time: 124.08425545692444
Epoch: 25, Steps: 137 | Train Loss: 0.2577026 Vali Loss: 0.2399655 Test Loss: 0.2727407
Validation loss decreased (0.240890 --> 0.239965).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2598724
	speed: 2.1913s/iter; left time: 22298.8130s
Epoch: 26 cost time: 122.67982316017151
Epoch: 26, Steps: 137 | Train Loss: 0.2572967 Vali Loss: 0.2394982 Test Loss: 0.2723353
Validation loss decreased (0.239965 --> 0.239498).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2583556
	speed: 2.1515s/iter; left time: 21599.0942s
Epoch: 27 cost time: 123.67803239822388
Epoch: 27, Steps: 137 | Train Loss: 0.2569280 Vali Loss: 0.2394520 Test Loss: 0.2719890
Validation loss decreased (0.239498 --> 0.239452).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2536720
	speed: 2.1473s/iter; left time: 21262.3635s
Epoch: 28 cost time: 121.2027702331543
Epoch: 28, Steps: 137 | Train Loss: 0.2566010 Vali Loss: 0.2391428 Test Loss: 0.2716439
Validation loss decreased (0.239452 --> 0.239143).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2533837
	speed: 2.2060s/iter; left time: 21541.8570s
Epoch: 29 cost time: 118.63293218612671
Epoch: 29, Steps: 137 | Train Loss: 0.2563074 Vali Loss: 0.2383957 Test Loss: 0.2713754
Validation loss decreased (0.239143 --> 0.238396).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2613665
	speed: 1.4873s/iter; left time: 14319.9816s
Epoch: 30 cost time: 86.51298713684082
Epoch: 30, Steps: 137 | Train Loss: 0.2558512 Vali Loss: 0.2390194 Test Loss: 0.2710803
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2529079
	speed: 1.4230s/iter; left time: 13505.2936s
Epoch: 31 cost time: 80.40525269508362
Epoch: 31, Steps: 137 | Train Loss: 0.2557758 Vali Loss: 0.2385211 Test Loss: 0.2708552
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2490489
	speed: 1.3821s/iter; left time: 12927.9773s
Epoch: 32 cost time: 86.04676938056946
Epoch: 32, Steps: 137 | Train Loss: 0.2555204 Vali Loss: 0.2386919 Test Loss: 0.2706074
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2569957
	speed: 1.6475s/iter; left time: 15185.3392s
Epoch: 33 cost time: 97.00971722602844
Epoch: 33, Steps: 137 | Train Loss: 0.2552403 Vali Loss: 0.2376421 Test Loss: 0.2704017
Validation loss decreased (0.238396 --> 0.237642).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2502404
	speed: 1.8036s/iter; left time: 16376.9593s
Epoch: 34 cost time: 108.43220901489258
Epoch: 34, Steps: 137 | Train Loss: 0.2550587 Vali Loss: 0.2375713 Test Loss: 0.2702263
Validation loss decreased (0.237642 --> 0.237571).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2538944
	speed: 1.6748s/iter; left time: 14977.3998s
Epoch: 35 cost time: 97.41046333312988
Epoch: 35, Steps: 137 | Train Loss: 0.2548983 Vali Loss: 0.2375024 Test Loss: 0.2700500
Validation loss decreased (0.237571 --> 0.237502).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2537948
	speed: 1.6213s/iter; left time: 14277.4950s
Epoch: 36 cost time: 92.97539973258972
Epoch: 36, Steps: 137 | Train Loss: 0.2547104 Vali Loss: 0.2376339 Test Loss: 0.2699006
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2639272
	speed: 1.6773s/iter; left time: 14540.9462s
Epoch: 37 cost time: 99.32939147949219
Epoch: 37, Steps: 137 | Train Loss: 0.2545148 Vali Loss: 0.2374022 Test Loss: 0.2697486
Validation loss decreased (0.237502 --> 0.237402).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2643137
	speed: 1.6331s/iter; left time: 13933.3953s
Epoch: 38 cost time: 92.13616108894348
Epoch: 38, Steps: 137 | Train Loss: 0.2543154 Vali Loss: 0.2372438 Test Loss: 0.2695969
Validation loss decreased (0.237402 --> 0.237244).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2550910
	speed: 1.6425s/iter; left time: 13789.1415s
Epoch: 39 cost time: 97.87903833389282
Epoch: 39, Steps: 137 | Train Loss: 0.2542928 Vali Loss: 0.2373358 Test Loss: 0.2694545
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2463235
	speed: 1.6750s/iter; left time: 13832.4159s
Epoch: 40 cost time: 97.92312908172607
Epoch: 40, Steps: 137 | Train Loss: 0.2540177 Vali Loss: 0.2372398 Test Loss: 0.2693304
Validation loss decreased (0.237244 --> 0.237240).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2452602
	speed: 1.5263s/iter; left time: 12395.0169s
Epoch: 41 cost time: 83.97113084793091
Epoch: 41, Steps: 137 | Train Loss: 0.2540254 Vali Loss: 0.2375330 Test Loss: 0.2692187
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2692952
	speed: 1.4190s/iter; left time: 11329.6481s
Epoch: 42 cost time: 83.45126438140869
Epoch: 42, Steps: 137 | Train Loss: 0.2539058 Vali Loss: 0.2369427 Test Loss: 0.2691087
Validation loss decreased (0.237240 --> 0.236943).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2561117
	speed: 1.4208s/iter; left time: 11149.3014s
Epoch: 43 cost time: 81.41079115867615
Epoch: 43, Steps: 137 | Train Loss: 0.2537876 Vali Loss: 0.2368287 Test Loss: 0.2690060
Validation loss decreased (0.236943 --> 0.236829).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2462778
	speed: 1.4389s/iter; left time: 11093.8565s
Epoch: 44 cost time: 84.77579021453857
Epoch: 44, Steps: 137 | Train Loss: 0.2537548 Vali Loss: 0.2371412 Test Loss: 0.2689210
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2572648
	speed: 1.4244s/iter; left time: 10787.1365s
Epoch: 45 cost time: 80.29523634910583
Epoch: 45, Steps: 137 | Train Loss: 0.2535813 Vali Loss: 0.2364956 Test Loss: 0.2688180
Validation loss decreased (0.236829 --> 0.236496).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2459875
	speed: 1.3369s/iter; left time: 9941.2286s
Epoch: 46 cost time: 77.0520453453064
Epoch: 46, Steps: 137 | Train Loss: 0.2534992 Vali Loss: 0.2368861 Test Loss: 0.2687281
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2565856
	speed: 1.3212s/iter; left time: 9643.3905s
Epoch: 47 cost time: 76.38402652740479
Epoch: 47, Steps: 137 | Train Loss: 0.2533518 Vali Loss: 0.2368569 Test Loss: 0.2686455
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2592039
	speed: 1.2971s/iter; left time: 9289.8108s
Epoch: 48 cost time: 74.95146751403809
Epoch: 48, Steps: 137 | Train Loss: 0.2532785 Vali Loss: 0.2363028 Test Loss: 0.2685804
Validation loss decreased (0.236496 --> 0.236303).  Saving model ...
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2705416
	speed: 1.2801s/iter; left time: 8992.9257s
Epoch: 49 cost time: 75.51492810249329
Epoch: 49, Steps: 137 | Train Loss: 0.2532639 Vali Loss: 0.2365301 Test Loss: 0.2684995
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2459635
	speed: 1.3075s/iter; left time: 9005.7687s
Epoch: 50 cost time: 74.80887699127197
Epoch: 50, Steps: 137 | Train Loss: 0.2531363 Vali Loss: 0.2364218 Test Loss: 0.2684344
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2544447
	speed: 1.2761s/iter; left time: 8615.2599s
Epoch: 51 cost time: 74.74645757675171
Epoch: 51, Steps: 137 | Train Loss: 0.2531207 Vali Loss: 0.2364024 Test Loss: 0.2683697
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2535528
	speed: 1.3231s/iter; left time: 8751.1808s
Epoch: 52 cost time: 76.19526410102844
Epoch: 52, Steps: 137 | Train Loss: 0.2529889 Vali Loss: 0.2361146 Test Loss: 0.2682993
Validation loss decreased (0.236303 --> 0.236115).  Saving model ...
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2442532
	speed: 1.3414s/iter; left time: 8688.2008s
Epoch: 53 cost time: 75.03685140609741
Epoch: 53, Steps: 137 | Train Loss: 0.2529393 Vali Loss: 0.2357522 Test Loss: 0.2682413
Validation loss decreased (0.236115 --> 0.235752).  Saving model ...
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2645751
	speed: 1.2996s/iter; left time: 8239.4041s
Epoch: 54 cost time: 73.98173570632935
Epoch: 54, Steps: 137 | Train Loss: 0.2528455 Vali Loss: 0.2359407 Test Loss: 0.2681942
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2609367
	speed: 1.3017s/iter; left time: 8074.3140s
Epoch: 55 cost time: 75.06234645843506
Epoch: 55, Steps: 137 | Train Loss: 0.2528263 Vali Loss: 0.2358694 Test Loss: 0.2681432
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.2467184
	speed: 1.2668s/iter; left time: 7684.3691s
Epoch: 56 cost time: 73.33175325393677
Epoch: 56, Steps: 137 | Train Loss: 0.2528185 Vali Loss: 0.2358449 Test Loss: 0.2680901
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2551170
	speed: 1.3055s/iter; left time: 7740.3509s
Epoch: 57 cost time: 76.37657403945923
Epoch: 57, Steps: 137 | Train Loss: 0.2527000 Vali Loss: 0.2356535 Test Loss: 0.2680412
Validation loss decreased (0.235752 --> 0.235654).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2527938
	speed: 1.3687s/iter; left time: 7927.5453s
Epoch: 58 cost time: 78.70659828186035
Epoch: 58, Steps: 137 | Train Loss: 0.2527296 Vali Loss: 0.2363226 Test Loss: 0.2680055
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2719699
	speed: 1.2976s/iter; left time: 7338.1245s
Epoch: 59 cost time: 72.45750045776367
Epoch: 59, Steps: 137 | Train Loss: 0.2526170 Vali Loss: 0.2355315 Test Loss: 0.2679628
Validation loss decreased (0.235654 --> 0.235532).  Saving model ...
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.2511240
	speed: 1.3310s/iter; left time: 7344.7205s
Epoch: 60 cost time: 80.46677732467651
Epoch: 60, Steps: 137 | Train Loss: 0.2526298 Vali Loss: 0.2359293 Test Loss: 0.2679170
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2519957
	speed: 1.4846s/iter; left time: 7988.8481s
Epoch: 61 cost time: 85.87090921401978
Epoch: 61, Steps: 137 | Train Loss: 0.2524995 Vali Loss: 0.2359947 Test Loss: 0.2678775
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2590870
	speed: 1.5129s/iter; left time: 7933.3870s
Epoch: 62 cost time: 87.1819999217987
Epoch: 62, Steps: 137 | Train Loss: 0.2525596 Vali Loss: 0.2353520 Test Loss: 0.2678403
Validation loss decreased (0.235532 --> 0.235352).  Saving model ...
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2549320
	speed: 1.5125s/iter; left time: 7724.4435s
Epoch: 63 cost time: 89.11632633209229
Epoch: 63, Steps: 137 | Train Loss: 0.2524473 Vali Loss: 0.2360425 Test Loss: 0.2678083
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2565732
	speed: 1.5297s/iter; left time: 7602.3661s
Epoch: 64 cost time: 88.20803999900818
Epoch: 64, Steps: 137 | Train Loss: 0.2524738 Vali Loss: 0.2359436 Test Loss: 0.2677828
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2529204
	speed: 1.2691s/iter; left time: 6133.7146s
Epoch: 65 cost time: 70.38557720184326
Epoch: 65, Steps: 137 | Train Loss: 0.2524105 Vali Loss: 0.2354539 Test Loss: 0.2677487
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2642950
	speed: 1.2061s/iter; left time: 5663.6247s
Epoch: 66 cost time: 68.64881134033203
Epoch: 66, Steps: 137 | Train Loss: 0.2523863 Vali Loss: 0.2350573 Test Loss: 0.2677253
Validation loss decreased (0.235352 --> 0.235057).  Saving model ...
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2508821
	speed: 1.0645s/iter; left time: 4852.8375s
Epoch: 67 cost time: 58.80063462257385
Epoch: 67, Steps: 137 | Train Loss: 0.2524038 Vali Loss: 0.2351602 Test Loss: 0.2676995
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2540767
	speed: 1.0348s/iter; left time: 4576.0727s
Epoch: 68 cost time: 61.044129848480225
Epoch: 68, Steps: 137 | Train Loss: 0.2522786 Vali Loss: 0.2358360 Test Loss: 0.2676731
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2489209
	speed: 1.1425s/iter; left time: 4895.6013s
Epoch: 69 cost time: 65.92776775360107
Epoch: 69, Steps: 137 | Train Loss: 0.2523156 Vali Loss: 0.2356957 Test Loss: 0.2676471
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2486760
	speed: 1.1284s/iter; left time: 4680.7048s
Epoch: 70 cost time: 64.14761281013489
Epoch: 70, Steps: 137 | Train Loss: 0.2522461 Vali Loss: 0.2355025 Test Loss: 0.2676267
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2598623
	speed: 1.1269s/iter; left time: 4520.0943s
Epoch: 71 cost time: 63.545204401016235
Epoch: 71, Steps: 137 | Train Loss: 0.2522033 Vali Loss: 0.2355897 Test Loss: 0.2676085
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2548193
	speed: 1.1021s/iter; left time: 4269.5221s
Epoch: 72 cost time: 63.623358726501465
Epoch: 72, Steps: 137 | Train Loss: 0.2522496 Vali Loss: 0.2351723 Test Loss: 0.2675815
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.2509525
	speed: 1.1042s/iter; left time: 4126.3289s
Epoch: 73 cost time: 65.23075819015503
Epoch: 73, Steps: 137 | Train Loss: 0.2522745 Vali Loss: 0.2351005 Test Loss: 0.2675635
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.2483951
	speed: 1.1422s/iter; left time: 4111.8432s
Epoch: 74 cost time: 63.18268966674805
Epoch: 74, Steps: 137 | Train Loss: 0.2521436 Vali Loss: 0.2354269 Test Loss: 0.2675456
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2398682
	speed: 1.1255s/iter; left time: 3897.4474s
Epoch: 75 cost time: 62.74168419837952
Epoch: 75, Steps: 137 | Train Loss: 0.2521695 Vali Loss: 0.2351997 Test Loss: 0.2675304
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.2484142
	speed: 1.1387s/iter; left time: 3787.3855s
Epoch: 76 cost time: 61.95902109146118
Epoch: 76, Steps: 137 | Train Loss: 0.2521238 Vali Loss: 0.2354739 Test Loss: 0.2675146
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2607398
	speed: 1.0054s/iter; left time: 3206.1907s
Epoch: 77 cost time: 53.252289056777954
Epoch: 77, Steps: 137 | Train Loss: 0.2522075 Vali Loss: 0.2357132 Test Loss: 0.2675004
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2559684
	speed: 0.8925s/iter; left time: 2724.0321s
Epoch: 78 cost time: 47.66366362571716
Epoch: 78, Steps: 137 | Train Loss: 0.2520634 Vali Loss: 0.2356682 Test Loss: 0.2674851
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.2449942
	speed: 0.9137s/iter; left time: 2663.4258s
Epoch: 79 cost time: 54.27821493148804
Epoch: 79, Steps: 137 | Train Loss: 0.2520661 Vali Loss: 0.2355968 Test Loss: 0.2674725
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.2513472
	speed: 1.3203s/iter; left time: 3667.7544s
Epoch: 80 cost time: 70.35387706756592
Epoch: 80, Steps: 137 | Train Loss: 0.2520358 Vali Loss: 0.2355885 Test Loss: 0.2674590
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.2499439
	speed: 0.8745s/iter; left time: 2309.5856s
Epoch: 81 cost time: 50.341752767562866
Epoch: 81, Steps: 137 | Train Loss: 0.2520993 Vali Loss: 0.2352530 Test Loss: 0.2674496
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.2506032
	speed: 1.0207s/iter; left time: 2555.9539s
Epoch: 82 cost time: 62.47295022010803
Epoch: 82, Steps: 137 | Train Loss: 0.2519762 Vali Loss: 0.2346353 Test Loss: 0.2674362
Validation loss decreased (0.235057 --> 0.234635).  Saving model ...
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.2719530
	speed: 0.9939s/iter; left time: 2352.5815s
Epoch: 83 cost time: 54.119518995285034
Epoch: 83, Steps: 137 | Train Loss: 0.2521192 Vali Loss: 0.2356679 Test Loss: 0.2674249
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.2673412
	speed: 0.9722s/iter; left time: 2167.9499s
Epoch: 84 cost time: 55.2096745967865
Epoch: 84, Steps: 137 | Train Loss: 0.2519321 Vali Loss: 0.2349052 Test Loss: 0.2674145
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.2545886
	speed: 0.9531s/iter; left time: 1994.9401s
Epoch: 85 cost time: 54.90881037712097
Epoch: 85, Steps: 137 | Train Loss: 0.2520470 Vali Loss: 0.2355972 Test Loss: 0.2674052
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.2620054
	speed: 0.9855s/iter; left time: 1927.5650s
Epoch: 86 cost time: 54.26395773887634
Epoch: 86, Steps: 137 | Train Loss: 0.2520940 Vali Loss: 0.2353446 Test Loss: 0.2673956
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.2416987
	speed: 0.9626s/iter; left time: 1750.9988s
Epoch: 87 cost time: 55.16734075546265
Epoch: 87, Steps: 137 | Train Loss: 0.2519470 Vali Loss: 0.2355842 Test Loss: 0.2673889
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.2483444
	speed: 0.9674s/iter; left time: 1627.1285s
Epoch: 88 cost time: 55.51878094673157
Epoch: 88, Steps: 137 | Train Loss: 0.2520010 Vali Loss: 0.2350948 Test Loss: 0.2673793
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.2610857
	speed: 0.9338s/iter; left time: 1442.6449s
Epoch: 89 cost time: 53.25614833831787
Epoch: 89, Steps: 137 | Train Loss: 0.2519778 Vali Loss: 0.2354456 Test Loss: 0.2673721
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.2426375
	speed: 0.9648s/iter; left time: 1358.4386s
Epoch: 90 cost time: 54.40736174583435
Epoch: 90, Steps: 137 | Train Loss: 0.2520007 Vali Loss: 0.2348790 Test Loss: 0.2673654
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.2539523
	speed: 0.9632s/iter; left time: 1224.1718s
Epoch: 91 cost time: 54.548269748687744
Epoch: 91, Steps: 137 | Train Loss: 0.2519663 Vali Loss: 0.2351751 Test Loss: 0.2673596
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.944182354829475e-06
	iters: 100, epoch: 92 | loss: 0.2415635
	speed: 1.0051s/iter; left time: 1139.7820s
Epoch: 92 cost time: 55.25273132324219
Epoch: 92, Steps: 137 | Train Loss: 0.2519808 Vali Loss: 0.2356946 Test Loss: 0.2673526
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.696973237088e-06
	iters: 100, epoch: 93 | loss: 0.2572194
	speed: 1.0442s/iter; left time: 1041.0453s
Epoch: 93 cost time: 64.00959825515747
Epoch: 93, Steps: 137 | Train Loss: 0.2519397 Vali Loss: 0.2349361 Test Loss: 0.2673464
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.462124575233601e-06
	iters: 100, epoch: 94 | loss: 0.2408924
	speed: 1.1123s/iter; left time: 956.5926s
Epoch: 94 cost time: 61.45357060432434
Epoch: 94, Steps: 137 | Train Loss: 0.2520084 Vali Loss: 0.2351315 Test Loss: 0.2673410
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.239018346471921e-06
	iters: 100, epoch: 95 | loss: 0.2509338
	speed: 1.1872s/iter; left time: 858.3164s
Epoch: 95 cost time: 66.256338596344
Epoch: 95, Steps: 137 | Train Loss: 0.2519409 Vali Loss: 0.2355899 Test Loss: 0.2673355
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.027067429148324e-06
	iters: 100, epoch: 96 | loss: 0.2479647
	speed: 1.0529s/iter; left time: 616.9978s
Epoch: 96 cost time: 58.60206174850464
Epoch: 96, Steps: 137 | Train Loss: 0.2519553 Vali Loss: 0.2350093 Test Loss: 0.2673306
EarlyStopping counter: 14 out of 20
Updating learning rate to 3.825714057690908e-06
	iters: 100, epoch: 97 | loss: 0.2502194
	speed: 0.9891s/iter; left time: 444.0836s
Epoch: 97 cost time: 55.421162843704224
Epoch: 97, Steps: 137 | Train Loss: 0.2519530 Vali Loss: 0.2355111 Test Loss: 0.2673256
EarlyStopping counter: 15 out of 20
Updating learning rate to 3.6344283548063623e-06
	iters: 100, epoch: 98 | loss: 0.2648839
	speed: 0.9852s/iter; left time: 307.3764s
Epoch: 98 cost time: 53.83559465408325
Epoch: 98, Steps: 137 | Train Loss: 0.2518595 Vali Loss: 0.2355238 Test Loss: 0.2673205
EarlyStopping counter: 16 out of 20
Updating learning rate to 3.452706937066044e-06
	iters: 100, epoch: 99 | loss: 0.2508924
	speed: 0.8319s/iter; left time: 145.5757s
Epoch: 99 cost time: 45.42620301246643
Epoch: 99, Steps: 137 | Train Loss: 0.2519048 Vali Loss: 0.2353423 Test Loss: 0.2673168
EarlyStopping counter: 17 out of 20
Updating learning rate to 3.2800715902127414e-06
	iters: 100, epoch: 100 | loss: 0.2536138
	speed: 0.8381s/iter; left time: 31.8480s
Epoch: 100 cost time: 48.81937265396118
Epoch: 100, Steps: 137 | Train Loss: 0.2519454 Vali Loss: 0.2351787 Test Loss: 0.2673125
EarlyStopping counter: 18 out of 20
Updating learning rate to 3.1160680107021042e-06
train 17603
val 1913
test 4541
Model(
  (freq_upsampler): Linear(in_features=26, out_features=234, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  249979392.0
params:  6318.0
Trainable parameters:  6318
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2795079
	speed: 0.3648s/iter; left time: 4961.5124s
Epoch: 1 cost time: 50.119747161865234
Epoch: 1, Steps: 137 | Train Loss: 0.2799826 Vali Loss: 0.2345252 Test Loss: 0.2664210
Validation loss decreased (inf --> 0.234525).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2672195
	speed: 0.8859s/iter; left time: 11927.8694s
Epoch: 2 cost time: 47.711153507232666
Epoch: 2, Steps: 137 | Train Loss: 0.2796161 Vali Loss: 0.2339578 Test Loss: 0.2663296
Validation loss decreased (0.234525 --> 0.233958).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2838007
	speed: 0.8376s/iter; left time: 11162.1500s
Epoch: 3 cost time: 49.816442251205444
Epoch: 3, Steps: 137 | Train Loss: 0.2794650 Vali Loss: 0.2340647 Test Loss: 0.2662070
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2679414
	speed: 1.0571s/iter; left time: 13943.3148s
Epoch: 4 cost time: 63.65804672241211
Epoch: 4, Steps: 137 | Train Loss: 0.2794266 Vali Loss: 0.2337497 Test Loss: 0.2662332
Validation loss decreased (0.233958 --> 0.233750).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2771837
	speed: 0.9365s/iter; left time: 12224.1226s
Epoch: 5 cost time: 44.78587222099304
