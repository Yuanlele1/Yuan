Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_180_j96_H8', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_180_j96_H8_FITS_custom_ftM_sl180_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18137
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=74, out_features=113, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  343577856.0
params:  8475.0
Trainable parameters:  8475
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3443923
	speed: 0.4751s/iter; left time: 6651.6640s
Epoch: 1 cost time: 65.52381086349487
Epoch: 1, Steps: 141 | Train Loss: 0.5313617 Vali Loss: 0.2482077 Test Loss: 0.2718980
Validation loss decreased (inf --> 0.248208).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2218958
	speed: 1.0416s/iter; left time: 14436.1821s
Epoch: 2 cost time: 64.85207438468933
Epoch: 2, Steps: 141 | Train Loss: 0.2331139 Vali Loss: 0.1765427 Test Loss: 0.1996964
Validation loss decreased (0.248208 --> 0.176543).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1742645
	speed: 1.0500s/iter; left time: 14404.5399s
Epoch: 3 cost time: 60.261311531066895
Epoch: 3, Steps: 141 | Train Loss: 0.1860315 Vali Loss: 0.1522483 Test Loss: 0.1760313
Validation loss decreased (0.176543 --> 0.152248).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1619228
	speed: 0.9603s/iter; left time: 13038.5664s
Epoch: 4 cost time: 59.640706300735474
Epoch: 4, Steps: 141 | Train Loss: 0.1690599 Vali Loss: 0.1433962 Test Loss: 0.1668645
Validation loss decreased (0.152248 --> 0.143396).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1668929
	speed: 1.0504s/iter; left time: 14114.0978s
Epoch: 5 cost time: 63.88473629951477
Epoch: 5, Steps: 141 | Train Loss: 0.1624845 Vali Loss: 0.1397656 Test Loss: 0.1629346
Validation loss decreased (0.143396 --> 0.139766).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1601469
	speed: 1.0596s/iter; left time: 14088.8487s
Epoch: 6 cost time: 64.0839262008667
Epoch: 6, Steps: 141 | Train Loss: 0.1595530 Vali Loss: 0.1380429 Test Loss: 0.1608748
Validation loss decreased (0.139766 --> 0.138043).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1664977
	speed: 1.0654s/iter; left time: 14015.8469s
Epoch: 7 cost time: 65.49268937110901
Epoch: 7, Steps: 141 | Train Loss: 0.1579422 Vali Loss: 0.1367148 Test Loss: 0.1595833
Validation loss decreased (0.138043 --> 0.136715).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1628378
	speed: 0.9739s/iter; left time: 12673.7435s
Epoch: 8 cost time: 58.06350660324097
Epoch: 8, Steps: 141 | Train Loss: 0.1568605 Vali Loss: 0.1361987 Test Loss: 0.1587002
Validation loss decreased (0.136715 --> 0.136199).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1598202
	speed: 1.0054s/iter; left time: 12942.9667s
Epoch: 9 cost time: 60.95724391937256
Epoch: 9, Steps: 141 | Train Loss: 0.1561783 Vali Loss: 0.1355194 Test Loss: 0.1580573
Validation loss decreased (0.136199 --> 0.135519).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1544467
	speed: 0.7901s/iter; left time: 10059.2594s
Epoch: 10 cost time: 39.13416862487793
Epoch: 10, Steps: 141 | Train Loss: 0.1555907 Vali Loss: 0.1351838 Test Loss: 0.1575887
Validation loss decreased (0.135519 --> 0.135184).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1516423
	speed: 0.6529s/iter; left time: 8220.9613s
Epoch: 11 cost time: 36.694764375686646
Epoch: 11, Steps: 141 | Train Loss: 0.1551799 Vali Loss: 0.1345983 Test Loss: 0.1572058
Validation loss decreased (0.135184 --> 0.134598).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1555683
	speed: 0.6307s/iter; left time: 7852.3232s
Epoch: 12 cost time: 39.359588861465454
Epoch: 12, Steps: 141 | Train Loss: 0.1548630 Vali Loss: 0.1342011 Test Loss: 0.1569161
Validation loss decreased (0.134598 --> 0.134201).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1547354
	speed: 0.6106s/iter; left time: 7515.9152s
Epoch: 13 cost time: 36.76064205169678
Epoch: 13, Steps: 141 | Train Loss: 0.1546757 Vali Loss: 0.1340676 Test Loss: 0.1566855
Validation loss decreased (0.134201 --> 0.134068).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1643132
	speed: 0.6270s/iter; left time: 7629.4061s
Epoch: 14 cost time: 39.669044733047485
Epoch: 14, Steps: 141 | Train Loss: 0.1545021 Vali Loss: 0.1339609 Test Loss: 0.1565093
Validation loss decreased (0.134068 --> 0.133961).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1585362
	speed: 0.6521s/iter; left time: 7842.4080s
Epoch: 15 cost time: 40.04707741737366
Epoch: 15, Steps: 141 | Train Loss: 0.1543772 Vali Loss: 0.1336707 Test Loss: 0.1563675
Validation loss decreased (0.133961 --> 0.133671).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1515506
	speed: 0.6023s/iter; left time: 7158.8157s
Epoch: 16 cost time: 38.29305577278137
Epoch: 16, Steps: 141 | Train Loss: 0.1541475 Vali Loss: 0.1339408 Test Loss: 0.1562421
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1493110
	speed: 0.6587s/iter; left time: 7736.5047s
Epoch: 17 cost time: 39.14411783218384
Epoch: 17, Steps: 141 | Train Loss: 0.1541121 Vali Loss: 0.1336455 Test Loss: 0.1561505
Validation loss decreased (0.133671 --> 0.133645).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1600608
	speed: 0.6154s/iter; left time: 7141.1872s
Epoch: 18 cost time: 37.222644329071045
Epoch: 18, Steps: 141 | Train Loss: 0.1539811 Vali Loss: 0.1338546 Test Loss: 0.1560693
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1544832
	speed: 0.6364s/iter; left time: 7294.6786s
Epoch: 19 cost time: 44.73910307884216
Epoch: 19, Steps: 141 | Train Loss: 0.1539108 Vali Loss: 0.1334446 Test Loss: 0.1560035
Validation loss decreased (0.133645 --> 0.133445).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1570448
	speed: 0.9965s/iter; left time: 11282.3787s
Epoch: 20 cost time: 63.85012912750244
Epoch: 20, Steps: 141 | Train Loss: 0.1539134 Vali Loss: 0.1332874 Test Loss: 0.1559553
Validation loss decreased (0.133445 --> 0.133287).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1615243
	speed: 1.0317s/iter; left time: 11535.7229s
Epoch: 21 cost time: 63.40602493286133
Epoch: 21, Steps: 141 | Train Loss: 0.1538471 Vali Loss: 0.1334941 Test Loss: 0.1558938
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1497495
	speed: 1.0641s/iter; left time: 11748.0739s
Epoch: 22 cost time: 59.950024127960205
Epoch: 22, Steps: 141 | Train Loss: 0.1538322 Vali Loss: 0.1333775 Test Loss: 0.1558602
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1525662
	speed: 0.6567s/iter; left time: 7157.5017s
Epoch: 23 cost time: 38.811277866363525
Epoch: 23, Steps: 141 | Train Loss: 0.1537641 Vali Loss: 0.1333165 Test Loss: 0.1558269
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1552337
	speed: 0.6186s/iter; left time: 6655.1281s
Epoch: 24 cost time: 36.822059869766235
Epoch: 24, Steps: 141 | Train Loss: 0.1537514 Vali Loss: 0.1332043 Test Loss: 0.1557833
Validation loss decreased (0.133287 --> 0.133204).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1481162
	speed: 0.6626s/iter; left time: 7034.5176s
Epoch: 25 cost time: 38.9584219455719
Epoch: 25, Steps: 141 | Train Loss: 0.1537015 Vali Loss: 0.1336074 Test Loss: 0.1557657
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1554464
	speed: 0.6406s/iter; left time: 6711.1501s
Epoch: 26 cost time: 39.04120063781738
Epoch: 26, Steps: 141 | Train Loss: 0.1537307 Vali Loss: 0.1334355 Test Loss: 0.1557324
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1442278
	speed: 0.6109s/iter; left time: 6313.9389s
Epoch: 27 cost time: 36.876497745513916
Epoch: 27, Steps: 141 | Train Loss: 0.1536821 Vali Loss: 0.1332274 Test Loss: 0.1557159
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1500645
	speed: 0.6444s/iter; left time: 6569.1785s
Epoch: 28 cost time: 39.56580114364624
Epoch: 28, Steps: 141 | Train Loss: 0.1536643 Vali Loss: 0.1328013 Test Loss: 0.1556953
Validation loss decreased (0.133204 --> 0.132801).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1514100
	speed: 0.6247s/iter; left time: 6280.0622s
Epoch: 29 cost time: 37.750977516174316
Epoch: 29, Steps: 141 | Train Loss: 0.1536125 Vali Loss: 0.1332979 Test Loss: 0.1556761
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1525071
	speed: 0.6149s/iter; left time: 6094.7275s
Epoch: 30 cost time: 38.77789521217346
Epoch: 30, Steps: 141 | Train Loss: 0.1536580 Vali Loss: 0.1333715 Test Loss: 0.1556672
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1519513
	speed: 0.6333s/iter; left time: 6187.7688s
Epoch: 31 cost time: 39.30496907234192
Epoch: 31, Steps: 141 | Train Loss: 0.1536111 Vali Loss: 0.1330900 Test Loss: 0.1556438
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1617866
	speed: 0.6244s/iter; left time: 6012.9161s
Epoch: 32 cost time: 39.818809509277344
Epoch: 32, Steps: 141 | Train Loss: 0.1535823 Vali Loss: 0.1332538 Test Loss: 0.1556347
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1774469
	speed: 0.6707s/iter; left time: 6364.3110s
Epoch: 33 cost time: 40.71267580986023
Epoch: 33, Steps: 141 | Train Loss: 0.1535588 Vali Loss: 0.1330765 Test Loss: 0.1556248
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1588753
	speed: 0.6479s/iter; left time: 6056.9174s
Epoch: 34 cost time: 39.170318365097046
Epoch: 34, Steps: 141 | Train Loss: 0.1535918 Vali Loss: 0.1334368 Test Loss: 0.1556191
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1532760
	speed: 0.6569s/iter; left time: 6048.0588s
Epoch: 35 cost time: 39.98659014701843
Epoch: 35, Steps: 141 | Train Loss: 0.1535504 Vali Loss: 0.1332039 Test Loss: 0.1556067
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1458985
	speed: 0.6635s/iter; left time: 6015.6026s
Epoch: 36 cost time: 40.24332618713379
Epoch: 36, Steps: 141 | Train Loss: 0.1536052 Vali Loss: 0.1333741 Test Loss: 0.1555960
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1694853
	speed: 0.6672s/iter; left time: 5954.9832s
Epoch: 37 cost time: 41.58249640464783
Epoch: 37, Steps: 141 | Train Loss: 0.1535827 Vali Loss: 0.1330097 Test Loss: 0.1555905
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1549959
	speed: 0.6380s/iter; left time: 5603.8642s
Epoch: 38 cost time: 38.42120552062988
Epoch: 38, Steps: 141 | Train Loss: 0.1535863 Vali Loss: 0.1329732 Test Loss: 0.1555919
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1487624
	speed: 0.6090s/iter; left time: 5263.2329s
Epoch: 39 cost time: 38.11902618408203
Epoch: 39, Steps: 141 | Train Loss: 0.1535079 Vali Loss: 0.1329021 Test Loss: 0.1555675
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1579800
	speed: 0.6298s/iter; left time: 5354.5984s
Epoch: 40 cost time: 38.26512336730957
Epoch: 40, Steps: 141 | Train Loss: 0.1535143 Vali Loss: 0.1332203 Test Loss: 0.1555692
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1611259
	speed: 0.6135s/iter; left time: 5129.4148s
Epoch: 41 cost time: 36.04575157165527
Epoch: 41, Steps: 141 | Train Loss: 0.1535762 Vali Loss: 0.1330248 Test Loss: 0.1555635
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1657862
	speed: 0.5894s/iter; left time: 4844.5574s
Epoch: 42 cost time: 36.319854736328125
Epoch: 42, Steps: 141 | Train Loss: 0.1535410 Vali Loss: 0.1328305 Test Loss: 0.1555620
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1495599
	speed: 0.5995s/iter; left time: 4843.2243s
Epoch: 43 cost time: 36.51288437843323
Epoch: 43, Steps: 141 | Train Loss: 0.1535565 Vali Loss: 0.1331512 Test Loss: 0.1555537
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1537953
	speed: 0.6070s/iter; left time: 4818.0399s
Epoch: 44 cost time: 38.295027017593384
Epoch: 44, Steps: 141 | Train Loss: 0.1535031 Vali Loss: 0.1331872 Test Loss: 0.1555457
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1504144
	speed: 0.6070s/iter; left time: 4733.1333s
Epoch: 45 cost time: 36.60449433326721
Epoch: 45, Steps: 141 | Train Loss: 0.1534701 Vali Loss: 0.1328662 Test Loss: 0.1555494
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1655188
	speed: 0.5962s/iter; left time: 4564.8017s
Epoch: 46 cost time: 37.02395582199097
Epoch: 46, Steps: 141 | Train Loss: 0.1535682 Vali Loss: 0.1332205 Test Loss: 0.1555519
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1638548
	speed: 0.6182s/iter; left time: 4646.0219s
Epoch: 47 cost time: 40.32211685180664
Epoch: 47, Steps: 141 | Train Loss: 0.1535087 Vali Loss: 0.1330344 Test Loss: 0.1555324
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1498480
	speed: 0.6598s/iter; left time: 4865.2196s
Epoch: 48 cost time: 37.158464670181274
Epoch: 48, Steps: 141 | Train Loss: 0.1535117 Vali Loss: 0.1332945 Test Loss: 0.1555340
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_180_j96_H8_FITS_custom_ftM_sl180_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.15564469993114471, mae:0.25040069222450256, rse:0.3921128511428833, corr:[0.46609014 0.46815437 0.4682789  0.4682852  0.4687872  0.4687206
 0.4687604  0.46880022 0.46829987 0.46830675 0.46797386 0.46756378
 0.46758318 0.46707502 0.46726045 0.46699578 0.46686903 0.4669436
 0.46683016 0.46691513 0.46703896 0.46710044 0.46775287 0.46781
 0.46729475 0.46716502 0.4668345  0.46676192 0.46655443 0.4664167
 0.46635836 0.46619946 0.46600035 0.46595603 0.46578795 0.46561176
 0.4656897  0.46541977 0.46546903 0.46538857 0.46537772 0.46547255
 0.46540165 0.46530044 0.4653518  0.46531487 0.46556187 0.46573263
 0.46548462 0.46542013 0.46527213 0.46525082 0.4650732  0.4649769
 0.46493948 0.46487868 0.46483135 0.46483982 0.46485478 0.46471882
 0.46480358 0.46465182 0.46468645 0.46458015 0.4645169  0.46461365
 0.46449    0.46431914 0.46425742 0.46413153 0.46433422 0.4644342
 0.46412987 0.4641793  0.4640983  0.46409705 0.46393383 0.46381345
 0.46380758 0.46365726 0.4636482  0.46373793 0.46373907 0.4637289
 0.46386153 0.46356776 0.46372524 0.4635923  0.46337187 0.46347412
 0.46314353 0.4630785  0.4631709  0.46325186 0.46354035 0.4638833 ]
