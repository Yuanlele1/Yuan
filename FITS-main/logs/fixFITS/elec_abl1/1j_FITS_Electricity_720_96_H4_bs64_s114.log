Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=134, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j96_H4', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_j96_H4_FITS_custom_ftM_sl720_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=134, out_features=151, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  831374592.0
params:  20385.0
Trainable parameters:  20385
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2452943
	speed: 0.5202s/iter; left time: 7075.1385s
Epoch: 1 cost time: 70.80203056335449
Epoch: 1, Steps: 137 | Train Loss: 0.4551522 Vali Loss: 0.1571739 Test Loss: 0.1872792
Validation loss decreased (inf --> 0.157174).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1669936
	speed: 1.1487s/iter; left time: 15466.7039s
Epoch: 2 cost time: 68.95957636833191
Epoch: 2, Steps: 137 | Train Loss: 0.1643283 Vali Loss: 0.1326426 Test Loss: 0.1568709
Validation loss decreased (0.157174 --> 0.132643).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1417977
	speed: 1.1781s/iter; left time: 15700.2483s
Epoch: 3 cost time: 74.85818791389465
Epoch: 3, Steps: 137 | Train Loss: 0.1550318 Vali Loss: 0.1306039 Test Loss: 0.1544177
Validation loss decreased (0.132643 --> 0.130604).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1666791
	speed: 1.2009s/iter; left time: 15839.4343s
Epoch: 4 cost time: 73.43707728385925
Epoch: 4, Steps: 137 | Train Loss: 0.1530473 Vali Loss: 0.1297158 Test Loss: 0.1531925
Validation loss decreased (0.130604 --> 0.129716).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1473553
	speed: 1.1984s/iter; left time: 15642.6163s
Epoch: 5 cost time: 72.79962468147278
Epoch: 5, Steps: 137 | Train Loss: 0.1520497 Vali Loss: 0.1288984 Test Loss: 0.1526060
Validation loss decreased (0.129716 --> 0.128898).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1714305
	speed: 1.2229s/iter; left time: 15795.2661s
Epoch: 6 cost time: 75.38716149330139
Epoch: 6, Steps: 137 | Train Loss: 0.1515453 Vali Loss: 0.1290117 Test Loss: 0.1522897
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1446069
	speed: 1.1291s/iter; left time: 14429.0587s
Epoch: 7 cost time: 71.16233921051025
Epoch: 7, Steps: 137 | Train Loss: 0.1511123 Vali Loss: 0.1287005 Test Loss: 0.1520607
Validation loss decreased (0.128898 --> 0.128701).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1456526
	speed: 1.1883s/iter; left time: 15023.0125s
Epoch: 8 cost time: 72.6755051612854
Epoch: 8, Steps: 137 | Train Loss: 0.1509725 Vali Loss: 0.1284607 Test Loss: 0.1517625
Validation loss decreased (0.128701 --> 0.128461).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1481123
	speed: 1.1692s/iter; left time: 14620.3297s
Epoch: 9 cost time: 75.72226858139038
Epoch: 9, Steps: 137 | Train Loss: 0.1508039 Vali Loss: 0.1284735 Test Loss: 0.1517879
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1499346
	speed: 1.4427s/iter; left time: 17843.5391s
Epoch: 10 cost time: 108.92711234092712
Epoch: 10, Steps: 137 | Train Loss: 0.1507016 Vali Loss: 0.1284257 Test Loss: 0.1517183
Validation loss decreased (0.128461 --> 0.128426).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1539376
	speed: 2.0162s/iter; left time: 24660.6207s
Epoch: 11 cost time: 127.17212462425232
Epoch: 11, Steps: 137 | Train Loss: 0.1506212 Vali Loss: 0.1282163 Test Loss: 0.1516742
Validation loss decreased (0.128426 --> 0.128216).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1570674
	speed: 2.0265s/iter; left time: 24508.2445s
Epoch: 12 cost time: 119.79411292076111
Epoch: 12, Steps: 137 | Train Loss: 0.1505572 Vali Loss: 0.1282264 Test Loss: 0.1515285
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1371436
	speed: 1.9232s/iter; left time: 22996.0782s
Epoch: 13 cost time: 115.42393970489502
Epoch: 13, Steps: 137 | Train Loss: 0.1504766 Vali Loss: 0.1280049 Test Loss: 0.1514572
Validation loss decreased (0.128216 --> 0.128005).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1510313
	speed: 1.8742s/iter; left time: 22152.6354s
Epoch: 14 cost time: 121.63824152946472
Epoch: 14, Steps: 137 | Train Loss: 0.1504190 Vali Loss: 0.1281802 Test Loss: 0.1515245
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1433325
	speed: 1.9487s/iter; left time: 22766.3681s
Epoch: 15 cost time: 121.14459776878357
Epoch: 15, Steps: 137 | Train Loss: 0.1503194 Vali Loss: 0.1281409 Test Loss: 0.1514127
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1472461
	speed: 1.9815s/iter; left time: 22878.5393s
Epoch: 16 cost time: 123.80867218971252
Epoch: 16, Steps: 137 | Train Loss: 0.1503254 Vali Loss: 0.1281620 Test Loss: 0.1514387
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1626464
	speed: 1.9308s/iter; left time: 22028.2644s
Epoch: 17 cost time: 118.58852338790894
Epoch: 17, Steps: 137 | Train Loss: 0.1503033 Vali Loss: 0.1281880 Test Loss: 0.1513504
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1493566
	speed: 2.0150s/iter; left time: 22713.1410s
Epoch: 18 cost time: 117.76286578178406
Epoch: 18, Steps: 137 | Train Loss: 0.1502081 Vali Loss: 0.1279521 Test Loss: 0.1513663
Validation loss decreased (0.128005 --> 0.127952).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1495641
	speed: 1.8970s/iter; left time: 21123.4166s
Epoch: 19 cost time: 122.6956627368927
Epoch: 19, Steps: 137 | Train Loss: 0.1502229 Vali Loss: 0.1279110 Test Loss: 0.1512865
Validation loss decreased (0.127952 --> 0.127911).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1409623
	speed: 2.1394s/iter; left time: 23529.0065s
Epoch: 20 cost time: 133.18756532669067
Epoch: 20, Steps: 137 | Train Loss: 0.1502358 Vali Loss: 0.1278760 Test Loss: 0.1512482
Validation loss decreased (0.127911 --> 0.127876).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1535987
	speed: 1.9684s/iter; left time: 21378.3685s
Epoch: 21 cost time: 119.44933438301086
Epoch: 21, Steps: 137 | Train Loss: 0.1502154 Vali Loss: 0.1281445 Test Loss: 0.1512402
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1536329
	speed: 1.9898s/iter; left time: 21339.0064s
Epoch: 22 cost time: 121.53665494918823
Epoch: 22, Steps: 137 | Train Loss: 0.1502316 Vali Loss: 0.1281712 Test Loss: 0.1512967
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1456259
	speed: 2.0626s/iter; left time: 21836.7286s
Epoch: 23 cost time: 124.41535711288452
Epoch: 23, Steps: 137 | Train Loss: 0.1501446 Vali Loss: 0.1280627 Test Loss: 0.1512822
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1569484
	speed: 2.0072s/iter; left time: 20974.8545s
Epoch: 24 cost time: 122.30762720108032
Epoch: 24, Steps: 137 | Train Loss: 0.1501610 Vali Loss: 0.1279483 Test Loss: 0.1512330
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1454498
	speed: 2.0011s/iter; left time: 20637.1073s
Epoch: 25 cost time: 125.54953670501709
Epoch: 25, Steps: 137 | Train Loss: 0.1501487 Vali Loss: 0.1280014 Test Loss: 0.1512080
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1459684
	speed: 2.0234s/iter; left time: 20589.7558s
Epoch: 26 cost time: 121.27202892303467
Epoch: 26, Steps: 137 | Train Loss: 0.1501226 Vali Loss: 0.1279252 Test Loss: 0.1512010
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1508521
	speed: 1.9622s/iter; left time: 19698.1903s
Epoch: 27 cost time: 122.65894913673401
Epoch: 27, Steps: 137 | Train Loss: 0.1500363 Vali Loss: 0.1277164 Test Loss: 0.1512261
Validation loss decreased (0.127876 --> 0.127716).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1504606
	speed: 1.9649s/iter; left time: 19456.2494s
Epoch: 28 cost time: 121.97124767303467
Epoch: 28, Steps: 137 | Train Loss: 0.1500800 Vali Loss: 0.1275902 Test Loss: 0.1511588
Validation loss decreased (0.127716 --> 0.127590).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1532304
	speed: 2.0272s/iter; left time: 19795.1991s
Epoch: 29 cost time: 121.61858344078064
Epoch: 29, Steps: 137 | Train Loss: 0.1501141 Vali Loss: 0.1279635 Test Loss: 0.1511973
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1460768
	speed: 1.9246s/iter; left time: 18529.9355s
Epoch: 30 cost time: 118.12476015090942
Epoch: 30, Steps: 137 | Train Loss: 0.1500730 Vali Loss: 0.1279554 Test Loss: 0.1511745
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1484685
	speed: 1.9416s/iter; left time: 18427.3391s
Epoch: 31 cost time: 119.49351859092712
Epoch: 31, Steps: 137 | Train Loss: 0.1500178 Vali Loss: 0.1281241 Test Loss: 0.1511859
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1553341
	speed: 1.9448s/iter; left time: 18191.4415s
Epoch: 32 cost time: 119.47082424163818
Epoch: 32, Steps: 137 | Train Loss: 0.1500461 Vali Loss: 0.1277416 Test Loss: 0.1511448
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1431784
	speed: 1.9834s/iter; left time: 18281.3513s
Epoch: 33 cost time: 125.30402088165283
Epoch: 33, Steps: 137 | Train Loss: 0.1500457 Vali Loss: 0.1276418 Test Loss: 0.1511763
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1432479
	speed: 1.8952s/iter; left time: 17208.6325s
Epoch: 34 cost time: 117.19073224067688
Epoch: 34, Steps: 137 | Train Loss: 0.1500460 Vali Loss: 0.1276911 Test Loss: 0.1511501
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1512948
	speed: 1.8480s/iter; left time: 16526.6358s
Epoch: 35 cost time: 109.14644932746887
Epoch: 35, Steps: 137 | Train Loss: 0.1500204 Vali Loss: 0.1278681 Test Loss: 0.1511617
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1542047
	speed: 1.9073s/iter; left time: 16795.8584s
Epoch: 36 cost time: 121.314870595932
Epoch: 36, Steps: 137 | Train Loss: 0.1500826 Vali Loss: 0.1278833 Test Loss: 0.1511543
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1422401
	speed: 1.9484s/iter; left time: 16890.4666s
Epoch: 37 cost time: 114.52396011352539
Epoch: 37, Steps: 137 | Train Loss: 0.1499822 Vali Loss: 0.1278792 Test Loss: 0.1511114
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1436341
	speed: 1.9975s/iter; left time: 17042.5070s
Epoch: 38 cost time: 122.6740403175354
Epoch: 38, Steps: 137 | Train Loss: 0.1500171 Vali Loss: 0.1276814 Test Loss: 0.1511314
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1469751
	speed: 1.8996s/iter; left time: 15947.0236s
Epoch: 39 cost time: 116.6789801120758
Epoch: 39, Steps: 137 | Train Loss: 0.1499591 Vali Loss: 0.1278567 Test Loss: 0.1511079
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1467474
	speed: 1.7473s/iter; left time: 14429.5301s
Epoch: 40 cost time: 115.24047231674194
Epoch: 40, Steps: 137 | Train Loss: 0.1499687 Vali Loss: 0.1278522 Test Loss: 0.1511094
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1489603
	speed: 1.8896s/iter; left time: 15345.1914s
Epoch: 41 cost time: 117.99236559867859
Epoch: 41, Steps: 137 | Train Loss: 0.1500103 Vali Loss: 0.1277320 Test Loss: 0.1511350
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1534028
	speed: 1.9832s/iter; left time: 15834.0704s
Epoch: 42 cost time: 122.691734790802
Epoch: 42, Steps: 137 | Train Loss: 0.1500185 Vali Loss: 0.1278728 Test Loss: 0.1511381
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1543081
	speed: 1.9362s/iter; left time: 15193.0156s
Epoch: 43 cost time: 117.40944528579712
Epoch: 43, Steps: 137 | Train Loss: 0.1499965 Vali Loss: 0.1275962 Test Loss: 0.1511248
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1494375
	speed: 2.0498s/iter; left time: 15803.9776s
Epoch: 44 cost time: 129.5223207473755
Epoch: 44, Steps: 137 | Train Loss: 0.1499187 Vali Loss: 0.1276464 Test Loss: 0.1511188
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1418521
	speed: 2.0170s/iter; left time: 15274.7274s
Epoch: 45 cost time: 124.85159397125244
Epoch: 45, Steps: 137 | Train Loss: 0.1499635 Vali Loss: 0.1276621 Test Loss: 0.1510850
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1467011
	speed: 1.9322s/iter; left time: 14367.8764s
Epoch: 46 cost time: 119.59539365768433
Epoch: 46, Steps: 137 | Train Loss: 0.1499519 Vali Loss: 0.1279898 Test Loss: 0.1511253
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1396297
	speed: 1.9736s/iter; left time: 14405.0183s
Epoch: 47 cost time: 119.58070373535156
Epoch: 47, Steps: 137 | Train Loss: 0.1499851 Vali Loss: 0.1279708 Test Loss: 0.1511334
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1440589
	speed: 1.8756s/iter; left time: 13432.6938s
Epoch: 48 cost time: 114.32182884216309
Epoch: 48, Steps: 137 | Train Loss: 0.1499387 Vali Loss: 0.1278975 Test Loss: 0.1511001
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_720_j96_H4_FITS_custom_ftM_sl720_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.1505662202835083, mae:0.2569529414176941, rse:0.385662704706192, corr:[0.4649454  0.46802458 0.4682959  0.46885672 0.46964115 0.4699229
 0.4697605  0.46959063 0.46956775 0.46956283 0.46946588 0.4693804
 0.4693998  0.46945566 0.46942446 0.4692769  0.46908316 0.4689769
 0.4689981  0.46903244 0.46900967 0.4690316  0.46923128 0.469533
 0.46968815 0.46976724 0.46966746 0.46950835 0.4694299  0.46938753
 0.46928835 0.46916008 0.46906272 0.46904445 0.46905226 0.46901926
 0.46894312 0.46885586 0.46882656 0.4688312  0.46880382 0.4687371
 0.46865886 0.46855608 0.46847883 0.46847358 0.4685183  0.46858844
 0.46868938 0.46887836 0.4689845  0.46891698 0.46877187 0.46864545
 0.4685667  0.46851888 0.4684759  0.46844423 0.46844283 0.4684529
 0.46843725 0.4683515  0.46824905 0.4682186  0.46828288 0.4683877
 0.46838093 0.4681657  0.46791035 0.46785238 0.46797758 0.46809006
 0.4680558  0.4679985  0.46796417 0.46797228 0.46797633 0.46789226
 0.46771312 0.46751255 0.4673743  0.46730834 0.46726963 0.4672713
 0.46736076 0.46748695 0.46754798 0.4674874  0.46740398 0.4674706
 0.467609   0.4674861  0.4670483  0.4666416  0.4670168  0.4679135 ]
