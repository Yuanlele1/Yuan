Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Traffic_90_j720_H8', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=10, pred_len=720, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Traffic_90_j720_H8_FITS_custom_ftM_sl90_ll48_pl720_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11471
val 1037
test 2789
Model(
  (freq_upsampler): Linear(in_features=42, out_features=378, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1751694336.0
params:  16254.0
Trainable parameters:  16254
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 172.42840099334717
Epoch: 1, Steps: 89 | Train Loss: 2.2426278 Vali Loss: 1.7431977 Test Loss: 2.1769540
Validation loss decreased (inf --> 1.743198).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 169.68206071853638
Epoch: 2, Steps: 89 | Train Loss: 1.0985293 Vali Loss: 1.0818257 Test Loss: 1.3364923
Validation loss decreased (1.743198 --> 1.081826).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 149.67382550239563
Epoch: 3, Steps: 89 | Train Loss: 0.7360998 Vali Loss: 0.8257849 Test Loss: 1.0067550
Validation loss decreased (1.081826 --> 0.825785).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 169.85607528686523
Epoch: 4, Steps: 89 | Train Loss: 0.5853575 Vali Loss: 0.7092919 Test Loss: 0.8570570
Validation loss decreased (0.825785 --> 0.709292).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 158.82998847961426
Epoch: 5, Steps: 89 | Train Loss: 0.5141577 Vali Loss: 0.6516461 Test Loss: 0.7830131
Validation loss decreased (0.709292 --> 0.651646).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 165.61409544944763
Epoch: 6, Steps: 89 | Train Loss: 0.4776712 Vali Loss: 0.6209643 Test Loss: 0.7432591
Validation loss decreased (0.651646 --> 0.620964).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 170.66673803329468
Epoch: 7, Steps: 89 | Train Loss: 0.4574887 Vali Loss: 0.6028538 Test Loss: 0.7205563
Validation loss decreased (0.620964 --> 0.602854).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 167.72282218933105
Epoch: 8, Steps: 89 | Train Loss: 0.4453178 Vali Loss: 0.5922640 Test Loss: 0.7070708
Validation loss decreased (0.602854 --> 0.592264).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 163.70215821266174
Epoch: 9, Steps: 89 | Train Loss: 0.4379314 Vali Loss: 0.5853097 Test Loss: 0.6981577
Validation loss decreased (0.592264 --> 0.585310).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 161.9757261276245
Epoch: 10, Steps: 89 | Train Loss: 0.4329220 Vali Loss: 0.5795833 Test Loss: 0.6919312
Validation loss decreased (0.585310 --> 0.579583).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 162.26850771903992
Epoch: 11, Steps: 89 | Train Loss: 0.4294275 Vali Loss: 0.5757245 Test Loss: 0.6877033
Validation loss decreased (0.579583 --> 0.575724).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 153.33172917366028
Epoch: 12, Steps: 89 | Train Loss: 0.4266783 Vali Loss: 0.5742427 Test Loss: 0.6845796
Validation loss decreased (0.575724 --> 0.574243).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 155.89480137825012
Epoch: 13, Steps: 89 | Train Loss: 0.4248156 Vali Loss: 0.5719016 Test Loss: 0.6820880
Validation loss decreased (0.574243 --> 0.571902).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 146.09582328796387
Epoch: 14, Steps: 89 | Train Loss: 0.4232275 Vali Loss: 0.5701333 Test Loss: 0.6801671
Validation loss decreased (0.571902 --> 0.570133).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 128.54751110076904
Epoch: 15, Steps: 89 | Train Loss: 0.4221559 Vali Loss: 0.5692307 Test Loss: 0.6786074
Validation loss decreased (0.570133 --> 0.569231).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 129.60718369483948
Epoch: 16, Steps: 89 | Train Loss: 0.4211270 Vali Loss: 0.5677890 Test Loss: 0.6774173
Validation loss decreased (0.569231 --> 0.567789).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 125.59349775314331
Epoch: 17, Steps: 89 | Train Loss: 0.4201845 Vali Loss: 0.5669762 Test Loss: 0.6767580
Validation loss decreased (0.567789 --> 0.566976).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 113.27425980567932
Epoch: 18, Steps: 89 | Train Loss: 0.4195509 Vali Loss: 0.5657022 Test Loss: 0.6757168
Validation loss decreased (0.566976 --> 0.565702).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 108.47361516952515
Epoch: 19, Steps: 89 | Train Loss: 0.4189960 Vali Loss: 0.5659696 Test Loss: 0.6749807
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 102.83767318725586
Epoch: 20, Steps: 89 | Train Loss: 0.4185690 Vali Loss: 0.5651366 Test Loss: 0.6743451
Validation loss decreased (0.565702 --> 0.565137).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 107.9312596321106
Epoch: 21, Steps: 89 | Train Loss: 0.4180180 Vali Loss: 0.5641352 Test Loss: 0.6738726
Validation loss decreased (0.565137 --> 0.564135).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 105.49770212173462
Epoch: 22, Steps: 89 | Train Loss: 0.4176615 Vali Loss: 0.5644400 Test Loss: 0.6733503
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 107.09462070465088
Epoch: 23, Steps: 89 | Train Loss: 0.4173119 Vali Loss: 0.5639538 Test Loss: 0.6730323
Validation loss decreased (0.564135 --> 0.563954).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 105.76667809486389
Epoch: 24, Steps: 89 | Train Loss: 0.4169848 Vali Loss: 0.5636529 Test Loss: 0.6724548
Validation loss decreased (0.563954 --> 0.563653).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 105.20566511154175
Epoch: 25, Steps: 89 | Train Loss: 0.4167645 Vali Loss: 0.5627397 Test Loss: 0.6722178
Validation loss decreased (0.563653 --> 0.562740).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 107.27519702911377
Epoch: 26, Steps: 89 | Train Loss: 0.4164699 Vali Loss: 0.5629528 Test Loss: 0.6719118
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 105.6874508857727
Epoch: 27, Steps: 89 | Train Loss: 0.4163561 Vali Loss: 0.5620220 Test Loss: 0.6717009
Validation loss decreased (0.562740 --> 0.562022).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 103.06394529342651
Epoch: 28, Steps: 89 | Train Loss: 0.4161048 Vali Loss: 0.5623167 Test Loss: 0.6714052
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 90.64149188995361
Epoch: 29, Steps: 89 | Train Loss: 0.4157865 Vali Loss: 0.5621722 Test Loss: 0.6712155
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 93.90994477272034
Epoch: 30, Steps: 89 | Train Loss: 0.4158255 Vali Loss: 0.5622551 Test Loss: 0.6709690
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 94.35804057121277
Epoch: 31, Steps: 89 | Train Loss: 0.4155062 Vali Loss: 0.5612990 Test Loss: 0.6708973
Validation loss decreased (0.562022 --> 0.561299).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 93.30225157737732
Epoch: 32, Steps: 89 | Train Loss: 0.4154121 Vali Loss: 0.5621811 Test Loss: 0.6707514
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 84.83778119087219
Epoch: 33, Steps: 89 | Train Loss: 0.4152591 Vali Loss: 0.5616809 Test Loss: 0.6705369
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 88.98209881782532
Epoch: 34, Steps: 89 | Train Loss: 0.4151651 Vali Loss: 0.5612333 Test Loss: 0.6704282
Validation loss decreased (0.561299 --> 0.561233).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 94.32147455215454
Epoch: 35, Steps: 89 | Train Loss: 0.4150145 Vali Loss: 0.5612236 Test Loss: 0.6703565
Validation loss decreased (0.561233 --> 0.561224).  Saving model ...
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 83.90647983551025
Epoch: 36, Steps: 89 | Train Loss: 0.4150253 Vali Loss: 0.5612198 Test Loss: 0.6701729
Validation loss decreased (0.561224 --> 0.561220).  Saving model ...
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 84.70287847518921
Epoch: 37, Steps: 89 | Train Loss: 0.4149582 Vali Loss: 0.5615061 Test Loss: 0.6700655
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 85.7807948589325
Epoch: 38, Steps: 89 | Train Loss: 0.4148589 Vali Loss: 0.5610968 Test Loss: 0.6699720
Validation loss decreased (0.561220 --> 0.561097).  Saving model ...
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 83.40236759185791
Epoch: 39, Steps: 89 | Train Loss: 0.4146100 Vali Loss: 0.5607176 Test Loss: 0.6698771
Validation loss decreased (0.561097 --> 0.560718).  Saving model ...
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 85.41130590438843
Epoch: 40, Steps: 89 | Train Loss: 0.4146081 Vali Loss: 0.5609000 Test Loss: 0.6697883
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 82.28069400787354
Epoch: 41, Steps: 89 | Train Loss: 0.4145165 Vali Loss: 0.5608327 Test Loss: 0.6698393
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 75.85085248947144
Epoch: 42, Steps: 89 | Train Loss: 0.4144455 Vali Loss: 0.5608618 Test Loss: 0.6697633
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 105.6645438671112
Epoch: 43, Steps: 89 | Train Loss: 0.4144401 Vali Loss: 0.5607637 Test Loss: 0.6696625
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 95.82776284217834
Epoch: 44, Steps: 89 | Train Loss: 0.4141467 Vali Loss: 0.5610639 Test Loss: 0.6695911
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 84.07414507865906
Epoch: 45, Steps: 89 | Train Loss: 0.4142788 Vali Loss: 0.5608126 Test Loss: 0.6695837
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 110.28341746330261
Epoch: 46, Steps: 89 | Train Loss: 0.4143670 Vali Loss: 0.5602905 Test Loss: 0.6695319
Validation loss decreased (0.560718 --> 0.560290).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 101.37044906616211
Epoch: 47, Steps: 89 | Train Loss: 0.4144336 Vali Loss: 0.5605680 Test Loss: 0.6694794
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 101.99938535690308
Epoch: 48, Steps: 89 | Train Loss: 0.4142522 Vali Loss: 0.5608118 Test Loss: 0.6694435
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 102.24573373794556
Epoch: 49, Steps: 89 | Train Loss: 0.4141793 Vali Loss: 0.5608326 Test Loss: 0.6694236
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 99.97653985023499
Epoch: 50, Steps: 89 | Train Loss: 0.4142798 Vali Loss: 0.5604267 Test Loss: 0.6693755
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 89.32221603393555
Epoch: 51, Steps: 89 | Train Loss: 0.4141550 Vali Loss: 0.5605221 Test Loss: 0.6693988
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 90.72316479682922
Epoch: 52, Steps: 89 | Train Loss: 0.4140891 Vali Loss: 0.5603554 Test Loss: 0.6693569
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 106.47946977615356
Epoch: 53, Steps: 89 | Train Loss: 0.4141234 Vali Loss: 0.5605419 Test Loss: 0.6693372
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 96.36847949028015
Epoch: 54, Steps: 89 | Train Loss: 0.4140415 Vali Loss: 0.5607185 Test Loss: 0.6692903
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 82.10851907730103
Epoch: 55, Steps: 89 | Train Loss: 0.4141075 Vali Loss: 0.5600215 Test Loss: 0.6692902
Validation loss decreased (0.560290 --> 0.560022).  Saving model ...
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 77.74892592430115
Epoch: 56, Steps: 89 | Train Loss: 0.4141253 Vali Loss: 0.5598063 Test Loss: 0.6692711
Validation loss decreased (0.560022 --> 0.559806).  Saving model ...
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 79.49027609825134
Epoch: 57, Steps: 89 | Train Loss: 0.4140406 Vali Loss: 0.5595942 Test Loss: 0.6692576
Validation loss decreased (0.559806 --> 0.559594).  Saving model ...
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 74.50680255889893
Epoch: 58, Steps: 89 | Train Loss: 0.4140150 Vali Loss: 0.5595792 Test Loss: 0.6692239
Validation loss decreased (0.559594 --> 0.559579).  Saving model ...
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 57.25403928756714
Epoch: 59, Steps: 89 | Train Loss: 0.4140516 Vali Loss: 0.5601193 Test Loss: 0.6692116
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 49.01840591430664
Epoch: 60, Steps: 89 | Train Loss: 0.4139960 Vali Loss: 0.5595260 Test Loss: 0.6692058
Validation loss decreased (0.559579 --> 0.559526).  Saving model ...
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 47.644102334976196
Epoch: 61, Steps: 89 | Train Loss: 0.4139268 Vali Loss: 0.5598749 Test Loss: 0.6692058
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 47.986093521118164
Epoch: 62, Steps: 89 | Train Loss: 0.4139969 Vali Loss: 0.5600165 Test Loss: 0.6691979
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 46.282776832580566
Epoch: 63, Steps: 89 | Train Loss: 0.4140507 Vali Loss: 0.5602870 Test Loss: 0.6691796
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 47.6882381439209
Epoch: 64, Steps: 89 | Train Loss: 0.4137815 Vali Loss: 0.5599128 Test Loss: 0.6691923
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 47.434014320373535
Epoch: 65, Steps: 89 | Train Loss: 0.4138707 Vali Loss: 0.5597591 Test Loss: 0.6691737
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 47.39760994911194
Epoch: 66, Steps: 89 | Train Loss: 0.4138795 Vali Loss: 0.5602270 Test Loss: 0.6691761
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 47.76249575614929
Epoch: 67, Steps: 89 | Train Loss: 0.4138654 Vali Loss: 0.5601393 Test Loss: 0.6691790
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6932767819016104e-05
