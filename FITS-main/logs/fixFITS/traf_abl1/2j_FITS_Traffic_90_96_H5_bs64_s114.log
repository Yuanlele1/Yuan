Args in experiment:
Namespace(H_order=5, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=30, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Traffic_90_j96_H5', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=10, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Traffic_90_j96_H5_FITS_custom_ftM_sl90_ll48_pl96_H5_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12095
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=30, out_features=62, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  205224960.0
params:  1922.0
Trainable parameters:  1922
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 41.79776310920715
Epoch: 1, Steps: 94 | Train Loss: 1.1186082 Vali Loss: 1.2348933 Test Loss: 1.4217883
Validation loss decreased (inf --> 1.234893).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 39.02251219749451
Epoch: 2, Steps: 94 | Train Loss: 0.7453319 Vali Loss: 0.9804222 Test Loss: 1.1287524
Validation loss decreased (1.234893 --> 0.980422).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 36.623554706573486
Epoch: 3, Steps: 94 | Train Loss: 0.5684582 Vali Loss: 0.8520364 Test Loss: 0.9843980
Validation loss decreased (0.980422 --> 0.852036).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 37.52889680862427
Epoch: 4, Steps: 94 | Train Loss: 0.4709396 Vali Loss: 0.7788672 Test Loss: 0.9028086
Validation loss decreased (0.852036 --> 0.778867).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 39.67322635650635
Epoch: 5, Steps: 94 | Train Loss: 0.4104132 Vali Loss: 0.7351912 Test Loss: 0.8522110
Validation loss decreased (0.778867 --> 0.735191).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 38.9568874835968
Epoch: 6, Steps: 94 | Train Loss: 0.3704597 Vali Loss: 0.7033203 Test Loss: 0.8174912
Validation loss decreased (0.735191 --> 0.703320).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 39.56003451347351
Epoch: 7, Steps: 94 | Train Loss: 0.3426846 Vali Loss: 0.6801975 Test Loss: 0.7939289
Validation loss decreased (0.703320 --> 0.680198).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 39.57500386238098
Epoch: 8, Steps: 94 | Train Loss: 0.3228702 Vali Loss: 0.6642419 Test Loss: 0.7761609
Validation loss decreased (0.680198 --> 0.664242).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 40.7490611076355
Epoch: 9, Steps: 94 | Train Loss: 0.3082439 Vali Loss: 0.6540430 Test Loss: 0.7628532
Validation loss decreased (0.664242 --> 0.654043).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 41.40451407432556
Epoch: 10, Steps: 94 | Train Loss: 0.2973319 Vali Loss: 0.6437692 Test Loss: 0.7526827
Validation loss decreased (0.654043 --> 0.643769).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 37.92999768257141
Epoch: 11, Steps: 94 | Train Loss: 0.2890352 Vali Loss: 0.6354039 Test Loss: 0.7444371
Validation loss decreased (0.643769 --> 0.635404).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 42.89183449745178
Epoch: 12, Steps: 94 | Train Loss: 0.2824246 Vali Loss: 0.6307530 Test Loss: 0.7379453
Validation loss decreased (0.635404 --> 0.630753).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 40.422508001327515
Epoch: 13, Steps: 94 | Train Loss: 0.2773051 Vali Loss: 0.6266789 Test Loss: 0.7324852
Validation loss decreased (0.630753 --> 0.626679).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 39.76619744300842
Epoch: 14, Steps: 94 | Train Loss: 0.2730297 Vali Loss: 0.6199879 Test Loss: 0.7279912
Validation loss decreased (0.626679 --> 0.619988).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 42.120431423187256
Epoch: 15, Steps: 94 | Train Loss: 0.2695425 Vali Loss: 0.6168855 Test Loss: 0.7240541
Validation loss decreased (0.619988 --> 0.616885).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 38.830803632736206
Epoch: 16, Steps: 94 | Train Loss: 0.2666811 Vali Loss: 0.6148809 Test Loss: 0.7207798
Validation loss decreased (0.616885 --> 0.614881).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 41.24267935752869
Epoch: 17, Steps: 94 | Train Loss: 0.2643118 Vali Loss: 0.6122501 Test Loss: 0.7179227
Validation loss decreased (0.614881 --> 0.612250).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 41.76050877571106
Epoch: 18, Steps: 94 | Train Loss: 0.2621445 Vali Loss: 0.6098769 Test Loss: 0.7152606
Validation loss decreased (0.612250 --> 0.609877).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 38.56808304786682
Epoch: 19, Steps: 94 | Train Loss: 0.2603818 Vali Loss: 0.6071089 Test Loss: 0.7131062
Validation loss decreased (0.609877 --> 0.607109).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 41.805399656295776
Epoch: 20, Steps: 94 | Train Loss: 0.2588726 Vali Loss: 0.6076766 Test Loss: 0.7110946
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 41.57669401168823
Epoch: 21, Steps: 94 | Train Loss: 0.2575123 Vali Loss: 0.6066573 Test Loss: 0.7093814
Validation loss decreased (0.607109 --> 0.606657).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 41.01990842819214
Epoch: 22, Steps: 94 | Train Loss: 0.2563778 Vali Loss: 0.6062998 Test Loss: 0.7077896
Validation loss decreased (0.606657 --> 0.606300).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 40.77085852622986
Epoch: 23, Steps: 94 | Train Loss: 0.2554134 Vali Loss: 0.6028317 Test Loss: 0.7064683
Validation loss decreased (0.606300 --> 0.602832).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 40.188101053237915
Epoch: 24, Steps: 94 | Train Loss: 0.2544204 Vali Loss: 0.6005921 Test Loss: 0.7051436
Validation loss decreased (0.602832 --> 0.600592).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 38.79690861701965
Epoch: 25, Steps: 94 | Train Loss: 0.2535701 Vali Loss: 0.6005874 Test Loss: 0.7040821
Validation loss decreased (0.600592 --> 0.600587).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 43.86898875236511
Epoch: 26, Steps: 94 | Train Loss: 0.2528254 Vali Loss: 0.6012830 Test Loss: 0.7030472
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 38.2495641708374
Epoch: 27, Steps: 94 | Train Loss: 0.2521349 Vali Loss: 0.5971059 Test Loss: 0.7021177
Validation loss decreased (0.600587 --> 0.597106).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 40.74357533454895
Epoch: 28, Steps: 94 | Train Loss: 0.2515275 Vali Loss: 0.5952384 Test Loss: 0.7012524
Validation loss decreased (0.597106 --> 0.595238).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 43.32336211204529
Epoch: 29, Steps: 94 | Train Loss: 0.2510296 Vali Loss: 0.5958612 Test Loss: 0.7004805
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 37.89231324195862
Epoch: 30, Steps: 94 | Train Loss: 0.2505137 Vali Loss: 0.5975181 Test Loss: 0.6997370
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 41.213122844696045
Epoch: 31, Steps: 94 | Train Loss: 0.2500110 Vali Loss: 0.5960581 Test Loss: 0.6991392
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 40.595299243927
Epoch: 32, Steps: 94 | Train Loss: 0.2496111 Vali Loss: 0.5954424 Test Loss: 0.6985191
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 40.805119037628174
Epoch: 33, Steps: 94 | Train Loss: 0.2492082 Vali Loss: 0.5937378 Test Loss: 0.6979655
Validation loss decreased (0.595238 --> 0.593738).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 42.191699504852295
Epoch: 34, Steps: 94 | Train Loss: 0.2489412 Vali Loss: 0.5956494 Test Loss: 0.6974922
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 42.42346167564392
Epoch: 35, Steps: 94 | Train Loss: 0.2485294 Vali Loss: 0.5961763 Test Loss: 0.6970543
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 41.42844772338867
Epoch: 36, Steps: 94 | Train Loss: 0.2482567 Vali Loss: 0.5932340 Test Loss: 0.6966023
Validation loss decreased (0.593738 --> 0.593234).  Saving model ...
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 39.900365591049194
Epoch: 37, Steps: 94 | Train Loss: 0.2479255 Vali Loss: 0.5938031 Test Loss: 0.6962332
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 40.25957465171814
Epoch: 38, Steps: 94 | Train Loss: 0.2477424 Vali Loss: 0.5928906 Test Loss: 0.6959025
Validation loss decreased (0.593234 --> 0.592891).  Saving model ...
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 40.237433433532715
Epoch: 39, Steps: 94 | Train Loss: 0.2475192 Vali Loss: 0.5922746 Test Loss: 0.6955172
Validation loss decreased (0.592891 --> 0.592275).  Saving model ...
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 40.39637088775635
Epoch: 40, Steps: 94 | Train Loss: 0.2471724 Vali Loss: 0.5917286 Test Loss: 0.6951727
Validation loss decreased (0.592275 --> 0.591729).  Saving model ...
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 41.08300542831421
Epoch: 41, Steps: 94 | Train Loss: 0.2469749 Vali Loss: 0.5925114 Test Loss: 0.6949093
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 44.058207750320435
Epoch: 42, Steps: 94 | Train Loss: 0.2467664 Vali Loss: 0.5908952 Test Loss: 0.6946010
Validation loss decreased (0.591729 --> 0.590895).  Saving model ...
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 40.697409868240356
Epoch: 43, Steps: 94 | Train Loss: 0.2465569 Vali Loss: 0.5901791 Test Loss: 0.6943330
Validation loss decreased (0.590895 --> 0.590179).  Saving model ...
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 41.399083614349365
Epoch: 44, Steps: 94 | Train Loss: 0.2463353 Vali Loss: 0.5911302 Test Loss: 0.6941295
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 41.9205379486084
Epoch: 45, Steps: 94 | Train Loss: 0.2462984 Vali Loss: 0.5915338 Test Loss: 0.6939064
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 40.570128440856934
Epoch: 46, Steps: 94 | Train Loss: 0.2461310 Vali Loss: 0.5901741 Test Loss: 0.6936541
Validation loss decreased (0.590179 --> 0.590174).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 42.201048851013184
Epoch: 47, Steps: 94 | Train Loss: 0.2459196 Vali Loss: 0.5912468 Test Loss: 0.6934654
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 39.0485098361969
Epoch: 48, Steps: 94 | Train Loss: 0.2458008 Vali Loss: 0.5906661 Test Loss: 0.6932802
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 39.618279218673706
Epoch: 49, Steps: 94 | Train Loss: 0.2456599 Vali Loss: 0.5884218 Test Loss: 0.6931050
Validation loss decreased (0.590174 --> 0.588422).  Saving model ...
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 40.60766530036926
Epoch: 50, Steps: 94 | Train Loss: 0.2455548 Vali Loss: 0.5868672 Test Loss: 0.6929298
Validation loss decreased (0.588422 --> 0.586867).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 39.3226363658905
Epoch: 51, Steps: 94 | Train Loss: 0.2454493 Vali Loss: 0.5922704 Test Loss: 0.6927939
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 40.83549666404724
Epoch: 52, Steps: 94 | Train Loss: 0.2453356 Vali Loss: 0.5900019 Test Loss: 0.6926806
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 40.21888256072998
Epoch: 53, Steps: 94 | Train Loss: 0.2452244 Vali Loss: 0.5909686 Test Loss: 0.6925140
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 38.97668504714966
Epoch: 54, Steps: 94 | Train Loss: 0.2451179 Vali Loss: 0.5893105 Test Loss: 0.6923774
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 42.407872438430786
Epoch: 55, Steps: 94 | Train Loss: 0.2449354 Vali Loss: 0.5888816 Test Loss: 0.6922485
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 38.75345802307129
Epoch: 56, Steps: 94 | Train Loss: 0.2449104 Vali Loss: 0.5888084 Test Loss: 0.6921318
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 40.03141212463379
Epoch: 57, Steps: 94 | Train Loss: 0.2448331 Vali Loss: 0.5897633 Test Loss: 0.6920358
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 40.52363705635071
Epoch: 58, Steps: 94 | Train Loss: 0.2446459 Vali Loss: 0.5894451 Test Loss: 0.6919263
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 37.96664071083069
Epoch: 59, Steps: 94 | Train Loss: 0.2447108 Vali Loss: 0.5902964 Test Loss: 0.6918166
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 40.69903111457825
Epoch: 60, Steps: 94 | Train Loss: 0.2446249 Vali Loss: 0.5880086 Test Loss: 0.6917376
EarlyStopping counter: 10 out of 10
Early stopping
train 12095
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=30, out_features=62, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  205224960.0
params:  1922.0
Trainable parameters:  1922
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 38.080902338027954
Epoch: 1, Steps: 94 | Train Loss: 0.4408308 Vali Loss: 0.5816591 Test Loss: 0.6825219
Validation loss decreased (inf --> 0.581659).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 38.85542964935303
Epoch: 2, Steps: 94 | Train Loss: 0.4373674 Vali Loss: 0.5779172 Test Loss: 0.6819999
Validation loss decreased (0.581659 --> 0.577917).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 41.462878704071045
Epoch: 3, Steps: 94 | Train Loss: 0.4362738 Vali Loss: 0.5748863 Test Loss: 0.6807289
Validation loss decreased (0.577917 --> 0.574886).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 40.07275915145874
Epoch: 4, Steps: 94 | Train Loss: 0.4359120 Vali Loss: 0.5769618 Test Loss: 0.6804715
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 36.948715686798096
Epoch: 5, Steps: 94 | Train Loss: 0.4358075 Vali Loss: 0.5756078 Test Loss: 0.6808934
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 40.14596343040466
Epoch: 6, Steps: 94 | Train Loss: 0.4355682 Vali Loss: 0.5772966 Test Loss: 0.6802674
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 38.69984149932861
Epoch: 7, Steps: 94 | Train Loss: 0.4355647 Vali Loss: 0.5768164 Test Loss: 0.6803479
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 37.67695379257202
Epoch: 8, Steps: 94 | Train Loss: 0.4354174 Vali Loss: 0.5765988 Test Loss: 0.6804731
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 36.17109203338623
Epoch: 9, Steps: 94 | Train Loss: 0.4353691 Vali Loss: 0.5772771 Test Loss: 0.6799167
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 33.060387134552
Epoch: 10, Steps: 94 | Train Loss: 0.4354046 Vali Loss: 0.5772858 Test Loss: 0.6801746
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 38.621376514434814
Epoch: 11, Steps: 94 | Train Loss: 0.4353717 Vali Loss: 0.5749878 Test Loss: 0.6800706
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 33.7002317905426
Epoch: 12, Steps: 94 | Train Loss: 0.4353104 Vali Loss: 0.5767004 Test Loss: 0.6798131
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 33.35587930679321
Epoch: 13, Steps: 94 | Train Loss: 0.4351540 Vali Loss: 0.5747287 Test Loss: 0.6800453
Validation loss decreased (0.574886 --> 0.574729).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 36.57481408119202
Epoch: 14, Steps: 94 | Train Loss: 0.4351897 Vali Loss: 0.5757100 Test Loss: 0.6800534
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 35.91506767272949
Epoch: 15, Steps: 94 | Train Loss: 0.4352401 Vali Loss: 0.5784448 Test Loss: 0.6796925
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 34.60783863067627
Epoch: 16, Steps: 94 | Train Loss: 0.4351141 Vali Loss: 0.5770636 Test Loss: 0.6801050
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 36.21544909477234
Epoch: 17, Steps: 94 | Train Loss: 0.4350587 Vali Loss: 0.5755778 Test Loss: 0.6796651
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 35.84515929222107
Epoch: 18, Steps: 94 | Train Loss: 0.4350976 Vali Loss: 0.5776925 Test Loss: 0.6798701
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 35.41760873794556
Epoch: 19, Steps: 94 | Train Loss: 0.4351000 Vali Loss: 0.5746112 Test Loss: 0.6798488
Validation loss decreased (0.574729 --> 0.574611).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 36.81742572784424
Epoch: 20, Steps: 94 | Train Loss: 0.4349440 Vali Loss: 0.5756305 Test Loss: 0.6797338
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 38.36903524398804
Epoch: 21, Steps: 94 | Train Loss: 0.4351592 Vali Loss: 0.5754188 Test Loss: 0.6796185
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 41.02527165412903
Epoch: 22, Steps: 94 | Train Loss: 0.4349819 Vali Loss: 0.5743606 Test Loss: 0.6798995
Validation loss decreased (0.574611 --> 0.574361).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 41.4807186126709
Epoch: 23, Steps: 94 | Train Loss: 0.4350598 Vali Loss: 0.5772764 Test Loss: 0.6797187
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 39.581989765167236
Epoch: 24, Steps: 94 | Train Loss: 0.4350835 Vali Loss: 0.5758988 Test Loss: 0.6797958
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 40.2625892162323
Epoch: 25, Steps: 94 | Train Loss: 0.4350490 Vali Loss: 0.5760835 Test Loss: 0.6796712
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 39.016167402267456
Epoch: 26, Steps: 94 | Train Loss: 0.4350623 Vali Loss: 0.5766445 Test Loss: 0.6797481
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 41.29279398918152
Epoch: 27, Steps: 94 | Train Loss: 0.4350586 Vali Loss: 0.5758237 Test Loss: 0.6797370
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 41.34174346923828
Epoch: 28, Steps: 94 | Train Loss: 0.4349778 Vali Loss: 0.5763534 Test Loss: 0.6796469
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 38.01307916641235
Epoch: 29, Steps: 94 | Train Loss: 0.4351556 Vali Loss: 0.5742744 Test Loss: 0.6797124
Validation loss decreased (0.574361 --> 0.574274).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 42.1496422290802
Epoch: 30, Steps: 94 | Train Loss: 0.4348858 Vali Loss: 0.5755454 Test Loss: 0.6796895
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 38.40538215637207
Epoch: 31, Steps: 94 | Train Loss: 0.4350162 Vali Loss: 0.5753074 Test Loss: 0.6796920
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 41.62115168571472
Epoch: 32, Steps: 94 | Train Loss: 0.4351007 Vali Loss: 0.5765698 Test Loss: 0.6796642
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 39.86556959152222
Epoch: 33, Steps: 94 | Train Loss: 0.4351014 Vali Loss: 0.5761964 Test Loss: 0.6797363
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 37.60011053085327
Epoch: 34, Steps: 94 | Train Loss: 0.4349466 Vali Loss: 0.5736414 Test Loss: 0.6796976
Validation loss decreased (0.574274 --> 0.573641).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 40.76754832267761
Epoch: 35, Steps: 94 | Train Loss: 0.4349063 Vali Loss: 0.5751726 Test Loss: 0.6796489
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 39.808756589889526
Epoch: 36, Steps: 94 | Train Loss: 0.4348394 Vali Loss: 0.5769939 Test Loss: 0.6797091
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 38.91776895523071
Epoch: 37, Steps: 94 | Train Loss: 0.4350197 Vali Loss: 0.5744473 Test Loss: 0.6796163
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 41.04232096672058
Epoch: 38, Steps: 94 | Train Loss: 0.4348600 Vali Loss: 0.5743410 Test Loss: 0.6796508
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 39.182775259017944
Epoch: 39, Steps: 94 | Train Loss: 0.4349455 Vali Loss: 0.5752234 Test Loss: 0.6796632
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 42.80244970321655
Epoch: 40, Steps: 94 | Train Loss: 0.4349735 Vali Loss: 0.5769746 Test Loss: 0.6796196
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 38.95133948326111
Epoch: 41, Steps: 94 | Train Loss: 0.4348318 Vali Loss: 0.5747570 Test Loss: 0.6795678
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 37.12500309944153
Epoch: 42, Steps: 94 | Train Loss: 0.4350128 Vali Loss: 0.5776032 Test Loss: 0.6795994
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 37.84225392341614
Epoch: 43, Steps: 94 | Train Loss: 0.4350517 Vali Loss: 0.5731997 Test Loss: 0.6795972
Validation loss decreased (0.573641 --> 0.573200).  Saving model ...
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 38.360265493392944
Epoch: 44, Steps: 94 | Train Loss: 0.4349847 Vali Loss: 0.5757106 Test Loss: 0.6796155
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 38.163687229156494
Epoch: 45, Steps: 94 | Train Loss: 0.4349363 Vali Loss: 0.5754610 Test Loss: 0.6796016
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 37.78403043746948
Epoch: 46, Steps: 94 | Train Loss: 0.4349748 Vali Loss: 0.5758598 Test Loss: 0.6796541
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 37.40743637084961
Epoch: 47, Steps: 94 | Train Loss: 0.4348816 Vali Loss: 0.5741363 Test Loss: 0.6796237
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 41.02773642539978
Epoch: 48, Steps: 94 | Train Loss: 0.4347805 Vali Loss: 0.5759048 Test Loss: 0.6796014
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 39.43459177017212
Epoch: 49, Steps: 94 | Train Loss: 0.4348946 Vali Loss: 0.5764891 Test Loss: 0.6796131
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 36.099263191223145
Epoch: 50, Steps: 94 | Train Loss: 0.4349852 Vali Loss: 0.5761729 Test Loss: 0.6795692
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 38.51084756851196
Epoch: 51, Steps: 94 | Train Loss: 0.4349871 Vali Loss: 0.5747035 Test Loss: 0.6795757
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 38.86933159828186
Epoch: 52, Steps: 94 | Train Loss: 0.4348067 Vali Loss: 0.5761078 Test Loss: 0.6796081
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 38.404940605163574
Epoch: 53, Steps: 94 | Train Loss: 0.4348752 Vali Loss: 0.5757766 Test Loss: 0.6795840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : Traffic_90_j96_H5_FITS_custom_ftM_sl90_ll48_pl96_H5_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.6842902898788452, mae:0.4052591323852539, rse:0.6849732995033264, corr:[0.2745543  0.2878787  0.2885994  0.28680408 0.28638852 0.2878907
 0.2899507  0.29030362 0.29046527 0.28998777 0.28869587 0.28864634
 0.28788775 0.28685677 0.28719303 0.28743884 0.2877204  0.28896728
 0.29080954 0.2925637  0.2935124  0.2950806  0.2954502  0.29502314
 0.3000652  0.30366108 0.30280614 0.30158144 0.30169812 0.3030024
 0.30422285 0.305836   0.30588913 0.3050617  0.30467635 0.3040364
 0.3028862  0.30228117 0.30237323 0.30239236 0.3027057  0.30359828
 0.30478334 0.3056461  0.3058872  0.30654332 0.30588272 0.30406517
 0.30404824 0.3028237  0.30145806 0.300964   0.2997966  0.29592714
 0.2928647  0.29367337 0.29352278 0.29245314 0.2915135  0.29002976
 0.28873894 0.28816596 0.28770187 0.28753123 0.28794664 0.28851876
 0.28941318 0.2904265  0.29070285 0.2908466  0.29044312 0.28881803
 0.286844   0.28528258 0.28501594 0.2860584  0.28730023 0.28735
 0.2873528  0.28943974 0.2896811  0.28871533 0.28780788 0.2864969
 0.2856846  0.285231   0.28464383 0.28495166 0.28523695 0.28493986
 0.2857335  0.28638837 0.28609157 0.28660908 0.28645137 0.28554374]
