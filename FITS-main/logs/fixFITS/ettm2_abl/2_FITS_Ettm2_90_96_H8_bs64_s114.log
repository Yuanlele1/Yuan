Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2755198
	speed: 0.0169s/iter; left time: 450.5042s
	iters: 200, epoch: 1 | loss: 0.2864487
	speed: 0.0117s/iter; left time: 310.2219s
Epoch: 1 cost time: 3.7315104007720947
Epoch: 1, Steps: 268 | Train Loss: 0.2500524 Vali Loss: 0.1784400 Test Loss: 0.2449618
Validation loss decreased (inf --> 0.178440).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1676921
	speed: 0.0638s/iter; left time: 1686.2642s
	iters: 200, epoch: 2 | loss: 0.1883942
	speed: 0.0114s/iter; left time: 300.6059s
Epoch: 2 cost time: 3.680041551589966
Epoch: 2, Steps: 268 | Train Loss: 0.1867121 Vali Loss: 0.1632311 Test Loss: 0.2248174
Validation loss decreased (0.178440 --> 0.163231).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1319526
	speed: 0.0650s/iter; left time: 1700.2924s
	iters: 200, epoch: 3 | loss: 0.1415379
	speed: 0.0115s/iter; left time: 300.0679s
Epoch: 3 cost time: 3.554367780685425
Epoch: 3, Steps: 268 | Train Loss: 0.1647731 Vali Loss: 0.1553432 Test Loss: 0.2146203
Validation loss decreased (0.163231 --> 0.155343).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1293555
	speed: 0.0621s/iter; left time: 1607.0803s
	iters: 200, epoch: 4 | loss: 0.1388023
	speed: 0.0108s/iter; left time: 279.4103s
Epoch: 4 cost time: 3.713726043701172
Epoch: 4, Steps: 268 | Train Loss: 0.1538203 Vali Loss: 0.1495222 Test Loss: 0.2073924
Validation loss decreased (0.155343 --> 0.149522).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1876657
	speed: 0.0639s/iter; left time: 1637.1038s
	iters: 200, epoch: 5 | loss: 0.1185109
	speed: 0.0104s/iter; left time: 266.1630s
Epoch: 5 cost time: 3.497441291809082
Epoch: 5, Steps: 268 | Train Loss: 0.1463963 Vali Loss: 0.1449862 Test Loss: 0.2018761
Validation loss decreased (0.149522 --> 0.144986).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1552079
	speed: 0.0591s/iter; left time: 1498.0739s
	iters: 200, epoch: 6 | loss: 0.1250711
	speed: 0.0107s/iter; left time: 269.5161s
Epoch: 6 cost time: 3.4952919483184814
Epoch: 6, Steps: 268 | Train Loss: 0.1417502 Vali Loss: 0.1414099 Test Loss: 0.1976383
Validation loss decreased (0.144986 --> 0.141410).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1823994
	speed: 0.0604s/iter; left time: 1515.4525s
	iters: 200, epoch: 7 | loss: 0.1677563
	speed: 0.0148s/iter; left time: 369.0519s
Epoch: 7 cost time: 3.826714515686035
Epoch: 7, Steps: 268 | Train Loss: 0.1381788 Vali Loss: 0.1389674 Test Loss: 0.1946439
Validation loss decreased (0.141410 --> 0.138967).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1060909
	speed: 0.0593s/iter; left time: 1472.6656s
	iters: 200, epoch: 8 | loss: 0.0924068
	speed: 0.0112s/iter; left time: 276.4052s
Epoch: 8 cost time: 4.214918375015259
Epoch: 8, Steps: 268 | Train Loss: 0.1356180 Vali Loss: 0.1368300 Test Loss: 0.1921493
Validation loss decreased (0.138967 --> 0.136830).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1078967
	speed: 0.0688s/iter; left time: 1689.6384s
	iters: 200, epoch: 9 | loss: 0.1278028
	speed: 0.0110s/iter; left time: 268.1772s
Epoch: 9 cost time: 3.469501256942749
Epoch: 9, Steps: 268 | Train Loss: 0.1338975 Vali Loss: 0.1353085 Test Loss: 0.1904606
Validation loss decreased (0.136830 --> 0.135309).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1460094
	speed: 0.0639s/iter; left time: 1551.1655s
	iters: 200, epoch: 10 | loss: 0.1355817
	speed: 0.0109s/iter; left time: 263.2404s
Epoch: 10 cost time: 3.4990100860595703
Epoch: 10, Steps: 268 | Train Loss: 0.1327458 Vali Loss: 0.1341463 Test Loss: 0.1891428
Validation loss decreased (0.135309 --> 0.134146).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1113092
	speed: 0.0632s/iter; left time: 1518.4008s
	iters: 200, epoch: 11 | loss: 0.0983543
	speed: 0.0137s/iter; left time: 327.7836s
Epoch: 11 cost time: 4.355130195617676
Epoch: 11, Steps: 268 | Train Loss: 0.1318664 Vali Loss: 0.1329884 Test Loss: 0.1880475
Validation loss decreased (0.134146 --> 0.132988).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1215846
	speed: 0.0745s/iter; left time: 1770.6547s
	iters: 200, epoch: 12 | loss: 0.0812791
	speed: 0.0115s/iter; left time: 270.8892s
Epoch: 12 cost time: 4.284485101699829
Epoch: 12, Steps: 268 | Train Loss: 0.1311320 Vali Loss: 0.1326126 Test Loss: 0.1874781
Validation loss decreased (0.132988 --> 0.132613).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1295960
	speed: 0.0695s/iter; left time: 1632.6956s
	iters: 200, epoch: 13 | loss: 0.1253859
	speed: 0.0113s/iter; left time: 265.3327s
Epoch: 13 cost time: 4.093010425567627
Epoch: 13, Steps: 268 | Train Loss: 0.1307681 Vali Loss: 0.1321229 Test Loss: 0.1869270
Validation loss decreased (0.132613 --> 0.132123).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1350342
	speed: 0.0649s/iter; left time: 1506.2771s
	iters: 200, epoch: 14 | loss: 0.0997059
	speed: 0.0103s/iter; left time: 237.0476s
Epoch: 14 cost time: 3.2486379146575928
Epoch: 14, Steps: 268 | Train Loss: 0.1307053 Vali Loss: 0.1317478 Test Loss: 0.1865348
Validation loss decreased (0.132123 --> 0.131748).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0957932
	speed: 0.0614s/iter; left time: 1409.3373s
	iters: 200, epoch: 15 | loss: 0.1185079
	speed: 0.0107s/iter; left time: 244.4291s
Epoch: 15 cost time: 3.4150030612945557
Epoch: 15, Steps: 268 | Train Loss: 0.1304063 Vali Loss: 0.1313968 Test Loss: 0.1862513
Validation loss decreased (0.131748 --> 0.131397).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1458549
	speed: 0.0615s/iter; left time: 1396.0022s
	iters: 200, epoch: 16 | loss: 0.1398090
	speed: 0.0221s/iter; left time: 499.2519s
Epoch: 16 cost time: 4.731240510940552
Epoch: 16, Steps: 268 | Train Loss: 0.1303909 Vali Loss: 0.1311361 Test Loss: 0.1860772
Validation loss decreased (0.131397 --> 0.131136).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1756439
	speed: 0.0665s/iter; left time: 1490.1411s
	iters: 200, epoch: 17 | loss: 0.1484716
	speed: 0.0105s/iter; left time: 233.5233s
Epoch: 17 cost time: 3.8055832386016846
Epoch: 17, Steps: 268 | Train Loss: 0.1302327 Vali Loss: 0.1310387 Test Loss: 0.1859323
Validation loss decreased (0.131136 --> 0.131039).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2405391
	speed: 0.0648s/iter; left time: 1435.6657s
	iters: 200, epoch: 18 | loss: 0.1128753
	speed: 0.0107s/iter; left time: 236.2766s
Epoch: 18 cost time: 4.080238103866577
Epoch: 18, Steps: 268 | Train Loss: 0.1300162 Vali Loss: 0.1310400 Test Loss: 0.1858761
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1036830
	speed: 0.0659s/iter; left time: 1442.2602s
	iters: 200, epoch: 19 | loss: 0.1751210
	speed: 0.0112s/iter; left time: 244.7311s
Epoch: 19 cost time: 3.5722858905792236
Epoch: 19, Steps: 268 | Train Loss: 0.1301680 Vali Loss: 0.1309175 Test Loss: 0.1857924
Validation loss decreased (0.131039 --> 0.130917).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0994278
	speed: 0.0629s/iter; left time: 1359.7810s
	iters: 200, epoch: 20 | loss: 0.0938291
	speed: 0.0102s/iter; left time: 219.9883s
Epoch: 20 cost time: 3.6627774238586426
Epoch: 20, Steps: 268 | Train Loss: 0.1300137 Vali Loss: 0.1309606 Test Loss: 0.1857421
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1027483
	speed: 0.0729s/iter; left time: 1554.9425s
	iters: 200, epoch: 21 | loss: 0.1201838
	speed: 0.0118s/iter; left time: 249.8134s
Epoch: 21 cost time: 3.832993268966675
Epoch: 21, Steps: 268 | Train Loss: 0.1301096 Vali Loss: 0.1308743 Test Loss: 0.1856999
Validation loss decreased (0.130917 --> 0.130874).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0902058
	speed: 0.0648s/iter; left time: 1365.3830s
	iters: 200, epoch: 22 | loss: 0.1261084
	speed: 0.0104s/iter; left time: 217.7949s
Epoch: 22 cost time: 3.521083116531372
Epoch: 22, Steps: 268 | Train Loss: 0.1302191 Vali Loss: 0.1307516 Test Loss: 0.1856110
Validation loss decreased (0.130874 --> 0.130752).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1075997
	speed: 0.0649s/iter; left time: 1350.8028s
	iters: 200, epoch: 23 | loss: 0.1684324
	speed: 0.0102s/iter; left time: 211.1579s
Epoch: 23 cost time: 3.7558815479278564
Epoch: 23, Steps: 268 | Train Loss: 0.1299551 Vali Loss: 0.1307105 Test Loss: 0.1856480
Validation loss decreased (0.130752 --> 0.130710).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1955131
	speed: 0.0645s/iter; left time: 1324.5310s
	iters: 200, epoch: 24 | loss: 0.1766298
	speed: 0.0100s/iter; left time: 205.3890s
Epoch: 24 cost time: 4.441104173660278
Epoch: 24, Steps: 268 | Train Loss: 0.1300240 Vali Loss: 0.1308102 Test Loss: 0.1856764
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0799195
	speed: 0.0663s/iter; left time: 1343.4452s
	iters: 200, epoch: 25 | loss: 0.1592942
	speed: 0.0190s/iter; left time: 382.8790s
Epoch: 25 cost time: 4.307605981826782
Epoch: 25, Steps: 268 | Train Loss: 0.1301649 Vali Loss: 0.1307970 Test Loss: 0.1856619
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1246479
	speed: 0.0612s/iter; left time: 1224.9273s
	iters: 200, epoch: 26 | loss: 0.1149698
	speed: 0.0179s/iter; left time: 356.2257s
Epoch: 26 cost time: 4.314271926879883
Epoch: 26, Steps: 268 | Train Loss: 0.1302158 Vali Loss: 0.1307731 Test Loss: 0.1856003
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0993369
	speed: 0.0645s/iter; left time: 1273.2551s
	iters: 200, epoch: 27 | loss: 0.1323635
	speed: 0.0102s/iter; left time: 200.9867s
Epoch: 27 cost time: 3.4438154697418213
Epoch: 27, Steps: 268 | Train Loss: 0.1301436 Vali Loss: 0.1308045 Test Loss: 0.1856355
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1503019
	speed: 0.0636s/iter; left time: 1238.7887s
	iters: 200, epoch: 28 | loss: 0.1140382
	speed: 0.0105s/iter; left time: 202.6274s
Epoch: 28 cost time: 3.4838290214538574
Epoch: 28, Steps: 268 | Train Loss: 0.1302300 Vali Loss: 0.1309016 Test Loss: 0.1856717
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1078772
	speed: 0.0695s/iter; left time: 1334.3090s
	iters: 200, epoch: 29 | loss: 0.1641162
	speed: 0.0143s/iter; left time: 272.5333s
Epoch: 29 cost time: 3.8085849285125732
Epoch: 29, Steps: 268 | Train Loss: 0.1301924 Vali Loss: 0.1308509 Test Loss: 0.1856232
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1356595
	speed: 0.0612s/iter; left time: 1157.6765s
	iters: 200, epoch: 30 | loss: 0.1072142
	speed: 0.0122s/iter; left time: 230.3833s
Epoch: 30 cost time: 3.6231679916381836
Epoch: 30, Steps: 268 | Train Loss: 0.1301794 Vali Loss: 0.1308645 Test Loss: 0.1856562
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1530700
	speed: 0.0605s/iter; left time: 1129.6447s
	iters: 200, epoch: 31 | loss: 0.1574799
	speed: 0.0104s/iter; left time: 193.3583s
Epoch: 31 cost time: 4.225212097167969
Epoch: 31, Steps: 268 | Train Loss: 0.1302214 Vali Loss: 0.1308591 Test Loss: 0.1856659
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1733427
	speed: 0.0746s/iter; left time: 1371.6403s
	iters: 200, epoch: 32 | loss: 0.1390856
	speed: 0.0111s/iter; left time: 203.2441s
Epoch: 32 cost time: 3.845299482345581
Epoch: 32, Steps: 268 | Train Loss: 0.1300933 Vali Loss: 0.1308673 Test Loss: 0.1856849
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1239796
	speed: 0.0611s/iter; left time: 1107.6288s
	iters: 200, epoch: 33 | loss: 0.1495787
	speed: 0.0115s/iter; left time: 207.1882s
Epoch: 33 cost time: 3.5724310874938965
Epoch: 33, Steps: 268 | Train Loss: 0.1301353 Vali Loss: 0.1309420 Test Loss: 0.1856763
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1085697
	speed: 0.0622s/iter; left time: 1110.0864s
	iters: 200, epoch: 34 | loss: 0.1232021
	speed: 0.0113s/iter; left time: 201.3712s
Epoch: 34 cost time: 3.65376877784729
Epoch: 34, Steps: 268 | Train Loss: 0.1302056 Vali Loss: 0.1308170 Test Loss: 0.1856482
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1484860
	speed: 0.0638s/iter; left time: 1121.6602s
	iters: 200, epoch: 35 | loss: 0.1259676
	speed: 0.0158s/iter; left time: 276.9176s
Epoch: 35 cost time: 4.077496767044067
Epoch: 35, Steps: 268 | Train Loss: 0.1301394 Vali Loss: 0.1308572 Test Loss: 0.1856560
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1632816
	speed: 0.0653s/iter; left time: 1131.7508s
	iters: 200, epoch: 36 | loss: 0.1216053
	speed: 0.0249s/iter; left time: 428.5782s
Epoch: 36 cost time: 5.539669752120972
Epoch: 36, Steps: 268 | Train Loss: 0.1301452 Vali Loss: 0.1309530 Test Loss: 0.1856525
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1293677
	speed: 0.0613s/iter; left time: 1045.0962s
	iters: 200, epoch: 37 | loss: 0.1607680
	speed: 0.0105s/iter; left time: 178.8182s
Epoch: 37 cost time: 3.490438461303711
Epoch: 37, Steps: 268 | Train Loss: 0.1302395 Vali Loss: 0.1308584 Test Loss: 0.1856515
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1205511
	speed: 0.0627s/iter; left time: 1051.6898s
	iters: 200, epoch: 38 | loss: 0.1051836
	speed: 0.0120s/iter; left time: 200.3872s
Epoch: 38 cost time: 3.8713996410369873
Epoch: 38, Steps: 268 | Train Loss: 0.1302354 Vali Loss: 0.1309304 Test Loss: 0.1856490
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1174862
	speed: 0.0632s/iter; left time: 1044.3302s
	iters: 200, epoch: 39 | loss: 0.1063592
	speed: 0.0109s/iter; left time: 179.7368s
Epoch: 39 cost time: 3.4347949028015137
Epoch: 39, Steps: 268 | Train Loss: 0.1300524 Vali Loss: 0.1307806 Test Loss: 0.1856407
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1431999
	speed: 0.0615s/iter; left time: 999.1142s
	iters: 200, epoch: 40 | loss: 0.1184210
	speed: 0.0112s/iter; left time: 181.2607s
Epoch: 40 cost time: 3.371396064758301
Epoch: 40, Steps: 268 | Train Loss: 0.1302526 Vali Loss: 0.1308538 Test Loss: 0.1856552
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1750438
	speed: 0.0700s/iter; left time: 1118.9541s
	iters: 200, epoch: 41 | loss: 0.1669040
	speed: 0.0109s/iter; left time: 173.1443s
Epoch: 41 cost time: 4.295437812805176
Epoch: 41, Steps: 268 | Train Loss: 0.1300667 Vali Loss: 0.1308523 Test Loss: 0.1856691
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1413180
	speed: 0.0635s/iter; left time: 998.2081s
	iters: 200, epoch: 42 | loss: 0.1113764
	speed: 0.0154s/iter; left time: 240.6273s
Epoch: 42 cost time: 4.080693960189819
Epoch: 42, Steps: 268 | Train Loss: 0.1302282 Vali Loss: 0.1308291 Test Loss: 0.1856691
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1073124
	speed: 0.0664s/iter; left time: 1025.7765s
	iters: 200, epoch: 43 | loss: 0.1512522
	speed: 0.0099s/iter; left time: 151.6271s
Epoch: 43 cost time: 3.7461905479431152
Epoch: 43, Steps: 268 | Train Loss: 0.1301739 Vali Loss: 0.1308911 Test Loss: 0.1856726
EarlyStopping counter: 20 out of 20
Early stopping
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3151209
	speed: 0.0185s/iter; left time: 493.4513s
	iters: 200, epoch: 1 | loss: 0.2106415
	speed: 0.0110s/iter; left time: 292.7743s
Epoch: 1 cost time: 3.6734821796417236
Epoch: 1, Steps: 268 | Train Loss: 0.2422611 Vali Loss: 0.1299492 Test Loss: 0.1847582
Validation loss decreased (inf --> 0.129949).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3480193
	speed: 0.0632s/iter; left time: 1671.8235s
	iters: 200, epoch: 2 | loss: 0.3245577
	speed: 0.0111s/iter; left time: 293.1407s
Epoch: 2 cost time: 3.7094497680664062
Epoch: 2, Steps: 268 | Train Loss: 0.2417171 Vali Loss: 0.1304191 Test Loss: 0.1849660
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2338467
	speed: 0.0629s/iter; left time: 1646.9041s
	iters: 200, epoch: 3 | loss: 0.1915326
	speed: 0.0106s/iter; left time: 277.0097s
Epoch: 3 cost time: 3.6153199672698975
Epoch: 3, Steps: 268 | Train Loss: 0.2412256 Vali Loss: 0.1305469 Test Loss: 0.1849981
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3336431
	speed: 0.0618s/iter; left time: 1600.4342s
	iters: 200, epoch: 4 | loss: 0.1884988
	speed: 0.0102s/iter; left time: 262.2730s
Epoch: 4 cost time: 3.404541015625
Epoch: 4, Steps: 268 | Train Loss: 0.2414140 Vali Loss: 0.1305644 Test Loss: 0.1849897
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1836014
	speed: 0.0624s/iter; left time: 1599.3620s
	iters: 200, epoch: 5 | loss: 0.2263278
	speed: 0.0107s/iter; left time: 272.3982s
Epoch: 5 cost time: 3.476750373840332
Epoch: 5, Steps: 268 | Train Loss: 0.2412947 Vali Loss: 0.1305679 Test Loss: 0.1849504
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3275000
	speed: 0.0618s/iter; left time: 1566.7008s
	iters: 200, epoch: 6 | loss: 0.1942559
	speed: 0.0103s/iter; left time: 260.7161s
Epoch: 6 cost time: 3.3715317249298096
Epoch: 6, Steps: 268 | Train Loss: 0.2411011 Vali Loss: 0.1303690 Test Loss: 0.1848103
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2160819
	speed: 0.0612s/iter; left time: 1535.6339s
	iters: 200, epoch: 7 | loss: 0.3946773
	speed: 0.0111s/iter; left time: 276.5261s
Epoch: 7 cost time: 3.655674457550049
Epoch: 7, Steps: 268 | Train Loss: 0.2410926 Vali Loss: 0.1303451 Test Loss: 0.1847540
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2258675
	speed: 0.0666s/iter; left time: 1654.0839s
	iters: 200, epoch: 8 | loss: 0.3800520
	speed: 0.0106s/iter; left time: 262.4675s
Epoch: 8 cost time: 3.432358741760254
Epoch: 8, Steps: 268 | Train Loss: 0.2409482 Vali Loss: 0.1302213 Test Loss: 0.1846908
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1861205
	speed: 0.0665s/iter; left time: 1633.5790s
	iters: 200, epoch: 9 | loss: 0.2176617
	speed: 0.0105s/iter; left time: 256.7993s
Epoch: 9 cost time: 3.317213535308838
Epoch: 9, Steps: 268 | Train Loss: 0.2406906 Vali Loss: 0.1304876 Test Loss: 0.1848753
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1960996
	speed: 0.0598s/iter; left time: 1452.1785s
	iters: 200, epoch: 10 | loss: 0.2726943
	speed: 0.0120s/iter; left time: 290.7343s
Epoch: 10 cost time: 3.5820600986480713
Epoch: 10, Steps: 268 | Train Loss: 0.2410586 Vali Loss: 0.1304350 Test Loss: 0.1848298
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2008006
	speed: 0.0615s/iter; left time: 1476.5336s
	iters: 200, epoch: 11 | loss: 0.2386001
	speed: 0.0100s/iter; left time: 238.7674s
Epoch: 11 cost time: 3.517709255218506
Epoch: 11, Steps: 268 | Train Loss: 0.2408111 Vali Loss: 0.1304960 Test Loss: 0.1848519
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1918245
	speed: 0.0604s/iter; left time: 1433.9979s
	iters: 200, epoch: 12 | loss: 0.1893120
	speed: 0.0108s/iter; left time: 255.0918s
Epoch: 12 cost time: 3.492079734802246
Epoch: 12, Steps: 268 | Train Loss: 0.2410200 Vali Loss: 0.1303080 Test Loss: 0.1847213
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2243185
	speed: 0.0777s/iter; left time: 1824.4811s
	iters: 200, epoch: 13 | loss: 0.3064889
	speed: 0.0184s/iter; left time: 430.6908s
Epoch: 13 cost time: 4.926714181900024
Epoch: 13, Steps: 268 | Train Loss: 0.2406587 Vali Loss: 0.1304059 Test Loss: 0.1847502
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2005590
	speed: 0.0744s/iter; left time: 1728.3082s
	iters: 200, epoch: 14 | loss: 0.3441232
	speed: 0.0113s/iter; left time: 260.9306s
Epoch: 14 cost time: 4.300408363342285
Epoch: 14, Steps: 268 | Train Loss: 0.2406637 Vali Loss: 0.1302906 Test Loss: 0.1846711
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2613543
	speed: 0.1278s/iter; left time: 2931.9081s
	iters: 200, epoch: 15 | loss: 0.1975524
	speed: 0.0362s/iter; left time: 827.0764s
Epoch: 15 cost time: 10.623351097106934
Epoch: 15, Steps: 268 | Train Loss: 0.2405402 Vali Loss: 0.1302171 Test Loss: 0.1846287
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2713504
	speed: 0.1244s/iter; left time: 2821.7934s
	iters: 200, epoch: 16 | loss: 0.1763359
	speed: 0.0121s/iter; left time: 272.3952s
Epoch: 16 cost time: 5.002689361572266
Epoch: 16, Steps: 268 | Train Loss: 0.2409023 Vali Loss: 0.1303319 Test Loss: 0.1847163
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3482676
	speed: 0.0830s/iter; left time: 1860.4204s
	iters: 200, epoch: 17 | loss: 0.1744169
	speed: 0.0127s/iter; left time: 283.3867s
Epoch: 17 cost time: 5.6849353313446045
Epoch: 17, Steps: 268 | Train Loss: 0.2406795 Vali Loss: 0.1304112 Test Loss: 0.1847607
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2275644
	speed: 0.1061s/iter; left time: 2350.1677s
	iters: 200, epoch: 18 | loss: 0.1820635
	speed: 0.0293s/iter; left time: 646.8788s
Epoch: 18 cost time: 7.747172117233276
Epoch: 18, Steps: 268 | Train Loss: 0.2405368 Vali Loss: 0.1303035 Test Loss: 0.1847074
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2379101
	speed: 0.1313s/iter; left time: 2871.8319s
	iters: 200, epoch: 19 | loss: 0.2587807
	speed: 0.0270s/iter; left time: 588.8159s
Epoch: 19 cost time: 9.41342830657959
Epoch: 19, Steps: 268 | Train Loss: 0.2405439 Vali Loss: 0.1303561 Test Loss: 0.1847097
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2615580
	speed: 0.1458s/iter; left time: 3150.4540s
	iters: 200, epoch: 20 | loss: 0.2480118
	speed: 0.0114s/iter; left time: 244.6556s
Epoch: 20 cost time: 6.645446300506592
Epoch: 20, Steps: 268 | Train Loss: 0.2405255 Vali Loss: 0.1303843 Test Loss: 0.1847435
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1406183
	speed: 0.1339s/iter; left time: 2858.2073s
	iters: 200, epoch: 21 | loss: 0.2199322
	speed: 0.0359s/iter; left time: 763.5299s
Epoch: 21 cost time: 10.297303915023804
Epoch: 21, Steps: 268 | Train Loss: 0.2408356 Vali Loss: 0.1303719 Test Loss: 0.1847095
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1856154501438141, mae:0.26927512884140015, rse:0.3493037223815918, corr:[0.5707599  0.5709171  0.56751317 0.5639208  0.5621992  0.56199706
 0.5616065  0.56032753 0.55885404 0.55790776 0.5574406  0.55691236
 0.5560879  0.55527943 0.554764   0.5543047  0.5535125  0.5522848
 0.55100477 0.5499979  0.5492379  0.548486   0.54761803 0.54683167
 0.5462955  0.5458559  0.54533523 0.5445867  0.5437299  0.5430915
 0.5426121  0.5421281  0.5414606  0.54074407 0.5402313  0.5400013
 0.5396736  0.5389808  0.53801966 0.53704906 0.53630376 0.5359028
 0.53565156 0.5353605  0.5350164  0.53456575 0.53405035 0.53331685
 0.53240407 0.5314792  0.53067064 0.53002834 0.52939403 0.5285907
 0.527783   0.5270835  0.52643394 0.5258513  0.5253076  0.52498955
 0.5248138  0.5246833  0.5245687  0.52449125 0.5244102  0.52435875
 0.52435416 0.52430195 0.5243187  0.5244056  0.52454925 0.52474344
 0.5248583  0.52495325 0.52494127 0.5248886  0.524899   0.52490467
 0.52490354 0.5248807  0.52484417 0.52475786 0.52464545 0.5245147
 0.5243652  0.52423286 0.5241082  0.5239944  0.52383125 0.5236239
 0.52355987 0.52378607 0.5238809  0.5236165  0.52266866 0.5208639 ]
