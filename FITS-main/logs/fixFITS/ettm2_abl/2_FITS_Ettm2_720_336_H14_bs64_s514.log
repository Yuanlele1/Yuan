Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=514, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=122, out_features=178, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  19457536.0
params:  21894.0
Trainable parameters:  21894
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4143320
	speed: 0.0259s/iter; left time: 673.2713s
	iters: 200, epoch: 1 | loss: 0.3289007
	speed: 0.0178s/iter; left time: 460.8729s
Epoch: 1 cost time: 5.4773242473602295
Epoch: 1, Steps: 261 | Train Loss: 0.3167923 Vali Loss: 0.2318651 Test Loss: 0.3100335
Validation loss decreased (inf --> 0.231865).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1830605
	speed: 0.0691s/iter; left time: 1778.0102s
	iters: 200, epoch: 2 | loss: 0.2142398
	speed: 0.0151s/iter; left time: 387.4217s
Epoch: 2 cost time: 4.667436838150024
Epoch: 2, Steps: 261 | Train Loss: 0.2048534 Vali Loss: 0.2166414 Test Loss: 0.2913207
Validation loss decreased (0.231865 --> 0.216641).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1655610
	speed: 0.0702s/iter; left time: 1788.7338s
	iters: 200, epoch: 3 | loss: 0.1679405
	speed: 0.0196s/iter; left time: 497.1019s
Epoch: 3 cost time: 4.986112356185913
Epoch: 3, Steps: 261 | Train Loss: 0.1692750 Vali Loss: 0.2096512 Test Loss: 0.2836223
Validation loss decreased (0.216641 --> 0.209651).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1892656
	speed: 0.0668s/iter; left time: 1684.2262s
	iters: 200, epoch: 4 | loss: 0.1461818
	speed: 0.0151s/iter; left time: 379.9032s
Epoch: 4 cost time: 4.47324538230896
Epoch: 4, Steps: 261 | Train Loss: 0.1515448 Vali Loss: 0.2052266 Test Loss: 0.2790268
Validation loss decreased (0.209651 --> 0.205227).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0957512
	speed: 0.0689s/iter; left time: 1719.7437s
	iters: 200, epoch: 5 | loss: 0.1597818
	speed: 0.0162s/iter; left time: 403.1972s
Epoch: 5 cost time: 4.760597467422485
Epoch: 5, Steps: 261 | Train Loss: 0.1417204 Vali Loss: 0.2020715 Test Loss: 0.2758742
Validation loss decreased (0.205227 --> 0.202071).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2132936
	speed: 0.0774s/iter; left time: 1912.0554s
	iters: 200, epoch: 6 | loss: 0.1266947
	speed: 0.0169s/iter; left time: 416.4090s
Epoch: 6 cost time: 5.583263635635376
Epoch: 6, Steps: 261 | Train Loss: 0.1364317 Vali Loss: 0.2000697 Test Loss: 0.2740397
Validation loss decreased (0.202071 --> 0.200070).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1368743
	speed: 0.0705s/iter; left time: 1723.3468s
	iters: 200, epoch: 7 | loss: 0.0935616
	speed: 0.0160s/iter; left time: 390.4468s
Epoch: 7 cost time: 4.739863872528076
Epoch: 7, Steps: 261 | Train Loss: 0.1334495 Vali Loss: 0.1986566 Test Loss: 0.2731696
Validation loss decreased (0.200070 --> 0.198657).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1411313
	speed: 0.0683s/iter; left time: 1650.0662s
	iters: 200, epoch: 8 | loss: 0.1584075
	speed: 0.0170s/iter; left time: 409.3485s
Epoch: 8 cost time: 4.7744481563568115
Epoch: 8, Steps: 261 | Train Loss: 0.1315664 Vali Loss: 0.1976611 Test Loss: 0.2725955
Validation loss decreased (0.198657 --> 0.197661).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1001587
	speed: 0.0675s/iter; left time: 1614.9672s
	iters: 200, epoch: 9 | loss: 0.1211738
	speed: 0.0159s/iter; left time: 378.9126s
Epoch: 9 cost time: 4.586061000823975
Epoch: 9, Steps: 261 | Train Loss: 0.1308692 Vali Loss: 0.1970732 Test Loss: 0.2721737
Validation loss decreased (0.197661 --> 0.197073).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1060850
	speed: 0.0667s/iter; left time: 1577.6812s
	iters: 200, epoch: 10 | loss: 0.1155172
	speed: 0.0162s/iter; left time: 382.3761s
Epoch: 10 cost time: 4.601074695587158
Epoch: 10, Steps: 261 | Train Loss: 0.1299858 Vali Loss: 0.1965004 Test Loss: 0.2721252
Validation loss decreased (0.197073 --> 0.196500).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1356282
	speed: 0.0705s/iter; left time: 1650.1171s
	iters: 200, epoch: 11 | loss: 0.1146451
	speed: 0.0178s/iter; left time: 415.3262s
Epoch: 11 cost time: 5.387758731842041
Epoch: 11, Steps: 261 | Train Loss: 0.1296867 Vali Loss: 0.1964087 Test Loss: 0.2718983
Validation loss decreased (0.196500 --> 0.196409).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1308337
	speed: 0.0811s/iter; left time: 1875.3023s
	iters: 200, epoch: 12 | loss: 0.1126080
	speed: 0.0269s/iter; left time: 618.9947s
Epoch: 12 cost time: 6.4637672901153564
Epoch: 12, Steps: 261 | Train Loss: 0.1295462 Vali Loss: 0.1961459 Test Loss: 0.2719166
Validation loss decreased (0.196409 --> 0.196146).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1582402
	speed: 0.0729s/iter; left time: 1666.8837s
	iters: 200, epoch: 13 | loss: 0.1277731
	speed: 0.0172s/iter; left time: 391.1058s
Epoch: 13 cost time: 4.774224758148193
Epoch: 13, Steps: 261 | Train Loss: 0.1294158 Vali Loss: 0.1960072 Test Loss: 0.2717340
Validation loss decreased (0.196146 --> 0.196007).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1160540
	speed: 0.0750s/iter; left time: 1695.4089s
	iters: 200, epoch: 14 | loss: 0.0990105
	speed: 0.0157s/iter; left time: 352.5719s
Epoch: 14 cost time: 5.173046588897705
Epoch: 14, Steps: 261 | Train Loss: 0.1295471 Vali Loss: 0.1962517 Test Loss: 0.2718922
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1519382
	speed: 0.0655s/iter; left time: 1463.4982s
	iters: 200, epoch: 15 | loss: 0.1201796
	speed: 0.0165s/iter; left time: 367.5950s
Epoch: 15 cost time: 4.665956258773804
Epoch: 15, Steps: 261 | Train Loss: 0.1295054 Vali Loss: 0.1960898 Test Loss: 0.2717798
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1143694
	speed: 0.0750s/iter; left time: 1656.3066s
	iters: 200, epoch: 16 | loss: 0.1411573
	speed: 0.0158s/iter; left time: 348.3230s
Epoch: 16 cost time: 4.654379844665527
Epoch: 16, Steps: 261 | Train Loss: 0.1294211 Vali Loss: 0.1960575 Test Loss: 0.2719336
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0975536
	speed: 0.0725s/iter; left time: 1582.8352s
	iters: 200, epoch: 17 | loss: 0.1627143
	speed: 0.0168s/iter; left time: 364.2484s
Epoch: 17 cost time: 5.046463251113892
Epoch: 17, Steps: 261 | Train Loss: 0.1293655 Vali Loss: 0.1960548 Test Loss: 0.2718105
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1081228
	speed: 0.0708s/iter; left time: 1527.5036s
	iters: 200, epoch: 18 | loss: 0.1333456
	speed: 0.0162s/iter; left time: 346.7283s
Epoch: 18 cost time: 4.8841941356658936
Epoch: 18, Steps: 261 | Train Loss: 0.1293267 Vali Loss: 0.1960654 Test Loss: 0.2718790
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0924770
	speed: 0.0749s/iter; left time: 1594.6181s
	iters: 200, epoch: 19 | loss: 0.0952528
	speed: 0.0165s/iter; left time: 348.9283s
Epoch: 19 cost time: 4.560041904449463
Epoch: 19, Steps: 261 | Train Loss: 0.1293222 Vali Loss: 0.1958684 Test Loss: 0.2717273
Validation loss decreased (0.196007 --> 0.195868).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1146343
	speed: 0.0737s/iter; left time: 1551.3995s
	iters: 200, epoch: 20 | loss: 0.1084567
	speed: 0.0257s/iter; left time: 538.6511s
Epoch: 20 cost time: 6.137906312942505
Epoch: 20, Steps: 261 | Train Loss: 0.1291475 Vali Loss: 0.1958882 Test Loss: 0.2717452
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1444931
	speed: 0.0756s/iter; left time: 1570.8200s
	iters: 200, epoch: 21 | loss: 0.1517323
	speed: 0.0226s/iter; left time: 466.6477s
Epoch: 21 cost time: 6.116000413894653
Epoch: 21, Steps: 261 | Train Loss: 0.1291777 Vali Loss: 0.1959256 Test Loss: 0.2717666
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1316518
	speed: 0.0750s/iter; left time: 1539.2339s
	iters: 200, epoch: 22 | loss: 0.1598357
	speed: 0.0183s/iter; left time: 373.2782s
Epoch: 22 cost time: 5.435863733291626
Epoch: 22, Steps: 261 | Train Loss: 0.1293357 Vali Loss: 0.1958688 Test Loss: 0.2717623
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1482968
	speed: 0.0764s/iter; left time: 1547.5481s
	iters: 200, epoch: 23 | loss: 0.1553539
	speed: 0.0206s/iter; left time: 415.7351s
Epoch: 23 cost time: 5.337535858154297
Epoch: 23, Steps: 261 | Train Loss: 0.1292924 Vali Loss: 0.1958775 Test Loss: 0.2716765
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1033904
	speed: 0.0741s/iter; left time: 1482.1161s
	iters: 200, epoch: 24 | loss: 0.1004366
	speed: 0.0197s/iter; left time: 391.2450s
Epoch: 24 cost time: 5.1233069896698
Epoch: 24, Steps: 261 | Train Loss: 0.1292967 Vali Loss: 0.1958897 Test Loss: 0.2717889
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1121345
	speed: 0.0706s/iter; left time: 1392.9606s
	iters: 200, epoch: 25 | loss: 0.1607777
	speed: 0.0154s/iter; left time: 302.4967s
Epoch: 25 cost time: 4.517047166824341
Epoch: 25, Steps: 261 | Train Loss: 0.1292664 Vali Loss: 0.1960599 Test Loss: 0.2717110
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0958827
	speed: 0.0676s/iter; left time: 1317.3082s
	iters: 200, epoch: 26 | loss: 0.1257669
	speed: 0.0163s/iter; left time: 316.5013s
Epoch: 26 cost time: 4.680938482284546
Epoch: 26, Steps: 261 | Train Loss: 0.1289674 Vali Loss: 0.1960528 Test Loss: 0.2717814
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1472830
	speed: 0.0684s/iter; left time: 1315.1076s
	iters: 200, epoch: 27 | loss: 0.0855037
	speed: 0.0169s/iter; left time: 322.5186s
Epoch: 27 cost time: 4.783661365509033
Epoch: 27, Steps: 261 | Train Loss: 0.1291728 Vali Loss: 0.1960378 Test Loss: 0.2717418
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1274269
	speed: 0.0677s/iter; left time: 1283.1571s
	iters: 200, epoch: 28 | loss: 0.1363702
	speed: 0.0170s/iter; left time: 321.1196s
Epoch: 28 cost time: 4.589572191238403
Epoch: 28, Steps: 261 | Train Loss: 0.1292723 Vali Loss: 0.1959411 Test Loss: 0.2717584
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1159784
	speed: 0.0662s/iter; left time: 1238.2323s
	iters: 200, epoch: 29 | loss: 0.1729131
	speed: 0.0170s/iter; left time: 315.7008s
Epoch: 29 cost time: 4.696278095245361
Epoch: 29, Steps: 261 | Train Loss: 0.1292183 Vali Loss: 0.1960560 Test Loss: 0.2717760
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1119555
	speed: 0.0671s/iter; left time: 1236.2185s
	iters: 200, epoch: 30 | loss: 0.1303975
	speed: 0.0176s/iter; left time: 323.4994s
Epoch: 30 cost time: 4.711587190628052
Epoch: 30, Steps: 261 | Train Loss: 0.1291936 Vali Loss: 0.1958701 Test Loss: 0.2716855
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1549948
	speed: 0.0692s/iter; left time: 1257.1252s
	iters: 200, epoch: 31 | loss: 0.0977810
	speed: 0.0164s/iter; left time: 297.0126s
Epoch: 31 cost time: 4.723949432373047
Epoch: 31, Steps: 261 | Train Loss: 0.1290895 Vali Loss: 0.1960014 Test Loss: 0.2717829
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1743670
	speed: 0.0708s/iter; left time: 1268.2946s
	iters: 200, epoch: 32 | loss: 0.1250260
	speed: 0.0192s/iter; left time: 341.5289s
Epoch: 32 cost time: 5.320783376693726
Epoch: 32, Steps: 261 | Train Loss: 0.1292673 Vali Loss: 0.1957654 Test Loss: 0.2717794
Validation loss decreased (0.195868 --> 0.195765).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1196098
	speed: 0.0785s/iter; left time: 1386.0079s
	iters: 200, epoch: 33 | loss: 0.0989256
	speed: 0.0174s/iter; left time: 306.1680s
Epoch: 33 cost time: 4.861909627914429
Epoch: 33, Steps: 261 | Train Loss: 0.1291225 Vali Loss: 0.1959292 Test Loss: 0.2717316
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1202152
	speed: 0.0693s/iter; left time: 1205.0889s
	iters: 200, epoch: 34 | loss: 0.1562430
	speed: 0.0223s/iter; left time: 386.2709s
Epoch: 34 cost time: 5.46743631362915
Epoch: 34, Steps: 261 | Train Loss: 0.1291772 Vali Loss: 0.1960329 Test Loss: 0.2717260
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1231562
	speed: 0.0760s/iter; left time: 1301.0928s
	iters: 200, epoch: 35 | loss: 0.1284672
	speed: 0.0197s/iter; left time: 335.8459s
Epoch: 35 cost time: 5.59965705871582
Epoch: 35, Steps: 261 | Train Loss: 0.1290285 Vali Loss: 0.1959013 Test Loss: 0.2717225
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1473157
	speed: 0.0769s/iter; left time: 1296.7842s
	iters: 200, epoch: 36 | loss: 0.1360933
	speed: 0.0164s/iter; left time: 275.4356s
Epoch: 36 cost time: 4.647441625595093
Epoch: 36, Steps: 261 | Train Loss: 0.1291564 Vali Loss: 0.1958388 Test Loss: 0.2717618
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1295578
	speed: 0.0682s/iter; left time: 1131.8009s
	iters: 200, epoch: 37 | loss: 0.0929982
	speed: 0.0164s/iter; left time: 270.2213s
Epoch: 37 cost time: 4.703223705291748
Epoch: 37, Steps: 261 | Train Loss: 0.1291688 Vali Loss: 0.1959148 Test Loss: 0.2717663
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1115021
	speed: 0.0672s/iter; left time: 1098.1519s
	iters: 200, epoch: 38 | loss: 0.0803943
	speed: 0.0154s/iter; left time: 250.2620s
Epoch: 38 cost time: 4.584901571273804
Epoch: 38, Steps: 261 | Train Loss: 0.1291240 Vali Loss: 0.1958788 Test Loss: 0.2717060
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1252922
	speed: 0.0705s/iter; left time: 1134.6208s
	iters: 200, epoch: 39 | loss: 0.1375783
	speed: 0.0158s/iter; left time: 253.3157s
Epoch: 39 cost time: 4.659911155700684
Epoch: 39, Steps: 261 | Train Loss: 0.1291217 Vali Loss: 0.1959302 Test Loss: 0.2717335
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1382892
	speed: 0.0689s/iter; left time: 1089.8515s
	iters: 200, epoch: 40 | loss: 0.1064580
	speed: 0.0163s/iter; left time: 255.8214s
Epoch: 40 cost time: 4.8215484619140625
Epoch: 40, Steps: 261 | Train Loss: 0.1291317 Vali Loss: 0.1960591 Test Loss: 0.2717088
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1264069
	speed: 0.0689s/iter; left time: 1072.6318s
	iters: 200, epoch: 41 | loss: 0.0921675
	speed: 0.0164s/iter; left time: 253.6873s
Epoch: 41 cost time: 4.757015943527222
Epoch: 41, Steps: 261 | Train Loss: 0.1292046 Vali Loss: 0.1960208 Test Loss: 0.2716792
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0715260
	speed: 0.0646s/iter; left time: 987.7346s
	iters: 200, epoch: 42 | loss: 0.1013511
	speed: 0.0162s/iter; left time: 245.9524s
Epoch: 42 cost time: 4.529331684112549
Epoch: 42, Steps: 261 | Train Loss: 0.1292463 Vali Loss: 0.1959191 Test Loss: 0.2716983
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1056658
	speed: 0.0674s/iter; left time: 1013.6751s
	iters: 200, epoch: 43 | loss: 0.2031011
	speed: 0.0163s/iter; left time: 244.2175s
Epoch: 43 cost time: 5.868583917617798
Epoch: 43, Steps: 261 | Train Loss: 0.1292306 Vali Loss: 0.1959154 Test Loss: 0.2717027
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1233040
	speed: 0.0821s/iter; left time: 1213.8278s
	iters: 200, epoch: 44 | loss: 0.1061754
	speed: 0.0163s/iter; left time: 239.4705s
Epoch: 44 cost time: 5.0941855907440186
Epoch: 44, Steps: 261 | Train Loss: 0.1292256 Vali Loss: 0.1959166 Test Loss: 0.2716779
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1298264
	speed: 0.0682s/iter; left time: 990.2588s
	iters: 200, epoch: 45 | loss: 0.1389829
	speed: 0.0178s/iter; left time: 257.1177s
Epoch: 45 cost time: 5.0963828563690186
Epoch: 45, Steps: 261 | Train Loss: 0.1290948 Vali Loss: 0.1957915 Test Loss: 0.2716809
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0932644
	speed: 0.0728s/iter; left time: 1037.5453s
	iters: 200, epoch: 46 | loss: 0.1298544
	speed: 0.0196s/iter; left time: 277.4946s
Epoch: 46 cost time: 5.087734222412109
Epoch: 46, Steps: 261 | Train Loss: 0.1290197 Vali Loss: 0.1960278 Test Loss: 0.2716741
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1066080
	speed: 0.0747s/iter; left time: 1045.4639s
	iters: 200, epoch: 47 | loss: 0.0869049
	speed: 0.0163s/iter; left time: 226.9836s
Epoch: 47 cost time: 4.570440053939819
Epoch: 47, Steps: 261 | Train Loss: 0.1290369 Vali Loss: 0.1960195 Test Loss: 0.2716832
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.0985732
	speed: 0.0680s/iter; left time: 933.5937s
	iters: 200, epoch: 48 | loss: 0.1109009
	speed: 0.0157s/iter; left time: 214.6510s
Epoch: 48 cost time: 4.706159591674805
Epoch: 48, Steps: 261 | Train Loss: 0.1290989 Vali Loss: 0.1958959 Test Loss: 0.2716714
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1156582
	speed: 0.0670s/iter; left time: 902.3570s
	iters: 200, epoch: 49 | loss: 0.1274679
	speed: 0.0163s/iter; left time: 218.3190s
Epoch: 49 cost time: 4.75297212600708
Epoch: 49, Steps: 261 | Train Loss: 0.1290278 Vali Loss: 0.1959296 Test Loss: 0.2716517
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1360497
	speed: 0.0697s/iter; left time: 921.0025s
	iters: 200, epoch: 50 | loss: 0.0923980
	speed: 0.0157s/iter; left time: 205.6229s
Epoch: 50 cost time: 4.724752902984619
Epoch: 50, Steps: 261 | Train Loss: 0.1291847 Vali Loss: 0.1958448 Test Loss: 0.2716735
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1288986
	speed: 0.0673s/iter; left time: 871.1118s
	iters: 200, epoch: 51 | loss: 0.1136124
	speed: 0.0154s/iter; left time: 198.0378s
Epoch: 51 cost time: 4.660431861877441
Epoch: 51, Steps: 261 | Train Loss: 0.1291787 Vali Loss: 0.1956775 Test Loss: 0.2716690
Validation loss decreased (0.195765 --> 0.195678).  Saving model ...
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1170009
	speed: 0.0671s/iter; left time: 851.9845s
	iters: 200, epoch: 52 | loss: 0.0849385
	speed: 0.0164s/iter; left time: 206.6679s
Epoch: 52 cost time: 4.712931394577026
Epoch: 52, Steps: 261 | Train Loss: 0.1290496 Vali Loss: 0.1958867 Test Loss: 0.2716779
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1505801
	speed: 0.0663s/iter; left time: 823.5339s
	iters: 200, epoch: 53 | loss: 0.1342977
	speed: 0.0153s/iter; left time: 188.2004s
Epoch: 53 cost time: 4.358657121658325
Epoch: 53, Steps: 261 | Train Loss: 0.1292237 Vali Loss: 0.1958954 Test Loss: 0.2716751
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1527921
	speed: 0.0665s/iter; left time: 809.1105s
	iters: 200, epoch: 54 | loss: 0.1409795
	speed: 0.0170s/iter; left time: 204.8552s
Epoch: 54 cost time: 4.716703414916992
Epoch: 54, Steps: 261 | Train Loss: 0.1293132 Vali Loss: 0.1958273 Test Loss: 0.2716832
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1114154
	speed: 0.0653s/iter; left time: 778.0575s
	iters: 200, epoch: 55 | loss: 0.1190736
	speed: 0.0167s/iter; left time: 197.5472s
Epoch: 55 cost time: 4.639251232147217
Epoch: 55, Steps: 261 | Train Loss: 0.1291895 Vali Loss: 0.1959368 Test Loss: 0.2716638
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1267868
	speed: 0.0740s/iter; left time: 861.7367s
	iters: 200, epoch: 56 | loss: 0.1191982
	speed: 0.0166s/iter; left time: 192.1848s
Epoch: 56 cost time: 5.268897771835327
Epoch: 56, Steps: 261 | Train Loss: 0.1291632 Vali Loss: 0.1956840 Test Loss: 0.2716782
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1456201
	speed: 0.0762s/iter; left time: 867.7000s
	iters: 200, epoch: 57 | loss: 0.1437132
	speed: 0.0162s/iter; left time: 182.4537s
Epoch: 57 cost time: 5.5509257316589355
Epoch: 57, Steps: 261 | Train Loss: 0.1291456 Vali Loss: 0.1960261 Test Loss: 0.2716767
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1490840
	speed: 0.0747s/iter; left time: 830.5359s
	iters: 200, epoch: 58 | loss: 0.1818780
	speed: 0.0157s/iter; left time: 173.5675s
Epoch: 58 cost time: 4.888180494308472
Epoch: 58, Steps: 261 | Train Loss: 0.1292718 Vali Loss: 0.1958658 Test Loss: 0.2716729
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1534078
	speed: 0.0741s/iter; left time: 804.4443s
	iters: 200, epoch: 59 | loss: 0.1299965
	speed: 0.0165s/iter; left time: 177.1081s
Epoch: 59 cost time: 4.947930335998535
Epoch: 59, Steps: 261 | Train Loss: 0.1291680 Vali Loss: 0.1958435 Test Loss: 0.2716646
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.0955232
	speed: 0.0751s/iter; left time: 796.3545s
	iters: 200, epoch: 60 | loss: 0.1239022
	speed: 0.0158s/iter; left time: 166.2957s
Epoch: 60 cost time: 5.450899839401245
Epoch: 60, Steps: 261 | Train Loss: 0.1290699 Vali Loss: 0.1958031 Test Loss: 0.2716782
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1089450
	speed: 0.0949s/iter; left time: 981.3699s
	iters: 200, epoch: 61 | loss: 0.1022687
	speed: 0.0168s/iter; left time: 171.9482s
Epoch: 61 cost time: 5.045058727264404
Epoch: 61, Steps: 261 | Train Loss: 0.1290691 Vali Loss: 0.1959970 Test Loss: 0.2716644
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.0906716
	speed: 0.0720s/iter; left time: 725.5231s
	iters: 200, epoch: 62 | loss: 0.1497848
	speed: 0.0168s/iter; left time: 167.6894s
Epoch: 62 cost time: 4.831689119338989
Epoch: 62, Steps: 261 | Train Loss: 0.1291849 Vali Loss: 0.1959270 Test Loss: 0.2716710
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1029813
	speed: 0.0677s/iter; left time: 664.5403s
	iters: 200, epoch: 63 | loss: 0.1353186
	speed: 0.0165s/iter; left time: 160.2510s
Epoch: 63 cost time: 4.667834997177124
Epoch: 63, Steps: 261 | Train Loss: 0.1290205 Vali Loss: 0.1959980 Test Loss: 0.2716708
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1455627
	speed: 0.0779s/iter; left time: 744.7475s
	iters: 200, epoch: 64 | loss: 0.0970636
	speed: 0.0166s/iter; left time: 156.7767s
Epoch: 64 cost time: 6.4009716510772705
Epoch: 64, Steps: 261 | Train Loss: 0.1290669 Vali Loss: 0.1958683 Test Loss: 0.2716834
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1588808
	speed: 0.0871s/iter; left time: 809.8393s
	iters: 200, epoch: 65 | loss: 0.1398081
	speed: 0.0170s/iter; left time: 156.1207s
Epoch: 65 cost time: 5.588501691818237
Epoch: 65, Steps: 261 | Train Loss: 0.1291818 Vali Loss: 0.1959280 Test Loss: 0.2716815
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1555044
	speed: 0.0785s/iter; left time: 708.9523s
	iters: 200, epoch: 66 | loss: 0.2100690
	speed: 0.0158s/iter; left time: 140.9135s
Epoch: 66 cost time: 5.349055767059326
Epoch: 66, Steps: 261 | Train Loss: 0.1290964 Vali Loss: 0.1960480 Test Loss: 0.2716794
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1336739
	speed: 0.0744s/iter; left time: 652.9932s
	iters: 200, epoch: 67 | loss: 0.1061765
	speed: 0.0175s/iter; left time: 151.3803s
Epoch: 67 cost time: 5.082230091094971
Epoch: 67, Steps: 261 | Train Loss: 0.1292225 Vali Loss: 0.1958287 Test Loss: 0.2716708
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1265035
	speed: 0.0698s/iter; left time: 593.8895s
	iters: 200, epoch: 68 | loss: 0.1531486
	speed: 0.0184s/iter; left time: 154.6032s
Epoch: 68 cost time: 4.937349557876587
Epoch: 68, Steps: 261 | Train Loss: 0.1290928 Vali Loss: 0.1957502 Test Loss: 0.2716759
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1024311
	speed: 0.0874s/iter; left time: 720.9197s
	iters: 200, epoch: 69 | loss: 0.1621980
	speed: 0.0268s/iter; left time: 218.5634s
Epoch: 69 cost time: 6.000888109207153
Epoch: 69, Steps: 261 | Train Loss: 0.1292769 Vali Loss: 0.1959111 Test Loss: 0.2716699
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1514268
	speed: 0.0753s/iter; left time: 601.7874s
	iters: 200, epoch: 70 | loss: 0.1964839
	speed: 0.0188s/iter; left time: 148.3670s
Epoch: 70 cost time: 5.554095506668091
Epoch: 70, Steps: 261 | Train Loss: 0.1290318 Vali Loss: 0.1957852 Test Loss: 0.2716813
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.0881961
	speed: 0.0798s/iter; left time: 616.5803s
	iters: 200, epoch: 71 | loss: 0.1143097
	speed: 0.0207s/iter; left time: 158.2839s
Epoch: 71 cost time: 5.764632701873779
Epoch: 71, Steps: 261 | Train Loss: 0.1292150 Vali Loss: 0.1957749 Test Loss: 0.2716745
EarlyStopping counter: 20 out of 20
Early stopping
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=122, out_features=178, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  19457536.0
params:  21894.0
Trainable parameters:  21894
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5126347
	speed: 0.0234s/iter; left time: 609.5759s
	iters: 200, epoch: 1 | loss: 0.3261660
	speed: 0.0186s/iter; left time: 480.5025s
Epoch: 1 cost time: 5.1841418743133545
Epoch: 1, Steps: 261 | Train Loss: 0.3790128 Vali Loss: 0.1941084 Test Loss: 0.2695524
Validation loss decreased (inf --> 0.194108).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3360614
	speed: 0.0748s/iter; left time: 1925.5825s
	iters: 200, epoch: 2 | loss: 0.3083317
	speed: 0.0185s/iter; left time: 473.7616s
Epoch: 2 cost time: 5.104936122894287
Epoch: 2, Steps: 261 | Train Loss: 0.3776506 Vali Loss: 0.1932143 Test Loss: 0.2686624
Validation loss decreased (0.194108 --> 0.193214).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2893903
	speed: 0.0730s/iter; left time: 1861.0565s
	iters: 200, epoch: 3 | loss: 0.2558252
	speed: 0.0269s/iter; left time: 682.2689s
Epoch: 3 cost time: 5.859966516494751
Epoch: 3, Steps: 261 | Train Loss: 0.3765116 Vali Loss: 0.1934354 Test Loss: 0.2685106
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3018877
	speed: 0.0707s/iter; left time: 1782.2492s
	iters: 200, epoch: 4 | loss: 0.3110123
	speed: 0.0162s/iter; left time: 407.4119s
Epoch: 4 cost time: 4.596582889556885
Epoch: 4, Steps: 261 | Train Loss: 0.3760552 Vali Loss: 0.1928450 Test Loss: 0.2679327
Validation loss decreased (0.193214 --> 0.192845).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3430461
	speed: 0.0688s/iter; left time: 1717.1621s
	iters: 200, epoch: 5 | loss: 0.2940139
	speed: 0.0187s/iter; left time: 463.9945s
Epoch: 5 cost time: 5.026752710342407
Epoch: 5, Steps: 261 | Train Loss: 0.3755354 Vali Loss: 0.1930320 Test Loss: 0.2680877
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.5051698
	speed: 0.0741s/iter; left time: 1830.2478s
	iters: 200, epoch: 6 | loss: 0.3885438
	speed: 0.0168s/iter; left time: 413.2757s
Epoch: 6 cost time: 5.247302770614624
Epoch: 6, Steps: 261 | Train Loss: 0.3753138 Vali Loss: 0.1924023 Test Loss: 0.2676461
Validation loss decreased (0.192845 --> 0.192402).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2919562
	speed: 0.0796s/iter; left time: 1945.9553s
	iters: 200, epoch: 7 | loss: 0.2743570
	speed: 0.0247s/iter; left time: 601.0590s
Epoch: 7 cost time: 5.75838303565979
Epoch: 7, Steps: 261 | Train Loss: 0.3747335 Vali Loss: 0.1927005 Test Loss: 0.2679258
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2930653
	speed: 0.0733s/iter; left time: 1771.4272s
	iters: 200, epoch: 8 | loss: 0.3963740
	speed: 0.0171s/iter; left time: 412.6259s
Epoch: 8 cost time: 5.486072063446045
Epoch: 8, Steps: 261 | Train Loss: 0.3748587 Vali Loss: 0.1926947 Test Loss: 0.2678005
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4751382
	speed: 0.0747s/iter; left time: 1785.9647s
	iters: 200, epoch: 9 | loss: 0.3241740
	speed: 0.0168s/iter; left time: 401.1374s
Epoch: 9 cost time: 4.93982458114624
Epoch: 9, Steps: 261 | Train Loss: 0.3742380 Vali Loss: 0.1923631 Test Loss: 0.2675888
Validation loss decreased (0.192402 --> 0.192363).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3966581
	speed: 0.0755s/iter; left time: 1785.0828s
	iters: 200, epoch: 10 | loss: 0.3537412
	speed: 0.0177s/iter; left time: 416.9189s
Epoch: 10 cost time: 4.866178274154663
Epoch: 10, Steps: 261 | Train Loss: 0.3744800 Vali Loss: 0.1924627 Test Loss: 0.2675466
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.4268438
	speed: 0.0715s/iter; left time: 1673.3053s
	iters: 200, epoch: 11 | loss: 0.3447370
	speed: 0.0161s/iter; left time: 375.5824s
Epoch: 11 cost time: 5.058361053466797
Epoch: 11, Steps: 261 | Train Loss: 0.3734896 Vali Loss: 0.1922747 Test Loss: 0.2672362
Validation loss decreased (0.192363 --> 0.192275).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.4395084
	speed: 0.0680s/iter; left time: 1573.1033s
	iters: 200, epoch: 12 | loss: 0.3239037
	speed: 0.0159s/iter; left time: 366.4744s
Epoch: 12 cost time: 4.596117734909058
Epoch: 12, Steps: 261 | Train Loss: 0.3732233 Vali Loss: 0.1923168 Test Loss: 0.2673303
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.5826192
	speed: 0.0688s/iter; left time: 1574.5270s
	iters: 200, epoch: 13 | loss: 0.3774097
	speed: 0.0167s/iter; left time: 379.7266s
Epoch: 13 cost time: 4.641919374465942
Epoch: 13, Steps: 261 | Train Loss: 0.3740137 Vali Loss: 0.1923882 Test Loss: 0.2673613
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3901789
	speed: 0.0670s/iter; left time: 1514.2602s
	iters: 200, epoch: 14 | loss: 0.3080257
	speed: 0.0173s/iter; left time: 390.1598s
Epoch: 14 cost time: 4.7290565967559814
Epoch: 14, Steps: 261 | Train Loss: 0.3742843 Vali Loss: 0.1922998 Test Loss: 0.2672151
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3390825
	speed: 0.0739s/iter; left time: 1650.3784s
	iters: 200, epoch: 15 | loss: 0.4470907
	speed: 0.0163s/iter; left time: 362.5537s
Epoch: 15 cost time: 5.134503602981567
Epoch: 15, Steps: 261 | Train Loss: 0.3738708 Vali Loss: 0.1924175 Test Loss: 0.2674540
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3798030
	speed: 0.0673s/iter; left time: 1486.2581s
	iters: 200, epoch: 16 | loss: 0.2716030
	speed: 0.0162s/iter; left time: 356.4629s
Epoch: 16 cost time: 4.735753536224365
Epoch: 16, Steps: 261 | Train Loss: 0.3740117 Vali Loss: 0.1919455 Test Loss: 0.2672144
Validation loss decreased (0.192275 --> 0.191945).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4161403
	speed: 0.0653s/iter; left time: 1425.1140s
	iters: 200, epoch: 17 | loss: 0.3744877
	speed: 0.0156s/iter; left time: 338.0302s
Epoch: 17 cost time: 4.610006093978882
Epoch: 17, Steps: 261 | Train Loss: 0.3735037 Vali Loss: 0.1921623 Test Loss: 0.2673309
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3436375
	speed: 0.0697s/iter; left time: 1503.3814s
	iters: 200, epoch: 18 | loss: 0.3226102
	speed: 0.0212s/iter; left time: 455.9625s
Epoch: 18 cost time: 5.287635564804077
Epoch: 18, Steps: 261 | Train Loss: 0.3728239 Vali Loss: 0.1922399 Test Loss: 0.2672938
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3017158
	speed: 0.0660s/iter; left time: 1406.6536s
	iters: 200, epoch: 19 | loss: 0.4152259
	speed: 0.0150s/iter; left time: 318.4807s
Epoch: 19 cost time: 4.466094255447388
Epoch: 19, Steps: 261 | Train Loss: 0.3735082 Vali Loss: 0.1924896 Test Loss: 0.2676273
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3515205
	speed: 0.0669s/iter; left time: 1407.8759s
	iters: 200, epoch: 20 | loss: 0.3972760
	speed: 0.0153s/iter; left time: 320.0002s
Epoch: 20 cost time: 4.561695575714111
Epoch: 20, Steps: 261 | Train Loss: 0.3733732 Vali Loss: 0.1923323 Test Loss: 0.2673260
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3871905
	speed: 0.0671s/iter; left time: 1393.9823s
	iters: 200, epoch: 21 | loss: 0.3910756
	speed: 0.0182s/iter; left time: 377.1960s
Epoch: 21 cost time: 4.906242609024048
Epoch: 21, Steps: 261 | Train Loss: 0.3734366 Vali Loss: 0.1922614 Test Loss: 0.2673794
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3741079
	speed: 0.0664s/iter; left time: 1363.4307s
	iters: 200, epoch: 22 | loss: 0.4492413
	speed: 0.0159s/iter; left time: 324.8987s
Epoch: 22 cost time: 4.626916408538818
Epoch: 22, Steps: 261 | Train Loss: 0.3735922 Vali Loss: 0.1922136 Test Loss: 0.2673019
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3337452
	speed: 0.0705s/iter; left time: 1427.9124s
	iters: 200, epoch: 23 | loss: 0.3134962
	speed: 0.0158s/iter; left time: 318.4736s
Epoch: 23 cost time: 4.6166090965271
Epoch: 23, Steps: 261 | Train Loss: 0.3735284 Vali Loss: 0.1923370 Test Loss: 0.2673492
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3545320
	speed: 0.0686s/iter; left time: 1371.0631s
	iters: 200, epoch: 24 | loss: 0.3573284
	speed: 0.0165s/iter; left time: 327.4446s
Epoch: 24 cost time: 4.974929094314575
Epoch: 24, Steps: 261 | Train Loss: 0.3733427 Vali Loss: 0.1921709 Test Loss: 0.2672422
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4539237
	speed: 0.0731s/iter; left time: 1442.2838s
	iters: 200, epoch: 25 | loss: 0.2942768
	speed: 0.0178s/iter; left time: 348.5999s
Epoch: 25 cost time: 5.09489631652832
Epoch: 25, Steps: 261 | Train Loss: 0.3729158 Vali Loss: 0.1923353 Test Loss: 0.2674675
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.4051956
	speed: 0.0645s/iter; left time: 1255.5495s
	iters: 200, epoch: 26 | loss: 0.3694510
	speed: 0.0163s/iter; left time: 316.7183s
Epoch: 26 cost time: 5.4888060092926025
Epoch: 26, Steps: 261 | Train Loss: 0.3734643 Vali Loss: 0.1921395 Test Loss: 0.2672253
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3666555
	speed: 0.0766s/iter; left time: 1472.1568s
	iters: 200, epoch: 27 | loss: 0.4073810
	speed: 0.0148s/iter; left time: 282.0627s
Epoch: 27 cost time: 4.395544528961182
Epoch: 27, Steps: 261 | Train Loss: 0.3733789 Vali Loss: 0.1921224 Test Loss: 0.2673631
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.4401044
	speed: 0.0611s/iter; left time: 1158.7224s
	iters: 200, epoch: 28 | loss: 0.3697847
	speed: 0.0147s/iter; left time: 277.5979s
Epoch: 28 cost time: 4.2535560131073
Epoch: 28, Steps: 261 | Train Loss: 0.3733498 Vali Loss: 0.1921592 Test Loss: 0.2672421
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2896905
	speed: 0.0721s/iter; left time: 1348.0620s
	iters: 200, epoch: 29 | loss: 0.3841977
	speed: 0.0153s/iter; left time: 283.9781s
Epoch: 29 cost time: 5.058688163757324
Epoch: 29, Steps: 261 | Train Loss: 0.3728880 Vali Loss: 0.1921911 Test Loss: 0.2672471
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4693859
	speed: 0.0704s/iter; left time: 1297.2871s
	iters: 200, epoch: 30 | loss: 0.2892051
	speed: 0.0160s/iter; left time: 294.2060s
Epoch: 30 cost time: 5.233409643173218
Epoch: 30, Steps: 261 | Train Loss: 0.3732155 Vali Loss: 0.1920194 Test Loss: 0.2672211
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3771665
	speed: 0.0733s/iter; left time: 1332.1834s
	iters: 200, epoch: 31 | loss: 0.3136223
	speed: 0.0302s/iter; left time: 544.9984s
Epoch: 31 cost time: 6.141951560974121
Epoch: 31, Steps: 261 | Train Loss: 0.3733540 Vali Loss: 0.1920675 Test Loss: 0.2671595
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.4311524
	speed: 0.0824s/iter; left time: 1475.5467s
	iters: 200, epoch: 32 | loss: 0.2753533
	speed: 0.0180s/iter; left time: 320.4952s
Epoch: 32 cost time: 5.589226007461548
Epoch: 32, Steps: 261 | Train Loss: 0.3730596 Vali Loss: 0.1922022 Test Loss: 0.2671047
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.4871848
	speed: 0.0719s/iter; left time: 1269.2478s
	iters: 200, epoch: 33 | loss: 0.3259274
	speed: 0.0165s/iter; left time: 290.1596s
Epoch: 33 cost time: 4.9216368198394775
Epoch: 33, Steps: 261 | Train Loss: 0.3728415 Vali Loss: 0.1922075 Test Loss: 0.2671247
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3118748
	speed: 0.0658s/iter; left time: 1144.2642s
	iters: 200, epoch: 34 | loss: 0.2729655
	speed: 0.0159s/iter; left time: 274.4880s
Epoch: 34 cost time: 4.5654613971710205
Epoch: 34, Steps: 261 | Train Loss: 0.3731555 Vali Loss: 0.1922385 Test Loss: 0.2671617
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.4455194
	speed: 0.0690s/iter; left time: 1182.4694s
	iters: 200, epoch: 35 | loss: 0.3026130
	speed: 0.0166s/iter; left time: 282.6858s
Epoch: 35 cost time: 4.753209590911865
Epoch: 35, Steps: 261 | Train Loss: 0.3732111 Vali Loss: 0.1921245 Test Loss: 0.2672428
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.5231810
	speed: 0.0732s/iter; left time: 1234.8825s
	iters: 200, epoch: 36 | loss: 0.4141371
	speed: 0.0164s/iter; left time: 275.0333s
Epoch: 36 cost time: 6.112179756164551
Epoch: 36, Steps: 261 | Train Loss: 0.3725812 Vali Loss: 0.1919782 Test Loss: 0.2672104
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2682414948940277, mae:0.3258303105831146, rse:0.4183344542980194, corr:[0.56063515 0.5608504  0.55703586 0.55528355 0.5557665  0.55637383
 0.5556042  0.5541614  0.5533777  0.5535837  0.5540794  0.55400044
 0.55329865 0.55259496 0.55243313 0.55260867 0.55252343 0.55180883
 0.55067617 0.5496811  0.5491666  0.5489755  0.5487305  0.54821527
 0.5475166  0.5468921  0.54644376 0.54602075 0.54543924 0.54473144
 0.5440838  0.54370767 0.5434791  0.54311275 0.54246837 0.5416522
 0.54083794 0.54019845 0.53970146 0.53921944 0.53866154 0.5380455
 0.5375156  0.5371347  0.53680176 0.53630567 0.53556997 0.53467315
 0.5337323  0.5329203  0.5323287  0.5318949  0.531379   0.53068966
 0.5299474  0.5293549  0.5289256  0.52856445 0.5281841  0.52777374
 0.5274173  0.5272556  0.52723074 0.52715474 0.5269251  0.5266127
 0.52630055 0.5261173  0.5260435  0.5259407  0.5257105  0.5253919
 0.52506363 0.52477336 0.5244283  0.5239845  0.52342314 0.5227928
 0.5221476  0.5215448  0.52087224 0.5201469  0.51940864 0.5187752
 0.51834685 0.5180737  0.51777565 0.51739717 0.5169848  0.5166413
 0.5164226  0.5162024  0.5157167  0.51483536 0.5135811  0.5121166
 0.5107324  0.5096217  0.50860345 0.50746834 0.506167   0.50477624
 0.5034727  0.50232655 0.5012949  0.50020176 0.4990086  0.49781314
 0.49674028 0.49594882 0.49546516 0.49510738 0.49470112 0.49405444
 0.49312487 0.49208605 0.491123   0.4902709  0.4895545  0.48885033
 0.4881667  0.48740673 0.4866177  0.48580816 0.48501948 0.4843041
 0.4836802  0.48299572 0.4820817  0.48093182 0.47972453 0.47865984
 0.4778488  0.4772079  0.47657278 0.47588432 0.47523186 0.47480395
 0.4745647  0.47430134 0.47372466 0.47279033 0.47171164 0.47070223
 0.4699175  0.46919584 0.46847582 0.46767864 0.466984   0.46656847
 0.46648803 0.4664767  0.46606576 0.46511298 0.46393013 0.46303567
 0.4626298  0.46251094 0.4622565  0.46173245 0.4610009  0.4604202
 0.4602119  0.46032774 0.46041232 0.46015644 0.4594719  0.45863563
 0.4580256  0.45782623 0.45779222 0.45765474 0.45723072 0.45651266
 0.45561182 0.45466524 0.45380473 0.45319125 0.45291105 0.4529978
 0.45305023 0.4527027  0.45199576 0.45121008 0.45075083 0.45086634
 0.45138323 0.45180315 0.45162138 0.4506324  0.4489741  0.44699863
 0.44510058 0.4435658  0.4422421  0.44109336 0.4403143  0.43987915
 0.4395415  0.43884403 0.43755808 0.43581352 0.4341586  0.43310276
 0.4326419  0.4322363  0.43129376 0.42970583 0.42803293 0.42699882
 0.42666066 0.42659983 0.4262598  0.4253286  0.42397067 0.42253652
 0.4214023  0.420582   0.41990513 0.41897368 0.4175455  0.41584104
 0.414274   0.41321686 0.41274697 0.4124113  0.4118288  0.41079247
 0.40921852 0.40748778 0.40603366 0.40526178 0.40515625 0.40537664
 0.40538776 0.40495327 0.40409705 0.40317157 0.40259457 0.40244654
 0.4025408  0.4024668  0.40210715 0.40166584 0.4011472  0.4007095
 0.4004099  0.40025234 0.4001502  0.4000078  0.39988863 0.39962572
 0.39913246 0.3986664  0.39841372 0.3986362  0.3991384  0.39950073
 0.39924282 0.39826697 0.39694834 0.39591235 0.39552546 0.39575794
 0.3961742  0.39637268 0.39643484 0.39652094 0.39661184 0.39646503
 0.3959016  0.39505836 0.39416862 0.3936581  0.39357153 0.39365017
 0.39368573 0.39338827 0.39284843 0.39241567 0.3921342  0.39188883
 0.39147228 0.39097312 0.39066616 0.3906869  0.3907918  0.39033943
 0.38908565 0.38749686 0.3861189  0.3854392  0.3854779  0.38567016
 0.38558662 0.38495967 0.38387886 0.38273996 0.3819879  0.3815021
 0.38134485 0.38138056 0.38159567 0.38156986 0.38104576 0.37999728
 0.37887764 0.3781823  0.3783924  0.3793121  0.38015044 0.38043335
 0.37996173 0.3794711  0.37953517 0.3800089  0.38021952 0.37958384
 0.378114   0.37683558 0.37670755 0.37755892 0.37831175 0.378198
 0.377242   0.37654698 0.37707058 0.37826625 0.37907755 0.37857327
 0.37715238 0.37609223 0.37638092 0.37735796 0.37572974 0.36625794]
