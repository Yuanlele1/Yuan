Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  8225280.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2680306
	speed: 0.0253s/iter; left time: 662.6617s
	iters: 200, epoch: 1 | loss: 0.1873581
	speed: 0.0181s/iter; left time: 471.1530s
Epoch: 1 cost time: 5.76550817489624
Epoch: 1, Steps: 263 | Train Loss: 0.2739913 Vali Loss: 0.1778555 Test Loss: 0.2308164
Validation loss decreased (inf --> 0.177856).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1981184
	speed: 0.0846s/iter; left time: 2194.1935s
	iters: 200, epoch: 2 | loss: 0.1742990
	speed: 0.0169s/iter; left time: 437.0543s
Epoch: 2 cost time: 5.361935377120972
Epoch: 2, Steps: 263 | Train Loss: 0.1577844 Vali Loss: 0.1644604 Test Loss: 0.2129230
Validation loss decreased (0.177856 --> 0.164460).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1310542
	speed: 0.0876s/iter; left time: 2248.1632s
	iters: 200, epoch: 3 | loss: 0.1126056
	speed: 0.0178s/iter; left time: 455.1935s
Epoch: 3 cost time: 5.746208667755127
Epoch: 3, Steps: 263 | Train Loss: 0.1142339 Vali Loss: 0.1556610 Test Loss: 0.2032291
Validation loss decreased (0.164460 --> 0.155661).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0820302
	speed: 0.0786s/iter; left time: 1998.2539s
	iters: 200, epoch: 4 | loss: 0.0827326
	speed: 0.0180s/iter; left time: 456.1879s
Epoch: 4 cost time: 5.661747694015503
Epoch: 4, Steps: 263 | Train Loss: 0.0897362 Vali Loss: 0.1477593 Test Loss: 0.1948382
Validation loss decreased (0.155661 --> 0.147759).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0789466
	speed: 0.0815s/iter; left time: 2048.6408s
	iters: 200, epoch: 5 | loss: 0.0656370
	speed: 0.0174s/iter; left time: 435.2780s
Epoch: 5 cost time: 5.317011833190918
Epoch: 5, Steps: 263 | Train Loss: 0.0737639 Vali Loss: 0.1411825 Test Loss: 0.1880279
Validation loss decreased (0.147759 --> 0.141183).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0644613
	speed: 0.0804s/iter; left time: 2001.7627s
	iters: 200, epoch: 6 | loss: 0.0547016
	speed: 0.0195s/iter; left time: 483.9376s
Epoch: 6 cost time: 5.2913901805877686
Epoch: 6, Steps: 263 | Train Loss: 0.0627371 Vali Loss: 0.1356332 Test Loss: 0.1824154
Validation loss decreased (0.141183 --> 0.135633).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0641863
	speed: 0.0796s/iter; left time: 1960.7908s
	iters: 200, epoch: 7 | loss: 0.0436153
	speed: 0.0169s/iter; left time: 415.0668s
Epoch: 7 cost time: 5.419469118118286
Epoch: 7, Steps: 263 | Train Loss: 0.0551174 Vali Loss: 0.1317027 Test Loss: 0.1785233
Validation loss decreased (0.135633 --> 0.131703).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0426843
	speed: 0.0795s/iter; left time: 1936.2596s
	iters: 200, epoch: 8 | loss: 0.0524582
	speed: 0.0149s/iter; left time: 360.4608s
Epoch: 8 cost time: 4.9983367919921875
Epoch: 8, Steps: 263 | Train Loss: 0.0497493 Vali Loss: 0.1287209 Test Loss: 0.1755424
Validation loss decreased (0.131703 --> 0.128721).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0409490
	speed: 0.0770s/iter; left time: 1856.0913s
	iters: 200, epoch: 9 | loss: 0.0482304
	speed: 0.0176s/iter; left time: 422.2403s
Epoch: 9 cost time: 5.351304292678833
Epoch: 9, Steps: 263 | Train Loss: 0.0460253 Vali Loss: 0.1261695 Test Loss: 0.1732656
Validation loss decreased (0.128721 --> 0.126170).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0424980
	speed: 0.0819s/iter; left time: 1952.9517s
	iters: 200, epoch: 10 | loss: 0.0436981
	speed: 0.0181s/iter; left time: 428.6203s
Epoch: 10 cost time: 5.575530529022217
Epoch: 10, Steps: 263 | Train Loss: 0.0434550 Vali Loss: 0.1244434 Test Loss: 0.1717764
Validation loss decreased (0.126170 --> 0.124443).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0406604
	speed: 0.0821s/iter; left time: 1934.0420s
	iters: 200, epoch: 11 | loss: 0.0413009
	speed: 0.0384s/iter; left time: 901.6902s
Epoch: 11 cost time: 9.545714378356934
Epoch: 11, Steps: 263 | Train Loss: 0.0416673 Vali Loss: 0.1232880 Test Loss: 0.1709641
Validation loss decreased (0.124443 --> 0.123288).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0490095
	speed: 0.0983s/iter; left time: 2291.8184s
	iters: 200, epoch: 12 | loss: 0.0312425
	speed: 0.0175s/iter; left time: 405.0766s
Epoch: 12 cost time: 5.288181781768799
Epoch: 12, Steps: 263 | Train Loss: 0.0405050 Vali Loss: 0.1220217 Test Loss: 0.1699408
Validation loss decreased (0.123288 --> 0.122022).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0372838
	speed: 0.0919s/iter; left time: 2116.8825s
	iters: 200, epoch: 13 | loss: 0.0329955
	speed: 0.0201s/iter; left time: 460.3436s
Epoch: 13 cost time: 5.575817346572876
Epoch: 13, Steps: 263 | Train Loss: 0.0397170 Vali Loss: 0.1215608 Test Loss: 0.1695202
Validation loss decreased (0.122022 --> 0.121561).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0369097
	speed: 0.0795s/iter; left time: 1810.3873s
	iters: 200, epoch: 14 | loss: 0.0468186
	speed: 0.0166s/iter; left time: 376.6620s
Epoch: 14 cost time: 5.578382253646851
Epoch: 14, Steps: 263 | Train Loss: 0.0392065 Vali Loss: 0.1209604 Test Loss: 0.1691681
Validation loss decreased (0.121561 --> 0.120960).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0338938
	speed: 0.0771s/iter; left time: 1736.7397s
	iters: 200, epoch: 15 | loss: 0.0437955
	speed: 0.0170s/iter; left time: 381.4494s
Epoch: 15 cost time: 5.621646165847778
Epoch: 15, Steps: 263 | Train Loss: 0.0388099 Vali Loss: 0.1203514 Test Loss: 0.1687971
Validation loss decreased (0.120960 --> 0.120351).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0473507
	speed: 0.0843s/iter; left time: 1875.6955s
	iters: 200, epoch: 16 | loss: 0.0361418
	speed: 0.0199s/iter; left time: 441.2214s
Epoch: 16 cost time: 5.9781434535980225
Epoch: 16, Steps: 263 | Train Loss: 0.0386457 Vali Loss: 0.1200362 Test Loss: 0.1686828
Validation loss decreased (0.120351 --> 0.120036).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0526348
	speed: 0.0818s/iter; left time: 1799.3703s
	iters: 200, epoch: 17 | loss: 0.0389867
	speed: 0.0173s/iter; left time: 378.4578s
Epoch: 17 cost time: 5.479612350463867
Epoch: 17, Steps: 263 | Train Loss: 0.0385218 Vali Loss: 0.1197893 Test Loss: 0.1683420
Validation loss decreased (0.120036 --> 0.119789).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0419887
	speed: 0.0864s/iter; left time: 1878.5349s
	iters: 200, epoch: 18 | loss: 0.0366814
	speed: 0.0172s/iter; left time: 371.7384s
Epoch: 18 cost time: 5.751368045806885
Epoch: 18, Steps: 263 | Train Loss: 0.0384333 Vali Loss: 0.1196274 Test Loss: 0.1685446
Validation loss decreased (0.119789 --> 0.119627).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0333413
	speed: 0.0828s/iter; left time: 1777.5907s
	iters: 200, epoch: 19 | loss: 0.0512014
	speed: 0.0172s/iter; left time: 367.7330s
Epoch: 19 cost time: 5.584062099456787
Epoch: 19, Steps: 263 | Train Loss: 0.0383754 Vali Loss: 0.1194974 Test Loss: 0.1683164
Validation loss decreased (0.119627 --> 0.119497).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0331787
	speed: 0.0837s/iter; left time: 1774.6603s
	iters: 200, epoch: 20 | loss: 0.0385951
	speed: 0.0161s/iter; left time: 340.6223s
Epoch: 20 cost time: 5.4139885902404785
Epoch: 20, Steps: 263 | Train Loss: 0.0383586 Vali Loss: 0.1195771 Test Loss: 0.1683318
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0333458
	speed: 0.0776s/iter; left time: 1625.6352s
	iters: 200, epoch: 21 | loss: 0.0452441
	speed: 0.0168s/iter; left time: 349.4344s
Epoch: 21 cost time: 5.011961936950684
Epoch: 21, Steps: 263 | Train Loss: 0.0383545 Vali Loss: 0.1194500 Test Loss: 0.1683963
Validation loss decreased (0.119497 --> 0.119450).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0444571
	speed: 0.0800s/iter; left time: 1654.3154s
	iters: 200, epoch: 22 | loss: 0.0266435
	speed: 0.0226s/iter; left time: 464.2995s
Epoch: 22 cost time: 5.689763307571411
Epoch: 22, Steps: 263 | Train Loss: 0.0383425 Vali Loss: 0.1194278 Test Loss: 0.1683688
Validation loss decreased (0.119450 --> 0.119428).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0384160
	speed: 0.0790s/iter; left time: 1612.8734s
	iters: 200, epoch: 23 | loss: 0.0413876
	speed: 0.0162s/iter; left time: 329.6042s
Epoch: 23 cost time: 4.926981210708618
Epoch: 23, Steps: 263 | Train Loss: 0.0383218 Vali Loss: 0.1191734 Test Loss: 0.1682404
Validation loss decreased (0.119428 --> 0.119173).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0320702
	speed: 0.0777s/iter; left time: 1565.2709s
	iters: 200, epoch: 24 | loss: 0.0364224
	speed: 0.0198s/iter; left time: 397.0428s
Epoch: 24 cost time: 5.384525299072266
Epoch: 24, Steps: 263 | Train Loss: 0.0383292 Vali Loss: 0.1192046 Test Loss: 0.1681969
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0319083
	speed: 0.0758s/iter; left time: 1507.1537s
	iters: 200, epoch: 25 | loss: 0.0473749
	speed: 0.0169s/iter; left time: 333.5591s
Epoch: 25 cost time: 5.064793586730957
Epoch: 25, Steps: 263 | Train Loss: 0.0382948 Vali Loss: 0.1192308 Test Loss: 0.1682507
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0411152
	speed: 0.0803s/iter; left time: 1576.7858s
	iters: 200, epoch: 26 | loss: 0.0326428
	speed: 0.0219s/iter; left time: 426.6745s
Epoch: 26 cost time: 5.682125806808472
Epoch: 26, Steps: 263 | Train Loss: 0.0382915 Vali Loss: 0.1192682 Test Loss: 0.1682925
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0447797
	speed: 0.0763s/iter; left time: 1477.1482s
	iters: 200, epoch: 27 | loss: 0.0407638
	speed: 0.0167s/iter; left time: 320.8295s
Epoch: 27 cost time: 5.044646501541138
Epoch: 27, Steps: 263 | Train Loss: 0.0383255 Vali Loss: 0.1193812 Test Loss: 0.1682936
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0374946
	speed: 0.0826s/iter; left time: 1577.6164s
	iters: 200, epoch: 28 | loss: 0.0289997
	speed: 0.0215s/iter; left time: 409.2803s
Epoch: 28 cost time: 5.76958441734314
Epoch: 28, Steps: 263 | Train Loss: 0.0383058 Vali Loss: 0.1193123 Test Loss: 0.1683622
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0384159
	speed: 0.0804s/iter; left time: 1515.1342s
	iters: 200, epoch: 29 | loss: 0.0291177
	speed: 0.0179s/iter; left time: 336.0132s
Epoch: 29 cost time: 5.542699337005615
Epoch: 29, Steps: 263 | Train Loss: 0.0382583 Vali Loss: 0.1194065 Test Loss: 0.1683494
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0407100
	speed: 0.0847s/iter; left time: 1574.0462s
	iters: 200, epoch: 30 | loss: 0.0370378
	speed: 0.0175s/iter; left time: 322.5065s
Epoch: 30 cost time: 5.5839831829071045
Epoch: 30, Steps: 263 | Train Loss: 0.0383095 Vali Loss: 0.1192822 Test Loss: 0.1681570
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0401268
	speed: 0.0780s/iter; left time: 1429.0259s
	iters: 200, epoch: 31 | loss: 0.0465271
	speed: 0.0208s/iter; left time: 378.2721s
Epoch: 31 cost time: 5.332988977432251
Epoch: 31, Steps: 263 | Train Loss: 0.0383222 Vali Loss: 0.1192194 Test Loss: 0.1682553
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0388726
	speed: 0.0756s/iter; left time: 1364.0824s
	iters: 200, epoch: 32 | loss: 0.0277886
	speed: 0.0161s/iter; left time: 288.2348s
Epoch: 32 cost time: 5.138571500778198
Epoch: 32, Steps: 263 | Train Loss: 0.0383199 Vali Loss: 0.1193516 Test Loss: 0.1684004
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0361754
	speed: 0.0820s/iter; left time: 1458.9781s
	iters: 200, epoch: 33 | loss: 0.0465275
	speed: 0.0219s/iter; left time: 387.8083s
Epoch: 33 cost time: 5.802491903305054
Epoch: 33, Steps: 263 | Train Loss: 0.0383119 Vali Loss: 0.1191906 Test Loss: 0.1682171
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0386633
	speed: 0.0808s/iter; left time: 1415.7449s
	iters: 200, epoch: 34 | loss: 0.0397001
	speed: 0.0157s/iter; left time: 272.8907s
Epoch: 34 cost time: 5.435418367385864
Epoch: 34, Steps: 263 | Train Loss: 0.0383242 Vali Loss: 0.1192376 Test Loss: 0.1681506
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0391330
	speed: 0.0832s/iter; left time: 1435.5173s
	iters: 200, epoch: 35 | loss: 0.0380088
	speed: 0.0169s/iter; left time: 290.0503s
Epoch: 35 cost time: 5.123247861862183
Epoch: 35, Steps: 263 | Train Loss: 0.0383154 Vali Loss: 0.1193299 Test Loss: 0.1683012
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0376816
	speed: 0.0831s/iter; left time: 1411.5482s
	iters: 200, epoch: 36 | loss: 0.0468986
	speed: 0.0191s/iter; left time: 322.5006s
Epoch: 36 cost time: 5.580846548080444
Epoch: 36, Steps: 263 | Train Loss: 0.0383056 Vali Loss: 0.1192818 Test Loss: 0.1682616
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0433613
	speed: 0.0791s/iter; left time: 1322.9168s
	iters: 200, epoch: 37 | loss: 0.0611828
	speed: 0.0164s/iter; left time: 272.1518s
Epoch: 37 cost time: 5.819259166717529
Epoch: 37, Steps: 263 | Train Loss: 0.0382946 Vali Loss: 0.1192478 Test Loss: 0.1682369
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0358534
	speed: 0.0823s/iter; left time: 1354.8385s
	iters: 200, epoch: 38 | loss: 0.0347168
	speed: 0.0156s/iter; left time: 255.4067s
Epoch: 38 cost time: 4.971899509429932
Epoch: 38, Steps: 263 | Train Loss: 0.0383082 Vali Loss: 0.1192333 Test Loss: 0.1681543
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0378745
	speed: 0.0775s/iter; left time: 1255.9566s
	iters: 200, epoch: 39 | loss: 0.0344937
	speed: 0.0203s/iter; left time: 326.4965s
Epoch: 39 cost time: 5.3937156200408936
Epoch: 39, Steps: 263 | Train Loss: 0.0382832 Vali Loss: 0.1193024 Test Loss: 0.1682753
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0317472
	speed: 0.0802s/iter; left time: 1277.9305s
	iters: 200, epoch: 40 | loss: 0.0429312
	speed: 0.0184s/iter; left time: 291.1926s
Epoch: 40 cost time: 5.422499656677246
Epoch: 40, Steps: 263 | Train Loss: 0.0382966 Vali Loss: 0.1192063 Test Loss: 0.1682190
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0315359
	speed: 0.0797s/iter; left time: 1250.4097s
	iters: 200, epoch: 41 | loss: 0.0325358
	speed: 0.0151s/iter; left time: 235.9855s
Epoch: 41 cost time: 5.284097194671631
Epoch: 41, Steps: 263 | Train Loss: 0.0382860 Vali Loss: 0.1192989 Test Loss: 0.1682105
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0356008
	speed: 0.0801s/iter; left time: 1234.7248s
	iters: 200, epoch: 42 | loss: 0.0417463
	speed: 0.0162s/iter; left time: 247.6918s
Epoch: 42 cost time: 5.216813087463379
Epoch: 42, Steps: 263 | Train Loss: 0.0382827 Vali Loss: 0.1192828 Test Loss: 0.1681886
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0439801
	speed: 0.0830s/iter; left time: 1257.4266s
	iters: 200, epoch: 43 | loss: 0.0322384
	speed: 0.0166s/iter; left time: 249.5186s
Epoch: 43 cost time: 5.298202276229858
Epoch: 43, Steps: 263 | Train Loss: 0.0383056 Vali Loss: 0.1193230 Test Loss: 0.1683266
EarlyStopping counter: 20 out of 20
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  8225280.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1663267
	speed: 0.0274s/iter; left time: 718.9304s
	iters: 200, epoch: 1 | loss: 0.1644634
	speed: 0.0189s/iter; left time: 494.1009s
Epoch: 1 cost time: 5.839890003204346
Epoch: 1, Steps: 263 | Train Loss: 0.2142368 Vali Loss: 0.1161502 Test Loss: 0.1646525
Validation loss decreased (inf --> 0.116150).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2041201
	speed: 0.0841s/iter; left time: 2180.8166s
	iters: 200, epoch: 2 | loss: 0.2553467
	speed: 0.0174s/iter; left time: 449.9460s
Epoch: 2 cost time: 5.505675554275513
Epoch: 2, Steps: 263 | Train Loss: 0.2110228 Vali Loss: 0.1154390 Test Loss: 0.1639536
Validation loss decreased (0.116150 --> 0.115439).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1749606
	speed: 0.0785s/iter; left time: 2015.6569s
	iters: 200, epoch: 3 | loss: 0.1414052
	speed: 0.0206s/iter; left time: 526.6252s
Epoch: 3 cost time: 5.365971565246582
Epoch: 3, Steps: 263 | Train Loss: 0.2098105 Vali Loss: 0.1156620 Test Loss: 0.1639618
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2147690
	speed: 0.0765s/iter; left time: 1944.8565s
	iters: 200, epoch: 4 | loss: 0.2447678
	speed: 0.0165s/iter; left time: 416.6220s
Epoch: 4 cost time: 4.97206711769104
Epoch: 4, Steps: 263 | Train Loss: 0.2091900 Vali Loss: 0.1151488 Test Loss: 0.1632282
Validation loss decreased (0.115439 --> 0.115149).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1874754
	speed: 0.0768s/iter; left time: 1932.5282s
	iters: 200, epoch: 5 | loss: 0.1320766
	speed: 0.0174s/iter; left time: 436.6702s
Epoch: 5 cost time: 5.295660972595215
Epoch: 5, Steps: 263 | Train Loss: 0.2085751 Vali Loss: 0.1153237 Test Loss: 0.1633746
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1907701
	speed: 0.0760s/iter; left time: 1890.2977s
	iters: 200, epoch: 6 | loss: 0.2109968
	speed: 0.0199s/iter; left time: 492.3796s
Epoch: 6 cost time: 5.515075922012329
Epoch: 6, Steps: 263 | Train Loss: 0.2083729 Vali Loss: 0.1150609 Test Loss: 0.1630474
Validation loss decreased (0.115149 --> 0.115061).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1716623
	speed: 0.0772s/iter; left time: 1901.4181s
	iters: 200, epoch: 7 | loss: 0.1608681
	speed: 0.0172s/iter; left time: 421.5439s
Epoch: 7 cost time: 5.116754055023193
Epoch: 7, Steps: 263 | Train Loss: 0.2079836 Vali Loss: 0.1153725 Test Loss: 0.1632115
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1405361
	speed: 0.0784s/iter; left time: 1910.6363s
	iters: 200, epoch: 8 | loss: 0.2018900
	speed: 0.0200s/iter; left time: 485.3868s
Epoch: 8 cost time: 5.448214769363403
Epoch: 8, Steps: 263 | Train Loss: 0.2077992 Vali Loss: 0.1153591 Test Loss: 0.1633120
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2114950
	speed: 0.0792s/iter; left time: 1909.1097s
	iters: 200, epoch: 9 | loss: 0.2117213
	speed: 0.0176s/iter; left time: 422.9951s
Epoch: 9 cost time: 5.369467258453369
Epoch: 9, Steps: 263 | Train Loss: 0.2077649 Vali Loss: 0.1152822 Test Loss: 0.1629883
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1715768
	speed: 0.0839s/iter; left time: 1998.5753s
	iters: 200, epoch: 10 | loss: 0.1794226
	speed: 0.0176s/iter; left time: 416.7594s
Epoch: 10 cost time: 5.403200626373291
Epoch: 10, Steps: 263 | Train Loss: 0.2076334 Vali Loss: 0.1151757 Test Loss: 0.1626693
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1914732
	speed: 0.0793s/iter; left time: 1868.3843s
	iters: 200, epoch: 11 | loss: 0.1987495
	speed: 0.0207s/iter; left time: 486.7567s
Epoch: 11 cost time: 5.522855043411255
Epoch: 11, Steps: 263 | Train Loss: 0.2072762 Vali Loss: 0.1150957 Test Loss: 0.1627394
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1996856
	speed: 0.0747s/iter; left time: 1741.0306s
	iters: 200, epoch: 12 | loss: 0.1672866
	speed: 0.0161s/iter; left time: 374.1572s
Epoch: 12 cost time: 4.973510980606079
Epoch: 12, Steps: 263 | Train Loss: 0.2074155 Vali Loss: 0.1149186 Test Loss: 0.1624901
Validation loss decreased (0.115061 --> 0.114919).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2212222
	speed: 0.0767s/iter; left time: 1768.0515s
	iters: 200, epoch: 13 | loss: 0.2088481
	speed: 0.0190s/iter; left time: 436.6474s
Epoch: 13 cost time: 5.393036127090454
Epoch: 13, Steps: 263 | Train Loss: 0.2072852 Vali Loss: 0.1151441 Test Loss: 0.1628941
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3147777
	speed: 0.0795s/iter; left time: 1810.4326s
	iters: 200, epoch: 14 | loss: 0.1689778
	speed: 0.0170s/iter; left time: 385.7030s
Epoch: 14 cost time: 5.1096436977386475
Epoch: 14, Steps: 263 | Train Loss: 0.2071891 Vali Loss: 0.1150766 Test Loss: 0.1626345
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2241841
	speed: 0.0790s/iter; left time: 1778.9873s
	iters: 200, epoch: 15 | loss: 0.3408915
	speed: 0.0205s/iter; left time: 460.0016s
Epoch: 15 cost time: 5.432646989822388
Epoch: 15, Steps: 263 | Train Loss: 0.2071105 Vali Loss: 0.1151879 Test Loss: 0.1627288
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1563520
	speed: 0.0733s/iter; left time: 1631.4144s
	iters: 200, epoch: 16 | loss: 0.1539166
	speed: 0.0159s/iter; left time: 351.8353s
Epoch: 16 cost time: 5.015877962112427
Epoch: 16, Steps: 263 | Train Loss: 0.2071574 Vali Loss: 0.1150901 Test Loss: 0.1626995
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1723567
	speed: 0.0796s/iter; left time: 1750.6993s
	iters: 200, epoch: 17 | loss: 0.2544585
	speed: 0.0201s/iter; left time: 440.5347s
Epoch: 17 cost time: 5.40566349029541
Epoch: 17, Steps: 263 | Train Loss: 0.2070237 Vali Loss: 0.1150467 Test Loss: 0.1627043
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1666758
	speed: 0.0761s/iter; left time: 1654.1322s
	iters: 200, epoch: 18 | loss: 0.2320304
	speed: 0.0197s/iter; left time: 426.1993s
Epoch: 18 cost time: 5.2133965492248535
Epoch: 18, Steps: 263 | Train Loss: 0.2072167 Vali Loss: 0.1150865 Test Loss: 0.1625440
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1514911
	speed: 0.0775s/iter; left time: 1663.1067s
	iters: 200, epoch: 19 | loss: 0.1489357
	speed: 0.0211s/iter; left time: 450.5394s
Epoch: 19 cost time: 5.367379188537598
Epoch: 19, Steps: 263 | Train Loss: 0.2067657 Vali Loss: 0.1151186 Test Loss: 0.1627667
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1638372
	speed: 0.0797s/iter; left time: 1690.2530s
	iters: 200, epoch: 20 | loss: 0.2291891
	speed: 0.0212s/iter; left time: 448.1152s
Epoch: 20 cost time: 5.744107961654663
Epoch: 20, Steps: 263 | Train Loss: 0.2070225 Vali Loss: 0.1149198 Test Loss: 0.1626600
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1720774
	speed: 0.0828s/iter; left time: 1733.1737s
	iters: 200, epoch: 21 | loss: 0.1609972
	speed: 0.0175s/iter; left time: 364.7585s
Epoch: 21 cost time: 5.64610481262207
Epoch: 21, Steps: 263 | Train Loss: 0.2065898 Vali Loss: 0.1149985 Test Loss: 0.1626907
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2153248
	speed: 0.0861s/iter; left time: 1779.4567s
	iters: 200, epoch: 22 | loss: 0.2760121
	speed: 0.0165s/iter; left time: 340.2169s
Epoch: 22 cost time: 5.120620965957642
Epoch: 22, Steps: 263 | Train Loss: 0.2067200 Vali Loss: 0.1150345 Test Loss: 0.1625332
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1943855
	speed: 0.0766s/iter; left time: 1564.2034s
	iters: 200, epoch: 23 | loss: 0.2908532
	speed: 0.0161s/iter; left time: 326.8835s
Epoch: 23 cost time: 5.190028667449951
Epoch: 23, Steps: 263 | Train Loss: 0.2069294 Vali Loss: 0.1151528 Test Loss: 0.1626438
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1814827
	speed: 0.0739s/iter; left time: 1488.7741s
	iters: 200, epoch: 24 | loss: 0.3734909
	speed: 0.0161s/iter; left time: 322.9270s
Epoch: 24 cost time: 4.947154998779297
Epoch: 24, Steps: 263 | Train Loss: 0.2066627 Vali Loss: 0.1150726 Test Loss: 0.1625611
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2568860
	speed: 0.0729s/iter; left time: 1450.6674s
	iters: 200, epoch: 25 | loss: 0.2208149
	speed: 0.0163s/iter; left time: 323.0703s
Epoch: 25 cost time: 4.98357892036438
Epoch: 25, Steps: 263 | Train Loss: 0.2066145 Vali Loss: 0.1150621 Test Loss: 0.1625427
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2309323
	speed: 0.0709s/iter; left time: 1391.6435s
	iters: 200, epoch: 26 | loss: 0.2673690
	speed: 0.0159s/iter; left time: 310.9748s
Epoch: 26 cost time: 4.809990882873535
Epoch: 26, Steps: 263 | Train Loss: 0.2067648 Vali Loss: 0.1151335 Test Loss: 0.1626206
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2408352
	speed: 0.0717s/iter; left time: 1388.9697s
	iters: 200, epoch: 27 | loss: 0.1826266
	speed: 0.0163s/iter; left time: 313.3308s
Epoch: 27 cost time: 4.951945781707764
Epoch: 27, Steps: 263 | Train Loss: 0.2067909 Vali Loss: 0.1149644 Test Loss: 0.1625094
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2267957
	speed: 0.0745s/iter; left time: 1423.4046s
	iters: 200, epoch: 28 | loss: 0.1776632
	speed: 0.0159s/iter; left time: 302.3798s
Epoch: 28 cost time: 5.098233461380005
Epoch: 28, Steps: 263 | Train Loss: 0.2066975 Vali Loss: 0.1150905 Test Loss: 0.1626877
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1777467
	speed: 0.0724s/iter; left time: 1364.1889s
	iters: 200, epoch: 29 | loss: 0.1720062
	speed: 0.0162s/iter; left time: 304.4541s
Epoch: 29 cost time: 4.931072235107422
Epoch: 29, Steps: 263 | Train Loss: 0.2067026 Vali Loss: 0.1150186 Test Loss: 0.1625738
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2412238
	speed: 0.0748s/iter; left time: 1388.4286s
	iters: 200, epoch: 30 | loss: 0.1952721
	speed: 0.0162s/iter; left time: 299.9408s
Epoch: 30 cost time: 4.842807054519653
Epoch: 30, Steps: 263 | Train Loss: 0.2067286 Vali Loss: 0.1149372 Test Loss: 0.1625530
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3294908
	speed: 0.0723s/iter; left time: 1323.9417s
	iters: 200, epoch: 31 | loss: 0.1800917
	speed: 0.0158s/iter; left time: 287.3413s
Epoch: 31 cost time: 4.852948427200317
Epoch: 31, Steps: 263 | Train Loss: 0.2064206 Vali Loss: 0.1150151 Test Loss: 0.1625755
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1916128
	speed: 0.0720s/iter; left time: 1298.6298s
	iters: 200, epoch: 32 | loss: 0.2030180
	speed: 0.0159s/iter; left time: 285.8646s
Epoch: 32 cost time: 4.809392929077148
Epoch: 32, Steps: 263 | Train Loss: 0.2065464 Vali Loss: 0.1149231 Test Loss: 0.1625115
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16292782127857208, mae:0.253971129655838, rse:0.3272606432437897, corr:[0.5694603  0.5705026  0.569285   0.5673225  0.566003   0.56567955
 0.5659386  0.5660923  0.56572884 0.564961   0.56418335 0.5637068
 0.56363374 0.56377095 0.5638546  0.56355745 0.56289285 0.56201464
 0.5611208  0.5603422  0.559751   0.55924267 0.55871713 0.55811
 0.55741554 0.55674547 0.55618954 0.5557367  0.555321   0.5549062
 0.5544143  0.5539269  0.5534291  0.55286527 0.55226654 0.5517011
 0.55113536 0.55054384 0.549891   0.54920894 0.548548   0.5479416
 0.5474154  0.5469333  0.5464315  0.5457889  0.5449909  0.544119
 0.5431574  0.5421453  0.5411953  0.54044974 0.53986317 0.53928727
 0.5385961  0.5378239  0.5369955  0.5362198  0.53565127 0.5353855
 0.53530306 0.5352987  0.53519154 0.53486264 0.5343197  0.5337925
 0.5333782  0.53318965 0.5331812  0.5331654  0.5329918  0.5326291
 0.53217196 0.53182423 0.53162706 0.5315198  0.53129464 0.53082
 0.53007543 0.5292851  0.5285068  0.5279514  0.52752775 0.52698624
 0.5261719  0.5251498  0.52397877 0.5230491  0.5227544  0.5230536
 0.523471   0.5234781  0.52274156 0.52179193 0.52180874 0.5227658 ]
