Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2132480.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3729398
	speed: 0.0730s/iter; left time: 1942.8004s
	iters: 200, epoch: 1 | loss: 0.5894306
	speed: 0.0459s/iter; left time: 1216.1202s
Epoch: 1 cost time: 14.556689500808716
Epoch: 1, Steps: 267 | Train Loss: 0.4057555 Vali Loss: 0.1871233 Test Loss: 0.2621862
Validation loss decreased (inf --> 0.187123).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4666673
	speed: 0.1671s/iter; left time: 4401.3364s
	iters: 200, epoch: 2 | loss: 0.3726367
	speed: 0.0342s/iter; left time: 897.1924s
Epoch: 2 cost time: 11.315593957901001
Epoch: 2, Steps: 267 | Train Loss: 0.3493610 Vali Loss: 0.1742945 Test Loss: 0.2475611
Validation loss decreased (0.187123 --> 0.174295).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4586465
	speed: 0.2012s/iter; left time: 5245.5782s
	iters: 200, epoch: 3 | loss: 0.2734789
	speed: 0.0456s/iter; left time: 1185.1347s
Epoch: 3 cost time: 13.41913628578186
Epoch: 3, Steps: 267 | Train Loss: 0.3370449 Vali Loss: 0.1698132 Test Loss: 0.2419071
Validation loss decreased (0.174295 --> 0.169813).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3095739
	speed: 0.1839s/iter; left time: 4744.8274s
	iters: 200, epoch: 4 | loss: 0.4547437
	speed: 0.0476s/iter; left time: 1222.0826s
Epoch: 4 cost time: 12.66175127029419
Epoch: 4, Steps: 267 | Train Loss: 0.3317677 Vali Loss: 0.1678070 Test Loss: 0.2390014
Validation loss decreased (0.169813 --> 0.167807).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3544298
	speed: 0.2053s/iter; left time: 5241.8649s
	iters: 200, epoch: 5 | loss: 0.2789006
	speed: 0.0380s/iter; left time: 966.4591s
Epoch: 5 cost time: 8.959508180618286
Epoch: 5, Steps: 267 | Train Loss: 0.3287387 Vali Loss: 0.1663775 Test Loss: 0.2372523
Validation loss decreased (0.167807 --> 0.166378).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2207999
	speed: 0.1486s/iter; left time: 3754.4713s
	iters: 200, epoch: 6 | loss: 0.3333596
	speed: 0.0308s/iter; left time: 774.6536s
Epoch: 6 cost time: 9.950671434402466
Epoch: 6, Steps: 267 | Train Loss: 0.3265491 Vali Loss: 0.1657077 Test Loss: 0.2360767
Validation loss decreased (0.166378 --> 0.165708).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3493047
	speed: 0.2144s/iter; left time: 5359.5394s
	iters: 200, epoch: 7 | loss: 0.3357546
	speed: 0.0230s/iter; left time: 572.7082s
Epoch: 7 cost time: 9.785033941268921
Epoch: 7, Steps: 267 | Train Loss: 0.3254608 Vali Loss: 0.1651219 Test Loss: 0.2351861
Validation loss decreased (0.165708 --> 0.165122).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2910287
	speed: 0.1897s/iter; left time: 4692.7044s
	iters: 200, epoch: 8 | loss: 0.2943295
	speed: 0.0510s/iter; left time: 1255.9876s
Epoch: 8 cost time: 13.289621829986572
Epoch: 8, Steps: 267 | Train Loss: 0.3243016 Vali Loss: 0.1649226 Test Loss: 0.2346640
Validation loss decreased (0.165122 --> 0.164923).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3564049
	speed: 0.1535s/iter; left time: 3755.3904s
	iters: 200, epoch: 9 | loss: 0.3230207
	speed: 0.0343s/iter; left time: 836.8210s
Epoch: 9 cost time: 8.235305309295654
Epoch: 9, Steps: 267 | Train Loss: 0.3238187 Vali Loss: 0.1646939 Test Loss: 0.2340731
Validation loss decreased (0.164923 --> 0.164694).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2645254
	speed: 0.1998s/iter; left time: 4835.9081s
	iters: 200, epoch: 10 | loss: 0.2686533
	speed: 0.0361s/iter; left time: 869.9488s
Epoch: 10 cost time: 11.836813926696777
Epoch: 10, Steps: 267 | Train Loss: 0.3232434 Vali Loss: 0.1644336 Test Loss: 0.2337900
Validation loss decreased (0.164694 --> 0.164434).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3556650
	speed: 0.2414s/iter; left time: 5775.7830s
	iters: 200, epoch: 11 | loss: 0.2850591
	speed: 0.0568s/iter; left time: 1353.3469s
Epoch: 11 cost time: 14.572210550308228
Epoch: 11, Steps: 267 | Train Loss: 0.3227361 Vali Loss: 0.1641604 Test Loss: 0.2336091
Validation loss decreased (0.164434 --> 0.164160).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2512274
	speed: 0.1860s/iter; left time: 4400.4311s
	iters: 200, epoch: 12 | loss: 0.2941597
	speed: 0.0561s/iter; left time: 1321.9345s
Epoch: 12 cost time: 13.752369403839111
Epoch: 12, Steps: 267 | Train Loss: 0.3223880 Vali Loss: 0.1641120 Test Loss: 0.2332952
Validation loss decreased (0.164160 --> 0.164112).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3646159
	speed: 0.1636s/iter; left time: 3826.8264s
	iters: 200, epoch: 13 | loss: 0.3020792
	speed: 0.0247s/iter; left time: 576.2527s
Epoch: 13 cost time: 8.30231237411499
Epoch: 13, Steps: 267 | Train Loss: 0.3220308 Vali Loss: 0.1638005 Test Loss: 0.2331686
Validation loss decreased (0.164112 --> 0.163800).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3890792
	speed: 0.1423s/iter; left time: 3291.3425s
	iters: 200, epoch: 14 | loss: 0.3164337
	speed: 0.0297s/iter; left time: 684.3737s
Epoch: 14 cost time: 8.455748558044434
Epoch: 14, Steps: 267 | Train Loss: 0.3218509 Vali Loss: 0.1640174 Test Loss: 0.2329665
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.4129499
	speed: 0.2229s/iter; left time: 5097.0351s
	iters: 200, epoch: 15 | loss: 0.2836284
	speed: 0.0337s/iter; left time: 767.9525s
Epoch: 15 cost time: 12.396182298660278
Epoch: 15, Steps: 267 | Train Loss: 0.3216793 Vali Loss: 0.1637707 Test Loss: 0.2329079
Validation loss decreased (0.163800 --> 0.163771).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2612799
	speed: 0.1629s/iter; left time: 3680.4272s
	iters: 200, epoch: 16 | loss: 0.2412496
	speed: 0.0607s/iter; left time: 1366.2472s
Epoch: 16 cost time: 12.794548273086548
Epoch: 16, Steps: 267 | Train Loss: 0.3214911 Vali Loss: 0.1638719 Test Loss: 0.2328061
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3612810
	speed: 0.1752s/iter; left time: 3912.9569s
	iters: 200, epoch: 17 | loss: 0.2477268
	speed: 0.0273s/iter; left time: 606.0689s
Epoch: 17 cost time: 9.071640729904175
Epoch: 17, Steps: 267 | Train Loss: 0.3212730 Vali Loss: 0.1639245 Test Loss: 0.2327534
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.4323876
	speed: 0.1548s/iter; left time: 3416.1369s
	iters: 200, epoch: 18 | loss: 0.2764415
	speed: 0.0310s/iter; left time: 681.7475s
Epoch: 18 cost time: 9.049428462982178
Epoch: 18, Steps: 267 | Train Loss: 0.3211811 Vali Loss: 0.1636180 Test Loss: 0.2326440
Validation loss decreased (0.163771 --> 0.163618).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4057703
	speed: 0.1410s/iter; left time: 3072.5831s
	iters: 200, epoch: 19 | loss: 0.3671218
	speed: 0.0483s/iter; left time: 1048.7459s
Epoch: 19 cost time: 11.148850440979004
Epoch: 19, Steps: 267 | Train Loss: 0.3211228 Vali Loss: 0.1638055 Test Loss: 0.2325213
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2596025
	speed: 0.1795s/iter; left time: 3864.7497s
	iters: 200, epoch: 20 | loss: 0.5077835
	speed: 0.0378s/iter; left time: 809.4531s
Epoch: 20 cost time: 12.506703853607178
Epoch: 20, Steps: 267 | Train Loss: 0.3209745 Vali Loss: 0.1637203 Test Loss: 0.2325137
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4682982
	speed: 0.1890s/iter; left time: 4017.8359s
	iters: 200, epoch: 21 | loss: 0.2921742
	speed: 0.0538s/iter; left time: 1139.1245s
Epoch: 21 cost time: 14.672369003295898
Epoch: 21, Steps: 267 | Train Loss: 0.3207626 Vali Loss: 0.1638006 Test Loss: 0.2325020
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2589183
	speed: 0.1914s/iter; left time: 4018.5424s
	iters: 200, epoch: 22 | loss: 0.3097062
	speed: 0.0428s/iter; left time: 894.5638s
Epoch: 22 cost time: 11.133103609085083
Epoch: 22, Steps: 267 | Train Loss: 0.3207591 Vali Loss: 0.1637586 Test Loss: 0.2325029
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2584614
	speed: 0.1638s/iter; left time: 3394.3202s
	iters: 200, epoch: 23 | loss: 0.3359447
	speed: 0.0408s/iter; left time: 842.5608s
Epoch: 23 cost time: 11.654044151306152
Epoch: 23, Steps: 267 | Train Loss: 0.3207484 Vali Loss: 0.1638565 Test Loss: 0.2324732
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3144475
	speed: 0.2135s/iter; left time: 4369.1438s
	iters: 200, epoch: 24 | loss: 0.2584466
	speed: 0.0654s/iter; left time: 1330.6073s
Epoch: 24 cost time: 16.533991813659668
Epoch: 24, Steps: 267 | Train Loss: 0.3206617 Vali Loss: 0.1637860 Test Loss: 0.2324021
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2523504
	speed: 0.2089s/iter; left time: 4219.2739s
	iters: 200, epoch: 25 | loss: 0.4534996
	speed: 0.0425s/iter; left time: 854.9282s
Epoch: 25 cost time: 10.719707489013672
Epoch: 25, Steps: 267 | Train Loss: 0.3206540 Vali Loss: 0.1636751 Test Loss: 0.2324192
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3320915
	speed: 0.1631s/iter; left time: 3250.2928s
	iters: 200, epoch: 26 | loss: 0.3474863
	speed: 0.0252s/iter; left time: 498.6245s
Epoch: 26 cost time: 10.070260047912598
Epoch: 26, Steps: 267 | Train Loss: 0.3205780 Vali Loss: 0.1637825 Test Loss: 0.2324063
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2202820
	speed: 0.1545s/iter; left time: 3036.6249s
	iters: 200, epoch: 27 | loss: 0.4765724
	speed: 0.0468s/iter; left time: 914.8198s
Epoch: 27 cost time: 11.998948335647583
Epoch: 27, Steps: 267 | Train Loss: 0.3205371 Vali Loss: 0.1636410 Test Loss: 0.2323740
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3340678
	speed: 0.1911s/iter; left time: 3704.9778s
	iters: 200, epoch: 28 | loss: 0.2870807
	speed: 0.0434s/iter; left time: 836.7201s
Epoch: 28 cost time: 10.71202802658081
Epoch: 28, Steps: 267 | Train Loss: 0.3205271 Vali Loss: 0.1636655 Test Loss: 0.2323689
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2692753
	speed: 0.2246s/iter; left time: 4295.7933s
	iters: 200, epoch: 29 | loss: 0.3417487
	speed: 0.0362s/iter; left time: 688.3222s
Epoch: 29 cost time: 12.293554782867432
Epoch: 29, Steps: 267 | Train Loss: 0.3203531 Vali Loss: 0.1636739 Test Loss: 0.2323586
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3012881
	speed: 0.1996s/iter; left time: 3764.3057s
	iters: 200, epoch: 30 | loss: 0.3096010
	speed: 0.0276s/iter; left time: 517.3356s
Epoch: 30 cost time: 9.078856468200684
Epoch: 30, Steps: 267 | Train Loss: 0.3203101 Vali Loss: 0.1637536 Test Loss: 0.2323473
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2949045
	speed: 0.1737s/iter; left time: 3228.6530s
	iters: 200, epoch: 31 | loss: 0.3278490
	speed: 0.0273s/iter; left time: 504.3485s
Epoch: 31 cost time: 9.100366592407227
Epoch: 31, Steps: 267 | Train Loss: 0.3203809 Vali Loss: 0.1636605 Test Loss: 0.2323527
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.5372781
	speed: 0.1543s/iter; left time: 2826.8552s
	iters: 200, epoch: 32 | loss: 0.2681644
	speed: 0.0312s/iter; left time: 567.7565s
Epoch: 32 cost time: 9.76079249382019
Epoch: 32, Steps: 267 | Train Loss: 0.3203504 Vali Loss: 0.1638419 Test Loss: 0.2323207
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3586172
	speed: 0.1665s/iter; left time: 3006.9799s
	iters: 200, epoch: 33 | loss: 0.2294224
	speed: 0.0245s/iter; left time: 440.7064s
Epoch: 33 cost time: 7.322972536087036
Epoch: 33, Steps: 267 | Train Loss: 0.3203366 Vali Loss: 0.1636153 Test Loss: 0.2323303
Validation loss decreased (0.163618 --> 0.163615).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2488340
	speed: 0.1812s/iter; left time: 3222.9985s
	iters: 200, epoch: 34 | loss: 0.2486637
	speed: 0.0252s/iter; left time: 445.4519s
Epoch: 34 cost time: 9.125919818878174
Epoch: 34, Steps: 267 | Train Loss: 0.3202950 Vali Loss: 0.1637504 Test Loss: 0.2323196
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3703657
	speed: 0.1263s/iter; left time: 2213.1037s
	iters: 200, epoch: 35 | loss: 0.2106377
	speed: 0.0173s/iter; left time: 300.8344s
Epoch: 35 cost time: 5.470344543457031
Epoch: 35, Steps: 267 | Train Loss: 0.3203212 Vali Loss: 0.1637846 Test Loss: 0.2323089
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2448283
	speed: 0.1295s/iter; left time: 2233.8063s
	iters: 200, epoch: 36 | loss: 0.3419295
	speed: 0.0171s/iter; left time: 293.2132s
Epoch: 36 cost time: 7.047279596328735
Epoch: 36, Steps: 267 | Train Loss: 0.3201217 Vali Loss: 0.1636279 Test Loss: 0.2323177
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3141653
	speed: 0.1392s/iter; left time: 2364.3495s
	iters: 200, epoch: 37 | loss: 0.6128013
	speed: 0.0285s/iter; left time: 480.8441s
Epoch: 37 cost time: 8.151106595993042
Epoch: 37, Steps: 267 | Train Loss: 0.3202424 Vali Loss: 0.1636738 Test Loss: 0.2322935
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3176722
	speed: 0.1332s/iter; left time: 2227.9965s
	iters: 200, epoch: 38 | loss: 0.2704464
	speed: 0.0422s/iter; left time: 701.6401s
Epoch: 38 cost time: 10.407438516616821
Epoch: 38, Steps: 267 | Train Loss: 0.3202319 Vali Loss: 0.1637561 Test Loss: 0.2322738
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3443718
	speed: 0.1154s/iter; left time: 1898.2221s
	iters: 200, epoch: 39 | loss: 0.2514811
	speed: 0.0285s/iter; left time: 466.8172s
Epoch: 39 cost time: 6.425293922424316
Epoch: 39, Steps: 267 | Train Loss: 0.3201507 Vali Loss: 0.1637121 Test Loss: 0.2322609
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3965003
	speed: 0.1040s/iter; left time: 1684.0448s
	iters: 200, epoch: 40 | loss: 0.3281644
	speed: 0.0326s/iter; left time: 523.9264s
Epoch: 40 cost time: 7.001918792724609
Epoch: 40, Steps: 267 | Train Loss: 0.3202197 Vali Loss: 0.1637857 Test Loss: 0.2322769
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.4642213
	speed: 0.0920s/iter; left time: 1464.7886s
	iters: 200, epoch: 41 | loss: 0.3546798
	speed: 0.0239s/iter; left time: 378.2442s
Epoch: 41 cost time: 6.938149929046631
Epoch: 41, Steps: 267 | Train Loss: 0.3202119 Vali Loss: 0.1637120 Test Loss: 0.2322673
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3317688
	speed: 0.1475s/iter; left time: 2308.9160s
	iters: 200, epoch: 42 | loss: 0.2569651
	speed: 0.0363s/iter; left time: 564.0603s
Epoch: 42 cost time: 11.612774133682251
Epoch: 42, Steps: 267 | Train Loss: 0.3200628 Vali Loss: 0.1635668 Test Loss: 0.2322686
Validation loss decreased (0.163615 --> 0.163567).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3824830
	speed: 0.1239s/iter; left time: 1906.5848s
	iters: 200, epoch: 43 | loss: 0.4139862
	speed: 0.0210s/iter; left time: 321.0510s
Epoch: 43 cost time: 6.836214065551758
Epoch: 43, Steps: 267 | Train Loss: 0.3201306 Vali Loss: 0.1635719 Test Loss: 0.2322492
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2059935
	speed: 0.1219s/iter; left time: 1842.4725s
	iters: 200, epoch: 44 | loss: 0.2996266
	speed: 0.0338s/iter; left time: 507.8413s
Epoch: 44 cost time: 9.350381851196289
Epoch: 44, Steps: 267 | Train Loss: 0.3201774 Vali Loss: 0.1637359 Test Loss: 0.2322556
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.4224937
	speed: 0.1225s/iter; left time: 1819.9327s
	iters: 200, epoch: 45 | loss: 0.2579985
	speed: 0.0267s/iter; left time: 393.7976s
Epoch: 45 cost time: 7.990729331970215
Epoch: 45, Steps: 267 | Train Loss: 0.3197353 Vali Loss: 0.1635302 Test Loss: 0.2322445
Validation loss decreased (0.163567 --> 0.163530).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2259740
	speed: 0.1097s/iter; left time: 1600.5751s
	iters: 200, epoch: 46 | loss: 0.3507756
	speed: 0.0221s/iter; left time: 320.0322s
Epoch: 46 cost time: 6.366960287094116
Epoch: 46, Steps: 267 | Train Loss: 0.3201238 Vali Loss: 0.1637321 Test Loss: 0.2322604
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2816884
	speed: 0.1104s/iter; left time: 1580.2717s
	iters: 200, epoch: 47 | loss: 0.2794892
	speed: 0.0210s/iter; left time: 297.9978s
Epoch: 47 cost time: 6.556882381439209
Epoch: 47, Steps: 267 | Train Loss: 0.3201137 Vali Loss: 0.1636714 Test Loss: 0.2322535
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3197171
	speed: 0.1096s/iter; left time: 1539.4695s
	iters: 200, epoch: 48 | loss: 0.2604782
	speed: 0.0321s/iter; left time: 448.4754s
Epoch: 48 cost time: 7.151398658752441
Epoch: 48, Steps: 267 | Train Loss: 0.3201508 Vali Loss: 0.1637163 Test Loss: 0.2322395
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2363287
	speed: 0.1585s/iter; left time: 2185.2497s
	iters: 200, epoch: 49 | loss: 0.2702149
	speed: 0.0496s/iter; left time: 679.3576s
Epoch: 49 cost time: 11.963492631912231
Epoch: 49, Steps: 267 | Train Loss: 0.3201056 Vali Loss: 0.1636899 Test Loss: 0.2322521
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2517594
	speed: 0.1536s/iter; left time: 2076.4139s
	iters: 200, epoch: 50 | loss: 0.3369696
	speed: 0.0376s/iter; left time: 504.1744s
Epoch: 50 cost time: 11.21789026260376
Epoch: 50, Steps: 267 | Train Loss: 0.3200794 Vali Loss: 0.1638304 Test Loss: 0.2322455
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2894861
	speed: 0.1408s/iter; left time: 1866.0131s
	iters: 200, epoch: 51 | loss: 0.2654877
	speed: 0.0277s/iter; left time: 364.0450s
Epoch: 51 cost time: 9.684208393096924
Epoch: 51, Steps: 267 | Train Loss: 0.3200382 Vali Loss: 0.1637876 Test Loss: 0.2322371
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.4837993
	speed: 0.1400s/iter; left time: 1818.0288s
	iters: 200, epoch: 52 | loss: 0.3725477
	speed: 0.0170s/iter; left time: 219.2130s
Epoch: 52 cost time: 7.446740388870239
Epoch: 52, Steps: 267 | Train Loss: 0.3200878 Vali Loss: 0.1636303 Test Loss: 0.2322334
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.3836855
	speed: 0.1135s/iter; left time: 1443.6969s
	iters: 200, epoch: 53 | loss: 0.2596147
	speed: 0.0416s/iter; left time: 524.6609s
Epoch: 53 cost time: 10.681844711303711
Epoch: 53, Steps: 267 | Train Loss: 0.3200038 Vali Loss: 0.1636646 Test Loss: 0.2322344
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2953119
	speed: 0.1685s/iter; left time: 2098.4426s
	iters: 200, epoch: 54 | loss: 0.4304992
	speed: 0.0168s/iter; left time: 207.6592s
Epoch: 54 cost time: 7.815129041671753
Epoch: 54, Steps: 267 | Train Loss: 0.3196715 Vali Loss: 0.1636655 Test Loss: 0.2322310
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.4846022
	speed: 0.1741s/iter; left time: 2121.6497s
	iters: 200, epoch: 55 | loss: 0.3283875
	speed: 0.0377s/iter; left time: 455.9497s
Epoch: 55 cost time: 11.205676317214966
Epoch: 55, Steps: 267 | Train Loss: 0.3200370 Vali Loss: 0.1636628 Test Loss: 0.2322205
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3576790
	speed: 0.1019s/iter; left time: 1214.6235s
	iters: 200, epoch: 56 | loss: 0.2837150
	speed: 0.0158s/iter; left time: 186.5026s
Epoch: 56 cost time: 5.223924398422241
Epoch: 56, Steps: 267 | Train Loss: 0.3200478 Vali Loss: 0.1636501 Test Loss: 0.2322267
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2795351
	speed: 0.1339s/iter; left time: 1559.8532s
	iters: 200, epoch: 57 | loss: 0.2375215
	speed: 0.0174s/iter; left time: 200.9611s
Epoch: 57 cost time: 6.4095752239227295
Epoch: 57, Steps: 267 | Train Loss: 0.3199953 Vali Loss: 0.1636338 Test Loss: 0.2322253
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3499700
	speed: 0.1150s/iter; left time: 1309.2183s
	iters: 200, epoch: 58 | loss: 0.3786575
	speed: 0.0230s/iter; left time: 259.8214s
Epoch: 58 cost time: 8.498907804489136
Epoch: 58, Steps: 267 | Train Loss: 0.3199925 Vali Loss: 0.1634727 Test Loss: 0.2322208
Validation loss decreased (0.163530 --> 0.163473).  Saving model ...
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.3043762
	speed: 0.1260s/iter; left time: 1400.3827s
	iters: 200, epoch: 59 | loss: 0.4289797
	speed: 0.0217s/iter; left time: 239.1078s
Epoch: 59 cost time: 6.09913969039917
Epoch: 59, Steps: 267 | Train Loss: 0.3196968 Vali Loss: 0.1635817 Test Loss: 0.2322238
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.4608647
	speed: 0.1024s/iter; left time: 1110.6890s
	iters: 200, epoch: 60 | loss: 0.3704112
	speed: 0.0167s/iter; left time: 179.0359s
Epoch: 60 cost time: 5.755937337875366
Epoch: 60, Steps: 267 | Train Loss: 0.3200275 Vali Loss: 0.1637763 Test Loss: 0.2322229
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2926826
	speed: 0.1139s/iter; left time: 1205.6101s
	iters: 200, epoch: 61 | loss: 0.5206222
	speed: 0.0289s/iter; left time: 302.8831s
Epoch: 61 cost time: 7.974848747253418
Epoch: 61, Steps: 267 | Train Loss: 0.3200440 Vali Loss: 0.1638248 Test Loss: 0.2322221
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.4210473
	speed: 0.1307s/iter; left time: 1348.4174s
	iters: 200, epoch: 62 | loss: 0.4798152
	speed: 0.0270s/iter; left time: 275.9552s
Epoch: 62 cost time: 8.355231046676636
Epoch: 62, Steps: 267 | Train Loss: 0.3200288 Vali Loss: 0.1635946 Test Loss: 0.2322178
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.3442863
	speed: 0.1257s/iter; left time: 1262.9503s
	iters: 200, epoch: 63 | loss: 0.3129606
	speed: 0.0208s/iter; left time: 206.8996s
Epoch: 63 cost time: 6.688506126403809
Epoch: 63, Steps: 267 | Train Loss: 0.3197478 Vali Loss: 0.1636232 Test Loss: 0.2322189
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.3751014
	speed: 0.1092s/iter; left time: 1068.3702s
	iters: 200, epoch: 64 | loss: 0.3796754
	speed: 0.0161s/iter; left time: 155.4153s
Epoch: 64 cost time: 6.217130661010742
Epoch: 64, Steps: 267 | Train Loss: 0.3199712 Vali Loss: 0.1636319 Test Loss: 0.2322198
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.3728921
	speed: 0.1007s/iter; left time: 957.9135s
	iters: 200, epoch: 65 | loss: 0.2720792
	speed: 0.0193s/iter; left time: 181.4598s
Epoch: 65 cost time: 5.717657804489136
Epoch: 65, Steps: 267 | Train Loss: 0.3199922 Vali Loss: 0.1635457 Test Loss: 0.2322168
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2882013
	speed: 0.1459s/iter; left time: 1349.4396s
	iters: 200, epoch: 66 | loss: 0.3902979
	speed: 0.0307s/iter; left time: 280.8633s
Epoch: 66 cost time: 7.935866832733154
Epoch: 66, Steps: 267 | Train Loss: 0.3196645 Vali Loss: 0.1636899 Test Loss: 0.2322125
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2657922
	speed: 0.1593s/iter; left time: 1430.4613s
	iters: 200, epoch: 67 | loss: 0.3668776
	speed: 0.0375s/iter; left time: 332.7423s
Epoch: 67 cost time: 11.915752649307251
Epoch: 67, Steps: 267 | Train Loss: 0.3199394 Vali Loss: 0.1636887 Test Loss: 0.2322144
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.3159892
	speed: 0.1731s/iter; left time: 1508.0469s
	iters: 200, epoch: 68 | loss: 0.3691213
	speed: 0.0294s/iter; left time: 253.2824s
Epoch: 68 cost time: 8.511770963668823
Epoch: 68, Steps: 267 | Train Loss: 0.3199725 Vali Loss: 0.1636526 Test Loss: 0.2322105
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.4617543
	speed: 0.1097s/iter; left time: 926.1652s
	iters: 200, epoch: 69 | loss: 0.2679213
	speed: 0.0194s/iter; left time: 161.9971s
Epoch: 69 cost time: 5.7047364711761475
Epoch: 69, Steps: 267 | Train Loss: 0.3199157 Vali Loss: 0.1638347 Test Loss: 0.2322120
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2608051
	speed: 0.1114s/iter; left time: 910.8442s
	iters: 200, epoch: 70 | loss: 0.3464865
	speed: 0.0225s/iter; left time: 182.0870s
Epoch: 70 cost time: 7.5840020179748535
Epoch: 70, Steps: 267 | Train Loss: 0.3200196 Vali Loss: 0.1637025 Test Loss: 0.2322114
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2382666
	speed: 0.1321s/iter; left time: 1045.3695s
	iters: 200, epoch: 71 | loss: 0.3016991
	speed: 0.0186s/iter; left time: 145.2157s
Epoch: 71 cost time: 7.880262613296509
Epoch: 71, Steps: 267 | Train Loss: 0.3199942 Vali Loss: 0.1635686 Test Loss: 0.2322135
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.3589087
	speed: 0.1286s/iter; left time: 982.7515s
	iters: 200, epoch: 72 | loss: 0.4155698
	speed: 0.0283s/iter; left time: 213.7783s
Epoch: 72 cost time: 7.676993131637573
Epoch: 72, Steps: 267 | Train Loss: 0.3197831 Vali Loss: 0.1637364 Test Loss: 0.2322114
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.3448113
	speed: 0.1304s/iter; left time: 962.0395s
	iters: 200, epoch: 73 | loss: 0.4413093
	speed: 0.0206s/iter; left time: 150.2324s
Epoch: 73 cost time: 9.909170389175415
Epoch: 73, Steps: 267 | Train Loss: 0.3200298 Vali Loss: 0.1637028 Test Loss: 0.2322112
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.4145296
	speed: 0.1235s/iter; left time: 878.2863s
	iters: 200, epoch: 74 | loss: 0.3090127
	speed: 0.0216s/iter; left time: 151.2282s
Epoch: 74 cost time: 6.524376392364502
Epoch: 74, Steps: 267 | Train Loss: 0.3199950 Vali Loss: 0.1636895 Test Loss: 0.2322089
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2316992
	speed: 0.0941s/iter; left time: 643.8722s
	iters: 200, epoch: 75 | loss: 0.2602929
	speed: 0.0247s/iter; left time: 166.7604s
Epoch: 75 cost time: 6.814355850219727
Epoch: 75, Steps: 267 | Train Loss: 0.3198499 Vali Loss: 0.1636945 Test Loss: 0.2322067
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.4570230
	speed: 0.1472s/iter; left time: 968.1829s
	iters: 200, epoch: 76 | loss: 0.2730014
	speed: 0.0344s/iter; left time: 222.7804s
Epoch: 76 cost time: 8.413702964782715
Epoch: 76, Steps: 267 | Train Loss: 0.3199898 Vali Loss: 0.1636303 Test Loss: 0.2322071
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2704391
	speed: 0.1163s/iter; left time: 733.9095s
	iters: 200, epoch: 77 | loss: 0.3182774
	speed: 0.0295s/iter; left time: 183.4587s
Epoch: 77 cost time: 8.440369129180908
Epoch: 77, Steps: 267 | Train Loss: 0.3199668 Vali Loss: 0.1637912 Test Loss: 0.2322092
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.5039802
	speed: 0.1329s/iter; left time: 802.8101s
	iters: 200, epoch: 78 | loss: 0.3623258
	speed: 0.0221s/iter; left time: 131.4182s
Epoch: 78 cost time: 8.266576528549194
Epoch: 78, Steps: 267 | Train Loss: 0.3198314 Vali Loss: 0.1637861 Test Loss: 0.2322088
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.23300491273403168, mae:0.29666438698768616, rse:0.3907307982444763, corr:[0.56804806 0.56768686 0.5623013  0.56084317 0.5615102  0.56070065
 0.5585457  0.55712736 0.5570873  0.5571707  0.55629724 0.5550094
 0.554408   0.55458915 0.55468374 0.55396837 0.5527792  0.5519323
 0.5516625  0.55142784 0.5507466  0.5497621  0.54905045 0.54884857
 0.5487475  0.5483114  0.54762286 0.5470398  0.5466958  0.5463097
 0.5456757  0.5449112  0.5442607  0.5439319  0.5437464  0.5434206
 0.54273367 0.54190373 0.54117656 0.5405935  0.5400848  0.5395701
 0.5390917  0.5387457  0.53847724 0.5381319  0.53752255 0.5366588
 0.53573006 0.5349341  0.53428644 0.53370476 0.5330261  0.53226876
 0.53164876 0.5312634  0.53087145 0.53041786 0.52992284 0.52955735
 0.5292989  0.52916604 0.52903134 0.5287748  0.5285261  0.5284165
 0.528335   0.5282082  0.5280035  0.5278362  0.52772576 0.52765924
 0.52756923 0.5273382  0.52708334 0.5268151  0.526565   0.5262567
 0.52589375 0.5254791  0.5250427  0.52459866 0.5242052  0.523825
 0.5234112  0.52299756 0.52254784 0.5221569  0.5218082  0.52146703
 0.52116174 0.52085394 0.52040917 0.5197645  0.5188476  0.51757973
 0.51593566 0.5141391  0.51236033 0.5107403  0.50934416 0.50813776
 0.5069885  0.5058007  0.50450355 0.5032     0.5020107  0.50097317
 0.49995813 0.49882144 0.4978002  0.49686736 0.49600464 0.49507993
 0.4939937  0.49286366 0.49176958 0.49073887 0.48979163 0.48882678
 0.48786944 0.4869257  0.48605368 0.48521456 0.48439425 0.483559
 0.4826501  0.48167747 0.48069704 0.4797379  0.47888538 0.478061
 0.4772677  0.47641906 0.47573707 0.47527444 0.47481322 0.4743381
 0.4738089  0.47329256 0.47282892 0.47234064 0.47173542 0.4709421
 0.47005713 0.46923298 0.46841517 0.4675646  0.46676517 0.46601328
 0.4654842  0.46525726 0.46492788 0.4643416  0.46366107 0.4631585
 0.46286643 0.46256068 0.46189433 0.461143   0.46068227 0.4606557
 0.4607725  0.46045554 0.45998785 0.45970187 0.45989683 0.46038848
 0.46058854 0.46035278 0.45999888 0.46009624 0.4606933  0.46100193
 0.4607427  0.46006006 0.4597176  0.45995307 0.46020815 0.46003246
 0.45937994 0.45889202 0.4590854  0.4593239  0.4591535  0.45852962
 0.45836222 0.45899853 0.4595069  0.459247   0.4585019  0.4579223 ]
