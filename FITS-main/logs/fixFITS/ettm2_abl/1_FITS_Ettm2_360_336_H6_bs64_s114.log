Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_360_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_360_336_FITS_ETTm2_ftM_sl360_ll48_pl336_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33865
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=34, out_features=65, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1980160.0
params:  2275.0
Trainable parameters:  2275
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3137572
	speed: 0.0225s/iter; left time: 592.9266s
	iters: 200, epoch: 1 | loss: 0.3504721
	speed: 0.0229s/iter; left time: 600.8967s
Epoch: 1 cost time: 5.642166614532471
Epoch: 1, Steps: 264 | Train Loss: 0.4867177 Vali Loss: 0.2214747 Test Loss: 0.2942363
Validation loss decreased (inf --> 0.221475).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3120013
	speed: 0.0822s/iter; left time: 2140.8409s
	iters: 200, epoch: 2 | loss: 0.3546876
	speed: 0.0155s/iter; left time: 402.9691s
Epoch: 2 cost time: 6.982320070266724
Epoch: 2, Steps: 264 | Train Loss: 0.4245356 Vali Loss: 0.2114114 Test Loss: 0.2835334
Validation loss decreased (0.221475 --> 0.211411).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4282653
	speed: 0.1275s/iter; left time: 3287.1975s
	iters: 200, epoch: 3 | loss: 0.3740002
	speed: 0.0167s/iter; left time: 428.7968s
Epoch: 3 cost time: 5.8142595291137695
Epoch: 3, Steps: 264 | Train Loss: 0.4133356 Vali Loss: 0.2072777 Test Loss: 0.2796907
Validation loss decreased (0.211411 --> 0.207278).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3463931
	speed: 0.1133s/iter; left time: 2889.9889s
	iters: 200, epoch: 4 | loss: 0.3924549
	speed: 0.0162s/iter; left time: 412.4294s
Epoch: 4 cost time: 4.763059616088867
Epoch: 4, Steps: 264 | Train Loss: 0.4065153 Vali Loss: 0.2052401 Test Loss: 0.2775995
Validation loss decreased (0.207278 --> 0.205240).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.5282324
	speed: 0.0844s/iter; left time: 2131.0575s
	iters: 200, epoch: 5 | loss: 0.5188267
	speed: 0.0175s/iter; left time: 441.0576s
Epoch: 5 cost time: 5.477936506271362
Epoch: 5, Steps: 264 | Train Loss: 0.4028658 Vali Loss: 0.2036479 Test Loss: 0.2761054
Validation loss decreased (0.205240 --> 0.203648).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4441880
	speed: 0.0738s/iter; left time: 1844.6167s
	iters: 200, epoch: 6 | loss: 0.4343330
	speed: 0.0149s/iter; left time: 370.9797s
Epoch: 6 cost time: 4.403544187545776
Epoch: 6, Steps: 264 | Train Loss: 0.4006669 Vali Loss: 0.2026008 Test Loss: 0.2751521
Validation loss decreased (0.203648 --> 0.202601).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4845725
	speed: 0.0782s/iter; left time: 1934.0239s
	iters: 200, epoch: 7 | loss: 0.4351161
	speed: 0.0294s/iter; left time: 723.2817s
Epoch: 7 cost time: 6.465666055679321
Epoch: 7, Steps: 264 | Train Loss: 0.3987674 Vali Loss: 0.2018076 Test Loss: 0.2746067
Validation loss decreased (0.202601 --> 0.201808).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4226805
	speed: 0.1236s/iter; left time: 3021.1977s
	iters: 200, epoch: 8 | loss: 0.3015192
	speed: 0.0349s/iter; left time: 850.5050s
Epoch: 8 cost time: 9.072962045669556
Epoch: 8, Steps: 264 | Train Loss: 0.3972337 Vali Loss: 0.2015457 Test Loss: 0.2741217
Validation loss decreased (0.201808 --> 0.201546).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3671755
	speed: 0.1145s/iter; left time: 2770.7897s
	iters: 200, epoch: 9 | loss: 0.3631719
	speed: 0.0180s/iter; left time: 433.6956s
Epoch: 9 cost time: 6.0653235912323
Epoch: 9, Steps: 264 | Train Loss: 0.3963053 Vali Loss: 0.2008158 Test Loss: 0.2738952
Validation loss decreased (0.201546 --> 0.200816).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3408856
	speed: 0.1338s/iter; left time: 3201.7438s
	iters: 200, epoch: 10 | loss: 0.2939820
	speed: 0.0241s/iter; left time: 573.8931s
Epoch: 10 cost time: 8.418773174285889
Epoch: 10, Steps: 264 | Train Loss: 0.3954783 Vali Loss: 0.2005779 Test Loss: 0.2736492
Validation loss decreased (0.200816 --> 0.200578).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.4817158
	speed: 0.1185s/iter; left time: 2803.5345s
	iters: 200, epoch: 11 | loss: 0.2961211
	speed: 0.0293s/iter; left time: 691.4526s
Epoch: 11 cost time: 6.755863428115845
Epoch: 11, Steps: 264 | Train Loss: 0.3948502 Vali Loss: 0.2004574 Test Loss: 0.2734474
Validation loss decreased (0.200578 --> 0.200457).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3248065
	speed: 0.0979s/iter; left time: 2290.1448s
	iters: 200, epoch: 12 | loss: 0.5446692
	speed: 0.0212s/iter; left time: 494.9048s
Epoch: 12 cost time: 6.955396890640259
Epoch: 12, Steps: 264 | Train Loss: 0.3945152 Vali Loss: 0.2005946 Test Loss: 0.2733254
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3283706
	speed: 0.1154s/iter; left time: 2668.6773s
	iters: 200, epoch: 13 | loss: 0.3069438
	speed: 0.0309s/iter; left time: 712.0213s
Epoch: 13 cost time: 7.003419876098633
Epoch: 13, Steps: 264 | Train Loss: 0.3933867 Vali Loss: 0.2001734 Test Loss: 0.2733023
Validation loss decreased (0.200457 --> 0.200173).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3334834
	speed: 0.1282s/iter; left time: 2930.6977s
	iters: 200, epoch: 14 | loss: 0.4984205
	speed: 0.0261s/iter; left time: 593.5148s
Epoch: 14 cost time: 9.124554872512817
Epoch: 14, Steps: 264 | Train Loss: 0.3936603 Vali Loss: 0.1999643 Test Loss: 0.2732352
Validation loss decreased (0.200173 --> 0.199964).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2819100
	speed: 0.1117s/iter; left time: 2524.4464s
	iters: 200, epoch: 15 | loss: 0.3230362
	speed: 0.0178s/iter; left time: 400.0737s
Epoch: 15 cost time: 5.6593217849731445
Epoch: 15, Steps: 264 | Train Loss: 0.3936831 Vali Loss: 0.1999067 Test Loss: 0.2730475
Validation loss decreased (0.199964 --> 0.199907).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2624426
	speed: 0.0955s/iter; left time: 2133.8692s
	iters: 200, epoch: 16 | loss: 0.2509267
	speed: 0.0240s/iter; left time: 534.2711s
Epoch: 16 cost time: 7.003965377807617
Epoch: 16, Steps: 264 | Train Loss: 0.3934564 Vali Loss: 0.2000430 Test Loss: 0.2731093
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.6546863
	speed: 0.0946s/iter; left time: 2087.4513s
	iters: 200, epoch: 17 | loss: 0.4620965
	speed: 0.0177s/iter; left time: 389.8564s
Epoch: 17 cost time: 5.524260997772217
Epoch: 17, Steps: 264 | Train Loss: 0.3926322 Vali Loss: 0.1997138 Test Loss: 0.2729047
Validation loss decreased (0.199907 --> 0.199714).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.4683496
	speed: 0.0858s/iter; left time: 1870.4863s
	iters: 200, epoch: 18 | loss: 0.4386961
	speed: 0.0217s/iter; left time: 471.9406s
Epoch: 18 cost time: 6.136114120483398
Epoch: 18, Steps: 264 | Train Loss: 0.3927794 Vali Loss: 0.1997930 Test Loss: 0.2729437
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2993592
	speed: 0.0839s/iter; left time: 1808.1056s
	iters: 200, epoch: 19 | loss: 0.4779252
	speed: 0.0255s/iter; left time: 547.7641s
Epoch: 19 cost time: 7.097771883010864
Epoch: 19, Steps: 264 | Train Loss: 0.3927212 Vali Loss: 0.1997564 Test Loss: 0.2729331
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3776639
	speed: 0.1170s/iter; left time: 2490.2771s
	iters: 200, epoch: 20 | loss: 0.3657135
	speed: 0.0205s/iter; left time: 433.8476s
Epoch: 20 cost time: 6.190009117126465
Epoch: 20, Steps: 264 | Train Loss: 0.3926435 Vali Loss: 0.1997641 Test Loss: 0.2729111
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3751586
	speed: 0.1020s/iter; left time: 2143.0955s
	iters: 200, epoch: 21 | loss: 0.2367095
	speed: 0.0271s/iter; left time: 567.6715s
Epoch: 21 cost time: 6.022899627685547
Epoch: 21, Steps: 264 | Train Loss: 0.3924856 Vali Loss: 0.1997163 Test Loss: 0.2728827
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3586135
	speed: 0.1099s/iter; left time: 2281.9655s
	iters: 200, epoch: 22 | loss: 0.4407841
	speed: 0.0197s/iter; left time: 406.9453s
Epoch: 22 cost time: 6.920973062515259
Epoch: 22, Steps: 264 | Train Loss: 0.3927618 Vali Loss: 0.1995461 Test Loss: 0.2729087
Validation loss decreased (0.199714 --> 0.199546).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.4889745
	speed: 0.0930s/iter; left time: 1905.1597s
	iters: 200, epoch: 23 | loss: 0.4222746
	speed: 0.0157s/iter; left time: 320.2827s
Epoch: 23 cost time: 4.663459062576294
Epoch: 23, Steps: 264 | Train Loss: 0.3925103 Vali Loss: 0.1994451 Test Loss: 0.2728375
Validation loss decreased (0.199546 --> 0.199445).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2735261
	speed: 0.0812s/iter; left time: 1642.2669s
	iters: 200, epoch: 24 | loss: 0.4069852
	speed: 0.0169s/iter; left time: 339.3958s
Epoch: 24 cost time: 5.233618259429932
Epoch: 24, Steps: 264 | Train Loss: 0.3921412 Vali Loss: 0.1994175 Test Loss: 0.2727935
Validation loss decreased (0.199445 --> 0.199418).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4556979
	speed: 0.0825s/iter; left time: 1648.0114s
	iters: 200, epoch: 25 | loss: 0.3882615
	speed: 0.0161s/iter; left time: 320.3718s
Epoch: 25 cost time: 5.196124076843262
Epoch: 25, Steps: 264 | Train Loss: 0.3923915 Vali Loss: 0.1996579 Test Loss: 0.2728192
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3796788
	speed: 0.0854s/iter; left time: 1683.3808s
	iters: 200, epoch: 26 | loss: 0.5289563
	speed: 0.0298s/iter; left time: 584.0170s
Epoch: 26 cost time: 7.863818883895874
Epoch: 26, Steps: 264 | Train Loss: 0.3920209 Vali Loss: 0.1995629 Test Loss: 0.2727921
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2798681
	speed: 0.1153s/iter; left time: 2240.7312s
	iters: 200, epoch: 27 | loss: 0.3499806
	speed: 0.0197s/iter; left time: 380.4415s
Epoch: 27 cost time: 5.2443318367004395
Epoch: 27, Steps: 264 | Train Loss: 0.3920156 Vali Loss: 0.1994252 Test Loss: 0.2727812
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3069000
	speed: 0.1127s/iter; left time: 2160.0901s
	iters: 200, epoch: 28 | loss: 0.3976058
	speed: 0.0178s/iter; left time: 339.9351s
Epoch: 28 cost time: 6.483273029327393
Epoch: 28, Steps: 264 | Train Loss: 0.3920077 Vali Loss: 0.1992462 Test Loss: 0.2727713
Validation loss decreased (0.199418 --> 0.199246).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.4191106
	speed: 0.1049s/iter; left time: 1983.6494s
	iters: 200, epoch: 29 | loss: 0.4270698
	speed: 0.0219s/iter; left time: 411.6352s
Epoch: 29 cost time: 6.1841230392456055
Epoch: 29, Steps: 264 | Train Loss: 0.3921373 Vali Loss: 0.1993974 Test Loss: 0.2727624
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4218114
	speed: 0.0962s/iter; left time: 1793.0047s
	iters: 200, epoch: 30 | loss: 0.3028103
	speed: 0.0247s/iter; left time: 457.2935s
Epoch: 30 cost time: 6.492561340332031
Epoch: 30, Steps: 264 | Train Loss: 0.3921794 Vali Loss: 0.1994777 Test Loss: 0.2727443
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3586105
	speed: 0.1041s/iter; left time: 1913.3823s
	iters: 200, epoch: 31 | loss: 0.3099615
	speed: 0.0148s/iter; left time: 270.9383s
Epoch: 31 cost time: 5.4512622356414795
Epoch: 31, Steps: 264 | Train Loss: 0.3919440 Vali Loss: 0.1994639 Test Loss: 0.2727465
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2818267
	speed: 0.0948s/iter; left time: 1716.9474s
	iters: 200, epoch: 32 | loss: 0.5080170
	speed: 0.0166s/iter; left time: 299.3312s
Epoch: 32 cost time: 6.09490442276001
Epoch: 32, Steps: 264 | Train Loss: 0.3919951 Vali Loss: 0.1993719 Test Loss: 0.2727676
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3851005
	speed: 0.1002s/iter; left time: 1789.5701s
	iters: 200, epoch: 33 | loss: 0.3786128
	speed: 0.0266s/iter; left time: 471.8860s
Epoch: 33 cost time: 5.748374700546265
Epoch: 33, Steps: 264 | Train Loss: 0.3918698 Vali Loss: 0.1993795 Test Loss: 0.2727218
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.4270629
	speed: 0.0840s/iter; left time: 1476.7197s
	iters: 200, epoch: 34 | loss: 0.3255326
	speed: 0.0215s/iter; left time: 376.6183s
Epoch: 34 cost time: 6.085074186325073
Epoch: 34, Steps: 264 | Train Loss: 0.3912252 Vali Loss: 0.1993369 Test Loss: 0.2726981
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3495147
	speed: 0.1254s/iter; left time: 2171.8801s
	iters: 200, epoch: 35 | loss: 0.4192782
	speed: 0.0165s/iter; left time: 284.9735s
Epoch: 35 cost time: 7.52393364906311
Epoch: 35, Steps: 264 | Train Loss: 0.3920187 Vali Loss: 0.1993644 Test Loss: 0.2726978
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.4701315
	speed: 0.0926s/iter; left time: 1580.3325s
	iters: 200, epoch: 36 | loss: 0.3772046
	speed: 0.0270s/iter; left time: 457.5695s
Epoch: 36 cost time: 6.9096903800964355
Epoch: 36, Steps: 264 | Train Loss: 0.3919121 Vali Loss: 0.1994989 Test Loss: 0.2727138
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2872939
	speed: 0.0965s/iter; left time: 1621.5084s
	iters: 200, epoch: 37 | loss: 0.4069420
	speed: 0.0185s/iter; left time: 308.1991s
Epoch: 37 cost time: 5.689712047576904
Epoch: 37, Steps: 264 | Train Loss: 0.3918424 Vali Loss: 0.1992830 Test Loss: 0.2726812
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.5292099
	speed: 0.0960s/iter; left time: 1586.3438s
	iters: 200, epoch: 38 | loss: 0.5739859
	speed: 0.0264s/iter; left time: 433.8044s
Epoch: 38 cost time: 6.915453672409058
Epoch: 38, Steps: 264 | Train Loss: 0.3916943 Vali Loss: 0.1994526 Test Loss: 0.2726975
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2178647
	speed: 0.1068s/iter; left time: 1737.7120s
	iters: 200, epoch: 39 | loss: 0.4964134
	speed: 0.0211s/iter; left time: 340.8249s
Epoch: 39 cost time: 6.712791442871094
Epoch: 39, Steps: 264 | Train Loss: 0.3914920 Vali Loss: 0.1993663 Test Loss: 0.2726743
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3399828
	speed: 0.0968s/iter; left time: 1548.9046s
	iters: 200, epoch: 40 | loss: 0.3532026
	speed: 0.0250s/iter; left time: 397.6679s
Epoch: 40 cost time: 7.278443336486816
Epoch: 40, Steps: 264 | Train Loss: 0.3915897 Vali Loss: 0.1992649 Test Loss: 0.2726833
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3775560
	speed: 0.1065s/iter; left time: 1676.4115s
	iters: 200, epoch: 41 | loss: 0.2962962
	speed: 0.0191s/iter; left time: 298.4571s
Epoch: 41 cost time: 5.000547647476196
Epoch: 41, Steps: 264 | Train Loss: 0.3917771 Vali Loss: 0.1993722 Test Loss: 0.2726674
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3893003
	speed: 0.0876s/iter; left time: 1356.0199s
	iters: 200, epoch: 42 | loss: 0.3426944
	speed: 0.0174s/iter; left time: 266.9755s
Epoch: 42 cost time: 5.63884711265564
Epoch: 42, Steps: 264 | Train Loss: 0.3916595 Vali Loss: 0.1992120 Test Loss: 0.2726645
Validation loss decreased (0.199246 --> 0.199212).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2819929
	speed: 0.0858s/iter; left time: 1305.4525s
	iters: 200, epoch: 43 | loss: 0.5105131
	speed: 0.0160s/iter; left time: 242.3753s
Epoch: 43 cost time: 5.54166841506958
Epoch: 43, Steps: 264 | Train Loss: 0.3915681 Vali Loss: 0.1992255 Test Loss: 0.2726568
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2749422
	speed: 0.0859s/iter; left time: 1283.8776s
	iters: 200, epoch: 44 | loss: 0.3579669
	speed: 0.0263s/iter; left time: 391.1570s
Epoch: 44 cost time: 6.946063041687012
Epoch: 44, Steps: 264 | Train Loss: 0.3918671 Vali Loss: 0.1994362 Test Loss: 0.2726752
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2755491
	speed: 0.0979s/iter; left time: 1438.2648s
	iters: 200, epoch: 45 | loss: 0.3637178
	speed: 0.0322s/iter; left time: 469.8596s
Epoch: 45 cost time: 8.053628206253052
Epoch: 45, Steps: 264 | Train Loss: 0.3914605 Vali Loss: 0.1993493 Test Loss: 0.2726447
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2991744
	speed: 0.1102s/iter; left time: 1589.7175s
	iters: 200, epoch: 46 | loss: 0.4837533
	speed: 0.0366s/iter; left time: 524.1020s
Epoch: 46 cost time: 7.112840414047241
Epoch: 46, Steps: 264 | Train Loss: 0.3917768 Vali Loss: 0.1992093 Test Loss: 0.2726522
Validation loss decreased (0.199212 --> 0.199209).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2349596
	speed: 0.0905s/iter; left time: 1281.7552s
	iters: 200, epoch: 47 | loss: 0.2759414
	speed: 0.0171s/iter; left time: 241.0330s
Epoch: 47 cost time: 6.017609596252441
Epoch: 47, Steps: 264 | Train Loss: 0.3913783 Vali Loss: 0.1993324 Test Loss: 0.2726506
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.5248571
	speed: 0.0876s/iter; left time: 1217.6020s
	iters: 200, epoch: 48 | loss: 0.3609194
	speed: 0.0254s/iter; left time: 350.1561s
Epoch: 48 cost time: 6.18066668510437
Epoch: 48, Steps: 264 | Train Loss: 0.3917411 Vali Loss: 0.1992683 Test Loss: 0.2726510
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.3152324
	speed: 0.0898s/iter; left time: 1224.4976s
	iters: 200, epoch: 49 | loss: 0.4343925
	speed: 0.0167s/iter; left time: 226.5224s
Epoch: 49 cost time: 5.803402900695801
Epoch: 49, Steps: 264 | Train Loss: 0.3913737 Vali Loss: 0.1993083 Test Loss: 0.2726529
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2898919
	speed: 0.0870s/iter; left time: 1162.8372s
	iters: 200, epoch: 50 | loss: 0.4500445
	speed: 0.0155s/iter; left time: 205.7225s
Epoch: 50 cost time: 5.306393623352051
Epoch: 50, Steps: 264 | Train Loss: 0.3915596 Vali Loss: 0.1992652 Test Loss: 0.2726499
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.3899979
	speed: 0.1121s/iter; left time: 1468.7903s
	iters: 200, epoch: 51 | loss: 0.3392754
	speed: 0.0153s/iter; left time: 198.8116s
Epoch: 51 cost time: 4.522850751876831
Epoch: 51, Steps: 264 | Train Loss: 0.3916609 Vali Loss: 0.1992261 Test Loss: 0.2726402
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.4851274
	speed: 0.0905s/iter; left time: 1161.7172s
	iters: 200, epoch: 52 | loss: 0.3888003
	speed: 0.0281s/iter; left time: 357.5782s
Epoch: 52 cost time: 7.990076541900635
Epoch: 52, Steps: 264 | Train Loss: 0.3915642 Vali Loss: 0.1994382 Test Loss: 0.2726413
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.4646352
	speed: 0.1164s/iter; left time: 1463.3938s
	iters: 200, epoch: 53 | loss: 0.4127000
	speed: 0.0162s/iter; left time: 202.6601s
Epoch: 53 cost time: 7.798931360244751
Epoch: 53, Steps: 264 | Train Loss: 0.3912979 Vali Loss: 0.1991880 Test Loss: 0.2726393
Validation loss decreased (0.199209 --> 0.199188).  Saving model ...
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.3003754
	speed: 0.1299s/iter; left time: 1599.5406s
	iters: 200, epoch: 54 | loss: 0.2894210
	speed: 0.0226s/iter; left time: 275.3341s
Epoch: 54 cost time: 6.150200843811035
Epoch: 54, Steps: 264 | Train Loss: 0.3916442 Vali Loss: 0.1993403 Test Loss: 0.2726422
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2977797
	speed: 0.1186s/iter; left time: 1428.8840s
	iters: 200, epoch: 55 | loss: 0.2484292
	speed: 0.0241s/iter; left time: 288.0277s
Epoch: 55 cost time: 7.929204940795898
Epoch: 55, Steps: 264 | Train Loss: 0.3910702 Vali Loss: 0.1994488 Test Loss: 0.2726287
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.5203308
	speed: 0.1058s/iter; left time: 1246.3883s
	iters: 200, epoch: 56 | loss: 0.2793765
	speed: 0.0169s/iter; left time: 197.9370s
Epoch: 56 cost time: 5.038005828857422
Epoch: 56, Steps: 264 | Train Loss: 0.3917122 Vali Loss: 0.1992344 Test Loss: 0.2726347
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2668822
	speed: 0.0822s/iter; left time: 946.2227s
	iters: 200, epoch: 57 | loss: 0.3149148
	speed: 0.0195s/iter; left time: 222.4499s
Epoch: 57 cost time: 6.918972969055176
Epoch: 57, Steps: 264 | Train Loss: 0.3911887 Vali Loss: 0.1992273 Test Loss: 0.2726279
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3879407
	speed: 0.1126s/iter; left time: 1266.8115s
	iters: 200, epoch: 58 | loss: 0.3309274
	speed: 0.0142s/iter; left time: 157.9013s
Epoch: 58 cost time: 4.260486841201782
Epoch: 58, Steps: 264 | Train Loss: 0.3915638 Vali Loss: 0.1992343 Test Loss: 0.2726251
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.5707510
	speed: 0.0750s/iter; left time: 823.7814s
	iters: 200, epoch: 59 | loss: 0.3086670
	speed: 0.0165s/iter; left time: 179.6202s
Epoch: 59 cost time: 4.8765058517456055
Epoch: 59, Steps: 264 | Train Loss: 0.3912464 Vali Loss: 0.1993152 Test Loss: 0.2726290
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.5324047
	speed: 0.0886s/iter; left time: 950.6835s
	iters: 200, epoch: 60 | loss: 0.4597974
	speed: 0.0223s/iter; left time: 237.1672s
Epoch: 60 cost time: 6.276925325393677
Epoch: 60, Steps: 264 | Train Loss: 0.3908276 Vali Loss: 0.1991316 Test Loss: 0.2726272
Validation loss decreased (0.199188 --> 0.199132).  Saving model ...
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2856460
	speed: 0.0917s/iter; left time: 958.7965s
	iters: 200, epoch: 61 | loss: 0.3033885
	speed: 0.0243s/iter; left time: 251.7049s
Epoch: 61 cost time: 7.274162530899048
Epoch: 61, Steps: 264 | Train Loss: 0.3913424 Vali Loss: 0.1992285 Test Loss: 0.2726241
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.5196187
	speed: 0.1230s/iter; left time: 1254.2894s
	iters: 200, epoch: 62 | loss: 0.3424156
	speed: 0.0169s/iter; left time: 170.2176s
Epoch: 62 cost time: 7.38659930229187
Epoch: 62, Steps: 264 | Train Loss: 0.3905797 Vali Loss: 0.1993416 Test Loss: 0.2726259
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.3423944
	speed: 0.1454s/iter; left time: 1444.6016s
	iters: 200, epoch: 63 | loss: 0.3462585
	speed: 0.0385s/iter; left time: 378.3974s
Epoch: 63 cost time: 9.432251930236816
Epoch: 63, Steps: 264 | Train Loss: 0.3916994 Vali Loss: 0.1993015 Test Loss: 0.2726218
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2417512
	speed: 0.0930s/iter; left time: 899.5617s
	iters: 200, epoch: 64 | loss: 0.2269818
	speed: 0.0250s/iter; left time: 239.5292s
Epoch: 64 cost time: 6.249706029891968
Epoch: 64, Steps: 264 | Train Loss: 0.3916146 Vali Loss: 0.1991823 Test Loss: 0.2726184
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.3242745
	speed: 0.0890s/iter; left time: 837.4473s
	iters: 200, epoch: 65 | loss: 0.3956360
	speed: 0.0183s/iter; left time: 170.6313s
Epoch: 65 cost time: 7.0090720653533936
Epoch: 65, Steps: 264 | Train Loss: 0.3914265 Vali Loss: 0.1994101 Test Loss: 0.2726175
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.4412310
	speed: 0.0992s/iter; left time: 907.1315s
	iters: 200, epoch: 66 | loss: 0.4527241
	speed: 0.0143s/iter; left time: 129.4084s
Epoch: 66 cost time: 4.512929677963257
Epoch: 66, Steps: 264 | Train Loss: 0.3911629 Vali Loss: 0.1992812 Test Loss: 0.2726202
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.5355998
	speed: 0.0811s/iter; left time: 720.0621s
	iters: 200, epoch: 67 | loss: 0.4170051
	speed: 0.0191s/iter; left time: 167.8506s
Epoch: 67 cost time: 5.349318265914917
Epoch: 67, Steps: 264 | Train Loss: 0.3915775 Vali Loss: 0.1993875 Test Loss: 0.2726173
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.3443804
	speed: 0.1141s/iter; left time: 982.7140s
	iters: 200, epoch: 68 | loss: 0.3378084
	speed: 0.0200s/iter; left time: 170.2902s
Epoch: 68 cost time: 6.647796392440796
Epoch: 68, Steps: 264 | Train Loss: 0.3917332 Vali Loss: 0.1992572 Test Loss: 0.2726153
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.5192832
	speed: 0.1052s/iter; left time: 878.5886s
	iters: 200, epoch: 69 | loss: 0.3276480
	speed: 0.0311s/iter; left time: 256.5874s
Epoch: 69 cost time: 6.8967461585998535
Epoch: 69, Steps: 264 | Train Loss: 0.3913248 Vali Loss: 0.1993895 Test Loss: 0.2726148
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.4764413
	speed: 0.1245s/iter; left time: 1006.8159s
	iters: 200, epoch: 70 | loss: 0.4023432
	speed: 0.0142s/iter; left time: 113.5095s
Epoch: 70 cost time: 6.970747470855713
Epoch: 70, Steps: 264 | Train Loss: 0.3912405 Vali Loss: 0.1991418 Test Loss: 0.2726121
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2408503
	speed: 0.0826s/iter; left time: 646.3968s
	iters: 200, epoch: 71 | loss: 0.3227109
	speed: 0.0240s/iter; left time: 185.6612s
Epoch: 71 cost time: 6.188920736312866
Epoch: 71, Steps: 264 | Train Loss: 0.3910577 Vali Loss: 0.1993799 Test Loss: 0.2726113
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.3955300
	speed: 0.1010s/iter; left time: 762.9779s
	iters: 200, epoch: 72 | loss: 0.3002643
	speed: 0.0242s/iter; left time: 180.2478s
Epoch: 72 cost time: 5.747227191925049
Epoch: 72, Steps: 264 | Train Loss: 0.3906805 Vali Loss: 0.1991914 Test Loss: 0.2726104
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.3964932
	speed: 0.0891s/iter; left time: 649.7110s
	iters: 200, epoch: 73 | loss: 0.4026017
	speed: 0.0148s/iter; left time: 106.3757s
Epoch: 73 cost time: 5.121239185333252
Epoch: 73, Steps: 264 | Train Loss: 0.3913790 Vali Loss: 0.1992220 Test Loss: 0.2726097
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.3878738
	speed: 0.0824s/iter; left time: 578.8768s
	iters: 200, epoch: 74 | loss: 0.2624696
	speed: 0.0169s/iter; left time: 117.3249s
Epoch: 74 cost time: 5.480048894882202
Epoch: 74, Steps: 264 | Train Loss: 0.3915794 Vali Loss: 0.1993303 Test Loss: 0.2726120
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.3560235
	speed: 0.0949s/iter; left time: 642.3351s
	iters: 200, epoch: 75 | loss: 0.2481907
	speed: 0.0219s/iter; left time: 146.0248s
Epoch: 75 cost time: 6.182163715362549
Epoch: 75, Steps: 264 | Train Loss: 0.3914180 Vali Loss: 0.1993336 Test Loss: 0.2726124
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.3348397
	speed: 0.0882s/iter; left time: 573.3340s
	iters: 200, epoch: 76 | loss: 0.3101219
	speed: 0.0301s/iter; left time: 192.7373s
Epoch: 76 cost time: 6.8608410358428955
Epoch: 76, Steps: 264 | Train Loss: 0.3910631 Vali Loss: 0.1992395 Test Loss: 0.2726087
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.3514799
	speed: 0.0962s/iter; left time: 599.9434s
	iters: 200, epoch: 77 | loss: 0.3763488
	speed: 0.0237s/iter; left time: 145.3625s
Epoch: 77 cost time: 7.3003435134887695
Epoch: 77, Steps: 264 | Train Loss: 0.3913344 Vali Loss: 0.1993086 Test Loss: 0.2726075
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.4832444
	speed: 0.0936s/iter; left time: 559.0584s
	iters: 200, epoch: 78 | loss: 0.3951885
	speed: 0.0169s/iter; left time: 99.5281s
Epoch: 78 cost time: 5.414609909057617
Epoch: 78, Steps: 264 | Train Loss: 0.3907877 Vali Loss: 0.1992332 Test Loss: 0.2726091
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.4203037
	speed: 0.0781s/iter; left time: 446.0763s
	iters: 200, epoch: 79 | loss: 0.4894873
	speed: 0.0221s/iter; left time: 123.7840s
Epoch: 79 cost time: 6.567676544189453
Epoch: 79, Steps: 264 | Train Loss: 0.3913074 Vali Loss: 0.1991791 Test Loss: 0.2726073
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.3570550
	speed: 0.1246s/iter; left time: 678.3529s
	iters: 200, epoch: 80 | loss: 0.4617198
	speed: 0.0159s/iter; left time: 85.0412s
Epoch: 80 cost time: 5.775695085525513
Epoch: 80, Steps: 264 | Train Loss: 0.3915120 Vali Loss: 0.1992223 Test Loss: 0.2726074
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_360_336_FITS_ETTm2_ftM_sl360_ll48_pl336_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.27391958236694336, mae:0.3268350660800934, rse:0.4227388799190521, corr:[0.5508217  0.555466   0.5566396  0.5554364  0.5535658  0.5520169
 0.5512857  0.55125546 0.5516438  0.5521265  0.5523441  0.552216
 0.55179936 0.55119914 0.55059457 0.5500759  0.5497089  0.5494598
 0.54925036 0.5489832  0.5486219  0.548207   0.5477196  0.5472504
 0.54681456 0.5463862  0.5460005  0.54565924 0.545368   0.5450656
 0.5447156  0.54432815 0.5438732  0.5433563  0.54277974 0.54219365
 0.54162604 0.5411045  0.5406634  0.5402713  0.5398724  0.53943974
 0.5389096  0.5382558  0.5375017  0.53666186 0.5358372  0.5350835
 0.5343817  0.53373384 0.53307915 0.5324438  0.5317648  0.5310096
 0.5302082  0.52946275 0.52881336 0.5283098  0.52797836 0.5277851
 0.52765644 0.5275327  0.52736896 0.52711374 0.52677697 0.5264225
 0.5261111  0.52587605 0.5257477  0.52572083 0.5257148  0.525654
 0.5254704  0.5251569  0.5247262  0.5242031  0.52367014 0.5231586
 0.5226919  0.52225703 0.5218624  0.5214389  0.5209598  0.5203828
 0.5197802  0.51921445 0.5186976  0.51827306 0.517917   0.51757526
 0.51717556 0.51664513 0.51587313 0.51482916 0.51355535 0.5121135
 0.510583   0.50912476 0.5077999  0.5065683  0.50537485 0.50421685
 0.50308305 0.50191    0.50071037 0.4995363  0.49847525 0.49756676
 0.4968229  0.49614188 0.4954821  0.4947712  0.49400303 0.49318165
 0.49234444 0.49154717 0.4908359  0.49020228 0.48967633 0.489163
 0.48858416 0.48785523 0.48705116 0.48621303 0.48537195 0.48457977
 0.4838799  0.48323202 0.48257178 0.4818801  0.48116305 0.48041582
 0.47963905 0.47889227 0.47820392 0.4776181  0.4770704  0.47656715
 0.4760287  0.4754352  0.47474962 0.47394565 0.4730543  0.4720886
 0.47113067 0.47024617 0.46951097 0.4689246  0.46841267 0.4678689
 0.4672653  0.46661213 0.46587542 0.46510947 0.46438783 0.46382967
 0.4634151  0.46310547 0.4628089  0.4625207  0.4621757  0.4617444
 0.4613082  0.46090645 0.46063384 0.46053228 0.46048853 0.46048877
 0.46044216 0.46033663 0.46012735 0.45979896 0.4593764  0.45891735
 0.4584675  0.45806804 0.45770654 0.45736483 0.45699573 0.45660558
 0.45616573 0.45567054 0.455223   0.45484874 0.4545437  0.45427617
 0.45396852 0.4535517  0.4529148  0.45196718 0.4507651  0.44929966
 0.44767833 0.44610968 0.4446157  0.44314975 0.441742   0.44036952
 0.43905053 0.4377495  0.4364581  0.43518388 0.43396503 0.43281528
 0.43173185 0.4307233  0.42970255 0.42871243 0.4277587  0.4269238
 0.42618132 0.42547852 0.42482486 0.42424273 0.4236352  0.42295298
 0.42213127 0.42098442 0.4196602  0.41832915 0.4171148  0.4160895
 0.4153402  0.41475528 0.41425422 0.41360655 0.41270438 0.4114967
 0.41009894 0.40877676 0.40764487 0.4068302  0.40632114 0.40604717
 0.40581337 0.40547213 0.4049509  0.40423504 0.40337127 0.40251017
 0.40176445 0.40120935 0.40091082 0.40092215 0.40098315 0.4009454
 0.40079707 0.40051448 0.4000867  0.39962184 0.3992697  0.39919028
 0.39929354 0.39960277 0.3999021  0.40003565 0.3999227  0.39950228
 0.39896786 0.3984253  0.39806283 0.3979458  0.39799967 0.39817393
 0.39836842 0.3984873  0.39845636 0.398164   0.39768046 0.3971776
 0.3966933  0.3963505  0.39619955 0.39628384 0.3964608  0.39660174
 0.39653316 0.39618888 0.39565894 0.39507565 0.39455864 0.3942581
 0.39414543 0.39413568 0.39409056 0.39383614 0.39317515 0.39209712
 0.39069393 0.38927522 0.3879531  0.38680676 0.38593906 0.38539967
 0.38509527 0.38489735 0.38469166 0.38426608 0.38365242 0.3829063
 0.3821059  0.38130954 0.38065878 0.38024178 0.38003507 0.38000643
 0.38015807 0.38026306 0.38019648 0.38002348 0.37972972 0.37938696
 0.3789566  0.3785154  0.37808338 0.37774482 0.37749603 0.37723666
 0.3768818  0.37631762 0.3754825  0.37451    0.3736069  0.37301853
 0.37288788 0.37329662 0.37407538 0.37475872 0.3748921  0.3743239
 0.37313884 0.37173316 0.37096217 0.37187827 0.37517235 0.38015136]
