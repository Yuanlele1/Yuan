Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=16, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=16, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  473088.0
params:  561.0
Trainable parameters:  561
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3616026
	speed: 0.0165s/iter; left time: 440.4728s
	iters: 200, epoch: 1 | loss: 0.2375365
	speed: 0.0114s/iter; left time: 303.0867s
Epoch: 1 cost time: 3.575040817260742
Epoch: 1, Steps: 268 | Train Loss: 0.2449537 Vali Loss: 0.1793594 Test Loss: 0.2446590
Validation loss decreased (inf --> 0.179359).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1815981
	speed: 0.0591s/iter; left time: 1562.1836s
	iters: 200, epoch: 2 | loss: 0.1330001
	speed: 0.0105s/iter; left time: 277.4007s
Epoch: 2 cost time: 3.2717537879943848
Epoch: 2, Steps: 268 | Train Loss: 0.1837864 Vali Loss: 0.1620157 Test Loss: 0.2227062
Validation loss decreased (0.179359 --> 0.162016).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2050910
	speed: 0.0614s/iter; left time: 1607.0357s
	iters: 200, epoch: 3 | loss: 0.1853495
	speed: 0.0105s/iter; left time: 273.0487s
Epoch: 3 cost time: 3.493173122406006
Epoch: 3, Steps: 268 | Train Loss: 0.1628008 Vali Loss: 0.1536752 Test Loss: 0.2121897
Validation loss decreased (0.162016 --> 0.153675).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1589486
	speed: 0.0591s/iter; left time: 1530.8569s
	iters: 200, epoch: 4 | loss: 0.1433041
	speed: 0.0105s/iter; left time: 271.5962s
Epoch: 4 cost time: 3.280261278152466
Epoch: 4, Steps: 268 | Train Loss: 0.1521955 Vali Loss: 0.1481282 Test Loss: 0.2052939
Validation loss decreased (0.153675 --> 0.148128).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1424265
	speed: 0.0588s/iter; left time: 1507.8947s
	iters: 200, epoch: 5 | loss: 0.1546723
	speed: 0.0110s/iter; left time: 280.3347s
Epoch: 5 cost time: 3.5053720474243164
Epoch: 5, Steps: 268 | Train Loss: 0.1455750 Vali Loss: 0.1439691 Test Loss: 0.2003113
Validation loss decreased (0.148128 --> 0.143969).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1531411
	speed: 0.0626s/iter; left time: 1588.7445s
	iters: 200, epoch: 6 | loss: 0.1207988
	speed: 0.0111s/iter; left time: 280.7275s
Epoch: 6 cost time: 3.551462411880493
Epoch: 6, Steps: 268 | Train Loss: 0.1411992 Vali Loss: 0.1406913 Test Loss: 0.1964239
Validation loss decreased (0.143969 --> 0.140691).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1304011
	speed: 0.0625s/iter; left time: 1569.3684s
	iters: 200, epoch: 7 | loss: 0.1206888
	speed: 0.0111s/iter; left time: 276.2026s
Epoch: 7 cost time: 3.6362202167510986
Epoch: 7, Steps: 268 | Train Loss: 0.1379492 Vali Loss: 0.1381303 Test Loss: 0.1935272
Validation loss decreased (0.140691 --> 0.138130).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1641215
	speed: 0.0626s/iter; left time: 1552.8654s
	iters: 200, epoch: 8 | loss: 0.1203186
	speed: 0.0110s/iter; left time: 270.9318s
Epoch: 8 cost time: 3.4573020935058594
Epoch: 8, Steps: 268 | Train Loss: 0.1355003 Vali Loss: 0.1364129 Test Loss: 0.1915206
Validation loss decreased (0.138130 --> 0.136413).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0907364
	speed: 0.0601s/iter; left time: 1475.9941s
	iters: 200, epoch: 9 | loss: 0.1758717
	speed: 0.0102s/iter; left time: 248.8692s
Epoch: 9 cost time: 3.300492763519287
Epoch: 9, Steps: 268 | Train Loss: 0.1342117 Vali Loss: 0.1350534 Test Loss: 0.1900007
Validation loss decreased (0.136413 --> 0.135053).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1716477
	speed: 0.0622s/iter; left time: 1510.2506s
	iters: 200, epoch: 10 | loss: 0.1492419
	speed: 0.0129s/iter; left time: 311.9745s
Epoch: 10 cost time: 3.6434221267700195
Epoch: 10, Steps: 268 | Train Loss: 0.1329709 Vali Loss: 0.1337873 Test Loss: 0.1887826
Validation loss decreased (0.135053 --> 0.133787).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1035143
	speed: 0.0636s/iter; left time: 1527.1628s
	iters: 200, epoch: 11 | loss: 0.1431186
	speed: 0.0128s/iter; left time: 307.2560s
Epoch: 11 cost time: 3.853794574737549
Epoch: 11, Steps: 268 | Train Loss: 0.1323369 Vali Loss: 0.1330013 Test Loss: 0.1878957
Validation loss decreased (0.133787 --> 0.133001).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0975215
	speed: 0.0621s/iter; left time: 1476.2442s
	iters: 200, epoch: 12 | loss: 0.0918724
	speed: 0.0126s/iter; left time: 298.5203s
Epoch: 12 cost time: 3.677144765853882
Epoch: 12, Steps: 268 | Train Loss: 0.1318349 Vali Loss: 0.1323804 Test Loss: 0.1872907
Validation loss decreased (0.133001 --> 0.132380).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1730234
	speed: 0.0630s/iter; left time: 1479.2684s
	iters: 200, epoch: 13 | loss: 0.1967040
	speed: 0.0152s/iter; left time: 355.4796s
Epoch: 13 cost time: 4.182689905166626
Epoch: 13, Steps: 268 | Train Loss: 0.1315636 Vali Loss: 0.1319619 Test Loss: 0.1868466
Validation loss decreased (0.132380 --> 0.131962).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0846829
	speed: 0.0645s/iter; left time: 1496.7382s
	iters: 200, epoch: 14 | loss: 0.1394980
	speed: 0.0105s/iter; left time: 243.4749s
Epoch: 14 cost time: 3.4548277854919434
Epoch: 14, Steps: 268 | Train Loss: 0.1313530 Vali Loss: 0.1317720 Test Loss: 0.1866044
Validation loss decreased (0.131962 --> 0.131772).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1217064
	speed: 0.0590s/iter; left time: 1354.1516s
	iters: 200, epoch: 15 | loss: 0.1418475
	speed: 0.0107s/iter; left time: 245.2029s
Epoch: 15 cost time: 3.393484592437744
Epoch: 15, Steps: 268 | Train Loss: 0.1311149 Vali Loss: 0.1314858 Test Loss: 0.1864158
Validation loss decreased (0.131772 --> 0.131486).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1195169
	speed: 0.0618s/iter; left time: 1402.4665s
	iters: 200, epoch: 16 | loss: 0.1065137
	speed: 0.0146s/iter; left time: 329.1825s
Epoch: 16 cost time: 3.8645753860473633
Epoch: 16, Steps: 268 | Train Loss: 0.1312327 Vali Loss: 0.1313854 Test Loss: 0.1862524
Validation loss decreased (0.131486 --> 0.131385).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1428931
	speed: 0.0640s/iter; left time: 1434.7156s
	iters: 200, epoch: 17 | loss: 0.1095953
	speed: 0.0107s/iter; left time: 238.2532s
Epoch: 17 cost time: 3.840916633605957
Epoch: 17, Steps: 268 | Train Loss: 0.1312020 Vali Loss: 0.1312763 Test Loss: 0.1861684
Validation loss decreased (0.131385 --> 0.131276).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0973237
	speed: 0.0599s/iter; left time: 1326.8898s
	iters: 200, epoch: 18 | loss: 0.0973492
	speed: 0.0103s/iter; left time: 227.9347s
Epoch: 18 cost time: 3.179771900177002
Epoch: 18, Steps: 268 | Train Loss: 0.1311253 Vali Loss: 0.1312068 Test Loss: 0.1861194
Validation loss decreased (0.131276 --> 0.131207).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1259654
	speed: 0.0599s/iter; left time: 1310.5624s
	iters: 200, epoch: 19 | loss: 0.1332374
	speed: 0.0113s/iter; left time: 245.3617s
Epoch: 19 cost time: 3.525453805923462
Epoch: 19, Steps: 268 | Train Loss: 0.1309630 Vali Loss: 0.1311807 Test Loss: 0.1860347
Validation loss decreased (0.131207 --> 0.131181).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1701281
	speed: 0.0623s/iter; left time: 1346.9495s
	iters: 200, epoch: 20 | loss: 0.1080709
	speed: 0.0106s/iter; left time: 228.2298s
Epoch: 20 cost time: 3.3290176391601562
Epoch: 20, Steps: 268 | Train Loss: 0.1310208 Vali Loss: 0.1310343 Test Loss: 0.1860057
Validation loss decreased (0.131181 --> 0.131034).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1045333
	speed: 0.0622s/iter; left time: 1326.6452s
	iters: 200, epoch: 21 | loss: 0.0985369
	speed: 0.0118s/iter; left time: 251.4701s
Epoch: 21 cost time: 3.7759668827056885
Epoch: 21, Steps: 268 | Train Loss: 0.1310312 Vali Loss: 0.1311637 Test Loss: 0.1859763
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1324203
	speed: 0.0624s/iter; left time: 1314.1204s
	iters: 200, epoch: 22 | loss: 0.0927509
	speed: 0.0111s/iter; left time: 232.6630s
Epoch: 22 cost time: 3.5466268062591553
Epoch: 22, Steps: 268 | Train Loss: 0.1310529 Vali Loss: 0.1311463 Test Loss: 0.1859805
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1860004
	speed: 0.0631s/iter; left time: 1312.7479s
	iters: 200, epoch: 23 | loss: 0.1517760
	speed: 0.0106s/iter; left time: 219.2484s
Epoch: 23 cost time: 3.4971888065338135
Epoch: 23, Steps: 268 | Train Loss: 0.1311071 Vali Loss: 0.1309635 Test Loss: 0.1859485
Validation loss decreased (0.131034 --> 0.130963).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0982560
	speed: 0.0587s/iter; left time: 1205.8747s
	iters: 200, epoch: 24 | loss: 0.2095181
	speed: 0.0103s/iter; left time: 211.4622s
Epoch: 24 cost time: 5.255172967910767
Epoch: 24, Steps: 268 | Train Loss: 0.1311382 Vali Loss: 0.1310040 Test Loss: 0.1859562
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1331474
	speed: 0.0809s/iter; left time: 1639.0747s
	iters: 200, epoch: 25 | loss: 0.0984712
	speed: 0.0113s/iter; left time: 227.4298s
Epoch: 25 cost time: 3.471153736114502
Epoch: 25, Steps: 268 | Train Loss: 0.1311396 Vali Loss: 0.1310009 Test Loss: 0.1859551
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1689704
	speed: 0.0643s/iter; left time: 1285.4138s
	iters: 200, epoch: 26 | loss: 0.1053825
	speed: 0.0105s/iter; left time: 209.7477s
Epoch: 26 cost time: 3.7667386531829834
Epoch: 26, Steps: 268 | Train Loss: 0.1309923 Vali Loss: 0.1309692 Test Loss: 0.1859605
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1271172
	speed: 0.0625s/iter; left time: 1232.8682s
	iters: 200, epoch: 27 | loss: 0.1303787
	speed: 0.0106s/iter; left time: 208.7412s
Epoch: 27 cost time: 3.4846506118774414
Epoch: 27, Steps: 268 | Train Loss: 0.1309567 Vali Loss: 0.1311445 Test Loss: 0.1859718
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1006147
	speed: 0.0602s/iter; left time: 1171.3193s
	iters: 200, epoch: 28 | loss: 0.2756267
	speed: 0.0108s/iter; left time: 209.9219s
Epoch: 28 cost time: 3.427753210067749
Epoch: 28, Steps: 268 | Train Loss: 0.1310577 Vali Loss: 0.1311301 Test Loss: 0.1859729
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1449246
	speed: 0.0597s/iter; left time: 1145.3085s
	iters: 200, epoch: 29 | loss: 0.1690171
	speed: 0.0106s/iter; left time: 202.4697s
Epoch: 29 cost time: 3.372622013092041
Epoch: 29, Steps: 268 | Train Loss: 0.1310594 Vali Loss: 0.1310935 Test Loss: 0.1859941
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1673607
	speed: 0.0599s/iter; left time: 1133.4579s
	iters: 200, epoch: 30 | loss: 0.1467129
	speed: 0.0106s/iter; left time: 199.9306s
Epoch: 30 cost time: 3.365586519241333
Epoch: 30, Steps: 268 | Train Loss: 0.1310318 Vali Loss: 0.1310891 Test Loss: 0.1859559
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1005832
	speed: 0.0596s/iter; left time: 1112.9669s
	iters: 200, epoch: 31 | loss: 0.1345946
	speed: 0.0120s/iter; left time: 221.9662s
Epoch: 31 cost time: 3.656998634338379
Epoch: 31, Steps: 268 | Train Loss: 0.1310147 Vali Loss: 0.1310475 Test Loss: 0.1859656
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1073184
	speed: 0.0618s/iter; left time: 1136.8091s
	iters: 200, epoch: 32 | loss: 0.1511368
	speed: 0.0103s/iter; left time: 188.5575s
Epoch: 32 cost time: 3.370309352874756
Epoch: 32, Steps: 268 | Train Loss: 0.1310654 Vali Loss: 0.1311339 Test Loss: 0.1859680
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1310172
	speed: 0.0608s/iter; left time: 1101.7215s
	iters: 200, epoch: 33 | loss: 0.1617396
	speed: 0.0106s/iter; left time: 191.1479s
Epoch: 33 cost time: 3.531534194946289
Epoch: 33, Steps: 268 | Train Loss: 0.1309781 Vali Loss: 0.1310682 Test Loss: 0.1859616
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1125307
	speed: 0.0593s/iter; left time: 1059.3743s
	iters: 200, epoch: 34 | loss: 0.0911731
	speed: 0.0101s/iter; left time: 179.3589s
Epoch: 34 cost time: 3.2991280555725098
Epoch: 34, Steps: 268 | Train Loss: 0.1309806 Vali Loss: 0.1311283 Test Loss: 0.1859770
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1463396
	speed: 0.0653s/iter; left time: 1148.5688s
	iters: 200, epoch: 35 | loss: 0.1305232
	speed: 0.0108s/iter; left time: 188.5300s
Epoch: 35 cost time: 3.5830748081207275
Epoch: 35, Steps: 268 | Train Loss: 0.1311369 Vali Loss: 0.1311066 Test Loss: 0.1859741
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0841003
	speed: 0.0614s/iter; left time: 1062.8798s
	iters: 200, epoch: 36 | loss: 0.1297569
	speed: 0.0109s/iter; left time: 187.1879s
Epoch: 36 cost time: 3.390627861022949
Epoch: 36, Steps: 268 | Train Loss: 0.1310939 Vali Loss: 0.1310943 Test Loss: 0.1859526
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1314828
	speed: 0.0616s/iter; left time: 1050.6417s
	iters: 200, epoch: 37 | loss: 0.1098117
	speed: 0.0108s/iter; left time: 182.4074s
Epoch: 37 cost time: 3.390146017074585
Epoch: 37, Steps: 268 | Train Loss: 0.1309451 Vali Loss: 0.1310663 Test Loss: 0.1859554
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1543253
	speed: 0.0606s/iter; left time: 1017.0171s
	iters: 200, epoch: 38 | loss: 0.1613578
	speed: 0.0103s/iter; left time: 172.6857s
Epoch: 38 cost time: 3.3784284591674805
Epoch: 38, Steps: 268 | Train Loss: 0.1309515 Vali Loss: 0.1311005 Test Loss: 0.1859495
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1060466
	speed: 0.0599s/iter; left time: 990.0264s
	iters: 200, epoch: 39 | loss: 0.1219456
	speed: 0.0108s/iter; left time: 176.9059s
Epoch: 39 cost time: 3.340071678161621
Epoch: 39, Steps: 268 | Train Loss: 0.1310528 Vali Loss: 0.1310138 Test Loss: 0.1859454
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1678784
	speed: 0.0600s/iter; left time: 975.5651s
	iters: 200, epoch: 40 | loss: 0.1034848
	speed: 0.0109s/iter; left time: 176.0293s
Epoch: 40 cost time: 3.434725284576416
Epoch: 40, Steps: 268 | Train Loss: 0.1310733 Vali Loss: 0.1311534 Test Loss: 0.1859569
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1224902
	speed: 0.0593s/iter; left time: 948.0530s
	iters: 200, epoch: 41 | loss: 0.1251706
	speed: 0.0119s/iter; left time: 188.2945s
Epoch: 41 cost time: 3.649001359939575
Epoch: 41, Steps: 268 | Train Loss: 0.1310093 Vali Loss: 0.1311762 Test Loss: 0.1859630
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1129362
	speed: 0.0705s/iter; left time: 1107.5991s
	iters: 200, epoch: 42 | loss: 0.0964869
	speed: 0.0106s/iter; left time: 164.9817s
Epoch: 42 cost time: 4.3114776611328125
Epoch: 42, Steps: 268 | Train Loss: 0.1310469 Vali Loss: 0.1311517 Test Loss: 0.1859636
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1274855
	speed: 0.0615s/iter; left time: 949.5214s
	iters: 200, epoch: 43 | loss: 0.0939051
	speed: 0.0101s/iter; left time: 155.5508s
Epoch: 43 cost time: 3.4189982414245605
Epoch: 43, Steps: 268 | Train Loss: 0.1310744 Vali Loss: 0.1310762 Test Loss: 0.1859572
EarlyStopping counter: 20 out of 20
Early stopping
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=16, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  473088.0
params:  561.0
Trainable parameters:  561
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2697360
	speed: 0.0157s/iter; left time: 419.2982s
	iters: 200, epoch: 1 | loss: 0.2453101
	speed: 0.0104s/iter; left time: 276.4914s
Epoch: 1 cost time: 3.377596378326416
Epoch: 1, Steps: 268 | Train Loss: 0.2425065 Vali Loss: 0.1306460 Test Loss: 0.1854024
Validation loss decreased (inf --> 0.130646).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2288932
	speed: 0.0630s/iter; left time: 1665.8846s
	iters: 200, epoch: 2 | loss: 0.2476174
	speed: 0.0103s/iter; left time: 271.7355s
Epoch: 2 cost time: 3.5220203399658203
Epoch: 2, Steps: 268 | Train Loss: 0.2419372 Vali Loss: 0.1306290 Test Loss: 0.1851388
Validation loss decreased (0.130646 --> 0.130629).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2295906
	speed: 0.0635s/iter; left time: 1660.4744s
	iters: 200, epoch: 3 | loss: 0.2034995
	speed: 0.0114s/iter; left time: 296.5677s
Epoch: 3 cost time: 3.609819173812866
Epoch: 3, Steps: 268 | Train Loss: 0.2418560 Vali Loss: 0.1306270 Test Loss: 0.1851636
Validation loss decreased (0.130629 --> 0.130627).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1391582
	speed: 0.0577s/iter; left time: 1494.5995s
	iters: 200, epoch: 4 | loss: 0.3053831
	speed: 0.0112s/iter; left time: 287.9391s
Epoch: 4 cost time: 3.5293304920196533
Epoch: 4, Steps: 268 | Train Loss: 0.2416844 Vali Loss: 0.1305927 Test Loss: 0.1851124
Validation loss decreased (0.130627 --> 0.130593).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2128852
	speed: 0.0644s/iter; left time: 1649.9758s
	iters: 200, epoch: 5 | loss: 0.3342989
	speed: 0.0103s/iter; left time: 261.8455s
Epoch: 5 cost time: 3.378408670425415
Epoch: 5, Steps: 268 | Train Loss: 0.2414177 Vali Loss: 0.1306514 Test Loss: 0.1851010
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2721416
	speed: 0.0619s/iter; left time: 1569.5995s
	iters: 200, epoch: 6 | loss: 0.2731393
	speed: 0.0113s/iter; left time: 285.3660s
Epoch: 6 cost time: 3.6781005859375
Epoch: 6, Steps: 268 | Train Loss: 0.2413066 Vali Loss: 0.1308222 Test Loss: 0.1852578
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2454438
	speed: 0.0676s/iter; left time: 1696.4054s
	iters: 200, epoch: 7 | loss: 0.1842711
	speed: 0.0117s/iter; left time: 293.3569s
Epoch: 7 cost time: 3.7402052879333496
Epoch: 7, Steps: 268 | Train Loss: 0.2415020 Vali Loss: 0.1306666 Test Loss: 0.1851217
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1815664
	speed: 0.0651s/iter; left time: 1615.3929s
	iters: 200, epoch: 8 | loss: 0.2058496
	speed: 0.0125s/iter; left time: 309.1169s
Epoch: 8 cost time: 3.8226358890533447
Epoch: 8, Steps: 268 | Train Loss: 0.2413472 Vali Loss: 0.1303776 Test Loss: 0.1849190
Validation loss decreased (0.130593 --> 0.130378).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1719361
	speed: 0.0634s/iter; left time: 1555.8652s
	iters: 200, epoch: 9 | loss: 0.2465511
	speed: 0.0104s/iter; left time: 254.9648s
Epoch: 9 cost time: 3.495727777481079
Epoch: 9, Steps: 268 | Train Loss: 0.2409924 Vali Loss: 0.1305798 Test Loss: 0.1850479
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3104648
	speed: 0.0609s/iter; left time: 1479.7104s
	iters: 200, epoch: 10 | loss: 0.3070501
	speed: 0.0102s/iter; left time: 247.4059s
Epoch: 10 cost time: 3.320734739303589
Epoch: 10, Steps: 268 | Train Loss: 0.2412766 Vali Loss: 0.1305480 Test Loss: 0.1850170
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1754198
	speed: 0.0609s/iter; left time: 1461.8998s
	iters: 200, epoch: 11 | loss: 0.3096528
	speed: 0.0116s/iter; left time: 278.1969s
Epoch: 11 cost time: 3.5726540088653564
Epoch: 11, Steps: 268 | Train Loss: 0.2413033 Vali Loss: 0.1306181 Test Loss: 0.1850658
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.4068519
	speed: 0.0635s/iter; left time: 1509.1690s
	iters: 200, epoch: 12 | loss: 0.2225661
	speed: 0.0104s/iter; left time: 246.3918s
Epoch: 12 cost time: 3.5895655155181885
Epoch: 12, Steps: 268 | Train Loss: 0.2411600 Vali Loss: 0.1305354 Test Loss: 0.1850005
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3290320
	speed: 0.0613s/iter; left time: 1438.8666s
	iters: 200, epoch: 13 | loss: 0.2696241
	speed: 0.0102s/iter; left time: 239.5219s
Epoch: 13 cost time: 3.4209020137786865
Epoch: 13, Steps: 268 | Train Loss: 0.2412184 Vali Loss: 0.1306673 Test Loss: 0.1850682
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2621515
	speed: 0.0597s/iter; left time: 1384.9474s
	iters: 200, epoch: 14 | loss: 0.2005996
	speed: 0.0101s/iter; left time: 232.9255s
Epoch: 14 cost time: 3.2307889461517334
Epoch: 14, Steps: 268 | Train Loss: 0.2406034 Vali Loss: 0.1306634 Test Loss: 0.1850954
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2780460
	speed: 0.0752s/iter; left time: 1726.4445s
	iters: 200, epoch: 15 | loss: 0.1851117
	speed: 0.0148s/iter; left time: 337.1001s
Epoch: 15 cost time: 4.302833557128906
Epoch: 15, Steps: 268 | Train Loss: 0.2412455 Vali Loss: 0.1305459 Test Loss: 0.1849981
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2114123
	speed: 0.0633s/iter; left time: 1436.6882s
	iters: 200, epoch: 16 | loss: 0.2109337
	speed: 0.0105s/iter; left time: 236.4476s
Epoch: 16 cost time: 3.3406050205230713
Epoch: 16, Steps: 268 | Train Loss: 0.2410881 Vali Loss: 0.1304750 Test Loss: 0.1849086
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2010190
	speed: 0.0660s/iter; left time: 1479.6464s
	iters: 200, epoch: 17 | loss: 0.2680876
	speed: 0.0104s/iter; left time: 232.7351s
Epoch: 17 cost time: 3.9092626571655273
Epoch: 17, Steps: 268 | Train Loss: 0.2411665 Vali Loss: 0.1305190 Test Loss: 0.1849968
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1848291
	speed: 0.0621s/iter; left time: 1374.1444s
	iters: 200, epoch: 18 | loss: 0.3259787
	speed: 0.0129s/iter; left time: 285.0241s
Epoch: 18 cost time: 3.69022536277771
Epoch: 18, Steps: 268 | Train Loss: 0.2404310 Vali Loss: 0.1306960 Test Loss: 0.1850872
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3142026
	speed: 0.0640s/iter; left time: 1399.2707s
	iters: 200, epoch: 19 | loss: 0.2209851
	speed: 0.0150s/iter; left time: 326.6397s
Epoch: 19 cost time: 4.123673439025879
Epoch: 19, Steps: 268 | Train Loss: 0.2410185 Vali Loss: 0.1305807 Test Loss: 0.1850332
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2515048
	speed: 0.0626s/iter; left time: 1352.2050s
	iters: 200, epoch: 20 | loss: 0.2331453
	speed: 0.0100s/iter; left time: 215.8268s
Epoch: 20 cost time: 3.3622024059295654
Epoch: 20, Steps: 268 | Train Loss: 0.2409846 Vali Loss: 0.1304987 Test Loss: 0.1849494
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2032534
	speed: 0.0613s/iter; left time: 1308.3000s
	iters: 200, epoch: 21 | loss: 0.2018929
	speed: 0.0103s/iter; left time: 219.1872s
Epoch: 21 cost time: 3.3230221271514893
Epoch: 21, Steps: 268 | Train Loss: 0.2409726 Vali Loss: 0.1305850 Test Loss: 0.1849895
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3609453
	speed: 0.0609s/iter; left time: 1283.5164s
	iters: 200, epoch: 22 | loss: 0.2645680
	speed: 0.0106s/iter; left time: 221.7599s
Epoch: 22 cost time: 3.5183725357055664
Epoch: 22, Steps: 268 | Train Loss: 0.2409079 Vali Loss: 0.1306095 Test Loss: 0.1849983
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2357332
	speed: 0.0613s/iter; left time: 1274.6334s
	iters: 200, epoch: 23 | loss: 0.3660196
	speed: 0.0108s/iter; left time: 224.5989s
Epoch: 23 cost time: 3.5788919925689697
Epoch: 23, Steps: 268 | Train Loss: 0.2410910 Vali Loss: 0.1305466 Test Loss: 0.1849694
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1474274
	speed: 0.0617s/iter; left time: 1267.5289s
	iters: 200, epoch: 24 | loss: 0.1999254
	speed: 0.0104s/iter; left time: 212.9327s
Epoch: 24 cost time: 3.4225428104400635
Epoch: 24, Steps: 268 | Train Loss: 0.2405617 Vali Loss: 0.1307267 Test Loss: 0.1850146
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1798588
	speed: 0.0593s/iter; left time: 1201.1562s
	iters: 200, epoch: 25 | loss: 0.1826199
	speed: 0.0103s/iter; left time: 206.9429s
Epoch: 25 cost time: 3.3874690532684326
Epoch: 25, Steps: 268 | Train Loss: 0.2408762 Vali Loss: 0.1305708 Test Loss: 0.1849727
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2438369
	speed: 0.0597s/iter; left time: 1195.0318s
	iters: 200, epoch: 26 | loss: 0.1874333
	speed: 0.0107s/iter; left time: 212.1994s
Epoch: 26 cost time: 3.3706374168395996
Epoch: 26, Steps: 268 | Train Loss: 0.2410386 Vali Loss: 0.1305156 Test Loss: 0.1849695
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1726422
	speed: 0.0607s/iter; left time: 1196.9980s
	iters: 200, epoch: 27 | loss: 0.2463936
	speed: 0.0102s/iter; left time: 200.5990s
Epoch: 27 cost time: 3.320946455001831
Epoch: 27, Steps: 268 | Train Loss: 0.2409868 Vali Loss: 0.1306070 Test Loss: 0.1849987
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2523018
	speed: 0.0624s/iter; left time: 1214.2601s
	iters: 200, epoch: 28 | loss: 0.2531495
	speed: 0.0102s/iter; left time: 197.1411s
Epoch: 28 cost time: 3.5419747829437256
Epoch: 28, Steps: 268 | Train Loss: 0.2411241 Vali Loss: 0.1305737 Test Loss: 0.1850212
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18577364087104797, mae:0.26933780312538147, rse:0.34945255517959595, corr:[0.5732779  0.5728553  0.56849396 0.56482846 0.5636137  0.56346345
 0.56254876 0.5604832  0.5584684  0.55749726 0.55730593 0.55702275
 0.5561379  0.5549234  0.5540507  0.55360436 0.55307806 0.5519686
 0.5503798  0.5488901  0.54796934 0.5475373  0.5471134  0.5464352
 0.5456063  0.5448438  0.54436564 0.54395103 0.54325855 0.54238033
 0.5415353  0.5410172  0.54068106 0.54028624 0.539678   0.5389932
 0.53833157 0.5377518  0.537179   0.5365146  0.53579795 0.53525674
 0.53497803 0.53488463 0.53474504 0.5343077  0.5336512  0.5327661
 0.53182    0.5309595  0.5301743  0.5294588  0.5287499  0.5280091
 0.52739644 0.52690285 0.5263353  0.5256903  0.5250296  0.5246519
 0.5245258  0.5245215  0.5245176  0.5244776  0.5243979  0.52436244
 0.52439845 0.52438384 0.52436733 0.52434254 0.52439135 0.5245886
 0.52482074 0.52504987 0.5251     0.52502346 0.5249876  0.5249961
 0.5250301  0.5250451  0.5249952  0.5248756  0.52478474 0.52475137
 0.52472174 0.5246063  0.5243578  0.5241335  0.523992   0.52392316
 0.5239293  0.524003   0.52392304 0.523608   0.5228781  0.5213778 ]
