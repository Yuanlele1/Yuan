Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=106, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=106, out_features=155, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  14721280.0
params:  16585.0
Trainable parameters:  16585
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2997525
	speed: 0.0280s/iter; left time: 726.9877s
	iters: 200, epoch: 1 | loss: 0.3776894
	speed: 0.0211s/iter; left time: 547.5401s
Epoch: 1 cost time: 6.298210859298706
Epoch: 1, Steps: 261 | Train Loss: 0.4598301 Vali Loss: 0.2098738 Test Loss: 0.2874074
Validation loss decreased (inf --> 0.209874).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5286446
	speed: 0.0938s/iter; left time: 2414.5596s
	iters: 200, epoch: 2 | loss: 0.3915154
	speed: 0.0203s/iter; left time: 520.8757s
Epoch: 2 cost time: 6.115985631942749
Epoch: 2, Steps: 261 | Train Loss: 0.4023857 Vali Loss: 0.2015140 Test Loss: 0.2779348
Validation loss decreased (0.209874 --> 0.201514).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3973835
	speed: 0.0908s/iter; left time: 2312.9372s
	iters: 200, epoch: 3 | loss: 0.3414578
	speed: 0.0213s/iter; left time: 541.7047s
Epoch: 3 cost time: 6.260422706604004
Epoch: 3, Steps: 261 | Train Loss: 0.3918538 Vali Loss: 0.1982097 Test Loss: 0.2745185
Validation loss decreased (0.201514 --> 0.198210).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3540092
	speed: 0.0949s/iter; left time: 2393.9704s
	iters: 200, epoch: 4 | loss: 0.4335308
	speed: 0.0203s/iter; left time: 509.7184s
Epoch: 4 cost time: 6.086863279342651
Epoch: 4, Steps: 261 | Train Loss: 0.3864441 Vali Loss: 0.1966380 Test Loss: 0.2726371
Validation loss decreased (0.198210 --> 0.196638).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3006506
	speed: 0.0869s/iter; left time: 2168.8031s
	iters: 200, epoch: 5 | loss: 0.2407469
	speed: 0.0196s/iter; left time: 487.1853s
Epoch: 5 cost time: 5.759031295776367
Epoch: 5, Steps: 261 | Train Loss: 0.3832030 Vali Loss: 0.1954647 Test Loss: 0.2709461
Validation loss decreased (0.196638 --> 0.195465).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4359809
	speed: 0.0895s/iter; left time: 2210.5687s
	iters: 200, epoch: 6 | loss: 0.5309114
	speed: 0.0208s/iter; left time: 512.1443s
Epoch: 6 cost time: 5.980509042739868
Epoch: 6, Steps: 261 | Train Loss: 0.3807680 Vali Loss: 0.1950898 Test Loss: 0.2706531
Validation loss decreased (0.195465 --> 0.195090).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3707309
	speed: 0.0861s/iter; left time: 2104.6514s
	iters: 200, epoch: 7 | loss: 0.4369813
	speed: 0.0208s/iter; left time: 506.1569s
Epoch: 7 cost time: 5.880471229553223
Epoch: 7, Steps: 261 | Train Loss: 0.3802238 Vali Loss: 0.1945967 Test Loss: 0.2699264
Validation loss decreased (0.195090 --> 0.194597).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2497771
	speed: 0.0856s/iter; left time: 2070.1857s
	iters: 200, epoch: 8 | loss: 0.5417697
	speed: 0.0195s/iter; left time: 470.3784s
Epoch: 8 cost time: 5.839296340942383
Epoch: 8, Steps: 261 | Train Loss: 0.3793964 Vali Loss: 0.1942397 Test Loss: 0.2695757
Validation loss decreased (0.194597 --> 0.194240).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3446023
	speed: 0.0869s/iter; left time: 2076.9806s
	iters: 200, epoch: 9 | loss: 0.3448603
	speed: 0.0192s/iter; left time: 457.0600s
Epoch: 9 cost time: 5.874551057815552
Epoch: 9, Steps: 261 | Train Loss: 0.3787275 Vali Loss: 0.1940411 Test Loss: 0.2692975
Validation loss decreased (0.194240 --> 0.194041).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2789080
	speed: 0.0906s/iter; left time: 2142.3221s
	iters: 200, epoch: 10 | loss: 0.2807319
	speed: 0.0206s/iter; left time: 486.3374s
Epoch: 10 cost time: 5.904311180114746
Epoch: 10, Steps: 261 | Train Loss: 0.3778300 Vali Loss: 0.1935651 Test Loss: 0.2688675
Validation loss decreased (0.194041 --> 0.193565).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3379339
	speed: 0.0888s/iter; left time: 2076.3146s
	iters: 200, epoch: 11 | loss: 0.3657013
	speed: 0.0195s/iter; left time: 455.3163s
Epoch: 11 cost time: 5.770840644836426
Epoch: 11, Steps: 261 | Train Loss: 0.3777878 Vali Loss: 0.1931700 Test Loss: 0.2684989
Validation loss decreased (0.193565 --> 0.193170).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.4366030
	speed: 0.0894s/iter; left time: 2067.2827s
	iters: 200, epoch: 12 | loss: 0.3759527
	speed: 0.0196s/iter; left time: 451.4574s
Epoch: 12 cost time: 5.882826805114746
Epoch: 12, Steps: 261 | Train Loss: 0.3770497 Vali Loss: 0.1933035 Test Loss: 0.2683585
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4155694
	speed: 0.0997s/iter; left time: 2279.9946s
	iters: 200, epoch: 13 | loss: 0.3345450
	speed: 0.0205s/iter; left time: 466.4291s
Epoch: 13 cost time: 5.959378004074097
Epoch: 13, Steps: 261 | Train Loss: 0.3768226 Vali Loss: 0.1933351 Test Loss: 0.2685639
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.4054599
	speed: 0.0927s/iter; left time: 2095.4134s
	iters: 200, epoch: 14 | loss: 0.4221635
	speed: 0.0199s/iter; left time: 448.6582s
Epoch: 14 cost time: 5.948766231536865
Epoch: 14, Steps: 261 | Train Loss: 0.3762542 Vali Loss: 0.1930629 Test Loss: 0.2681560
Validation loss decreased (0.193170 --> 0.193063).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.5207099
	speed: 0.1088s/iter; left time: 2432.1226s
	iters: 200, epoch: 15 | loss: 0.5227470
	speed: 0.0209s/iter; left time: 465.5906s
Epoch: 15 cost time: 9.498494386672974
Epoch: 15, Steps: 261 | Train Loss: 0.3761047 Vali Loss: 0.1931501 Test Loss: 0.2683451
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3296206
	speed: 0.1105s/iter; left time: 2440.9430s
	iters: 200, epoch: 16 | loss: 0.3459427
	speed: 0.0212s/iter; left time: 465.0304s
Epoch: 16 cost time: 6.144315004348755
Epoch: 16, Steps: 261 | Train Loss: 0.3761095 Vali Loss: 0.1930566 Test Loss: 0.2682175
Validation loss decreased (0.193063 --> 0.193057).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4434845
	speed: 0.0912s/iter; left time: 1990.4088s
	iters: 200, epoch: 17 | loss: 0.4200729
	speed: 0.0227s/iter; left time: 492.5549s
Epoch: 17 cost time: 6.343880891799927
Epoch: 17, Steps: 261 | Train Loss: 0.3758356 Vali Loss: 0.1930773 Test Loss: 0.2680916
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.5235785
	speed: 0.0930s/iter; left time: 2005.0744s
	iters: 200, epoch: 18 | loss: 0.4413510
	speed: 0.0202s/iter; left time: 434.5083s
Epoch: 18 cost time: 6.003671407699585
Epoch: 18, Steps: 261 | Train Loss: 0.3757875 Vali Loss: 0.1928189 Test Loss: 0.2678690
Validation loss decreased (0.193057 --> 0.192819).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3643593
	speed: 0.0894s/iter; left time: 1904.7754s
	iters: 200, epoch: 19 | loss: 0.5271571
	speed: 0.0193s/iter; left time: 408.5420s
Epoch: 19 cost time: 5.634419202804565
Epoch: 19, Steps: 261 | Train Loss: 0.3752895 Vali Loss: 0.1928621 Test Loss: 0.2678963
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.4236130
	speed: 0.0886s/iter; left time: 1864.7995s
	iters: 200, epoch: 20 | loss: 0.4165608
	speed: 0.0191s/iter; left time: 399.8554s
Epoch: 20 cost time: 5.857860326766968
Epoch: 20, Steps: 261 | Train Loss: 0.3752948 Vali Loss: 0.1928556 Test Loss: 0.2679601
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4308962
	speed: 0.0885s/iter; left time: 1838.5865s
	iters: 200, epoch: 21 | loss: 0.3659229
	speed: 0.0199s/iter; left time: 412.5429s
Epoch: 21 cost time: 5.691506624221802
Epoch: 21, Steps: 261 | Train Loss: 0.3750820 Vali Loss: 0.1928385 Test Loss: 0.2680522
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.4909626
	speed: 0.0879s/iter; left time: 1803.4716s
	iters: 200, epoch: 22 | loss: 0.4797334
	speed: 0.0196s/iter; left time: 399.2895s
Epoch: 22 cost time: 5.874860048294067
Epoch: 22, Steps: 261 | Train Loss: 0.3751632 Vali Loss: 0.1927336 Test Loss: 0.2677805
Validation loss decreased (0.192819 --> 0.192734).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.5197875
	speed: 0.0893s/iter; left time: 1808.4083s
	iters: 200, epoch: 23 | loss: 0.3828467
	speed: 0.0197s/iter; left time: 397.6209s
Epoch: 23 cost time: 5.912866830825806
Epoch: 23, Steps: 261 | Train Loss: 0.3748824 Vali Loss: 0.1926791 Test Loss: 0.2678168
Validation loss decreased (0.192734 --> 0.192679).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.4247658
	speed: 0.0844s/iter; left time: 1688.8079s
	iters: 200, epoch: 24 | loss: 0.3554430
	speed: 0.0196s/iter; left time: 389.9795s
Epoch: 24 cost time: 5.640415906906128
Epoch: 24, Steps: 261 | Train Loss: 0.3746589 Vali Loss: 0.1925899 Test Loss: 0.2678168
Validation loss decreased (0.192679 --> 0.192590).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4137309
	speed: 0.0861s/iter; left time: 1698.6030s
	iters: 200, epoch: 25 | loss: 0.2661669
	speed: 0.0202s/iter; left time: 396.5751s
Epoch: 25 cost time: 5.980986833572388
Epoch: 25, Steps: 261 | Train Loss: 0.3748989 Vali Loss: 0.1925787 Test Loss: 0.2677883
Validation loss decreased (0.192590 --> 0.192579).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3534532
	speed: 0.0852s/iter; left time: 1660.2719s
	iters: 200, epoch: 26 | loss: 0.3716926
	speed: 0.0193s/iter; left time: 373.7505s
Epoch: 26 cost time: 5.684259414672852
Epoch: 26, Steps: 261 | Train Loss: 0.3749099 Vali Loss: 0.1925997 Test Loss: 0.2678080
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.5614681
	speed: 0.0875s/iter; left time: 1680.7801s
	iters: 200, epoch: 27 | loss: 0.3462310
	speed: 0.0200s/iter; left time: 382.1355s
Epoch: 27 cost time: 5.874457359313965
Epoch: 27, Steps: 261 | Train Loss: 0.3747842 Vali Loss: 0.1927410 Test Loss: 0.2676908
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3712777
	speed: 0.0860s/iter; left time: 1630.4890s
	iters: 200, epoch: 28 | loss: 0.3152930
	speed: 0.0201s/iter; left time: 379.2943s
Epoch: 28 cost time: 5.8014748096466064
Epoch: 28, Steps: 261 | Train Loss: 0.3742883 Vali Loss: 0.1925999 Test Loss: 0.2676923
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3016901
	speed: 0.0853s/iter; left time: 1593.9377s
	iters: 200, epoch: 29 | loss: 0.4320233
	speed: 0.0186s/iter; left time: 345.4197s
Epoch: 29 cost time: 5.5023674964904785
Epoch: 29, Steps: 261 | Train Loss: 0.3749543 Vali Loss: 0.1925497 Test Loss: 0.2676437
Validation loss decreased (0.192579 --> 0.192550).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4700863
	speed: 0.0887s/iter; left time: 1635.6111s
	iters: 200, epoch: 30 | loss: 0.4100161
	speed: 0.0206s/iter; left time: 377.7611s
Epoch: 30 cost time: 6.0340046882629395
Epoch: 30, Steps: 261 | Train Loss: 0.3740941 Vali Loss: 0.1926734 Test Loss: 0.2676099
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.4476317
	speed: 0.0906s/iter; left time: 1646.4382s
	iters: 200, epoch: 31 | loss: 0.3326336
	speed: 0.0197s/iter; left time: 356.1145s
Epoch: 31 cost time: 5.730305910110474
Epoch: 31, Steps: 261 | Train Loss: 0.3747502 Vali Loss: 0.1926804 Test Loss: 0.2676115
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.4220472
	speed: 0.0902s/iter; left time: 1616.0346s
	iters: 200, epoch: 32 | loss: 0.4140457
	speed: 0.0195s/iter; left time: 347.7287s
Epoch: 32 cost time: 6.051191806793213
Epoch: 32, Steps: 261 | Train Loss: 0.3745227 Vali Loss: 0.1925178 Test Loss: 0.2676394
Validation loss decreased (0.192550 --> 0.192518).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3737251
	speed: 0.0842s/iter; left time: 1486.3478s
	iters: 200, epoch: 33 | loss: 0.3863615
	speed: 0.0293s/iter; left time: 513.8549s
Epoch: 33 cost time: 8.630239486694336
Epoch: 33, Steps: 261 | Train Loss: 0.3740641 Vali Loss: 0.1923687 Test Loss: 0.2676119
Validation loss decreased (0.192518 --> 0.192369).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3882124
	speed: 0.1080s/iter; left time: 1877.1804s
	iters: 200, epoch: 34 | loss: 0.3886488
	speed: 0.0192s/iter; left time: 332.1282s
Epoch: 34 cost time: 5.686162233352661
Epoch: 34, Steps: 261 | Train Loss: 0.3744153 Vali Loss: 0.1925440 Test Loss: 0.2675469
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.4061866
	speed: 0.0875s/iter; left time: 1498.5817s
	iters: 200, epoch: 35 | loss: 0.3987787
	speed: 0.0189s/iter; left time: 322.4348s
Epoch: 35 cost time: 5.677166700363159
Epoch: 35, Steps: 261 | Train Loss: 0.3742411 Vali Loss: 0.1926054 Test Loss: 0.2675819
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3701925
	speed: 0.0925s/iter; left time: 1560.0157s
	iters: 200, epoch: 36 | loss: 0.3033559
	speed: 0.0208s/iter; left time: 348.1044s
Epoch: 36 cost time: 5.94573187828064
Epoch: 36, Steps: 261 | Train Loss: 0.3742233 Vali Loss: 0.1925105 Test Loss: 0.2675486
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.4399831
	speed: 0.0874s/iter; left time: 1450.4570s
	iters: 200, epoch: 37 | loss: 0.3129096
	speed: 0.0198s/iter; left time: 326.4728s
Epoch: 37 cost time: 5.759284973144531
Epoch: 37, Steps: 261 | Train Loss: 0.3740955 Vali Loss: 0.1924523 Test Loss: 0.2675284
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.4780238
	speed: 0.0866s/iter; left time: 1415.9461s
	iters: 200, epoch: 38 | loss: 0.3722979
	speed: 0.0199s/iter; left time: 323.4242s
Epoch: 38 cost time: 5.676550626754761
Epoch: 38, Steps: 261 | Train Loss: 0.3739418 Vali Loss: 0.1925468 Test Loss: 0.2675729
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.4312602
	speed: 0.0894s/iter; left time: 1438.1917s
	iters: 200, epoch: 39 | loss: 0.3908791
	speed: 0.0198s/iter; left time: 317.0277s
Epoch: 39 cost time: 6.189318895339966
Epoch: 39, Steps: 261 | Train Loss: 0.3734578 Vali Loss: 0.1924750 Test Loss: 0.2675584
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.5205497
	speed: 0.0885s/iter; left time: 1401.0038s
	iters: 200, epoch: 40 | loss: 0.2700489
	speed: 0.0279s/iter; left time: 438.5297s
Epoch: 40 cost time: 6.6715898513793945
Epoch: 40, Steps: 261 | Train Loss: 0.3744288 Vali Loss: 0.1923583 Test Loss: 0.2675200
Validation loss decreased (0.192369 --> 0.192358).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3754658
	speed: 0.0912s/iter; left time: 1418.7099s
	iters: 200, epoch: 41 | loss: 0.4163904
	speed: 0.0212s/iter; left time: 327.1229s
Epoch: 41 cost time: 6.0149524211883545
Epoch: 41, Steps: 261 | Train Loss: 0.3740156 Vali Loss: 0.1924739 Test Loss: 0.2674768
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2657258
	speed: 0.0898s/iter; left time: 1374.4817s
	iters: 200, epoch: 42 | loss: 0.3335900
	speed: 0.0196s/iter; left time: 298.3916s
Epoch: 42 cost time: 5.733672618865967
Epoch: 42, Steps: 261 | Train Loss: 0.3736080 Vali Loss: 0.1926217 Test Loss: 0.2675058
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3149978
	speed: 0.0854s/iter; left time: 1283.8188s
	iters: 200, epoch: 43 | loss: 0.2699867
	speed: 0.0196s/iter; left time: 292.8747s
Epoch: 43 cost time: 5.707525730133057
Epoch: 43, Steps: 261 | Train Loss: 0.3738409 Vali Loss: 0.1924415 Test Loss: 0.2675001
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.5090504
	speed: 0.0856s/iter; left time: 1264.8997s
	iters: 200, epoch: 44 | loss: 0.4090733
	speed: 0.0206s/iter; left time: 302.6879s
Epoch: 44 cost time: 6.914364814758301
Epoch: 44, Steps: 261 | Train Loss: 0.3735442 Vali Loss: 0.1924864 Test Loss: 0.2674493
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2722783
	speed: 0.0990s/iter; left time: 1437.6562s
	iters: 200, epoch: 45 | loss: 0.4090387
	speed: 0.0232s/iter; left time: 333.7970s
Epoch: 45 cost time: 6.2214765548706055
Epoch: 45, Steps: 261 | Train Loss: 0.3740301 Vali Loss: 0.1925423 Test Loss: 0.2674549
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.5713726
	speed: 0.0908s/iter; left time: 1295.0983s
	iters: 200, epoch: 46 | loss: 0.3646343
	speed: 0.0202s/iter; left time: 286.0166s
Epoch: 46 cost time: 5.94774603843689
Epoch: 46, Steps: 261 | Train Loss: 0.3736280 Vali Loss: 0.1924457 Test Loss: 0.2674539
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3322421
	speed: 0.0892s/iter; left time: 1248.9440s
	iters: 200, epoch: 47 | loss: 0.3098138
	speed: 0.0191s/iter; left time: 265.2633s
Epoch: 47 cost time: 5.726258277893066
Epoch: 47, Steps: 261 | Train Loss: 0.3742244 Vali Loss: 0.1924847 Test Loss: 0.2674761
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3439282
	speed: 0.0854s/iter; left time: 1172.6825s
	iters: 200, epoch: 48 | loss: 0.2395544
	speed: 0.0206s/iter; left time: 280.3915s
Epoch: 48 cost time: 5.906070232391357
Epoch: 48, Steps: 261 | Train Loss: 0.3743246 Vali Loss: 0.1925367 Test Loss: 0.2674429
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.4057435
	speed: 0.0942s/iter; left time: 1269.4202s
	iters: 200, epoch: 49 | loss: 0.4538161
	speed: 0.0194s/iter; left time: 259.6340s
Epoch: 49 cost time: 5.90588116645813
Epoch: 49, Steps: 261 | Train Loss: 0.3740789 Vali Loss: 0.1922890 Test Loss: 0.2674496
Validation loss decreased (0.192358 --> 0.192289).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.3483332
	speed: 0.0860s/iter; left time: 1135.8566s
	iters: 200, epoch: 50 | loss: 0.4747837
	speed: 0.0200s/iter; left time: 262.6639s
Epoch: 50 cost time: 5.790829181671143
Epoch: 50, Steps: 261 | Train Loss: 0.3739049 Vali Loss: 0.1925023 Test Loss: 0.2674555
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.4370402
	speed: 0.0939s/iter; left time: 1216.2353s
	iters: 200, epoch: 51 | loss: 0.4590526
	speed: 0.0227s/iter; left time: 291.1862s
Epoch: 51 cost time: 6.567152500152588
Epoch: 51, Steps: 261 | Train Loss: 0.3740180 Vali Loss: 0.1923187 Test Loss: 0.2674629
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2782232
	speed: 0.0845s/iter; left time: 1071.7889s
	iters: 200, epoch: 52 | loss: 0.5059763
	speed: 0.0190s/iter; left time: 239.3362s
Epoch: 52 cost time: 5.539020538330078
Epoch: 52, Steps: 261 | Train Loss: 0.3736719 Vali Loss: 0.1924392 Test Loss: 0.2674376
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.4082887
	speed: 0.0870s/iter; left time: 1081.4687s
	iters: 200, epoch: 53 | loss: 0.2949024
	speed: 0.0199s/iter; left time: 245.7450s
Epoch: 53 cost time: 5.899995803833008
Epoch: 53, Steps: 261 | Train Loss: 0.3739026 Vali Loss: 0.1925846 Test Loss: 0.2674518
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.3552451
	speed: 0.0871s/iter; left time: 1059.2435s
	iters: 200, epoch: 54 | loss: 0.2640760
	speed: 0.0191s/iter; left time: 230.4763s
Epoch: 54 cost time: 5.634361743927002
Epoch: 54, Steps: 261 | Train Loss: 0.3738110 Vali Loss: 0.1925259 Test Loss: 0.2674465
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.4533529
	speed: 0.0856s/iter; left time: 1019.1686s
	iters: 200, epoch: 55 | loss: 0.3384541
	speed: 0.0185s/iter; left time: 218.1188s
Epoch: 55 cost time: 5.549215078353882
Epoch: 55, Steps: 261 | Train Loss: 0.3736418 Vali Loss: 0.1924393 Test Loss: 0.2674459
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.5956956
	speed: 0.0825s/iter; left time: 960.4212s
	iters: 200, epoch: 56 | loss: 0.5689528
	speed: 0.0219s/iter; left time: 253.3692s
Epoch: 56 cost time: 5.776437759399414
Epoch: 56, Steps: 261 | Train Loss: 0.3737065 Vali Loss: 0.1924154 Test Loss: 0.2674375
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3623978
	speed: 0.0809s/iter; left time: 920.9059s
	iters: 200, epoch: 57 | loss: 0.3114843
	speed: 0.0229s/iter; left time: 257.9178s
Epoch: 57 cost time: 6.01945686340332
Epoch: 57, Steps: 261 | Train Loss: 0.3739787 Vali Loss: 0.1923937 Test Loss: 0.2674402
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3222803
	speed: 0.0850s/iter; left time: 945.7876s
	iters: 200, epoch: 58 | loss: 0.3620065
	speed: 0.0198s/iter; left time: 218.6081s
Epoch: 58 cost time: 5.7209649085998535
Epoch: 58, Steps: 261 | Train Loss: 0.3739131 Vali Loss: 0.1923596 Test Loss: 0.2674537
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.4716370
	speed: 0.0846s/iter; left time: 919.1678s
	iters: 200, epoch: 59 | loss: 0.4104956
	speed: 0.0195s/iter; left time: 209.7129s
Epoch: 59 cost time: 5.7262372970581055
Epoch: 59, Steps: 261 | Train Loss: 0.3741156 Vali Loss: 0.1924481 Test Loss: 0.2674477
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.4211662
	speed: 0.0863s/iter; left time: 914.8010s
	iters: 200, epoch: 60 | loss: 0.4873327
	speed: 0.0204s/iter; left time: 213.9937s
Epoch: 60 cost time: 5.788738012313843
Epoch: 60, Steps: 261 | Train Loss: 0.3737720 Vali Loss: 0.1923780 Test Loss: 0.2674393
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.3668119
	speed: 0.0871s/iter; left time: 900.7028s
	iters: 200, epoch: 61 | loss: 0.3124182
	speed: 0.0216s/iter; left time: 221.6401s
Epoch: 61 cost time: 6.014974594116211
Epoch: 61, Steps: 261 | Train Loss: 0.3734801 Vali Loss: 0.1924571 Test Loss: 0.2674301
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.4289529
	speed: 0.0835s/iter; left time: 841.7114s
	iters: 200, epoch: 62 | loss: 0.3724512
	speed: 0.0208s/iter; left time: 207.1362s
Epoch: 62 cost time: 5.726575613021851
Epoch: 62, Steps: 261 | Train Loss: 0.3739021 Vali Loss: 0.1923881 Test Loss: 0.2674252
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.4183295
	speed: 0.0927s/iter; left time: 910.3762s
	iters: 200, epoch: 63 | loss: 0.2799840
	speed: 0.0202s/iter; left time: 196.6604s
Epoch: 63 cost time: 5.770703554153442
Epoch: 63, Steps: 261 | Train Loss: 0.3734837 Vali Loss: 0.1925158 Test Loss: 0.2674278
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2506075
	speed: 0.0852s/iter; left time: 814.1136s
	iters: 200, epoch: 64 | loss: 0.3705074
	speed: 0.0190s/iter; left time: 180.1271s
Epoch: 64 cost time: 5.66058874130249
Epoch: 64, Steps: 261 | Train Loss: 0.3738901 Vali Loss: 0.1925193 Test Loss: 0.2674208
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.3348048
	speed: 0.0857s/iter; left time: 797.1486s
	iters: 200, epoch: 65 | loss: 0.3971759
	speed: 0.0203s/iter; left time: 186.4267s
Epoch: 65 cost time: 6.0581889152526855
Epoch: 65, Steps: 261 | Train Loss: 0.3739299 Vali Loss: 0.1924523 Test Loss: 0.2674311
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.3808923
	speed: 0.0899s/iter; left time: 812.4818s
	iters: 200, epoch: 66 | loss: 0.4228858
	speed: 0.0187s/iter; left time: 167.1905s
Epoch: 66 cost time: 5.645611763000488
Epoch: 66, Steps: 261 | Train Loss: 0.3734282 Vali Loss: 0.1925236 Test Loss: 0.2674153
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.3004904
	speed: 0.0874s/iter; left time: 766.9118s
	iters: 200, epoch: 67 | loss: 0.3322961
	speed: 0.0192s/iter; left time: 166.4034s
Epoch: 67 cost time: 5.781699895858765
Epoch: 67, Steps: 261 | Train Loss: 0.3733163 Vali Loss: 0.1924192 Test Loss: 0.2674268
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.5494526
	speed: 0.0894s/iter; left time: 761.1731s
	iters: 200, epoch: 68 | loss: 0.4882167
	speed: 0.0194s/iter; left time: 162.9337s
Epoch: 68 cost time: 5.722626209259033
Epoch: 68, Steps: 261 | Train Loss: 0.3736459 Vali Loss: 0.1923683 Test Loss: 0.2674186
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.6409572
	speed: 0.0850s/iter; left time: 701.8076s
	iters: 200, epoch: 69 | loss: 0.3283225
	speed: 0.0191s/iter; left time: 155.8518s
Epoch: 69 cost time: 5.689135551452637
Epoch: 69, Steps: 261 | Train Loss: 0.3739766 Vali Loss: 0.1924520 Test Loss: 0.2674210
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.2684682607650757, mae:0.3260784149169922, rse:0.4185112416744232, corr:[0.556758   0.5584559  0.5537545  0.5512997  0.55196655 0.553664
 0.5540146  0.5528596  0.5515915  0.5512336  0.5518243  0.55258197
 0.552684   0.55201536 0.5512164  0.55075353 0.550743   0.55084896
 0.550556   0.5497246  0.54871094 0.54791147 0.54755116 0.5475275
 0.5474272  0.54696226 0.546207   0.5454372  0.5448773  0.544588
 0.5443926  0.5441172  0.5436072  0.54288423 0.5421495  0.5416054
 0.54122853 0.54086936 0.54032487 0.53958315 0.5388014  0.5381363
 0.53769976 0.53742814 0.53712606 0.53659075 0.53581196 0.53493047
 0.5340555  0.53331125 0.5327332  0.5322532  0.53168297 0.53094614
 0.53012633 0.52942926 0.52895653 0.52868116 0.5284834  0.52823085
 0.52788156 0.52755785 0.52736413 0.52730507 0.5272921  0.5272085
 0.5269249  0.5265034  0.52608556 0.52579874 0.52565247 0.525545
 0.5253223  0.5249279  0.52437174 0.52380496 0.52332956 0.52294594
 0.5225342  0.5220246  0.5213229  0.5205564  0.5198709  0.5193659
 0.5190169  0.51867956 0.51819026 0.5175586  0.51689535 0.5163471
 0.51598865 0.51569885 0.5152175  0.5144111  0.5132828  0.51193684
 0.5105844  0.5094069  0.50829583 0.5071137  0.5058161  0.5044769
 0.5032712  0.5022771  0.5014516  0.5006011  0.4996265  0.49855712
 0.49748525 0.49656573 0.49588522 0.4953213  0.4947039  0.4938321
 0.49267566 0.49148947 0.4905689  0.4899588  0.48952246 0.488926
 0.4880678  0.48695278 0.48586634 0.48503825 0.48449653 0.4840472
 0.4834629  0.48259    0.48146552 0.48031208 0.47936603 0.47867265
 0.4781157  0.47750723 0.47674933 0.4759195  0.4751953  0.4747501
 0.47449827 0.474221   0.47366178 0.4727886  0.47178692 0.4708626
 0.4701846  0.4696226  0.46906912 0.46831793 0.4673874  0.466442
 0.46577623 0.4654917  0.4652988  0.46485895 0.4640558  0.46307617
 0.46219766 0.46166453 0.4614554  0.46139008 0.461119   0.46052223
 0.45970666 0.45902798 0.4587482  0.45883623 0.45893595 0.4587461
 0.45821777 0.45757937 0.45704433 0.45679584 0.45674998 0.4566171
 0.4561621  0.45537394 0.45447832 0.45379084 0.45341623 0.45330706
 0.45308277 0.4524759  0.45159885 0.45072725 0.4501369  0.4499086
 0.4498746  0.4497287  0.44918245 0.44815856 0.44683105 0.44546017
 0.44423774 0.4432138  0.44208437 0.44067347 0.4391526  0.43773723
 0.43662298 0.43573967 0.4348953  0.43387815 0.43268496 0.43148154
 0.43045413 0.42958465 0.42863646 0.42742625 0.42607978 0.4249302
 0.42412463 0.4237169  0.42351022 0.42312723 0.42230853 0.42096335
 0.41938013 0.4179719  0.4171018  0.41662005 0.41605353 0.4151014
 0.41376743 0.4123981  0.41143528 0.41084346 0.41036078 0.4096548
 0.40843776 0.40694892 0.40558338 0.4047733  0.40452883 0.4045228
 0.40427515 0.4036352  0.40273508 0.40198565 0.40171206 0.40179506
 0.40183958 0.401356   0.4003311  0.39926657 0.39853922 0.39844203
 0.39880377 0.39917487 0.39910486 0.39852062 0.39792338 0.39772388
 0.3979943  0.39850405 0.3986758  0.39830652 0.39751673 0.3968146
 0.39655238 0.39665738 0.3967122  0.3963364  0.39545244 0.3944919
 0.39399004 0.3941414  0.3947561  0.3952576  0.39515135 0.39439887
 0.39346957 0.39300168 0.3931     0.3934683  0.3935253  0.39299247
 0.39220297 0.39154136 0.3913459  0.3916121  0.39181823 0.3915515
 0.39073008 0.38980037 0.38936132 0.38958544 0.3899948  0.38965476
 0.38813406 0.38590106 0.38375372 0.38254616 0.38254508 0.38309717
 0.38341892 0.38293096 0.38172907 0.38054797 0.38022646 0.38061336
 0.38116735 0.38106743 0.38014716 0.37872303 0.3777583  0.37784788
 0.3787173  0.37929842 0.37895697 0.37776244 0.37649304 0.3762799
 0.37707287 0.3781435  0.3784373  0.3775112  0.37600043 0.37519825
 0.37575966 0.37722287 0.37836048 0.37819734 0.37669697 0.37516093
 0.37498787 0.37627926 0.37778813 0.37799427 0.3766214  0.37480524
 0.3747132  0.3763119  0.37749392 0.37576115 0.3695725  0.36369804]
