Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=66, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=66, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4908288.0
params:  5561.0
Trainable parameters:  5561
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2782208
	speed: 0.0159s/iter; left time: 421.4912s
	iters: 200, epoch: 1 | loss: 0.2571673
	speed: 0.0105s/iter; left time: 277.5285s
Epoch: 1 cost time: 4.039917707443237
Epoch: 1, Steps: 266 | Train Loss: 0.2273173 Vali Loss: 0.1731656 Test Loss: 0.2338264
Validation loss decreased (inf --> 0.173166).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0897553
	speed: 0.0560s/iter; left time: 1469.5203s
	iters: 200, epoch: 2 | loss: 0.1154800
	speed: 0.0095s/iter; left time: 247.7266s
Epoch: 2 cost time: 3.824272632598877
Epoch: 2, Steps: 266 | Train Loss: 0.1373640 Vali Loss: 0.1530826 Test Loss: 0.2086084
Validation loss decreased (0.173166 --> 0.153083).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1143349
	speed: 0.0561s/iter; left time: 1455.8152s
	iters: 200, epoch: 3 | loss: 0.0961659
	speed: 0.0124s/iter; left time: 321.2709s
Epoch: 3 cost time: 3.390462875366211
Epoch: 3, Steps: 266 | Train Loss: 0.1048353 Vali Loss: 0.1430695 Test Loss: 0.1959829
Validation loss decreased (0.153083 --> 0.143069).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0791665
	speed: 0.0847s/iter; left time: 2177.9374s
	iters: 200, epoch: 4 | loss: 0.0670012
	speed: 0.0164s/iter; left time: 419.7413s
Epoch: 4 cost time: 4.42883038520813
Epoch: 4, Steps: 266 | Train Loss: 0.0874400 Vali Loss: 0.1365457 Test Loss: 0.1876517
Validation loss decreased (0.143069 --> 0.136546).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0883271
	speed: 0.0500s/iter; left time: 1272.4190s
	iters: 200, epoch: 5 | loss: 0.0731449
	speed: 0.0096s/iter; left time: 243.2032s
Epoch: 5 cost time: 3.08747935295105
Epoch: 5, Steps: 266 | Train Loss: 0.0766327 Vali Loss: 0.1319582 Test Loss: 0.1819290
Validation loss decreased (0.136546 --> 0.131958).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0668643
	speed: 0.0468s/iter; left time: 1177.5126s
	iters: 200, epoch: 6 | loss: 0.0613588
	speed: 0.0097s/iter; left time: 244.2607s
Epoch: 6 cost time: 3.119028329849243
Epoch: 6, Steps: 266 | Train Loss: 0.0697715 Vali Loss: 0.1287421 Test Loss: 0.1779661
Validation loss decreased (0.131958 --> 0.128742).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0585487
	speed: 0.0460s/iter; left time: 1144.5848s
	iters: 200, epoch: 7 | loss: 0.0548707
	speed: 0.0096s/iter; left time: 239.2318s
Epoch: 7 cost time: 3.0850698947906494
Epoch: 7, Steps: 266 | Train Loss: 0.0650105 Vali Loss: 0.1261147 Test Loss: 0.1748412
Validation loss decreased (0.128742 --> 0.126115).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0722721
	speed: 0.0473s/iter; left time: 1164.8291s
	iters: 200, epoch: 8 | loss: 0.0492900
	speed: 0.0096s/iter; left time: 234.9735s
Epoch: 8 cost time: 3.0571186542510986
Epoch: 8, Steps: 266 | Train Loss: 0.0616499 Vali Loss: 0.1245588 Test Loss: 0.1728355
Validation loss decreased (0.126115 --> 0.124559).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0581461
	speed: 0.0472s/iter; left time: 1150.5894s
	iters: 200, epoch: 9 | loss: 0.0687113
	speed: 0.0098s/iter; left time: 237.3117s
Epoch: 9 cost time: 3.0392348766326904
Epoch: 9, Steps: 266 | Train Loss: 0.0594608 Vali Loss: 0.1233422 Test Loss: 0.1715746
Validation loss decreased (0.124559 --> 0.123342).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0611453
	speed: 0.0474s/iter; left time: 1143.6979s
	iters: 200, epoch: 10 | loss: 0.0577453
	speed: 0.0098s/iter; left time: 235.4673s
Epoch: 10 cost time: 3.214531183242798
Epoch: 10, Steps: 266 | Train Loss: 0.0578884 Vali Loss: 0.1224333 Test Loss: 0.1705635
Validation loss decreased (0.123342 --> 0.122433).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0652442
	speed: 0.0490s/iter; left time: 1168.0741s
	iters: 200, epoch: 11 | loss: 0.0659191
	speed: 0.0100s/iter; left time: 238.1857s
Epoch: 11 cost time: 3.2041962146759033
Epoch: 11, Steps: 266 | Train Loss: 0.0568016 Vali Loss: 0.1217494 Test Loss: 0.1698882
Validation loss decreased (0.122433 --> 0.121749).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0510760
	speed: 0.0492s/iter; left time: 1158.9104s
	iters: 200, epoch: 12 | loss: 0.0517271
	speed: 0.0083s/iter; left time: 194.8779s
Epoch: 12 cost time: 3.0291740894317627
Epoch: 12, Steps: 266 | Train Loss: 0.0560328 Vali Loss: 0.1212798 Test Loss: 0.1695163
Validation loss decreased (0.121749 --> 0.121280).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0748720
	speed: 0.0508s/iter; left time: 1183.6732s
	iters: 200, epoch: 13 | loss: 0.0573460
	speed: 0.0097s/iter; left time: 225.5861s
Epoch: 13 cost time: 3.075543165206909
Epoch: 13, Steps: 266 | Train Loss: 0.0555994 Vali Loss: 0.1207839 Test Loss: 0.1691104
Validation loss decreased (0.121280 --> 0.120784).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0453049
	speed: 0.0460s/iter; left time: 1060.8861s
	iters: 200, epoch: 14 | loss: 0.0542118
	speed: 0.0093s/iter; left time: 213.8048s
Epoch: 14 cost time: 3.051396608352661
Epoch: 14, Steps: 266 | Train Loss: 0.0552531 Vali Loss: 0.1207548 Test Loss: 0.1691305
Validation loss decreased (0.120784 --> 0.120755).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0398735
	speed: 0.0470s/iter; left time: 1071.4233s
	iters: 200, epoch: 15 | loss: 0.0601678
	speed: 0.0088s/iter; left time: 200.3622s
Epoch: 15 cost time: 2.9934959411621094
Epoch: 15, Steps: 266 | Train Loss: 0.0550294 Vali Loss: 0.1203188 Test Loss: 0.1689302
Validation loss decreased (0.120755 --> 0.120319).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0482362
	speed: 0.0459s/iter; left time: 1033.0615s
	iters: 200, epoch: 16 | loss: 0.0600950
	speed: 0.0100s/iter; left time: 224.9810s
Epoch: 16 cost time: 3.121727705001831
Epoch: 16, Steps: 266 | Train Loss: 0.0549269 Vali Loss: 0.1202132 Test Loss: 0.1689447
Validation loss decreased (0.120319 --> 0.120213).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0454974
	speed: 0.0463s/iter; left time: 1030.2180s
	iters: 200, epoch: 17 | loss: 0.0525939
	speed: 0.0096s/iter; left time: 212.9695s
Epoch: 17 cost time: 3.0639212131500244
Epoch: 17, Steps: 266 | Train Loss: 0.0548608 Vali Loss: 0.1200576 Test Loss: 0.1687908
Validation loss decreased (0.120213 --> 0.120058).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0435022
	speed: 0.0461s/iter; left time: 1012.4030s
	iters: 200, epoch: 18 | loss: 0.0557186
	speed: 0.0103s/iter; left time: 224.9615s
Epoch: 18 cost time: 3.245579957962036
Epoch: 18, Steps: 266 | Train Loss: 0.0548368 Vali Loss: 0.1201584 Test Loss: 0.1687884
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0675006
	speed: 0.0581s/iter; left time: 1262.4015s
	iters: 200, epoch: 19 | loss: 0.0536516
	speed: 0.0102s/iter; left time: 219.6462s
Epoch: 19 cost time: 4.014774560928345
Epoch: 19, Steps: 266 | Train Loss: 0.0547786 Vali Loss: 0.1200687 Test Loss: 0.1687426
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0548486
	speed: 0.0499s/iter; left time: 1069.3867s
	iters: 200, epoch: 20 | loss: 0.0419568
	speed: 0.0101s/iter; left time: 215.0350s
Epoch: 20 cost time: 3.182016372680664
Epoch: 20, Steps: 266 | Train Loss: 0.0547846 Vali Loss: 0.1198107 Test Loss: 0.1690330
Validation loss decreased (0.120058 --> 0.119811).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0880148
	speed: 0.0483s/iter; left time: 1023.8689s
	iters: 200, epoch: 21 | loss: 0.0719047
	speed: 0.0104s/iter; left time: 218.2286s
Epoch: 21 cost time: 3.1189866065979004
Epoch: 21, Steps: 266 | Train Loss: 0.0547709 Vali Loss: 0.1198283 Test Loss: 0.1688318
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0492362
	speed: 0.0478s/iter; left time: 999.7059s
	iters: 200, epoch: 22 | loss: 0.0439710
	speed: 0.0120s/iter; left time: 248.9663s
Epoch: 22 cost time: 3.299361228942871
Epoch: 22, Steps: 266 | Train Loss: 0.0547193 Vali Loss: 0.1199732 Test Loss: 0.1686582
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0544143
	speed: 0.0480s/iter; left time: 990.1376s
	iters: 200, epoch: 23 | loss: 0.0751125
	speed: 0.0101s/iter; left time: 208.4303s
Epoch: 23 cost time: 3.2343530654907227
Epoch: 23, Steps: 266 | Train Loss: 0.0547676 Vali Loss: 0.1198814 Test Loss: 0.1687806
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0646653
	speed: 0.0503s/iter; left time: 1024.3109s
	iters: 200, epoch: 24 | loss: 0.0516818
	speed: 0.0097s/iter; left time: 197.5851s
Epoch: 24 cost time: 3.2060494422912598
Epoch: 24, Steps: 266 | Train Loss: 0.0547267 Vali Loss: 0.1200621 Test Loss: 0.1688114
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0517519
	speed: 0.0462s/iter; left time: 930.1431s
	iters: 200, epoch: 25 | loss: 0.0468946
	speed: 0.0121s/iter; left time: 243.2058s
Epoch: 25 cost time: 3.343452215194702
Epoch: 25, Steps: 266 | Train Loss: 0.0547340 Vali Loss: 0.1199832 Test Loss: 0.1687327
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0540155
	speed: 0.0514s/iter; left time: 1020.7338s
	iters: 200, epoch: 26 | loss: 0.0614718
	speed: 0.0113s/iter; left time: 223.7296s
Epoch: 26 cost time: 3.557945966720581
Epoch: 26, Steps: 266 | Train Loss: 0.0547529 Vali Loss: 0.1200140 Test Loss: 0.1688195
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0594181
	speed: 0.0491s/iter; left time: 962.1080s
	iters: 200, epoch: 27 | loss: 0.0493933
	speed: 0.0098s/iter; left time: 191.7202s
Epoch: 27 cost time: 3.090088129043579
Epoch: 27, Steps: 266 | Train Loss: 0.0547442 Vali Loss: 0.1199814 Test Loss: 0.1687275
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0454211
	speed: 0.0775s/iter; left time: 1497.5596s
	iters: 200, epoch: 28 | loss: 0.0550520
	speed: 0.0093s/iter; left time: 179.5197s
Epoch: 28 cost time: 5.968043088912964
Epoch: 28, Steps: 266 | Train Loss: 0.0547485 Vali Loss: 0.1200372 Test Loss: 0.1685927
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0632738
	speed: 0.0479s/iter; left time: 912.6582s
	iters: 200, epoch: 29 | loss: 0.0459489
	speed: 0.0097s/iter; left time: 183.4537s
Epoch: 29 cost time: 3.1873064041137695
Epoch: 29, Steps: 266 | Train Loss: 0.0547670 Vali Loss: 0.1200331 Test Loss: 0.1687230
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0469230
	speed: 0.0474s/iter; left time: 890.8374s
	iters: 200, epoch: 30 | loss: 0.0433602
	speed: 0.0089s/iter; left time: 165.8750s
Epoch: 30 cost time: 2.867790937423706
Epoch: 30, Steps: 266 | Train Loss: 0.0547351 Vali Loss: 0.1200118 Test Loss: 0.1686836
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0469365
	speed: 0.0466s/iter; left time: 862.4202s
	iters: 200, epoch: 31 | loss: 0.0595255
	speed: 0.0108s/iter; left time: 199.4146s
Epoch: 31 cost time: 3.1622424125671387
Epoch: 31, Steps: 266 | Train Loss: 0.0547373 Vali Loss: 0.1198986 Test Loss: 0.1687588
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0410814
	speed: 0.0470s/iter; left time: 858.7860s
	iters: 200, epoch: 32 | loss: 0.0812523
	speed: 0.0093s/iter; left time: 169.0596s
Epoch: 32 cost time: 3.0156619548797607
Epoch: 32, Steps: 266 | Train Loss: 0.0547217 Vali Loss: 0.1199297 Test Loss: 0.1686519
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0717027
	speed: 0.0471s/iter; left time: 847.6767s
	iters: 200, epoch: 33 | loss: 0.0401059
	speed: 0.0099s/iter; left time: 176.7378s
Epoch: 33 cost time: 3.1369290351867676
Epoch: 33, Steps: 266 | Train Loss: 0.0547411 Vali Loss: 0.1199576 Test Loss: 0.1686378
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0639711
	speed: 0.0474s/iter; left time: 840.2960s
	iters: 200, epoch: 34 | loss: 0.0736682
	speed: 0.0096s/iter; left time: 168.4805s
Epoch: 34 cost time: 3.0990962982177734
Epoch: 34, Steps: 266 | Train Loss: 0.0546993 Vali Loss: 0.1199286 Test Loss: 0.1687253
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0377792
	speed: 0.0470s/iter; left time: 819.8912s
	iters: 200, epoch: 35 | loss: 0.0419015
	speed: 0.0098s/iter; left time: 169.3939s
Epoch: 35 cost time: 3.0370261669158936
Epoch: 35, Steps: 266 | Train Loss: 0.0547243 Vali Loss: 0.1198837 Test Loss: 0.1686827
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0461995
	speed: 0.0487s/iter; left time: 836.4798s
	iters: 200, epoch: 36 | loss: 0.0499918
	speed: 0.0104s/iter; left time: 177.7580s
Epoch: 36 cost time: 3.303826332092285
Epoch: 36, Steps: 266 | Train Loss: 0.0547365 Vali Loss: 0.1198767 Test Loss: 0.1686709
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0590957
	speed: 0.0506s/iter; left time: 855.8765s
	iters: 200, epoch: 37 | loss: 0.0417409
	speed: 0.0101s/iter; left time: 169.4107s
Epoch: 37 cost time: 3.1472527980804443
Epoch: 37, Steps: 266 | Train Loss: 0.0547318 Vali Loss: 0.1198680 Test Loss: 0.1686565
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0880419
	speed: 0.0480s/iter; left time: 800.3072s
	iters: 200, epoch: 38 | loss: 0.0691191
	speed: 0.0098s/iter; left time: 162.3230s
Epoch: 38 cost time: 3.2359137535095215
Epoch: 38, Steps: 266 | Train Loss: 0.0547081 Vali Loss: 0.1198917 Test Loss: 0.1686288
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0520645
	speed: 0.0481s/iter; left time: 787.9846s
	iters: 200, epoch: 39 | loss: 0.0481360
	speed: 0.0091s/iter; left time: 149.0173s
Epoch: 39 cost time: 3.1373372077941895
Epoch: 39, Steps: 266 | Train Loss: 0.0546431 Vali Loss: 0.1199292 Test Loss: 0.1686830
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0568908
	speed: 0.0753s/iter; left time: 1213.5839s
	iters: 200, epoch: 40 | loss: 0.0643847
	speed: 0.0091s/iter; left time: 145.5007s
Epoch: 40 cost time: 3.2864584922790527
Epoch: 40, Steps: 266 | Train Loss: 0.0547377 Vali Loss: 0.1199427 Test Loss: 0.1686704
EarlyStopping counter: 20 out of 20
Early stopping
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=66, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4908288.0
params:  5561.0
Trainable parameters:  5561
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2493826
	speed: 0.0152s/iter; left time: 401.7507s
	iters: 200, epoch: 1 | loss: 0.1517319
	speed: 0.0091s/iter; left time: 239.5633s
Epoch: 1 cost time: 3.0516936779022217
Epoch: 1, Steps: 266 | Train Loss: 0.2179664 Vali Loss: 0.1181897 Test Loss: 0.1668216
Validation loss decreased (inf --> 0.118190).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2009076
	speed: 0.0465s/iter; left time: 1218.9676s
	iters: 200, epoch: 2 | loss: 0.1958760
	speed: 0.0095s/iter; left time: 247.5060s
Epoch: 2 cost time: 3.0192601680755615
Epoch: 2, Steps: 266 | Train Loss: 0.2157577 Vali Loss: 0.1174623 Test Loss: 0.1659957
Validation loss decreased (0.118190 --> 0.117462).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2675162
	speed: 0.0453s/iter; left time: 1176.0131s
	iters: 200, epoch: 3 | loss: 0.2433781
	speed: 0.0098s/iter; left time: 253.4954s
Epoch: 3 cost time: 3.0642168521881104
Epoch: 3, Steps: 266 | Train Loss: 0.2148603 Vali Loss: 0.1171901 Test Loss: 0.1655716
Validation loss decreased (0.117462 --> 0.117190).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2303574
	speed: 0.0463s/iter; left time: 1190.4862s
	iters: 200, epoch: 4 | loss: 0.1796739
	speed: 0.0088s/iter; left time: 225.3611s
Epoch: 4 cost time: 3.225627899169922
Epoch: 4, Steps: 266 | Train Loss: 0.2142246 Vali Loss: 0.1168823 Test Loss: 0.1654384
Validation loss decreased (0.117190 --> 0.116882).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2732461
	speed: 0.0656s/iter; left time: 1668.2980s
	iters: 200, epoch: 5 | loss: 0.1937959
	speed: 0.0239s/iter; left time: 606.2288s
Epoch: 5 cost time: 6.220653295516968
Epoch: 5, Steps: 266 | Train Loss: 0.2139138 Vali Loss: 0.1168543 Test Loss: 0.1652454
Validation loss decreased (0.116882 --> 0.116854).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3106287
	speed: 0.0701s/iter; left time: 1765.5610s
	iters: 200, epoch: 6 | loss: 0.3349212
	speed: 0.0106s/iter; left time: 264.5701s
Epoch: 6 cost time: 3.705690860748291
Epoch: 6, Steps: 266 | Train Loss: 0.2136537 Vali Loss: 0.1168413 Test Loss: 0.1649894
Validation loss decreased (0.116854 --> 0.116841).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2106352
	speed: 0.0545s/iter; left time: 1356.6681s
	iters: 200, epoch: 7 | loss: 0.1476226
	speed: 0.0112s/iter; left time: 278.0731s
Epoch: 7 cost time: 3.4917681217193604
Epoch: 7, Steps: 266 | Train Loss: 0.2134084 Vali Loss: 0.1166808 Test Loss: 0.1647890
Validation loss decreased (0.116841 --> 0.116681).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1686412
	speed: 0.0753s/iter; left time: 1854.7961s
	iters: 200, epoch: 8 | loss: 0.1666223
	speed: 0.0108s/iter; left time: 265.5015s
Epoch: 8 cost time: 4.44914174079895
Epoch: 8, Steps: 266 | Train Loss: 0.2133136 Vali Loss: 0.1167577 Test Loss: 0.1648970
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2387124
	speed: 0.0497s/iter; left time: 1211.4381s
	iters: 200, epoch: 9 | loss: 0.2543896
	speed: 0.0082s/iter; left time: 198.6431s
Epoch: 9 cost time: 2.8006505966186523
Epoch: 9, Steps: 266 | Train Loss: 0.2128603 Vali Loss: 0.1168227 Test Loss: 0.1647745
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1346451
	speed: 0.0461s/iter; left time: 1111.1804s
	iters: 200, epoch: 10 | loss: 0.1818323
	speed: 0.0083s/iter; left time: 198.7926s
Epoch: 10 cost time: 2.6740946769714355
Epoch: 10, Steps: 266 | Train Loss: 0.2123577 Vali Loss: 0.1167164 Test Loss: 0.1646734
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1720476
	speed: 0.0467s/iter; left time: 1113.8915s
	iters: 200, epoch: 11 | loss: 0.1959060
	speed: 0.0093s/iter; left time: 221.8118s
Epoch: 11 cost time: 2.965383291244507
Epoch: 11, Steps: 266 | Train Loss: 0.2129800 Vali Loss: 0.1166685 Test Loss: 0.1648347
Validation loss decreased (0.116681 --> 0.116669).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2059858
	speed: 0.0492s/iter; left time: 1159.8896s
	iters: 200, epoch: 12 | loss: 0.1725232
	speed: 0.0091s/iter; left time: 212.5259s
Epoch: 12 cost time: 3.1285157203674316
Epoch: 12, Steps: 266 | Train Loss: 0.2128218 Vali Loss: 0.1166977 Test Loss: 0.1646503
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2360937
	speed: 0.0464s/iter; left time: 1081.7926s
	iters: 200, epoch: 13 | loss: 0.1465660
	speed: 0.0092s/iter; left time: 212.8821s
Epoch: 13 cost time: 3.070044755935669
Epoch: 13, Steps: 266 | Train Loss: 0.2125542 Vali Loss: 0.1168547 Test Loss: 0.1645670
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2137735
	speed: 0.0477s/iter; left time: 1099.5662s
	iters: 200, epoch: 14 | loss: 0.1422281
	speed: 0.0097s/iter; left time: 222.0929s
Epoch: 14 cost time: 3.106372356414795
Epoch: 14, Steps: 266 | Train Loss: 0.2125566 Vali Loss: 0.1166315 Test Loss: 0.1643942
Validation loss decreased (0.116669 --> 0.116632).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1973102
	speed: 0.0497s/iter; left time: 1132.4184s
	iters: 200, epoch: 15 | loss: 0.1770469
	speed: 0.0094s/iter; left time: 212.4085s
Epoch: 15 cost time: 3.0672101974487305
Epoch: 15, Steps: 266 | Train Loss: 0.2126670 Vali Loss: 0.1165488 Test Loss: 0.1646344
Validation loss decreased (0.116632 --> 0.116549).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2092197
	speed: 0.0478s/iter; left time: 1076.8406s
	iters: 200, epoch: 16 | loss: 0.2137068
	speed: 0.0186s/iter; left time: 416.8314s
Epoch: 16 cost time: 4.050806999206543
Epoch: 16, Steps: 266 | Train Loss: 0.2125900 Vali Loss: 0.1166584 Test Loss: 0.1645828
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2338929
	speed: 0.0478s/iter; left time: 1063.2697s
	iters: 200, epoch: 17 | loss: 0.2336743
	speed: 0.0094s/iter; left time: 208.0492s
Epoch: 17 cost time: 3.1188406944274902
Epoch: 17, Steps: 266 | Train Loss: 0.2126273 Vali Loss: 0.1165870 Test Loss: 0.1645373
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1940983
	speed: 0.0647s/iter; left time: 1422.2480s
	iters: 200, epoch: 18 | loss: 0.2683670
	speed: 0.0091s/iter; left time: 198.0583s
Epoch: 18 cost time: 3.164149522781372
Epoch: 18, Steps: 266 | Train Loss: 0.2125053 Vali Loss: 0.1166005 Test Loss: 0.1644054
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2155417
	speed: 0.0486s/iter; left time: 1055.5954s
	iters: 200, epoch: 19 | loss: 0.2582440
	speed: 0.0093s/iter; left time: 200.4515s
Epoch: 19 cost time: 3.1168222427368164
Epoch: 19, Steps: 266 | Train Loss: 0.2124595 Vali Loss: 0.1165969 Test Loss: 0.1644554
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2733640
	speed: 0.0508s/iter; left time: 1089.0684s
	iters: 200, epoch: 20 | loss: 0.2243071
	speed: 0.0085s/iter; left time: 181.9342s
Epoch: 20 cost time: 2.9365084171295166
Epoch: 20, Steps: 266 | Train Loss: 0.2123144 Vali Loss: 0.1165448 Test Loss: 0.1645757
Validation loss decreased (0.116549 --> 0.116545).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2623091
	speed: 0.0505s/iter; left time: 1069.8818s
	iters: 200, epoch: 21 | loss: 0.2315068
	speed: 0.0108s/iter; left time: 228.1228s
Epoch: 21 cost time: 3.4552054405212402
Epoch: 21, Steps: 266 | Train Loss: 0.2121084 Vali Loss: 0.1166256 Test Loss: 0.1645419
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2799561
	speed: 0.0522s/iter; left time: 1091.4589s
	iters: 200, epoch: 22 | loss: 0.1996990
	speed: 0.0095s/iter; left time: 197.7263s
Epoch: 22 cost time: 3.1674463748931885
Epoch: 22, Steps: 266 | Train Loss: 0.2122667 Vali Loss: 0.1164483 Test Loss: 0.1646011
Validation loss decreased (0.116545 --> 0.116448).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1948425
	speed: 0.0486s/iter; left time: 1004.1689s
	iters: 200, epoch: 23 | loss: 0.3025100
	speed: 0.0082s/iter; left time: 168.5546s
Epoch: 23 cost time: 2.81632924079895
Epoch: 23, Steps: 266 | Train Loss: 0.2123225 Vali Loss: 0.1165664 Test Loss: 0.1644884
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2139340
	speed: 0.0601s/iter; left time: 1224.1098s
	iters: 200, epoch: 24 | loss: 0.2329565
	speed: 0.0092s/iter; left time: 185.7223s
Epoch: 24 cost time: 3.293200969696045
Epoch: 24, Steps: 266 | Train Loss: 0.2123016 Vali Loss: 0.1164959 Test Loss: 0.1644105
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2341743
	speed: 0.1280s/iter; left time: 2574.8620s
	iters: 200, epoch: 25 | loss: 0.3021569
	speed: 0.0415s/iter; left time: 831.1743s
Epoch: 25 cost time: 12.084262609481812
Epoch: 25, Steps: 266 | Train Loss: 0.2123382 Vali Loss: 0.1165960 Test Loss: 0.1645274
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1469415
	speed: 0.1693s/iter; left time: 3361.1094s
	iters: 200, epoch: 26 | loss: 0.2386674
	speed: 0.0397s/iter; left time: 784.8994s
Epoch: 26 cost time: 10.852818250656128
Epoch: 26, Steps: 266 | Train Loss: 0.2122976 Vali Loss: 0.1165572 Test Loss: 0.1642914
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2576823
	speed: 0.1500s/iter; left time: 2937.5561s
	iters: 200, epoch: 27 | loss: 0.1784711
	speed: 0.0386s/iter; left time: 751.9285s
Epoch: 27 cost time: 9.245928764343262
Epoch: 27, Steps: 266 | Train Loss: 0.2121373 Vali Loss: 0.1165615 Test Loss: 0.1644090
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1957189
	speed: 0.0946s/iter; left time: 1826.8243s
	iters: 200, epoch: 28 | loss: 0.2068973
	speed: 0.0497s/iter; left time: 955.6013s
Epoch: 28 cost time: 10.238659143447876
Epoch: 28, Steps: 266 | Train Loss: 0.2122691 Vali Loss: 0.1165756 Test Loss: 0.1644923
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1895553
	speed: 0.1056s/iter; left time: 2011.3452s
	iters: 200, epoch: 29 | loss: 0.2788544
	speed: 0.0096s/iter; left time: 182.6699s
Epoch: 29 cost time: 3.2089200019836426
Epoch: 29, Steps: 266 | Train Loss: 0.2120903 Vali Loss: 0.1165904 Test Loss: 0.1644297
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2414266
	speed: 0.0514s/iter; left time: 966.0070s
	iters: 200, epoch: 30 | loss: 0.3028709
	speed: 0.0107s/iter; left time: 200.0092s
Epoch: 30 cost time: 3.426813840866089
Epoch: 30, Steps: 266 | Train Loss: 0.2121568 Vali Loss: 0.1166413 Test Loss: 0.1643716
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3468979
	speed: 0.0525s/iter; left time: 972.9550s
	iters: 200, epoch: 31 | loss: 0.1640803
	speed: 0.0187s/iter; left time: 345.0213s
Epoch: 31 cost time: 4.350791931152344
Epoch: 31, Steps: 266 | Train Loss: 0.2121948 Vali Loss: 0.1165034 Test Loss: 0.1645301
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2108146
	speed: 0.0523s/iter; left time: 955.3806s
	iters: 200, epoch: 32 | loss: 0.2848326
	speed: 0.0085s/iter; left time: 155.1753s
Epoch: 32 cost time: 2.812455177307129
Epoch: 32, Steps: 266 | Train Loss: 0.2121065 Vali Loss: 0.1165489 Test Loss: 0.1643285
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2191148
	speed: 0.0566s/iter; left time: 1017.5809s
	iters: 200, epoch: 33 | loss: 0.1968333
	speed: 0.0105s/iter; left time: 187.8910s
Epoch: 33 cost time: 3.410656213760376
Epoch: 33, Steps: 266 | Train Loss: 0.2118665 Vali Loss: 0.1165322 Test Loss: 0.1644844
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1571322
	speed: 0.0625s/iter; left time: 1107.8816s
	iters: 200, epoch: 34 | loss: 0.2202857
	speed: 0.0118s/iter; left time: 208.8150s
Epoch: 34 cost time: 3.602388381958008
Epoch: 34, Steps: 266 | Train Loss: 0.2121514 Vali Loss: 0.1166699 Test Loss: 0.1644024
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2546738
	speed: 0.0585s/iter; left time: 1021.4040s
	iters: 200, epoch: 35 | loss: 0.1744214
	speed: 0.0093s/iter; left time: 161.6212s
Epoch: 35 cost time: 3.117323875427246
Epoch: 35, Steps: 266 | Train Loss: 0.2121490 Vali Loss: 0.1165744 Test Loss: 0.1644060
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1350590
	speed: 0.0468s/iter; left time: 804.5702s
	iters: 200, epoch: 36 | loss: 0.2520243
	speed: 0.0099s/iter; left time: 169.3064s
Epoch: 36 cost time: 3.1464595794677734
Epoch: 36, Steps: 266 | Train Loss: 0.2120429 Vali Loss: 0.1166319 Test Loss: 0.1644342
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1877132
	speed: 0.0464s/iter; left time: 785.8795s
	iters: 200, epoch: 37 | loss: 0.2442251
	speed: 0.0094s/iter; left time: 158.8842s
Epoch: 37 cost time: 3.1011266708374023
Epoch: 37, Steps: 266 | Train Loss: 0.2118439 Vali Loss: 0.1166457 Test Loss: 0.1644000
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1997419
	speed: 0.0476s/iter; left time: 793.6714s
	iters: 200, epoch: 38 | loss: 0.2426048
	speed: 0.0092s/iter; left time: 152.9432s
Epoch: 38 cost time: 3.042332887649536
Epoch: 38, Steps: 266 | Train Loss: 0.2120231 Vali Loss: 0.1166169 Test Loss: 0.1644800
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2604317
	speed: 0.0463s/iter; left time: 758.6284s
	iters: 200, epoch: 39 | loss: 0.2493287
	speed: 0.0099s/iter; left time: 161.8312s
Epoch: 39 cost time: 3.1071131229400635
Epoch: 39, Steps: 266 | Train Loss: 0.2120930 Vali Loss: 0.1165543 Test Loss: 0.1644141
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1849866
	speed: 0.0464s/iter; left time: 747.5230s
	iters: 200, epoch: 40 | loss: 0.4100511
	speed: 0.0097s/iter; left time: 155.6021s
Epoch: 40 cost time: 3.0498125553131104
Epoch: 40, Steps: 266 | Train Loss: 0.2120404 Vali Loss: 0.1165369 Test Loss: 0.1643685
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1449396
	speed: 0.0518s/iter; left time: 821.0387s
	iters: 200, epoch: 41 | loss: 0.2201933
	speed: 0.0093s/iter; left time: 147.0967s
Epoch: 41 cost time: 3.0402753353118896
Epoch: 41, Steps: 266 | Train Loss: 0.2120593 Vali Loss: 0.1166447 Test Loss: 0.1644356
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1600059
	speed: 0.0475s/iter; left time: 740.2942s
	iters: 200, epoch: 42 | loss: 0.2071085
	speed: 0.0094s/iter; left time: 144.9639s
Epoch: 42 cost time: 3.3498899936676025
Epoch: 42, Steps: 266 | Train Loss: 0.2121521 Vali Loss: 0.1165584 Test Loss: 0.1644012
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16519775986671448, mae:0.2547716498374939, rse:0.32953253388404846, corr:[0.57306004 0.5719422  0.5684394  0.5672561  0.5676637  0.56722933
 0.5656674  0.56423163 0.5638322  0.56408685 0.5639867  0.56330585
 0.56259257 0.56237584 0.56256956 0.56256676 0.56208855 0.5612389
 0.560426   0.5598478  0.55942476 0.55897886 0.5584269  0.5579904
 0.55772007 0.5574732  0.55712414 0.5566278  0.5560819  0.55558777
 0.555218   0.55496454 0.5546377  0.55420154 0.5537504  0.5533605
 0.55296236 0.55241877 0.55175436 0.55102533 0.5503217  0.5497848
 0.54934245 0.5489068  0.54843205 0.54783237 0.5472079  0.5465376
 0.5457386  0.54492706 0.54415244 0.5435686  0.5429608  0.54212785
 0.5411095  0.5401804  0.5394587  0.5389829  0.53863215 0.53825384
 0.53776914 0.5373692  0.53719366 0.5371302  0.5370069  0.53681463
 0.5365514  0.53626055 0.53608215 0.53604573 0.5360737  0.536096
 0.5360321  0.5358916  0.53561795 0.5351541  0.53467876 0.53425264
 0.53385365 0.53341633 0.5329903  0.53251004 0.5320568  0.531545
 0.5310174  0.53053975 0.53002644 0.5295757  0.5292606  0.52899104
 0.52860874 0.5281366  0.5274512  0.5269985  0.5267362  0.5247805 ]
