Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2479786
	speed: 0.0252s/iter; left time: 673.5168s
	iters: 200, epoch: 1 | loss: 0.1858332
	speed: 0.0168s/iter; left time: 448.2105s
Epoch: 1 cost time: 6.498132944107056
Epoch: 1, Steps: 268 | Train Loss: 0.2260929 Vali Loss: 0.1639116 Test Loss: 0.2281338
Validation loss decreased (inf --> 0.163912).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1473881
	speed: 0.1100s/iter; left time: 2907.2935s
	iters: 200, epoch: 2 | loss: 0.1171277
	speed: 0.0194s/iter; left time: 510.0178s
Epoch: 2 cost time: 5.62468695640564
Epoch: 2, Steps: 268 | Train Loss: 0.1688616 Vali Loss: 0.1505997 Test Loss: 0.2102262
Validation loss decreased (0.163912 --> 0.150600).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1395246
	speed: 0.1031s/iter; left time: 2697.8135s
	iters: 200, epoch: 3 | loss: 0.1564144
	speed: 0.0162s/iter; left time: 423.0725s
Epoch: 3 cost time: 4.912535190582275
Epoch: 3, Steps: 268 | Train Loss: 0.1506608 Vali Loss: 0.1446904 Test Loss: 0.2022306
Validation loss decreased (0.150600 --> 0.144690).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2335288
	speed: 0.1133s/iter; left time: 2935.3856s
	iters: 200, epoch: 4 | loss: 0.1289677
	speed: 0.0282s/iter; left time: 728.0361s
Epoch: 4 cost time: 7.65572714805603
Epoch: 4, Steps: 268 | Train Loss: 0.1422495 Vali Loss: 0.1405025 Test Loss: 0.1970225
Validation loss decreased (0.144690 --> 0.140502).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1157361
	speed: 0.0946s/iter; left time: 2423.3658s
	iters: 200, epoch: 5 | loss: 0.1172123
	speed: 0.0193s/iter; left time: 492.1884s
Epoch: 5 cost time: 5.177106142044067
Epoch: 5, Steps: 268 | Train Loss: 0.1373756 Vali Loss: 0.1374252 Test Loss: 0.1932215
Validation loss decreased (0.140502 --> 0.137425).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1146631
	speed: 0.1462s/iter; left time: 3708.4523s
	iters: 200, epoch: 6 | loss: 0.1092369
	speed: 0.0283s/iter; left time: 715.4723s
Epoch: 6 cost time: 6.781910419464111
Epoch: 6, Steps: 268 | Train Loss: 0.1341404 Vali Loss: 0.1352877 Test Loss: 0.1908057
Validation loss decreased (0.137425 --> 0.135288).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1385593
	speed: 0.0852s/iter; left time: 2136.9103s
	iters: 200, epoch: 7 | loss: 0.0893103
	speed: 0.0151s/iter; left time: 376.1582s
Epoch: 7 cost time: 4.6992669105529785
Epoch: 7, Steps: 268 | Train Loss: 0.1319691 Vali Loss: 0.1336735 Test Loss: 0.1888894
Validation loss decreased (0.135288 --> 0.133673).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1134322
	speed: 0.0881s/iter; left time: 2185.8629s
	iters: 200, epoch: 8 | loss: 0.1233935
	speed: 0.0168s/iter; left time: 416.4671s
Epoch: 8 cost time: 5.102097511291504
Epoch: 8, Steps: 268 | Train Loss: 0.1306678 Vali Loss: 0.1326388 Test Loss: 0.1876543
Validation loss decreased (0.133673 --> 0.132639).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2135342
	speed: 0.1355s/iter; left time: 3327.6608s
	iters: 200, epoch: 9 | loss: 0.1387719
	speed: 0.0243s/iter; left time: 595.1720s
Epoch: 9 cost time: 7.599599361419678
Epoch: 9, Steps: 268 | Train Loss: 0.1299750 Vali Loss: 0.1319390 Test Loss: 0.1868469
Validation loss decreased (0.132639 --> 0.131939).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0869521
	speed: 0.0988s/iter; left time: 2398.7680s
	iters: 200, epoch: 10 | loss: 0.1520792
	speed: 0.0187s/iter; left time: 451.4167s
Epoch: 10 cost time: 6.388302803039551
Epoch: 10, Steps: 268 | Train Loss: 0.1296309 Vali Loss: 0.1314836 Test Loss: 0.1863007
Validation loss decreased (0.131939 --> 0.131484).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0979731
	speed: 0.1112s/iter; left time: 2671.5272s
	iters: 200, epoch: 11 | loss: 0.1156900
	speed: 0.0300s/iter; left time: 717.2885s
Epoch: 11 cost time: 6.587069749832153
Epoch: 11, Steps: 268 | Train Loss: 0.1292813 Vali Loss: 0.1311138 Test Loss: 0.1859016
Validation loss decreased (0.131484 --> 0.131114).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1207247
	speed: 0.1003s/iter; left time: 2382.6584s
	iters: 200, epoch: 12 | loss: 0.1730027
	speed: 0.0252s/iter; left time: 596.2452s
Epoch: 12 cost time: 6.87846302986145
Epoch: 12, Steps: 268 | Train Loss: 0.1292061 Vali Loss: 0.1308919 Test Loss: 0.1856732
Validation loss decreased (0.131114 --> 0.130892).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1419257
	speed: 0.1014s/iter; left time: 2382.0504s
	iters: 200, epoch: 13 | loss: 0.1482163
	speed: 0.0158s/iter; left time: 370.1612s
Epoch: 13 cost time: 5.526869535446167
Epoch: 13, Steps: 268 | Train Loss: 0.1291221 Vali Loss: 0.1306340 Test Loss: 0.1854571
Validation loss decreased (0.130892 --> 0.130634).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1099848
	speed: 0.0976s/iter; left time: 2265.9752s
	iters: 200, epoch: 14 | loss: 0.0918386
	speed: 0.0153s/iter; left time: 354.0811s
Epoch: 14 cost time: 5.29630184173584
Epoch: 14, Steps: 268 | Train Loss: 0.1288716 Vali Loss: 0.1304730 Test Loss: 0.1853334
Validation loss decreased (0.130634 --> 0.130473).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1502438
	speed: 0.0978s/iter; left time: 2244.9237s
	iters: 200, epoch: 15 | loss: 0.1240261
	speed: 0.0219s/iter; left time: 500.3389s
Epoch: 15 cost time: 8.090959548950195
Epoch: 15, Steps: 268 | Train Loss: 0.1288935 Vali Loss: 0.1303467 Test Loss: 0.1852892
Validation loss decreased (0.130473 --> 0.130347).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1096861
	speed: 0.1227s/iter; left time: 2782.3183s
	iters: 200, epoch: 16 | loss: 0.1204513
	speed: 0.0169s/iter; left time: 382.3473s
Epoch: 16 cost time: 6.571259260177612
Epoch: 16, Steps: 268 | Train Loss: 0.1289346 Vali Loss: 0.1302837 Test Loss: 0.1852215
Validation loss decreased (0.130347 --> 0.130284).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1730713
	speed: 0.1030s/iter; left time: 2308.8119s
	iters: 200, epoch: 17 | loss: 0.1363884
	speed: 0.0254s/iter; left time: 567.1756s
Epoch: 17 cost time: 6.6397011280059814
Epoch: 17, Steps: 268 | Train Loss: 0.1289039 Vali Loss: 0.1304687 Test Loss: 0.1852183
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1138481
	speed: 0.1075s/iter; left time: 2380.5041s
	iters: 200, epoch: 18 | loss: 0.1124940
	speed: 0.0159s/iter; left time: 351.3076s
Epoch: 18 cost time: 5.926579475402832
Epoch: 18, Steps: 268 | Train Loss: 0.1289433 Vali Loss: 0.1303827 Test Loss: 0.1851892
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1281578
	speed: 0.0892s/iter; left time: 1952.2884s
	iters: 200, epoch: 19 | loss: 0.1087579
	speed: 0.0171s/iter; left time: 371.5151s
Epoch: 19 cost time: 4.974761247634888
Epoch: 19, Steps: 268 | Train Loss: 0.1289257 Vali Loss: 0.1303737 Test Loss: 0.1851342
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1381382
	speed: 0.1012s/iter; left time: 2187.1538s
	iters: 200, epoch: 20 | loss: 0.1278682
	speed: 0.0172s/iter; left time: 369.6141s
Epoch: 20 cost time: 5.425645112991333
Epoch: 20, Steps: 268 | Train Loss: 0.1288514 Vali Loss: 0.1304335 Test Loss: 0.1851577
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1179686
	speed: 0.1179s/iter; left time: 2515.2801s
	iters: 200, epoch: 21 | loss: 0.0997311
	speed: 0.0207s/iter; left time: 439.2773s
Epoch: 21 cost time: 6.560956954956055
Epoch: 21, Steps: 268 | Train Loss: 0.1289090 Vali Loss: 0.1305018 Test Loss: 0.1852027
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1240607
	speed: 0.0994s/iter; left time: 2094.6274s
	iters: 200, epoch: 22 | loss: 0.1691856
	speed: 0.0234s/iter; left time: 490.0577s
Epoch: 22 cost time: 5.857120037078857
Epoch: 22, Steps: 268 | Train Loss: 0.1288308 Vali Loss: 0.1305449 Test Loss: 0.1852017
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1078065
	speed: 0.0969s/iter; left time: 2016.1482s
	iters: 200, epoch: 23 | loss: 0.1368253
	speed: 0.0206s/iter; left time: 425.5642s
Epoch: 23 cost time: 5.912383317947388
Epoch: 23, Steps: 268 | Train Loss: 0.1288326 Vali Loss: 0.1303874 Test Loss: 0.1852138
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1176447
	speed: 0.0906s/iter; left time: 1859.7589s
	iters: 200, epoch: 24 | loss: 0.1189161
	speed: 0.0295s/iter; left time: 603.4833s
Epoch: 24 cost time: 7.730326890945435
Epoch: 24, Steps: 268 | Train Loss: 0.1289793 Vali Loss: 0.1303997 Test Loss: 0.1851884
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0919026
	speed: 0.1180s/iter; left time: 2390.8017s
	iters: 200, epoch: 25 | loss: 0.1243060
	speed: 0.0162s/iter; left time: 326.0085s
Epoch: 25 cost time: 5.9618823528289795
Epoch: 25, Steps: 268 | Train Loss: 0.1288848 Vali Loss: 0.1304880 Test Loss: 0.1851761
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1355890
	speed: 0.1587s/iter; left time: 3173.2894s
	iters: 200, epoch: 26 | loss: 0.1218853
	speed: 0.0162s/iter; left time: 322.8082s
Epoch: 26 cost time: 6.625218868255615
Epoch: 26, Steps: 268 | Train Loss: 0.1287445 Vali Loss: 0.1304918 Test Loss: 0.1852283
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1354100
	speed: 0.1258s/iter; left time: 2482.2508s
	iters: 200, epoch: 27 | loss: 0.1778109
	speed: 0.0162s/iter; left time: 318.2922s
Epoch: 27 cost time: 5.923758268356323
Epoch: 27, Steps: 268 | Train Loss: 0.1289206 Vali Loss: 0.1305226 Test Loss: 0.1852123
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1862561
	speed: 0.0885s/iter; left time: 1722.6530s
	iters: 200, epoch: 28 | loss: 0.0810975
	speed: 0.0173s/iter; left time: 335.6719s
Epoch: 28 cost time: 5.451624631881714
Epoch: 28, Steps: 268 | Train Loss: 0.1287668 Vali Loss: 0.1305781 Test Loss: 0.1852484
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1222304
	speed: 0.1101s/iter; left time: 2113.8231s
	iters: 200, epoch: 29 | loss: 0.1007286
	speed: 0.0163s/iter; left time: 310.7043s
Epoch: 29 cost time: 5.122032165527344
Epoch: 29, Steps: 268 | Train Loss: 0.1289667 Vali Loss: 0.1304698 Test Loss: 0.1852041
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2044546
	speed: 0.0847s/iter; left time: 1603.2840s
	iters: 200, epoch: 30 | loss: 0.0846915
	speed: 0.0159s/iter; left time: 300.0842s
Epoch: 30 cost time: 5.09798526763916
Epoch: 30, Steps: 268 | Train Loss: 0.1288632 Vali Loss: 0.1304749 Test Loss: 0.1851999
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1506310
	speed: 0.1066s/iter; left time: 1990.1729s
	iters: 200, epoch: 31 | loss: 0.1301489
	speed: 0.0148s/iter; left time: 274.9368s
Epoch: 31 cost time: 5.838932752609253
Epoch: 31, Steps: 268 | Train Loss: 0.1289454 Vali Loss: 0.1305190 Test Loss: 0.1852241
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1106881
	speed: 0.0954s/iter; left time: 1754.0462s
	iters: 200, epoch: 32 | loss: 0.0940762
	speed: 0.0270s/iter; left time: 493.4403s
Epoch: 32 cost time: 6.912725925445557
Epoch: 32, Steps: 268 | Train Loss: 0.1288669 Vali Loss: 0.1305647 Test Loss: 0.1852151
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0951753
	speed: 0.1413s/iter; left time: 2561.3529s
	iters: 200, epoch: 33 | loss: 0.1115143
	speed: 0.0164s/iter; left time: 295.4217s
Epoch: 33 cost time: 6.146109104156494
Epoch: 33, Steps: 268 | Train Loss: 0.1287719 Vali Loss: 0.1304455 Test Loss: 0.1852245
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1545429
	speed: 0.1181s/iter; left time: 2108.2012s
	iters: 200, epoch: 34 | loss: 0.1144830
	speed: 0.0209s/iter; left time: 370.5710s
Epoch: 34 cost time: 7.382535934448242
Epoch: 34, Steps: 268 | Train Loss: 0.1289208 Vali Loss: 0.1304109 Test Loss: 0.1851995
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1182056
	speed: 0.1030s/iter; left time: 1812.3771s
	iters: 200, epoch: 35 | loss: 0.1332175
	speed: 0.0172s/iter; left time: 300.3363s
Epoch: 35 cost time: 5.538103818893433
Epoch: 35, Steps: 268 | Train Loss: 0.1289588 Vali Loss: 0.1305153 Test Loss: 0.1852207
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1113233
	speed: 0.0979s/iter; left time: 1696.4404s
	iters: 200, epoch: 36 | loss: 0.1491034
	speed: 0.0151s/iter; left time: 259.5203s
Epoch: 36 cost time: 4.769728422164917
Epoch: 36, Steps: 268 | Train Loss: 0.1289144 Vali Loss: 0.1304801 Test Loss: 0.1852086
EarlyStopping counter: 20 out of 20
Early stopping
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2081933
	speed: 0.0241s/iter; left time: 644.0480s
	iters: 200, epoch: 1 | loss: 0.2784897
	speed: 0.0209s/iter; left time: 554.9489s
Epoch: 1 cost time: 6.058748245239258
Epoch: 1, Steps: 268 | Train Loss: 0.2416523 Vali Loss: 0.1301096 Test Loss: 0.1846837
Validation loss decreased (inf --> 0.130110).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2174085
	speed: 0.1154s/iter; left time: 3051.1853s
	iters: 200, epoch: 2 | loss: 0.1649897
	speed: 0.0361s/iter; left time: 951.5199s
Epoch: 2 cost time: 9.021045684814453
Epoch: 2, Steps: 268 | Train Loss: 0.2410529 Vali Loss: 0.1300257 Test Loss: 0.1845345
Validation loss decreased (0.130110 --> 0.130026).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1999367
	speed: 0.1074s/iter; left time: 2809.2343s
	iters: 200, epoch: 3 | loss: 0.2310285
	speed: 0.0158s/iter; left time: 412.5106s
Epoch: 3 cost time: 4.896924734115601
Epoch: 3, Steps: 268 | Train Loss: 0.2409217 Vali Loss: 0.1301339 Test Loss: 0.1845492
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2951863
	speed: 0.1000s/iter; left time: 2589.3294s
	iters: 200, epoch: 4 | loss: 0.1800379
	speed: 0.0271s/iter; left time: 698.9260s
Epoch: 4 cost time: 6.096151828765869
Epoch: 4, Steps: 268 | Train Loss: 0.2404146 Vali Loss: 0.1299448 Test Loss: 0.1844085
Validation loss decreased (0.130026 --> 0.129945).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2417047
	speed: 0.0897s/iter; left time: 2299.4238s
	iters: 200, epoch: 5 | loss: 0.2417450
	speed: 0.0150s/iter; left time: 381.7725s
Epoch: 5 cost time: 4.5901453495025635
Epoch: 5, Steps: 268 | Train Loss: 0.2403095 Vali Loss: 0.1301008 Test Loss: 0.1844416
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2428779
	speed: 0.0950s/iter; left time: 2409.8533s
	iters: 200, epoch: 6 | loss: 0.3743597
	speed: 0.0167s/iter; left time: 423.0677s
Epoch: 6 cost time: 5.514676570892334
Epoch: 6, Steps: 268 | Train Loss: 0.2406085 Vali Loss: 0.1299976 Test Loss: 0.1843812
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1658241
	speed: 0.0961s/iter; left time: 2412.2879s
	iters: 200, epoch: 7 | loss: 0.2962116
	speed: 0.0167s/iter; left time: 417.8944s
Epoch: 7 cost time: 4.943750381469727
Epoch: 7, Steps: 268 | Train Loss: 0.2404101 Vali Loss: 0.1302030 Test Loss: 0.1844864
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1642840
	speed: 0.0880s/iter; left time: 2185.8346s
	iters: 200, epoch: 8 | loss: 0.2001966
	speed: 0.0157s/iter; left time: 388.8855s
Epoch: 8 cost time: 5.6944191455841064
Epoch: 8, Steps: 268 | Train Loss: 0.2404280 Vali Loss: 0.1300749 Test Loss: 0.1844226
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2331183
	speed: 0.1278s/iter; left time: 3138.7830s
	iters: 200, epoch: 9 | loss: 0.2324760
	speed: 0.0234s/iter; left time: 573.1324s
Epoch: 9 cost time: 7.793786287307739
Epoch: 9, Steps: 268 | Train Loss: 0.2405848 Vali Loss: 0.1302526 Test Loss: 0.1844495
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2534356
	speed: 0.1304s/iter; left time: 3168.1925s
	iters: 200, epoch: 10 | loss: 0.2261682
	speed: 0.0254s/iter; left time: 615.5461s
Epoch: 10 cost time: 7.994209051132202
Epoch: 10, Steps: 268 | Train Loss: 0.2402923 Vali Loss: 0.1298853 Test Loss: 0.1841858
Validation loss decreased (0.129945 --> 0.129885).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1671972
	speed: 0.1164s/iter; left time: 2796.5162s
	iters: 200, epoch: 11 | loss: 0.3656293
	speed: 0.0154s/iter; left time: 367.9202s
Epoch: 11 cost time: 5.812707424163818
Epoch: 11, Steps: 268 | Train Loss: 0.2403780 Vali Loss: 0.1301759 Test Loss: 0.1844200
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2291120
	speed: 0.1267s/iter; left time: 3009.2854s
	iters: 200, epoch: 12 | loss: 0.1833479
	speed: 0.0165s/iter; left time: 389.7641s
Epoch: 12 cost time: 5.573222875595093
Epoch: 12, Steps: 268 | Train Loss: 0.2402436 Vali Loss: 0.1301352 Test Loss: 0.1844198
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2754474
	speed: 0.1097s/iter; left time: 2575.2405s
	iters: 200, epoch: 13 | loss: 0.1808399
	speed: 0.0240s/iter; left time: 561.1353s
Epoch: 13 cost time: 7.239330530166626
Epoch: 13, Steps: 268 | Train Loss: 0.2401742 Vali Loss: 0.1300047 Test Loss: 0.1842933
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2548979
	speed: 0.1117s/iter; left time: 2593.2318s
	iters: 200, epoch: 14 | loss: 0.3271673
	speed: 0.0261s/iter; left time: 602.3468s
Epoch: 14 cost time: 6.0684404373168945
Epoch: 14, Steps: 268 | Train Loss: 0.2403383 Vali Loss: 0.1298984 Test Loss: 0.1842064
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3037999
	speed: 0.1068s/iter; left time: 2451.5081s
	iters: 200, epoch: 15 | loss: 0.2179875
	speed: 0.0177s/iter; left time: 403.9342s
Epoch: 15 cost time: 6.615236759185791
Epoch: 15, Steps: 268 | Train Loss: 0.2400812 Vali Loss: 0.1300204 Test Loss: 0.1843672
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2589637
	speed: 0.1131s/iter; left time: 2564.8162s
	iters: 200, epoch: 16 | loss: 0.2402137
	speed: 0.0193s/iter; left time: 436.2407s
Epoch: 16 cost time: 5.332906246185303
Epoch: 16, Steps: 268 | Train Loss: 0.2404191 Vali Loss: 0.1300498 Test Loss: 0.1843226
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2396801
	speed: 0.0880s/iter; left time: 1972.7875s
	iters: 200, epoch: 17 | loss: 0.2424930
	speed: 0.0163s/iter; left time: 362.9052s
Epoch: 17 cost time: 4.79927396774292
Epoch: 17, Steps: 268 | Train Loss: 0.2399831 Vali Loss: 0.1299750 Test Loss: 0.1843195
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2810056
	speed: 0.0893s/iter; left time: 1976.4456s
	iters: 200, epoch: 18 | loss: 0.2525136
	speed: 0.0198s/iter; left time: 436.7337s
Epoch: 18 cost time: 5.539280891418457
Epoch: 18, Steps: 268 | Train Loss: 0.2401926 Vali Loss: 0.1300656 Test Loss: 0.1843213
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2724902
	speed: 0.0932s/iter; left time: 2038.2198s
	iters: 200, epoch: 19 | loss: 0.2044093
	speed: 0.0225s/iter; left time: 490.3973s
Epoch: 19 cost time: 5.538812160491943
Epoch: 19, Steps: 268 | Train Loss: 0.2402927 Vali Loss: 0.1300330 Test Loss: 0.1843481
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2062331
	speed: 0.0969s/iter; left time: 2094.3700s
	iters: 200, epoch: 20 | loss: 0.2096985
	speed: 0.0156s/iter; left time: 336.3519s
Epoch: 20 cost time: 5.476686716079712
Epoch: 20, Steps: 268 | Train Loss: 0.2400041 Vali Loss: 0.1299684 Test Loss: 0.1842606
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2827354
	speed: 0.0942s/iter; left time: 2010.6964s
	iters: 200, epoch: 21 | loss: 0.2614208
	speed: 0.0151s/iter; left time: 321.2757s
Epoch: 21 cost time: 5.508328676223755
Epoch: 21, Steps: 268 | Train Loss: 0.2400368 Vali Loss: 0.1301188 Test Loss: 0.1843473
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2568079
	speed: 0.0928s/iter; left time: 1955.9811s
	iters: 200, epoch: 22 | loss: 0.1815887
	speed: 0.0152s/iter; left time: 317.7938s
Epoch: 22 cost time: 4.886119604110718
Epoch: 22, Steps: 268 | Train Loss: 0.2401010 Vali Loss: 0.1299701 Test Loss: 0.1843242
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2587036
	speed: 0.0958s/iter; left time: 1992.6768s
	iters: 200, epoch: 23 | loss: 0.1798930
	speed: 0.0157s/iter; left time: 325.7946s
Epoch: 23 cost time: 5.665546655654907
Epoch: 23, Steps: 268 | Train Loss: 0.2402045 Vali Loss: 0.1300854 Test Loss: 0.1843233
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1751753
	speed: 0.1131s/iter; left time: 2321.8501s
	iters: 200, epoch: 24 | loss: 0.3581012
	speed: 0.0358s/iter; left time: 732.6599s
Epoch: 24 cost time: 8.123659610748291
Epoch: 24, Steps: 268 | Train Loss: 0.2400361 Vali Loss: 0.1299805 Test Loss: 0.1842726
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2585959
	speed: 0.1160s/iter; left time: 2350.5812s
	iters: 200, epoch: 25 | loss: 0.2279619
	speed: 0.0346s/iter; left time: 697.1008s
Epoch: 25 cost time: 7.887382984161377
Epoch: 25, Steps: 268 | Train Loss: 0.2396632 Vali Loss: 0.1300332 Test Loss: 0.1843134
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2022442
	speed: 0.1053s/iter; left time: 2105.2250s
	iters: 200, epoch: 26 | loss: 0.2270428
	speed: 0.0201s/iter; left time: 399.4013s
Epoch: 26 cost time: 6.361355781555176
Epoch: 26, Steps: 268 | Train Loss: 0.2401367 Vali Loss: 0.1300400 Test Loss: 0.1843219
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2251743
	speed: 0.0964s/iter; left time: 1901.6604s
	iters: 200, epoch: 27 | loss: 0.2758179
	speed: 0.0161s/iter; left time: 315.2605s
Epoch: 27 cost time: 5.583442211151123
Epoch: 27, Steps: 268 | Train Loss: 0.2398828 Vali Loss: 0.1301791 Test Loss: 0.1843380
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2348400
	speed: 0.1065s/iter; left time: 2072.3613s
	iters: 200, epoch: 28 | loss: 0.2123852
	speed: 0.0163s/iter; left time: 315.4726s
Epoch: 28 cost time: 4.979197978973389
Epoch: 28, Steps: 268 | Train Loss: 0.2402885 Vali Loss: 0.1300528 Test Loss: 0.1843453
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2179864
	speed: 0.0946s/iter; left time: 1816.8387s
	iters: 200, epoch: 29 | loss: 0.1833163
	speed: 0.0149s/iter; left time: 285.1150s
Epoch: 29 cost time: 4.82344913482666
Epoch: 29, Steps: 268 | Train Loss: 0.2401907 Vali Loss: 0.1301594 Test Loss: 0.1843240
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1674488
	speed: 0.1252s/iter; left time: 2370.4520s
	iters: 200, epoch: 30 | loss: 0.2611669
	speed: 0.0169s/iter; left time: 317.2942s
Epoch: 30 cost time: 6.065637111663818
Epoch: 30, Steps: 268 | Train Loss: 0.2401014 Vali Loss: 0.1300693 Test Loss: 0.1843128
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18503770232200623, mae:0.2684582769870758, rse:0.3487597107887268, corr:[0.576214   0.5734364  0.567871   0.56619966 0.56524616 0.5627817
 0.56101143 0.56072426 0.5601273  0.5585201  0.5570642  0.5563799
 0.5557108  0.5547703  0.55412394 0.5536233  0.55253404 0.5510349
 0.5500743  0.5495735  0.5486376  0.5472419  0.54625005 0.5459806
 0.545648   0.5447944  0.5441619  0.5440156  0.54364413 0.5427468
 0.54173374 0.5411452  0.5407106  0.54014885 0.5396237  0.5394013
 0.53904337 0.538289   0.53738135 0.5365902  0.535855   0.53523594
 0.53486    0.5348193  0.5347935  0.5343264  0.53364635 0.53294957
 0.5322178  0.5312539  0.53018457 0.5294531  0.52900416 0.5283813
 0.5276022  0.5269584  0.5264755  0.5259756  0.52528745 0.52484703
 0.52473325 0.5246543  0.5244617  0.52439606 0.5245238  0.5246509
 0.52459186 0.5243598  0.5243259  0.524465   0.52458405 0.5247293
 0.52493435 0.525197   0.52522355 0.52510977 0.5251434  0.52522206
 0.5251684  0.52499044 0.5249148  0.52496755 0.52496886 0.52478
 0.5246014  0.5245733  0.52449036 0.5242551  0.5239908  0.5239186
 0.5240094  0.5240241  0.52379936 0.52364594 0.5232978  0.5217164 ]
