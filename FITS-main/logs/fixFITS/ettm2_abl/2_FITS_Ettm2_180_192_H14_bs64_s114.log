Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=38, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=38, out_features=78, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2655744.0
params:  3042.0
Trainable parameters:  3042
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3091411
	speed: 0.0153s/iter; left time: 406.1194s
	iters: 200, epoch: 1 | loss: 0.3148833
	speed: 0.0085s/iter; left time: 224.9699s
Epoch: 1 cost time: 2.9396231174468994
Epoch: 1, Steps: 267 | Train Loss: 0.2999456 Vali Loss: 0.2112849 Test Loss: 0.2923640
Validation loss decreased (inf --> 0.211285).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2348754
	speed: 0.0443s/iter; left time: 1166.0159s
	iters: 200, epoch: 2 | loss: 0.1894932
	speed: 0.0084s/iter; left time: 219.1877s
Epoch: 2 cost time: 2.5878453254699707
Epoch: 2, Steps: 267 | Train Loss: 0.2247296 Vali Loss: 0.1949669 Test Loss: 0.2725099
Validation loss decreased (0.211285 --> 0.194967).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1646499
	speed: 0.0449s/iter; left time: 1170.2220s
	iters: 200, epoch: 3 | loss: 0.2494831
	speed: 0.0077s/iter; left time: 201.2216s
Epoch: 3 cost time: 2.737865686416626
Epoch: 3, Steps: 267 | Train Loss: 0.2033145 Vali Loss: 0.1862030 Test Loss: 0.2619123
Validation loss decreased (0.194967 --> 0.186203).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1592649
	speed: 0.0498s/iter; left time: 1285.7839s
	iters: 200, epoch: 4 | loss: 0.2521805
	speed: 0.0086s/iter; left time: 219.9273s
Epoch: 4 cost time: 3.033601760864258
Epoch: 4, Steps: 267 | Train Loss: 0.1924514 Vali Loss: 0.1804149 Test Loss: 0.2544583
Validation loss decreased (0.186203 --> 0.180415).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2370481
	speed: 0.0456s/iter; left time: 1165.2437s
	iters: 200, epoch: 5 | loss: 0.1448662
	speed: 0.0093s/iter; left time: 237.2904s
Epoch: 5 cost time: 2.9630789756774902
Epoch: 5, Steps: 267 | Train Loss: 0.1858817 Vali Loss: 0.1758109 Test Loss: 0.2487342
Validation loss decreased (0.180415 --> 0.175811).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2026019
	speed: 0.0547s/iter; left time: 1381.4152s
	iters: 200, epoch: 6 | loss: 0.1209783
	speed: 0.0088s/iter; left time: 220.7601s
Epoch: 6 cost time: 3.4170942306518555
Epoch: 6, Steps: 267 | Train Loss: 0.1813907 Vali Loss: 0.1727682 Test Loss: 0.2447303
Validation loss decreased (0.175811 --> 0.172768).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1774512
	speed: 0.0632s/iter; left time: 1580.8830s
	iters: 200, epoch: 7 | loss: 0.1870015
	speed: 0.0138s/iter; left time: 342.9526s
Epoch: 7 cost time: 4.58788275718689
Epoch: 7, Steps: 267 | Train Loss: 0.1782717 Vali Loss: 0.1705327 Test Loss: 0.2416740
Validation loss decreased (0.172768 --> 0.170533).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1817453
	speed: 0.0564s/iter; left time: 1394.5115s
	iters: 200, epoch: 8 | loss: 0.1296264
	speed: 0.0123s/iter; left time: 302.3738s
Epoch: 8 cost time: 4.1727681159973145
Epoch: 8, Steps: 267 | Train Loss: 0.1761058 Vali Loss: 0.1689604 Test Loss: 0.2395315
Validation loss decreased (0.170533 --> 0.168960).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1740269
	speed: 0.0710s/iter; left time: 1737.0719s
	iters: 200, epoch: 9 | loss: 0.2115539
	speed: 0.0161s/iter; left time: 391.3311s
Epoch: 9 cost time: 5.150026082992554
Epoch: 9, Steps: 267 | Train Loss: 0.1745781 Vali Loss: 0.1677453 Test Loss: 0.2380101
Validation loss decreased (0.168960 --> 0.167745).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1860675
	speed: 0.0668s/iter; left time: 1617.5487s
	iters: 200, epoch: 10 | loss: 0.1358565
	speed: 0.0182s/iter; left time: 439.7422s
Epoch: 10 cost time: 4.3193652629852295
Epoch: 10, Steps: 267 | Train Loss: 0.1734587 Vali Loss: 0.1667350 Test Loss: 0.2367132
Validation loss decreased (0.167745 --> 0.166735).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1870724
	speed: 0.0492s/iter; left time: 1178.3185s
	iters: 200, epoch: 11 | loss: 0.2204471
	speed: 0.0092s/iter; left time: 219.1591s
Epoch: 11 cost time: 3.155301809310913
Epoch: 11, Steps: 267 | Train Loss: 0.1727320 Vali Loss: 0.1662598 Test Loss: 0.2358739
Validation loss decreased (0.166735 --> 0.166260).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1894798
	speed: 0.0482s/iter; left time: 1140.6652s
	iters: 200, epoch: 12 | loss: 0.1913229
	speed: 0.0080s/iter; left time: 187.9763s
Epoch: 12 cost time: 2.6840994358062744
Epoch: 12, Steps: 267 | Train Loss: 0.1721802 Vali Loss: 0.1654530 Test Loss: 0.2351222
Validation loss decreased (0.166260 --> 0.165453).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1528821
	speed: 0.0482s/iter; left time: 1128.7318s
	iters: 200, epoch: 13 | loss: 0.1480230
	speed: 0.0203s/iter; left time: 472.3255s
Epoch: 13 cost time: 4.599524736404419
Epoch: 13, Steps: 267 | Train Loss: 0.1718460 Vali Loss: 0.1652139 Test Loss: 0.2347135
Validation loss decreased (0.165453 --> 0.165214).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1437553
	speed: 0.0746s/iter; left time: 1726.3029s
	iters: 200, epoch: 14 | loss: 0.1074491
	speed: 0.0080s/iter; left time: 183.0935s
Epoch: 14 cost time: 2.6870861053466797
Epoch: 14, Steps: 267 | Train Loss: 0.1715707 Vali Loss: 0.1648721 Test Loss: 0.2343536
Validation loss decreased (0.165214 --> 0.164872).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1871485
	speed: 0.0504s/iter; left time: 1153.3355s
	iters: 200, epoch: 15 | loss: 0.2285075
	speed: 0.0089s/iter; left time: 203.1768s
Epoch: 15 cost time: 3.106349468231201
Epoch: 15, Steps: 267 | Train Loss: 0.1714426 Vali Loss: 0.1648788 Test Loss: 0.2341214
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1786151
	speed: 0.0610s/iter; left time: 1378.9643s
	iters: 200, epoch: 16 | loss: 0.2240285
	speed: 0.0082s/iter; left time: 185.3647s
Epoch: 16 cost time: 2.747619867324829
Epoch: 16, Steps: 267 | Train Loss: 0.1713289 Vali Loss: 0.1646118 Test Loss: 0.2339067
Validation loss decreased (0.164872 --> 0.164612).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1507832
	speed: 0.0524s/iter; left time: 1169.8594s
	iters: 200, epoch: 17 | loss: 0.1880878
	speed: 0.0103s/iter; left time: 228.7625s
Epoch: 17 cost time: 3.747424364089966
Epoch: 17, Steps: 267 | Train Loss: 0.1711946 Vali Loss: 0.1645038 Test Loss: 0.2337271
Validation loss decreased (0.164612 --> 0.164504).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1371572
	speed: 0.0566s/iter; left time: 1249.6544s
	iters: 200, epoch: 18 | loss: 0.2716156
	speed: 0.0086s/iter; left time: 188.9925s
Epoch: 18 cost time: 3.1313393115997314
Epoch: 18, Steps: 267 | Train Loss: 0.1711465 Vali Loss: 0.1644586 Test Loss: 0.2335991
Validation loss decreased (0.164504 --> 0.164459).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1713938
	speed: 0.0688s/iter; left time: 1499.7569s
	iters: 200, epoch: 19 | loss: 0.1371378
	speed: 0.0082s/iter; left time: 177.4078s
Epoch: 19 cost time: 2.874910593032837
Epoch: 19, Steps: 267 | Train Loss: 0.1711269 Vali Loss: 0.1644295 Test Loss: 0.2335384
Validation loss decreased (0.164459 --> 0.164429).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2318999
	speed: 0.0504s/iter; left time: 1085.6803s
	iters: 200, epoch: 20 | loss: 0.1309700
	speed: 0.0092s/iter; left time: 196.4301s
Epoch: 20 cost time: 3.081596612930298
Epoch: 20, Steps: 267 | Train Loss: 0.1710313 Vali Loss: 0.1645044 Test Loss: 0.2335100
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1931951
	speed: 0.0485s/iter; left time: 1030.7694s
	iters: 200, epoch: 21 | loss: 0.2396331
	speed: 0.0090s/iter; left time: 189.5616s
Epoch: 21 cost time: 3.0131638050079346
Epoch: 21, Steps: 267 | Train Loss: 0.1710584 Vali Loss: 0.1644083 Test Loss: 0.2334286
Validation loss decreased (0.164429 --> 0.164408).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1900969
	speed: 0.0481s/iter; left time: 1010.1024s
	iters: 200, epoch: 22 | loss: 0.1830526
	speed: 0.0102s/iter; left time: 212.7606s
Epoch: 22 cost time: 3.320712089538574
Epoch: 22, Steps: 267 | Train Loss: 0.1710102 Vali Loss: 0.1643686 Test Loss: 0.2333924
Validation loss decreased (0.164408 --> 0.164369).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1872744
	speed: 0.0483s/iter; left time: 1001.3165s
	iters: 200, epoch: 23 | loss: 0.2150108
	speed: 0.0084s/iter; left time: 172.7966s
Epoch: 23 cost time: 2.868767738342285
Epoch: 23, Steps: 267 | Train Loss: 0.1710388 Vali Loss: 0.1643500 Test Loss: 0.2334200
Validation loss decreased (0.164369 --> 0.164350).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1528344
	speed: 0.0464s/iter; left time: 948.4959s
	iters: 200, epoch: 24 | loss: 0.1787138
	speed: 0.0079s/iter; left time: 160.8708s
Epoch: 24 cost time: 2.7155659198760986
Epoch: 24, Steps: 267 | Train Loss: 0.1709818 Vali Loss: 0.1644465 Test Loss: 0.2334044
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2107152
	speed: 0.0595s/iter; left time: 1202.0094s
	iters: 200, epoch: 25 | loss: 0.1588760
	speed: 0.0098s/iter; left time: 196.9947s
Epoch: 25 cost time: 3.4535367488861084
Epoch: 25, Steps: 267 | Train Loss: 0.1708933 Vali Loss: 0.1643917 Test Loss: 0.2333613
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1919813
	speed: 0.0503s/iter; left time: 1002.0708s
	iters: 200, epoch: 26 | loss: 0.2214609
	speed: 0.0081s/iter; left time: 159.6696s
Epoch: 26 cost time: 2.86887526512146
Epoch: 26, Steps: 267 | Train Loss: 0.1710064 Vali Loss: 0.1641225 Test Loss: 0.2333181
Validation loss decreased (0.164350 --> 0.164123).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1811019
	speed: 0.0514s/iter; left time: 1010.6481s
	iters: 200, epoch: 27 | loss: 0.1495990
	speed: 0.0141s/iter; left time: 274.8600s
Epoch: 27 cost time: 3.8862621784210205
Epoch: 27, Steps: 267 | Train Loss: 0.1709930 Vali Loss: 0.1642344 Test Loss: 0.2333238
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1465163
	speed: 0.0790s/iter; left time: 1532.4132s
	iters: 200, epoch: 28 | loss: 0.1358531
	speed: 0.0097s/iter; left time: 187.9992s
Epoch: 28 cost time: 5.900770664215088
Epoch: 28, Steps: 267 | Train Loss: 0.1708543 Vali Loss: 0.1642172 Test Loss: 0.2332837
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2205590
	speed: 0.0471s/iter; left time: 901.4517s
	iters: 200, epoch: 29 | loss: 0.1304615
	speed: 0.0088s/iter; left time: 166.7500s
Epoch: 29 cost time: 2.907909631729126
Epoch: 29, Steps: 267 | Train Loss: 0.1708820 Vali Loss: 0.1642617 Test Loss: 0.2333082
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1700644
	speed: 0.0549s/iter; left time: 1035.3955s
	iters: 200, epoch: 30 | loss: 0.1281768
	speed: 0.0091s/iter; left time: 169.9602s
Epoch: 30 cost time: 3.008970260620117
Epoch: 30, Steps: 267 | Train Loss: 0.1709812 Vali Loss: 0.1642687 Test Loss: 0.2332601
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2071198
	speed: 0.0473s/iter; left time: 879.3990s
	iters: 200, epoch: 31 | loss: 0.1442181
	speed: 0.0078s/iter; left time: 144.8995s
Epoch: 31 cost time: 2.709780216217041
Epoch: 31, Steps: 267 | Train Loss: 0.1707888 Vali Loss: 0.1643271 Test Loss: 0.2332836
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1998364
	speed: 0.0451s/iter; left time: 827.0283s
	iters: 200, epoch: 32 | loss: 0.1316675
	speed: 0.0078s/iter; left time: 141.3661s
Epoch: 32 cost time: 2.697558641433716
Epoch: 32, Steps: 267 | Train Loss: 0.1708662 Vali Loss: 0.1643613 Test Loss: 0.2332705
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1691724
	speed: 0.0448s/iter; left time: 808.4235s
	iters: 200, epoch: 33 | loss: 0.2322382
	speed: 0.0079s/iter; left time: 141.7908s
Epoch: 33 cost time: 2.73956561088562
Epoch: 33, Steps: 267 | Train Loss: 0.1709345 Vali Loss: 0.1642882 Test Loss: 0.2332792
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2449968
	speed: 0.0431s/iter; left time: 766.9957s
	iters: 200, epoch: 34 | loss: 0.1766573
	speed: 0.0080s/iter; left time: 140.9890s
Epoch: 34 cost time: 2.6383519172668457
Epoch: 34, Steps: 267 | Train Loss: 0.1709427 Vali Loss: 0.1643938 Test Loss: 0.2333024
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1925830
	speed: 0.0441s/iter; left time: 773.1998s
	iters: 200, epoch: 35 | loss: 0.1647152
	speed: 0.0080s/iter; left time: 138.7523s
Epoch: 35 cost time: 2.7441720962524414
Epoch: 35, Steps: 267 | Train Loss: 0.1708322 Vali Loss: 0.1644341 Test Loss: 0.2332715
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1744321
	speed: 0.0470s/iter; left time: 810.6705s
	iters: 200, epoch: 36 | loss: 0.1673964
	speed: 0.0084s/iter; left time: 143.9017s
Epoch: 36 cost time: 2.8277668952941895
Epoch: 36, Steps: 267 | Train Loss: 0.1707802 Vali Loss: 0.1642702 Test Loss: 0.2332572
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2211723
	speed: 0.0457s/iter; left time: 776.3868s
	iters: 200, epoch: 37 | loss: 0.2746615
	speed: 0.0090s/iter; left time: 151.6320s
Epoch: 37 cost time: 2.874605178833008
Epoch: 37, Steps: 267 | Train Loss: 0.1709301 Vali Loss: 0.1644614 Test Loss: 0.2332523
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1393274
	speed: 0.0437s/iter; left time: 730.4389s
	iters: 200, epoch: 38 | loss: 0.2503769
	speed: 0.0092s/iter; left time: 153.6410s
Epoch: 38 cost time: 2.9217429161071777
Epoch: 38, Steps: 267 | Train Loss: 0.1709104 Vali Loss: 0.1641848 Test Loss: 0.2332562
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2057654
	speed: 0.0523s/iter; left time: 860.9674s
	iters: 200, epoch: 39 | loss: 0.2153389
	speed: 0.0100s/iter; left time: 162.8423s
Epoch: 39 cost time: 3.35152530670166
Epoch: 39, Steps: 267 | Train Loss: 0.1709195 Vali Loss: 0.1644565 Test Loss: 0.2332656
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1604663
	speed: 0.0540s/iter; left time: 873.7270s
	iters: 200, epoch: 40 | loss: 0.1760288
	speed: 0.0077s/iter; left time: 123.2689s
Epoch: 40 cost time: 3.2584383487701416
Epoch: 40, Steps: 267 | Train Loss: 0.1709291 Vali Loss: 0.1641863 Test Loss: 0.2332415
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1396488
	speed: 0.0437s/iter; left time: 696.4120s
	iters: 200, epoch: 41 | loss: 0.1636763
	speed: 0.0079s/iter; left time: 124.6260s
Epoch: 41 cost time: 2.669191837310791
Epoch: 41, Steps: 267 | Train Loss: 0.1709151 Vali Loss: 0.1643865 Test Loss: 0.2332399
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2319972
	speed: 0.0440s/iter; left time: 689.4951s
	iters: 200, epoch: 42 | loss: 0.1727743
	speed: 0.0078s/iter; left time: 120.8732s
Epoch: 42 cost time: 2.6276583671569824
Epoch: 42, Steps: 267 | Train Loss: 0.1709207 Vali Loss: 0.1643278 Test Loss: 0.2332516
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2244552
	speed: 0.0450s/iter; left time: 692.0483s
	iters: 200, epoch: 43 | loss: 0.1559557
	speed: 0.0078s/iter; left time: 119.0394s
Epoch: 43 cost time: 2.741015672683716
Epoch: 43, Steps: 267 | Train Loss: 0.1708958 Vali Loss: 0.1644326 Test Loss: 0.2332258
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1287562
	speed: 0.0441s/iter; left time: 666.4776s
	iters: 200, epoch: 44 | loss: 0.1609708
	speed: 0.0079s/iter; left time: 118.4672s
Epoch: 44 cost time: 2.691542863845825
Epoch: 44, Steps: 267 | Train Loss: 0.1708496 Vali Loss: 0.1643410 Test Loss: 0.2332357
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1519984
	speed: 0.0529s/iter; left time: 785.0196s
	iters: 200, epoch: 45 | loss: 0.1529922
	speed: 0.0121s/iter; left time: 178.2820s
Epoch: 45 cost time: 4.10573673248291
Epoch: 45, Steps: 267 | Train Loss: 0.1709190 Vali Loss: 0.1643261 Test Loss: 0.2332589
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1581900
	speed: 0.0445s/iter; left time: 648.5392s
	iters: 200, epoch: 46 | loss: 0.1520196
	speed: 0.0079s/iter; left time: 114.7219s
Epoch: 46 cost time: 2.7204043865203857
Epoch: 46, Steps: 267 | Train Loss: 0.1708891 Vali Loss: 0.1644099 Test Loss: 0.2332511
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=38, out_features=78, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2655744.0
params:  3042.0
Trainable parameters:  3042
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4441463
	speed: 0.0134s/iter; left time: 356.2718s
	iters: 200, epoch: 1 | loss: 0.3267385
	speed: 0.0078s/iter; left time: 206.2513s
Epoch: 1 cost time: 2.6545746326446533
Epoch: 1, Steps: 267 | Train Loss: 0.3208908 Vali Loss: 0.1638156 Test Loss: 0.2325305
Validation loss decreased (inf --> 0.163816).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2371257
	speed: 0.0475s/iter; left time: 1250.0733s
	iters: 200, epoch: 2 | loss: 0.3578888
	speed: 0.0098s/iter; left time: 256.4650s
Epoch: 2 cost time: 3.177495241165161
Epoch: 2, Steps: 267 | Train Loss: 0.3209998 Vali Loss: 0.1636397 Test Loss: 0.2324462
Validation loss decreased (0.163816 --> 0.163640).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4289107
	speed: 0.0497s/iter; left time: 1296.1998s
	iters: 200, epoch: 3 | loss: 0.3256298
	speed: 0.0102s/iter; left time: 265.9084s
Epoch: 3 cost time: 3.2956483364105225
Epoch: 3, Steps: 267 | Train Loss: 0.3202418 Vali Loss: 0.1639012 Test Loss: 0.2323017
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3205529
	speed: 0.0515s/iter; left time: 1329.8706s
	iters: 200, epoch: 4 | loss: 0.4127600
	speed: 0.0085s/iter; left time: 218.7680s
Epoch: 4 cost time: 2.9653306007385254
Epoch: 4, Steps: 267 | Train Loss: 0.3202271 Vali Loss: 0.1637823 Test Loss: 0.2323588
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3606258
	speed: 0.0492s/iter; left time: 1256.2428s
	iters: 200, epoch: 5 | loss: 0.2694560
	speed: 0.0096s/iter; left time: 243.3180s
Epoch: 5 cost time: 3.113077402114868
Epoch: 5, Steps: 267 | Train Loss: 0.3202088 Vali Loss: 0.1635661 Test Loss: 0.2323062
Validation loss decreased (0.163640 --> 0.163566).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3405255
	speed: 0.0452s/iter; left time: 1142.6110s
	iters: 200, epoch: 6 | loss: 0.4294177
	speed: 0.0083s/iter; left time: 209.1008s
Epoch: 6 cost time: 2.7153666019439697
Epoch: 6, Steps: 267 | Train Loss: 0.3200783 Vali Loss: 0.1635594 Test Loss: 0.2320697
Validation loss decreased (0.163566 --> 0.163559).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2762495
	speed: 0.0483s/iter; left time: 1207.1296s
	iters: 200, epoch: 7 | loss: 0.2880341
	speed: 0.0084s/iter; left time: 209.8994s
Epoch: 7 cost time: 2.9572181701660156
Epoch: 7, Steps: 267 | Train Loss: 0.3199789 Vali Loss: 0.1635452 Test Loss: 0.2321888
Validation loss decreased (0.163559 --> 0.163545).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3739755
	speed: 0.0488s/iter; left time: 1206.0967s
	iters: 200, epoch: 8 | loss: 0.2871919
	speed: 0.0081s/iter; left time: 198.3414s
Epoch: 8 cost time: 2.780144691467285
Epoch: 8, Steps: 267 | Train Loss: 0.3199490 Vali Loss: 0.1636239 Test Loss: 0.2321329
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3330946
	speed: 0.0513s/iter; left time: 1256.0470s
	iters: 200, epoch: 9 | loss: 0.3131804
	speed: 0.0135s/iter; left time: 329.0848s
Epoch: 9 cost time: 3.4990718364715576
Epoch: 9, Steps: 267 | Train Loss: 0.3198281 Vali Loss: 0.1636533 Test Loss: 0.2321434
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3821631
	speed: 0.0589s/iter; left time: 1425.3283s
	iters: 200, epoch: 10 | loss: 0.4115420
	speed: 0.0092s/iter; left time: 221.0406s
Epoch: 10 cost time: 3.453834056854248
Epoch: 10, Steps: 267 | Train Loss: 0.3198122 Vali Loss: 0.1637339 Test Loss: 0.2320994
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3611578
	speed: 0.0478s/iter; left time: 1142.7635s
	iters: 200, epoch: 11 | loss: 0.4107623
	speed: 0.0114s/iter; left time: 272.6445s
Epoch: 11 cost time: 3.2474751472473145
Epoch: 11, Steps: 267 | Train Loss: 0.3197214 Vali Loss: 0.1636326 Test Loss: 0.2319772
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2935822
	speed: 0.0491s/iter; left time: 1162.3175s
	iters: 200, epoch: 12 | loss: 0.2894277
	speed: 0.0101s/iter; left time: 236.9137s
Epoch: 12 cost time: 3.1945650577545166
Epoch: 12, Steps: 267 | Train Loss: 0.3196687 Vali Loss: 0.1635359 Test Loss: 0.2319802
Validation loss decreased (0.163545 --> 0.163536).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3641608
	speed: 0.0468s/iter; left time: 1094.5268s
	iters: 200, epoch: 13 | loss: 0.4325756
	speed: 0.0088s/iter; left time: 205.0978s
Epoch: 13 cost time: 3.02388596534729
Epoch: 13, Steps: 267 | Train Loss: 0.3194787 Vali Loss: 0.1636978 Test Loss: 0.2320449
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2664036
	speed: 0.0453s/iter; left time: 1048.2553s
	iters: 200, epoch: 14 | loss: 0.3212009
	speed: 0.0086s/iter; left time: 199.1554s
Epoch: 14 cost time: 2.8076276779174805
Epoch: 14, Steps: 267 | Train Loss: 0.3195888 Vali Loss: 0.1636680 Test Loss: 0.2320020
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2773731
	speed: 0.0418s/iter; left time: 956.8011s
	iters: 200, epoch: 15 | loss: 0.3884090
	speed: 0.0076s/iter; left time: 173.0469s
Epoch: 15 cost time: 2.6149418354034424
Epoch: 15, Steps: 267 | Train Loss: 0.3195785 Vali Loss: 0.1636841 Test Loss: 0.2319549
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4827545
	speed: 0.0428s/iter; left time: 966.7117s
	iters: 200, epoch: 16 | loss: 0.3354859
	speed: 0.0077s/iter; left time: 172.6968s
Epoch: 16 cost time: 2.5872581005096436
Epoch: 16, Steps: 267 | Train Loss: 0.3195540 Vali Loss: 0.1637015 Test Loss: 0.2320092
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3301362
	speed: 0.0433s/iter; left time: 966.8335s
	iters: 200, epoch: 17 | loss: 0.2798031
	speed: 0.0075s/iter; left time: 166.0879s
Epoch: 17 cost time: 2.6589221954345703
Epoch: 17, Steps: 267 | Train Loss: 0.3195319 Vali Loss: 0.1636004 Test Loss: 0.2319454
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3738947
	speed: 0.0432s/iter; left time: 952.9361s
	iters: 200, epoch: 18 | loss: 0.2896427
	speed: 0.0077s/iter; left time: 168.7486s
Epoch: 18 cost time: 2.6156084537506104
Epoch: 18, Steps: 267 | Train Loss: 0.3194804 Vali Loss: 0.1636734 Test Loss: 0.2319617
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2720710
	speed: 0.0416s/iter; left time: 907.6234s
	iters: 200, epoch: 19 | loss: 0.2588168
	speed: 0.0076s/iter; left time: 164.5427s
Epoch: 19 cost time: 2.593052864074707
Epoch: 19, Steps: 267 | Train Loss: 0.3193697 Vali Loss: 0.1635769 Test Loss: 0.2319133
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2535287
	speed: 0.0442s/iter; left time: 950.9055s
	iters: 200, epoch: 20 | loss: 0.3174640
	speed: 0.0143s/iter; left time: 306.6297s
Epoch: 20 cost time: 3.3738765716552734
Epoch: 20, Steps: 267 | Train Loss: 0.3194706 Vali Loss: 0.1636849 Test Loss: 0.2319546
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3289719
	speed: 0.0427s/iter; left time: 906.8322s
	iters: 200, epoch: 21 | loss: 0.2566099
	speed: 0.0084s/iter; left time: 178.5944s
Epoch: 21 cost time: 2.773573875427246
Epoch: 21, Steps: 267 | Train Loss: 0.3193576 Vali Loss: 0.1635839 Test Loss: 0.2319960
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2969675
	speed: 0.0484s/iter; left time: 1015.5059s
	iters: 200, epoch: 22 | loss: 0.2630489
	speed: 0.0078s/iter; left time: 163.1918s
Epoch: 22 cost time: 2.72835373878479
Epoch: 22, Steps: 267 | Train Loss: 0.3193612 Vali Loss: 0.1637175 Test Loss: 0.2319423
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2410245
	speed: 0.0499s/iter; left time: 1033.4105s
	iters: 200, epoch: 23 | loss: 0.3429379
	speed: 0.0082s/iter; left time: 169.4558s
Epoch: 23 cost time: 3.3984384536743164
Epoch: 23, Steps: 267 | Train Loss: 0.3193994 Vali Loss: 0.1635993 Test Loss: 0.2319797
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3654735
	speed: 0.0439s/iter; left time: 898.3717s
	iters: 200, epoch: 24 | loss: 0.4523405
	speed: 0.0079s/iter; left time: 160.9294s
Epoch: 24 cost time: 2.568647861480713
Epoch: 24, Steps: 267 | Train Loss: 0.3193872 Vali Loss: 0.1638003 Test Loss: 0.2319670
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3800153
	speed: 0.0492s/iter; left time: 993.0870s
	iters: 200, epoch: 25 | loss: 0.2678297
	speed: 0.0078s/iter; left time: 156.6852s
Epoch: 25 cost time: 2.716906785964966
Epoch: 25, Steps: 267 | Train Loss: 0.3191655 Vali Loss: 0.1636239 Test Loss: 0.2319467
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3294719
	speed: 0.0420s/iter; left time: 837.3879s
	iters: 200, epoch: 26 | loss: 0.2317500
	speed: 0.0076s/iter; left time: 150.2263s
Epoch: 26 cost time: 2.577357769012451
Epoch: 26, Steps: 267 | Train Loss: 0.3192689 Vali Loss: 0.1638160 Test Loss: 0.2319298
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2859501
	speed: 0.0424s/iter; left time: 834.1924s
	iters: 200, epoch: 27 | loss: 0.2548846
	speed: 0.0076s/iter; left time: 149.2993s
Epoch: 27 cost time: 2.536722421646118
Epoch: 27, Steps: 267 | Train Loss: 0.3193707 Vali Loss: 0.1637814 Test Loss: 0.2319606
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3146505
	speed: 0.0429s/iter; left time: 832.8477s
	iters: 200, epoch: 28 | loss: 0.4527356
	speed: 0.0077s/iter; left time: 147.9612s
Epoch: 28 cost time: 2.5528767108917236
Epoch: 28, Steps: 267 | Train Loss: 0.3193469 Vali Loss: 0.1636700 Test Loss: 0.2319576
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3621230
	speed: 0.0422s/iter; left time: 806.3916s
	iters: 200, epoch: 29 | loss: 0.3887653
	speed: 0.0077s/iter; left time: 147.3672s
Epoch: 29 cost time: 2.5995757579803467
Epoch: 29, Steps: 267 | Train Loss: 0.3193236 Vali Loss: 0.1638696 Test Loss: 0.2319715
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2060038
	speed: 0.0435s/iter; left time: 820.8444s
	iters: 200, epoch: 30 | loss: 0.2850192
	speed: 0.0078s/iter; left time: 145.4647s
Epoch: 30 cost time: 2.634298801422119
Epoch: 30, Steps: 267 | Train Loss: 0.3192520 Vali Loss: 0.1637592 Test Loss: 0.2319757
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3010373
	speed: 0.0484s/iter; left time: 898.8944s
	iters: 200, epoch: 31 | loss: 0.2796476
	speed: 0.0078s/iter; left time: 143.6921s
Epoch: 31 cost time: 2.8537471294403076
Epoch: 31, Steps: 267 | Train Loss: 0.3193513 Vali Loss: 0.1635997 Test Loss: 0.2319615
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3113203
	speed: 0.0464s/iter; left time: 850.8155s
	iters: 200, epoch: 32 | loss: 0.2972932
	speed: 0.0079s/iter; left time: 144.2879s
Epoch: 32 cost time: 2.806565523147583
Epoch: 32, Steps: 267 | Train Loss: 0.3192210 Vali Loss: 0.1638756 Test Loss: 0.2319586
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.23276324570178986, mae:0.29641440510749817, rse:0.39052814245224, corr:[0.56970847 0.5694727  0.56427926 0.562383   0.5626299  0.5616515
 0.559718   0.5585714  0.5582986  0.55764735 0.5563391  0.55549675
 0.55561745 0.5558071  0.5552703  0.55429035 0.55367005 0.5533704
 0.5526892  0.55145615 0.55033964 0.54990256 0.54984635 0.54954416
 0.54886746 0.5482592  0.54801476 0.5476912  0.5468714  0.5457857
 0.5450168  0.5446548  0.54420435 0.5435153  0.54296815 0.54287905
 0.54281574 0.5423289  0.5413351  0.54029655 0.53973997 0.5395917
 0.5394455  0.5390603  0.5385488  0.53810567 0.53758186 0.53679174
 0.53579766 0.5348936  0.53421986 0.5336947  0.5330745  0.5323307
 0.531673   0.53118724 0.53064096 0.530129   0.5297548  0.5295777
 0.52937466 0.5290869  0.528792   0.52859634 0.52859396 0.5286636
 0.5285068  0.5281862  0.5279531  0.5279268  0.5278619  0.52760834
 0.52728266 0.5270422  0.52700627 0.52692837 0.5266811  0.52627397
 0.5258919  0.5255498  0.52513576 0.524611   0.5241215  0.52374184
 0.5234073  0.5230344  0.5225359  0.52207357 0.52170044 0.5214004
 0.52114177 0.5208624  0.5204495  0.51983905 0.518931   0.5176393
 0.5160002  0.5142671  0.51255566 0.51095617 0.5095385  0.50831
 0.507156   0.5059668  0.50464165 0.5032906  0.5021137  0.5012203
 0.5003704  0.49922985 0.49804544 0.49694675 0.49606037 0.49522454
 0.4941721  0.49299076 0.4918249  0.49079487 0.48991585 0.4889743
 0.4879945  0.48706266 0.48627245 0.4855237  0.4846896  0.48374522
 0.4827746  0.48184362 0.48091865 0.47991535 0.47896266 0.47810656
 0.47737327 0.47653088 0.4757426  0.47517183 0.47479755 0.47462156
 0.4743452  0.47381797 0.47312477 0.47240195 0.47172064 0.47097895
 0.47017834 0.46936926 0.46848848 0.467595   0.4668464  0.46620104
 0.46572784 0.46540064 0.46486887 0.46416712 0.46358114 0.46324682
 0.46290264 0.4623527  0.46158376 0.46111196 0.46103704 0.461007
 0.46077237 0.46027288 0.46008593 0.46015644 0.46015665 0.4600125
 0.45990318 0.46014345 0.460535   0.46072966 0.46073416 0.4606253
 0.46069834 0.4606689  0.46038717 0.46004206 0.4600329  0.4604206
 0.4605833  0.4601743  0.459776   0.45984903 0.46028784 0.46043268
 0.46015742 0.46005726 0.4604345  0.46088684 0.46045265 0.45811498]
