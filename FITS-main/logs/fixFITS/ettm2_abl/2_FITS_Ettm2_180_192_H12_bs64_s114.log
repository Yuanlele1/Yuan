Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2132480.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2990094
	speed: 0.0346s/iter; left time: 921.2825s
	iters: 200, epoch: 1 | loss: 0.3714843
	speed: 0.0163s/iter; left time: 431.7677s
Epoch: 1 cost time: 7.414011240005493
Epoch: 1, Steps: 267 | Train Loss: 0.3009526 Vali Loss: 0.2117527 Test Loss: 0.2918498
Validation loss decreased (inf --> 0.211753).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2898265
	speed: 0.1078s/iter; left time: 2838.7490s
	iters: 200, epoch: 2 | loss: 0.2373836
	speed: 0.0225s/iter; left time: 590.5816s
Epoch: 2 cost time: 7.374920129776001
Epoch: 2, Steps: 267 | Train Loss: 0.2252546 Vali Loss: 0.1934566 Test Loss: 0.2703688
Validation loss decreased (0.211753 --> 0.193457).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2652711
	speed: 0.1395s/iter; left time: 3636.9055s
	iters: 200, epoch: 3 | loss: 0.1682803
	speed: 0.0315s/iter; left time: 818.8392s
Epoch: 3 cost time: 9.336169242858887
Epoch: 3, Steps: 267 | Train Loss: 0.2027517 Vali Loss: 0.1845348 Test Loss: 0.2595992
Validation loss decreased (0.193457 --> 0.184535).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1814259
	speed: 0.1226s/iter; left time: 3162.6251s
	iters: 200, epoch: 4 | loss: 0.2525422
	speed: 0.0184s/iter; left time: 473.1311s
Epoch: 4 cost time: 7.589141130447388
Epoch: 4, Steps: 267 | Train Loss: 0.1918406 Vali Loss: 0.1787952 Test Loss: 0.2523632
Validation loss decreased (0.184535 --> 0.178795).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2003045
	speed: 0.1438s/iter; left time: 3671.3319s
	iters: 200, epoch: 5 | loss: 0.1584112
	speed: 0.0288s/iter; left time: 732.3157s
Epoch: 5 cost time: 7.6607489585876465
Epoch: 5, Steps: 267 | Train Loss: 0.1851671 Vali Loss: 0.1744676 Test Loss: 0.2472133
Validation loss decreased (0.178795 --> 0.174468).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1251296
	speed: 0.1037s/iter; left time: 2621.0997s
	iters: 200, epoch: 6 | loss: 0.1833003
	speed: 0.0218s/iter; left time: 549.2454s
Epoch: 6 cost time: 6.180573463439941
Epoch: 6, Steps: 267 | Train Loss: 0.1806870 Vali Loss: 0.1717031 Test Loss: 0.2434647
Validation loss decreased (0.174468 --> 0.171703).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1889897
	speed: 0.0999s/iter; left time: 2498.4567s
	iters: 200, epoch: 7 | loss: 0.1830990
	speed: 0.0620s/iter; left time: 1544.6216s
Epoch: 7 cost time: 11.182897806167603
Epoch: 7, Steps: 267 | Train Loss: 0.1778981 Vali Loss: 0.1695315 Test Loss: 0.2406156
Validation loss decreased (0.171703 --> 0.169531).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1598180
	speed: 0.1231s/iter; left time: 3043.5311s
	iters: 200, epoch: 8 | loss: 0.1604051
	speed: 0.0338s/iter; left time: 831.8190s
Epoch: 8 cost time: 7.2020182609558105
Epoch: 8, Steps: 267 | Train Loss: 0.1758230 Vali Loss: 0.1682367 Test Loss: 0.2387393
Validation loss decreased (0.169531 --> 0.168237).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1911602
	speed: 0.1186s/iter; left time: 2901.4878s
	iters: 200, epoch: 9 | loss: 0.1731834
	speed: 0.0413s/iter; left time: 1006.9558s
Epoch: 9 cost time: 8.089646816253662
Epoch: 9, Steps: 267 | Train Loss: 0.1746022 Vali Loss: 0.1672196 Test Loss: 0.2372145
Validation loss decreased (0.168237 --> 0.167220).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1437868
	speed: 0.1311s/iter; left time: 3172.0128s
	iters: 200, epoch: 10 | loss: 0.1445275
	speed: 0.0405s/iter; left time: 975.1191s
Epoch: 10 cost time: 10.832839250564575
Epoch: 10, Steps: 267 | Train Loss: 0.1736758 Vali Loss: 0.1664100 Test Loss: 0.2362480
Validation loss decreased (0.167220 --> 0.166410).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1892104
	speed: 0.1748s/iter; left time: 4182.2381s
	iters: 200, epoch: 11 | loss: 0.1533134
	speed: 0.0206s/iter; left time: 490.3744s
Epoch: 11 cost time: 9.013848543167114
Epoch: 11, Steps: 267 | Train Loss: 0.1730172 Vali Loss: 0.1657285 Test Loss: 0.2355436
Validation loss decreased (0.166410 --> 0.165728).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1357262
	speed: 0.1508s/iter; left time: 3568.2024s
	iters: 200, epoch: 12 | loss: 0.1585918
	speed: 0.0206s/iter; left time: 484.3894s
Epoch: 12 cost time: 7.700930118560791
Epoch: 12, Steps: 267 | Train Loss: 0.1726009 Vali Loss: 0.1654042 Test Loss: 0.2349153
Validation loss decreased (0.165728 --> 0.165404).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1936263
	speed: 0.1666s/iter; left time: 3896.9936s
	iters: 200, epoch: 13 | loss: 0.1616141
	speed: 0.0177s/iter; left time: 411.8881s
Epoch: 13 cost time: 7.191326379776001
Epoch: 13, Steps: 267 | Train Loss: 0.1722846 Vali Loss: 0.1648828 Test Loss: 0.2345344
Validation loss decreased (0.165404 --> 0.164883).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2065478
	speed: 0.1213s/iter; left time: 2804.6780s
	iters: 200, epoch: 14 | loss: 0.1700327
	speed: 0.0420s/iter; left time: 966.6520s
Epoch: 14 cost time: 8.627265453338623
Epoch: 14, Steps: 267 | Train Loss: 0.1721284 Vali Loss: 0.1649647 Test Loss: 0.2341671
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2189298
	speed: 0.1467s/iter; left time: 3353.2075s
	iters: 200, epoch: 15 | loss: 0.1523949
	speed: 0.0418s/iter; left time: 951.2799s
Epoch: 15 cost time: 9.866827964782715
Epoch: 15, Steps: 267 | Train Loss: 0.1720187 Vali Loss: 0.1646210 Test Loss: 0.2339826
Validation loss decreased (0.164883 --> 0.164621).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1409736
	speed: 0.1485s/iter; left time: 3354.6912s
	iters: 200, epoch: 16 | loss: 0.1303680
	speed: 0.0444s/iter; left time: 998.6105s
Epoch: 16 cost time: 11.481265544891357
Epoch: 16, Steps: 267 | Train Loss: 0.1719258 Vali Loss: 0.1646795 Test Loss: 0.2338521
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1946168
	speed: 0.1210s/iter; left time: 2702.4389s
	iters: 200, epoch: 17 | loss: 0.1328455
	speed: 0.0244s/iter; left time: 542.3027s
Epoch: 17 cost time: 7.020737648010254
Epoch: 17, Steps: 267 | Train Loss: 0.1718296 Vali Loss: 0.1646787 Test Loss: 0.2337393
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2302968
	speed: 0.1304s/iter; left time: 2876.9576s
	iters: 200, epoch: 18 | loss: 0.1480471
	speed: 0.0347s/iter; left time: 761.0997s
Epoch: 18 cost time: 8.860493183135986
Epoch: 18, Steps: 267 | Train Loss: 0.1718064 Vali Loss: 0.1643521 Test Loss: 0.2336131
Validation loss decreased (0.164621 --> 0.164352).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2167142
	speed: 0.1270s/iter; left time: 2766.9575s
	iters: 200, epoch: 19 | loss: 0.1955640
	speed: 0.0464s/iter; left time: 1006.5314s
Epoch: 19 cost time: 9.023772239685059
Epoch: 19, Steps: 267 | Train Loss: 0.1718005 Vali Loss: 0.1645348 Test Loss: 0.2335028
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1397109
	speed: 0.1284s/iter; left time: 2763.8077s
	iters: 200, epoch: 20 | loss: 0.2690563
	speed: 0.0194s/iter; left time: 415.2296s
Epoch: 20 cost time: 8.122821569442749
Epoch: 20, Steps: 267 | Train Loss: 0.1717484 Vali Loss: 0.1644448 Test Loss: 0.2334847
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2474161
	speed: 0.1568s/iter; left time: 3334.0545s
	iters: 200, epoch: 21 | loss: 0.1574758
	speed: 0.0276s/iter; left time: 583.7237s
Epoch: 21 cost time: 8.96170711517334
Epoch: 21, Steps: 267 | Train Loss: 0.1716623 Vali Loss: 0.1645246 Test Loss: 0.2334606
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1392402
	speed: 0.1518s/iter; left time: 3186.3355s
	iters: 200, epoch: 22 | loss: 0.1657774
	speed: 0.0324s/iter; left time: 677.5047s
Epoch: 22 cost time: 10.061221599578857
Epoch: 22, Steps: 267 | Train Loss: 0.1716824 Vali Loss: 0.1644685 Test Loss: 0.2334649
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1386556
	speed: 0.1334s/iter; left time: 2764.2978s
	iters: 200, epoch: 23 | loss: 0.1800458
	speed: 0.0328s/iter; left time: 675.9955s
Epoch: 23 cost time: 10.140049695968628
Epoch: 23, Steps: 267 | Train Loss: 0.1716976 Vali Loss: 0.1645772 Test Loss: 0.2334592
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1679090
	speed: 0.1892s/iter; left time: 3871.4394s
	iters: 200, epoch: 24 | loss: 0.1391357
	speed: 0.0401s/iter; left time: 817.3513s
Epoch: 24 cost time: 9.719995737075806
Epoch: 24, Steps: 267 | Train Loss: 0.1716702 Vali Loss: 0.1645096 Test Loss: 0.2333886
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1357758
	speed: 0.1998s/iter; left time: 4035.4927s
	iters: 200, epoch: 25 | loss: 0.2415971
	speed: 0.0328s/iter; left time: 659.3297s
Epoch: 25 cost time: 10.73384690284729
Epoch: 25, Steps: 267 | Train Loss: 0.1716816 Vali Loss: 0.1643916 Test Loss: 0.2333966
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1760877
	speed: 0.1151s/iter; left time: 2293.2036s
	iters: 200, epoch: 26 | loss: 0.1854576
	speed: 0.0352s/iter; left time: 696.9090s
Epoch: 26 cost time: 9.62902569770813
Epoch: 26, Steps: 267 | Train Loss: 0.1716562 Vali Loss: 0.1645050 Test Loss: 0.2333959
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1193919
	speed: 0.1469s/iter; left time: 2887.0112s
	iters: 200, epoch: 27 | loss: 0.2531516
	speed: 0.0238s/iter; left time: 464.9840s
Epoch: 27 cost time: 7.983904838562012
Epoch: 27, Steps: 267 | Train Loss: 0.1716477 Vali Loss: 0.1643693 Test Loss: 0.2333721
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1780393
	speed: 0.1579s/iter; left time: 3062.7819s
	iters: 200, epoch: 28 | loss: 0.1544275
	speed: 0.0200s/iter; left time: 386.5685s
Epoch: 28 cost time: 7.927632093429565
Epoch: 28, Steps: 267 | Train Loss: 0.1716552 Vali Loss: 0.1644048 Test Loss: 0.2333850
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1450929
	speed: 0.1174s/iter; left time: 2245.5987s
	iters: 200, epoch: 29 | loss: 0.1811299
	speed: 0.0399s/iter; left time: 759.9391s
Epoch: 29 cost time: 10.057512998580933
Epoch: 29, Steps: 267 | Train Loss: 0.1715767 Vali Loss: 0.1644139 Test Loss: 0.2333838
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1617897
	speed: 0.1513s/iter; left time: 2853.5385s
	iters: 200, epoch: 30 | loss: 0.1650582
	speed: 0.0254s/iter; left time: 476.1801s
Epoch: 30 cost time: 7.812182903289795
Epoch: 30, Steps: 267 | Train Loss: 0.1715653 Vali Loss: 0.1644980 Test Loss: 0.2333755
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1575883
	speed: 0.1233s/iter; left time: 2291.4014s
	iters: 200, epoch: 31 | loss: 0.1745463
	speed: 0.0247s/iter; left time: 456.5309s
Epoch: 31 cost time: 7.706401348114014
Epoch: 31, Steps: 267 | Train Loss: 0.1716101 Vali Loss: 0.1644051 Test Loss: 0.2333712
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2870698
	speed: 0.1407s/iter; left time: 2578.1775s
	iters: 200, epoch: 32 | loss: 0.1448631
	speed: 0.0368s/iter; left time: 670.5384s
Epoch: 32 cost time: 8.682462692260742
Epoch: 32, Steps: 267 | Train Loss: 0.1716007 Vali Loss: 0.1645780 Test Loss: 0.2333530
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1908431
	speed: 0.1547s/iter; left time: 2793.0557s
	iters: 200, epoch: 33 | loss: 0.1247358
	speed: 0.0316s/iter; left time: 567.1370s
Epoch: 33 cost time: 10.06203818321228
Epoch: 33, Steps: 267 | Train Loss: 0.1716026 Vali Loss: 0.1643582 Test Loss: 0.2333613
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1350643
	speed: 0.1546s/iter; left time: 2750.5478s
	iters: 200, epoch: 34 | loss: 0.1340679
	speed: 0.0282s/iter; left time: 498.0321s
Epoch: 34 cost time: 7.650341033935547
Epoch: 34, Steps: 267 | Train Loss: 0.1715875 Vali Loss: 0.1644973 Test Loss: 0.2333610
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1973523
	speed: 0.1243s/iter; left time: 2177.8826s
	iters: 200, epoch: 35 | loss: 0.1144923
	speed: 0.0220s/iter; left time: 383.8521s
Epoch: 35 cost time: 7.096460580825806
Epoch: 35, Steps: 267 | Train Loss: 0.1716083 Vali Loss: 0.1645417 Test Loss: 0.2333544
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1318707
	speed: 0.1093s/iter; left time: 1885.3102s
	iters: 200, epoch: 36 | loss: 0.1821559
	speed: 0.0347s/iter; left time: 595.1878s
Epoch: 36 cost time: 10.182628870010376
Epoch: 36, Steps: 267 | Train Loss: 0.1715087 Vali Loss: 0.1643737 Test Loss: 0.2333617
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1695259
	speed: 0.1947s/iter; left time: 3307.0905s
	iters: 200, epoch: 37 | loss: 0.3258364
	speed: 0.0177s/iter; left time: 299.5432s
Epoch: 37 cost time: 6.355708360671997
Epoch: 37, Steps: 267 | Train Loss: 0.1715790 Vali Loss: 0.1644262 Test Loss: 0.2333436
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1692875
	speed: 0.1858s/iter; left time: 3107.4947s
	iters: 200, epoch: 38 | loss: 0.1442027
	speed: 0.0373s/iter; left time: 619.8221s
Epoch: 38 cost time: 10.014517068862915
Epoch: 38, Steps: 267 | Train Loss: 0.1715771 Vali Loss: 0.1644994 Test Loss: 0.2333236
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2132480.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2913051
	speed: 0.0217s/iter; left time: 578.4752s
	iters: 200, epoch: 1 | loss: 0.3534475
	speed: 0.0311s/iter; left time: 823.1318s
Epoch: 1 cost time: 6.975184440612793
Epoch: 1, Steps: 267 | Train Loss: 0.3220445 Vali Loss: 0.1641186 Test Loss: 0.2327764
Validation loss decreased (inf --> 0.164119).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3166172
	speed: 0.1284s/iter; left time: 3382.0701s
	iters: 200, epoch: 2 | loss: 0.4078817
	speed: 0.0235s/iter; left time: 616.5818s
Epoch: 2 cost time: 8.066553354263306
Epoch: 2, Steps: 267 | Train Loss: 0.3213090 Vali Loss: 0.1637931 Test Loss: 0.2326483
Validation loss decreased (0.164119 --> 0.163793).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2686908
	speed: 0.1500s/iter; left time: 3909.7266s
	iters: 200, epoch: 3 | loss: 0.3515676
	speed: 0.0387s/iter; left time: 1003.7829s
Epoch: 3 cost time: 10.873339891433716
Epoch: 3, Steps: 267 | Train Loss: 0.3209255 Vali Loss: 0.1636992 Test Loss: 0.2323186
Validation loss decreased (0.163793 --> 0.163699).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2518769
	speed: 0.1519s/iter; left time: 3919.6746s
	iters: 200, epoch: 4 | loss: 0.3428524
	speed: 0.0201s/iter; left time: 516.8172s
Epoch: 4 cost time: 6.796082258224487
Epoch: 4, Steps: 267 | Train Loss: 0.3206606 Vali Loss: 0.1638065 Test Loss: 0.2323376
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3087632
	speed: 0.1623s/iter; left time: 4144.9421s
	iters: 200, epoch: 5 | loss: 0.2652039
	speed: 0.0260s/iter; left time: 660.9027s
Epoch: 5 cost time: 7.140977144241333
Epoch: 5, Steps: 267 | Train Loss: 0.3204428 Vali Loss: 0.1637569 Test Loss: 0.2323871
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2262719
	speed: 0.1288s/iter; left time: 3253.3367s
	iters: 200, epoch: 6 | loss: 0.3120508
	speed: 0.0171s/iter; left time: 430.6535s
Epoch: 6 cost time: 6.963705062866211
Epoch: 6, Steps: 267 | Train Loss: 0.3203150 Vali Loss: 0.1636451 Test Loss: 0.2322306
Validation loss decreased (0.163699 --> 0.163645).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3119541
	speed: 0.1406s/iter; left time: 3514.1988s
	iters: 200, epoch: 7 | loss: 0.2122603
	speed: 0.0203s/iter; left time: 506.1094s
Epoch: 7 cost time: 9.171072483062744
Epoch: 7, Steps: 267 | Train Loss: 0.3202568 Vali Loss: 0.1635017 Test Loss: 0.2322560
Validation loss decreased (0.163645 --> 0.163502).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3491419
	speed: 0.1317s/iter; left time: 3256.5607s
	iters: 200, epoch: 8 | loss: 0.2433423
	speed: 0.0403s/iter; left time: 991.5858s
Epoch: 8 cost time: 9.584559679031372
Epoch: 8, Steps: 267 | Train Loss: 0.3200682 Vali Loss: 0.1635394 Test Loss: 0.2320986
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1849387
	speed: 0.1423s/iter; left time: 3480.3291s
	iters: 200, epoch: 9 | loss: 0.2797150
	speed: 0.0300s/iter; left time: 732.0515s
Epoch: 9 cost time: 9.247498035430908
Epoch: 9, Steps: 267 | Train Loss: 0.3200341 Vali Loss: 0.1635251 Test Loss: 0.2321212
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.6730063
	speed: 0.1194s/iter; left time: 2889.1385s
	iters: 200, epoch: 10 | loss: 0.1992852
	speed: 0.0199s/iter; left time: 480.1628s
Epoch: 10 cost time: 5.89702033996582
Epoch: 10, Steps: 267 | Train Loss: 0.3197079 Vali Loss: 0.1635944 Test Loss: 0.2319225
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2807031
	speed: 0.1166s/iter; left time: 2790.8825s
	iters: 200, epoch: 11 | loss: 0.2650191
	speed: 0.0229s/iter; left time: 545.0881s
Epoch: 11 cost time: 7.470993757247925
Epoch: 11, Steps: 267 | Train Loss: 0.3200143 Vali Loss: 0.1636417 Test Loss: 0.2320543
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2878889
	speed: 0.0996s/iter; left time: 2356.4843s
	iters: 200, epoch: 12 | loss: 0.3888758
	speed: 0.0253s/iter; left time: 596.8325s
Epoch: 12 cost time: 6.689416885375977
Epoch: 12, Steps: 267 | Train Loss: 0.3198751 Vali Loss: 0.1637393 Test Loss: 0.2320884
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2407844
	speed: 0.0985s/iter; left time: 2305.4423s
	iters: 200, epoch: 13 | loss: 0.2453581
	speed: 0.0220s/iter; left time: 512.2491s
Epoch: 13 cost time: 7.092063903808594
Epoch: 13, Steps: 267 | Train Loss: 0.3198422 Vali Loss: 0.1635528 Test Loss: 0.2319979
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.4391642
	speed: 0.1345s/iter; left time: 3111.1942s
	iters: 200, epoch: 14 | loss: 0.3112112
	speed: 0.0356s/iter; left time: 820.6354s
Epoch: 14 cost time: 9.769834518432617
Epoch: 14, Steps: 267 | Train Loss: 0.3198366 Vali Loss: 0.1635756 Test Loss: 0.2320578
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3713992
	speed: 0.1259s/iter; left time: 2878.4448s
	iters: 200, epoch: 15 | loss: 0.3461482
	speed: 0.0198s/iter; left time: 450.5080s
Epoch: 15 cost time: 6.52515435218811
Epoch: 15, Steps: 267 | Train Loss: 0.3198035 Vali Loss: 0.1638758 Test Loss: 0.2320301
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3173773
	speed: 0.1285s/iter; left time: 2903.5761s
	iters: 200, epoch: 16 | loss: 0.3789665
	speed: 0.0407s/iter; left time: 915.3792s
Epoch: 16 cost time: 10.143041849136353
Epoch: 16, Steps: 267 | Train Loss: 0.3197043 Vali Loss: 0.1636405 Test Loss: 0.2320493
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2688603
	speed: 0.1350s/iter; left time: 3015.2068s
	iters: 200, epoch: 17 | loss: 0.4058150
	speed: 0.0207s/iter; left time: 459.5026s
Epoch: 17 cost time: 5.948750257492065
Epoch: 17, Steps: 267 | Train Loss: 0.3197037 Vali Loss: 0.1636247 Test Loss: 0.2320041
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.4643295
	speed: 0.1079s/iter; left time: 2380.6585s
	iters: 200, epoch: 18 | loss: 0.4278887
	speed: 0.0340s/iter; left time: 747.5276s
Epoch: 18 cost time: 8.517435073852539
Epoch: 18, Steps: 267 | Train Loss: 0.3197175 Vali Loss: 0.1637893 Test Loss: 0.2320875
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3511521
	speed: 0.1049s/iter; left time: 2285.4170s
	iters: 200, epoch: 19 | loss: 0.3530625
	speed: 0.0261s/iter; left time: 565.4762s
Epoch: 19 cost time: 6.579073905944824
Epoch: 19, Steps: 267 | Train Loss: 0.3196639 Vali Loss: 0.1637368 Test Loss: 0.2320155
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3503159
	speed: 0.1364s/iter; left time: 2936.8705s
	iters: 200, epoch: 20 | loss: 0.2209007
	speed: 0.0306s/iter; left time: 654.6317s
Epoch: 20 cost time: 10.923935651779175
Epoch: 20, Steps: 267 | Train Loss: 0.3195861 Vali Loss: 0.1637707 Test Loss: 0.2320414
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3317094
	speed: 0.1650s/iter; left time: 3508.4661s
	iters: 200, epoch: 21 | loss: 0.2801678
	speed: 0.0331s/iter; left time: 699.5545s
Epoch: 21 cost time: 8.586091995239258
Epoch: 21, Steps: 267 | Train Loss: 0.3196769 Vali Loss: 0.1637861 Test Loss: 0.2320480
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3733078
	speed: 0.1338s/iter; left time: 2808.3463s
	iters: 200, epoch: 22 | loss: 0.3299375
	speed: 0.0181s/iter; left time: 377.8702s
Epoch: 22 cost time: 6.696532726287842
Epoch: 22, Steps: 267 | Train Loss: 0.3195174 Vali Loss: 0.1637728 Test Loss: 0.2320802
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1555659
	speed: 0.1117s/iter; left time: 2315.8662s
	iters: 200, epoch: 23 | loss: 0.4117679
	speed: 0.0177s/iter; left time: 365.8330s
Epoch: 23 cost time: 6.823450565338135
Epoch: 23, Steps: 267 | Train Loss: 0.3196195 Vali Loss: 0.1637225 Test Loss: 0.2320372
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2182577
	speed: 0.1150s/iter; left time: 2352.4769s
	iters: 200, epoch: 24 | loss: 0.4432968
	speed: 0.0242s/iter; left time: 491.8629s
Epoch: 24 cost time: 7.047475576400757
Epoch: 24, Steps: 267 | Train Loss: 0.3195272 Vali Loss: 0.1636375 Test Loss: 0.2320593
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3428639
	speed: 0.1371s/iter; left time: 2768.9852s
	iters: 200, epoch: 25 | loss: 0.3395260
	speed: 0.0329s/iter; left time: 661.0664s
Epoch: 25 cost time: 9.92777395248413
Epoch: 25, Steps: 267 | Train Loss: 0.3196356 Vali Loss: 0.1637348 Test Loss: 0.2320620
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3649978
	speed: 0.1318s/iter; left time: 2625.6643s
	iters: 200, epoch: 26 | loss: 0.2461277
	speed: 0.0248s/iter; left time: 492.5935s
Epoch: 26 cost time: 7.820374250411987
Epoch: 26, Steps: 267 | Train Loss: 0.3195808 Vali Loss: 0.1636345 Test Loss: 0.2320783
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2792679
	speed: 0.1503s/iter; left time: 2953.8471s
	iters: 200, epoch: 27 | loss: 0.3442053
	speed: 0.0231s/iter; left time: 451.7474s
Epoch: 27 cost time: 7.109861373901367
Epoch: 27, Steps: 267 | Train Loss: 0.3196185 Vali Loss: 0.1637617 Test Loss: 0.2320229
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_192_FITS_ETTm2_ftM_sl180_ll48_pl192_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2330421656370163, mae:0.296627402305603, rse:0.3907620310783386, corr:[0.56767255 0.5692995  0.56495076 0.5620392  0.56185573 0.5618027
 0.56024873 0.5580484  0.5568728  0.55687773 0.5568737  0.55612034
 0.55504507 0.5545382  0.5546972  0.5547025  0.5539739  0.5527619
 0.5518412  0.5515157  0.5513409  0.5507736  0.5498555  0.5490901
 0.54875696 0.54860264 0.5482485  0.54755646 0.54679024 0.54622805
 0.5458723  0.54548967 0.544862   0.54413724 0.54360026 0.5433142
 0.54292333 0.542222   0.54126656 0.5403675  0.5398159  0.5395577
 0.53934187 0.5389834  0.53852326 0.53810865 0.5376649  0.5370194
 0.5360821  0.5350069  0.5340532  0.5334072  0.5329177  0.5323688
 0.5317792  0.5312864  0.5308372  0.53047544 0.53013223 0.5298229
 0.5295176  0.5293339  0.5292312  0.52905566 0.5288207  0.5286277
 0.5284472  0.5282888  0.5281235  0.5279755  0.52781665 0.52766913
 0.5275372  0.52734894 0.5271665  0.5269356  0.52668375 0.52635854
 0.52599084 0.52557355 0.52510905 0.52461886 0.5241744  0.52377224
 0.52337116 0.52295893 0.52248096 0.522056   0.52168554 0.5213623
 0.52110755 0.5208508  0.5204343  0.5197748  0.5187811  0.5174176
 0.5157556  0.51404667 0.5123402  0.51066357 0.5091364  0.5078444
 0.5067084  0.50558466 0.50435084 0.5030797  0.50188595 0.5008442
 0.4998364  0.49868047 0.49760744 0.49665073 0.49583843 0.49499968
 0.49396828 0.49285868 0.4917806  0.49078926 0.48988873 0.4889148
 0.48788574 0.48688087 0.48601672 0.48527545 0.48457226 0.48379442
 0.48288837 0.48190925 0.4809208  0.47992107 0.47901604 0.47818938
 0.47746417 0.47672823 0.47612986 0.47568807 0.47523016 0.47475392
 0.47417876 0.4735547  0.47295108 0.47240672 0.4719237  0.47135088
 0.47059435 0.46969023 0.46869144 0.4677416  0.4669362  0.46610874
 0.46532747 0.4648084  0.46440935 0.4640149  0.46354246 0.4629943
 0.4624165  0.46188903 0.46129808 0.46082577 0.46054253 0.4604336
 0.46043682 0.4602544  0.46008167 0.45992342 0.4598542  0.4599464
 0.46006632 0.46016625 0.46022442 0.4603374  0.46058613 0.46069145
 0.46063906 0.46037897 0.4601559  0.46009815 0.46014652 0.46021262
 0.4600779  0.4597686  0.45964608 0.45971552 0.45988137 0.45980227
 0.45952368 0.4594809  0.45987484 0.46046236 0.46026152 0.45787677]
