Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=38, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=38, out_features=58, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1974784.0
params:  2262.0
Trainable parameters:  2262
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1617191
	speed: 0.0119s/iter; left time: 315.5654s
	iters: 200, epoch: 1 | loss: 0.1463805
	speed: 0.0070s/iter; left time: 186.7963s
Epoch: 1 cost time: 2.3723623752593994
Epoch: 1, Steps: 267 | Train Loss: 0.2040465 Vali Loss: 0.1607187 Test Loss: 0.2252278
Validation loss decreased (inf --> 0.160719).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1461149
	speed: 0.0396s/iter; left time: 1043.4347s
	iters: 200, epoch: 2 | loss: 0.1132040
	speed: 0.0068s/iter; left time: 179.6799s
Epoch: 2 cost time: 2.2914130687713623
Epoch: 2, Steps: 267 | Train Loss: 0.1345990 Vali Loss: 0.1467066 Test Loss: 0.2070991
Validation loss decreased (0.160719 --> 0.146707).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1162674
	speed: 0.0405s/iter; left time: 1056.9507s
	iters: 200, epoch: 3 | loss: 0.1293406
	speed: 0.0082s/iter; left time: 214.1019s
Epoch: 3 cost time: 2.7566211223602295
Epoch: 3, Steps: 267 | Train Loss: 0.1134930 Vali Loss: 0.1394227 Test Loss: 0.1973804
Validation loss decreased (0.146707 --> 0.139423).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0848110
	speed: 0.0467s/iter; left time: 1204.6653s
	iters: 200, epoch: 4 | loss: 0.1255598
	speed: 0.0084s/iter; left time: 215.3867s
Epoch: 4 cost time: 3.178354501724243
Epoch: 4, Steps: 267 | Train Loss: 0.1032174 Vali Loss: 0.1342665 Test Loss: 0.1902321
Validation loss decreased (0.139423 --> 0.134266).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0991207
	speed: 0.0454s/iter; left time: 1158.2969s
	iters: 200, epoch: 5 | loss: 0.0864359
	speed: 0.0075s/iter; left time: 191.0014s
Epoch: 5 cost time: 2.592242479324341
Epoch: 5, Steps: 267 | Train Loss: 0.0971066 Vali Loss: 0.1308717 Test Loss: 0.1853667
Validation loss decreased (0.134266 --> 0.130872).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0779981
	speed: 0.0403s/iter; left time: 1018.3739s
	iters: 200, epoch: 6 | loss: 0.0778763
	speed: 0.0069s/iter; left time: 172.7005s
Epoch: 6 cost time: 2.367046356201172
Epoch: 6, Steps: 267 | Train Loss: 0.0932771 Vali Loss: 0.1287945 Test Loss: 0.1820482
Validation loss decreased (0.130872 --> 0.128794).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1372909
	speed: 0.0448s/iter; left time: 1119.7124s
	iters: 200, epoch: 7 | loss: 0.1095959
	speed: 0.0076s/iter; left time: 189.8702s
Epoch: 7 cost time: 2.582659959793091
Epoch: 7, Steps: 267 | Train Loss: 0.0907577 Vali Loss: 0.1273072 Test Loss: 0.1798281
Validation loss decreased (0.128794 --> 0.127307).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1019280
	speed: 0.0429s/iter; left time: 1061.2111s
	iters: 200, epoch: 8 | loss: 0.1016150
	speed: 0.0080s/iter; left time: 197.7125s
Epoch: 8 cost time: 2.7263693809509277
Epoch: 8, Steps: 267 | Train Loss: 0.0893889 Vali Loss: 0.1263252 Test Loss: 0.1781681
Validation loss decreased (0.127307 --> 0.126325).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0977756
	speed: 0.0422s/iter; left time: 1031.5033s
	iters: 200, epoch: 9 | loss: 0.0661138
	speed: 0.0080s/iter; left time: 195.3018s
Epoch: 9 cost time: 2.7268178462982178
Epoch: 9, Steps: 267 | Train Loss: 0.0884256 Vali Loss: 0.1257511 Test Loss: 0.1770923
Validation loss decreased (0.126325 --> 0.125751).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0637858
	speed: 0.0421s/iter; left time: 1017.5664s
	iters: 200, epoch: 10 | loss: 0.0918713
	speed: 0.0076s/iter; left time: 183.1810s
Epoch: 10 cost time: 2.5189108848571777
Epoch: 10, Steps: 267 | Train Loss: 0.0877759 Vali Loss: 0.1251832 Test Loss: 0.1762749
Validation loss decreased (0.125751 --> 0.125183).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0699910
	speed: 0.0453s/iter; left time: 1083.7358s
	iters: 200, epoch: 11 | loss: 0.0768448
	speed: 0.0081s/iter; left time: 192.7741s
Epoch: 11 cost time: 2.781477212905884
Epoch: 11, Steps: 267 | Train Loss: 0.0874331 Vali Loss: 0.1250552 Test Loss: 0.1760804
Validation loss decreased (0.125183 --> 0.125055).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0830203
	speed: 0.0431s/iter; left time: 1019.0544s
	iters: 200, epoch: 12 | loss: 0.0845487
	speed: 0.0071s/iter; left time: 166.7850s
Epoch: 12 cost time: 2.4399003982543945
Epoch: 12, Steps: 267 | Train Loss: 0.0873902 Vali Loss: 0.1249284 Test Loss: 0.1756186
Validation loss decreased (0.125055 --> 0.124928).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1097521
	speed: 0.0424s/iter; left time: 993.1798s
	iters: 200, epoch: 13 | loss: 0.0934618
	speed: 0.0086s/iter; left time: 200.3342s
Epoch: 13 cost time: 2.8313357830047607
Epoch: 13, Steps: 267 | Train Loss: 0.0870889 Vali Loss: 0.1248676 Test Loss: 0.1754957
Validation loss decreased (0.124928 --> 0.124868).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1258530
	speed: 0.0441s/iter; left time: 1020.5529s
	iters: 200, epoch: 14 | loss: 0.0847595
	speed: 0.0082s/iter; left time: 188.8234s
Epoch: 14 cost time: 2.754199981689453
Epoch: 14, Steps: 267 | Train Loss: 0.0869602 Vali Loss: 0.1249106 Test Loss: 0.1755207
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1106934
	speed: 0.0468s/iter; left time: 1070.5445s
	iters: 200, epoch: 15 | loss: 0.0643860
	speed: 0.0070s/iter; left time: 159.2365s
Epoch: 15 cost time: 2.519470691680908
Epoch: 15, Steps: 267 | Train Loss: 0.0871339 Vali Loss: 0.1248208 Test Loss: 0.1754067
Validation loss decreased (0.124868 --> 0.124821).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0728931
	speed: 0.0457s/iter; left time: 1032.3430s
	iters: 200, epoch: 16 | loss: 0.1021064
	speed: 0.0086s/iter; left time: 193.9940s
Epoch: 16 cost time: 2.969062566757202
Epoch: 16, Steps: 267 | Train Loss: 0.0868932 Vali Loss: 0.1246838 Test Loss: 0.1752558
Validation loss decreased (0.124821 --> 0.124684).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1068145
	speed: 0.0763s/iter; left time: 1704.5840s
	iters: 200, epoch: 17 | loss: 0.0836521
	speed: 0.0096s/iter; left time: 213.7223s
Epoch: 17 cost time: 3.752403497695923
Epoch: 17, Steps: 267 | Train Loss: 0.0870553 Vali Loss: 0.1248429 Test Loss: 0.1752906
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1015216
	speed: 0.0484s/iter; left time: 1067.9676s
	iters: 200, epoch: 18 | loss: 0.0880924
	speed: 0.0073s/iter; left time: 160.0622s
Epoch: 18 cost time: 2.520810842514038
Epoch: 18, Steps: 267 | Train Loss: 0.0870437 Vali Loss: 0.1248158 Test Loss: 0.1752860
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0993014
	speed: 0.0420s/iter; left time: 915.6842s
	iters: 200, epoch: 19 | loss: 0.0924644
	speed: 0.0075s/iter; left time: 162.8635s
Epoch: 19 cost time: 2.690542459487915
Epoch: 19, Steps: 267 | Train Loss: 0.0870441 Vali Loss: 0.1248169 Test Loss: 0.1753443
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1059839
	speed: 0.0413s/iter; left time: 888.4519s
	iters: 200, epoch: 20 | loss: 0.1055577
	speed: 0.0082s/iter; left time: 175.3451s
Epoch: 20 cost time: 2.6576597690582275
Epoch: 20, Steps: 267 | Train Loss: 0.0869965 Vali Loss: 0.1248830 Test Loss: 0.1752820
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0818161
	speed: 0.0451s/iter; left time: 958.8228s
	iters: 200, epoch: 21 | loss: 0.0719063
	speed: 0.0085s/iter; left time: 180.7078s
Epoch: 21 cost time: 2.7829904556274414
Epoch: 21, Steps: 267 | Train Loss: 0.0869000 Vali Loss: 0.1248790 Test Loss: 0.1752894
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0964365
	speed: 0.0452s/iter; left time: 949.4720s
	iters: 200, epoch: 22 | loss: 0.0807724
	speed: 0.0072s/iter; left time: 150.6235s
Epoch: 22 cost time: 2.3829097747802734
Epoch: 22, Steps: 267 | Train Loss: 0.0870049 Vali Loss: 0.1248900 Test Loss: 0.1753495
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0724363
	speed: 0.0419s/iter; left time: 868.7367s
	iters: 200, epoch: 23 | loss: 0.0658451
	speed: 0.0075s/iter; left time: 155.2984s
Epoch: 23 cost time: 2.521477222442627
Epoch: 23, Steps: 267 | Train Loss: 0.0870222 Vali Loss: 0.1248948 Test Loss: 0.1753671
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0644730
	speed: 0.0412s/iter; left time: 842.5369s
	iters: 200, epoch: 24 | loss: 0.1032424
	speed: 0.0072s/iter; left time: 146.2178s
Epoch: 24 cost time: 2.5645203590393066
Epoch: 24, Steps: 267 | Train Loss: 0.0870794 Vali Loss: 0.1249234 Test Loss: 0.1752595
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0870739
	speed: 0.0405s/iter; left time: 817.6441s
	iters: 200, epoch: 25 | loss: 0.0752098
	speed: 0.0072s/iter; left time: 143.8417s
Epoch: 25 cost time: 2.5084853172302246
Epoch: 25, Steps: 267 | Train Loss: 0.0870128 Vali Loss: 0.1248675 Test Loss: 0.1752719
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0828911
	speed: 0.0437s/iter; left time: 870.5249s
	iters: 200, epoch: 26 | loss: 0.0684036
	speed: 0.0072s/iter; left time: 143.4191s
Epoch: 26 cost time: 2.5346319675445557
Epoch: 26, Steps: 267 | Train Loss: 0.0870159 Vali Loss: 0.1249225 Test Loss: 0.1752699
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0624965
	speed: 0.0424s/iter; left time: 832.8507s
	iters: 200, epoch: 27 | loss: 0.1051059
	speed: 0.0076s/iter; left time: 149.0451s
Epoch: 27 cost time: 2.599285364151001
Epoch: 27, Steps: 267 | Train Loss: 0.0869075 Vali Loss: 0.1248613 Test Loss: 0.1752042
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0628323
	speed: 0.0405s/iter; left time: 785.8915s
	iters: 200, epoch: 28 | loss: 0.0683093
	speed: 0.0070s/iter; left time: 134.7423s
Epoch: 28 cost time: 2.551398754119873
Epoch: 28, Steps: 267 | Train Loss: 0.0870627 Vali Loss: 0.1249018 Test Loss: 0.1752367
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0842832
	speed: 0.0386s/iter; left time: 738.9058s
	iters: 200, epoch: 29 | loss: 0.0669342
	speed: 0.0070s/iter; left time: 134.0121s
Epoch: 29 cost time: 2.361511468887329
Epoch: 29, Steps: 267 | Train Loss: 0.0869076 Vali Loss: 0.1247814 Test Loss: 0.1752144
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1005978
	speed: 0.0394s/iter; left time: 743.8515s
	iters: 200, epoch: 30 | loss: 0.0639684
	speed: 0.0071s/iter; left time: 132.3869s
Epoch: 30 cost time: 2.416569471359253
Epoch: 30, Steps: 267 | Train Loss: 0.0868781 Vali Loss: 0.1248191 Test Loss: 0.1752107
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1186956
	speed: 0.0408s/iter; left time: 758.4424s
	iters: 200, epoch: 31 | loss: 0.0994982
	speed: 0.0070s/iter; left time: 128.6674s
Epoch: 31 cost time: 2.42570161819458
Epoch: 31, Steps: 267 | Train Loss: 0.0870249 Vali Loss: 0.1249921 Test Loss: 0.1752564
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0857621
	speed: 0.0403s/iter; left time: 738.5895s
	iters: 200, epoch: 32 | loss: 0.0863829
	speed: 0.0070s/iter; left time: 127.5714s
Epoch: 32 cost time: 2.430269479751587
Epoch: 32, Steps: 267 | Train Loss: 0.0869115 Vali Loss: 0.1248759 Test Loss: 0.1753244
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0714548
	speed: 0.0427s/iter; left time: 770.5693s
	iters: 200, epoch: 33 | loss: 0.1037200
	speed: 0.0081s/iter; left time: 145.0550s
Epoch: 33 cost time: 2.672867774963379
Epoch: 33, Steps: 267 | Train Loss: 0.0870031 Vali Loss: 0.1248151 Test Loss: 0.1752365
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0987887
	speed: 0.0525s/iter; left time: 934.0083s
	iters: 200, epoch: 34 | loss: 0.0895728
	speed: 0.0085s/iter; left time: 150.3568s
Epoch: 34 cost time: 3.2481377124786377
Epoch: 34, Steps: 267 | Train Loss: 0.0870236 Vali Loss: 0.1248878 Test Loss: 0.1752391
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0998074
	speed: 0.0429s/iter; left time: 751.2101s
	iters: 200, epoch: 35 | loss: 0.0904308
	speed: 0.0080s/iter; left time: 139.9518s
Epoch: 35 cost time: 2.7270100116729736
Epoch: 35, Steps: 267 | Train Loss: 0.0868352 Vali Loss: 0.1249167 Test Loss: 0.1752652
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1061758
	speed: 0.0460s/iter; left time: 793.8513s
	iters: 200, epoch: 36 | loss: 0.0778609
	speed: 0.0069s/iter; left time: 118.9044s
Epoch: 36 cost time: 2.5874977111816406
Epoch: 36, Steps: 267 | Train Loss: 0.0870187 Vali Loss: 0.1249387 Test Loss: 0.1752695
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=38, out_features=58, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1974784.0
params:  2262.0
Trainable parameters:  2262
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1805876
	speed: 0.0125s/iter; left time: 333.4704s
	iters: 200, epoch: 1 | loss: 0.2670412
	speed: 0.0069s/iter; left time: 181.6680s
Epoch: 1 cost time: 2.426640748977661
Epoch: 1, Steps: 267 | Train Loss: 0.2314360 Vali Loss: 0.1240904 Test Loss: 0.1742649
Validation loss decreased (inf --> 0.124090).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2045991
	speed: 0.0398s/iter; left time: 1047.1529s
	iters: 200, epoch: 2 | loss: 0.2147105
	speed: 0.0069s/iter; left time: 180.5909s
Epoch: 2 cost time: 2.4298412799835205
Epoch: 2, Steps: 267 | Train Loss: 0.2305555 Vali Loss: 0.1237761 Test Loss: 0.1734484
Validation loss decreased (0.124090 --> 0.123776).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2127503
	speed: 0.0537s/iter; left time: 1399.1990s
	iters: 200, epoch: 3 | loss: 0.2720351
	speed: 0.0105s/iter; left time: 273.4303s
Epoch: 3 cost time: 3.4841959476470947
Epoch: 3, Steps: 267 | Train Loss: 0.2297869 Vali Loss: 0.1235603 Test Loss: 0.1734177
Validation loss decreased (0.123776 --> 0.123560).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2235828
	speed: 0.0487s/iter; left time: 1257.6297s
	iters: 200, epoch: 4 | loss: 0.1786761
	speed: 0.0094s/iter; left time: 242.3613s
Epoch: 4 cost time: 3.0989787578582764
Epoch: 4, Steps: 267 | Train Loss: 0.2293038 Vali Loss: 0.1233934 Test Loss: 0.1732469
Validation loss decreased (0.123560 --> 0.123393).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2450483
	speed: 0.0467s/iter; left time: 1192.0491s
	iters: 200, epoch: 5 | loss: 0.1663338
	speed: 0.0087s/iter; left time: 222.2146s
Epoch: 5 cost time: 4.738105297088623
Epoch: 5, Steps: 267 | Train Loss: 0.2288454 Vali Loss: 0.1231924 Test Loss: 0.1727884
Validation loss decreased (0.123393 --> 0.123192).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1918653
	speed: 0.0681s/iter; left time: 1721.7174s
	iters: 200, epoch: 6 | loss: 0.2029495
	speed: 0.0085s/iter; left time: 215.1071s
Epoch: 6 cost time: 3.454972982406616
Epoch: 6, Steps: 267 | Train Loss: 0.2289052 Vali Loss: 0.1231929 Test Loss: 0.1728690
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1543067
	speed: 0.0458s/iter; left time: 1144.2711s
	iters: 200, epoch: 7 | loss: 0.3030578
	speed: 0.0073s/iter; left time: 181.1937s
Epoch: 7 cost time: 2.461263418197632
Epoch: 7, Steps: 267 | Train Loss: 0.2287581 Vali Loss: 0.1231423 Test Loss: 0.1728695
Validation loss decreased (0.123192 --> 0.123142).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2095526
	speed: 0.0426s/iter; left time: 1052.9554s
	iters: 200, epoch: 8 | loss: 0.1911890
	speed: 0.0073s/iter; left time: 179.2405s
Epoch: 8 cost time: 2.4383609294891357
Epoch: 8, Steps: 267 | Train Loss: 0.2284494 Vali Loss: 0.1230264 Test Loss: 0.1726307
Validation loss decreased (0.123142 --> 0.123026).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2683543
	speed: 0.0422s/iter; left time: 1032.9896s
	iters: 200, epoch: 9 | loss: 0.2276268
	speed: 0.0072s/iter; left time: 174.7758s
Epoch: 9 cost time: 2.521214008331299
Epoch: 9, Steps: 267 | Train Loss: 0.2286670 Vali Loss: 0.1231510 Test Loss: 0.1728591
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1820100
	speed: 0.0482s/iter; left time: 1167.1246s
	iters: 200, epoch: 10 | loss: 0.1982720
	speed: 0.0123s/iter; left time: 295.5286s
Epoch: 10 cost time: 3.464277505874634
Epoch: 10, Steps: 267 | Train Loss: 0.2287366 Vali Loss: 0.1231704 Test Loss: 0.1726196
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2047723
	speed: 0.0449s/iter; left time: 1075.3395s
	iters: 200, epoch: 11 | loss: 0.2194340
	speed: 0.0068s/iter; left time: 161.2930s
Epoch: 11 cost time: 2.3327949047088623
Epoch: 11, Steps: 267 | Train Loss: 0.2282796 Vali Loss: 0.1229746 Test Loss: 0.1725614
Validation loss decreased (0.123026 --> 0.122975).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2303601
	speed: 0.0432s/iter; left time: 1022.7651s
	iters: 200, epoch: 12 | loss: 0.2542998
	speed: 0.0082s/iter; left time: 193.6197s
Epoch: 12 cost time: 2.795994281768799
Epoch: 12, Steps: 267 | Train Loss: 0.2283298 Vali Loss: 0.1229506 Test Loss: 0.1725673
Validation loss decreased (0.122975 --> 0.122951).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2845418
	speed: 0.0428s/iter; left time: 1001.3069s
	iters: 200, epoch: 13 | loss: 0.3645523
	speed: 0.0069s/iter; left time: 161.7932s
Epoch: 13 cost time: 2.488874912261963
Epoch: 13, Steps: 267 | Train Loss: 0.2286299 Vali Loss: 0.1230527 Test Loss: 0.1724144
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1911675
	speed: 0.0398s/iter; left time: 920.2608s
	iters: 200, epoch: 14 | loss: 0.2423706
	speed: 0.0069s/iter; left time: 159.5870s
Epoch: 14 cost time: 2.457279920578003
Epoch: 14, Steps: 267 | Train Loss: 0.2282014 Vali Loss: 0.1231578 Test Loss: 0.1725693
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1674032
	speed: 0.0387s/iter; left time: 883.8124s
	iters: 200, epoch: 15 | loss: 0.2831241
	speed: 0.0069s/iter; left time: 157.7821s
Epoch: 15 cost time: 2.3589470386505127
Epoch: 15, Steps: 267 | Train Loss: 0.2285052 Vali Loss: 0.1231239 Test Loss: 0.1726715
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3301504
	speed: 0.0432s/iter; left time: 975.8530s
	iters: 200, epoch: 16 | loss: 0.2449700
	speed: 0.0084s/iter; left time: 188.2938s
Epoch: 16 cost time: 2.929877996444702
Epoch: 16, Steps: 267 | Train Loss: 0.2284766 Vali Loss: 0.1231154 Test Loss: 0.1726461
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2053753
	speed: 0.0548s/iter; left time: 1224.1288s
	iters: 200, epoch: 17 | loss: 0.1586456
	speed: 0.0105s/iter; left time: 232.2949s
Epoch: 17 cost time: 3.329068660736084
Epoch: 17, Steps: 267 | Train Loss: 0.2284845 Vali Loss: 0.1230640 Test Loss: 0.1726542
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1759201
	speed: 0.0448s/iter; left time: 989.3477s
	iters: 200, epoch: 18 | loss: 0.2537854
	speed: 0.0072s/iter; left time: 159.1159s
Epoch: 18 cost time: 2.490621328353882
Epoch: 18, Steps: 267 | Train Loss: 0.2283518 Vali Loss: 0.1230070 Test Loss: 0.1726150
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3009551
	speed: 0.0469s/iter; left time: 1021.8414s
	iters: 200, epoch: 19 | loss: 0.1785386
	speed: 0.0083s/iter; left time: 180.6069s
Epoch: 19 cost time: 2.7808520793914795
Epoch: 19, Steps: 267 | Train Loss: 0.2280649 Vali Loss: 0.1230560 Test Loss: 0.1725104
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3005726
	speed: 0.0486s/iter; left time: 1045.6835s
	iters: 200, epoch: 20 | loss: 0.1875190
	speed: 0.0080s/iter; left time: 172.0041s
Epoch: 20 cost time: 2.6193466186523438
Epoch: 20, Steps: 267 | Train Loss: 0.2278090 Vali Loss: 0.1230397 Test Loss: 0.1726229
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3273411
	speed: 0.0406s/iter; left time: 862.2649s
	iters: 200, epoch: 21 | loss: 0.2967741
	speed: 0.0106s/iter; left time: 223.8170s
Epoch: 21 cost time: 2.8126564025878906
Epoch: 21, Steps: 267 | Train Loss: 0.2282836 Vali Loss: 0.1230864 Test Loss: 0.1725660
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2558680
	speed: 0.0409s/iter; left time: 859.5255s
	iters: 200, epoch: 22 | loss: 0.2516716
	speed: 0.0069s/iter; left time: 144.1039s
Epoch: 22 cost time: 2.4173402786254883
Epoch: 22, Steps: 267 | Train Loss: 0.2280564 Vali Loss: 0.1230786 Test Loss: 0.1725062
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2193952
	speed: 0.0421s/iter; left time: 873.3270s
	iters: 200, epoch: 23 | loss: 0.2258232
	speed: 0.0068s/iter; left time: 139.4563s
Epoch: 23 cost time: 2.4420652389526367
Epoch: 23, Steps: 267 | Train Loss: 0.2282540 Vali Loss: 0.1230248 Test Loss: 0.1725808
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1836921
	speed: 0.0397s/iter; left time: 812.4217s
	iters: 200, epoch: 24 | loss: 0.1879210
	speed: 0.0068s/iter; left time: 137.6323s
Epoch: 24 cost time: 2.4445536136627197
Epoch: 24, Steps: 267 | Train Loss: 0.2276636 Vali Loss: 0.1230065 Test Loss: 0.1725481
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3621447
	speed: 0.0397s/iter; left time: 801.8881s
	iters: 200, epoch: 25 | loss: 0.2146048
	speed: 0.0071s/iter; left time: 142.7341s
Epoch: 25 cost time: 2.4332520961761475
Epoch: 25, Steps: 267 | Train Loss: 0.2283430 Vali Loss: 0.1231078 Test Loss: 0.1725522
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2557387
	speed: 0.0405s/iter; left time: 807.8150s
	iters: 200, epoch: 26 | loss: 0.2165006
	speed: 0.0070s/iter; left time: 139.7563s
Epoch: 26 cost time: 2.5526909828186035
Epoch: 26, Steps: 267 | Train Loss: 0.2278123 Vali Loss: 0.1231583 Test Loss: 0.1726535
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2539003
	speed: 0.0451s/iter; left time: 885.8519s
	iters: 200, epoch: 27 | loss: 0.2641460
	speed: 0.0083s/iter; left time: 163.3143s
Epoch: 27 cost time: 2.8118159770965576
Epoch: 27, Steps: 267 | Train Loss: 0.2278638 Vali Loss: 0.1230929 Test Loss: 0.1725622
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2628159
	speed: 0.0459s/iter; left time: 890.5444s
	iters: 200, epoch: 28 | loss: 0.2473661
	speed: 0.0088s/iter; left time: 170.3680s
Epoch: 28 cost time: 2.939487934112549
Epoch: 28, Steps: 267 | Train Loss: 0.2280751 Vali Loss: 0.1230641 Test Loss: 0.1725693
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2757733
	speed: 0.0432s/iter; left time: 825.6987s
	iters: 200, epoch: 29 | loss: 0.2444339
	speed: 0.0101s/iter; left time: 191.6839s
Epoch: 29 cost time: 3.0925800800323486
Epoch: 29, Steps: 267 | Train Loss: 0.2279083 Vali Loss: 0.1231255 Test Loss: 0.1725742
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2543143
	speed: 0.0476s/iter; left time: 897.0659s
	iters: 200, epoch: 30 | loss: 0.1959277
	speed: 0.0087s/iter; left time: 163.0395s
Epoch: 30 cost time: 2.73458194732666
Epoch: 30, Steps: 267 | Train Loss: 0.2280817 Vali Loss: 0.1231248 Test Loss: 0.1725253
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1554653
	speed: 0.0529s/iter; left time: 984.0496s
	iters: 200, epoch: 31 | loss: 0.2687676
	speed: 0.0084s/iter; left time: 154.6415s
Epoch: 31 cost time: 3.6828341484069824
Epoch: 31, Steps: 267 | Train Loss: 0.2279342 Vali Loss: 0.1230271 Test Loss: 0.1725529
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1567183
	speed: 0.0485s/iter; left time: 888.0234s
	iters: 200, epoch: 32 | loss: 0.2824592
	speed: 0.0100s/iter; left time: 181.8155s
Epoch: 32 cost time: 3.1241977214813232
Epoch: 32, Steps: 267 | Train Loss: 0.2278920 Vali Loss: 0.1231434 Test Loss: 0.1725347
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.17331528663635254, mae:0.25873228907585144, rse:0.3375317454338074, corr:[0.5736441  0.5729824  0.567789   0.56636375 0.56677175 0.56541795
 0.5630824  0.56203425 0.5622603  0.56207246 0.56098485 0.5601699
 0.5602114  0.5602384  0.5594846  0.55829793 0.5575944  0.55738044
 0.5569241  0.55596375 0.55505776 0.55467004 0.55453557 0.5541256
 0.5533531  0.55266327 0.5523844  0.55214685 0.55155057 0.5507548
 0.55017245 0.5498403  0.54933256 0.5485522  0.5478591  0.5475853
 0.5474201  0.5470138  0.5462212  0.5453261  0.544672   0.5442411
 0.54383236 0.5433904  0.54302776 0.5427689  0.5423513  0.54159874
 0.5406017  0.53967416 0.5389738  0.5384313  0.5378173  0.5371107
 0.5365145  0.5360851  0.53553516 0.5349581  0.53447133 0.53419816
 0.5339233  0.53362566 0.5333908  0.5332114  0.5331024  0.5329748
 0.5326746  0.5323867  0.5322979  0.5324033  0.5323474  0.53206444
 0.5317979  0.531641   0.5316684  0.5314905  0.5310599  0.5305481
 0.53017145 0.5298552  0.529375   0.5287693  0.5282587  0.5278653
 0.5274143  0.5268821  0.52636117 0.52615476 0.52605855 0.52575815
 0.5253829  0.5251219  0.52493554 0.524764   0.524526   0.5232685 ]
