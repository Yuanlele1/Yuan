Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=20, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=20, out_features=41, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  734720.0
params:  861.0
Trainable parameters:  861
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1933232
	speed: 0.0157s/iter; left time: 419.8336s
	iters: 200, epoch: 1 | loss: 0.2292291
	speed: 0.0100s/iter; left time: 265.5634s
Epoch: 1 cost time: 3.290060520172119
Epoch: 1, Steps: 268 | Train Loss: 0.2404082 Vali Loss: 0.1723612 Test Loss: 0.2375480
Validation loss decreased (inf --> 0.172361).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1560964
	speed: 0.0563s/iter; left time: 1488.6212s
	iters: 200, epoch: 2 | loss: 0.1859435
	speed: 0.0099s/iter; left time: 260.0999s
Epoch: 2 cost time: 3.15936541557312
Epoch: 2, Steps: 268 | Train Loss: 0.1791940 Vali Loss: 0.1578803 Test Loss: 0.2181502
Validation loss decreased (0.172361 --> 0.157880).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1563641
	speed: 0.0572s/iter; left time: 1496.9812s
	iters: 200, epoch: 3 | loss: 0.1865913
	speed: 0.0098s/iter; left time: 255.8371s
Epoch: 3 cost time: 3.1667075157165527
Epoch: 3, Steps: 268 | Train Loss: 0.1587261 Vali Loss: 0.1507656 Test Loss: 0.2089794
Validation loss decreased (0.157880 --> 0.150766).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1288460
	speed: 0.0565s/iter; left time: 1462.6617s
	iters: 200, epoch: 4 | loss: 0.1078953
	speed: 0.0098s/iter; left time: 252.5234s
Epoch: 4 cost time: 3.15573787689209
Epoch: 4, Steps: 268 | Train Loss: 0.1487139 Vali Loss: 0.1457102 Test Loss: 0.2026389
Validation loss decreased (0.150766 --> 0.145710).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1507351
	speed: 0.0578s/iter; left time: 1482.2195s
	iters: 200, epoch: 5 | loss: 0.1391534
	speed: 0.0099s/iter; left time: 251.6665s
Epoch: 5 cost time: 3.2206945419311523
Epoch: 5, Steps: 268 | Train Loss: 0.1425643 Vali Loss: 0.1416924 Test Loss: 0.1978211
Validation loss decreased (0.145710 --> 0.141692).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0925130
	speed: 0.0583s/iter; left time: 1479.2547s
	iters: 200, epoch: 6 | loss: 0.1334520
	speed: 0.0099s/iter; left time: 250.5086s
Epoch: 6 cost time: 3.173413038253784
Epoch: 6, Steps: 268 | Train Loss: 0.1382633 Vali Loss: 0.1387461 Test Loss: 0.1943466
Validation loss decreased (0.141692 --> 0.138746).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1357051
	speed: 0.0590s/iter; left time: 1480.5525s
	iters: 200, epoch: 7 | loss: 0.1141352
	speed: 0.0098s/iter; left time: 245.8202s
Epoch: 7 cost time: 3.3358685970306396
Epoch: 7, Steps: 268 | Train Loss: 0.1351967 Vali Loss: 0.1364842 Test Loss: 0.1917704
Validation loss decreased (0.138746 --> 0.136484).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1599526
	speed: 0.0585s/iter; left time: 1452.9624s
	iters: 200, epoch: 8 | loss: 0.1620421
	speed: 0.0103s/iter; left time: 254.9049s
Epoch: 8 cost time: 3.2844278812408447
Epoch: 8, Steps: 268 | Train Loss: 0.1332099 Vali Loss: 0.1347814 Test Loss: 0.1898428
Validation loss decreased (0.136484 --> 0.134781).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1069135
	speed: 0.0586s/iter; left time: 1439.0389s
	iters: 200, epoch: 9 | loss: 0.1218076
	speed: 0.0102s/iter; left time: 248.3013s
Epoch: 9 cost time: 3.236166477203369
Epoch: 9, Steps: 268 | Train Loss: 0.1319790 Vali Loss: 0.1335512 Test Loss: 0.1885566
Validation loss decreased (0.134781 --> 0.133551).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1677128
	speed: 0.0569s/iter; left time: 1381.4602s
	iters: 200, epoch: 10 | loss: 0.1036511
	speed: 0.0101s/iter; left time: 243.2531s
Epoch: 10 cost time: 3.1791160106658936
Epoch: 10, Steps: 268 | Train Loss: 0.1311072 Vali Loss: 0.1328048 Test Loss: 0.1876267
Validation loss decreased (0.133551 --> 0.132805).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1228139
	speed: 0.0569s/iter; left time: 1367.6332s
	iters: 200, epoch: 11 | loss: 0.1250163
	speed: 0.0098s/iter; left time: 234.5925s
Epoch: 11 cost time: 3.156348705291748
Epoch: 11, Steps: 268 | Train Loss: 0.1304639 Vali Loss: 0.1321827 Test Loss: 0.1869517
Validation loss decreased (0.132805 --> 0.132183).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1117981
	speed: 0.0582s/iter; left time: 1381.8529s
	iters: 200, epoch: 12 | loss: 0.0959002
	speed: 0.0098s/iter; left time: 231.1977s
Epoch: 12 cost time: 3.2491374015808105
Epoch: 12, Steps: 268 | Train Loss: 0.1301355 Vali Loss: 0.1315951 Test Loss: 0.1864143
Validation loss decreased (0.132183 --> 0.131595).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1265494
	speed: 0.0583s/iter; left time: 1369.9742s
	iters: 200, epoch: 13 | loss: 0.0928679
	speed: 0.0098s/iter; left time: 228.5168s
Epoch: 13 cost time: 3.1816208362579346
Epoch: 13, Steps: 268 | Train Loss: 0.1299293 Vali Loss: 0.1312106 Test Loss: 0.1860855
Validation loss decreased (0.131595 --> 0.131211).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1525481
	speed: 0.0571s/iter; left time: 1326.7072s
	iters: 200, epoch: 14 | loss: 0.1310695
	speed: 0.0371s/iter; left time: 857.0963s
Epoch: 14 cost time: 6.672379493713379
Epoch: 14, Steps: 268 | Train Loss: 0.1296332 Vali Loss: 0.1308837 Test Loss: 0.1858026
Validation loss decreased (0.131211 --> 0.130884).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1621096
	speed: 0.0644s/iter; left time: 1476.9070s
	iters: 200, epoch: 15 | loss: 0.1659603
	speed: 0.0099s/iter; left time: 225.8348s
Epoch: 15 cost time: 3.1624715328216553
Epoch: 15, Steps: 268 | Train Loss: 0.1295319 Vali Loss: 0.1309495 Test Loss: 0.1857643
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2249427
	speed: 0.0565s/iter; left time: 1281.6188s
	iters: 200, epoch: 16 | loss: 0.1133857
	speed: 0.0098s/iter; left time: 220.5468s
Epoch: 16 cost time: 3.2241408824920654
Epoch: 16, Steps: 268 | Train Loss: 0.1296632 Vali Loss: 0.1308357 Test Loss: 0.1856295
Validation loss decreased (0.130884 --> 0.130836).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1851866
	speed: 0.0573s/iter; left time: 1284.3374s
	iters: 200, epoch: 17 | loss: 0.1054666
	speed: 0.0099s/iter; left time: 220.4982s
Epoch: 17 cost time: 3.1510183811187744
Epoch: 17, Steps: 268 | Train Loss: 0.1295396 Vali Loss: 0.1307186 Test Loss: 0.1855634
Validation loss decreased (0.130836 --> 0.130719).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1774396
	speed: 0.0586s/iter; left time: 1298.5886s
	iters: 200, epoch: 18 | loss: 0.1267698
	speed: 0.0100s/iter; left time: 220.1839s
Epoch: 18 cost time: 3.240513324737549
Epoch: 18, Steps: 268 | Train Loss: 0.1296032 Vali Loss: 0.1306360 Test Loss: 0.1854870
Validation loss decreased (0.130719 --> 0.130636).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1241071
	speed: 0.0588s/iter; left time: 1286.9220s
	iters: 200, epoch: 19 | loss: 0.1058997
	speed: 0.0099s/iter; left time: 214.5142s
Epoch: 19 cost time: 3.212775945663452
Epoch: 19, Steps: 268 | Train Loss: 0.1294365 Vali Loss: 0.1306330 Test Loss: 0.1854519
Validation loss decreased (0.130636 --> 0.130633).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1150011
	speed: 0.0576s/iter; left time: 1245.3750s
	iters: 200, epoch: 20 | loss: 0.1225734
	speed: 0.0100s/iter; left time: 214.7421s
Epoch: 20 cost time: 3.2416210174560547
Epoch: 20, Steps: 268 | Train Loss: 0.1296047 Vali Loss: 0.1306112 Test Loss: 0.1854750
Validation loss decreased (0.130633 --> 0.130611).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1223063
	speed: 0.0605s/iter; left time: 1291.1328s
	iters: 200, epoch: 21 | loss: 0.1173744
	speed: 0.0106s/iter; left time: 225.9003s
Epoch: 21 cost time: 3.4327471256256104
Epoch: 21, Steps: 268 | Train Loss: 0.1294600 Vali Loss: 0.1306396 Test Loss: 0.1854780
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1485042
	speed: 0.0591s/iter; left time: 1245.3304s
	iters: 200, epoch: 22 | loss: 0.1291282
	speed: 0.0097s/iter; left time: 203.4587s
Epoch: 22 cost time: 3.2068417072296143
Epoch: 22, Steps: 268 | Train Loss: 0.1295948 Vali Loss: 0.1305916 Test Loss: 0.1854385
Validation loss decreased (0.130611 --> 0.130592).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1373131
	speed: 0.0575s/iter; left time: 1196.7581s
	iters: 200, epoch: 23 | loss: 0.1579937
	speed: 0.0099s/iter; left time: 205.4633s
Epoch: 23 cost time: 3.206592321395874
Epoch: 23, Steps: 268 | Train Loss: 0.1295039 Vali Loss: 0.1305900 Test Loss: 0.1854065
Validation loss decreased (0.130592 --> 0.130590).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1242585
	speed: 0.0601s/iter; left time: 1234.4388s
	iters: 200, epoch: 24 | loss: 0.1330282
	speed: 0.0099s/iter; left time: 203.2986s
Epoch: 24 cost time: 3.2815756797790527
Epoch: 24, Steps: 268 | Train Loss: 0.1293381 Vali Loss: 0.1304735 Test Loss: 0.1853916
Validation loss decreased (0.130590 --> 0.130473).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1051973
	speed: 0.0591s/iter; left time: 1197.2603s
	iters: 200, epoch: 25 | loss: 0.1516213
	speed: 0.0101s/iter; left time: 203.5059s
Epoch: 25 cost time: 3.2405552864074707
Epoch: 25, Steps: 268 | Train Loss: 0.1295899 Vali Loss: 0.1305806 Test Loss: 0.1853495
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1272267
	speed: 0.0578s/iter; left time: 1156.5788s
	iters: 200, epoch: 26 | loss: 0.1420883
	speed: 0.0099s/iter; left time: 196.6892s
Epoch: 26 cost time: 3.2088863849639893
Epoch: 26, Steps: 268 | Train Loss: 0.1294369 Vali Loss: 0.1305584 Test Loss: 0.1853793
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1115685
	speed: 0.0587s/iter; left time: 1158.0127s
	iters: 200, epoch: 27 | loss: 0.1038387
	speed: 0.0099s/iter; left time: 194.3779s
Epoch: 27 cost time: 3.267896890640259
Epoch: 27, Steps: 268 | Train Loss: 0.1295461 Vali Loss: 0.1305272 Test Loss: 0.1854068
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1332772
	speed: 0.0570s/iter; left time: 1109.3148s
	iters: 200, epoch: 28 | loss: 0.2455866
	speed: 0.0098s/iter; left time: 190.6085s
Epoch: 28 cost time: 3.139270544052124
Epoch: 28, Steps: 268 | Train Loss: 0.1294499 Vali Loss: 0.1306617 Test Loss: 0.1854575
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1203149
	speed: 0.0565s/iter; left time: 1085.0629s
	iters: 200, epoch: 29 | loss: 0.0841512
	speed: 0.0099s/iter; left time: 188.1657s
Epoch: 29 cost time: 3.1065642833709717
Epoch: 29, Steps: 268 | Train Loss: 0.1295681 Vali Loss: 0.1306211 Test Loss: 0.1854232
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1264029
	speed: 0.0561s/iter; left time: 1062.0592s
	iters: 200, epoch: 30 | loss: 0.1029349
	speed: 0.0099s/iter; left time: 186.4046s
Epoch: 30 cost time: 3.1511640548706055
Epoch: 30, Steps: 268 | Train Loss: 0.1294593 Vali Loss: 0.1305794 Test Loss: 0.1854277
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1621014
	speed: 0.0596s/iter; left time: 1112.8707s
	iters: 200, epoch: 31 | loss: 0.1306138
	speed: 0.0099s/iter; left time: 182.9780s
Epoch: 31 cost time: 3.2481329441070557
Epoch: 31, Steps: 268 | Train Loss: 0.1295083 Vali Loss: 0.1306417 Test Loss: 0.1854101
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1282543
	speed: 0.0562s/iter; left time: 1034.1679s
	iters: 200, epoch: 32 | loss: 0.2258208
	speed: 0.0103s/iter; left time: 187.5411s
Epoch: 32 cost time: 3.318819046020508
Epoch: 32, Steps: 268 | Train Loss: 0.1292940 Vali Loss: 0.1305816 Test Loss: 0.1854203
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1296987
	speed: 0.0594s/iter; left time: 1076.2233s
	iters: 200, epoch: 33 | loss: 0.1247960
	speed: 0.0101s/iter; left time: 181.1543s
Epoch: 33 cost time: 3.258453130722046
Epoch: 33, Steps: 268 | Train Loss: 0.1293518 Vali Loss: 0.1305749 Test Loss: 0.1854003
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0942494
	speed: 0.0566s/iter; left time: 1010.2676s
	iters: 200, epoch: 34 | loss: 0.1193754
	speed: 0.0097s/iter; left time: 172.8129s
Epoch: 34 cost time: 3.12516450881958
Epoch: 34, Steps: 268 | Train Loss: 0.1294573 Vali Loss: 0.1305633 Test Loss: 0.1854020
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1186871
	speed: 0.0594s/iter; left time: 1044.9779s
	iters: 200, epoch: 35 | loss: 0.1096015
	speed: 0.0100s/iter; left time: 175.4218s
Epoch: 35 cost time: 3.299161672592163
Epoch: 35, Steps: 268 | Train Loss: 0.1293472 Vali Loss: 0.1306673 Test Loss: 0.1854143
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1544862
	speed: 0.0624s/iter; left time: 1081.5788s
	iters: 200, epoch: 36 | loss: 0.0881433
	speed: 0.0100s/iter; left time: 172.6518s
Epoch: 36 cost time: 3.175124168395996
Epoch: 36, Steps: 268 | Train Loss: 0.1294213 Vali Loss: 0.1305955 Test Loss: 0.1854263
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1189229
	speed: 0.0645s/iter; left time: 1099.3816s
	iters: 200, epoch: 37 | loss: 0.1547371
	speed: 0.0098s/iter; left time: 166.4790s
Epoch: 37 cost time: 3.248417854309082
Epoch: 37, Steps: 268 | Train Loss: 0.1294862 Vali Loss: 0.1307101 Test Loss: 0.1854400
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1109475
	speed: 0.0595s/iter; left time: 999.4483s
	iters: 200, epoch: 38 | loss: 0.0889385
	speed: 0.0098s/iter; left time: 164.1713s
Epoch: 38 cost time: 3.2254791259765625
Epoch: 38, Steps: 268 | Train Loss: 0.1295607 Vali Loss: 0.1306635 Test Loss: 0.1854253
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1466094
	speed: 0.0582s/iter; left time: 960.7606s
	iters: 200, epoch: 39 | loss: 0.1161748
	speed: 0.0192s/iter; left time: 315.3443s
Epoch: 39 cost time: 4.185528755187988
Epoch: 39, Steps: 268 | Train Loss: 0.1295020 Vali Loss: 0.1306243 Test Loss: 0.1854341
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1698422
	speed: 0.0602s/iter; left time: 978.3254s
	iters: 200, epoch: 40 | loss: 0.1228706
	speed: 0.0103s/iter; left time: 165.5593s
Epoch: 40 cost time: 3.4224681854248047
Epoch: 40, Steps: 268 | Train Loss: 0.1294219 Vali Loss: 0.1306565 Test Loss: 0.1854306
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1433432
	speed: 0.0581s/iter; left time: 928.6659s
	iters: 200, epoch: 41 | loss: 0.1404413
	speed: 0.0098s/iter; left time: 155.8544s
Epoch: 41 cost time: 3.176590919494629
Epoch: 41, Steps: 268 | Train Loss: 0.1294890 Vali Loss: 0.1306444 Test Loss: 0.1854386
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1254705
	speed: 0.0579s/iter; left time: 910.4253s
	iters: 200, epoch: 42 | loss: 0.1533376
	speed: 0.0098s/iter; left time: 152.5179s
Epoch: 42 cost time: 3.159257411956787
Epoch: 42, Steps: 268 | Train Loss: 0.1295914 Vali Loss: 0.1306828 Test Loss: 0.1854523
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1892734
	speed: 0.0587s/iter; left time: 905.9422s
	iters: 200, epoch: 43 | loss: 0.0908709
	speed: 0.0100s/iter; left time: 152.8229s
Epoch: 43 cost time: 3.167741060256958
Epoch: 43, Steps: 268 | Train Loss: 0.1294093 Vali Loss: 0.1306928 Test Loss: 0.1854274
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1297868
	speed: 0.0571s/iter; left time: 866.7477s
	iters: 200, epoch: 44 | loss: 0.0835162
	speed: 0.0098s/iter; left time: 147.8467s
Epoch: 44 cost time: 3.1471943855285645
Epoch: 44, Steps: 268 | Train Loss: 0.1294818 Vali Loss: 0.1306323 Test Loss: 0.1854264
EarlyStopping counter: 20 out of 20
Early stopping
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=20, out_features=41, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  734720.0
params:  861.0
Trainable parameters:  861
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1694777
	speed: 0.0145s/iter; left time: 388.2059s
	iters: 200, epoch: 1 | loss: 0.1895325
	speed: 0.0098s/iter; left time: 261.4219s
Epoch: 1 cost time: 3.133561134338379
Epoch: 1, Steps: 268 | Train Loss: 0.2418398 Vali Loss: 0.1301570 Test Loss: 0.1848082
Validation loss decreased (inf --> 0.130157).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2061693
	speed: 0.0582s/iter; left time: 1538.6095s
	iters: 200, epoch: 2 | loss: 0.3050242
	speed: 0.0097s/iter; left time: 256.5987s
Epoch: 2 cost time: 3.842655897140503
Epoch: 2, Steps: 268 | Train Loss: 0.2414024 Vali Loss: 0.1302217 Test Loss: 0.1847157
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3250891
	speed: 0.0645s/iter; left time: 1688.8941s
	iters: 200, epoch: 3 | loss: 0.2230909
	speed: 0.0098s/iter; left time: 255.2296s
Epoch: 3 cost time: 3.293256998062134
Epoch: 3, Steps: 268 | Train Loss: 0.2409040 Vali Loss: 0.1300510 Test Loss: 0.1845618
Validation loss decreased (0.130157 --> 0.130051).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1798498
	speed: 0.0611s/iter; left time: 1581.6114s
	iters: 200, epoch: 4 | loss: 0.2282918
	speed: 0.0099s/iter; left time: 254.2506s
Epoch: 4 cost time: 3.3157241344451904
Epoch: 4, Steps: 268 | Train Loss: 0.2407889 Vali Loss: 0.1301521 Test Loss: 0.1846556
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2384765
	speed: 0.0575s/iter; left time: 1473.3703s
	iters: 200, epoch: 5 | loss: 0.3063464
	speed: 0.0099s/iter; left time: 253.3842s
Epoch: 5 cost time: 3.248220682144165
Epoch: 5, Steps: 268 | Train Loss: 0.2406164 Vali Loss: 0.1302126 Test Loss: 0.1847030
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2514077
	speed: 0.0581s/iter; left time: 1473.3838s
	iters: 200, epoch: 6 | loss: 0.2706056
	speed: 0.0100s/iter; left time: 251.8807s
Epoch: 6 cost time: 3.2299435138702393
Epoch: 6, Steps: 268 | Train Loss: 0.2409321 Vali Loss: 0.1302591 Test Loss: 0.1847177
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2805423
	speed: 0.0584s/iter; left time: 1465.1172s
	iters: 200, epoch: 7 | loss: 0.2247715
	speed: 0.0100s/iter; left time: 248.9088s
Epoch: 7 cost time: 3.252030849456787
Epoch: 7, Steps: 268 | Train Loss: 0.2407241 Vali Loss: 0.1300929 Test Loss: 0.1845449
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2614745
	speed: 0.0568s/iter; left time: 1409.7214s
	iters: 200, epoch: 8 | loss: 0.2896845
	speed: 0.0098s/iter; left time: 242.5973s
Epoch: 8 cost time: 3.183098077774048
Epoch: 8, Steps: 268 | Train Loss: 0.2406590 Vali Loss: 0.1299295 Test Loss: 0.1844908
Validation loss decreased (0.130051 --> 0.129929).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4047555
	speed: 0.0566s/iter; left time: 1389.3155s
	iters: 200, epoch: 9 | loss: 0.2627290
	speed: 0.0098s/iter; left time: 239.6913s
Epoch: 9 cost time: 3.215360403060913
Epoch: 9, Steps: 268 | Train Loss: 0.2404659 Vali Loss: 0.1301796 Test Loss: 0.1845712
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2461770
	speed: 0.0561s/iter; left time: 1361.4840s
	iters: 200, epoch: 10 | loss: 0.2249070
	speed: 0.0099s/iter; left time: 239.7596s
Epoch: 10 cost time: 3.1046042442321777
Epoch: 10, Steps: 268 | Train Loss: 0.2406422 Vali Loss: 0.1303448 Test Loss: 0.1846779
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3298708
	speed: 0.0559s/iter; left time: 1342.7628s
	iters: 200, epoch: 11 | loss: 0.1754957
	speed: 0.0097s/iter; left time: 232.3028s
Epoch: 11 cost time: 3.17899751663208
Epoch: 11, Steps: 268 | Train Loss: 0.2404232 Vali Loss: 0.1302047 Test Loss: 0.1846026
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1481710
	speed: 0.0607s/iter; left time: 1441.7520s
	iters: 200, epoch: 12 | loss: 0.3003961
	speed: 0.0400s/iter; left time: 946.2901s
Epoch: 12 cost time: 6.460204124450684
Epoch: 12, Steps: 268 | Train Loss: 0.2406542 Vali Loss: 0.1302765 Test Loss: 0.1845791
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2672810
	speed: 0.0580s/iter; left time: 1362.5712s
	iters: 200, epoch: 13 | loss: 0.1998188
	speed: 0.0100s/iter; left time: 234.6582s
Epoch: 13 cost time: 3.2007055282592773
Epoch: 13, Steps: 268 | Train Loss: 0.2402732 Vali Loss: 0.1303173 Test Loss: 0.1846330
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1912262
	speed: 0.0592s/iter; left time: 1373.5099s
	iters: 200, epoch: 14 | loss: 0.2533844
	speed: 0.0099s/iter; left time: 229.6330s
Epoch: 14 cost time: 3.2995896339416504
Epoch: 14, Steps: 268 | Train Loss: 0.2402838 Vali Loss: 0.1300682 Test Loss: 0.1844203
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2101141
	speed: 0.0588s/iter; left time: 1349.6442s
	iters: 200, epoch: 15 | loss: 0.2319858
	speed: 0.0100s/iter; left time: 227.6535s
Epoch: 15 cost time: 3.2850003242492676
Epoch: 15, Steps: 268 | Train Loss: 0.2401600 Vali Loss: 0.1301041 Test Loss: 0.1844677
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2940123
	speed: 0.0614s/iter; left time: 1391.8954s
	iters: 200, epoch: 16 | loss: 0.1652963
	speed: 0.0100s/iter; left time: 225.1311s
Epoch: 16 cost time: 3.2437350749969482
Epoch: 16, Steps: 268 | Train Loss: 0.2405751 Vali Loss: 0.1301929 Test Loss: 0.1845390
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3475818
	speed: 0.0574s/iter; left time: 1286.5184s
	iters: 200, epoch: 17 | loss: 0.3388568
	speed: 0.0097s/iter; left time: 216.8405s
Epoch: 17 cost time: 3.1010098457336426
Epoch: 17, Steps: 268 | Train Loss: 0.2405415 Vali Loss: 0.1302629 Test Loss: 0.1846127
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1937536
	speed: 0.0581s/iter; left time: 1286.3399s
	iters: 200, epoch: 18 | loss: 0.2371831
	speed: 0.0098s/iter; left time: 216.6354s
Epoch: 18 cost time: 3.1880133152008057
Epoch: 18, Steps: 268 | Train Loss: 0.2406360 Vali Loss: 0.1302763 Test Loss: 0.1846283
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2044210
	speed: 0.0568s/iter; left time: 1241.8916s
	iters: 200, epoch: 19 | loss: 0.2297029
	speed: 0.0099s/iter; left time: 215.6357s
Epoch: 19 cost time: 3.1585566997528076
Epoch: 19, Steps: 268 | Train Loss: 0.2403344 Vali Loss: 0.1302058 Test Loss: 0.1845004
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1905471
	speed: 0.0590s/iter; left time: 1274.2713s
	iters: 200, epoch: 20 | loss: 0.2525919
	speed: 0.0098s/iter; left time: 210.1902s
Epoch: 20 cost time: 3.2086384296417236
Epoch: 20, Steps: 268 | Train Loss: 0.2404657 Vali Loss: 0.1302325 Test Loss: 0.1845795
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3228279
	speed: 0.0565s/iter; left time: 1205.8371s
	iters: 200, epoch: 21 | loss: 0.1770576
	speed: 0.0098s/iter; left time: 208.7902s
Epoch: 21 cost time: 3.191357135772705
Epoch: 21, Steps: 268 | Train Loss: 0.2402809 Vali Loss: 0.1302106 Test Loss: 0.1845449
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2686250
	speed: 0.0622s/iter; left time: 1310.1706s
	iters: 200, epoch: 22 | loss: 0.3530540
	speed: 0.0098s/iter; left time: 206.1519s
Epoch: 22 cost time: 3.4507288932800293
Epoch: 22, Steps: 268 | Train Loss: 0.2405289 Vali Loss: 0.1303255 Test Loss: 0.1845904
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1665348
	speed: 0.0587s/iter; left time: 1222.1501s
	iters: 200, epoch: 23 | loss: 0.2341528
	speed: 0.0099s/iter; left time: 205.9158s
Epoch: 23 cost time: 3.253775119781494
Epoch: 23, Steps: 268 | Train Loss: 0.2402089 Vali Loss: 0.1302676 Test Loss: 0.1845699
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2265235
	speed: 0.0574s/iter; left time: 1178.0932s
	iters: 200, epoch: 24 | loss: 0.2282940
	speed: 0.0098s/iter; left time: 200.2828s
Epoch: 24 cost time: 3.2513105869293213
Epoch: 24, Steps: 268 | Train Loss: 0.2401614 Vali Loss: 0.1301628 Test Loss: 0.1845425
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2156711
	speed: 0.0582s/iter; left time: 1180.0360s
	iters: 200, epoch: 25 | loss: 0.2960705
	speed: 0.0101s/iter; left time: 204.3189s
Epoch: 25 cost time: 3.2594399452209473
Epoch: 25, Steps: 268 | Train Loss: 0.2402773 Vali Loss: 0.1302647 Test Loss: 0.1845421
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2973700
	speed: 0.0558s/iter; left time: 1116.3427s
	iters: 200, epoch: 26 | loss: 0.2120992
	speed: 0.0098s/iter; left time: 194.6587s
Epoch: 26 cost time: 3.0812997817993164
Epoch: 26, Steps: 268 | Train Loss: 0.2401500 Vali Loss: 0.1302515 Test Loss: 0.1845862
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.4252812
	speed: 0.0579s/iter; left time: 1143.2138s
	iters: 200, epoch: 27 | loss: 0.1825999
	speed: 0.0099s/iter; left time: 194.7458s
Epoch: 27 cost time: 3.22123646736145
Epoch: 27, Steps: 268 | Train Loss: 0.2400215 Vali Loss: 0.1301657 Test Loss: 0.1845208
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2388944
	speed: 0.0583s/iter; left time: 1135.4294s
	iters: 200, epoch: 28 | loss: 0.1761007
	speed: 0.0120s/iter; left time: 232.2506s
Epoch: 28 cost time: 5.475947856903076
Epoch: 28, Steps: 268 | Train Loss: 0.2403398 Vali Loss: 0.1301692 Test Loss: 0.1845167
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18533794581890106, mae:0.2687617242336273, rse:0.3490425646305084, corr:[0.57505757 0.57326376 0.5675692  0.5648029  0.5643467  0.5630751
 0.5612045  0.5602416  0.5600265  0.55916494 0.55745655 0.556055
 0.55561024 0.55534136 0.55439043 0.55299395 0.5519474  0.5512638
 0.5504702  0.54941964 0.5484265  0.54762745 0.5467499  0.54573244
 0.5448807  0.5444479  0.5443412  0.5440821  0.543439   0.5427294
 0.5420294  0.541328   0.5405831  0.53997993 0.53957874 0.53923243
 0.5386283  0.53786576 0.5372013  0.5365744  0.5358407  0.5352501
 0.5349994  0.5349718  0.5347571  0.53407234 0.5332539  0.5325391
 0.5319061  0.5310988  0.53011495 0.5293759  0.52899736 0.52857625
 0.5278512  0.5269047  0.5261569  0.5258747  0.52570146 0.5253767
 0.5248245  0.52447754 0.5245605  0.5247882  0.5247105  0.52444726
 0.52434313 0.52434075 0.524382   0.5243674  0.5244147  0.52465844
 0.5248961  0.5250372  0.5250103  0.5250116  0.5251496  0.52520245
 0.52510846 0.5249785  0.5249355  0.5249158  0.5248417  0.52473414
 0.5246583  0.5245774  0.5243404  0.52405435 0.52388704 0.52387166
 0.5239101  0.5238934  0.52370316 0.52350247 0.5229995  0.52147514]
