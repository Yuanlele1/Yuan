Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=42, out_features=61, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2295552.0
params:  2623.0
Trainable parameters:  2623
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3674428
	speed: 0.0203s/iter; left time: 528.4296s
	iters: 200, epoch: 1 | loss: 0.2233383
	speed: 0.0158s/iter; left time: 409.6144s
Epoch: 1 cost time: 4.579514980316162
Epoch: 1, Steps: 261 | Train Loss: 0.3381857 Vali Loss: 0.2372117 Test Loss: 0.3172556
Validation loss decreased (inf --> 0.237212).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1874585
	speed: 0.0664s/iter; left time: 1708.2961s
	iters: 200, epoch: 2 | loss: 0.2201543
	speed: 0.0157s/iter; left time: 403.2923s
Epoch: 2 cost time: 4.581958055496216
Epoch: 2, Steps: 261 | Train Loss: 0.2217488 Vali Loss: 0.2183774 Test Loss: 0.2930612
Validation loss decreased (0.237212 --> 0.218377).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1784906
	speed: 0.0648s/iter; left time: 1651.7406s
	iters: 200, epoch: 3 | loss: 0.1923490
	speed: 0.0157s/iter; left time: 399.5823s
Epoch: 3 cost time: 4.572271108627319
Epoch: 3, Steps: 261 | Train Loss: 0.1834892 Vali Loss: 0.2116234 Test Loss: 0.2848992
Validation loss decreased (0.218377 --> 0.211623).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1586043
	speed: 0.0630s/iter; left time: 1589.6408s
	iters: 200, epoch: 4 | loss: 0.1808923
	speed: 0.0149s/iter; left time: 375.2618s
Epoch: 4 cost time: 4.333721399307251
Epoch: 4, Steps: 261 | Train Loss: 0.1653471 Vali Loss: 0.2074859 Test Loss: 0.2802119
Validation loss decreased (0.211623 --> 0.207486).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1490315
	speed: 0.0646s/iter; left time: 1611.1246s
	iters: 200, epoch: 5 | loss: 0.1051626
	speed: 0.0153s/iter; left time: 381.1884s
Epoch: 5 cost time: 4.504833936691284
Epoch: 5, Steps: 261 | Train Loss: 0.1554681 Vali Loss: 0.2048310 Test Loss: 0.2775813
Validation loss decreased (0.207486 --> 0.204831).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2032924
	speed: 0.0636s/iter; left time: 1571.5870s
	iters: 200, epoch: 6 | loss: 0.1676888
	speed: 0.0157s/iter; left time: 385.1831s
Epoch: 6 cost time: 4.432981252670288
Epoch: 6, Steps: 261 | Train Loss: 0.1500759 Vali Loss: 0.2026438 Test Loss: 0.2758901
Validation loss decreased (0.204831 --> 0.202644).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2265411
	speed: 0.0656s/iter; left time: 1602.8357s
	iters: 200, epoch: 7 | loss: 0.1472217
	speed: 0.0152s/iter; left time: 370.9659s
Epoch: 7 cost time: 4.484890937805176
Epoch: 7, Steps: 261 | Train Loss: 0.1468721 Vali Loss: 0.2017790 Test Loss: 0.2752445
Validation loss decreased (0.202644 --> 0.201779).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1108493
	speed: 0.0633s/iter; left time: 1529.5335s
	iters: 200, epoch: 8 | loss: 0.1439269
	speed: 0.0155s/iter; left time: 374.1664s
Epoch: 8 cost time: 4.444708824157715
Epoch: 8, Steps: 261 | Train Loss: 0.1453019 Vali Loss: 0.2010635 Test Loss: 0.2748445
Validation loss decreased (0.201779 --> 0.201064).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1002605
	speed: 0.0633s/iter; left time: 1513.0185s
	iters: 200, epoch: 9 | loss: 0.1079281
	speed: 0.0152s/iter; left time: 362.1683s
Epoch: 9 cost time: 4.394765377044678
Epoch: 9, Steps: 261 | Train Loss: 0.1443098 Vali Loss: 0.2006391 Test Loss: 0.2747774
Validation loss decreased (0.201064 --> 0.200639).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1326751
	speed: 0.0628s/iter; left time: 1484.2026s
	iters: 200, epoch: 10 | loss: 0.1640276
	speed: 0.0150s/iter; left time: 353.7648s
Epoch: 10 cost time: 4.359981536865234
Epoch: 10, Steps: 261 | Train Loss: 0.1435976 Vali Loss: 0.1998627 Test Loss: 0.2745436
Validation loss decreased (0.200639 --> 0.199863).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1446437
	speed: 0.0630s/iter; left time: 1473.6590s
	iters: 200, epoch: 11 | loss: 0.2180126
	speed: 0.0150s/iter; left time: 349.8856s
Epoch: 11 cost time: 4.431890964508057
Epoch: 11, Steps: 261 | Train Loss: 0.1431959 Vali Loss: 0.1999046 Test Loss: 0.2746447
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1446261
	speed: 0.0626s/iter; left time: 1448.7104s
	iters: 200, epoch: 12 | loss: 0.1506738
	speed: 0.0153s/iter; left time: 351.6706s
Epoch: 12 cost time: 4.385026216506958
Epoch: 12, Steps: 261 | Train Loss: 0.1430184 Vali Loss: 0.1994619 Test Loss: 0.2747148
Validation loss decreased (0.199863 --> 0.199462).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0967038
	speed: 0.0622s/iter; left time: 1422.8157s
	iters: 200, epoch: 13 | loss: 0.2097046
	speed: 0.0152s/iter; left time: 346.9746s
Epoch: 13 cost time: 4.271219968795776
Epoch: 13, Steps: 261 | Train Loss: 0.1428778 Vali Loss: 0.1996256 Test Loss: 0.2747415
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1531342
	speed: 0.0631s/iter; left time: 1427.5945s
	iters: 200, epoch: 14 | loss: 0.1530367
	speed: 0.0145s/iter; left time: 326.5428s
Epoch: 14 cost time: 4.334081649780273
Epoch: 14, Steps: 261 | Train Loss: 0.1427752 Vali Loss: 0.1995792 Test Loss: 0.2747408
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2193436
	speed: 0.0616s/iter; left time: 1377.3358s
	iters: 200, epoch: 15 | loss: 0.1009069
	speed: 0.0157s/iter; left time: 349.5111s
Epoch: 15 cost time: 4.423976898193359
Epoch: 15, Steps: 261 | Train Loss: 0.1427532 Vali Loss: 0.1996524 Test Loss: 0.2747614
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1364754
	speed: 0.0628s/iter; left time: 1386.9260s
	iters: 200, epoch: 16 | loss: 0.1931270
	speed: 0.0152s/iter; left time: 334.5839s
Epoch: 16 cost time: 4.414077281951904
Epoch: 16, Steps: 261 | Train Loss: 0.1427991 Vali Loss: 0.1994589 Test Loss: 0.2746764
Validation loss decreased (0.199462 --> 0.199459).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1005474
	speed: 0.0631s/iter; left time: 1378.1492s
	iters: 200, epoch: 17 | loss: 0.1872111
	speed: 0.0162s/iter; left time: 351.9392s
Epoch: 17 cost time: 4.483243227005005
Epoch: 17, Steps: 261 | Train Loss: 0.1427499 Vali Loss: 0.1993967 Test Loss: 0.2746578
Validation loss decreased (0.199459 --> 0.199397).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1907330
	speed: 0.0644s/iter; left time: 1388.0552s
	iters: 200, epoch: 18 | loss: 0.1234969
	speed: 0.0150s/iter; left time: 322.8720s
Epoch: 18 cost time: 4.461150169372559
Epoch: 18, Steps: 261 | Train Loss: 0.1427515 Vali Loss: 0.1995452 Test Loss: 0.2748231
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1518748
	speed: 0.0617s/iter; left time: 1313.4322s
	iters: 200, epoch: 19 | loss: 0.1614973
	speed: 0.0151s/iter; left time: 319.4861s
Epoch: 19 cost time: 4.349907398223877
Epoch: 19, Steps: 261 | Train Loss: 0.1428601 Vali Loss: 0.1994650 Test Loss: 0.2747644
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1313896
	speed: 0.0619s/iter; left time: 1302.7872s
	iters: 200, epoch: 20 | loss: 0.1477243
	speed: 0.0153s/iter; left time: 321.0293s
Epoch: 20 cost time: 4.2983739376068115
Epoch: 20, Steps: 261 | Train Loss: 0.1426495 Vali Loss: 0.1994297 Test Loss: 0.2747163
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1856261
	speed: 0.0626s/iter; left time: 1301.6383s
	iters: 200, epoch: 21 | loss: 0.1507193
	speed: 0.0149s/iter; left time: 308.0042s
Epoch: 21 cost time: 4.417771100997925
Epoch: 21, Steps: 261 | Train Loss: 0.1428163 Vali Loss: 0.1993061 Test Loss: 0.2747708
Validation loss decreased (0.199397 --> 0.199306).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1250926
	speed: 0.0614s/iter; left time: 1260.6782s
	iters: 200, epoch: 22 | loss: 0.1323272
	speed: 0.0149s/iter; left time: 304.0814s
Epoch: 22 cost time: 4.368204832077026
Epoch: 22, Steps: 261 | Train Loss: 0.1426565 Vali Loss: 0.1994369 Test Loss: 0.2746631
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1422361
	speed: 0.0645s/iter; left time: 1306.7286s
	iters: 200, epoch: 23 | loss: 0.0996550
	speed: 0.0148s/iter; left time: 297.8272s
Epoch: 23 cost time: 4.371656179428101
Epoch: 23, Steps: 261 | Train Loss: 0.1426824 Vali Loss: 0.1993359 Test Loss: 0.2746287
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1020681
	speed: 0.0636s/iter; left time: 1272.0997s
	iters: 200, epoch: 24 | loss: 0.1198861
	speed: 0.0159s/iter; left time: 315.9006s
Epoch: 24 cost time: 4.5857439041137695
Epoch: 24, Steps: 261 | Train Loss: 0.1426758 Vali Loss: 0.1994805 Test Loss: 0.2747700
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1740136
	speed: 0.0633s/iter; left time: 1249.8230s
	iters: 200, epoch: 25 | loss: 0.1681638
	speed: 0.0149s/iter; left time: 292.2712s
Epoch: 25 cost time: 4.30316686630249
Epoch: 25, Steps: 261 | Train Loss: 0.1427394 Vali Loss: 0.1994373 Test Loss: 0.2747043
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1553878
	speed: 0.0634s/iter; left time: 1235.6507s
	iters: 200, epoch: 26 | loss: 0.1326832
	speed: 0.0151s/iter; left time: 293.0350s
Epoch: 26 cost time: 4.41290283203125
Epoch: 26, Steps: 261 | Train Loss: 0.1427762 Vali Loss: 0.1994285 Test Loss: 0.2747070
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1253988
	speed: 0.0648s/iter; left time: 1245.0410s
	iters: 200, epoch: 27 | loss: 0.1915600
	speed: 0.0158s/iter; left time: 302.3444s
Epoch: 27 cost time: 4.43759298324585
Epoch: 27, Steps: 261 | Train Loss: 0.1427320 Vali Loss: 0.1994549 Test Loss: 0.2746553
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1521681
	speed: 0.0632s/iter; left time: 1198.7975s
	iters: 200, epoch: 28 | loss: 0.1085858
	speed: 0.0150s/iter; left time: 283.1804s
Epoch: 28 cost time: 4.361188650131226
Epoch: 28, Steps: 261 | Train Loss: 0.1426834 Vali Loss: 0.1994751 Test Loss: 0.2745784
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1226649
	speed: 0.0637s/iter; left time: 1191.2934s
	iters: 200, epoch: 29 | loss: 0.1999000
	speed: 0.0154s/iter; left time: 285.8913s
Epoch: 29 cost time: 4.469987630844116
Epoch: 29, Steps: 261 | Train Loss: 0.1426316 Vali Loss: 0.1993116 Test Loss: 0.2747218
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1628407
	speed: 0.0639s/iter; left time: 1177.7939s
	iters: 200, epoch: 30 | loss: 0.1374086
	speed: 0.0154s/iter; left time: 282.7038s
Epoch: 30 cost time: 4.404692888259888
Epoch: 30, Steps: 261 | Train Loss: 0.1427496 Vali Loss: 0.1994278 Test Loss: 0.2746383
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1567674
	speed: 0.0615s/iter; left time: 1117.5157s
	iters: 200, epoch: 31 | loss: 0.1669008
	speed: 0.0157s/iter; left time: 283.5781s
Epoch: 31 cost time: 4.345643043518066
Epoch: 31, Steps: 261 | Train Loss: 0.1426813 Vali Loss: 0.1994336 Test Loss: 0.2746923
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1075349
	speed: 0.0626s/iter; left time: 1121.3717s
	iters: 200, epoch: 32 | loss: 0.1137589
	speed: 0.0149s/iter; left time: 265.3332s
Epoch: 32 cost time: 4.3702521324157715
Epoch: 32, Steps: 261 | Train Loss: 0.1424816 Vali Loss: 0.1993235 Test Loss: 0.2745991
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1585673
	speed: 0.0642s/iter; left time: 1132.9649s
	iters: 200, epoch: 33 | loss: 0.1326098
	speed: 0.0156s/iter; left time: 273.1313s
Epoch: 33 cost time: 4.427941560745239
Epoch: 33, Steps: 261 | Train Loss: 0.1425560 Vali Loss: 0.1994455 Test Loss: 0.2746490
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1409062
	speed: 0.0632s/iter; left time: 1098.4908s
	iters: 200, epoch: 34 | loss: 0.1568516
	speed: 0.0155s/iter; left time: 267.6051s
Epoch: 34 cost time: 4.438632011413574
Epoch: 34, Steps: 261 | Train Loss: 0.1427487 Vali Loss: 0.1995000 Test Loss: 0.2746342
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1282971
	speed: 0.0632s/iter; left time: 1082.8970s
	iters: 200, epoch: 35 | loss: 0.1835775
	speed: 0.0151s/iter; left time: 257.2749s
Epoch: 35 cost time: 4.347073554992676
Epoch: 35, Steps: 261 | Train Loss: 0.1426670 Vali Loss: 0.1994116 Test Loss: 0.2746754
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1748371
	speed: 0.0624s/iter; left time: 1051.9267s
	iters: 200, epoch: 36 | loss: 0.1283739
	speed: 0.0156s/iter; left time: 261.0589s
Epoch: 36 cost time: 4.388615846633911
Epoch: 36, Steps: 261 | Train Loss: 0.1426649 Vali Loss: 0.1993340 Test Loss: 0.2746242
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1532324
	speed: 0.0644s/iter; left time: 1069.5947s
	iters: 200, epoch: 37 | loss: 0.1363502
	speed: 0.0150s/iter; left time: 246.9444s
Epoch: 37 cost time: 4.39323353767395
Epoch: 37, Steps: 261 | Train Loss: 0.1426287 Vali Loss: 0.1993981 Test Loss: 0.2746519
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1884065
	speed: 0.0616s/iter; left time: 1006.9799s
	iters: 200, epoch: 38 | loss: 0.1318448
	speed: 0.0151s/iter; left time: 245.2019s
Epoch: 38 cost time: 4.243420362472534
Epoch: 38, Steps: 261 | Train Loss: 0.1427095 Vali Loss: 0.1995358 Test Loss: 0.2747043
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1761010
	speed: 0.0628s/iter; left time: 1009.4545s
	iters: 200, epoch: 39 | loss: 0.1148058
	speed: 0.0150s/iter; left time: 239.0756s
Epoch: 39 cost time: 4.374308109283447
Epoch: 39, Steps: 261 | Train Loss: 0.1426607 Vali Loss: 0.1992720 Test Loss: 0.2746696
Validation loss decreased (0.199306 --> 0.199272).  Saving model ...
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1856920
	speed: 0.0637s/iter; left time: 1008.0794s
	iters: 200, epoch: 40 | loss: 0.1178466
	speed: 0.0159s/iter; left time: 250.7121s
Epoch: 40 cost time: 4.41903829574585
Epoch: 40, Steps: 261 | Train Loss: 0.1426903 Vali Loss: 0.1994346 Test Loss: 0.2746627
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1689166
	speed: 0.0615s/iter; left time: 956.5318s
	iters: 200, epoch: 41 | loss: 0.1326641
	speed: 0.0151s/iter; left time: 233.0477s
Epoch: 41 cost time: 4.252917051315308
Epoch: 41, Steps: 261 | Train Loss: 0.1426645 Vali Loss: 0.1993733 Test Loss: 0.2746510
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1526705
	speed: 0.0610s/iter; left time: 933.8319s
	iters: 200, epoch: 42 | loss: 0.2306577
	speed: 0.0149s/iter; left time: 225.7788s
Epoch: 42 cost time: 4.251340389251709
Epoch: 42, Steps: 261 | Train Loss: 0.1426287 Vali Loss: 0.1992498 Test Loss: 0.2746670
Validation loss decreased (0.199272 --> 0.199250).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1255205
	speed: 0.0615s/iter; left time: 924.8978s
	iters: 200, epoch: 43 | loss: 0.1281008
	speed: 0.0151s/iter; left time: 225.1655s
Epoch: 43 cost time: 4.39452052116394
Epoch: 43, Steps: 261 | Train Loss: 0.1426203 Vali Loss: 0.1991151 Test Loss: 0.2746548
Validation loss decreased (0.199250 --> 0.199115).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1310173
	speed: 0.0620s/iter; left time: 915.7579s
	iters: 200, epoch: 44 | loss: 0.1187634
	speed: 0.0148s/iter; left time: 217.2409s
Epoch: 44 cost time: 4.202747583389282
Epoch: 44, Steps: 261 | Train Loss: 0.1426362 Vali Loss: 0.1993884 Test Loss: 0.2746456
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1410129
	speed: 0.0637s/iter; left time: 924.6724s
	iters: 200, epoch: 45 | loss: 0.1873059
	speed: 0.0155s/iter; left time: 223.2045s
Epoch: 45 cost time: 4.435420513153076
Epoch: 45, Steps: 261 | Train Loss: 0.1426838 Vali Loss: 0.1993242 Test Loss: 0.2746203
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0926915
	speed: 0.0623s/iter; left time: 888.8423s
	iters: 200, epoch: 46 | loss: 0.1289000
	speed: 0.0154s/iter; left time: 217.5672s
Epoch: 46 cost time: 4.399299621582031
Epoch: 46, Steps: 261 | Train Loss: 0.1426799 Vali Loss: 0.1994071 Test Loss: 0.2746600
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1364656
	speed: 0.0634s/iter; left time: 887.9655s
	iters: 200, epoch: 47 | loss: 0.1058253
	speed: 0.0155s/iter; left time: 215.2374s
Epoch: 47 cost time: 4.382725954055786
Epoch: 47, Steps: 261 | Train Loss: 0.1426525 Vali Loss: 0.1995220 Test Loss: 0.2746640
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1470937
	speed: 0.0632s/iter; left time: 867.8461s
	iters: 200, epoch: 48 | loss: 0.1216337
	speed: 0.0154s/iter; left time: 210.5246s
Epoch: 48 cost time: 4.4283671379089355
Epoch: 48, Steps: 261 | Train Loss: 0.1423782 Vali Loss: 0.1993618 Test Loss: 0.2746276
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1125077
	speed: 0.0639s/iter; left time: 861.4066s
	iters: 200, epoch: 49 | loss: 0.2019615
	speed: 0.0159s/iter; left time: 212.6036s
Epoch: 49 cost time: 4.4366044998168945
Epoch: 49, Steps: 261 | Train Loss: 0.1426938 Vali Loss: 0.1993163 Test Loss: 0.2746469
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1567359
	speed: 0.0629s/iter; left time: 831.6343s
	iters: 200, epoch: 50 | loss: 0.1478960
	speed: 0.0153s/iter; left time: 200.2832s
Epoch: 50 cost time: 4.375488758087158
Epoch: 50, Steps: 261 | Train Loss: 0.1427174 Vali Loss: 0.1992837 Test Loss: 0.2746216
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1602793
	speed: 0.0622s/iter; left time: 805.9352s
	iters: 200, epoch: 51 | loss: 0.1294880
	speed: 0.0159s/iter; left time: 204.6941s
Epoch: 51 cost time: 4.3876941204071045
Epoch: 51, Steps: 261 | Train Loss: 0.1425032 Vali Loss: 0.1993096 Test Loss: 0.2746392
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1039820
	speed: 0.0636s/iter; left time: 806.9877s
	iters: 200, epoch: 52 | loss: 0.1668839
	speed: 0.0149s/iter; left time: 187.7570s
Epoch: 52 cost time: 4.388782262802124
Epoch: 52, Steps: 261 | Train Loss: 0.1427397 Vali Loss: 0.1991357 Test Loss: 0.2746451
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1324491
	speed: 0.0638s/iter; left time: 793.4193s
	iters: 200, epoch: 53 | loss: 0.1321716
	speed: 0.0155s/iter; left time: 190.5583s
Epoch: 53 cost time: 4.443843126296997
Epoch: 53, Steps: 261 | Train Loss: 0.1427065 Vali Loss: 0.1994741 Test Loss: 0.2746549
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1331493
	speed: 0.0635s/iter; left time: 772.4696s
	iters: 200, epoch: 54 | loss: 0.1514639
	speed: 0.0149s/iter; left time: 179.7868s
Epoch: 54 cost time: 4.343913316726685
Epoch: 54, Steps: 261 | Train Loss: 0.1426726 Vali Loss: 0.1993620 Test Loss: 0.2746550
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1481823
	speed: 0.0630s/iter; left time: 749.6938s
	iters: 200, epoch: 55 | loss: 0.1493933
	speed: 0.0156s/iter; left time: 183.7339s
Epoch: 55 cost time: 4.35999870300293
Epoch: 55, Steps: 261 | Train Loss: 0.1426266 Vali Loss: 0.1992587 Test Loss: 0.2746322
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1524317
	speed: 0.0645s/iter; left time: 751.1850s
	iters: 200, epoch: 56 | loss: 0.1393370
	speed: 0.0152s/iter; left time: 175.2381s
Epoch: 56 cost time: 4.339493989944458
Epoch: 56, Steps: 261 | Train Loss: 0.1426799 Vali Loss: 0.1994277 Test Loss: 0.2746299
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1472833
	speed: 0.0626s/iter; left time: 713.1355s
	iters: 200, epoch: 57 | loss: 0.1406381
	speed: 0.0158s/iter; left time: 178.6977s
Epoch: 57 cost time: 4.571102142333984
Epoch: 57, Steps: 261 | Train Loss: 0.1426132 Vali Loss: 0.1992942 Test Loss: 0.2746128
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1590765
	speed: 0.0709s/iter; left time: 788.5618s
	iters: 200, epoch: 58 | loss: 0.1317033
	speed: 0.0171s/iter; left time: 188.5860s
Epoch: 58 cost time: 4.920602321624756
Epoch: 58, Steps: 261 | Train Loss: 0.1425932 Vali Loss: 0.1993009 Test Loss: 0.2746338
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1535951
	speed: 0.0658s/iter; left time: 714.8705s
	iters: 200, epoch: 59 | loss: 0.1164089
	speed: 0.0153s/iter; left time: 165.0436s
Epoch: 59 cost time: 4.306233882904053
Epoch: 59, Steps: 261 | Train Loss: 0.1426221 Vali Loss: 0.1993380 Test Loss: 0.2746315
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.2169472
	speed: 0.0618s/iter; left time: 654.6752s
	iters: 200, epoch: 60 | loss: 0.1467537
	speed: 0.0154s/iter; left time: 161.6781s
Epoch: 60 cost time: 4.318293571472168
Epoch: 60, Steps: 261 | Train Loss: 0.1424326 Vali Loss: 0.1993632 Test Loss: 0.2746198
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1340970
	speed: 0.0627s/iter; left time: 648.4753s
	iters: 200, epoch: 61 | loss: 0.1324593
	speed: 0.0148s/iter; left time: 151.9253s
Epoch: 61 cost time: 4.22130823135376
Epoch: 61, Steps: 261 | Train Loss: 0.1425074 Vali Loss: 0.1993072 Test Loss: 0.2746318
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1243162
	speed: 0.0618s/iter; left time: 622.8966s
	iters: 200, epoch: 62 | loss: 0.1576939
	speed: 0.0156s/iter; left time: 155.8542s
Epoch: 62 cost time: 4.33088493347168
Epoch: 62, Steps: 261 | Train Loss: 0.1426552 Vali Loss: 0.1994448 Test Loss: 0.2746333
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1698129
	speed: 0.0611s/iter; left time: 599.6045s
	iters: 200, epoch: 63 | loss: 0.1257155
	speed: 0.0149s/iter; left time: 144.6056s
Epoch: 63 cost time: 4.238907337188721
Epoch: 63, Steps: 261 | Train Loss: 0.1425759 Vali Loss: 0.1992876 Test Loss: 0.2746223
EarlyStopping counter: 20 out of 20
Early stopping
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=42, out_features=61, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2295552.0
params:  2623.0
Trainable parameters:  2623
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4950564
	speed: 0.0186s/iter; left time: 482.4321s
	iters: 200, epoch: 1 | loss: 0.3048078
	speed: 0.0147s/iter; left time: 380.3219s
Epoch: 1 cost time: 4.197358131408691
Epoch: 1, Steps: 261 | Train Loss: 0.3851633 Vali Loss: 0.1971262 Test Loss: 0.2724112
Validation loss decreased (inf --> 0.197126).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2850993
	speed: 0.0636s/iter; left time: 1636.5184s
	iters: 200, epoch: 2 | loss: 0.4145511
	speed: 0.0145s/iter; left time: 372.5362s
Epoch: 2 cost time: 4.325233221054077
Epoch: 2, Steps: 261 | Train Loss: 0.3836960 Vali Loss: 0.1966190 Test Loss: 0.2713290
Validation loss decreased (0.197126 --> 0.196619).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4395928
	speed: 0.0620s/iter; left time: 1580.0756s
	iters: 200, epoch: 3 | loss: 0.4008803
	speed: 0.0150s/iter; left time: 380.6898s
Epoch: 3 cost time: 4.346984386444092
Epoch: 3, Steps: 261 | Train Loss: 0.3823184 Vali Loss: 0.1963915 Test Loss: 0.2712257
Validation loss decreased (0.196619 --> 0.196392).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2456122
	speed: 0.0632s/iter; left time: 1594.9468s
	iters: 200, epoch: 4 | loss: 0.3544641
	speed: 0.0149s/iter; left time: 373.4349s
Epoch: 4 cost time: 4.426330804824829
Epoch: 4, Steps: 261 | Train Loss: 0.3815340 Vali Loss: 0.1963966 Test Loss: 0.2711405
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2743780
	speed: 0.0639s/iter; left time: 1593.8293s
	iters: 200, epoch: 5 | loss: 0.3488846
	speed: 0.0156s/iter; left time: 386.7150s
Epoch: 5 cost time: 4.415337324142456
Epoch: 5, Steps: 261 | Train Loss: 0.3813929 Vali Loss: 0.1958309 Test Loss: 0.2704750
Validation loss decreased (0.196392 --> 0.195831).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3169915
	speed: 0.0613s/iter; left time: 1512.7703s
	iters: 200, epoch: 6 | loss: 0.3632386
	speed: 0.0151s/iter; left time: 371.0269s
Epoch: 6 cost time: 4.234078645706177
Epoch: 6, Steps: 261 | Train Loss: 0.3811001 Vali Loss: 0.1958339 Test Loss: 0.2704976
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3292054
	speed: 0.0621s/iter; left time: 1516.9228s
	iters: 200, epoch: 7 | loss: 0.2807299
	speed: 0.0157s/iter; left time: 381.5059s
Epoch: 7 cost time: 4.436119079589844
Epoch: 7, Steps: 261 | Train Loss: 0.3808163 Vali Loss: 0.1958035 Test Loss: 0.2706117
Validation loss decreased (0.195831 --> 0.195803).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3971298
	speed: 0.0621s/iter; left time: 1502.2234s
	iters: 200, epoch: 8 | loss: 0.5195482
	speed: 0.0151s/iter; left time: 364.0246s
Epoch: 8 cost time: 4.294543504714966
Epoch: 8, Steps: 261 | Train Loss: 0.3802182 Vali Loss: 0.1956557 Test Loss: 0.2703662
Validation loss decreased (0.195803 --> 0.195656).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3273847
	speed: 0.0623s/iter; left time: 1489.0769s
	iters: 200, epoch: 9 | loss: 0.2957040
	speed: 0.0152s/iter; left time: 362.5483s
Epoch: 9 cost time: 4.289809703826904
Epoch: 9, Steps: 261 | Train Loss: 0.3796374 Vali Loss: 0.1954145 Test Loss: 0.2701450
Validation loss decreased (0.195656 --> 0.195415).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2926549
	speed: 0.0621s/iter; left time: 1469.1885s
	iters: 200, epoch: 10 | loss: 0.3540771
	speed: 0.0150s/iter; left time: 352.6468s
Epoch: 10 cost time: 4.285655975341797
Epoch: 10, Steps: 261 | Train Loss: 0.3803269 Vali Loss: 0.1955500 Test Loss: 0.2702405
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3070025
	speed: 0.0636s/iter; left time: 1488.5252s
	iters: 200, epoch: 11 | loss: 0.4062359
	speed: 0.0148s/iter; left time: 345.4125s
Epoch: 11 cost time: 4.385745525360107
Epoch: 11, Steps: 261 | Train Loss: 0.3797274 Vali Loss: 0.1955767 Test Loss: 0.2702813
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2798711
	speed: 0.0643s/iter; left time: 1488.3764s
	iters: 200, epoch: 12 | loss: 0.4436291
	speed: 0.0154s/iter; left time: 354.7071s
Epoch: 12 cost time: 4.395595550537109
Epoch: 12, Steps: 261 | Train Loss: 0.3796993 Vali Loss: 0.1954157 Test Loss: 0.2699961
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2865575
	speed: 0.0634s/iter; left time: 1451.0376s
	iters: 200, epoch: 13 | loss: 0.3618962
	speed: 0.0148s/iter; left time: 336.5016s
Epoch: 13 cost time: 4.360538959503174
Epoch: 13, Steps: 261 | Train Loss: 0.3793698 Vali Loss: 0.1954018 Test Loss: 0.2700030
Validation loss decreased (0.195415 --> 0.195402).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.5014418
	speed: 0.0631s/iter; left time: 1426.9285s
	iters: 200, epoch: 14 | loss: 0.4606853
	speed: 0.0150s/iter; left time: 337.2416s
Epoch: 14 cost time: 4.3407042026519775
Epoch: 14, Steps: 261 | Train Loss: 0.3793342 Vali Loss: 0.1955350 Test Loss: 0.2701104
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2839663
	speed: 0.0621s/iter; left time: 1386.9842s
	iters: 200, epoch: 15 | loss: 0.3806598
	speed: 0.0155s/iter; left time: 344.8438s
Epoch: 15 cost time: 4.367591857910156
Epoch: 15, Steps: 261 | Train Loss: 0.3795571 Vali Loss: 0.1955666 Test Loss: 0.2701114
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.4751878
	speed: 0.0629s/iter; left time: 1388.6648s
	iters: 200, epoch: 16 | loss: 0.3884954
	speed: 0.0155s/iter; left time: 341.6000s
Epoch: 16 cost time: 4.49836277961731
Epoch: 16, Steps: 261 | Train Loss: 0.3786495 Vali Loss: 0.1951527 Test Loss: 0.2698245
Validation loss decreased (0.195402 --> 0.195153).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3475887
	speed: 0.0640s/iter; left time: 1397.5827s
	iters: 200, epoch: 17 | loss: 0.3895475
	speed: 0.0147s/iter; left time: 319.9812s
Epoch: 17 cost time: 4.370514392852783
Epoch: 17, Steps: 261 | Train Loss: 0.3797663 Vali Loss: 0.1952368 Test Loss: 0.2699722
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3452762
	speed: 0.0620s/iter; left time: 1336.5489s
	iters: 200, epoch: 18 | loss: 0.4591892
	speed: 0.0151s/iter; left time: 324.4555s
Epoch: 18 cost time: 4.254454851150513
Epoch: 18, Steps: 261 | Train Loss: 0.3793653 Vali Loss: 0.1952274 Test Loss: 0.2698245
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3932763
	speed: 0.0617s/iter; left time: 1313.3727s
	iters: 200, epoch: 19 | loss: 0.4200794
	speed: 0.0147s/iter; left time: 312.0474s
Epoch: 19 cost time: 4.303799152374268
Epoch: 19, Steps: 261 | Train Loss: 0.3787093 Vali Loss: 0.1953669 Test Loss: 0.2699367
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3408833
	speed: 0.0642s/iter; left time: 1351.2613s
	iters: 200, epoch: 20 | loss: 0.3746738
	speed: 0.0157s/iter; left time: 327.8137s
Epoch: 20 cost time: 4.48101544380188
Epoch: 20, Steps: 261 | Train Loss: 0.3796127 Vali Loss: 0.1953177 Test Loss: 0.2699178
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3096001
	speed: 0.0645s/iter; left time: 1340.3888s
	iters: 200, epoch: 21 | loss: 0.4693374
	speed: 0.0154s/iter; left time: 318.5376s
Epoch: 21 cost time: 4.468929767608643
Epoch: 21, Steps: 261 | Train Loss: 0.3796076 Vali Loss: 0.1954641 Test Loss: 0.2699929
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3382780
	speed: 0.0635s/iter; left time: 1303.0669s
	iters: 200, epoch: 22 | loss: 0.2913846
	speed: 0.0149s/iter; left time: 305.0962s
Epoch: 22 cost time: 4.264095067977905
Epoch: 22, Steps: 261 | Train Loss: 0.3793812 Vali Loss: 0.1953377 Test Loss: 0.2698267
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3463085
	speed: 0.0619s/iter; left time: 1254.2137s
	iters: 200, epoch: 23 | loss: 0.2878079
	speed: 0.0156s/iter; left time: 313.8006s
Epoch: 23 cost time: 4.428977012634277
Epoch: 23, Steps: 261 | Train Loss: 0.3793801 Vali Loss: 0.1954237 Test Loss: 0.2699352
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.4467546
	speed: 0.0619s/iter; left time: 1238.2698s
	iters: 200, epoch: 24 | loss: 0.2450545
	speed: 0.0152s/iter; left time: 302.2401s
Epoch: 24 cost time: 4.366582632064819
Epoch: 24, Steps: 261 | Train Loss: 0.3791102 Vali Loss: 0.1952113 Test Loss: 0.2699349
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4772063
	speed: 0.0636s/iter; left time: 1255.6715s
	iters: 200, epoch: 25 | loss: 0.4321141
	speed: 0.0147s/iter; left time: 289.5466s
Epoch: 25 cost time: 4.29277777671814
Epoch: 25, Steps: 261 | Train Loss: 0.3789693 Vali Loss: 0.1953187 Test Loss: 0.2699199
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.4319846
	speed: 0.0625s/iter; left time: 1217.5445s
	iters: 200, epoch: 26 | loss: 0.4264037
	speed: 0.0153s/iter; left time: 296.3639s
Epoch: 26 cost time: 4.42941427230835
Epoch: 26, Steps: 261 | Train Loss: 0.3789759 Vali Loss: 0.1953366 Test Loss: 0.2698991
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3041117
	speed: 0.0648s/iter; left time: 1245.4486s
	iters: 200, epoch: 27 | loss: 0.3228796
	speed: 0.0153s/iter; left time: 293.0147s
Epoch: 27 cost time: 4.522295713424683
Epoch: 27, Steps: 261 | Train Loss: 0.3793419 Vali Loss: 0.1953216 Test Loss: 0.2699550
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3321688
	speed: 0.0627s/iter; left time: 1187.8673s
	iters: 200, epoch: 28 | loss: 0.2874336
	speed: 0.0156s/iter; left time: 294.7854s
Epoch: 28 cost time: 4.4755542278289795
Epoch: 28, Steps: 261 | Train Loss: 0.3789514 Vali Loss: 0.1951817 Test Loss: 0.2699242
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3465169
	speed: 0.0631s/iter; left time: 1180.1391s
	iters: 200, epoch: 29 | loss: 0.4553951
	speed: 0.0147s/iter; left time: 273.6040s
Epoch: 29 cost time: 4.309500694274902
Epoch: 29, Steps: 261 | Train Loss: 0.3788471 Vali Loss: 0.1952223 Test Loss: 0.2698884
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.4126785
	speed: 0.0632s/iter; left time: 1164.8595s
	iters: 200, epoch: 30 | loss: 0.2301556
	speed: 0.0147s/iter; left time: 270.1701s
Epoch: 30 cost time: 4.412914514541626
Epoch: 30, Steps: 261 | Train Loss: 0.3792841 Vali Loss: 0.1952489 Test Loss: 0.2699249
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.4628734
	speed: 0.0636s/iter; left time: 1155.6512s
	iters: 200, epoch: 31 | loss: 0.4217263
	speed: 0.0154s/iter; left time: 277.7388s
Epoch: 31 cost time: 4.4155802726745605
Epoch: 31, Steps: 261 | Train Loss: 0.3793619 Vali Loss: 0.1950429 Test Loss: 0.2698998
Validation loss decreased (0.195153 --> 0.195043).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3683099
	speed: 0.0632s/iter; left time: 1131.6053s
	iters: 200, epoch: 32 | loss: 0.4755082
	speed: 0.0153s/iter; left time: 272.1550s
Epoch: 32 cost time: 4.360534191131592
Epoch: 32, Steps: 261 | Train Loss: 0.3786195 Vali Loss: 0.1952444 Test Loss: 0.2698715
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.5824132
	speed: 0.0623s/iter; left time: 1100.1734s
	iters: 200, epoch: 33 | loss: 0.4942081
	speed: 0.0152s/iter; left time: 266.8420s
Epoch: 33 cost time: 4.442577838897705
Epoch: 33, Steps: 261 | Train Loss: 0.3787158 Vali Loss: 0.1952517 Test Loss: 0.2698613
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3421565
	speed: 0.0645s/iter; left time: 1120.6994s
	iters: 200, epoch: 34 | loss: 0.3963465
	speed: 0.0152s/iter; left time: 263.2304s
Epoch: 34 cost time: 4.419316291809082
Epoch: 34, Steps: 261 | Train Loss: 0.3787799 Vali Loss: 0.1951577 Test Loss: 0.2698849
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2793120
	speed: 0.0645s/iter; left time: 1104.8797s
	iters: 200, epoch: 35 | loss: 0.3027841
	speed: 0.0149s/iter; left time: 253.7107s
Epoch: 35 cost time: 4.445016860961914
Epoch: 35, Steps: 261 | Train Loss: 0.3782946 Vali Loss: 0.1954532 Test Loss: 0.2699237
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3528448
	speed: 0.0631s/iter; left time: 1064.1093s
	iters: 200, epoch: 36 | loss: 0.3132884
	speed: 0.0149s/iter; left time: 250.6516s
Epoch: 36 cost time: 4.300635099411011
Epoch: 36, Steps: 261 | Train Loss: 0.3791731 Vali Loss: 0.1952203 Test Loss: 0.2698977
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2669324
	speed: 0.0623s/iter; left time: 1033.9631s
	iters: 200, epoch: 37 | loss: 0.3947707
	speed: 0.0145s/iter; left time: 239.5973s
Epoch: 37 cost time: 4.22818660736084
Epoch: 37, Steps: 261 | Train Loss: 0.3788859 Vali Loss: 0.1953156 Test Loss: 0.2698624
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2769234
	speed: 0.0614s/iter; left time: 1003.0599s
	iters: 200, epoch: 38 | loss: 0.3772483
	speed: 0.0149s/iter; left time: 242.2039s
Epoch: 38 cost time: 4.310557842254639
Epoch: 38, Steps: 261 | Train Loss: 0.3788606 Vali Loss: 0.1952192 Test Loss: 0.2698569
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.4510973
	speed: 0.0636s/iter; left time: 1023.4087s
	iters: 200, epoch: 39 | loss: 0.4757951
	speed: 0.0146s/iter; left time: 232.6300s
Epoch: 39 cost time: 4.353141784667969
Epoch: 39, Steps: 261 | Train Loss: 0.3788328 Vali Loss: 0.1953486 Test Loss: 0.2698334
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3450295
	speed: 0.0632s/iter; left time: 1000.3131s
	iters: 200, epoch: 40 | loss: 0.3570309
	speed: 0.0147s/iter; left time: 231.1873s
Epoch: 40 cost time: 4.388047695159912
Epoch: 40, Steps: 261 | Train Loss: 0.3790289 Vali Loss: 0.1953367 Test Loss: 0.2698456
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2601218
	speed: 0.0634s/iter; left time: 986.3266s
	iters: 200, epoch: 41 | loss: 0.4325204
	speed: 0.0146s/iter; left time: 225.7884s
Epoch: 41 cost time: 4.324395179748535
Epoch: 41, Steps: 261 | Train Loss: 0.3791383 Vali Loss: 0.1953701 Test Loss: 0.2698300
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3280438
	speed: 0.0621s/iter; left time: 950.2262s
	iters: 200, epoch: 42 | loss: 0.3206115
	speed: 0.0154s/iter; left time: 234.1496s
Epoch: 42 cost time: 4.3995466232299805
Epoch: 42, Steps: 261 | Train Loss: 0.3783085 Vali Loss: 0.1953042 Test Loss: 0.2698339
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.4476843
	speed: 0.0627s/iter; left time: 942.9561s
	iters: 200, epoch: 43 | loss: 0.3545298
	speed: 0.0159s/iter; left time: 236.8737s
Epoch: 43 cost time: 4.502356290817261
Epoch: 43, Steps: 261 | Train Loss: 0.3783133 Vali Loss: 0.1951169 Test Loss: 0.2698511
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3907058
	speed: 0.0639s/iter; left time: 944.4406s
	iters: 200, epoch: 44 | loss: 0.2448488
	speed: 0.0157s/iter; left time: 230.6391s
Epoch: 44 cost time: 4.4647767543792725
Epoch: 44, Steps: 261 | Train Loss: 0.3786399 Vali Loss: 0.1952723 Test Loss: 0.2698804
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.5191290
	speed: 0.0637s/iter; left time: 924.9263s
	iters: 200, epoch: 45 | loss: 0.4640173
	speed: 0.0157s/iter; left time: 226.7624s
Epoch: 45 cost time: 4.411865949630737
Epoch: 45, Steps: 261 | Train Loss: 0.3788709 Vali Loss: 0.1952938 Test Loss: 0.2698529
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3808502
	speed: 0.0625s/iter; left time: 890.6577s
	iters: 200, epoch: 46 | loss: 0.2862490
	speed: 0.0157s/iter; left time: 222.5572s
Epoch: 46 cost time: 4.40205717086792
Epoch: 46, Steps: 261 | Train Loss: 0.3789183 Vali Loss: 0.1951825 Test Loss: 0.2698476
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.4367945
	speed: 0.0617s/iter; left time: 863.3619s
	iters: 200, epoch: 47 | loss: 0.3768277
	speed: 0.0154s/iter; left time: 213.8123s
Epoch: 47 cost time: 4.3809568881988525
Epoch: 47, Steps: 261 | Train Loss: 0.3788121 Vali Loss: 0.1953528 Test Loss: 0.2698619
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3588881
	speed: 0.0649s/iter; left time: 891.5563s
	iters: 200, epoch: 48 | loss: 0.3855178
	speed: 0.0151s/iter; left time: 206.4566s
Epoch: 48 cost time: 4.580881595611572
Epoch: 48, Steps: 261 | Train Loss: 0.3787355 Vali Loss: 0.1951065 Test Loss: 0.2698531
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2773452
	speed: 0.0620s/iter; left time: 835.6125s
	iters: 200, epoch: 49 | loss: 0.4928567
	speed: 0.0150s/iter; left time: 200.8830s
Epoch: 49 cost time: 4.38062858581543
Epoch: 49, Steps: 261 | Train Loss: 0.3787750 Vali Loss: 0.1952231 Test Loss: 0.2698648
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.5206506
	speed: 0.0622s/iter; left time: 821.4225s
	iters: 200, epoch: 50 | loss: 0.4615010
	speed: 0.0153s/iter; left time: 200.2748s
Epoch: 50 cost time: 4.3619704246521
Epoch: 50, Steps: 261 | Train Loss: 0.3782979 Vali Loss: 0.1951727 Test Loss: 0.2698681
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.3342939
	speed: 0.0621s/iter; left time: 804.5136s
	iters: 200, epoch: 51 | loss: 0.2733765
	speed: 0.0150s/iter; left time: 192.7863s
Epoch: 51 cost time: 4.366307497024536
Epoch: 51, Steps: 261 | Train Loss: 0.3788147 Vali Loss: 0.1953180 Test Loss: 0.2698437
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_720_336_FITS_ETTm2_ftM_sl720_ll48_pl336_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.27092328667640686, mae:0.3283711075782776, rse:0.42042046785354614, corr:[0.551825   0.5528749  0.5539075  0.55445635 0.554408   0.55392265
 0.5531961  0.55237985 0.5516149  0.5510002  0.5505562  0.55025744
 0.55008745 0.54996675 0.5498792  0.5497194  0.5494593  0.5491039
 0.5486334  0.5480349  0.5473543  0.54661745 0.5458807  0.5452133
 0.544609   0.5440685  0.54359615 0.54318005 0.54280615 0.5424595
 0.54210484 0.5417888  0.5414834  0.5411139  0.5406479  0.5401072
 0.5394882  0.5388345  0.5381557  0.5374655  0.5367841  0.5360965
 0.53541076 0.5347205  0.53403974 0.53336513 0.5327249  0.53214276
 0.5315719  0.53096807 0.5303078  0.5296373  0.5289545  0.52826333
 0.5275752  0.5269584  0.5264099  0.52592534 0.5255166  0.52518404
 0.5249119  0.52472657 0.5246201  0.5245478  0.52447325 0.52440214
 0.5242906  0.52414894 0.5239862  0.5237884  0.5235184  0.52316594
 0.52271307 0.52218366 0.52157253 0.5209208  0.52025354 0.51959103
 0.5189474  0.5183803  0.5178475  0.51738256 0.5169701  0.51660603
 0.5162955  0.5160261  0.51573604 0.5154014  0.5149873  0.5144675
 0.51384664 0.51314175 0.51227975 0.5112617  0.5101044  0.5088024
 0.5074117  0.5060547  0.5047436  0.5034792  0.5022702  0.5011088
 0.49999458 0.49889034 0.49780115 0.4967016  0.495631   0.49463844
 0.4937189  0.4928509  0.49202463 0.4912212  0.4904907  0.48981512
 0.4891358  0.4884662  0.48782843 0.48718295 0.48654905 0.48585483
 0.48512635 0.48432535 0.4834955  0.4826263  0.48169252 0.48068926
 0.4796807  0.47870663 0.47779527 0.47697443 0.47625872 0.475614
 0.47503328 0.47451818 0.4740661  0.4736414  0.47317988 0.47267696
 0.4720977  0.471466   0.47076473 0.4700198  0.46926922 0.4684693
 0.4676172  0.46664238 0.4656405  0.46463448 0.46368793 0.46279848
 0.4620225  0.4614194  0.4609278  0.4604785  0.46003398 0.45963293
 0.45926178 0.45890924 0.45853537 0.4581852  0.45783588 0.45748374
 0.45711508 0.45674685 0.45639917 0.45610747 0.4558253  0.45552376
 0.4552118  0.45493785 0.4546365  0.45429346 0.45390224 0.45347583
 0.4530434  0.45262596 0.45222223 0.45181918 0.4513681  0.45092955
 0.45045847 0.4499259  0.44938543 0.44884667 0.4482839  0.4476678
 0.44699037 0.4462614  0.44545072 0.44450468 0.44339687 0.44212687
 0.44076228 0.439458   0.4381833  0.43687138 0.43554872 0.4341897
 0.4328308  0.43148157 0.430176   0.42892402 0.42774126 0.42663607
 0.42562622 0.4247055  0.42381886 0.42294613 0.4221415  0.42148644
 0.4208707  0.420229   0.4195026  0.41868278 0.41781983 0.416886
 0.4158794  0.41476694 0.41361427 0.41246498 0.41130304 0.41016528
 0.40907574 0.40805125 0.40714484 0.4062577  0.4053632  0.4044871
 0.4035781  0.40273353 0.40194324 0.4012659  0.40066764 0.40013158
 0.39959157 0.3990569  0.39849895 0.39794993 0.39745635 0.39702204
 0.39666802 0.39630795 0.39593926 0.3956548  0.39538512 0.39516148
 0.39500904 0.39493525 0.39486724 0.39473787 0.39460808 0.3944527
 0.3942702  0.39411175 0.39391613 0.39369494 0.39343113 0.39315578
 0.39289612 0.39264128 0.392388   0.39214846 0.39190158 0.39167884
 0.3914632  0.3912049  0.3909339  0.3906472  0.3903129  0.38992393
 0.38949353 0.38910908 0.38876927 0.38851553 0.38832724 0.38818017
 0.38812053 0.38805583 0.3879325  0.38777614 0.38755757 0.38730094
 0.38697502 0.3865687  0.38607615 0.3854862  0.38480377 0.3839657
 0.38304415 0.38221303 0.38149834 0.3808623  0.3802805  0.37969634
 0.37916514 0.37866607 0.3781653  0.3776442  0.3771705  0.37665516
 0.37618345 0.3757417  0.37539095 0.37507275 0.37482113 0.37466967
 0.37466803 0.3746938  0.37469515 0.3746225  0.37440524 0.3741402
 0.3737458  0.37329113 0.37276813 0.37218836 0.37162384 0.37116894
 0.370844   0.3707247  0.37084332 0.3711509  0.37152702 0.37193224
 0.37227923 0.37252906 0.37264305 0.37247583 0.37199244 0.3711321
 0.37001228 0.36869135 0.36736262 0.3663206  0.3656566  0.3653101 ]
