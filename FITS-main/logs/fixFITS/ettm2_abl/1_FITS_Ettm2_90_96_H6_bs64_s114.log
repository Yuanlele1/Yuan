Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=16, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=16, out_features=33, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  473088.0
params:  561.0
Trainable parameters:  561
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4759180
	speed: 0.0164s/iter; left time: 438.6469s
	iters: 200, epoch: 1 | loss: 0.3200219
	speed: 0.0112s/iter; left time: 297.5063s
Epoch: 1 cost time: 3.4827535152435303
Epoch: 1, Steps: 268 | Train Loss: 0.3138227 Vali Loss: 0.1509959 Test Loss: 0.2128290
Validation loss decreased (inf --> 0.150996).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2525007
	speed: 0.0589s/iter; left time: 1556.5618s
	iters: 200, epoch: 2 | loss: 0.1826644
	speed: 0.0102s/iter; left time: 268.3900s
Epoch: 2 cost time: 3.360280752182007
Epoch: 2, Steps: 268 | Train Loss: 0.2648721 Vali Loss: 0.1369325 Test Loss: 0.1958092
Validation loss decreased (0.150996 --> 0.136932).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3409365
	speed: 0.0629s/iter; left time: 1645.7965s
	iters: 200, epoch: 3 | loss: 0.3048419
	speed: 0.0129s/iter; left time: 335.0287s
Epoch: 3 cost time: 3.6656086444854736
Epoch: 3, Steps: 268 | Train Loss: 0.2540869 Vali Loss: 0.1329322 Test Loss: 0.1905367
Validation loss decreased (0.136932 --> 0.132932).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2576445
	speed: 0.0619s/iter; left time: 1602.8558s
	iters: 200, epoch: 4 | loss: 0.2344716
	speed: 0.0107s/iter; left time: 276.7424s
Epoch: 4 cost time: 3.489208936691284
Epoch: 4, Steps: 268 | Train Loss: 0.2492624 Vali Loss: 0.1315195 Test Loss: 0.1882594
Validation loss decreased (0.132932 --> 0.131519).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2343632
	speed: 0.0824s/iter; left time: 2110.8426s
	iters: 200, epoch: 5 | loss: 0.2690555
	speed: 0.0101s/iter; left time: 257.1537s
Epoch: 5 cost time: 3.20209002494812
Epoch: 5, Steps: 268 | Train Loss: 0.2467343 Vali Loss: 0.1308262 Test Loss: 0.1870699
Validation loss decreased (0.131519 --> 0.130826).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2655047
	speed: 0.0579s/iter; left time: 1469.2340s
	iters: 200, epoch: 6 | loss: 0.2062407
	speed: 0.0107s/iter; left time: 270.9854s
Epoch: 6 cost time: 3.5438902378082275
Epoch: 6, Steps: 268 | Train Loss: 0.2454753 Vali Loss: 0.1302467 Test Loss: 0.1860910
Validation loss decreased (0.130826 --> 0.130247).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2282651
	speed: 0.0599s/iter; left time: 1503.2017s
	iters: 200, epoch: 7 | loss: 0.2101439
	speed: 0.0106s/iter; left time: 263.9965s
Epoch: 7 cost time: 3.3741328716278076
Epoch: 7, Steps: 268 | Train Loss: 0.2442716 Vali Loss: 0.1300370 Test Loss: 0.1856377
Validation loss decreased (0.130247 --> 0.130037).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2982142
	speed: 0.0585s/iter; left time: 1453.4852s
	iters: 200, epoch: 8 | loss: 0.2131409
	speed: 0.0102s/iter; left time: 253.0023s
Epoch: 8 cost time: 3.272441864013672
Epoch: 8, Steps: 268 | Train Loss: 0.2431041 Vali Loss: 0.1301504 Test Loss: 0.1854789
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1581565
	speed: 0.0626s/iter; left time: 1537.2050s
	iters: 200, epoch: 9 | loss: 0.3251052
	speed: 0.0114s/iter; left time: 278.8451s
Epoch: 9 cost time: 3.541389226913452
Epoch: 9, Steps: 268 | Train Loss: 0.2431023 Vali Loss: 0.1302267 Test Loss: 0.1853546
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3218730
	speed: 0.0605s/iter; left time: 1468.5493s
	iters: 200, epoch: 10 | loss: 0.2745568
	speed: 0.0106s/iter; left time: 256.7448s
Epoch: 10 cost time: 3.4488508701324463
Epoch: 10, Steps: 268 | Train Loss: 0.2423973 Vali Loss: 0.1299837 Test Loss: 0.1851329
Validation loss decreased (0.130037 --> 0.129984).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1868248
	speed: 0.0635s/iter; left time: 1524.3369s
	iters: 200, epoch: 11 | loss: 0.2637092
	speed: 0.0108s/iter; left time: 257.5727s
Epoch: 11 cost time: 3.7177388668060303
Epoch: 11, Steps: 268 | Train Loss: 0.2423125 Vali Loss: 0.1300026 Test Loss: 0.1850089
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1767294
	speed: 0.0591s/iter; left time: 1402.7794s
	iters: 200, epoch: 12 | loss: 0.1651372
	speed: 0.0102s/iter; left time: 241.7995s
Epoch: 12 cost time: 3.1916682720184326
Epoch: 12, Steps: 268 | Train Loss: 0.2420847 Vali Loss: 0.1300406 Test Loss: 0.1849873
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3248828
	speed: 0.0601s/iter; left time: 1411.4788s
	iters: 200, epoch: 13 | loss: 0.3669770
	speed: 0.0105s/iter; left time: 246.4177s
Epoch: 13 cost time: 3.405552864074707
Epoch: 13, Steps: 268 | Train Loss: 0.2420128 Vali Loss: 0.1301308 Test Loss: 0.1849868
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1520610
	speed: 0.0594s/iter; left time: 1378.8846s
	iters: 200, epoch: 14 | loss: 0.2583154
	speed: 0.0102s/iter; left time: 235.2423s
Epoch: 14 cost time: 3.215115785598755
Epoch: 14, Steps: 268 | Train Loss: 0.2418736 Vali Loss: 0.1302948 Test Loss: 0.1850377
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2253578
	speed: 0.0607s/iter; left time: 1392.3783s
	iters: 200, epoch: 15 | loss: 0.2617392
	speed: 0.0100s/iter; left time: 229.1396s
Epoch: 15 cost time: 3.272435426712036
Epoch: 15, Steps: 268 | Train Loss: 0.2415629 Vali Loss: 0.1303024 Test Loss: 0.1850892
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2182033
	speed: 0.0618s/iter; left time: 1402.6438s
	iters: 200, epoch: 16 | loss: 0.1945173
	speed: 0.0108s/iter; left time: 244.6313s
Epoch: 16 cost time: 5.332430839538574
Epoch: 16, Steps: 268 | Train Loss: 0.2418525 Vali Loss: 0.1303725 Test Loss: 0.1850533
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2644631
	speed: 0.2001s/iter; left time: 4485.2500s
	iters: 200, epoch: 17 | loss: 0.1996562
	speed: 0.0360s/iter; left time: 803.1845s
Epoch: 17 cost time: 16.173290967941284
Epoch: 17, Steps: 268 | Train Loss: 0.2418211 Vali Loss: 0.1303926 Test Loss: 0.1850694
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1736432
	speed: 0.2002s/iter; left time: 4433.3204s
	iters: 200, epoch: 18 | loss: 0.1768035
	speed: 0.0575s/iter; left time: 1267.5269s
Epoch: 18 cost time: 12.16133189201355
Epoch: 18, Steps: 268 | Train Loss: 0.2416681 Vali Loss: 0.1304454 Test Loss: 0.1851094
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2307903
	speed: 0.1959s/iter; left time: 4286.0957s
	iters: 200, epoch: 19 | loss: 0.2481669
	speed: 0.0326s/iter; left time: 709.5149s
Epoch: 19 cost time: 12.746517658233643
Epoch: 19, Steps: 268 | Train Loss: 0.2413482 Vali Loss: 0.1304768 Test Loss: 0.1850656
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3173630
	speed: 0.1865s/iter; left time: 4029.5881s
	iters: 200, epoch: 20 | loss: 0.1975977
	speed: 0.0554s/iter; left time: 1192.1722s
Epoch: 20 cost time: 10.047975063323975
Epoch: 20, Steps: 268 | Train Loss: 0.2414398 Vali Loss: 0.1303616 Test Loss: 0.1850553
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1919972
	speed: 0.1401s/iter; left time: 2990.7578s
	iters: 200, epoch: 21 | loss: 0.1793429
	speed: 0.0547s/iter; left time: 1162.0182s
Epoch: 21 cost time: 9.174300909042358
Epoch: 21, Steps: 268 | Train Loss: 0.2414324 Vali Loss: 0.1305385 Test Loss: 0.1850563
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2433230
	speed: 0.1387s/iter; left time: 2922.2595s
	iters: 200, epoch: 22 | loss: 0.1684663
	speed: 0.0599s/iter; left time: 1256.4782s
Epoch: 22 cost time: 13.19240403175354
Epoch: 22, Steps: 268 | Train Loss: 0.2414561 Vali Loss: 0.1305313 Test Loss: 0.1850636
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3503535
	speed: 0.1967s/iter; left time: 4091.5231s
	iters: 200, epoch: 23 | loss: 0.2829697
	speed: 0.0306s/iter; left time: 633.3589s
Epoch: 23 cost time: 14.206865549087524
Epoch: 23, Steps: 268 | Train Loss: 0.2415450 Vali Loss: 0.1303404 Test Loss: 0.1850238
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1785660
	speed: 0.1641s/iter; left time: 3370.5972s
	iters: 200, epoch: 24 | loss: 0.3944275
	speed: 0.0100s/iter; left time: 204.2630s
Epoch: 24 cost time: 3.352621555328369
Epoch: 24, Steps: 268 | Train Loss: 0.2415810 Vali Loss: 0.1304119 Test Loss: 0.1850474
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2475779
	speed: 0.0615s/iter; left time: 1246.5795s
	iters: 200, epoch: 25 | loss: 0.1782858
	speed: 0.0121s/iter; left time: 243.0428s
Epoch: 25 cost time: 3.7915399074554443
Epoch: 25, Steps: 268 | Train Loss: 0.2415666 Vali Loss: 0.1303952 Test Loss: 0.1850268
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3152379
	speed: 0.0601s/iter; left time: 1201.8649s
	iters: 200, epoch: 26 | loss: 0.1907618
	speed: 0.0101s/iter; left time: 200.9957s
Epoch: 26 cost time: 3.340571641921997
Epoch: 26, Steps: 268 | Train Loss: 0.2412691 Vali Loss: 0.1303674 Test Loss: 0.1850333
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2338034
	speed: 0.0605s/iter; left time: 1193.0505s
	iters: 200, epoch: 27 | loss: 0.2416487
	speed: 0.0100s/iter; left time: 196.9912s
Epoch: 27 cost time: 3.3341121673583984
Epoch: 27, Steps: 268 | Train Loss: 0.2411924 Vali Loss: 0.1305532 Test Loss: 0.1850494
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1839740
	speed: 0.0591s/iter; left time: 1149.8522s
	iters: 200, epoch: 28 | loss: 0.5204183
	speed: 0.0100s/iter; left time: 192.7330s
Epoch: 28 cost time: 3.270557165145874
Epoch: 28, Steps: 268 | Train Loss: 0.2413742 Vali Loss: 0.1305346 Test Loss: 0.1850472
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2676682
	speed: 0.0684s/iter; left time: 1312.6033s
	iters: 200, epoch: 29 | loss: 0.3122605
	speed: 0.0107s/iter; left time: 203.7790s
Epoch: 29 cost time: 3.3188998699188232
Epoch: 29, Steps: 268 | Train Loss: 0.2413609 Vali Loss: 0.1304994 Test Loss: 0.1850620
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3107437
	speed: 0.0618s/iter; left time: 1170.7356s
	iters: 200, epoch: 30 | loss: 0.2714220
	speed: 0.0100s/iter; left time: 188.7958s
Epoch: 30 cost time: 3.454591751098633
Epoch: 30, Steps: 268 | Train Loss: 0.2413022 Vali Loss: 0.1304866 Test Loss: 0.1850118
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_90_96_FITS_ETTm2_ftM_sl90_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.18598145246505737, mae:0.26962631940841675, rse:0.34964796900749207, corr:[0.56935674 0.5719829  0.5661439  0.56109554 0.56031656 0.5613117
 0.560852   0.5586743  0.5566244  0.5560334  0.5563891  0.55632174
 0.5552463  0.55378497 0.5529506  0.552874   0.55273783 0.5518294
 0.55029595 0.54886264 0.54811376 0.54786927 0.5474901  0.5467112
 0.54575497 0.5450585  0.5448355  0.5447054  0.5442142  0.54338366
 0.54246616 0.54180443 0.5413583  0.5409204  0.54034364 0.53971016
 0.53908575 0.5384887  0.53784084 0.53709877 0.5363457  0.53581613
 0.53557765 0.53547454 0.5352476  0.5346963  0.5339373  0.5330613
 0.532246   0.53155476 0.5308887  0.5301818  0.5293943  0.5285794
 0.52793294 0.5274383  0.52691686 0.5263546  0.5257881  0.52545154
 0.5253262  0.5253085  0.52528214 0.5252006  0.5250608  0.52493215
 0.5248635  0.524798   0.52475667 0.52472985 0.5247813  0.5249487
 0.52513003 0.5252761  0.5252128  0.5249953  0.5248157  0.5247364
 0.52479154 0.5248337  0.52471894 0.52448326 0.5242932  0.52423394
 0.52420306 0.5240008  0.5235879  0.5232137  0.5230789  0.52314156
 0.5231475  0.522955   0.5225711  0.5224707  0.5225183  0.52095056]
