Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=18, out_features=27, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  435456.0
params:  513.0
Trainable parameters:  513
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2147669
	speed: 0.0753s/iter; left time: 2002.5250s
	iters: 200, epoch: 1 | loss: 0.1836774
	speed: 0.0651s/iter; left time: 1724.9908s
Epoch: 1 cost time: 18.73257565498352
Epoch: 1, Steps: 267 | Train Loss: 0.2306413 Vali Loss: 0.1737571 Test Loss: 0.2397759
Validation loss decreased (inf --> 0.173757).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1616153
	speed: 0.2463s/iter; left time: 6486.0271s
	iters: 200, epoch: 2 | loss: 0.1505130
	speed: 0.0648s/iter; left time: 1698.9869s
Epoch: 2 cost time: 17.3042995929718
Epoch: 2, Steps: 267 | Train Loss: 0.1566479 Vali Loss: 0.1545858 Test Loss: 0.2136063
Validation loss decreased (0.173757 --> 0.154586).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1329603
	speed: 0.2394s/iter; left time: 6240.2060s
	iters: 200, epoch: 3 | loss: 0.1315578
	speed: 0.0487s/iter; left time: 1264.7078s
Epoch: 3 cost time: 14.609179019927979
Epoch: 3, Steps: 267 | Train Loss: 0.1273174 Vali Loss: 0.1444290 Test Loss: 0.2002658
Validation loss decreased (0.154586 --> 0.144429).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1023923
	speed: 0.2394s/iter; left time: 6177.3905s
	iters: 200, epoch: 4 | loss: 0.1069964
	speed: 0.0666s/iter; left time: 1712.8516s
Epoch: 4 cost time: 17.106396675109863
Epoch: 4, Steps: 267 | Train Loss: 0.1130831 Vali Loss: 0.1381277 Test Loss: 0.1923676
Validation loss decreased (0.144429 --> 0.138128).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1131990
	speed: 0.2637s/iter; left time: 6733.0218s
	iters: 200, epoch: 5 | loss: 0.1026976
	speed: 0.0494s/iter; left time: 1255.3964s
Epoch: 5 cost time: 13.765903234481812
Epoch: 5, Steps: 267 | Train Loss: 0.1051793 Vali Loss: 0.1340981 Test Loss: 0.1872177
Validation loss decreased (0.138128 --> 0.134098).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1108571
	speed: 0.2601s/iter; left time: 6571.8920s
	iters: 200, epoch: 6 | loss: 0.1366751
	speed: 0.0485s/iter; left time: 1221.0838s
Epoch: 6 cost time: 15.837955951690674
Epoch: 6, Steps: 267 | Train Loss: 0.1010376 Vali Loss: 0.1315708 Test Loss: 0.1838691
Validation loss decreased (0.134098 --> 0.131571).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0743621
	speed: 0.2230s/iter; left time: 5574.6112s
	iters: 200, epoch: 7 | loss: 0.0860931
	speed: 0.0603s/iter; left time: 1501.8873s
Epoch: 7 cost time: 16.584065198898315
Epoch: 7, Steps: 267 | Train Loss: 0.0983656 Vali Loss: 0.1296503 Test Loss: 0.1816189
Validation loss decreased (0.131571 --> 0.129650).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0848682
	speed: 0.2203s/iter; left time: 5449.3705s
	iters: 200, epoch: 8 | loss: 0.0951218
	speed: 0.0619s/iter; left time: 1525.2443s
Epoch: 8 cost time: 15.56060242652893
Epoch: 8, Steps: 267 | Train Loss: 0.0971365 Vali Loss: 0.1286033 Test Loss: 0.1801117
Validation loss decreased (0.129650 --> 0.128603).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0704315
	speed: 0.2349s/iter; left time: 5746.8545s
	iters: 200, epoch: 9 | loss: 0.1390297
	speed: 0.0567s/iter; left time: 1380.6393s
Epoch: 9 cost time: 15.999570608139038
Epoch: 9, Steps: 267 | Train Loss: 0.0962608 Vali Loss: 0.1279328 Test Loss: 0.1792708
Validation loss decreased (0.128603 --> 0.127933).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1317258
	speed: 0.1512s/iter; left time: 3659.1921s
	iters: 200, epoch: 10 | loss: 0.0807950
	speed: 0.0295s/iter; left time: 711.7493s
Epoch: 10 cost time: 8.360416650772095
Epoch: 10, Steps: 267 | Train Loss: 0.0958669 Vali Loss: 0.1272626 Test Loss: 0.1785534
Validation loss decreased (0.127933 --> 0.127263).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0665458
	speed: 0.0931s/iter; left time: 2228.3819s
	iters: 200, epoch: 11 | loss: 0.0906367
	speed: 0.0308s/iter; left time: 735.0039s
Epoch: 11 cost time: 7.1717774868011475
Epoch: 11, Steps: 267 | Train Loss: 0.0954575 Vali Loss: 0.1270577 Test Loss: 0.1781659
Validation loss decreased (0.127263 --> 0.127058).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0705321
	speed: 0.2376s/iter; left time: 5621.3931s
	iters: 200, epoch: 12 | loss: 0.0756337
	speed: 0.0611s/iter; left time: 1439.7671s
Epoch: 12 cost time: 17.221681118011475
Epoch: 12, Steps: 267 | Train Loss: 0.0954295 Vali Loss: 0.1269104 Test Loss: 0.1778551
Validation loss decreased (0.127058 --> 0.126910).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0768867
	speed: 0.2455s/iter; left time: 5743.9038s
	iters: 200, epoch: 13 | loss: 0.1172682
	speed: 0.0567s/iter; left time: 1321.5311s
Epoch: 13 cost time: 15.378912210464478
Epoch: 13, Steps: 267 | Train Loss: 0.0953645 Vali Loss: 0.1267717 Test Loss: 0.1776662
Validation loss decreased (0.126910 --> 0.126772).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1687816
	speed: 0.2771s/iter; left time: 6408.9244s
	iters: 200, epoch: 14 | loss: 0.0581086
	speed: 0.0618s/iter; left time: 1422.3424s
Epoch: 14 cost time: 17.269022941589355
Epoch: 14, Steps: 267 | Train Loss: 0.0952863 Vali Loss: 0.1268049 Test Loss: 0.1776266
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0698716
	speed: 0.2682s/iter; left time: 6130.8399s
	iters: 200, epoch: 15 | loss: 0.1085531
	speed: 0.0527s/iter; left time: 1199.4649s
Epoch: 15 cost time: 16.584827661514282
Epoch: 15, Steps: 267 | Train Loss: 0.0950865 Vali Loss: 0.1267331 Test Loss: 0.1774510
Validation loss decreased (0.126772 --> 0.126733).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1076712
	speed: 0.2341s/iter; left time: 5290.7247s
	iters: 200, epoch: 16 | loss: 0.1350775
	speed: 0.0607s/iter; left time: 1364.4237s
Epoch: 16 cost time: 16.401270151138306
Epoch: 16, Steps: 267 | Train Loss: 0.0952752 Vali Loss: 0.1266727 Test Loss: 0.1774161
Validation loss decreased (0.126733 --> 0.126673).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0729863
	speed: 0.1912s/iter; left time: 4269.1919s
	iters: 200, epoch: 17 | loss: 0.0793088
	speed: 0.0286s/iter; left time: 636.7761s
Epoch: 17 cost time: 10.769653558731079
Epoch: 17, Steps: 267 | Train Loss: 0.0951837 Vali Loss: 0.1266242 Test Loss: 0.1773866
Validation loss decreased (0.126673 --> 0.126624).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0996513
	speed: 0.2253s/iter; left time: 4970.8412s
	iters: 200, epoch: 18 | loss: 0.0667057
	speed: 0.0458s/iter; left time: 1005.3727s
Epoch: 18 cost time: 13.492871522903442
Epoch: 18, Steps: 267 | Train Loss: 0.0952152 Vali Loss: 0.1267100 Test Loss: 0.1774844
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0769472
	speed: 0.2664s/iter; left time: 5806.1078s
	iters: 200, epoch: 19 | loss: 0.0822359
	speed: 0.0573s/iter; left time: 1243.8880s
Epoch: 19 cost time: 15.616543054580688
Epoch: 19, Steps: 267 | Train Loss: 0.0950888 Vali Loss: 0.1268304 Test Loss: 0.1775175
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0626037
	speed: 0.2597s/iter; left time: 5591.7458s
	iters: 200, epoch: 20 | loss: 0.1036292
	speed: 0.0609s/iter; left time: 1305.9478s
Epoch: 20 cost time: 15.633408069610596
Epoch: 20, Steps: 267 | Train Loss: 0.0952297 Vali Loss: 0.1267947 Test Loss: 0.1774363
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0991260
	speed: 0.1630s/iter; left time: 3465.7805s
	iters: 200, epoch: 21 | loss: 0.0830860
	speed: 0.0649s/iter; left time: 1373.3801s
Epoch: 21 cost time: 15.980416774749756
Epoch: 21, Steps: 267 | Train Loss: 0.0951326 Vali Loss: 0.1266815 Test Loss: 0.1774610
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0905790
	speed: 0.2452s/iter; left time: 5148.3187s
	iters: 200, epoch: 22 | loss: 0.0820823
	speed: 0.0269s/iter; left time: 562.3937s
Epoch: 22 cost time: 7.341527462005615
Epoch: 22, Steps: 267 | Train Loss: 0.0951306 Vali Loss: 0.1267233 Test Loss: 0.1774194
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0717046
	speed: 0.1268s/iter; left time: 2629.1224s
	iters: 200, epoch: 23 | loss: 0.0771982
	speed: 0.0290s/iter; left time: 598.2772s
Epoch: 23 cost time: 10.36410927772522
Epoch: 23, Steps: 267 | Train Loss: 0.0951123 Vali Loss: 0.1266499 Test Loss: 0.1774241
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1370565
	speed: 0.1722s/iter; left time: 3522.3204s
	iters: 200, epoch: 24 | loss: 0.0792748
	speed: 0.0552s/iter; left time: 1124.0041s
Epoch: 24 cost time: 14.402813911437988
Epoch: 24, Steps: 267 | Train Loss: 0.0951544 Vali Loss: 0.1267719 Test Loss: 0.1774609
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0776279
	speed: 0.1981s/iter; left time: 4000.1638s
	iters: 200, epoch: 25 | loss: 0.0945105
	speed: 0.0520s/iter; left time: 1045.3791s
Epoch: 25 cost time: 14.54776406288147
Epoch: 25, Steps: 267 | Train Loss: 0.0951800 Vali Loss: 0.1266667 Test Loss: 0.1774619
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1166368
	speed: 0.1413s/iter; left time: 2814.6251s
	iters: 200, epoch: 26 | loss: 0.1104691
	speed: 0.0414s/iter; left time: 820.3546s
Epoch: 26 cost time: 11.80317497253418
Epoch: 26, Steps: 267 | Train Loss: 0.0951498 Vali Loss: 0.1266526 Test Loss: 0.1774405
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0698413
	speed: 0.2151s/iter; left time: 4228.2399s
	iters: 200, epoch: 27 | loss: 0.1074745
	speed: 0.0597s/iter; left time: 1166.9153s
Epoch: 27 cost time: 16.035752534866333
Epoch: 27, Steps: 267 | Train Loss: 0.0951972 Vali Loss: 0.1268160 Test Loss: 0.1774456
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0885724
	speed: 0.3007s/iter; left time: 5830.3870s
	iters: 200, epoch: 28 | loss: 0.0921915
	speed: 0.0589s/iter; left time: 1136.5942s
Epoch: 28 cost time: 16.522674560546875
Epoch: 28, Steps: 267 | Train Loss: 0.0951017 Vali Loss: 0.1267240 Test Loss: 0.1774294
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1039217
	speed: 0.2624s/iter; left time: 5019.0289s
	iters: 200, epoch: 29 | loss: 0.0766367
	speed: 0.0618s/iter; left time: 1175.7845s
Epoch: 29 cost time: 18.08399796485901
Epoch: 29, Steps: 267 | Train Loss: 0.0951922 Vali Loss: 0.1267283 Test Loss: 0.1774177
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1002072
	speed: 0.2379s/iter; left time: 4485.8675s
	iters: 200, epoch: 30 | loss: 0.0895421
	speed: 0.0561s/iter; left time: 1052.3191s
Epoch: 30 cost time: 15.213188648223877
Epoch: 30, Steps: 267 | Train Loss: 0.0951950 Vali Loss: 0.1266747 Test Loss: 0.1774229
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0930380
	speed: 0.1574s/iter; left time: 2925.9261s
	iters: 200, epoch: 31 | loss: 0.0828288
	speed: 0.0410s/iter; left time: 758.5764s
Epoch: 31 cost time: 10.589065074920654
Epoch: 31, Steps: 267 | Train Loss: 0.0951651 Vali Loss: 0.1265426 Test Loss: 0.1774136
Validation loss decreased (0.126624 --> 0.126543).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1295122
	speed: 0.2032s/iter; left time: 3723.8391s
	iters: 200, epoch: 32 | loss: 0.0650483
	speed: 0.0403s/iter; left time: 733.9864s
Epoch: 32 cost time: 12.265828132629395
Epoch: 32, Steps: 267 | Train Loss: 0.0952080 Vali Loss: 0.1267017 Test Loss: 0.1774375
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0795878
	speed: 0.1487s/iter; left time: 2684.7551s
	iters: 200, epoch: 33 | loss: 0.0875270
	speed: 0.0518s/iter; left time: 929.4316s
Epoch: 33 cost time: 13.176456451416016
Epoch: 33, Steps: 267 | Train Loss: 0.0950367 Vali Loss: 0.1266606 Test Loss: 0.1774815
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0620906
	speed: 0.2287s/iter; left time: 4068.4752s
	iters: 200, epoch: 34 | loss: 0.0739303
	speed: 0.0604s/iter; left time: 1069.0724s
Epoch: 34 cost time: 16.97018337249756
Epoch: 34, Steps: 267 | Train Loss: 0.0951226 Vali Loss: 0.1268002 Test Loss: 0.1774530
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0789418
	speed: 0.2518s/iter; left time: 4413.1148s
	iters: 200, epoch: 35 | loss: 0.1136257
	speed: 0.0642s/iter; left time: 1119.1238s
Epoch: 35 cost time: 18.077306509017944
Epoch: 35, Steps: 267 | Train Loss: 0.0951060 Vali Loss: 0.1267350 Test Loss: 0.1774585
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1329440
	speed: 0.3365s/iter; left time: 5807.3600s
	iters: 200, epoch: 36 | loss: 0.0974300
	speed: 0.0792s/iter; left time: 1358.5430s
Epoch: 36 cost time: 23.039313793182373
Epoch: 36, Steps: 267 | Train Loss: 0.0951361 Vali Loss: 0.1267477 Test Loss: 0.1774496
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0930224
	speed: 0.2407s/iter; left time: 4089.9486s
	iters: 200, epoch: 37 | loss: 0.0908283
	speed: 0.0666s/iter; left time: 1124.8879s
Epoch: 37 cost time: 14.703901290893555
Epoch: 37, Steps: 267 | Train Loss: 0.0950784 Vali Loss: 0.1267788 Test Loss: 0.1774508
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1224571
	speed: 0.2120s/iter; left time: 3545.4560s
	iters: 200, epoch: 38 | loss: 0.1124516
	speed: 0.0615s/iter; left time: 1022.0437s
Epoch: 38 cost time: 14.669052600860596
Epoch: 38, Steps: 267 | Train Loss: 0.0950248 Vali Loss: 0.1267732 Test Loss: 0.1774699
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1434037
	speed: 0.2950s/iter; left time: 4854.6992s
	iters: 200, epoch: 39 | loss: 0.0684889
	speed: 0.0678s/iter; left time: 1108.4092s
Epoch: 39 cost time: 19.092055082321167
Epoch: 39, Steps: 267 | Train Loss: 0.0951259 Vali Loss: 0.1267706 Test Loss: 0.1774663
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1108619
	speed: 0.3173s/iter; left time: 5136.3012s
	iters: 200, epoch: 40 | loss: 0.1465804
	speed: 0.0717s/iter; left time: 1152.9206s
Epoch: 40 cost time: 19.390827655792236
Epoch: 40, Steps: 267 | Train Loss: 0.0951808 Vali Loss: 0.1267055 Test Loss: 0.1774408
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0762325
	speed: 0.3119s/iter; left time: 4966.4653s
	iters: 200, epoch: 41 | loss: 0.0901139
	speed: 0.0722s/iter; left time: 1142.5295s
Epoch: 41 cost time: 19.756965398788452
Epoch: 41, Steps: 267 | Train Loss: 0.0951072 Vali Loss: 0.1267275 Test Loss: 0.1774767
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0947246
	speed: 0.3210s/iter; left time: 5024.1993s
	iters: 200, epoch: 42 | loss: 0.1102744
	speed: 0.0631s/iter; left time: 982.1500s
Epoch: 42 cost time: 17.35235333442688
Epoch: 42, Steps: 267 | Train Loss: 0.0950480 Vali Loss: 0.1267584 Test Loss: 0.1774437
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0858985
	speed: 0.1808s/iter; left time: 2781.6701s
	iters: 200, epoch: 43 | loss: 0.1014514
	speed: 0.0661s/iter; left time: 1011.1930s
Epoch: 43 cost time: 15.493906259536743
Epoch: 43, Steps: 267 | Train Loss: 0.0950841 Vali Loss: 0.1267966 Test Loss: 0.1774702
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1279639
	speed: 0.2512s/iter; left time: 3798.4221s
	iters: 200, epoch: 44 | loss: 0.0690447
	speed: 0.0630s/iter; left time: 946.9712s
Epoch: 44 cost time: 16.307082653045654
Epoch: 44, Steps: 267 | Train Loss: 0.0950844 Vali Loss: 0.1267614 Test Loss: 0.1774624
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0969319
	speed: 0.2892s/iter; left time: 4296.2060s
	iters: 200, epoch: 45 | loss: 0.1046714
	speed: 0.0671s/iter; left time: 989.3416s
Epoch: 45 cost time: 17.86888813972473
Epoch: 45, Steps: 267 | Train Loss: 0.0952009 Vali Loss: 0.1268343 Test Loss: 0.1774775
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0779676
	speed: 0.3152s/iter; left time: 4598.0282s
	iters: 200, epoch: 46 | loss: 0.1161948
	speed: 0.0525s/iter; left time: 760.1425s
Epoch: 46 cost time: 17.15868878364563
Epoch: 46, Steps: 267 | Train Loss: 0.0951756 Vali Loss: 0.1268350 Test Loss: 0.1774502
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.0886331
	speed: 0.3062s/iter; left time: 4383.8858s
	iters: 200, epoch: 47 | loss: 0.1133713
	speed: 0.0700s/iter; left time: 996.0265s
Epoch: 47 cost time: 18.669140815734863
Epoch: 47, Steps: 267 | Train Loss: 0.0951719 Vali Loss: 0.1268852 Test Loss: 0.1774613
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.0783591
	speed: 0.2689s/iter; left time: 3778.5982s
	iters: 200, epoch: 48 | loss: 0.1048470
	speed: 0.0592s/iter; left time: 825.7204s
Epoch: 48 cost time: 15.312791585922241
Epoch: 48, Steps: 267 | Train Loss: 0.0949094 Vali Loss: 0.1268273 Test Loss: 0.1774452
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1052661
	speed: 0.1834s/iter; left time: 2527.9255s
	iters: 200, epoch: 49 | loss: 0.0825861
	speed: 0.0531s/iter; left time: 726.0275s
Epoch: 49 cost time: 12.109829187393188
Epoch: 49, Steps: 267 | Train Loss: 0.0951275 Vali Loss: 0.1268239 Test Loss: 0.1774532
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.0996252
	speed: 0.1611s/iter; left time: 2178.1367s
	iters: 200, epoch: 50 | loss: 0.1124680
	speed: 0.0622s/iter; left time: 834.0890s
Epoch: 50 cost time: 13.895281314849854
Epoch: 50, Steps: 267 | Train Loss: 0.0951389 Vali Loss: 0.1268487 Test Loss: 0.1774679
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1216940
	speed: 0.1902s/iter; left time: 2520.2581s
	iters: 200, epoch: 51 | loss: 0.0975980
	speed: 0.0617s/iter; left time: 811.7341s
Epoch: 51 cost time: 15.988012313842773
Epoch: 51, Steps: 267 | Train Loss: 0.0951040 Vali Loss: 0.1267962 Test Loss: 0.1774649
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=18, out_features=27, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  435456.0
params:  513.0
Trainable parameters:  513
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2777693
	speed: 0.0416s/iter; left time: 1107.9058s
	iters: 200, epoch: 1 | loss: 0.1890047
	speed: 0.0642s/iter; left time: 1700.1086s
Epoch: 1 cost time: 15.522873878479004
Epoch: 1, Steps: 267 | Train Loss: 0.2355678 Vali Loss: 0.1254846 Test Loss: 0.1758425
Validation loss decreased (inf --> 0.125485).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1522360
	speed: 0.2894s/iter; left time: 7620.3945s
	iters: 200, epoch: 2 | loss: 0.2479350
	speed: 0.0573s/iter; left time: 1503.3597s
Epoch: 2 cost time: 16.664759397506714
Epoch: 2, Steps: 267 | Train Loss: 0.2345839 Vali Loss: 0.1251374 Test Loss: 0.1754491
Validation loss decreased (0.125485 --> 0.125137).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2384964
	speed: 0.2851s/iter; left time: 7431.1578s
	iters: 200, epoch: 3 | loss: 0.2457364
	speed: 0.0671s/iter; left time: 1743.1924s
Epoch: 3 cost time: 17.503739595413208
Epoch: 3, Steps: 267 | Train Loss: 0.2340297 Vali Loss: 0.1252152 Test Loss: 0.1752457
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2208787
	speed: 0.2776s/iter; left time: 7163.2132s
	iters: 200, epoch: 4 | loss: 0.1897242
	speed: 0.0352s/iter; left time: 904.6278s
Epoch: 4 cost time: 11.349010705947876
Epoch: 4, Steps: 267 | Train Loss: 0.2337068 Vali Loss: 0.1249230 Test Loss: 0.1751894
Validation loss decreased (0.125137 --> 0.124923).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2232421
	speed: 0.1502s/iter; left time: 3835.2627s
	iters: 200, epoch: 5 | loss: 0.2795955
	speed: 0.0350s/iter; left time: 890.2431s
Epoch: 5 cost time: 11.83887505531311
Epoch: 5, Steps: 267 | Train Loss: 0.2334410 Vali Loss: 0.1247570 Test Loss: 0.1749326
Validation loss decreased (0.124923 --> 0.124757).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2285386
	speed: 0.1724s/iter; left time: 4356.0843s
	iters: 200, epoch: 6 | loss: 0.2170548
	speed: 0.0668s/iter; left time: 1680.6248s
Epoch: 6 cost time: 15.959163665771484
Epoch: 6, Steps: 267 | Train Loss: 0.2326235 Vali Loss: 0.1249650 Test Loss: 0.1749842
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1853481
	speed: 0.2167s/iter; left time: 5416.9900s
	iters: 200, epoch: 7 | loss: 0.1645973
	speed: 0.0557s/iter; left time: 1385.7961s
Epoch: 7 cost time: 15.866050720214844
Epoch: 7, Steps: 267 | Train Loss: 0.2326476 Vali Loss: 0.1247463 Test Loss: 0.1744525
Validation loss decreased (0.124757 --> 0.124746).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1464779
	speed: 0.1853s/iter; left time: 4581.6872s
	iters: 200, epoch: 8 | loss: 0.1916440
	speed: 0.0616s/iter; left time: 1516.5698s
Epoch: 8 cost time: 16.726425647735596
Epoch: 8, Steps: 267 | Train Loss: 0.2331078 Vali Loss: 0.1246214 Test Loss: 0.1746534
Validation loss decreased (0.124746 --> 0.124621).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1942238
	speed: 0.2766s/iter; left time: 6766.5579s
	iters: 200, epoch: 9 | loss: 0.2323403
	speed: 0.0585s/iter; left time: 1426.2691s
Epoch: 9 cost time: 17.019281148910522
Epoch: 9, Steps: 267 | Train Loss: 0.2320895 Vali Loss: 0.1246492 Test Loss: 0.1746440
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1495892
	speed: 0.2234s/iter; left time: 5405.5550s
	iters: 200, epoch: 10 | loss: 0.2688672
	speed: 0.0544s/iter; left time: 1310.5395s
Epoch: 10 cost time: 16.299296379089355
Epoch: 10, Steps: 267 | Train Loss: 0.2326141 Vali Loss: 0.1247891 Test Loss: 0.1744779
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2928861
	speed: 0.2781s/iter; left time: 6656.2514s
	iters: 200, epoch: 11 | loss: 0.2974255
	speed: 0.0639s/iter; left time: 1522.8171s
Epoch: 11 cost time: 15.821969509124756
Epoch: 11, Steps: 267 | Train Loss: 0.2326669 Vali Loss: 0.1245858 Test Loss: 0.1746444
Validation loss decreased (0.124621 --> 0.124586).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3476121
	speed: 0.2272s/iter; left time: 5377.2414s
	iters: 200, epoch: 12 | loss: 0.2985143
	speed: 0.0601s/iter; left time: 1415.4987s
Epoch: 12 cost time: 17.1889750957489
Epoch: 12, Steps: 267 | Train Loss: 0.2322684 Vali Loss: 0.1245807 Test Loss: 0.1746495
Validation loss decreased (0.124586 --> 0.124581).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1842916
	speed: 0.2643s/iter; left time: 6184.8155s
	iters: 200, epoch: 13 | loss: 0.2502642
	speed: 0.0675s/iter; left time: 1573.1355s
Epoch: 13 cost time: 17.161085605621338
Epoch: 13, Steps: 267 | Train Loss: 0.2322034 Vali Loss: 0.1246626 Test Loss: 0.1744070
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2857402
	speed: 0.2844s/iter; left time: 6579.0823s
	iters: 200, epoch: 14 | loss: 0.3416130
	speed: 0.0628s/iter; left time: 1447.0977s
Epoch: 14 cost time: 17.75234866142273
Epoch: 14, Steps: 267 | Train Loss: 0.2323480 Vali Loss: 0.1245468 Test Loss: 0.1744327
Validation loss decreased (0.124581 --> 0.124547).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3148230
	speed: 0.3215s/iter; left time: 7349.9474s
	iters: 200, epoch: 15 | loss: 0.2615536
	speed: 0.0695s/iter; left time: 1582.8175s
Epoch: 15 cost time: 19.214438915252686
Epoch: 15, Steps: 267 | Train Loss: 0.2322737 Vali Loss: 0.1246356 Test Loss: 0.1744114
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2689759
	speed: 0.3167s/iter; left time: 7156.2134s
	iters: 200, epoch: 16 | loss: 0.2638960
	speed: 0.0625s/iter; left time: 1406.4111s
Epoch: 16 cost time: 17.696038484573364
Epoch: 16, Steps: 267 | Train Loss: 0.2323588 Vali Loss: 0.1246813 Test Loss: 0.1745349
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3648898
	speed: 0.2608s/iter; left time: 5822.6675s
	iters: 200, epoch: 17 | loss: 0.2531929
	speed: 0.0319s/iter; left time: 709.0343s
Epoch: 17 cost time: 10.140522956848145
Epoch: 17, Steps: 267 | Train Loss: 0.2320484 Vali Loss: 0.1246007 Test Loss: 0.1744799
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2929761
	speed: 0.1470s/iter; left time: 3242.8474s
	iters: 200, epoch: 18 | loss: 0.2443336
	speed: 0.0505s/iter; left time: 1108.3375s
Epoch: 18 cost time: 12.166464805603027
Epoch: 18, Steps: 267 | Train Loss: 0.2320810 Vali Loss: 0.1246218 Test Loss: 0.1744310
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2135421
	speed: 0.1718s/iter; left time: 3744.8957s
	iters: 200, epoch: 19 | loss: 0.1731867
	speed: 0.0434s/iter; left time: 941.0404s
Epoch: 19 cost time: 11.34125828742981
Epoch: 19, Steps: 267 | Train Loss: 0.2321921 Vali Loss: 0.1246030 Test Loss: 0.1744646
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2727051
	speed: 0.1365s/iter; left time: 2937.5208s
	iters: 200, epoch: 20 | loss: 0.2333891
	speed: 0.0465s/iter; left time: 996.6498s
Epoch: 20 cost time: 11.597442388534546
Epoch: 20, Steps: 267 | Train Loss: 0.2320906 Vali Loss: 0.1246287 Test Loss: 0.1744689
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1546349
	speed: 0.1567s/iter; left time: 3330.7472s
	iters: 200, epoch: 21 | loss: 0.1671017
	speed: 0.0346s/iter; left time: 731.9881s
Epoch: 21 cost time: 7.735506296157837
Epoch: 21, Steps: 267 | Train Loss: 0.2321863 Vali Loss: 0.1247002 Test Loss: 0.1744541
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2009358
	speed: 0.2310s/iter; left time: 4849.9754s
	iters: 200, epoch: 22 | loss: 0.3225984
	speed: 0.0654s/iter; left time: 1365.9060s
Epoch: 22 cost time: 18.74613642692566
Epoch: 22, Steps: 267 | Train Loss: 0.2319503 Vali Loss: 0.1245508 Test Loss: 0.1744459
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2237597
	speed: 0.2968s/iter; left time: 6152.4160s
	iters: 200, epoch: 23 | loss: 0.2207015
	speed: 0.0712s/iter; left time: 1469.3241s
Epoch: 23 cost time: 18.536420583724976
Epoch: 23, Steps: 267 | Train Loss: 0.2321837 Vali Loss: 0.1246775 Test Loss: 0.1744901
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1769815
	speed: 0.2900s/iter; left time: 5932.4940s
	iters: 200, epoch: 24 | loss: 0.2151443
	speed: 0.0469s/iter; left time: 955.6154s
Epoch: 24 cost time: 15.076257467269897
Epoch: 24, Steps: 267 | Train Loss: 0.2316068 Vali Loss: 0.1246832 Test Loss: 0.1744357
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2240333
	speed: 0.1640s/iter; left time: 3311.7699s
	iters: 200, epoch: 25 | loss: 0.2167027
	speed: 0.0508s/iter; left time: 1021.7272s
Epoch: 25 cost time: 10.651423692703247
Epoch: 25, Steps: 267 | Train Loss: 0.2322695 Vali Loss: 0.1246590 Test Loss: 0.1744675
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1948715
	speed: 0.1079s/iter; left time: 2149.8452s
	iters: 200, epoch: 26 | loss: 0.1333484
	speed: 0.0466s/iter; left time: 924.0137s
Epoch: 26 cost time: 10.600288152694702
Epoch: 26, Steps: 267 | Train Loss: 0.2321293 Vali Loss: 0.1246387 Test Loss: 0.1744468
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2475227
	speed: 0.2042s/iter; left time: 4014.0429s
	iters: 200, epoch: 27 | loss: 0.1768204
	speed: 0.0549s/iter; left time: 1074.2578s
Epoch: 27 cost time: 15.060258865356445
Epoch: 27, Steps: 267 | Train Loss: 0.2322343 Vali Loss: 0.1246923 Test Loss: 0.1743832
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2114585
	speed: 0.2539s/iter; left time: 4923.1814s
	iters: 200, epoch: 28 | loss: 0.2634113
	speed: 0.0669s/iter; left time: 1290.6468s
Epoch: 28 cost time: 17.86562991142273
Epoch: 28, Steps: 267 | Train Loss: 0.2319220 Vali Loss: 0.1246379 Test Loss: 0.1743964
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2193044
	speed: 0.3444s/iter; left time: 6586.1998s
	iters: 200, epoch: 29 | loss: 0.4515628
	speed: 0.0701s/iter; left time: 1333.3958s
Epoch: 29 cost time: 19.450933694839478
Epoch: 29, Steps: 267 | Train Loss: 0.2318469 Vali Loss: 0.1245791 Test Loss: 0.1743942
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2688649
	speed: 0.3235s/iter; left time: 6100.9102s
	iters: 200, epoch: 30 | loss: 0.2820898
	speed: 0.0686s/iter; left time: 1286.9436s
Epoch: 30 cost time: 18.826202154159546
Epoch: 30, Steps: 267 | Train Loss: 0.2322111 Vali Loss: 0.1246026 Test Loss: 0.1744458
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1875071
	speed: 0.3008s/iter; left time: 5592.4648s
	iters: 200, epoch: 31 | loss: 0.1942478
	speed: 0.0678s/iter; left time: 1252.8974s
Epoch: 31 cost time: 18.789119958877563
Epoch: 31, Steps: 267 | Train Loss: 0.2320583 Vali Loss: 0.1246175 Test Loss: 0.1743999
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3372472
	speed: 0.1968s/iter; left time: 3606.2415s
	iters: 200, epoch: 32 | loss: 0.3364049
	speed: 0.0549s/iter; left time: 1000.9637s
Epoch: 32 cost time: 16.0609393119812
Epoch: 32, Steps: 267 | Train Loss: 0.2321095 Vali Loss: 0.1246556 Test Loss: 0.1743907
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3290470
	speed: 0.2216s/iter; left time: 4000.8311s
	iters: 200, epoch: 33 | loss: 0.3593490
	speed: 0.0487s/iter; left time: 874.3478s
Epoch: 33 cost time: 14.602321863174438
Epoch: 33, Steps: 267 | Train Loss: 0.2320309 Vali Loss: 0.1246776 Test Loss: 0.1744160
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1664504
	speed: 0.1479s/iter; left time: 2631.5720s
	iters: 200, epoch: 34 | loss: 0.2687906
	speed: 0.0357s/iter; left time: 631.5062s
Epoch: 34 cost time: 11.383962154388428
Epoch: 34, Steps: 267 | Train Loss: 0.2317920 Vali Loss: 0.1246492 Test Loss: 0.1744272
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_180_96_FITS_ETTm2_ftM_sl180_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.17518417537212372, mae:0.26079753041267395, rse:0.33934667706489563, corr:[0.56825924 0.57005596 0.5697159  0.5678606  0.56545407 0.56329083
 0.561882   0.56122833 0.56111664 0.5612515  0.5612863  0.56103545
 0.56040925 0.5594195  0.5583276  0.5573102  0.55648386 0.5558585
 0.55539376 0.5549963  0.5545835  0.55408925 0.5534879  0.5528431
 0.55220056 0.55158466 0.55106294 0.55062145 0.55021024 0.54978025
 0.5493194  0.5488718  0.5484085  0.547903   0.5473307  0.54675275
 0.5461623  0.5456327  0.54514617 0.544675   0.5442196  0.5437708
 0.54326737 0.5426702  0.5419603  0.54121226 0.5404764  0.53979737
 0.53915656 0.53851914 0.53785    0.5371713  0.5364437  0.5356427
 0.53485954 0.53424096 0.5337989  0.53358644 0.5335201  0.53353846
 0.5334854  0.53334236 0.5330887  0.53269005 0.53222984 0.5318629
 0.5316417  0.53158426 0.53165513 0.531792   0.53187644 0.5318155
 0.531629   0.5312656  0.5308629  0.53045505 0.53010607 0.5298019
 0.52955323 0.52932006 0.5290283  0.52862406 0.528109   0.52750343
 0.526846   0.52624124 0.5257064  0.52536595 0.52521604 0.5251945
 0.5252615  0.5253014  0.5251013  0.52445424 0.52318907 0.5211285 ]
