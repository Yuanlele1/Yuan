Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=50, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=50, out_features=63, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2822400.0
params:  3213.0
Trainable parameters:  3213
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1675323
	speed: 0.0207s/iter; left time: 548.5287s
	iters: 200, epoch: 1 | loss: 0.1730092
	speed: 0.0137s/iter; left time: 362.3812s
Epoch: 1 cost time: 4.345180988311768
Epoch: 1, Steps: 266 | Train Loss: 0.2269956 Vali Loss: 0.1668330 Test Loss: 0.2251564
Validation loss decreased (inf --> 0.166833).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1357757
	speed: 0.0682s/iter; left time: 1788.9858s
	iters: 200, epoch: 2 | loss: 0.1390405
	speed: 0.0133s/iter; left time: 347.1832s
Epoch: 2 cost time: 4.159356594085693
Epoch: 2, Steps: 266 | Train Loss: 0.1362686 Vali Loss: 0.1503603 Test Loss: 0.2040092
Validation loss decreased (0.166833 --> 0.150360).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1118238
	speed: 0.0701s/iter; left time: 1820.8029s
	iters: 200, epoch: 3 | loss: 0.0776014
	speed: 0.0137s/iter; left time: 354.8281s
Epoch: 3 cost time: 4.145654916763306
Epoch: 3, Steps: 266 | Train Loss: 0.1030559 Vali Loss: 0.1416525 Test Loss: 0.1929140
Validation loss decreased (0.150360 --> 0.141653).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1216897
	speed: 0.0675s/iter; left time: 1734.2859s
	iters: 200, epoch: 4 | loss: 0.0589448
	speed: 0.0127s/iter; left time: 323.8959s
Epoch: 4 cost time: 3.9103946685791016
Epoch: 4, Steps: 266 | Train Loss: 0.0859798 Vali Loss: 0.1356844 Test Loss: 0.1855179
Validation loss decreased (0.141653 --> 0.135684).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0953267
	speed: 0.0637s/iter; left time: 1621.3580s
	iters: 200, epoch: 5 | loss: 0.0648909
	speed: 0.0127s/iter; left time: 322.9026s
Epoch: 5 cost time: 3.8572475910186768
Epoch: 5, Steps: 266 | Train Loss: 0.0759260 Vali Loss: 0.1313704 Test Loss: 0.1802677
Validation loss decreased (0.135684 --> 0.131370).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0707174
	speed: 0.0674s/iter; left time: 1697.6872s
	iters: 200, epoch: 6 | loss: 0.0649349
	speed: 0.0131s/iter; left time: 327.8798s
Epoch: 6 cost time: 4.045257568359375
Epoch: 6, Steps: 266 | Train Loss: 0.0694709 Vali Loss: 0.1281027 Test Loss: 0.1764958
Validation loss decreased (0.131370 --> 0.128103).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0719164
	speed: 0.0652s/iter; left time: 1624.4902s
	iters: 200, epoch: 7 | loss: 0.0608644
	speed: 0.0144s/iter; left time: 357.3154s
Epoch: 7 cost time: 4.323129415512085
Epoch: 7, Steps: 266 | Train Loss: 0.0652102 Vali Loss: 0.1258181 Test Loss: 0.1741735
Validation loss decreased (0.128103 --> 0.125818).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0743009
	speed: 0.0652s/iter; left time: 1607.1880s
	iters: 200, epoch: 8 | loss: 0.0509840
	speed: 0.0133s/iter; left time: 327.3840s
Epoch: 8 cost time: 3.9723939895629883
Epoch: 8, Steps: 266 | Train Loss: 0.0625090 Vali Loss: 0.1241962 Test Loss: 0.1722084
Validation loss decreased (0.125818 --> 0.124196).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0527605
	speed: 0.0642s/iter; left time: 1563.8609s
	iters: 200, epoch: 9 | loss: 0.0692569
	speed: 0.0126s/iter; left time: 306.3657s
Epoch: 9 cost time: 3.935405731201172
Epoch: 9, Steps: 266 | Train Loss: 0.0606077 Vali Loss: 0.1229149 Test Loss: 0.1709736
Validation loss decreased (0.124196 --> 0.122915).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0384158
	speed: 0.0664s/iter; left time: 1600.7135s
	iters: 200, epoch: 10 | loss: 0.0505043
	speed: 0.0130s/iter; left time: 313.1514s
Epoch: 10 cost time: 3.9733500480651855
Epoch: 10, Steps: 266 | Train Loss: 0.0593569 Vali Loss: 0.1221354 Test Loss: 0.1702645
Validation loss decreased (0.122915 --> 0.122135).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0642669
	speed: 0.0656s/iter; left time: 1564.4681s
	iters: 200, epoch: 11 | loss: 0.0581034
	speed: 0.0132s/iter; left time: 313.7207s
Epoch: 11 cost time: 3.961010217666626
Epoch: 11, Steps: 266 | Train Loss: 0.0585982 Vali Loss: 0.1215593 Test Loss: 0.1698269
Validation loss decreased (0.122135 --> 0.121559).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0395435
	speed: 0.0637s/iter; left time: 1501.5775s
	iters: 200, epoch: 12 | loss: 0.0444383
	speed: 0.0127s/iter; left time: 298.0997s
Epoch: 12 cost time: 3.99929141998291
Epoch: 12, Steps: 266 | Train Loss: 0.0580041 Vali Loss: 0.1211008 Test Loss: 0.1696055
Validation loss decreased (0.121559 --> 0.121101).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0655967
	speed: 0.0642s/iter; left time: 1497.0897s
	iters: 200, epoch: 13 | loss: 0.0542707
	speed: 0.0127s/iter; left time: 294.1120s
Epoch: 13 cost time: 3.952021360397339
Epoch: 13, Steps: 266 | Train Loss: 0.0576667 Vali Loss: 0.1209742 Test Loss: 0.1696005
Validation loss decreased (0.121101 --> 0.120974).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0556733
	speed: 0.0650s/iter; left time: 1498.0005s
	iters: 200, epoch: 14 | loss: 0.0547726
	speed: 0.0140s/iter; left time: 321.2743s
Epoch: 14 cost time: 4.207219839096069
Epoch: 14, Steps: 266 | Train Loss: 0.0575157 Vali Loss: 0.1208154 Test Loss: 0.1690701
Validation loss decreased (0.120974 --> 0.120815).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0551416
	speed: 0.0672s/iter; left time: 1531.1437s
	iters: 200, epoch: 15 | loss: 0.0518492
	speed: 0.0132s/iter; left time: 298.3394s
Epoch: 15 cost time: 4.055583953857422
Epoch: 15, Steps: 266 | Train Loss: 0.0574043 Vali Loss: 0.1205902 Test Loss: 0.1692847
Validation loss decreased (0.120815 --> 0.120590).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0556828
	speed: 0.0666s/iter; left time: 1500.0660s
	iters: 200, epoch: 16 | loss: 0.0846053
	speed: 0.0127s/iter; left time: 283.9912s
Epoch: 16 cost time: 3.976807117462158
Epoch: 16, Steps: 266 | Train Loss: 0.0573178 Vali Loss: 0.1204225 Test Loss: 0.1693225
Validation loss decreased (0.120590 --> 0.120423).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0501252
	speed: 0.0652s/iter; left time: 1449.4549s
	iters: 200, epoch: 17 | loss: 0.0649808
	speed: 0.0309s/iter; left time: 684.0410s
Epoch: 17 cost time: 7.759061336517334
Epoch: 17, Steps: 266 | Train Loss: 0.0572008 Vali Loss: 0.1203225 Test Loss: 0.1692860
Validation loss decreased (0.120423 --> 0.120322).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0482551
	speed: 0.0886s/iter; left time: 1947.1809s
	iters: 200, epoch: 18 | loss: 0.0638522
	speed: 0.0130s/iter; left time: 285.5132s
Epoch: 18 cost time: 4.169886112213135
Epoch: 18, Steps: 266 | Train Loss: 0.0572659 Vali Loss: 0.1204287 Test Loss: 0.1691572
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0471917
	speed: 0.0673s/iter; left time: 1460.7648s
	iters: 200, epoch: 19 | loss: 0.0501504
	speed: 0.0139s/iter; left time: 299.8751s
Epoch: 19 cost time: 4.220260381698608
Epoch: 19, Steps: 266 | Train Loss: 0.0572525 Vali Loss: 0.1203310 Test Loss: 0.1692245
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0471598
	speed: 0.0683s/iter; left time: 1464.9709s
	iters: 200, epoch: 20 | loss: 0.0587237
	speed: 0.0133s/iter; left time: 284.7929s
Epoch: 20 cost time: 4.0568413734436035
Epoch: 20, Steps: 266 | Train Loss: 0.0572203 Vali Loss: 0.1204372 Test Loss: 0.1690643
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0571870
	speed: 0.0659s/iter; left time: 1395.7565s
	iters: 200, epoch: 21 | loss: 0.0718576
	speed: 0.0140s/iter; left time: 294.1046s
Epoch: 21 cost time: 4.280588388442993
Epoch: 21, Steps: 266 | Train Loss: 0.0572335 Vali Loss: 0.1203516 Test Loss: 0.1690532
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0692068
	speed: 0.0660s/iter; left time: 1380.7558s
	iters: 200, epoch: 22 | loss: 0.0540762
	speed: 0.0144s/iter; left time: 299.5366s
Epoch: 22 cost time: 4.345382928848267
Epoch: 22, Steps: 266 | Train Loss: 0.0572283 Vali Loss: 0.1202374 Test Loss: 0.1691206
Validation loss decreased (0.120322 --> 0.120237).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0431547
	speed: 0.0677s/iter; left time: 1397.1497s
	iters: 200, epoch: 23 | loss: 0.0773578
	speed: 0.0133s/iter; left time: 272.6137s
Epoch: 23 cost time: 3.935821056365967
Epoch: 23, Steps: 266 | Train Loss: 0.0572173 Vali Loss: 0.1202929 Test Loss: 0.1691180
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0690428
	speed: 0.0644s/iter; left time: 1312.6871s
	iters: 200, epoch: 24 | loss: 0.0389023
	speed: 0.0127s/iter; left time: 257.8059s
Epoch: 24 cost time: 3.8825831413269043
Epoch: 24, Steps: 266 | Train Loss: 0.0571986 Vali Loss: 0.1203732 Test Loss: 0.1691629
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0786930
	speed: 0.0651s/iter; left time: 1309.9632s
	iters: 200, epoch: 25 | loss: 0.0482289
	speed: 0.0127s/iter; left time: 253.8373s
Epoch: 25 cost time: 3.9824836254119873
Epoch: 25, Steps: 266 | Train Loss: 0.0572320 Vali Loss: 0.1204199 Test Loss: 0.1691570
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0511214
	speed: 0.0647s/iter; left time: 1284.7484s
	iters: 200, epoch: 26 | loss: 0.0562148
	speed: 0.0125s/iter; left time: 247.2483s
Epoch: 26 cost time: 4.042256116867065
Epoch: 26, Steps: 266 | Train Loss: 0.0571621 Vali Loss: 0.1203227 Test Loss: 0.1691579
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0452127
	speed: 0.0667s/iter; left time: 1306.8668s
	iters: 200, epoch: 27 | loss: 0.0567776
	speed: 0.0129s/iter; left time: 252.1191s
Epoch: 27 cost time: 3.9923641681671143
Epoch: 27, Steps: 266 | Train Loss: 0.0571858 Vali Loss: 0.1204171 Test Loss: 0.1691706
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0481498
	speed: 0.0776s/iter; left time: 1500.0891s
	iters: 200, epoch: 28 | loss: 0.0775693
	speed: 0.0131s/iter; left time: 252.5592s
Epoch: 28 cost time: 4.718571662902832
Epoch: 28, Steps: 266 | Train Loss: 0.0572032 Vali Loss: 0.1203828 Test Loss: 0.1690801
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0563735
	speed: 0.0795s/iter; left time: 1514.9342s
	iters: 200, epoch: 29 | loss: 0.0596422
	speed: 0.0144s/iter; left time: 273.1109s
Epoch: 29 cost time: 4.2931482791900635
Epoch: 29, Steps: 266 | Train Loss: 0.0571916 Vali Loss: 0.1202425 Test Loss: 0.1691283
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0479007
	speed: 0.0667s/iter; left time: 1252.2040s
	iters: 200, epoch: 30 | loss: 0.0796407
	speed: 0.0129s/iter; left time: 241.7822s
Epoch: 30 cost time: 4.084347486495972
Epoch: 30, Steps: 266 | Train Loss: 0.0571657 Vali Loss: 0.1204259 Test Loss: 0.1690877
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0514554
	speed: 0.0695s/iter; left time: 1287.6103s
	iters: 200, epoch: 31 | loss: 0.0488577
	speed: 0.0130s/iter; left time: 239.9509s
Epoch: 31 cost time: 4.195054292678833
Epoch: 31, Steps: 266 | Train Loss: 0.0572059 Vali Loss: 0.1204161 Test Loss: 0.1691022
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0608082
	speed: 0.0942s/iter; left time: 1719.5675s
	iters: 200, epoch: 32 | loss: 0.0417751
	speed: 0.0123s/iter; left time: 223.7423s
Epoch: 32 cost time: 3.8477108478546143
Epoch: 32, Steps: 266 | Train Loss: 0.0571787 Vali Loss: 0.1204943 Test Loss: 0.1692074
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0619495
	speed: 0.0639s/iter; left time: 1149.2582s
	iters: 200, epoch: 33 | loss: 0.0929567
	speed: 0.0124s/iter; left time: 221.4607s
Epoch: 33 cost time: 3.9004695415496826
Epoch: 33, Steps: 266 | Train Loss: 0.0571817 Vali Loss: 0.1204140 Test Loss: 0.1691830
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0516617
	speed: 0.0686s/iter; left time: 1216.4580s
	iters: 200, epoch: 34 | loss: 0.0772589
	speed: 0.0128s/iter; left time: 225.3037s
Epoch: 34 cost time: 4.152467489242554
Epoch: 34, Steps: 266 | Train Loss: 0.0572075 Vali Loss: 0.1204059 Test Loss: 0.1690623
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0634554
	speed: 0.0668s/iter; left time: 1165.6724s
	iters: 200, epoch: 35 | loss: 0.0670639
	speed: 0.0127s/iter; left time: 221.0849s
Epoch: 35 cost time: 3.9933528900146484
Epoch: 35, Steps: 266 | Train Loss: 0.0571818 Vali Loss: 0.1203405 Test Loss: 0.1690402
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0643837
	speed: 0.0668s/iter; left time: 1147.8346s
	iters: 200, epoch: 36 | loss: 0.0577088
	speed: 0.0133s/iter; left time: 226.7659s
Epoch: 36 cost time: 4.05773138999939
Epoch: 36, Steps: 266 | Train Loss: 0.0572050 Vali Loss: 0.1204234 Test Loss: 0.1690869
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0617168
	speed: 0.0645s/iter; left time: 1091.8595s
	iters: 200, epoch: 37 | loss: 0.0399417
	speed: 0.0129s/iter; left time: 217.6136s
Epoch: 37 cost time: 4.034189701080322
Epoch: 37, Steps: 266 | Train Loss: 0.0571635 Vali Loss: 0.1203606 Test Loss: 0.1690527
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0499529
	speed: 0.0659s/iter; left time: 1097.0825s
	iters: 200, epoch: 38 | loss: 0.0957496
	speed: 0.0131s/iter; left time: 216.5819s
Epoch: 38 cost time: 3.9954421520233154
Epoch: 38, Steps: 266 | Train Loss: 0.0571233 Vali Loss: 0.1203771 Test Loss: 0.1690264
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0420197
	speed: 0.0667s/iter; left time: 1093.4833s
	iters: 200, epoch: 39 | loss: 0.0596226
	speed: 0.0128s/iter; left time: 207.8164s
Epoch: 39 cost time: 4.016187429428101
Epoch: 39, Steps: 266 | Train Loss: 0.0571682 Vali Loss: 0.1203727 Test Loss: 0.1690770
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0595009
	speed: 0.0649s/iter; left time: 1046.3669s
	iters: 200, epoch: 40 | loss: 0.0801251
	speed: 0.0131s/iter; left time: 209.9084s
Epoch: 40 cost time: 4.073709011077881
Epoch: 40, Steps: 266 | Train Loss: 0.0570753 Vali Loss: 0.1202795 Test Loss: 0.1690117
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0572203
	speed: 0.0670s/iter; left time: 1062.3937s
	iters: 200, epoch: 41 | loss: 0.0550896
	speed: 0.0127s/iter; left time: 200.2072s
Epoch: 41 cost time: 3.9590702056884766
Epoch: 41, Steps: 266 | Train Loss: 0.0571967 Vali Loss: 0.1203572 Test Loss: 0.1690887
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0626236
	speed: 0.0653s/iter; left time: 1018.6837s
	iters: 200, epoch: 42 | loss: 0.0529319
	speed: 0.0133s/iter; left time: 205.8046s
Epoch: 42 cost time: 3.978191614151001
Epoch: 42, Steps: 266 | Train Loss: 0.0571698 Vali Loss: 0.1204317 Test Loss: 0.1691034
EarlyStopping counter: 20 out of 20
Early stopping
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=50, out_features=63, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2822400.0
params:  3213.0
Trainable parameters:  3213
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1912208
	speed: 0.0213s/iter; left time: 563.2984s
	iters: 200, epoch: 1 | loss: 0.2283323
	speed: 0.0137s/iter; left time: 362.7647s
Epoch: 1 cost time: 4.374318838119507
Epoch: 1, Steps: 266 | Train Loss: 0.2189328 Vali Loss: 0.1182745 Test Loss: 0.1669275
Validation loss decreased (inf --> 0.118275).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1901397
	speed: 0.0673s/iter; left time: 1764.8144s
	iters: 200, epoch: 2 | loss: 0.2419378
	speed: 0.0135s/iter; left time: 353.5116s
Epoch: 2 cost time: 4.2776782512664795
Epoch: 2, Steps: 266 | Train Loss: 0.2166980 Vali Loss: 0.1176359 Test Loss: 0.1663091
Validation loss decreased (0.118275 --> 0.117636).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1953631
	speed: 0.0666s/iter; left time: 1730.6959s
	iters: 200, epoch: 3 | loss: 0.1932354
	speed: 0.0130s/iter; left time: 336.3144s
Epoch: 3 cost time: 4.128948211669922
Epoch: 3, Steps: 266 | Train Loss: 0.2156185 Vali Loss: 0.1175997 Test Loss: 0.1655722
Validation loss decreased (0.117636 --> 0.117600).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1658136
	speed: 0.0648s/iter; left time: 1666.1773s
	iters: 200, epoch: 4 | loss: 0.1772948
	speed: 0.0126s/iter; left time: 322.6209s
Epoch: 4 cost time: 3.881528615951538
Epoch: 4, Steps: 266 | Train Loss: 0.2149861 Vali Loss: 0.1173923 Test Loss: 0.1657678
Validation loss decreased (0.117600 --> 0.117392).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1939085
	speed: 0.0634s/iter; left time: 1613.0077s
	iters: 200, epoch: 5 | loss: 0.1839835
	speed: 0.0124s/iter; left time: 314.6943s
Epoch: 5 cost time: 3.84051251411438
Epoch: 5, Steps: 266 | Train Loss: 0.2146685 Vali Loss: 0.1171951 Test Loss: 0.1654775
Validation loss decreased (0.117392 --> 0.117195).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2140781
	speed: 0.0637s/iter; left time: 1604.2941s
	iters: 200, epoch: 6 | loss: 0.1963818
	speed: 0.0128s/iter; left time: 320.1917s
Epoch: 6 cost time: 3.992886781692505
Epoch: 6, Steps: 266 | Train Loss: 0.2142589 Vali Loss: 0.1171375 Test Loss: 0.1650378
Validation loss decreased (0.117195 --> 0.117137).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2172041
	speed: 0.0653s/iter; left time: 1626.8052s
	iters: 200, epoch: 7 | loss: 0.1787073
	speed: 0.0127s/iter; left time: 314.6367s
Epoch: 7 cost time: 3.890474557876587
Epoch: 7, Steps: 266 | Train Loss: 0.2141100 Vali Loss: 0.1170414 Test Loss: 0.1652353
Validation loss decreased (0.117137 --> 0.117041).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2050841
	speed: 0.0667s/iter; left time: 1644.2384s
	iters: 200, epoch: 8 | loss: 0.2934484
	speed: 0.0128s/iter; left time: 313.0914s
Epoch: 8 cost time: 4.076097726821899
Epoch: 8, Steps: 266 | Train Loss: 0.2140197 Vali Loss: 0.1168379 Test Loss: 0.1648355
Validation loss decreased (0.117041 --> 0.116838).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2908067
	speed: 0.0659s/iter; left time: 1606.5717s
	iters: 200, epoch: 9 | loss: 0.2101241
	speed: 0.0135s/iter; left time: 327.3741s
Epoch: 9 cost time: 4.167672157287598
Epoch: 9, Steps: 266 | Train Loss: 0.2139399 Vali Loss: 0.1168614 Test Loss: 0.1652935
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2084445
	speed: 0.0674s/iter; left time: 1624.9928s
	iters: 200, epoch: 10 | loss: 0.1540451
	speed: 0.0133s/iter; left time: 318.4373s
Epoch: 10 cost time: 4.184991359710693
Epoch: 10, Steps: 266 | Train Loss: 0.2136376 Vali Loss: 0.1169721 Test Loss: 0.1651448
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1914724
	speed: 0.0786s/iter; left time: 1873.8729s
	iters: 200, epoch: 11 | loss: 0.1896933
	speed: 0.0125s/iter; left time: 296.9331s
Epoch: 11 cost time: 3.936100721359253
Epoch: 11, Steps: 266 | Train Loss: 0.2137724 Vali Loss: 0.1168883 Test Loss: 0.1649107
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1644032
	speed: 0.0636s/iter; left time: 1498.4412s
	iters: 200, epoch: 12 | loss: 0.1778779
	speed: 0.0127s/iter; left time: 298.7054s
Epoch: 12 cost time: 3.9387552738189697
Epoch: 12, Steps: 266 | Train Loss: 0.2136321 Vali Loss: 0.1169054 Test Loss: 0.1648497
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1504568
	speed: 0.0638s/iter; left time: 1486.2652s
	iters: 200, epoch: 13 | loss: 0.2253408
	speed: 0.0127s/iter; left time: 294.4928s
Epoch: 13 cost time: 3.8684754371643066
Epoch: 13, Steps: 266 | Train Loss: 0.2134867 Vali Loss: 0.1168862 Test Loss: 0.1649503
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1571392
	speed: 0.0636s/iter; left time: 1465.8878s
	iters: 200, epoch: 14 | loss: 0.2221227
	speed: 0.0124s/iter; left time: 284.3763s
Epoch: 14 cost time: 3.887723922729492
Epoch: 14, Steps: 266 | Train Loss: 0.2135580 Vali Loss: 0.1169293 Test Loss: 0.1649830
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1809550
	speed: 0.0640s/iter; left time: 1457.8037s
	iters: 200, epoch: 15 | loss: 0.1644613
	speed: 0.0128s/iter; left time: 290.1245s
Epoch: 15 cost time: 3.9020609855651855
Epoch: 15, Steps: 266 | Train Loss: 0.2134739 Vali Loss: 0.1169471 Test Loss: 0.1649260
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2555551
	speed: 0.0630s/iter; left time: 1417.0697s
	iters: 200, epoch: 16 | loss: 0.1796134
	speed: 0.0123s/iter; left time: 276.2339s
Epoch: 16 cost time: 3.7873177528381348
Epoch: 16, Steps: 266 | Train Loss: 0.2134324 Vali Loss: 0.1169445 Test Loss: 0.1648629
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2550704
	speed: 0.0654s/iter; left time: 1455.3048s
	iters: 200, epoch: 17 | loss: 0.1822779
	speed: 0.0129s/iter; left time: 284.8046s
Epoch: 17 cost time: 3.939419984817505
Epoch: 17, Steps: 266 | Train Loss: 0.2131079 Vali Loss: 0.1168228 Test Loss: 0.1647246
Validation loss decreased (0.116838 --> 0.116823).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2430999
	speed: 0.0690s/iter; left time: 1517.2252s
	iters: 200, epoch: 18 | loss: 0.2610332
	speed: 0.0127s/iter; left time: 278.1561s
Epoch: 18 cost time: 4.288367033004761
Epoch: 18, Steps: 266 | Train Loss: 0.2133933 Vali Loss: 0.1169641 Test Loss: 0.1647961
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2289137
	speed: 0.0637s/iter; left time: 1382.9259s
	iters: 200, epoch: 19 | loss: 0.2131591
	speed: 0.0129s/iter; left time: 278.3951s
Epoch: 19 cost time: 3.8476738929748535
Epoch: 19, Steps: 266 | Train Loss: 0.2132956 Vali Loss: 0.1168434 Test Loss: 0.1648898
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2368710
	speed: 0.0666s/iter; left time: 1428.8269s
	iters: 200, epoch: 20 | loss: 0.2385882
	speed: 0.0135s/iter; left time: 288.3493s
Epoch: 20 cost time: 4.1344521045684814
Epoch: 20, Steps: 266 | Train Loss: 0.2131123 Vali Loss: 0.1169210 Test Loss: 0.1649463
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1714879
	speed: 0.0690s/iter; left time: 1460.7442s
	iters: 200, epoch: 21 | loss: 0.1708089
	speed: 0.0133s/iter; left time: 281.1601s
Epoch: 21 cost time: 4.151569843292236
Epoch: 21, Steps: 266 | Train Loss: 0.2132686 Vali Loss: 0.1168622 Test Loss: 0.1648910
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1832967
	speed: 0.0691s/iter; left time: 1444.4178s
	iters: 200, epoch: 22 | loss: 0.4093452
	speed: 0.0142s/iter; left time: 296.2818s
Epoch: 22 cost time: 4.334594011306763
Epoch: 22, Steps: 266 | Train Loss: 0.2130939 Vali Loss: 0.1168184 Test Loss: 0.1649090
Validation loss decreased (0.116823 --> 0.116818).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2576810
	speed: 0.0666s/iter; left time: 1376.2410s
	iters: 200, epoch: 23 | loss: 0.1593485
	speed: 0.0136s/iter; left time: 280.3769s
Epoch: 23 cost time: 5.841864347457886
Epoch: 23, Steps: 266 | Train Loss: 0.2131275 Vali Loss: 0.1168949 Test Loss: 0.1647282
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2887996
	speed: 0.0834s/iter; left time: 1699.4165s
	iters: 200, epoch: 24 | loss: 0.1473975
	speed: 0.0138s/iter; left time: 279.0805s
Epoch: 24 cost time: 4.165859699249268
Epoch: 24, Steps: 266 | Train Loss: 0.2129541 Vali Loss: 0.1168022 Test Loss: 0.1648194
Validation loss decreased (0.116818 --> 0.116802).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3727897
	speed: 0.0681s/iter; left time: 1369.8944s
	iters: 200, epoch: 25 | loss: 0.1732017
	speed: 0.0145s/iter; left time: 290.3684s
Epoch: 25 cost time: 4.352829933166504
Epoch: 25, Steps: 266 | Train Loss: 0.2131050 Vali Loss: 0.1168951 Test Loss: 0.1647912
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1633268
	speed: 0.0680s/iter; left time: 1350.6903s
	iters: 200, epoch: 26 | loss: 0.1492158
	speed: 0.0236s/iter; left time: 466.8792s
Epoch: 26 cost time: 5.185394287109375
Epoch: 26, Steps: 266 | Train Loss: 0.2131386 Vali Loss: 0.1168737 Test Loss: 0.1647316
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3425071
	speed: 0.0671s/iter; left time: 1314.1699s
	iters: 200, epoch: 27 | loss: 0.1608335
	speed: 0.0135s/iter; left time: 263.0782s
Epoch: 27 cost time: 4.222161054611206
Epoch: 27, Steps: 266 | Train Loss: 0.2128520 Vali Loss: 0.1168087 Test Loss: 0.1646315
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1906892
	speed: 0.0692s/iter; left time: 1337.8173s
	iters: 200, epoch: 28 | loss: 0.2289012
	speed: 0.0133s/iter; left time: 256.0427s
Epoch: 28 cost time: 4.234859943389893
Epoch: 28, Steps: 266 | Train Loss: 0.2128450 Vali Loss: 0.1168833 Test Loss: 0.1646169
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1947051
	speed: 0.0650s/iter; left time: 1239.1460s
	iters: 200, epoch: 29 | loss: 0.1683996
	speed: 0.0128s/iter; left time: 241.6670s
Epoch: 29 cost time: 3.9880523681640625
Epoch: 29, Steps: 266 | Train Loss: 0.2130757 Vali Loss: 0.1168645 Test Loss: 0.1647043
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2028905
	speed: 0.0648s/iter; left time: 1217.9330s
	iters: 200, epoch: 30 | loss: 0.1958904
	speed: 0.0135s/iter; left time: 251.7951s
Epoch: 30 cost time: 4.094838857650757
Epoch: 30, Steps: 266 | Train Loss: 0.2128780 Vali Loss: 0.1169055 Test Loss: 0.1647100
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2531557
	speed: 0.0666s/iter; left time: 1234.0775s
	iters: 200, epoch: 31 | loss: 0.2286434
	speed: 0.0126s/iter; left time: 232.1562s
Epoch: 31 cost time: 4.072473049163818
Epoch: 31, Steps: 266 | Train Loss: 0.2129774 Vali Loss: 0.1168544 Test Loss: 0.1646975
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1660664
	speed: 0.0632s/iter; left time: 1153.6898s
	iters: 200, epoch: 32 | loss: 0.1897912
	speed: 0.0130s/iter; left time: 236.1948s
Epoch: 32 cost time: 3.914562463760376
Epoch: 32, Steps: 266 | Train Loss: 0.2129268 Vali Loss: 0.1168634 Test Loss: 0.1647378
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2120586
	speed: 0.0684s/iter; left time: 1230.4603s
	iters: 200, epoch: 33 | loss: 0.2444531
	speed: 0.0138s/iter; left time: 246.9307s
Epoch: 33 cost time: 4.325502157211304
Epoch: 33, Steps: 266 | Train Loss: 0.2127388 Vali Loss: 0.1168809 Test Loss: 0.1646750
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1372068
	speed: 0.0695s/iter; left time: 1230.9298s
	iters: 200, epoch: 34 | loss: 0.1512738
	speed: 0.0142s/iter; left time: 249.8445s
Epoch: 34 cost time: 4.392756223678589
Epoch: 34, Steps: 266 | Train Loss: 0.2129317 Vali Loss: 0.1168636 Test Loss: 0.1646971
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1630603
	speed: 0.0671s/iter; left time: 1171.5540s
	iters: 200, epoch: 35 | loss: 0.2382121
	speed: 0.0126s/iter; left time: 219.3316s
Epoch: 35 cost time: 4.062411308288574
Epoch: 35, Steps: 266 | Train Loss: 0.2128380 Vali Loss: 0.1168927 Test Loss: 0.1647404
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2250637
	speed: 0.0637s/iter; left time: 1094.9416s
	iters: 200, epoch: 36 | loss: 0.1519817
	speed: 0.0124s/iter; left time: 211.1427s
Epoch: 36 cost time: 3.8736672401428223
Epoch: 36, Steps: 266 | Train Loss: 0.2129235 Vali Loss: 0.1168443 Test Loss: 0.1646286
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2506151
	speed: 0.0681s/iter; left time: 1151.7829s
	iters: 200, epoch: 37 | loss: 0.2374756
	speed: 0.0137s/iter; left time: 230.5590s
Epoch: 37 cost time: 4.155805349349976
Epoch: 37, Steps: 266 | Train Loss: 0.2128356 Vali Loss: 0.1168714 Test Loss: 0.1646659
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1616730
	speed: 0.0673s/iter; left time: 1121.7148s
	iters: 200, epoch: 38 | loss: 0.2597635
	speed: 0.0141s/iter; left time: 233.8238s
Epoch: 38 cost time: 4.249655485153198
Epoch: 38, Steps: 266 | Train Loss: 0.2128349 Vali Loss: 0.1168361 Test Loss: 0.1646914
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1739456
	speed: 0.0679s/iter; left time: 1112.7350s
	iters: 200, epoch: 39 | loss: 0.1891355
	speed: 0.0136s/iter; left time: 222.0258s
Epoch: 39 cost time: 4.136586666107178
Epoch: 39, Steps: 266 | Train Loss: 0.2129077 Vali Loss: 0.1168809 Test Loss: 0.1646619
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2292871
	speed: 0.0652s/iter; left time: 1051.2621s
	iters: 200, epoch: 40 | loss: 0.1708204
	speed: 0.0129s/iter; left time: 206.8723s
Epoch: 40 cost time: 4.09382176399231
Epoch: 40, Steps: 266 | Train Loss: 0.2129021 Vali Loss: 0.1169092 Test Loss: 0.1646588
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1806333
	speed: 0.0663s/iter; left time: 1051.5214s
	iters: 200, epoch: 41 | loss: 0.2011346
	speed: 0.0131s/iter; left time: 207.1640s
Epoch: 41 cost time: 4.034641265869141
Epoch: 41, Steps: 266 | Train Loss: 0.2128671 Vali Loss: 0.1168696 Test Loss: 0.1646882
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1820075
	speed: 0.0640s/iter; left time: 998.1317s
	iters: 200, epoch: 42 | loss: 0.2300334
	speed: 0.0127s/iter; left time: 197.1033s
Epoch: 42 cost time: 3.867589235305786
Epoch: 42, Steps: 266 | Train Loss: 0.2126617 Vali Loss: 0.1169876 Test Loss: 0.1646089
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2011606
	speed: 0.0631s/iter; left time: 967.7298s
	iters: 200, epoch: 43 | loss: 0.2036919
	speed: 0.0121s/iter; left time: 185.0262s
Epoch: 43 cost time: 3.8264987468719482
Epoch: 43, Steps: 266 | Train Loss: 0.2128462 Vali Loss: 0.1168449 Test Loss: 0.1646750
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1495585
	speed: 0.0651s/iter; left time: 979.8559s
	iters: 200, epoch: 44 | loss: 0.1448269
	speed: 0.0127s/iter; left time: 190.7054s
Epoch: 44 cost time: 3.9270179271698
Epoch: 44, Steps: 266 | Train Loss: 0.2129159 Vali Loss: 0.1168733 Test Loss: 0.1646538
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm2_360_96_FITS_ETTm2_ftM_sl360_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16541321575641632, mae:0.2551406919956207, rse:0.32974734902381897, corr:[0.5708351  0.57203805 0.56965506 0.5669178  0.56568235 0.5657013
 0.56604046 0.5657245  0.56465024 0.5634576  0.56270444 0.56262004
 0.5629091  0.56304204 0.5627502  0.56207955 0.56141865 0.5609455
 0.5606571  0.56036    0.5599191  0.5593211  0.5586222  0.55809116
 0.55779487 0.55761117 0.5574024  0.55700356 0.55638933 0.5556514
 0.5549985  0.5546289  0.5544666  0.5543348  0.5540485  0.55353993
 0.55285966 0.5521364  0.5515295  0.5510606  0.5506607  0.5502857
 0.5497977  0.54916525 0.54846066 0.5477072  0.5470267  0.54642314
 0.545786   0.5450977  0.5442852  0.5435034  0.5427386  0.54196995
 0.5412174  0.5405349  0.5398602  0.5392149  0.53865224 0.5382133
 0.53785616 0.5376124  0.53745055 0.5372692  0.53703344 0.5368216
 0.53663677 0.53645265 0.5363421  0.53631335 0.5362729  0.53617185
 0.53600514 0.53582203 0.5356025  0.53530097 0.5349528  0.53450197
 0.5339922  0.5334776  0.53302664 0.53253824 0.53205186 0.53152287
 0.5310034  0.53057563 0.5301632  0.52977896 0.52939796 0.52897435
 0.52848417 0.52803254 0.52767384 0.52736306 0.52662206 0.5243295 ]
