Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_90_j96_H8', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_90_j96_H8_FITS_custom_ftM_sl90_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18227
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=42, out_features=86, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  148409856.0
params:  3698.0
Trainable parameters:  3698
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4675245
	speed: 0.0740s/iter; left time: 1043.6999s
Epoch: 1 cost time: 10.066148281097412
Epoch: 1, Steps: 142 | Train Loss: 0.6355176 Vali Loss: 0.3386891 Test Loss: 0.3856401
Validation loss decreased (inf --> 0.338689).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2922068
	speed: 0.1503s/iter; left time: 2098.3005s
Epoch: 2 cost time: 10.054710626602173
Epoch: 2, Steps: 142 | Train Loss: 0.3156934 Vali Loss: 0.2389128 Test Loss: 0.2705943
Validation loss decreased (0.338689 --> 0.238913).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2467727
	speed: 0.1492s/iter; left time: 2061.6498s
Epoch: 3 cost time: 9.956945419311523
Epoch: 3, Steps: 142 | Train Loss: 0.2522894 Vali Loss: 0.2125315 Test Loss: 0.2397637
Validation loss decreased (0.238913 --> 0.212532).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2227387
	speed: 0.1529s/iter; left time: 2091.1725s
Epoch: 4 cost time: 10.173251628875732
Epoch: 4, Steps: 142 | Train Loss: 0.2328646 Vali Loss: 0.2018691 Test Loss: 0.2279401
Validation loss decreased (0.212532 --> 0.201869).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2246993
	speed: 0.1504s/iter; left time: 2035.0091s
Epoch: 5 cost time: 10.038202047348022
Epoch: 5, Steps: 142 | Train Loss: 0.2244468 Vali Loss: 0.1967026 Test Loss: 0.2219186
Validation loss decreased (0.201869 --> 0.196703).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2266887
	speed: 0.1541s/iter; left time: 2063.2195s
Epoch: 6 cost time: 10.177868127822876
Epoch: 6, Steps: 142 | Train Loss: 0.2197915 Vali Loss: 0.1933440 Test Loss: 0.2182887
Validation loss decreased (0.196703 --> 0.193344).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2116187
	speed: 0.1535s/iter; left time: 2033.1528s
Epoch: 7 cost time: 10.036044836044312
Epoch: 7, Steps: 142 | Train Loss: 0.2168961 Vali Loss: 0.1914436 Test Loss: 0.2158533
Validation loss decreased (0.193344 --> 0.191444).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2258612
	speed: 0.1502s/iter; left time: 1969.2116s
Epoch: 8 cost time: 10.029841184616089
Epoch: 8, Steps: 142 | Train Loss: 0.2149281 Vali Loss: 0.1899717 Test Loss: 0.2141462
Validation loss decreased (0.191444 --> 0.189972).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2071157
	speed: 0.1508s/iter; left time: 1955.3128s
Epoch: 9 cost time: 10.143593311309814
Epoch: 9, Steps: 142 | Train Loss: 0.2135471 Vali Loss: 0.1887964 Test Loss: 0.2129043
Validation loss decreased (0.189972 --> 0.188796).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2160434
	speed: 0.1489s/iter; left time: 1909.8538s
Epoch: 10 cost time: 10.057536363601685
Epoch: 10, Steps: 142 | Train Loss: 0.2124621 Vali Loss: 0.1879308 Test Loss: 0.2119581
Validation loss decreased (0.188796 --> 0.187931).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2225079
	speed: 0.1518s/iter; left time: 1925.2876s
Epoch: 11 cost time: 10.187029361724854
Epoch: 11, Steps: 142 | Train Loss: 0.2117084 Vali Loss: 0.1874629 Test Loss: 0.2112020
Validation loss decreased (0.187931 --> 0.187463).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2035986
	speed: 0.1523s/iter; left time: 1909.9553s
Epoch: 12 cost time: 9.995843410491943
Epoch: 12, Steps: 142 | Train Loss: 0.2110683 Vali Loss: 0.1869725 Test Loss: 0.2105924
Validation loss decreased (0.187463 --> 0.186973).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2012110
	speed: 0.1521s/iter; left time: 1885.3802s
Epoch: 13 cost time: 10.119786500930786
Epoch: 13, Steps: 142 | Train Loss: 0.2105696 Vali Loss: 0.1864077 Test Loss: 0.2100801
Validation loss decreased (0.186973 --> 0.186408).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2110688
	speed: 0.1538s/iter; left time: 1884.8040s
Epoch: 14 cost time: 10.407684326171875
Epoch: 14, Steps: 142 | Train Loss: 0.2101389 Vali Loss: 0.1860450 Test Loss: 0.2096595
Validation loss decreased (0.186408 --> 0.186045).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2078736
	speed: 0.1541s/iter; left time: 1867.0175s
Epoch: 15 cost time: 10.238513231277466
Epoch: 15, Steps: 142 | Train Loss: 0.2097899 Vali Loss: 0.1858366 Test Loss: 0.2092867
Validation loss decreased (0.186045 --> 0.185837).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2153827
	speed: 0.1554s/iter; left time: 1860.5171s
Epoch: 16 cost time: 10.233196020126343
Epoch: 16, Steps: 142 | Train Loss: 0.2094063 Vali Loss: 0.1858947 Test Loss: 0.2089902
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2079303
	speed: 0.1533s/iter; left time: 1812.8703s
Epoch: 17 cost time: 10.131309270858765
Epoch: 17, Steps: 142 | Train Loss: 0.2091649 Vali Loss: 0.1850194 Test Loss: 0.2087154
Validation loss decreased (0.185837 --> 0.185019).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2093871
	speed: 0.1532s/iter; left time: 1790.0157s
Epoch: 18 cost time: 10.023815870285034
Epoch: 18, Steps: 142 | Train Loss: 0.2089440 Vali Loss: 0.1852318 Test Loss: 0.2084836
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2015574
	speed: 0.1526s/iter; left time: 1761.7835s
Epoch: 19 cost time: 10.133966207504272
Epoch: 19, Steps: 142 | Train Loss: 0.2087205 Vali Loss: 0.1852013 Test Loss: 0.2082873
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2258269
	speed: 0.1523s/iter; left time: 1736.3786s
Epoch: 20 cost time: 10.135571718215942
Epoch: 20, Steps: 142 | Train Loss: 0.2085838 Vali Loss: 0.1852645 Test Loss: 0.2081026
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2073697
	speed: 0.1537s/iter; left time: 1731.1930s
Epoch: 21 cost time: 10.183820962905884
Epoch: 21, Steps: 142 | Train Loss: 0.2083778 Vali Loss: 0.1849804 Test Loss: 0.2079480
Validation loss decreased (0.185019 --> 0.184980).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2064670
	speed: 0.1548s/iter; left time: 1720.7758s
Epoch: 22 cost time: 10.209086894989014
Epoch: 22, Steps: 142 | Train Loss: 0.2082557 Vali Loss: 0.1850208 Test Loss: 0.2078149
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2051578
	speed: 0.1525s/iter; left time: 1674.0990s
Epoch: 23 cost time: 10.27683138847351
Epoch: 23, Steps: 142 | Train Loss: 0.2081598 Vali Loss: 0.1850403 Test Loss: 0.2076948
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1968976
	speed: 0.1521s/iter; left time: 1648.4763s
Epoch: 24 cost time: 10.234513521194458
Epoch: 24, Steps: 142 | Train Loss: 0.2079219 Vali Loss: 0.1845574 Test Loss: 0.2076001
Validation loss decreased (0.184980 --> 0.184557).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1993664
	speed: 0.1510s/iter; left time: 1614.8629s
Epoch: 25 cost time: 10.203902006149292
Epoch: 25, Steps: 142 | Train Loss: 0.2079308 Vali Loss: 0.1845203 Test Loss: 0.2074981
Validation loss decreased (0.184557 --> 0.184520).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2030879
	speed: 0.1520s/iter; left time: 1603.2435s
Epoch: 26 cost time: 10.021488904953003
Epoch: 26, Steps: 142 | Train Loss: 0.2078850 Vali Loss: 0.1846760 Test Loss: 0.2074291
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2165187
	speed: 0.1518s/iter; left time: 1579.7909s
Epoch: 27 cost time: 10.154085159301758
Epoch: 27, Steps: 142 | Train Loss: 0.2077628 Vali Loss: 0.1847000 Test Loss: 0.2073534
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2055586
	speed: 0.1502s/iter; left time: 1541.7114s
Epoch: 28 cost time: 10.175909757614136
Epoch: 28, Steps: 142 | Train Loss: 0.2076971 Vali Loss: 0.1846543 Test Loss: 0.2072969
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2180258
	speed: 0.1546s/iter; left time: 1565.4850s
Epoch: 29 cost time: 10.349676847457886
Epoch: 29, Steps: 142 | Train Loss: 0.2076658 Vali Loss: 0.1840758 Test Loss: 0.2072311
Validation loss decreased (0.184520 --> 0.184076).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2130538
	speed: 0.1537s/iter; left time: 1534.7743s
Epoch: 30 cost time: 10.182013034820557
Epoch: 30, Steps: 142 | Train Loss: 0.2076335 Vali Loss: 0.1843956 Test Loss: 0.2071794
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2112230
	speed: 0.1543s/iter; left time: 1518.0256s
Epoch: 31 cost time: 10.23863697052002
Epoch: 31, Steps: 142 | Train Loss: 0.2076527 Vali Loss: 0.1845114 Test Loss: 0.2071469
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2095171
	speed: 0.1512s/iter; left time: 1466.4112s
Epoch: 32 cost time: 10.055068969726562
Epoch: 32, Steps: 142 | Train Loss: 0.2075191 Vali Loss: 0.1841227 Test Loss: 0.2071077
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1985416
	speed: 0.1541s/iter; left time: 1472.7751s
Epoch: 33 cost time: 10.024881601333618
Epoch: 33, Steps: 142 | Train Loss: 0.2075713 Vali Loss: 0.1844932 Test Loss: 0.2070815
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2087492
	speed: 0.1511s/iter; left time: 1422.7952s
Epoch: 34 cost time: 10.143484354019165
Epoch: 34, Steps: 142 | Train Loss: 0.2075155 Vali Loss: 0.1843542 Test Loss: 0.2070460
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2131584
	speed: 0.1517s/iter; left time: 1406.9632s
Epoch: 35 cost time: 10.07427167892456
Epoch: 35, Steps: 142 | Train Loss: 0.2074162 Vali Loss: 0.1844218 Test Loss: 0.2070184
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2135584
	speed: 0.1515s/iter; left time: 1383.0479s
Epoch: 36 cost time: 10.018010377883911
Epoch: 36, Steps: 142 | Train Loss: 0.2074561 Vali Loss: 0.1840390 Test Loss: 0.2069931
Validation loss decreased (0.184076 --> 0.184039).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2048192
	speed: 0.1545s/iter; left time: 1388.3564s
Epoch: 37 cost time: 10.293961524963379
Epoch: 37, Steps: 142 | Train Loss: 0.2074299 Vali Loss: 0.1843074 Test Loss: 0.2069840
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2168237
	speed: 0.1537s/iter; left time: 1359.4203s
Epoch: 38 cost time: 10.222580671310425
Epoch: 38, Steps: 142 | Train Loss: 0.2073904 Vali Loss: 0.1843945 Test Loss: 0.2069678
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2147219
	speed: 0.1546s/iter; left time: 1345.8390s
Epoch: 39 cost time: 10.05989384651184
Epoch: 39, Steps: 142 | Train Loss: 0.2073867 Vali Loss: 0.1840411 Test Loss: 0.2069435
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2088742
	speed: 0.1522s/iter; left time: 1303.3057s
Epoch: 40 cost time: 9.872184038162231
Epoch: 40, Steps: 142 | Train Loss: 0.2072833 Vali Loss: 0.1837730 Test Loss: 0.2069237
Validation loss decreased (0.184039 --> 0.183773).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2072807
	speed: 0.1504s/iter; left time: 1266.9299s
Epoch: 41 cost time: 10.225051879882812
Epoch: 41, Steps: 142 | Train Loss: 0.2073949 Vali Loss: 0.1845293 Test Loss: 0.2069093
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2043045
	speed: 0.1515s/iter; left time: 1253.9100s
Epoch: 42 cost time: 10.081314325332642
Epoch: 42, Steps: 142 | Train Loss: 0.2073672 Vali Loss: 0.1842660 Test Loss: 0.2069010
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1996105
	speed: 0.1511s/iter; left time: 1229.1531s
Epoch: 43 cost time: 10.07914113998413
Epoch: 43, Steps: 142 | Train Loss: 0.2073110 Vali Loss: 0.1837147 Test Loss: 0.2068874
Validation loss decreased (0.183773 --> 0.183715).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2087112
	speed: 0.1542s/iter; left time: 1232.7315s
Epoch: 44 cost time: 10.14877200126648
Epoch: 44, Steps: 142 | Train Loss: 0.2073166 Vali Loss: 0.1841371 Test Loss: 0.2068834
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2006474
	speed: 0.1604s/iter; left time: 1259.4204s
Epoch: 45 cost time: 9.964779615402222
Epoch: 45, Steps: 142 | Train Loss: 0.2073664 Vali Loss: 0.1838211 Test Loss: 0.2068693
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2057329
	speed: 0.1511s/iter; left time: 1165.2191s
Epoch: 46 cost time: 10.237560033798218
Epoch: 46, Steps: 142 | Train Loss: 0.2072751 Vali Loss: 0.1837547 Test Loss: 0.2068678
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2130918
	speed: 0.1549s/iter; left time: 1172.6679s
Epoch: 47 cost time: 10.269189834594727
Epoch: 47, Steps: 142 | Train Loss: 0.2073160 Vali Loss: 0.1842397 Test Loss: 0.2068552
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2134403
	speed: 0.1531s/iter; left time: 1136.8440s
Epoch: 48 cost time: 10.184588432312012
Epoch: 48, Steps: 142 | Train Loss: 0.2072929 Vali Loss: 0.1840020 Test Loss: 0.2068536
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2032920
	speed: 0.1500s/iter; left time: 1092.6445s
Epoch: 49 cost time: 10.055588960647583
Epoch: 49, Steps: 142 | Train Loss: 0.2072861 Vali Loss: 0.1841590 Test Loss: 0.2068417
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2099368
	speed: 0.1516s/iter; left time: 1082.5321s
Epoch: 50 cost time: 10.033639907836914
Epoch: 50, Steps: 142 | Train Loss: 0.2072561 Vali Loss: 0.1842306 Test Loss: 0.2068331
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.2156428
	speed: 0.1508s/iter; left time: 1055.8305s
Epoch: 51 cost time: 10.058149099349976
Epoch: 51, Steps: 142 | Train Loss: 0.2072476 Vali Loss: 0.1838611 Test Loss: 0.2068341
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.2009242
	speed: 0.1536s/iter; left time: 1053.4484s
Epoch: 52 cost time: 10.177094459533691
Epoch: 52, Steps: 142 | Train Loss: 0.2071798 Vali Loss: 0.1838957 Test Loss: 0.2068268
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2068188
	speed: 0.1492s/iter; left time: 1002.2197s
Epoch: 53 cost time: 10.016421794891357
Epoch: 53, Steps: 142 | Train Loss: 0.2072572 Vali Loss: 0.1843450 Test Loss: 0.2068243
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2046235
	speed: 0.1531s/iter; left time: 1006.5747s
Epoch: 54 cost time: 10.177038669586182
Epoch: 54, Steps: 142 | Train Loss: 0.2072625 Vali Loss: 0.1841955 Test Loss: 0.2068165
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.2095127
	speed: 0.1587s/iter; left time: 1021.2064s
Epoch: 55 cost time: 10.48645830154419
Epoch: 55, Steps: 142 | Train Loss: 0.2072697 Vali Loss: 0.1841742 Test Loss: 0.2068156
EarlyStopping counter: 12 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1954022
	speed: 0.1555s/iter; left time: 977.9471s
Epoch: 56 cost time: 10.225268840789795
Epoch: 56, Steps: 142 | Train Loss: 0.2072191 Vali Loss: 0.1838118 Test Loss: 0.2068089
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.2004311
	speed: 0.1549s/iter; left time: 952.2573s
Epoch: 57 cost time: 9.980998277664185
Epoch: 57, Steps: 142 | Train Loss: 0.2072530 Vali Loss: 0.1845208 Test Loss: 0.2068060
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.2056192
	speed: 0.1489s/iter; left time: 894.6630s
Epoch: 58 cost time: 9.887426853179932
Epoch: 58, Steps: 142 | Train Loss: 0.2072750 Vali Loss: 0.1839727 Test Loss: 0.2068044
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.2181593
	speed: 0.1471s/iter; left time: 862.9376s
Epoch: 59 cost time: 9.570471286773682
Epoch: 59, Steps: 142 | Train Loss: 0.2072821 Vali Loss: 0.1836376 Test Loss: 0.2068013
Validation loss decreased (0.183715 --> 0.183638).  Saving model ...
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1998415
	speed: 0.1390s/iter; left time: 795.2138s
Epoch: 60 cost time: 9.266352415084839
Epoch: 60, Steps: 142 | Train Loss: 0.2072339 Vali Loss: 0.1839684 Test Loss: 0.2067995
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.2096665
	speed: 0.1434s/iter; left time: 800.0635s
Epoch: 61 cost time: 9.47466492652893
Epoch: 61, Steps: 142 | Train Loss: 0.2072421 Vali Loss: 0.1843374 Test Loss: 0.2067968
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.2092286
	speed: 0.1422s/iter; left time: 773.5882s
Epoch: 62 cost time: 9.383908987045288
Epoch: 62, Steps: 142 | Train Loss: 0.2072295 Vali Loss: 0.1841156 Test Loss: 0.2067944
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.2116675
	speed: 0.1426s/iter; left time: 755.3876s
Epoch: 63 cost time: 9.385895490646362
Epoch: 63, Steps: 142 | Train Loss: 0.2072748 Vali Loss: 0.1843404 Test Loss: 0.2067902
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.2201138
	speed: 0.1461s/iter; left time: 753.0536s
Epoch: 64 cost time: 9.453542947769165
Epoch: 64, Steps: 142 | Train Loss: 0.2072645 Vali Loss: 0.1840362 Test Loss: 0.2067884
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.2236821
	speed: 0.1472s/iter; left time: 737.7858s
Epoch: 65 cost time: 9.7715904712677
Epoch: 65, Steps: 142 | Train Loss: 0.2072788 Vali Loss: 0.1838774 Test Loss: 0.2067883
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.2148104
	speed: 0.1458s/iter; left time: 710.1176s
Epoch: 66 cost time: 9.414874792098999
Epoch: 66, Steps: 142 | Train Loss: 0.2072139 Vali Loss: 0.1840020 Test Loss: 0.2067873
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.2204006
	speed: 0.1428s/iter; left time: 675.1700s
Epoch: 67 cost time: 9.352305889129639
Epoch: 67, Steps: 142 | Train Loss: 0.2072391 Vali Loss: 0.1838091 Test Loss: 0.2067840
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2153281
	speed: 0.1434s/iter; left time: 657.8253s
Epoch: 68 cost time: 9.510812759399414
Epoch: 68, Steps: 142 | Train Loss: 0.2072679 Vali Loss: 0.1836115 Test Loss: 0.2067803
Validation loss decreased (0.183638 --> 0.183612).  Saving model ...
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.2181372
	speed: 0.1439s/iter; left time: 639.6527s
Epoch: 69 cost time: 9.727844476699829
Epoch: 69, Steps: 142 | Train Loss: 0.2072480 Vali Loss: 0.1844071 Test Loss: 0.2067811
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.2016695
	speed: 0.1502s/iter; left time: 646.2641s
Epoch: 70 cost time: 9.472564220428467
Epoch: 70, Steps: 142 | Train Loss: 0.2072123 Vali Loss: 0.1837151 Test Loss: 0.2067782
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.2050389
	speed: 0.1415s/iter; left time: 588.7101s
Epoch: 71 cost time: 9.264960289001465
Epoch: 71, Steps: 142 | Train Loss: 0.2072086 Vali Loss: 0.1838762 Test Loss: 0.2067773
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.2039997
	speed: 0.1465s/iter; left time: 588.7515s
Epoch: 72 cost time: 10.01857590675354
Epoch: 72, Steps: 142 | Train Loss: 0.2071818 Vali Loss: 0.1841186 Test Loss: 0.2067744
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.2123007
	speed: 0.1484s/iter; left time: 575.3325s
Epoch: 73 cost time: 9.524567604064941
Epoch: 73, Steps: 142 | Train Loss: 0.2071920 Vali Loss: 0.1837099 Test Loss: 0.2067737
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.2004212
	speed: 0.1490s/iter; left time: 556.6971s
Epoch: 74 cost time: 9.786335945129395
Epoch: 74, Steps: 142 | Train Loss: 0.2071376 Vali Loss: 0.1835832 Test Loss: 0.2067732
Validation loss decreased (0.183612 --> 0.183583).  Saving model ...
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.2147736
	speed: 0.1449s/iter; left time: 520.7346s
Epoch: 75 cost time: 9.418612957000732
Epoch: 75, Steps: 142 | Train Loss: 0.2072673 Vali Loss: 0.1839982 Test Loss: 0.2067729
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.2103858
	speed: 0.1313s/iter; left time: 452.9468s
Epoch: 76 cost time: 8.613038539886475
Epoch: 76, Steps: 142 | Train Loss: 0.2072160 Vali Loss: 0.1840191 Test Loss: 0.2067717
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.2040802
	speed: 0.1327s/iter; left time: 439.0281s
Epoch: 77 cost time: 9.206300258636475
Epoch: 77, Steps: 142 | Train Loss: 0.2072672 Vali Loss: 0.1843444 Test Loss: 0.2067712
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.2051638
	speed: 0.1490s/iter; left time: 471.9722s
Epoch: 78 cost time: 9.41486382484436
Epoch: 78, Steps: 142 | Train Loss: 0.2071803 Vali Loss: 0.1836660 Test Loss: 0.2067698
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.2116480
	speed: 0.1422s/iter; left time: 430.1405s
Epoch: 79 cost time: 9.40295958518982
Epoch: 79, Steps: 142 | Train Loss: 0.2072309 Vali Loss: 0.1839080 Test Loss: 0.2067699
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.2086749
	speed: 0.1425s/iter; left time: 410.9460s
Epoch: 80 cost time: 9.534931182861328
Epoch: 80, Steps: 142 | Train Loss: 0.2072078 Vali Loss: 0.1841141 Test Loss: 0.2067681
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.2182274
	speed: 0.1439s/iter; left time: 394.3127s
Epoch: 81 cost time: 9.415392637252808
Epoch: 81, Steps: 142 | Train Loss: 0.2072281 Vali Loss: 0.1839985 Test Loss: 0.2067677
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.2157329
	speed: 0.1461s/iter; left time: 379.6309s
Epoch: 82 cost time: 9.706614255905151
Epoch: 82, Steps: 142 | Train Loss: 0.2072161 Vali Loss: 0.1840965 Test Loss: 0.2067667
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1989180
	speed: 0.1466s/iter; left time: 360.2301s
Epoch: 83 cost time: 9.642822027206421
Epoch: 83, Steps: 142 | Train Loss: 0.2071694 Vali Loss: 0.1840483 Test Loss: 0.2067661
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.2109907
	speed: 0.1433s/iter; left time: 331.7074s
Epoch: 84 cost time: 9.487463235855103
Epoch: 84, Steps: 142 | Train Loss: 0.2071882 Vali Loss: 0.1841099 Test Loss: 0.2067655
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1957222
	speed: 0.1425s/iter; left time: 309.7176s
Epoch: 85 cost time: 9.250890493392944
Epoch: 85, Steps: 142 | Train Loss: 0.2071884 Vali Loss: 0.1839962 Test Loss: 0.2067654
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.2091012
	speed: 0.1442s/iter; left time: 292.8260s
Epoch: 86 cost time: 9.637843370437622
Epoch: 86, Steps: 142 | Train Loss: 0.2072111 Vali Loss: 0.1836384 Test Loss: 0.2067643
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.2129546
	speed: 0.1472s/iter; left time: 278.0091s
Epoch: 87 cost time: 9.606087923049927
Epoch: 87, Steps: 142 | Train Loss: 0.2072016 Vali Loss: 0.1838635 Test Loss: 0.2067644
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.2068264
	speed: 0.1452s/iter; left time: 253.6935s
Epoch: 88 cost time: 9.55630612373352
Epoch: 88, Steps: 142 | Train Loss: 0.2071887 Vali Loss: 0.1842029 Test Loss: 0.2067642
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.2084950
	speed: 0.1453s/iter; left time: 233.2245s
Epoch: 89 cost time: 9.376230001449585
Epoch: 89, Steps: 142 | Train Loss: 0.2072321 Vali Loss: 0.1836150 Test Loss: 0.2067629
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.2016007
	speed: 0.1450s/iter; left time: 212.1260s
Epoch: 90 cost time: 9.588352918624878
Epoch: 90, Steps: 142 | Train Loss: 0.2071553 Vali Loss: 0.1836512 Test Loss: 0.2067631
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.2257980
	speed: 0.1456s/iter; left time: 192.3611s
Epoch: 91 cost time: 9.578421831130981
Epoch: 91, Steps: 142 | Train Loss: 0.2071964 Vali Loss: 0.1844115 Test Loss: 0.2067620
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.944182354829475e-06
	iters: 100, epoch: 92 | loss: 0.2077060
	speed: 0.1446s/iter; left time: 170.5261s
Epoch: 92 cost time: 9.481419563293457
Epoch: 92, Steps: 142 | Train Loss: 0.2072460 Vali Loss: 0.1838589 Test Loss: 0.2067623
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.696973237088e-06
	iters: 100, epoch: 93 | loss: 0.2039559
	speed: 0.1498s/iter; left time: 155.3097s
Epoch: 93 cost time: 9.69643759727478
Epoch: 93, Steps: 142 | Train Loss: 0.2072046 Vali Loss: 0.1839677 Test Loss: 0.2067618
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.462124575233601e-06
	iters: 100, epoch: 94 | loss: 0.2091773
	speed: 0.1474s/iter; left time: 131.9280s
Epoch: 94 cost time: 9.789421558380127
Epoch: 94, Steps: 142 | Train Loss: 0.2072021 Vali Loss: 0.1843117 Test Loss: 0.2067612
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_90_j96_H8_FITS_custom_ftM_sl90_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.20572496950626373, mae:0.2808656096458435, rse:0.45080360770225525, corr:[0.46155974 0.46173683 0.46020243 0.45924464 0.4581771  0.45760733
 0.45754054 0.45684463 0.45606872 0.45496744 0.4544508  0.4537227
 0.4533806  0.45280188 0.45247963 0.45210138 0.452014   0.45226043
 0.4523505  0.45245907 0.45249122 0.45250517 0.45254314 0.4515441
 0.44943503 0.4477588  0.44656318 0.445592   0.44493115 0.44521543
 0.4458395  0.4460489  0.44542384 0.4449631  0.44461405 0.44423625
 0.44420043 0.44394296 0.44389847 0.4437134  0.4437696  0.44385177
 0.44399655 0.444177   0.4442989  0.4446012  0.4447333  0.44452074
 0.44360644 0.4430819  0.44307044 0.4432463  0.44417727 0.44568828
 0.4478617  0.44912067 0.44890955 0.44890034 0.4486865  0.44855407
 0.44853082 0.4484154  0.44864717 0.44881904 0.44911003 0.44936875
 0.44973686 0.4499102  0.45027465 0.4507451  0.4513331  0.45160028
 0.45177016 0.45226753 0.4529577  0.45412844 0.45603755 0.45844764
 0.46162742 0.46356612 0.46344787 0.46326107 0.46291932 0.46270484
 0.46264172 0.46268058 0.46282557 0.46300444 0.46315187 0.4633693
 0.46333995 0.4632653  0.46310416 0.46307912 0.4626102  0.46320033]
