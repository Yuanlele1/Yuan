Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=170, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_360_j96_H10', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_360_j96_H10_FITS_custom_ftM_sl360_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17957
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=170, out_features=215, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1501766400.0
params:  36765.0
Trainable parameters:  36765
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3654893
	speed: 0.3153s/iter; left time: 4382.5848s
Epoch: 1 cost time: 45.17449617385864
Epoch: 1, Steps: 140 | Train Loss: 0.5536303 Vali Loss: 0.2273200 Test Loss: 0.2666768
Validation loss decreased (inf --> 0.227320).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1711744
	speed: 0.6815s/iter; left time: 9378.5039s
Epoch: 2 cost time: 39.68067741394043
Epoch: 2, Steps: 140 | Train Loss: 0.1964676 Vali Loss: 0.1328014 Test Loss: 0.1566604
Validation loss decreased (0.227320 --> 0.132801).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1412227
	speed: 0.6596s/iter; left time: 8984.0165s
Epoch: 3 cost time: 39.22870755195618
Epoch: 3, Steps: 140 | Train Loss: 0.1497956 Vali Loss: 0.1236174 Test Loss: 0.1446878
Validation loss decreased (0.132801 --> 0.123617).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1367899
	speed: 0.6917s/iter; left time: 9324.7199s
Epoch: 4 cost time: 42.712751388549805
Epoch: 4, Steps: 140 | Train Loss: 0.1449657 Vali Loss: 0.1225543 Test Loss: 0.1430092
Validation loss decreased (0.123617 --> 0.122554).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1474850
	speed: 0.7693s/iter; left time: 10263.2558s
Epoch: 5 cost time: 52.12056016921997
Epoch: 5, Steps: 140 | Train Loss: 0.1439272 Vali Loss: 0.1215641 Test Loss: 0.1423896
Validation loss decreased (0.122554 --> 0.121564).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1379577
	speed: 0.9118s/iter; left time: 12036.6920s
Epoch: 6 cost time: 55.348599910736084
Epoch: 6, Steps: 140 | Train Loss: 0.1433902 Vali Loss: 0.1213533 Test Loss: 0.1420113
Validation loss decreased (0.121564 --> 0.121353).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1524220
	speed: 0.6916s/iter; left time: 9032.4986s
Epoch: 7 cost time: 41.50348091125488
Epoch: 7, Steps: 140 | Train Loss: 0.1429378 Vali Loss: 0.1209074 Test Loss: 0.1417088
Validation loss decreased (0.121353 --> 0.120907).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1329856
	speed: 0.6308s/iter; left time: 8150.2076s
Epoch: 8 cost time: 37.4947464466095
Epoch: 8, Steps: 140 | Train Loss: 0.1426923 Vali Loss: 0.1212621 Test Loss: 0.1415754
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1366889
	speed: 0.5963s/iter; left time: 7621.0849s
Epoch: 9 cost time: 35.89871263504028
Epoch: 9, Steps: 140 | Train Loss: 0.1425657 Vali Loss: 0.1211706 Test Loss: 0.1413773
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1313801
	speed: 0.5669s/iter; left time: 7166.4180s
Epoch: 10 cost time: 34.27087712287903
Epoch: 10, Steps: 140 | Train Loss: 0.1423576 Vali Loss: 0.1209379 Test Loss: 0.1412675
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1366730
	speed: 0.5664s/iter; left time: 7080.8323s
Epoch: 11 cost time: 34.178104400634766
Epoch: 11, Steps: 140 | Train Loss: 0.1422267 Vali Loss: 0.1207891 Test Loss: 0.1411492
Validation loss decreased (0.120907 --> 0.120789).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1508207
	speed: 0.5367s/iter; left time: 6634.6341s
Epoch: 12 cost time: 33.59248924255371
Epoch: 12, Steps: 140 | Train Loss: 0.1421376 Vali Loss: 0.1205398 Test Loss: 0.1410852
Validation loss decreased (0.120789 --> 0.120540).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1480607
	speed: 0.5542s/iter; left time: 6772.2769s
Epoch: 13 cost time: 34.338926792144775
Epoch: 13, Steps: 140 | Train Loss: 0.1421086 Vali Loss: 0.1207449 Test Loss: 0.1410120
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1375721
	speed: 0.5520s/iter; left time: 6668.8738s
Epoch: 14 cost time: 34.878117084503174
Epoch: 14, Steps: 140 | Train Loss: 0.1420039 Vali Loss: 0.1205246 Test Loss: 0.1409570
Validation loss decreased (0.120540 --> 0.120525).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1339207
	speed: 0.7869s/iter; left time: 9395.9642s
Epoch: 15 cost time: 52.891404151916504
Epoch: 15, Steps: 140 | Train Loss: 0.1419420 Vali Loss: 0.1205155 Test Loss: 0.1409283
Validation loss decreased (0.120525 --> 0.120516).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1452783
	speed: 0.8700s/iter; left time: 10266.6058s
Epoch: 16 cost time: 52.485586404800415
Epoch: 16, Steps: 140 | Train Loss: 0.1419496 Vali Loss: 0.1203070 Test Loss: 0.1408717
Validation loss decreased (0.120516 --> 0.120307).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1533404
	speed: 0.8181s/iter; left time: 9540.3585s
Epoch: 17 cost time: 47.32319116592407
Epoch: 17, Steps: 140 | Train Loss: 0.1418425 Vali Loss: 0.1206758 Test Loss: 0.1408185
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1451370
	speed: 0.7655s/iter; left time: 8819.2755s
Epoch: 18 cost time: 47.946399211883545
Epoch: 18, Steps: 140 | Train Loss: 0.1417887 Vali Loss: 0.1204917 Test Loss: 0.1408015
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1464421
	speed: 0.8226s/iter; left time: 9361.6998s
Epoch: 19 cost time: 50.18225979804993
Epoch: 19, Steps: 140 | Train Loss: 0.1418123 Vali Loss: 0.1203355 Test Loss: 0.1407789
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1406559
	speed: 0.8292s/iter; left time: 9320.6242s
Epoch: 20 cost time: 50.68622326850891
Epoch: 20, Steps: 140 | Train Loss: 0.1417662 Vali Loss: 0.1201067 Test Loss: 0.1407329
Validation loss decreased (0.120307 --> 0.120107).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1474766
	speed: 0.8397s/iter; left time: 9322.0209s
Epoch: 21 cost time: 51.64288544654846
Epoch: 21, Steps: 140 | Train Loss: 0.1417417 Vali Loss: 0.1201871 Test Loss: 0.1407121
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1462625
	speed: 0.7814s/iter; left time: 8565.4230s
Epoch: 22 cost time: 48.485270977020264
Epoch: 22, Steps: 140 | Train Loss: 0.1417115 Vali Loss: 0.1204917 Test Loss: 0.1407440
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1465917
	speed: 0.7988s/iter; left time: 8643.4662s
Epoch: 23 cost time: 50.053956508636475
Epoch: 23, Steps: 140 | Train Loss: 0.1416896 Vali Loss: 0.1199328 Test Loss: 0.1406958
Validation loss decreased (0.120107 --> 0.119933).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1345779
	speed: 0.8058s/iter; left time: 8607.1946s
Epoch: 24 cost time: 47.894800901412964
Epoch: 24, Steps: 140 | Train Loss: 0.1416109 Vali Loss: 0.1205334 Test Loss: 0.1406587
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1357150
	speed: 0.8021s/iter; left time: 8454.6638s
Epoch: 25 cost time: 49.46686005592346
Epoch: 25, Steps: 140 | Train Loss: 0.1416414 Vali Loss: 0.1206079 Test Loss: 0.1406330
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1468331
	speed: 0.7909s/iter; left time: 8225.6995s
Epoch: 26 cost time: 47.66832518577576
Epoch: 26, Steps: 140 | Train Loss: 0.1415309 Vali Loss: 0.1202192 Test Loss: 0.1406734
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1418139
	speed: 0.8120s/iter; left time: 8331.5027s
Epoch: 27 cost time: 50.359538316726685
Epoch: 27, Steps: 140 | Train Loss: 0.1416195 Vali Loss: 0.1201278 Test Loss: 0.1406435
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1412943
	speed: 0.8115s/iter; left time: 8213.3075s
Epoch: 28 cost time: 50.30555605888367
Epoch: 28, Steps: 140 | Train Loss: 0.1416058 Vali Loss: 0.1203197 Test Loss: 0.1406005
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1329727
	speed: 0.8189s/iter; left time: 8173.4026s
Epoch: 29 cost time: 50.69988226890564
Epoch: 29, Steps: 140 | Train Loss: 0.1415944 Vali Loss: 0.1202163 Test Loss: 0.1406056
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1363719
	speed: 0.8192s/iter; left time: 8062.1286s
Epoch: 30 cost time: 51.71588611602783
Epoch: 30, Steps: 140 | Train Loss: 0.1415728 Vali Loss: 0.1200282 Test Loss: 0.1405742
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1335978
	speed: 0.8245s/iter; left time: 7998.6696s
Epoch: 31 cost time: 51.43032932281494
Epoch: 31, Steps: 140 | Train Loss: 0.1415752 Vali Loss: 0.1202534 Test Loss: 0.1405770
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1356711
	speed: 0.8307s/iter; left time: 7942.5322s
Epoch: 32 cost time: 51.805357456207275
Epoch: 32, Steps: 140 | Train Loss: 0.1415470 Vali Loss: 0.1201651 Test Loss: 0.1405830
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1436466
	speed: 0.8450s/iter; left time: 7961.0058s
Epoch: 33 cost time: 50.05802655220032
Epoch: 33, Steps: 140 | Train Loss: 0.1415117 Vali Loss: 0.1205957 Test Loss: 0.1405681
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1441154
	speed: 0.8085s/iter; left time: 7504.0417s
Epoch: 34 cost time: 48.46298336982727
Epoch: 34, Steps: 140 | Train Loss: 0.1415380 Vali Loss: 0.1203488 Test Loss: 0.1405672
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1446160
	speed: 0.8045s/iter; left time: 7353.7639s
Epoch: 35 cost time: 49.9728319644928
Epoch: 35, Steps: 140 | Train Loss: 0.1414926 Vali Loss: 0.1202635 Test Loss: 0.1405524
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1451107
	speed: 0.8152s/iter; left time: 7337.8417s
Epoch: 36 cost time: 49.629979372024536
Epoch: 36, Steps: 140 | Train Loss: 0.1415138 Vali Loss: 0.1201495 Test Loss: 0.1405589
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1444741
	speed: 0.8368s/iter; left time: 7414.8573s
Epoch: 37 cost time: 51.07287836074829
Epoch: 37, Steps: 140 | Train Loss: 0.1414906 Vali Loss: 0.1199473 Test Loss: 0.1405424
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1381103
	speed: 0.8223s/iter; left time: 7170.8440s
Epoch: 38 cost time: 49.23135161399841
Epoch: 38, Steps: 140 | Train Loss: 0.1415001 Vali Loss: 0.1199401 Test Loss: 0.1405379
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1487521
	speed: 0.7836s/iter; left time: 6723.8281s
Epoch: 39 cost time: 48.00062298774719
Epoch: 39, Steps: 140 | Train Loss: 0.1414804 Vali Loss: 0.1200195 Test Loss: 0.1405389
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1513547
	speed: 0.8091s/iter; left time: 6829.5934s
Epoch: 40 cost time: 50.12683868408203
Epoch: 40, Steps: 140 | Train Loss: 0.1415095 Vali Loss: 0.1200915 Test Loss: 0.1405310
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1425475
	speed: 0.8078s/iter; left time: 6705.8715s
Epoch: 41 cost time: 49.60656952857971
Epoch: 41, Steps: 140 | Train Loss: 0.1414613 Vali Loss: 0.1201243 Test Loss: 0.1405201
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1375147
	speed: 0.8146s/iter; left time: 6648.3581s
Epoch: 42 cost time: 49.80205249786377
Epoch: 42, Steps: 140 | Train Loss: 0.1414500 Vali Loss: 0.1200221 Test Loss: 0.1405129
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1383230
	speed: 0.8037s/iter; left time: 6446.0976s
Epoch: 43 cost time: 48.98258113861084
Epoch: 43, Steps: 140 | Train Loss: 0.1414767 Vali Loss: 0.1201985 Test Loss: 0.1405071
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_360_j96_H10_FITS_custom_ftM_sl360_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.14040423929691315, mae:0.23629076778888702, rse:0.3724208474159241, corr:[0.46618518 0.4673793  0.46853718 0.46980143 0.46992075 0.47052246
 0.4704608  0.4704224  0.47043    0.47003886 0.47012064 0.46972474
 0.4696677  0.46946096 0.46943426 0.46938643 0.46917114 0.46914393
 0.46913967 0.46915781 0.46898094 0.46912745 0.4692476  0.4694493
 0.46953398 0.4695795  0.46975797 0.46956843 0.46963137 0.46927318
 0.46934626 0.46911812 0.4690064  0.4689126  0.4686682  0.4686559
 0.46838263 0.46848878 0.46840918 0.4683451  0.4683969  0.46836165
 0.46852785 0.46831474 0.46832442 0.4682535  0.4683649  0.46856093
 0.46864772 0.4686831  0.46854025 0.46861348 0.46832785 0.46831927
 0.46803886 0.468042   0.46802577 0.4678089  0.46796867 0.46772924
 0.46782106 0.467807   0.46785343 0.4679638  0.4677844  0.46792787
 0.46775737 0.467712   0.46745574 0.46739417 0.46744066 0.46745846
 0.46756628 0.46740425 0.46755686 0.46725607 0.4673398  0.46709403
 0.46709883 0.46693218 0.46689647 0.46705115 0.4668953  0.46721724
 0.46705613 0.46734172 0.46732196 0.46727857 0.46729568 0.4667901
 0.46702734 0.46605024 0.4665504  0.46580794 0.46703535 0.46753493]
