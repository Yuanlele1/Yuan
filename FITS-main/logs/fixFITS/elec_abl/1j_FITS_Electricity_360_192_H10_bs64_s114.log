Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=170, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_360_j192_H10', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_360_j192_H10_FITS_custom_ftM_sl360_ll48_pl192_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17861
val 2441
test 5069
Model(
  (freq_upsampler): Linear(in_features=170, out_features=260, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1816089600.0
params:  44460.0
Trainable parameters:  44460
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5062999
	speed: 0.4803s/iter; left time: 6628.7645s
Epoch: 1 cost time: 68.53889989852905
Epoch: 1, Steps: 139 | Train Loss: 0.6714393 Vali Loss: 0.3395648 Test Loss: 0.3992333
Validation loss decreased (inf --> 0.339565).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2676685
	speed: 1.0644s/iter; left time: 14541.1893s
Epoch: 2 cost time: 59.425785064697266
Epoch: 2, Steps: 139 | Train Loss: 0.3022427 Vali Loss: 0.1909255 Test Loss: 0.2286291
Validation loss decreased (0.339565 --> 0.190926).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1943140
	speed: 0.9987s/iter; left time: 13504.7953s
Epoch: 3 cost time: 60.86007618904114
Epoch: 3, Steps: 139 | Train Loss: 0.1977707 Vali Loss: 0.1470748 Test Loss: 0.1767143
Validation loss decreased (0.190926 --> 0.147075).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1721866
	speed: 0.9799s/iter; left time: 13114.3513s
Epoch: 4 cost time: 61.466885566711426
Epoch: 4, Steps: 139 | Train Loss: 0.1681395 Vali Loss: 0.1362957 Test Loss: 0.1631940
Validation loss decreased (0.147075 --> 0.136296).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1616985
	speed: 0.8972s/iter; left time: 11883.3407s
Epoch: 5 cost time: 45.84563660621643
Epoch: 5, Steps: 139 | Train Loss: 0.1607913 Vali Loss: 0.1338126 Test Loss: 0.1598023
Validation loss decreased (0.136296 --> 0.133813).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1601711
	speed: 0.7196s/iter; left time: 9430.4608s
Epoch: 6 cost time: 42.816765546798706
Epoch: 6, Steps: 139 | Train Loss: 0.1587709 Vali Loss: 0.1330929 Test Loss: 0.1587463
Validation loss decreased (0.133813 --> 0.133093).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1616572
	speed: 0.7404s/iter; left time: 9600.8273s
Epoch: 7 cost time: 47.62508845329285
Epoch: 7, Steps: 139 | Train Loss: 0.1579933 Vali Loss: 0.1328416 Test Loss: 0.1583108
Validation loss decreased (0.133093 --> 0.132842).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1515648
	speed: 0.7212s/iter; left time: 9250.9717s
Epoch: 8 cost time: 42.26431441307068
Epoch: 8, Steps: 139 | Train Loss: 0.1576116 Vali Loss: 0.1325316 Test Loss: 0.1580167
Validation loss decreased (0.132842 --> 0.132532).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1541534
	speed: 0.6755s/iter; left time: 8571.7573s
Epoch: 9 cost time: 40.68000054359436
Epoch: 9, Steps: 139 | Train Loss: 0.1572599 Vali Loss: 0.1323205 Test Loss: 0.1578565
Validation loss decreased (0.132532 --> 0.132320).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1653460
	speed: 0.6276s/iter; left time: 7876.5037s
Epoch: 10 cost time: 38.143251180648804
Epoch: 10, Steps: 139 | Train Loss: 0.1570899 Vali Loss: 0.1322293 Test Loss: 0.1576894
Validation loss decreased (0.132320 --> 0.132229).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1538064
	speed: 0.6267s/iter; left time: 7778.5185s
Epoch: 11 cost time: 39.00899600982666
Epoch: 11, Steps: 139 | Train Loss: 0.1569664 Vali Loss: 0.1321643 Test Loss: 0.1576262
Validation loss decreased (0.132229 --> 0.132164).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1563226
	speed: 0.7903s/iter; left time: 9698.4754s
Epoch: 12 cost time: 55.51382637023926
Epoch: 12, Steps: 139 | Train Loss: 0.1568520 Vali Loss: 0.1319747 Test Loss: 0.1575142
Validation loss decreased (0.132164 --> 0.131975).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1576234
	speed: 0.9424s/iter; left time: 11434.2360s
Epoch: 13 cost time: 57.39538550376892
Epoch: 13, Steps: 139 | Train Loss: 0.1567693 Vali Loss: 0.1319568 Test Loss: 0.1574637
Validation loss decreased (0.131975 --> 0.131957).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1570089
	speed: 0.8989s/iter; left time: 10781.4386s
Epoch: 14 cost time: 54.23322582244873
Epoch: 14, Steps: 139 | Train Loss: 0.1566750 Vali Loss: 0.1319482 Test Loss: 0.1574259
Validation loss decreased (0.131957 --> 0.131948).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1639311
	speed: 0.8663s/iter; left time: 10270.2653s
Epoch: 15 cost time: 54.4929895401001
Epoch: 15, Steps: 139 | Train Loss: 0.1566441 Vali Loss: 0.1319090 Test Loss: 0.1573918
Validation loss decreased (0.131948 --> 0.131909).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1506867
	speed: 0.9379s/iter; left time: 10988.4546s
Epoch: 16 cost time: 57.07815146446228
Epoch: 16, Steps: 139 | Train Loss: 0.1565310 Vali Loss: 0.1318965 Test Loss: 0.1573216
Validation loss decreased (0.131909 --> 0.131896).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1600100
	speed: 0.8899s/iter; left time: 10302.6469s
Epoch: 17 cost time: 55.85434103012085
Epoch: 17, Steps: 139 | Train Loss: 0.1565303 Vali Loss: 0.1317835 Test Loss: 0.1572955
Validation loss decreased (0.131896 --> 0.131784).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1623106
	speed: 0.9606s/iter; left time: 10987.4814s
Epoch: 18 cost time: 57.48019504547119
Epoch: 18, Steps: 139 | Train Loss: 0.1565079 Vali Loss: 0.1318175 Test Loss: 0.1572629
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1458400
	speed: 0.9060s/iter; left time: 10237.1147s
Epoch: 19 cost time: 55.12416052818298
Epoch: 19, Steps: 139 | Train Loss: 0.1564062 Vali Loss: 0.1318247 Test Loss: 0.1572523
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1517254
	speed: 0.8939s/iter; left time: 9975.6884s
Epoch: 20 cost time: 55.56954383850098
Epoch: 20, Steps: 139 | Train Loss: 0.1564653 Vali Loss: 0.1317399 Test Loss: 0.1572306
Validation loss decreased (0.131784 --> 0.131740).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1571597
	speed: 0.9157s/iter; left time: 10092.2281s
Epoch: 21 cost time: 55.920284271240234
Epoch: 21, Steps: 139 | Train Loss: 0.1564464 Vali Loss: 0.1317364 Test Loss: 0.1572050
Validation loss decreased (0.131740 --> 0.131736).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1545037
	speed: 0.9063s/iter; left time: 9862.5298s
Epoch: 22 cost time: 54.26396369934082
Epoch: 22, Steps: 139 | Train Loss: 0.1564120 Vali Loss: 0.1316972 Test Loss: 0.1571970
Validation loss decreased (0.131736 --> 0.131697).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1537845
	speed: 0.9302s/iter; left time: 9993.4923s
Epoch: 23 cost time: 59.52426362037659
Epoch: 23, Steps: 139 | Train Loss: 0.1563578 Vali Loss: 0.1317045 Test Loss: 0.1571831
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1412035
	speed: 0.9172s/iter; left time: 9725.5470s
Epoch: 24 cost time: 57.67184233665466
Epoch: 24, Steps: 139 | Train Loss: 0.1563301 Vali Loss: 0.1316494 Test Loss: 0.1571530
Validation loss decreased (0.131697 --> 0.131649).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1551024
	speed: 0.9357s/iter; left time: 9792.2468s
Epoch: 25 cost time: 58.92383074760437
Epoch: 25, Steps: 139 | Train Loss: 0.1563476 Vali Loss: 0.1316559 Test Loss: 0.1571506
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1507005
	speed: 0.9263s/iter; left time: 9564.9567s
Epoch: 26 cost time: 55.91496539115906
Epoch: 26, Steps: 139 | Train Loss: 0.1563223 Vali Loss: 0.1316511 Test Loss: 0.1571229
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1511847
	speed: 0.9438s/iter; left time: 9614.4844s
Epoch: 27 cost time: 58.80582356452942
Epoch: 27, Steps: 139 | Train Loss: 0.1563049 Vali Loss: 0.1316665 Test Loss: 0.1571214
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1638871
	speed: 0.9599s/iter; left time: 9645.3536s
Epoch: 28 cost time: 58.75895833969116
Epoch: 28, Steps: 139 | Train Loss: 0.1563124 Vali Loss: 0.1316651 Test Loss: 0.1571266
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1536456
	speed: 0.9165s/iter; left time: 9081.5253s
Epoch: 29 cost time: 55.27561569213867
Epoch: 29, Steps: 139 | Train Loss: 0.1562810 Vali Loss: 0.1316090 Test Loss: 0.1571269
Validation loss decreased (0.131649 --> 0.131609).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1607895
	speed: 0.9017s/iter; left time: 8809.9312s
Epoch: 30 cost time: 56.108020305633545
Epoch: 30, Steps: 139 | Train Loss: 0.1562692 Vali Loss: 0.1316255 Test Loss: 0.1571019
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1568332
	speed: 0.9080s/iter; left time: 8745.2904s
Epoch: 31 cost time: 56.06577754020691
Epoch: 31, Steps: 139 | Train Loss: 0.1562746 Vali Loss: 0.1315545 Test Loss: 0.1571153
Validation loss decreased (0.131609 --> 0.131554).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1518885
	speed: 0.9185s/iter; left time: 8718.5681s
Epoch: 32 cost time: 54.24202585220337
Epoch: 32, Steps: 139 | Train Loss: 0.1562910 Vali Loss: 0.1316134 Test Loss: 0.1570938
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1543534
	speed: 0.8969s/iter; left time: 8388.3429s
Epoch: 33 cost time: 54.266871213912964
Epoch: 33, Steps: 139 | Train Loss: 0.1562843 Vali Loss: 0.1316213 Test Loss: 0.1570943
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1625108
	speed: 0.8929s/iter; left time: 8227.1202s
Epoch: 34 cost time: 55.13102436065674
Epoch: 34, Steps: 139 | Train Loss: 0.1562886 Vali Loss: 0.1316572 Test Loss: 0.1570866
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1536549
	speed: 0.8834s/iter; left time: 8017.2665s
Epoch: 35 cost time: 54.866790533065796
Epoch: 35, Steps: 139 | Train Loss: 0.1562719 Vali Loss: 0.1315438 Test Loss: 0.1570793
Validation loss decreased (0.131554 --> 0.131544).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1700257
	speed: 0.8917s/iter; left time: 7968.0627s
Epoch: 36 cost time: 53.64022374153137
Epoch: 36, Steps: 139 | Train Loss: 0.1562497 Vali Loss: 0.1316157 Test Loss: 0.1570795
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1569494
	speed: 0.9184s/iter; left time: 8078.8263s
Epoch: 37 cost time: 56.42456865310669
Epoch: 37, Steps: 139 | Train Loss: 0.1562634 Vali Loss: 0.1315230 Test Loss: 0.1570684
Validation loss decreased (0.131544 --> 0.131523).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1437700
	speed: 0.8607s/iter; left time: 7452.0768s
Epoch: 38 cost time: 51.73255133628845
Epoch: 38, Steps: 139 | Train Loss: 0.1562434 Vali Loss: 0.1315864 Test Loss: 0.1570604
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1701127
	speed: 0.8339s/iter; left time: 7104.2661s
Epoch: 39 cost time: 51.45645260810852
Epoch: 39, Steps: 139 | Train Loss: 0.1562102 Vali Loss: 0.1315964 Test Loss: 0.1570698
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1591358
	speed: 0.8614s/iter; left time: 7218.9462s
Epoch: 40 cost time: 53.46724581718445
Epoch: 40, Steps: 139 | Train Loss: 0.1562099 Vali Loss: 0.1314896 Test Loss: 0.1570655
Validation loss decreased (0.131523 --> 0.131490).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1638148
	speed: 0.8649s/iter; left time: 7127.5211s
Epoch: 41 cost time: 51.57954716682434
Epoch: 41, Steps: 139 | Train Loss: 0.1562215 Vali Loss: 0.1316397 Test Loss: 0.1570606
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1532476
	speed: 0.8445s/iter; left time: 6842.2823s
Epoch: 42 cost time: 52.22321367263794
Epoch: 42, Steps: 139 | Train Loss: 0.1561805 Vali Loss: 0.1315921 Test Loss: 0.1570527
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1609736
	speed: 0.8498s/iter; left time: 6767.2153s
Epoch: 43 cost time: 51.79420828819275
Epoch: 43, Steps: 139 | Train Loss: 0.1561958 Vali Loss: 0.1314890 Test Loss: 0.1570520
Validation loss decreased (0.131490 --> 0.131489).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1566510
	speed: 0.7960s/iter; left time: 6228.2724s
Epoch: 44 cost time: 48.537768602371216
Epoch: 44, Steps: 139 | Train Loss: 0.1562312 Vali Loss: 0.1315977 Test Loss: 0.1570505
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1587509
	speed: 0.7828s/iter; left time: 6015.8076s
Epoch: 45 cost time: 49.03646993637085
Epoch: 45, Steps: 139 | Train Loss: 0.1562021 Vali Loss: 0.1315635 Test Loss: 0.1570525
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1463794
	speed: 0.8341s/iter; left time: 6293.9056s
Epoch: 46 cost time: 51.55794143676758
Epoch: 46, Steps: 139 | Train Loss: 0.1562294 Vali Loss: 0.1315679 Test Loss: 0.1570505
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1603736
	speed: 0.8291s/iter; left time: 6141.4890s
Epoch: 47 cost time: 49.945677757263184
Epoch: 47, Steps: 139 | Train Loss: 0.1561873 Vali Loss: 0.1315048 Test Loss: 0.1570466
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1579038
	speed: 0.8039s/iter; left time: 5842.4848s
Epoch: 48 cost time: 50.23121690750122
Epoch: 48, Steps: 139 | Train Loss: 0.1561692 Vali Loss: 0.1315674 Test Loss: 0.1570452
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1477976
	speed: 0.8469s/iter; left time: 6037.5227s
Epoch: 49 cost time: 50.73665237426758
Epoch: 49, Steps: 139 | Train Loss: 0.1562077 Vali Loss: 0.1315009 Test Loss: 0.1570451
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1555786
	speed: 0.8429s/iter; left time: 5891.8650s
Epoch: 50 cost time: 53.45665097236633
Epoch: 50, Steps: 139 | Train Loss: 0.1562437 Vali Loss: 0.1314790 Test Loss: 0.1570536
Validation loss decreased (0.131489 --> 0.131479).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1624625
	speed: 0.8238s/iter; left time: 5643.7592s
Epoch: 51 cost time: 49.741865158081055
Epoch: 51, Steps: 139 | Train Loss: 0.1562415 Vali Loss: 0.1314930 Test Loss: 0.1570453
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1532397
	speed: 0.8090s/iter; left time: 5429.8406s
Epoch: 52 cost time: 50.438568353652954
Epoch: 52, Steps: 139 | Train Loss: 0.1562173 Vali Loss: 0.1315404 Test Loss: 0.1570418
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1495080
	speed: 0.8271s/iter; left time: 5436.5273s
Epoch: 53 cost time: 54.76279282569885
Epoch: 53, Steps: 139 | Train Loss: 0.1562077 Vali Loss: 0.1315603 Test Loss: 0.1570465
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1631725
	speed: 1.0788s/iter; left time: 6941.0294s
Epoch: 54 cost time: 64.40429902076721
Epoch: 54, Steps: 139 | Train Loss: 0.1562542 Vali Loss: 0.1315593 Test Loss: 0.1570372
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1778186
	speed: 1.0221s/iter; left time: 6433.8890s
Epoch: 55 cost time: 65.17718625068665
Epoch: 55, Steps: 139 | Train Loss: 0.1561261 Vali Loss: 0.1315308 Test Loss: 0.1570429
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1453575
	speed: 1.0798s/iter; left time: 6647.0017s
Epoch: 56 cost time: 67.40002059936523
Epoch: 56, Steps: 139 | Train Loss: 0.1561597 Vali Loss: 0.1315065 Test Loss: 0.1570388
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1613843
	speed: 1.0910s/iter; left time: 6564.3434s
Epoch: 57 cost time: 69.5388240814209
Epoch: 57, Steps: 139 | Train Loss: 0.1561304 Vali Loss: 0.1315505 Test Loss: 0.1570400
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1468790
	speed: 1.1817s/iter; left time: 6946.3178s
Epoch: 58 cost time: 69.93986678123474
Epoch: 58, Steps: 139 | Train Loss: 0.1562427 Vali Loss: 0.1315558 Test Loss: 0.1570388
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1715745
	speed: 1.1026s/iter; left time: 6327.8278s
Epoch: 59 cost time: 68.86779880523682
Epoch: 59, Steps: 139 | Train Loss: 0.1562082 Vali Loss: 0.1315169 Test Loss: 0.1570400
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1547901
	speed: 1.0960s/iter; left time: 6137.7779s
Epoch: 60 cost time: 68.66994547843933
Epoch: 60, Steps: 139 | Train Loss: 0.1561406 Vali Loss: 0.1314839 Test Loss: 0.1570385
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1536265
	speed: 1.1399s/iter; left time: 6225.1378s
Epoch: 61 cost time: 65.33135414123535
Epoch: 61, Steps: 139 | Train Loss: 0.1561432 Vali Loss: 0.1315840 Test Loss: 0.1570372
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1502110
	speed: 1.1072s/iter; left time: 5892.6180s
Epoch: 62 cost time: 69.3233392238617
Epoch: 62, Steps: 139 | Train Loss: 0.1561462 Vali Loss: 0.1315367 Test Loss: 0.1570325
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1600800
	speed: 1.1140s/iter; left time: 5773.7297s
Epoch: 63 cost time: 69.24455666542053
Epoch: 63, Steps: 139 | Train Loss: 0.1561044 Vali Loss: 0.1315071 Test Loss: 0.1570363
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1557818
	speed: 1.0959s/iter; left time: 5527.6855s
Epoch: 64 cost time: 66.99302291870117
Epoch: 64, Steps: 139 | Train Loss: 0.1561720 Vali Loss: 0.1314579 Test Loss: 0.1570368
Validation loss decreased (0.131479 --> 0.131458).  Saving model ...
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1520584
	speed: 1.1447s/iter; left time: 5614.8436s
Epoch: 65 cost time: 66.24967980384827
Epoch: 65, Steps: 139 | Train Loss: 0.1561502 Vali Loss: 0.1315850 Test Loss: 0.1570337
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1569530
	speed: 1.1462s/iter; left time: 5462.6941s
Epoch: 66 cost time: 68.09861731529236
Epoch: 66, Steps: 139 | Train Loss: 0.1561665 Vali Loss: 0.1315366 Test Loss: 0.1570338
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1494756
	speed: 1.0774s/iter; left time: 4985.2719s
Epoch: 67 cost time: 67.14664769172668
Epoch: 67, Steps: 139 | Train Loss: 0.1562270 Vali Loss: 0.1315155 Test Loss: 0.1570337
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1408545
	speed: 1.1330s/iter; left time: 5085.1142s
Epoch: 68 cost time: 69.15973329544067
Epoch: 68, Steps: 139 | Train Loss: 0.1561831 Vali Loss: 0.1315195 Test Loss: 0.1570335
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1508407
	speed: 1.2094s/iter; left time: 5259.7378s
Epoch: 69 cost time: 70.94346475601196
Epoch: 69, Steps: 139 | Train Loss: 0.1562325 Vali Loss: 0.1315600 Test Loss: 0.1570336
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1505111
	speed: 1.1109s/iter; left time: 4677.0316s
Epoch: 70 cost time: 66.19182252883911
Epoch: 70, Steps: 139 | Train Loss: 0.1561676 Vali Loss: 0.1315283 Test Loss: 0.1570339
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1686608
	speed: 1.0748s/iter; left time: 4375.5949s
Epoch: 71 cost time: 64.04067397117615
Epoch: 71, Steps: 139 | Train Loss: 0.1561211 Vali Loss: 0.1315417 Test Loss: 0.1570336
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1532893
	speed: 1.0479s/iter; left time: 4120.2239s
Epoch: 72 cost time: 63.60551071166992
Epoch: 72, Steps: 139 | Train Loss: 0.1561830 Vali Loss: 0.1314817 Test Loss: 0.1570324
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1419173
	speed: 1.0787s/iter; left time: 4091.3301s
Epoch: 73 cost time: 68.3707537651062
Epoch: 73, Steps: 139 | Train Loss: 0.1562217 Vali Loss: 0.1315216 Test Loss: 0.1570302
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1524175
	speed: 1.0917s/iter; left time: 3989.0630s
Epoch: 74 cost time: 64.85161447525024
Epoch: 74, Steps: 139 | Train Loss: 0.1561601 Vali Loss: 0.1315151 Test Loss: 0.1570307
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1537762
	speed: 1.0394s/iter; left time: 3653.4419s
Epoch: 75 cost time: 62.69595956802368
Epoch: 75, Steps: 139 | Train Loss: 0.1561999 Vali Loss: 0.1315204 Test Loss: 0.1570295
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1559999
	speed: 1.0415s/iter; left time: 3516.0972s
Epoch: 76 cost time: 64.12827205657959
Epoch: 76, Steps: 139 | Train Loss: 0.1561777 Vali Loss: 0.1315155 Test Loss: 0.1570310
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1512913
	speed: 1.0883s/iter; left time: 3522.7950s
Epoch: 77 cost time: 66.84542894363403
Epoch: 77, Steps: 139 | Train Loss: 0.1561406 Vali Loss: 0.1315474 Test Loss: 0.1570285
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1530203
	speed: 1.1086s/iter; left time: 3434.2949s
Epoch: 78 cost time: 63.69505262374878
Epoch: 78, Steps: 139 | Train Loss: 0.1561644 Vali Loss: 0.1315096 Test Loss: 0.1570276
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1576231
	speed: 1.1228s/iter; left time: 3322.2344s
Epoch: 79 cost time: 69.83751893043518
Epoch: 79, Steps: 139 | Train Loss: 0.1561452 Vali Loss: 0.1315307 Test Loss: 0.1570286
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1543565
	speed: 1.1265s/iter; left time: 3176.6780s
Epoch: 80 cost time: 69.09071278572083
Epoch: 80, Steps: 139 | Train Loss: 0.1560435 Vali Loss: 0.1315098 Test Loss: 0.1570286
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.1480906
	speed: 1.1077s/iter; left time: 2969.8278s
Epoch: 81 cost time: 65.59395861625671
Epoch: 81, Steps: 139 | Train Loss: 0.1562056 Vali Loss: 0.1315151 Test Loss: 0.1570286
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1484945
	speed: 1.0831s/iter; left time: 2753.2683s
Epoch: 82 cost time: 66.81890797615051
Epoch: 82, Steps: 139 | Train Loss: 0.1561485 Vali Loss: 0.1314920 Test Loss: 0.1570295
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1585960
	speed: 1.1828s/iter; left time: 2842.1525s
Epoch: 83 cost time: 72.27171468734741
Epoch: 83, Steps: 139 | Train Loss: 0.1562017 Vali Loss: 0.1315094 Test Loss: 0.1570286
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.1552599
	speed: 1.1174s/iter; left time: 2529.6881s
Epoch: 84 cost time: 64.80100440979004
Epoch: 84, Steps: 139 | Train Loss: 0.1561882 Vali Loss: 0.1315212 Test Loss: 0.1570295
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_360_j192_H10_FITS_custom_ftM_sl360_ll48_pl192_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.1542079597711563, mae:0.2478921264410019, rse:0.39044132828712463, corr:[0.46340224 0.46572903 0.46626255 0.467461   0.46740645 0.46795398
 0.4676733  0.46773997 0.46739787 0.4672289  0.46702033 0.46686313
 0.4668521  0.46679163 0.46682784 0.46679476 0.46687925 0.46672806
 0.46672392 0.46644476 0.46631217 0.46632046 0.46627644 0.46653003
 0.46668765 0.46689716 0.4669623  0.46684822 0.46683452 0.4665949
 0.46658906 0.4663372  0.46625945 0.46605417 0.46597078 0.46580386
 0.46578792 0.46572256 0.4655693  0.46551073 0.4653383  0.4652355
 0.46501315 0.4648689  0.46473217 0.46466678 0.46468276 0.4647642
 0.46496472 0.465039   0.46509334 0.4650984  0.46495682 0.46498144
 0.4648403  0.46482372 0.46469814 0.46467718 0.46460015 0.46455443
 0.46461287 0.46457985 0.46458358 0.46449384 0.46450824 0.46438208
 0.4643669  0.46419856 0.46404406 0.46405032 0.46401072 0.4641396
 0.4642287  0.46426493 0.4643649  0.46426705 0.46427578 0.4641986
 0.4642257  0.4641069  0.46406946 0.46401435 0.4639394  0.46396556
 0.46384367 0.4639242  0.46383902 0.46385774 0.46379265 0.46376938
 0.4637422  0.4635028  0.4633983  0.46333826 0.46336097 0.46350107
 0.46356857 0.46366677 0.46368396 0.46371514 0.46365893 0.46361655
 0.46358782 0.46356636 0.46354452 0.46342582 0.46338877 0.46327266
 0.46332428 0.4632159  0.46323806 0.46320292 0.46317562 0.4631877
 0.46314812 0.46323013 0.46319053 0.46328503 0.46339384 0.4635708
 0.46376342 0.46381503 0.4639341  0.4639281  0.4639255  0.463927
 0.4638727  0.46388233 0.46374708 0.46376523 0.4636129  0.46360007
 0.46350348 0.46352664 0.4635221  0.4634789  0.4635497  0.46350077
 0.46365255 0.46350127 0.46351805 0.4635576  0.46373084 0.46398598
 0.4643082  0.46455133 0.4646197  0.46466672 0.46467727 0.4645804
 0.4646094  0.4644332  0.46444854 0.46426105 0.46423328 0.46416426
 0.4641398  0.46419504 0.46415716 0.46434566 0.46428886 0.46445978
 0.46434698 0.4642289  0.4639954  0.46384624 0.46383932 0.46377987
 0.463722   0.4634944  0.46347818 0.46329394 0.46305883 0.4628802
 0.4626438  0.46254215 0.46227893 0.46226192 0.46209148 0.46220434
 0.46218675 0.46225998 0.4623712  0.4622276  0.46238095 0.46193033
 0.46208996 0.46129787 0.46149662 0.4609747  0.4617956  0.46189174]
