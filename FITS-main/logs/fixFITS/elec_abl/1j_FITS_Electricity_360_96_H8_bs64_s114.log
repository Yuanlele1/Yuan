Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=138, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_360_j96_H8', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_360_j96_H8_FITS_custom_ftM_sl360_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17957
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=138, out_features=174, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  986605056.0
params:  24186.0
Trainable parameters:  24186
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3017337
	speed: 0.5694s/iter; left time: 7915.3063s
Epoch: 1 cost time: 78.85734939575195
Epoch: 1, Steps: 140 | Train Loss: 0.4570941 Vali Loss: 0.1911668 Test Loss: 0.2224291
Validation loss decreased (inf --> 0.191167).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1546053
	speed: 1.0775s/iter; left time: 14827.9002s
Epoch: 2 cost time: 63.82553791999817
Epoch: 2, Steps: 140 | Train Loss: 0.1763918 Vali Loss: 0.1289696 Test Loss: 0.1514275
Validation loss decreased (0.191167 --> 0.128970).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1481070
	speed: 1.0286s/iter; left time: 14010.5805s
Epoch: 3 cost time: 61.473487854003906
Epoch: 3, Steps: 140 | Train Loss: 0.1486201 Vali Loss: 0.1243551 Test Loss: 0.1453331
Validation loss decreased (0.128970 --> 0.124355).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1376635
	speed: 1.0149s/iter; left time: 13681.6188s
Epoch: 4 cost time: 61.18972134590149
Epoch: 4, Steps: 140 | Train Loss: 0.1459030 Vali Loss: 0.1234072 Test Loss: 0.1441666
Validation loss decreased (0.124355 --> 0.123407).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1410839
	speed: 0.9848s/iter; left time: 13138.1326s
Epoch: 5 cost time: 61.65558338165283
Epoch: 5, Steps: 140 | Train Loss: 0.1449587 Vali Loss: 0.1230824 Test Loss: 0.1436159
Validation loss decreased (0.123407 --> 0.123082).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1581081
	speed: 0.9846s/iter; left time: 12997.9019s
Epoch: 6 cost time: 62.50507736206055
Epoch: 6, Steps: 140 | Train Loss: 0.1444964 Vali Loss: 0.1225485 Test Loss: 0.1432447
Validation loss decreased (0.123082 --> 0.122549).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1367548
	speed: 1.0326s/iter; left time: 13486.4885s
Epoch: 7 cost time: 59.3769211769104
Epoch: 7, Steps: 140 | Train Loss: 0.1441716 Vali Loss: 0.1226574 Test Loss: 0.1430159
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1408214
	speed: 0.9839s/iter; left time: 12713.3705s
Epoch: 8 cost time: 62.363121032714844
Epoch: 8, Steps: 140 | Train Loss: 0.1439225 Vali Loss: 0.1225304 Test Loss: 0.1428699
Validation loss decreased (0.122549 --> 0.122530).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1481356
	speed: 0.9870s/iter; left time: 12615.4103s
Epoch: 9 cost time: 61.232465505599976
Epoch: 9, Steps: 140 | Train Loss: 0.1437370 Vali Loss: 0.1221692 Test Loss: 0.1427155
Validation loss decreased (0.122530 --> 0.122169).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1401702
	speed: 1.0096s/iter; left time: 12762.3503s
Epoch: 10 cost time: 61.47932839393616
Epoch: 10, Steps: 140 | Train Loss: 0.1436807 Vali Loss: 0.1222271 Test Loss: 0.1426993
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1455591
	speed: 1.0215s/iter; left time: 12769.9816s
Epoch: 11 cost time: 63.10897374153137
Epoch: 11, Steps: 140 | Train Loss: 0.1435310 Vali Loss: 0.1221950 Test Loss: 0.1425684
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1470436
	speed: 1.0426s/iter; left time: 12888.1516s
Epoch: 12 cost time: 64.2656364440918
Epoch: 12, Steps: 140 | Train Loss: 0.1435094 Vali Loss: 0.1221302 Test Loss: 0.1425180
Validation loss decreased (0.122169 --> 0.122130).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1359321
	speed: 0.9675s/iter; left time: 11823.2516s
Epoch: 13 cost time: 60.59474563598633
Epoch: 13, Steps: 140 | Train Loss: 0.1434634 Vali Loss: 0.1220421 Test Loss: 0.1425053
Validation loss decreased (0.122130 --> 0.122042).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1516073
	speed: 1.0660s/iter; left time: 12878.6133s
Epoch: 14 cost time: 66.25176858901978
Epoch: 14, Steps: 140 | Train Loss: 0.1433858 Vali Loss: 0.1220870 Test Loss: 0.1424079
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1472681
	speed: 0.9980s/iter; left time: 11916.6736s
Epoch: 15 cost time: 62.326594829559326
Epoch: 15, Steps: 140 | Train Loss: 0.1433186 Vali Loss: 0.1218876 Test Loss: 0.1423820
Validation loss decreased (0.122042 --> 0.121888).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1538608
	speed: 1.0473s/iter; left time: 12359.4231s
Epoch: 16 cost time: 64.15343713760376
Epoch: 16, Steps: 140 | Train Loss: 0.1433158 Vali Loss: 0.1220179 Test Loss: 0.1424029
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1391916
	speed: 1.0153s/iter; left time: 11839.3797s
Epoch: 17 cost time: 62.183403730392456
Epoch: 17, Steps: 140 | Train Loss: 0.1432290 Vali Loss: 0.1219130 Test Loss: 0.1423888
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1395877
	speed: 0.9559s/iter; left time: 11013.3443s
Epoch: 18 cost time: 58.76414108276367
Epoch: 18, Steps: 140 | Train Loss: 0.1432312 Vali Loss: 0.1220415 Test Loss: 0.1423941
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1605118
	speed: 1.0111s/iter; left time: 11507.1931s
Epoch: 19 cost time: 66.40852189064026
Epoch: 19, Steps: 140 | Train Loss: 0.1432413 Vali Loss: 0.1219170 Test Loss: 0.1423526
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1438673
	speed: 1.0356s/iter; left time: 11641.4921s
Epoch: 20 cost time: 62.723692655563354
Epoch: 20, Steps: 140 | Train Loss: 0.1432125 Vali Loss: 0.1218462 Test Loss: 0.1423031
Validation loss decreased (0.121888 --> 0.121846).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1444998
	speed: 0.9991s/iter; left time: 11091.4684s
Epoch: 21 cost time: 61.815383195877075
Epoch: 21, Steps: 140 | Train Loss: 0.1431786 Vali Loss: 0.1219323 Test Loss: 0.1422773
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1479126
	speed: 1.0547s/iter; left time: 11561.0691s
Epoch: 22 cost time: 62.84482717514038
Epoch: 22, Steps: 140 | Train Loss: 0.1431424 Vali Loss: 0.1215789 Test Loss: 0.1422374
Validation loss decreased (0.121846 --> 0.121579).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1377375
	speed: 1.0018s/iter; left time: 10840.0224s
Epoch: 23 cost time: 63.23717427253723
Epoch: 23, Steps: 140 | Train Loss: 0.1431398 Vali Loss: 0.1218063 Test Loss: 0.1422487
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1488641
	speed: 1.0759s/iter; left time: 11491.8762s
Epoch: 24 cost time: 65.44957423210144
Epoch: 24, Steps: 140 | Train Loss: 0.1430933 Vali Loss: 0.1217360 Test Loss: 0.1422439
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1478871
	speed: 1.0374s/iter; left time: 10935.3599s
Epoch: 25 cost time: 62.67566895484924
Epoch: 25, Steps: 140 | Train Loss: 0.1431328 Vali Loss: 0.1217049 Test Loss: 0.1422363
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1491992
	speed: 1.0209s/iter; left time: 10618.6191s
Epoch: 26 cost time: 63.06743001937866
Epoch: 26, Steps: 140 | Train Loss: 0.1430527 Vali Loss: 0.1216666 Test Loss: 0.1422181
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1350410
	speed: 0.9906s/iter; left time: 10164.1066s
Epoch: 27 cost time: 62.63732719421387
Epoch: 27, Steps: 140 | Train Loss: 0.1430726 Vali Loss: 0.1215785 Test Loss: 0.1422437
Validation loss decreased (0.121579 --> 0.121578).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1447043
	speed: 1.0390s/iter; left time: 10515.6116s
Epoch: 28 cost time: 63.011335611343384
Epoch: 28, Steps: 140 | Train Loss: 0.1430698 Vali Loss: 0.1218018 Test Loss: 0.1421960
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1384771
	speed: 1.0457s/iter; left time: 10437.1223s
Epoch: 29 cost time: 62.615538358688354
Epoch: 29, Steps: 140 | Train Loss: 0.1430136 Vali Loss: 0.1218292 Test Loss: 0.1421732
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1474156
	speed: 0.9978s/iter; left time: 9818.9801s
Epoch: 30 cost time: 60.249114990234375
Epoch: 30, Steps: 140 | Train Loss: 0.1430620 Vali Loss: 0.1217601 Test Loss: 0.1421957
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1434030
	speed: 0.9972s/iter; left time: 9673.8348s
Epoch: 31 cost time: 64.8252284526825
Epoch: 31, Steps: 140 | Train Loss: 0.1430500 Vali Loss: 0.1216933 Test Loss: 0.1421800
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1541699
	speed: 1.0273s/iter; left time: 9822.1632s
Epoch: 32 cost time: 61.929293155670166
Epoch: 32, Steps: 140 | Train Loss: 0.1430045 Vali Loss: 0.1219611 Test Loss: 0.1421732
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1445494
	speed: 1.0480s/iter; left time: 9872.9878s
Epoch: 33 cost time: 63.547929525375366
Epoch: 33, Steps: 140 | Train Loss: 0.1430325 Vali Loss: 0.1217319 Test Loss: 0.1421542
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1392705
	speed: 1.0281s/iter; left time: 9541.6265s
Epoch: 34 cost time: 61.406606674194336
Epoch: 34, Steps: 140 | Train Loss: 0.1430349 Vali Loss: 0.1217520 Test Loss: 0.1421690
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1449219
	speed: 1.0152s/iter; left time: 9279.5733s
Epoch: 35 cost time: 63.578453063964844
Epoch: 35, Steps: 140 | Train Loss: 0.1429928 Vali Loss: 0.1218645 Test Loss: 0.1421785
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1532757
	speed: 1.0214s/iter; left time: 9193.2636s
Epoch: 36 cost time: 66.21279191970825
Epoch: 36, Steps: 140 | Train Loss: 0.1430301 Vali Loss: 0.1221179 Test Loss: 0.1421588
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1389826
	speed: 1.0271s/iter; left time: 9101.2560s
Epoch: 37 cost time: 62.66356706619263
Epoch: 37, Steps: 140 | Train Loss: 0.1430129 Vali Loss: 0.1217771 Test Loss: 0.1421459
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1518812
	speed: 1.0058s/iter; left time: 8771.2744s
Epoch: 38 cost time: 62.684008836746216
Epoch: 38, Steps: 140 | Train Loss: 0.1430074 Vali Loss: 0.1218302 Test Loss: 0.1421671
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1423275
	speed: 1.0218s/iter; left time: 8768.3019s
Epoch: 39 cost time: 64.18440628051758
Epoch: 39, Steps: 140 | Train Loss: 0.1430144 Vali Loss: 0.1216216 Test Loss: 0.1421497
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1507694
	speed: 1.0276s/iter; left time: 8674.3591s
Epoch: 40 cost time: 60.803603172302246
Epoch: 40, Steps: 140 | Train Loss: 0.1430073 Vali Loss: 0.1217206 Test Loss: 0.1421477
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1405067
	speed: 1.0088s/iter; left time: 8374.2070s
Epoch: 41 cost time: 60.69286561012268
Epoch: 41, Steps: 140 | Train Loss: 0.1429891 Vali Loss: 0.1218343 Test Loss: 0.1421507
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1374176
	speed: 1.0366s/iter; left time: 8459.5154s
Epoch: 42 cost time: 62.00697588920593
Epoch: 42, Steps: 140 | Train Loss: 0.1430207 Vali Loss: 0.1218169 Test Loss: 0.1421340
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1515106
	speed: 1.0448s/iter; left time: 8380.0296s
Epoch: 43 cost time: 63.445977449417114
Epoch: 43, Steps: 140 | Train Loss: 0.1429577 Vali Loss: 0.1217324 Test Loss: 0.1421349
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1631784
	speed: 0.9556s/iter; left time: 7530.9765s
Epoch: 44 cost time: 58.593770265579224
Epoch: 44, Steps: 140 | Train Loss: 0.1430021 Vali Loss: 0.1214590 Test Loss: 0.1421411
Validation loss decreased (0.121578 --> 0.121459).  Saving model ...
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1388590
	speed: 0.9954s/iter; left time: 7705.3706s
Epoch: 45 cost time: 63.26683950424194
Epoch: 45, Steps: 140 | Train Loss: 0.1429797 Vali Loss: 0.1218931 Test Loss: 0.1421324
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1335503
	speed: 1.0098s/iter; left time: 7675.7881s
Epoch: 46 cost time: 62.10750484466553
Epoch: 46, Steps: 140 | Train Loss: 0.1429940 Vali Loss: 0.1218438 Test Loss: 0.1421558
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1413081
	speed: 1.0730s/iter; left time: 8005.2964s
Epoch: 47 cost time: 70.76134133338928
Epoch: 47, Steps: 140 | Train Loss: 0.1429434 Vali Loss: 0.1216564 Test Loss: 0.1421227
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1475642
	speed: 1.0519s/iter; left time: 7700.8157s
Epoch: 48 cost time: 60.759246826171875
Epoch: 48, Steps: 140 | Train Loss: 0.1429837 Vali Loss: 0.1217922 Test Loss: 0.1421155
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1483417
	speed: 1.0209s/iter; left time: 7331.1529s
Epoch: 49 cost time: 65.75515079498291
Epoch: 49, Steps: 140 | Train Loss: 0.1429668 Vali Loss: 0.1217332 Test Loss: 0.1421192
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1408835
	speed: 0.9869s/iter; left time: 6948.9186s
Epoch: 50 cost time: 62.91558480262756
Epoch: 50, Steps: 140 | Train Loss: 0.1429790 Vali Loss: 0.1216124 Test Loss: 0.1421232
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1454342
	speed: 1.0686s/iter; left time: 7374.4118s
Epoch: 51 cost time: 61.86487126350403
Epoch: 51, Steps: 140 | Train Loss: 0.1429639 Vali Loss: 0.1217634 Test Loss: 0.1421213
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.1581116
	speed: 1.0543s/iter; left time: 7128.3527s
Epoch: 52 cost time: 57.875168323516846
Epoch: 52, Steps: 140 | Train Loss: 0.1429509 Vali Loss: 0.1218003 Test Loss: 0.1421233
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.1436309
	speed: 0.9736s/iter; left time: 6446.1878s
Epoch: 53 cost time: 61.280017614364624
Epoch: 53, Steps: 140 | Train Loss: 0.1429517 Vali Loss: 0.1214795 Test Loss: 0.1421268
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.1451681
	speed: 1.0031s/iter; left time: 6501.2819s
Epoch: 54 cost time: 63.29541373252869
Epoch: 54, Steps: 140 | Train Loss: 0.1429653 Vali Loss: 0.1215791 Test Loss: 0.1421133
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.1415557
	speed: 1.0139s/iter; left time: 6429.1476s
Epoch: 55 cost time: 60.94019627571106
Epoch: 55, Steps: 140 | Train Loss: 0.1429540 Vali Loss: 0.1215365 Test Loss: 0.1421297
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.1475349
	speed: 0.9964s/iter; left time: 6178.4177s
Epoch: 56 cost time: 60.39147162437439
Epoch: 56, Steps: 140 | Train Loss: 0.1429893 Vali Loss: 0.1216618 Test Loss: 0.1421124
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.1391241
	speed: 0.9828s/iter; left time: 5956.9215s
Epoch: 57 cost time: 63.891804456710815
Epoch: 57, Steps: 140 | Train Loss: 0.1429691 Vali Loss: 0.1215445 Test Loss: 0.1421179
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.1360432
	speed: 0.9922s/iter; left time: 5874.6473s
Epoch: 58 cost time: 58.993510723114014
Epoch: 58, Steps: 140 | Train Loss: 0.1429663 Vali Loss: 0.1214393 Test Loss: 0.1421123
Validation loss decreased (0.121459 --> 0.121439).  Saving model ...
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.1439697
	speed: 0.9983s/iter; left time: 5771.0572s
Epoch: 59 cost time: 63.98441529273987
Epoch: 59, Steps: 140 | Train Loss: 0.1429447 Vali Loss: 0.1215109 Test Loss: 0.1421126
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.1371627
	speed: 1.0676s/iter; left time: 6022.2265s
Epoch: 60 cost time: 69.47241592407227
Epoch: 60, Steps: 140 | Train Loss: 0.1429363 Vali Loss: 0.1216920 Test Loss: 0.1421046
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.1412046
	speed: 1.1118s/iter; left time: 6115.8454s
Epoch: 61 cost time: 64.14592933654785
Epoch: 61, Steps: 140 | Train Loss: 0.1429238 Vali Loss: 0.1214869 Test Loss: 0.1421064
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.1417336
	speed: 0.9567s/iter; left time: 5128.9373s
Epoch: 62 cost time: 60.649842500686646
Epoch: 62, Steps: 140 | Train Loss: 0.1429580 Vali Loss: 0.1216120 Test Loss: 0.1421115
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.1513940
	speed: 1.0062s/iter; left time: 5253.4951s
Epoch: 63 cost time: 59.6063232421875
Epoch: 63, Steps: 140 | Train Loss: 0.1429313 Vali Loss: 0.1217009 Test Loss: 0.1421086
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.1325971
	speed: 0.9900s/iter; left time: 5030.3530s
Epoch: 64 cost time: 65.38831448554993
Epoch: 64, Steps: 140 | Train Loss: 0.1429236 Vali Loss: 0.1215890 Test Loss: 0.1421072
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.1333096
	speed: 0.9623s/iter; left time: 4754.7823s
Epoch: 65 cost time: 57.63251733779907
Epoch: 65, Steps: 140 | Train Loss: 0.1429314 Vali Loss: 0.1215298 Test Loss: 0.1421091
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.1308237
	speed: 1.0031s/iter; left time: 4815.7615s
Epoch: 66 cost time: 61.3296332359314
Epoch: 66, Steps: 140 | Train Loss: 0.1429433 Vali Loss: 0.1217150 Test Loss: 0.1421073
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.1297497
	speed: 0.9855s/iter; left time: 4593.5026s
Epoch: 67 cost time: 60.59475874900818
Epoch: 67, Steps: 140 | Train Loss: 0.1429395 Vali Loss: 0.1216972 Test Loss: 0.1421076
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.1369057
	speed: 1.0726s/iter; left time: 4849.1247s
Epoch: 68 cost time: 64.67930459976196
Epoch: 68, Steps: 140 | Train Loss: 0.1429476 Vali Loss: 0.1216139 Test Loss: 0.1421049
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.1420517
	speed: 0.9875s/iter; left time: 4326.4110s
Epoch: 69 cost time: 58.39419746398926
Epoch: 69, Steps: 140 | Train Loss: 0.1428955 Vali Loss: 0.1218092 Test Loss: 0.1421053
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.1575014
	speed: 0.9773s/iter; left time: 4144.7037s
Epoch: 70 cost time: 60.058666467666626
Epoch: 70, Steps: 140 | Train Loss: 0.1429399 Vali Loss: 0.1215860 Test Loss: 0.1421046
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.1496409
	speed: 0.9684s/iter; left time: 3971.5081s
Epoch: 71 cost time: 60.460732221603394
Epoch: 71, Steps: 140 | Train Loss: 0.1429108 Vali Loss: 0.1217854 Test Loss: 0.1421057
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.1507839
	speed: 1.0924s/iter; left time: 4327.0789s
Epoch: 72 cost time: 68.792635679245
Epoch: 72, Steps: 140 | Train Loss: 0.1429336 Vali Loss: 0.1215601 Test Loss: 0.1421041
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.1344301
	speed: 1.0142s/iter; left time: 3875.3146s
Epoch: 73 cost time: 57.45092463493347
Epoch: 73, Steps: 140 | Train Loss: 0.1429287 Vali Loss: 0.1216344 Test Loss: 0.1421038
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.1499621
	speed: 0.9743s/iter; left time: 3586.3469s
Epoch: 74 cost time: 63.88302278518677
Epoch: 74, Steps: 140 | Train Loss: 0.1429551 Vali Loss: 0.1215365 Test Loss: 0.1421065
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.1384884
	speed: 1.0016s/iter; left time: 3546.5761s
Epoch: 75 cost time: 58.84885787963867
Epoch: 75, Steps: 140 | Train Loss: 0.1428896 Vali Loss: 0.1217127 Test Loss: 0.1421029
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.1507266
	speed: 0.9491s/iter; left time: 3227.7416s
Epoch: 76 cost time: 60.02611041069031
Epoch: 76, Steps: 140 | Train Loss: 0.1428965 Vali Loss: 0.1216915 Test Loss: 0.1421049
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.1425438
	speed: 0.8942s/iter; left time: 2916.0651s
Epoch: 77 cost time: 52.80329990386963
Epoch: 77, Steps: 140 | Train Loss: 0.1429507 Vali Loss: 0.1216187 Test Loss: 0.1421017
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.1473806
	speed: 0.8700s/iter; left time: 2715.3616s
Epoch: 78 cost time: 54.70745396614075
Epoch: 78, Steps: 140 | Train Loss: 0.1429429 Vali Loss: 0.1213953 Test Loss: 0.1421017
Validation loss decreased (0.121439 --> 0.121395).  Saving model ...
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.1398912
	speed: 0.8549s/iter; left time: 2548.5700s
Epoch: 79 cost time: 53.765421867370605
Epoch: 79, Steps: 140 | Train Loss: 0.1429263 Vali Loss: 0.1217986 Test Loss: 0.1421022
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.1365982
	speed: 0.9016s/iter; left time: 2561.5651s
Epoch: 80 cost time: 55.69593071937561
Epoch: 80, Steps: 140 | Train Loss: 0.1429081 Vali Loss: 0.1212719 Test Loss: 0.1421041
Validation loss decreased (0.121395 --> 0.121272).  Saving model ...
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.1436438
	speed: 0.8505s/iter; left time: 2297.2490s
Epoch: 81 cost time: 53.25062346458435
Epoch: 81, Steps: 140 | Train Loss: 0.1429106 Vali Loss: 0.1215435 Test Loss: 0.1421010
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.1507074
	speed: 0.8411s/iter; left time: 2154.0321s
Epoch: 82 cost time: 51.89216446876526
Epoch: 82, Steps: 140 | Train Loss: 0.1429079 Vali Loss: 0.1216649 Test Loss: 0.1421000
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.84480283288145e-06
	iters: 100, epoch: 83 | loss: 0.1418944
	speed: 0.8706s/iter; left time: 2107.7204s
Epoch: 83 cost time: 52.83761787414551
Epoch: 83, Steps: 140 | Train Loss: 0.1429462 Vali Loss: 0.1217213 Test Loss: 0.1421021
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.452562691237377e-06
	iters: 100, epoch: 84 | loss: 0.1450205
	speed: 1.0061s/iter; left time: 2294.9205s
Epoch: 84 cost time: 59.904738664627075
Epoch: 84, Steps: 140 | Train Loss: 0.1429021 Vali Loss: 0.1217074 Test Loss: 0.1421001
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.079934556675507e-06
	iters: 100, epoch: 85 | loss: 0.1400097
	speed: 0.8771s/iter; left time: 1877.8954s
Epoch: 85 cost time: 51.09753108024597
Epoch: 85, Steps: 140 | Train Loss: 0.1428771 Vali Loss: 0.1218628 Test Loss: 0.1421002
EarlyStopping counter: 5 out of 20
Updating learning rate to 6.725937828841732e-06
	iters: 100, epoch: 86 | loss: 0.1380918
	speed: 0.9031s/iter; left time: 1807.1482s
Epoch: 86 cost time: 53.4475359916687
Epoch: 86, Steps: 140 | Train Loss: 0.1429128 Vali Loss: 0.1217201 Test Loss: 0.1420998
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.389640937399644e-06
	iters: 100, epoch: 87 | loss: 0.1335108
	speed: 0.8641s/iter; left time: 1608.0204s
Epoch: 87 cost time: 52.06746530532837
Epoch: 87, Steps: 140 | Train Loss: 0.1429613 Vali Loss: 0.1217755 Test Loss: 0.1421003
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.070158890529662e-06
	iters: 100, epoch: 88 | loss: 0.1465590
	speed: 0.8396s/iter; left time: 1444.9960s
Epoch: 88 cost time: 53.20462989807129
Epoch: 88, Steps: 140 | Train Loss: 0.1429161 Vali Loss: 0.1214345 Test Loss: 0.1421016
EarlyStopping counter: 8 out of 20
Updating learning rate to 5.766650946003179e-06
	iters: 100, epoch: 89 | loss: 0.1353218
	speed: 0.9297s/iter; left time: 1469.9276s
Epoch: 89 cost time: 56.11188745498657
Epoch: 89, Steps: 140 | Train Loss: 0.1429065 Vali Loss: 0.1217715 Test Loss: 0.1421013
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.47831839870302e-06
	iters: 100, epoch: 90 | loss: 0.1277456
	speed: 0.8418s/iter; left time: 1212.9788s
Epoch: 90 cost time: 52.97930312156677
Epoch: 90, Steps: 140 | Train Loss: 0.1428793 Vali Loss: 0.1216273 Test Loss: 0.1421011
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.204402478767869e-06
	iters: 100, epoch: 91 | loss: 0.1418891
	speed: 0.8748s/iter; left time: 1138.1494s
Epoch: 91 cost time: 51.2499897480011
Epoch: 91, Steps: 140 | Train Loss: 0.1429284 Vali Loss: 0.1220410 Test Loss: 0.1421005
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.944182354829475e-06
	iters: 100, epoch: 92 | loss: 0.1439448
	speed: 0.8538s/iter; left time: 991.2659s
Epoch: 92 cost time: 53.84609389305115
Epoch: 92, Steps: 140 | Train Loss: 0.1429328 Vali Loss: 0.1217826 Test Loss: 0.1421004
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.696973237088e-06
	iters: 100, epoch: 93 | loss: 0.1523452
	speed: 0.8811s/iter; left time: 899.6425s
Epoch: 93 cost time: 54.675520181655884
Epoch: 93, Steps: 140 | Train Loss: 0.1429433 Vali Loss: 0.1218205 Test Loss: 0.1420984
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.462124575233601e-06
	iters: 100, epoch: 94 | loss: 0.1397047
	speed: 0.8635s/iter; left time: 760.7133s
Epoch: 94 cost time: 50.46596813201904
Epoch: 94, Steps: 140 | Train Loss: 0.1429324 Vali Loss: 0.1217276 Test Loss: 0.1420995
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.239018346471921e-06
	iters: 100, epoch: 95 | loss: 0.1387980
	speed: 0.8302s/iter; left time: 615.1494s
Epoch: 95 cost time: 52.5220742225647
Epoch: 95, Steps: 140 | Train Loss: 0.1429131 Vali Loss: 0.1217500 Test Loss: 0.1421002
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.027067429148324e-06
	iters: 100, epoch: 96 | loss: 0.1452547
	speed: 0.9598s/iter; left time: 576.8151s
Epoch: 96 cost time: 58.040605306625366
Epoch: 96, Steps: 140 | Train Loss: 0.1429009 Vali Loss: 0.1215809 Test Loss: 0.1420999
EarlyStopping counter: 16 out of 20
Updating learning rate to 3.825714057690908e-06
	iters: 100, epoch: 97 | loss: 0.1357173
	speed: 0.8539s/iter; left time: 393.6450s
Epoch: 97 cost time: 53.929027795791626
Epoch: 97, Steps: 140 | Train Loss: 0.1429376 Vali Loss: 0.1217659 Test Loss: 0.1420995
EarlyStopping counter: 17 out of 20
Updating learning rate to 3.6344283548063623e-06
	iters: 100, epoch: 98 | loss: 0.1421363
	speed: 0.8424s/iter; left time: 270.4254s
Epoch: 98 cost time: 51.61885666847229
Epoch: 98, Steps: 140 | Train Loss: 0.1429277 Vali Loss: 0.1215078 Test Loss: 0.1420994
EarlyStopping counter: 18 out of 20
Updating learning rate to 3.452706937066044e-06
	iters: 100, epoch: 99 | loss: 0.1373347
	speed: 0.9350s/iter; left time: 169.2416s
Epoch: 99 cost time: 58.66962671279907
Epoch: 99, Steps: 140 | Train Loss: 0.1429132 Vali Loss: 0.1216179 Test Loss: 0.1420991
EarlyStopping counter: 19 out of 20
Updating learning rate to 3.2800715902127414e-06
	iters: 100, epoch: 100 | loss: 0.1422770
	speed: 0.8956s/iter; left time: 36.7204s
Epoch: 100 cost time: 55.42982077598572
Epoch: 100, Steps: 140 | Train Loss: 0.1429220 Vali Loss: 0.1214156 Test Loss: 0.1420993
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_360_j96_H8_FITS_custom_ftM_sl360_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.14180755615234375, mae:0.23916983604431152, rse:0.37427735328674316, corr:[0.46557987 0.46774065 0.46935374 0.46947724 0.47024095 0.47003523
 0.47020498 0.47016352 0.46979585 0.46979675 0.4695386  0.4694258
 0.4693632  0.4692032  0.46925592 0.46918967 0.4691222  0.46914536
 0.46904707 0.46898732 0.46897867 0.46896654 0.4689661  0.4691386
 0.4692421  0.46922788 0.4692846  0.46920684 0.46903682 0.4690194
 0.46881977 0.46869    0.46869224 0.46854886 0.46849236 0.46845683
 0.46836308 0.4683795  0.4683239  0.46824202 0.46828428 0.46824107
 0.4681538  0.46806085 0.46793175 0.46787086 0.46787754 0.46802035
 0.46809924 0.46817225 0.46820316 0.46812132 0.46810344 0.4680065
 0.46791178 0.46791595 0.46783042 0.4677972  0.4677639  0.46764407
 0.46765777 0.4676198  0.4675457  0.46759585 0.4675417  0.46751052
 0.46750972 0.46726745 0.46709695 0.4670523  0.46700767 0.4671247
 0.46719912 0.46721384 0.4672284  0.46721277 0.46711665 0.46705577
 0.4670524  0.46696192 0.46691272 0.4668671  0.4667316  0.4667935
 0.46675128 0.46667346 0.46684015 0.4666781  0.46664613 0.46679723
 0.46648264 0.46647933 0.46639374 0.4664704  0.46674728 0.46697652]
