Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j96_H10', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4759633920.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1985007
	speed: 0.7587s/iter; left time: 10319.5865s
Epoch: 1 cost time: 103.54213881492615
Epoch: 1, Steps: 137 | Train Loss: 0.3770186 Vali Loss: 0.1327663 Test Loss: 0.1600283
Validation loss decreased (inf --> 0.132766).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1456995
	speed: 1.5853s/iter; left time: 21344.3111s
Epoch: 2 cost time: 94.88629364967346
Epoch: 2, Steps: 137 | Train Loss: 0.1445843 Vali Loss: 0.1161987 Test Loss: 0.1386164
Validation loss decreased (0.132766 --> 0.116199).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1351635
	speed: 1.5726s/iter; left time: 20957.7314s
Epoch: 3 cost time: 96.97742938995361
Epoch: 3, Steps: 137 | Train Loss: 0.1383515 Vali Loss: 0.1151015 Test Loss: 0.1374330
Validation loss decreased (0.116199 --> 0.115101).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1487771
	speed: 1.4994s/iter; left time: 19776.5021s
Epoch: 4 cost time: 93.09426617622375
Epoch: 4, Steps: 137 | Train Loss: 0.1373052 Vali Loss: 0.1145087 Test Loss: 0.1367022
Validation loss decreased (0.115101 --> 0.114509).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1374144
	speed: 1.5525s/iter; left time: 20264.7975s
Epoch: 5 cost time: 100.27245426177979
Epoch: 5, Steps: 137 | Train Loss: 0.1366262 Vali Loss: 0.1143358 Test Loss: 0.1363820
Validation loss decreased (0.114509 --> 0.114336).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1362018
	speed: 1.5815s/iter; left time: 20426.0975s
Epoch: 6 cost time: 95.06055450439453
Epoch: 6, Steps: 137 | Train Loss: 0.1362308 Vali Loss: 0.1138643 Test Loss: 0.1360988
Validation loss decreased (0.114336 --> 0.113864).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1351200
	speed: 1.5441s/iter; left time: 19732.4335s
Epoch: 7 cost time: 94.51674962043762
Epoch: 7, Steps: 137 | Train Loss: 0.1359862 Vali Loss: 0.1136294 Test Loss: 0.1359229
Validation loss decreased (0.113864 --> 0.113629).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1309020
	speed: 1.5893s/iter; left time: 20092.2036s
Epoch: 8 cost time: 95.86861562728882
Epoch: 8, Steps: 137 | Train Loss: 0.1357399 Vali Loss: 0.1137724 Test Loss: 0.1357613
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1306471
	speed: 1.6139s/iter; left time: 20181.2323s
Epoch: 9 cost time: 97.78017711639404
Epoch: 9, Steps: 137 | Train Loss: 0.1355786 Vali Loss: 0.1135170 Test Loss: 0.1356185
Validation loss decreased (0.113629 --> 0.113517).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1507436
	speed: 1.5264s/iter; left time: 18878.9810s
Epoch: 10 cost time: 94.95886611938477
Epoch: 10, Steps: 137 | Train Loss: 0.1355075 Vali Loss: 0.1134329 Test Loss: 0.1355398
Validation loss decreased (0.113517 --> 0.113433).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1397313
	speed: 1.5107s/iter; left time: 18476.7825s
Epoch: 11 cost time: 89.77263355255127
Epoch: 11, Steps: 137 | Train Loss: 0.1353539 Vali Loss: 0.1134968 Test Loss: 0.1355561
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1280901
	speed: 1.4799s/iter; left time: 17898.3602s
Epoch: 12 cost time: 93.09240388870239
Epoch: 12, Steps: 137 | Train Loss: 0.1352295 Vali Loss: 0.1133244 Test Loss: 0.1354856
Validation loss decreased (0.113433 --> 0.113324).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1516973
	speed: 1.3987s/iter; left time: 16724.6270s
Epoch: 13 cost time: 83.09958052635193
Epoch: 13, Steps: 137 | Train Loss: 0.1352315 Vali Loss: 0.1134502 Test Loss: 0.1354703
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1402299
	speed: 1.4747s/iter; left time: 17431.0451s
Epoch: 14 cost time: 89.47033309936523
Epoch: 14, Steps: 137 | Train Loss: 0.1351392 Vali Loss: 0.1133948 Test Loss: 0.1354177
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1381893
	speed: 1.4383s/iter; left time: 16803.6867s
Epoch: 15 cost time: 88.98506903648376
Epoch: 15, Steps: 137 | Train Loss: 0.1351614 Vali Loss: 0.1132995 Test Loss: 0.1354347
Validation loss decreased (0.113324 --> 0.113299).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1310732
	speed: 1.4601s/iter; left time: 16858.1780s
Epoch: 16 cost time: 85.78221273422241
Epoch: 16, Steps: 137 | Train Loss: 0.1350935 Vali Loss: 0.1132859 Test Loss: 0.1354033
Validation loss decreased (0.113299 --> 0.113286).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1294549
	speed: 1.3920s/iter; left time: 15881.4754s
Epoch: 17 cost time: 88.49158358573914
Epoch: 17, Steps: 137 | Train Loss: 0.1350743 Vali Loss: 0.1133021 Test Loss: 0.1353392
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1322082
	speed: 1.4759s/iter; left time: 16636.2666s
Epoch: 18 cost time: 94.4783263206482
Epoch: 18, Steps: 137 | Train Loss: 0.1350273 Vali Loss: 0.1133546 Test Loss: 0.1352893
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1274202
	speed: 1.4984s/iter; left time: 16685.1934s
Epoch: 19 cost time: 90.36659336090088
Epoch: 19, Steps: 137 | Train Loss: 0.1350239 Vali Loss: 0.1129906 Test Loss: 0.1352544
Validation loss decreased (0.113286 --> 0.112991).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1298851
	speed: 1.5502s/iter; left time: 17049.2366s
Epoch: 20 cost time: 97.63045835494995
Epoch: 20, Steps: 137 | Train Loss: 0.1349475 Vali Loss: 0.1133264 Test Loss: 0.1352899
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1284230
	speed: 1.4009s/iter; left time: 15215.1634s
Epoch: 21 cost time: 86.18762397766113
Epoch: 21, Steps: 137 | Train Loss: 0.1349352 Vali Loss: 0.1131542 Test Loss: 0.1352304
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1473276
	speed: 1.4292s/iter; left time: 15326.4891s
Epoch: 22 cost time: 89.29706501960754
Epoch: 22, Steps: 137 | Train Loss: 0.1348841 Vali Loss: 0.1132479 Test Loss: 0.1353127
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1316876
	speed: 1.5147s/iter; left time: 16036.1003s
Epoch: 23 cost time: 88.81616449356079
Epoch: 23, Steps: 137 | Train Loss: 0.1349235 Vali Loss: 0.1131020 Test Loss: 0.1352080
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1449639
	speed: 1.4904s/iter; left time: 15574.4959s
Epoch: 24 cost time: 89.96400165557861
Epoch: 24, Steps: 137 | Train Loss: 0.1349133 Vali Loss: 0.1132889 Test Loss: 0.1351598
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1326907
	speed: 1.5265s/iter; left time: 15743.0913s
Epoch: 25 cost time: 93.3959412574768
Epoch: 25, Steps: 137 | Train Loss: 0.1348724 Vali Loss: 0.1131097 Test Loss: 0.1351765
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1423797
	speed: 1.4337s/iter; left time: 14589.5319s
Epoch: 26 cost time: 86.40051341056824
Epoch: 26, Steps: 137 | Train Loss: 0.1348783 Vali Loss: 0.1133472 Test Loss: 0.1351676
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1442695
	speed: 1.2943s/iter; left time: 12993.4977s
Epoch: 27 cost time: 77.9706757068634
Epoch: 27, Steps: 137 | Train Loss: 0.1348260 Vali Loss: 0.1133300 Test Loss: 0.1351896
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1330096
	speed: 1.2660s/iter; left time: 12535.7984s
Epoch: 28 cost time: 82.21446704864502
Epoch: 28, Steps: 137 | Train Loss: 0.1348509 Vali Loss: 0.1131230 Test Loss: 0.1351966
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1481935
	speed: 1.2760s/iter; left time: 12460.3445s
Epoch: 29 cost time: 80.2329683303833
Epoch: 29, Steps: 137 | Train Loss: 0.1348469 Vali Loss: 0.1130232 Test Loss: 0.1351646
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1373800
	speed: 1.3135s/iter; left time: 12646.0208s
Epoch: 30 cost time: 77.26890444755554
Epoch: 30, Steps: 137 | Train Loss: 0.1348371 Vali Loss: 0.1132278 Test Loss: 0.1351738
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1327704
	speed: 1.3075s/iter; left time: 12409.2118s
Epoch: 31 cost time: 82.10491466522217
Epoch: 31, Steps: 137 | Train Loss: 0.1347737 Vali Loss: 0.1127511 Test Loss: 0.1351399
Validation loss decreased (0.112991 --> 0.112751).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1328239
	speed: 1.3312s/iter; left time: 12452.2522s
Epoch: 32 cost time: 79.94309258460999
Epoch: 32, Steps: 137 | Train Loss: 0.1346884 Vali Loss: 0.1133202 Test Loss: 0.1351223
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1303788
	speed: 1.2899s/iter; left time: 11889.2179s
Epoch: 33 cost time: 80.70267653465271
Epoch: 33, Steps: 137 | Train Loss: 0.1347901 Vali Loss: 0.1129942 Test Loss: 0.1351035
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1297185
	speed: 1.2887s/iter; left time: 11701.7447s
Epoch: 34 cost time: 78.79421925544739
Epoch: 34, Steps: 137 | Train Loss: 0.1347620 Vali Loss: 0.1130395 Test Loss: 0.1351349
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1408518
	speed: 1.2760s/iter; left time: 11411.6031s
Epoch: 35 cost time: 79.60162425041199
Epoch: 35, Steps: 137 | Train Loss: 0.1348125 Vali Loss: 0.1128474 Test Loss: 0.1351682
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1286821
	speed: 1.3192s/iter; left time: 11616.9969s
Epoch: 36 cost time: 81.32628107070923
Epoch: 36, Steps: 137 | Train Loss: 0.1347645 Vali Loss: 0.1128791 Test Loss: 0.1351051
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1429150
	speed: 1.2808s/iter; left time: 11103.3155s
Epoch: 37 cost time: 81.10672378540039
Epoch: 37, Steps: 137 | Train Loss: 0.1347558 Vali Loss: 0.1130879 Test Loss: 0.1351113
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1317965
	speed: 1.3020s/iter; left time: 11108.5646s
Epoch: 38 cost time: 79.60673785209656
Epoch: 38, Steps: 137 | Train Loss: 0.1347509 Vali Loss: 0.1133033 Test Loss: 0.1351059
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1474191
	speed: 1.2401s/iter; left time: 10410.5198s
Epoch: 39 cost time: 75.51907205581665
Epoch: 39, Steps: 137 | Train Loss: 0.1347347 Vali Loss: 0.1131204 Test Loss: 0.1350928
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1359100
	speed: 1.2828s/iter; left time: 10593.3431s
Epoch: 40 cost time: 76.52582383155823
Epoch: 40, Steps: 137 | Train Loss: 0.1347256 Vali Loss: 0.1130030 Test Loss: 0.1351015
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1302521
	speed: 1.3368s/iter; left time: 10856.4131s
Epoch: 41 cost time: 83.33194136619568
Epoch: 41, Steps: 137 | Train Loss: 0.1347454 Vali Loss: 0.1134203 Test Loss: 0.1350676
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1462991
	speed: 1.2934s/iter; left time: 10326.7256s
Epoch: 42 cost time: 81.40820813179016
Epoch: 42, Steps: 137 | Train Loss: 0.1347566 Vali Loss: 0.1130167 Test Loss: 0.1350693
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1360217
	speed: 1.2831s/iter; left time: 10068.6813s
Epoch: 43 cost time: 79.55462980270386
Epoch: 43, Steps: 137 | Train Loss: 0.1347275 Vali Loss: 0.1130549 Test Loss: 0.1350809
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1219955
	speed: 1.2737s/iter; left time: 9820.1440s
Epoch: 44 cost time: 76.73030877113342
Epoch: 44, Steps: 137 | Train Loss: 0.1346641 Vali Loss: 0.1131876 Test Loss: 0.1350825
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1331457
	speed: 1.2997s/iter; left time: 9842.9823s
Epoch: 45 cost time: 84.07993912696838
Epoch: 45, Steps: 137 | Train Loss: 0.1347317 Vali Loss: 0.1131436 Test Loss: 0.1350934
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1285827
	speed: 1.3980s/iter; left time: 10395.3030s
Epoch: 46 cost time: 80.98756694793701
Epoch: 46, Steps: 137 | Train Loss: 0.1347057 Vali Loss: 0.1129501 Test Loss: 0.1350575
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1489872
	speed: 1.2136s/iter; left time: 8858.0876s
Epoch: 47 cost time: 79.13412046432495
Epoch: 47, Steps: 137 | Train Loss: 0.1347011 Vali Loss: 0.1131328 Test Loss: 0.1350808
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1427749
	speed: 1.2771s/iter; left time: 9146.5465s
Epoch: 48 cost time: 78.0040955543518
Epoch: 48, Steps: 137 | Train Loss: 0.1346515 Vali Loss: 0.1130737 Test Loss: 0.1350566
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1392865
	speed: 1.4491s/iter; left time: 10179.6995s
Epoch: 49 cost time: 89.02634453773499
Epoch: 49, Steps: 137 | Train Loss: 0.1346800 Vali Loss: 0.1129576 Test Loss: 0.1350621
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1314654
	speed: 1.2852s/iter; left time: 8852.6512s
Epoch: 50 cost time: 81.54108428955078
Epoch: 50, Steps: 137 | Train Loss: 0.1346891 Vali Loss: 0.1130629 Test Loss: 0.1350484
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1342334
	speed: 1.2979s/iter; left time: 8762.3546s
Epoch: 51 cost time: 77.20097279548645
Epoch: 51, Steps: 137 | Train Loss: 0.1346803 Vali Loss: 0.1128977 Test Loss: 0.1350630
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.134548157453537, mae:0.2312832474708557, rse:0.36457154154777527, corr:[0.46604568 0.4687733  0.46972594 0.47078112 0.4707722  0.47130817
 0.4714894  0.4713908  0.47139773 0.47118372 0.4711466  0.47089422
 0.47090632 0.47082534 0.4707109  0.4706087  0.47057983 0.47059757
 0.4705989  0.4706024  0.47059685 0.47058764 0.47074568 0.47084406
 0.4709615  0.47114474 0.4712064  0.47114673 0.47096258 0.47099188
 0.4708241  0.47075906 0.4707293  0.4705775  0.47053042 0.47046438
 0.4704281  0.4703228  0.4702536  0.4702491  0.4702752  0.47035375
 0.4702948  0.4702141  0.47018754 0.47008136 0.47015044 0.47022873
 0.47039387 0.4705563  0.47051492 0.47056472 0.47038072 0.4702562
 0.47026008 0.4701074  0.47019708 0.47013527 0.4700333  0.47000736
 0.46986797 0.46990713 0.4698744  0.4698744  0.46983236 0.4698716
 0.46991748 0.46960694 0.46951172 0.46938932 0.46935663 0.46943218
 0.4694677  0.46953475 0.469397   0.46939224 0.4692706  0.4691593
 0.46923202 0.46900713 0.46902043 0.46898425 0.46885327 0.46907103
 0.46882427 0.4689739  0.46885163 0.4688447  0.46889323 0.46861884
 0.46893162 0.46832865 0.4687175  0.4685924  0.46927917 0.4695159 ]
