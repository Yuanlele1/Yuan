Args in experiment:
Namespace(H_order=2, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=72, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H2_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=72, out_features=81, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  5225472.0
params:  5913.0
Trainable parameters:  5913
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 4.1210572719573975
Epoch: 1, Steps: 61 | Train Loss: 0.5923069 Vali Loss: 1.0312177 Test Loss: 0.5287036
Validation loss decreased (inf --> 1.031218).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 3.9571805000305176
Epoch: 2, Steps: 61 | Train Loss: 0.4195420 Vali Loss: 0.8615518 Test Loss: 0.4354880
Validation loss decreased (1.031218 --> 0.861552).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 3.8154399394989014
Epoch: 3, Steps: 61 | Train Loss: 0.3806135 Vali Loss: 0.8023520 Test Loss: 0.4131212
Validation loss decreased (0.861552 --> 0.802352).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 4.061334609985352
Epoch: 4, Steps: 61 | Train Loss: 0.3683879 Vali Loss: 0.7762166 Test Loss: 0.4080726
Validation loss decreased (0.802352 --> 0.776217).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 3.978468894958496
Epoch: 5, Steps: 61 | Train Loss: 0.3628499 Vali Loss: 0.7623777 Test Loss: 0.4062604
Validation loss decreased (0.776217 --> 0.762378).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 4.051591396331787
Epoch: 6, Steps: 61 | Train Loss: 0.3600029 Vali Loss: 0.7583331 Test Loss: 0.4052355
Validation loss decreased (0.762378 --> 0.758333).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 3.9762215614318848
Epoch: 7, Steps: 61 | Train Loss: 0.3577498 Vali Loss: 0.7488178 Test Loss: 0.4048291
Validation loss decreased (0.758333 --> 0.748818).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 3.9485270977020264
Epoch: 8, Steps: 61 | Train Loss: 0.3557765 Vali Loss: 0.7455146 Test Loss: 0.4043787
Validation loss decreased (0.748818 --> 0.745515).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 3.87245512008667
Epoch: 9, Steps: 61 | Train Loss: 0.3544297 Vali Loss: 0.7339069 Test Loss: 0.4039030
Validation loss decreased (0.745515 --> 0.733907).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 3.9817843437194824
Epoch: 10, Steps: 61 | Train Loss: 0.3532242 Vali Loss: 0.7340448 Test Loss: 0.4034832
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 3.902714967727661
Epoch: 11, Steps: 61 | Train Loss: 0.3522262 Vali Loss: 0.7320036 Test Loss: 0.4033211
Validation loss decreased (0.733907 --> 0.732004).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 4.100648403167725
Epoch: 12, Steps: 61 | Train Loss: 0.3519861 Vali Loss: 0.7279074 Test Loss: 0.4034676
Validation loss decreased (0.732004 --> 0.727907).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 3.937952995300293
Epoch: 13, Steps: 61 | Train Loss: 0.3512890 Vali Loss: 0.7237918 Test Loss: 0.4031903
Validation loss decreased (0.727907 --> 0.723792).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 3.9240143299102783
Epoch: 14, Steps: 61 | Train Loss: 0.3507197 Vali Loss: 0.7264392 Test Loss: 0.4033329
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 3.953622817993164
Epoch: 15, Steps: 61 | Train Loss: 0.3502336 Vali Loss: 0.7245225 Test Loss: 0.4029312
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 4.0666184425354
Epoch: 16, Steps: 61 | Train Loss: 0.3499589 Vali Loss: 0.7258040 Test Loss: 0.4032226
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 4.045612573623657
Epoch: 17, Steps: 61 | Train Loss: 0.3495933 Vali Loss: 0.7205745 Test Loss: 0.4030858
Validation loss decreased (0.723792 --> 0.720574).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 3.8945701122283936
Epoch: 18, Steps: 61 | Train Loss: 0.3493081 Vali Loss: 0.7202805 Test Loss: 0.4028605
Validation loss decreased (0.720574 --> 0.720281).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 4.108378887176514
Epoch: 19, Steps: 61 | Train Loss: 0.3491697 Vali Loss: 0.7210795 Test Loss: 0.4030479
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 3.883848190307617
Epoch: 20, Steps: 61 | Train Loss: 0.3491318 Vali Loss: 0.7216223 Test Loss: 0.4030526
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 3.8942508697509766
Epoch: 21, Steps: 61 | Train Loss: 0.3488208 Vali Loss: 0.7191874 Test Loss: 0.4029875
Validation loss decreased (0.720281 --> 0.719187).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 3.9650557041168213
Epoch: 22, Steps: 61 | Train Loss: 0.3486124 Vali Loss: 0.7209253 Test Loss: 0.4031224
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 3.827486515045166
Epoch: 23, Steps: 61 | Train Loss: 0.3486905 Vali Loss: 0.7151899 Test Loss: 0.4031150
Validation loss decreased (0.719187 --> 0.715190).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 4.009292364120483
Epoch: 24, Steps: 61 | Train Loss: 0.3484010 Vali Loss: 0.7182835 Test Loss: 0.4030601
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 3.948212146759033
Epoch: 25, Steps: 61 | Train Loss: 0.3483779 Vali Loss: 0.7155777 Test Loss: 0.4030993
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 3.915954113006592
Epoch: 26, Steps: 61 | Train Loss: 0.3482245 Vali Loss: 0.7163299 Test Loss: 0.4032348
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 4.080159425735474
Epoch: 27, Steps: 61 | Train Loss: 0.3481152 Vali Loss: 0.7160516 Test Loss: 0.4033647
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 3.7980241775512695
Epoch: 28, Steps: 61 | Train Loss: 0.3480352 Vali Loss: 0.7157064 Test Loss: 0.4032013
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 3.902329921722412
Epoch: 29, Steps: 61 | Train Loss: 0.3478696 Vali Loss: 0.7179732 Test Loss: 0.4031909
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 3.9431560039520264
Epoch: 30, Steps: 61 | Train Loss: 0.3480194 Vali Loss: 0.7120100 Test Loss: 0.4031624
Validation loss decreased (0.715190 --> 0.712010).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 3.9164981842041016
Epoch: 31, Steps: 61 | Train Loss: 0.3479306 Vali Loss: 0.7142352 Test Loss: 0.4032550
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 3.8584656715393066
Epoch: 32, Steps: 61 | Train Loss: 0.3479144 Vali Loss: 0.7172024 Test Loss: 0.4030871
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 3.8886866569519043
Epoch: 33, Steps: 61 | Train Loss: 0.3477757 Vali Loss: 0.7174808 Test Loss: 0.4031814
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 3.9385688304901123
Epoch: 34, Steps: 61 | Train Loss: 0.3477462 Vali Loss: 0.7136311 Test Loss: 0.4033177
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 3.9600369930267334
Epoch: 35, Steps: 61 | Train Loss: 0.3475675 Vali Loss: 0.7154875 Test Loss: 0.4032113
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 4.116428375244141
Epoch: 36, Steps: 61 | Train Loss: 0.3476871 Vali Loss: 0.7141103 Test Loss: 0.4033194
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 3.824140787124634
Epoch: 37, Steps: 61 | Train Loss: 0.3476328 Vali Loss: 0.7178556 Test Loss: 0.4032579
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 3.9830589294433594
Epoch: 38, Steps: 61 | Train Loss: 0.3474558 Vali Loss: 0.7115428 Test Loss: 0.4032452
Validation loss decreased (0.712010 --> 0.711543).  Saving model ...
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 3.9774158000946045
Epoch: 39, Steps: 61 | Train Loss: 0.3475905 Vali Loss: 0.7148320 Test Loss: 0.4033145
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 3.88674259185791
Epoch: 40, Steps: 61 | Train Loss: 0.3475964 Vali Loss: 0.7151640 Test Loss: 0.4032125
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 3.917353391647339
Epoch: 41, Steps: 61 | Train Loss: 0.3476216 Vali Loss: 0.7178001 Test Loss: 0.4033464
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 3.9830052852630615
Epoch: 42, Steps: 61 | Train Loss: 0.3471601 Vali Loss: 0.7151636 Test Loss: 0.4032259
EarlyStopping counter: 4 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 3.8684051036834717
Epoch: 43, Steps: 61 | Train Loss: 0.3474452 Vali Loss: 0.7177330 Test Loss: 0.4032808
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 4.01745867729187
Epoch: 44, Steps: 61 | Train Loss: 0.3471817 Vali Loss: 0.7149737 Test Loss: 0.4032103
EarlyStopping counter: 6 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 3.9006259441375732
Epoch: 45, Steps: 61 | Train Loss: 0.3472333 Vali Loss: 0.7145268 Test Loss: 0.4032498
EarlyStopping counter: 7 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 3.944920063018799
Epoch: 46, Steps: 61 | Train Loss: 0.3471617 Vali Loss: 0.7138425 Test Loss: 0.4032429
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 4.0680553913116455
Epoch: 47, Steps: 61 | Train Loss: 0.3471488 Vali Loss: 0.7115735 Test Loss: 0.4032456
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 3.9128806591033936
Epoch: 48, Steps: 61 | Train Loss: 0.3470472 Vali Loss: 0.7153552 Test Loss: 0.4033267
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 4.021501064300537
Epoch: 49, Steps: 61 | Train Loss: 0.3471649 Vali Loss: 0.7185584 Test Loss: 0.4032481
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 3.882542610168457
Epoch: 50, Steps: 61 | Train Loss: 0.3471406 Vali Loss: 0.7129663 Test Loss: 0.4032370
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 3.9349253177642822
Epoch: 51, Steps: 61 | Train Loss: 0.3471230 Vali Loss: 0.7145381 Test Loss: 0.4032873
EarlyStopping counter: 13 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 4.214292526245117
Epoch: 52, Steps: 61 | Train Loss: 0.3471434 Vali Loss: 0.7112220 Test Loss: 0.4032517
Validation loss decreased (0.711543 --> 0.711222).  Saving model ...
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 3.921527862548828
Epoch: 53, Steps: 61 | Train Loss: 0.3469795 Vali Loss: 0.7176903 Test Loss: 0.4032483
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 3.936927318572998
Epoch: 54, Steps: 61 | Train Loss: 0.3472418 Vali Loss: 0.7184686 Test Loss: 0.4032753
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 3.955724000930786
Epoch: 55, Steps: 61 | Train Loss: 0.3472148 Vali Loss: 0.7119018 Test Loss: 0.4032972
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 3.941136360168457
Epoch: 56, Steps: 61 | Train Loss: 0.3471612 Vali Loss: 0.7172444 Test Loss: 0.4032441
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 3.8984289169311523
Epoch: 57, Steps: 61 | Train Loss: 0.3469157 Vali Loss: 0.7113559 Test Loss: 0.4032782
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 3.914621591567993
Epoch: 58, Steps: 61 | Train Loss: 0.3471693 Vali Loss: 0.7163453 Test Loss: 0.4033097
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 3.8950281143188477
Epoch: 59, Steps: 61 | Train Loss: 0.3471550 Vali Loss: 0.7159579 Test Loss: 0.4032540
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 4.059648752212524
Epoch: 60, Steps: 61 | Train Loss: 0.3470901 Vali Loss: 0.7161617 Test Loss: 0.4032807
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 3.9601194858551025
Epoch: 61, Steps: 61 | Train Loss: 0.3470650 Vali Loss: 0.7137923 Test Loss: 0.4032482
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 4.060712099075317
Epoch: 62, Steps: 61 | Train Loss: 0.3469534 Vali Loss: 0.7149575 Test Loss: 0.4032955
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 4.057459592819214
Epoch: 63, Steps: 61 | Train Loss: 0.3470597 Vali Loss: 0.7113654 Test Loss: 0.4032868
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 3.969794511795044
Epoch: 64, Steps: 61 | Train Loss: 0.3468841 Vali Loss: 0.7134562 Test Loss: 0.4033349
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 3.9384841918945312
Epoch: 65, Steps: 61 | Train Loss: 0.3471297 Vali Loss: 0.7116033 Test Loss: 0.4033121
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 3.8927578926086426
Epoch: 66, Steps: 61 | Train Loss: 0.3470040 Vali Loss: 0.7155936 Test Loss: 0.4032939
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 3.9454026222229004
Epoch: 67, Steps: 61 | Train Loss: 0.3469927 Vali Loss: 0.7130085 Test Loss: 0.4032952
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 3.936849355697632
Epoch: 68, Steps: 61 | Train Loss: 0.3470676 Vali Loss: 0.7159085 Test Loss: 0.4033424
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.6086129428065296e-05
Epoch: 69 cost time: 3.9875905513763428
Epoch: 69, Steps: 61 | Train Loss: 0.3470665 Vali Loss: 0.7160127 Test Loss: 0.4032998
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.5281822956662033e-05
Epoch: 70 cost time: 3.9583680629730225
Epoch: 70, Steps: 61 | Train Loss: 0.3470139 Vali Loss: 0.7154632 Test Loss: 0.4032848
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.451773180882893e-05
Epoch: 71 cost time: 4.036592245101929
Epoch: 71, Steps: 61 | Train Loss: 0.3471720 Vali Loss: 0.7121056 Test Loss: 0.4033052
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.3791845218387483e-05
Epoch: 72 cost time: 4.057736158370972
Epoch: 72, Steps: 61 | Train Loss: 0.3469874 Vali Loss: 0.7157665 Test Loss: 0.4032986
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H2_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.40296390652656555, mae:0.42502689361572266, rse:0.6029633283615112, corr:[0.26988152 0.27470812 0.27654597 0.27564943 0.27334216 0.27113158
 0.2696037  0.2687733  0.26829314 0.26815256 0.26823375 0.26831913
 0.268383   0.2684454  0.2685944  0.26874444 0.26865336 0.26837075
 0.26799121 0.26761416 0.26735651 0.26739883 0.26742655 0.26746175
 0.26736832 0.26715192 0.26675937 0.26620638 0.2656173  0.26511452
 0.264836   0.26466474 0.26462212 0.26463935 0.26456478 0.26446682
 0.26446286 0.26451355 0.26456696 0.26458254 0.26467457 0.26477805
 0.26487035 0.264969   0.26511893 0.26529488 0.26533887 0.26507056
 0.264177   0.26301962 0.2616398  0.2603111  0.25921246 0.25831878
 0.2577156  0.25741413 0.25722936 0.25714436 0.25695443 0.25668702
 0.2563687  0.2561192  0.2560265  0.2561868  0.2564528  0.25669983
 0.25687733 0.25672978 0.25629207 0.255739   0.25521302 0.25462738
 0.25406525 0.25353318 0.25299895 0.25263962 0.2523184  0.2518145
 0.25109524 0.25023165 0.24926488 0.24832916 0.24750794 0.2469369
 0.24684682 0.247065   0.24730925 0.24719696 0.24668524 0.2459441
 0.24512668 0.24448113 0.24438085 0.24494323 0.24523538 0.24290262]
