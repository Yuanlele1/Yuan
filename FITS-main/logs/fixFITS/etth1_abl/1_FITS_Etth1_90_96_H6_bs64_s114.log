Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_90_96_FITS_ETTh1_ftM_sl90_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8455
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2132480.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 1.0577092170715332
Epoch: 1, Steps: 66 | Train Loss: 0.6803468 Vali Loss: 1.1364337 Test Loss: 0.7089756
Validation loss decreased (inf --> 1.136434).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 0.9812335968017578
Epoch: 2, Steps: 66 | Train Loss: 0.5123058 Vali Loss: 0.9435024 Test Loss: 0.5443923
Validation loss decreased (1.136434 --> 0.943502).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 0.9879522323608398
Epoch: 3, Steps: 66 | Train Loss: 0.4459233 Vali Loss: 0.8574978 Test Loss: 0.4761787
Validation loss decreased (0.943502 --> 0.857498).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 0.96980881690979
Epoch: 4, Steps: 66 | Train Loss: 0.4153394 Vali Loss: 0.8086588 Test Loss: 0.4439114
Validation loss decreased (0.857498 --> 0.808659).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 0.9870445728302002
Epoch: 5, Steps: 66 | Train Loss: 0.3990875 Vali Loss: 0.7851706 Test Loss: 0.4267263
Validation loss decreased (0.808659 --> 0.785171).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 1.0230066776275635
Epoch: 6, Steps: 66 | Train Loss: 0.3893538 Vali Loss: 0.7704771 Test Loss: 0.4168428
Validation loss decreased (0.785171 --> 0.770477).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.0389151573181152
Epoch: 7, Steps: 66 | Train Loss: 0.3827108 Vali Loss: 0.7568223 Test Loss: 0.4105632
Validation loss decreased (0.770477 --> 0.756822).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 0.992915153503418
Epoch: 8, Steps: 66 | Train Loss: 0.3783829 Vali Loss: 0.7466577 Test Loss: 0.4062230
Validation loss decreased (0.756822 --> 0.746658).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 0.9599840641021729
Epoch: 9, Steps: 66 | Train Loss: 0.3750304 Vali Loss: 0.7409983 Test Loss: 0.4031543
Validation loss decreased (0.746658 --> 0.740998).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 0.970404863357544
Epoch: 10, Steps: 66 | Train Loss: 0.3723213 Vali Loss: 0.7383103 Test Loss: 0.4008243
Validation loss decreased (0.740998 --> 0.738310).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 1.0556178092956543
Epoch: 11, Steps: 66 | Train Loss: 0.3702469 Vali Loss: 0.7363287 Test Loss: 0.3989223
Validation loss decreased (0.738310 --> 0.736329).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 1.0382821559906006
Epoch: 12, Steps: 66 | Train Loss: 0.3684326 Vali Loss: 0.7290999 Test Loss: 0.3974061
Validation loss decreased (0.736329 --> 0.729100).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 1.554893970489502
Epoch: 13, Steps: 66 | Train Loss: 0.3671827 Vali Loss: 0.7243952 Test Loss: 0.3963027
Validation loss decreased (0.729100 --> 0.724395).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 1.1142151355743408
Epoch: 14, Steps: 66 | Train Loss: 0.3660134 Vali Loss: 0.7251667 Test Loss: 0.3951282
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.0206451416015625
Epoch: 15, Steps: 66 | Train Loss: 0.3649936 Vali Loss: 0.7247025 Test Loss: 0.3943250
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 1.0766875743865967
Epoch: 16, Steps: 66 | Train Loss: 0.3641725 Vali Loss: 0.7202654 Test Loss: 0.3935643
Validation loss decreased (0.724395 --> 0.720265).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 0.9898004531860352
Epoch: 17, Steps: 66 | Train Loss: 0.3633607 Vali Loss: 0.7194825 Test Loss: 0.3929449
Validation loss decreased (0.720265 --> 0.719483).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 0.9891159534454346
Epoch: 18, Steps: 66 | Train Loss: 0.3628122 Vali Loss: 0.7154326 Test Loss: 0.3923106
Validation loss decreased (0.719483 --> 0.715433).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 1.1496517658233643
Epoch: 19, Steps: 66 | Train Loss: 0.3622678 Vali Loss: 0.7182868 Test Loss: 0.3918413
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 0.9130344390869141
Epoch: 20, Steps: 66 | Train Loss: 0.3617146 Vali Loss: 0.7153418 Test Loss: 0.3913972
Validation loss decreased (0.715433 --> 0.715342).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 1.0215463638305664
Epoch: 21, Steps: 66 | Train Loss: 0.3612202 Vali Loss: 0.7160751 Test Loss: 0.3910514
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 0.9135692119598389
Epoch: 22, Steps: 66 | Train Loss: 0.3610059 Vali Loss: 0.7144328 Test Loss: 0.3906649
Validation loss decreased (0.715342 --> 0.714433).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 0.9395442008972168
Epoch: 23, Steps: 66 | Train Loss: 0.3606464 Vali Loss: 0.7107173 Test Loss: 0.3903476
Validation loss decreased (0.714433 --> 0.710717).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 0.8821697235107422
Epoch: 24, Steps: 66 | Train Loss: 0.3603240 Vali Loss: 0.7096831 Test Loss: 0.3900124
Validation loss decreased (0.710717 --> 0.709683).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.067735195159912
Epoch: 25, Steps: 66 | Train Loss: 0.3601231 Vali Loss: 0.7126514 Test Loss: 0.3897640
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 0.9208273887634277
Epoch: 26, Steps: 66 | Train Loss: 0.3598630 Vali Loss: 0.7155711 Test Loss: 0.3895686
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 1.0504577159881592
Epoch: 27, Steps: 66 | Train Loss: 0.3596605 Vali Loss: 0.7139666 Test Loss: 0.3893373
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 0.935776948928833
Epoch: 28, Steps: 66 | Train Loss: 0.3594921 Vali Loss: 0.7126710 Test Loss: 0.3891404
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 0.933847188949585
Epoch: 29, Steps: 66 | Train Loss: 0.3592259 Vali Loss: 0.7104920 Test Loss: 0.3889811
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 0.9551303386688232
Epoch: 30, Steps: 66 | Train Loss: 0.3590741 Vali Loss: 0.7140700 Test Loss: 0.3888477
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 2.1756255626678467
Epoch: 31, Steps: 66 | Train Loss: 0.3588459 Vali Loss: 0.7110494 Test Loss: 0.3886679
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 0.9887425899505615
Epoch: 32, Steps: 66 | Train Loss: 0.3588897 Vali Loss: 0.7108709 Test Loss: 0.3885212
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 0.907440185546875
Epoch: 33, Steps: 66 | Train Loss: 0.3587177 Vali Loss: 0.7093057 Test Loss: 0.3883981
Validation loss decreased (0.709683 --> 0.709306).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 1.1024982929229736
Epoch: 34, Steps: 66 | Train Loss: 0.3586515 Vali Loss: 0.7055631 Test Loss: 0.3883033
Validation loss decreased (0.709306 --> 0.705563).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 1.052968978881836
Epoch: 35, Steps: 66 | Train Loss: 0.3585701 Vali Loss: 0.7089158 Test Loss: 0.3881952
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 1.3185036182403564
Epoch: 36, Steps: 66 | Train Loss: 0.3584315 Vali Loss: 0.7091640 Test Loss: 0.3881248
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 1.2800705432891846
Epoch: 37, Steps: 66 | Train Loss: 0.3583204 Vali Loss: 0.7099860 Test Loss: 0.3880208
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 1.4194390773773193
Epoch: 38, Steps: 66 | Train Loss: 0.3582730 Vali Loss: 0.7062936 Test Loss: 0.3879545
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 1.261986255645752
Epoch: 39, Steps: 66 | Train Loss: 0.3582600 Vali Loss: 0.7094450 Test Loss: 0.3878920
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 1.3107991218566895
Epoch: 40, Steps: 66 | Train Loss: 0.3582399 Vali Loss: 0.7091619 Test Loss: 0.3878006
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 1.2462959289550781
Epoch: 41, Steps: 66 | Train Loss: 0.3581533 Vali Loss: 0.7071043 Test Loss: 0.3877376
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 1.2833969593048096
Epoch: 42, Steps: 66 | Train Loss: 0.3578570 Vali Loss: 0.7105853 Test Loss: 0.3876846
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 1.1420750617980957
Epoch: 43, Steps: 66 | Train Loss: 0.3579637 Vali Loss: 0.7053936 Test Loss: 0.3876178
Validation loss decreased (0.705563 --> 0.705394).  Saving model ...
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 1.1951477527618408
Epoch: 44, Steps: 66 | Train Loss: 0.3579741 Vali Loss: 0.7048134 Test Loss: 0.3875814
Validation loss decreased (0.705394 --> 0.704813).  Saving model ...
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 1.2770779132843018
Epoch: 45, Steps: 66 | Train Loss: 0.3578962 Vali Loss: 0.7050536 Test Loss: 0.3875409
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 1.210498571395874
Epoch: 46, Steps: 66 | Train Loss: 0.3578694 Vali Loss: 0.7029030 Test Loss: 0.3875080
Validation loss decreased (0.704813 --> 0.702903).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 1.1387131214141846
Epoch: 47, Steps: 66 | Train Loss: 0.3577885 Vali Loss: 0.7098317 Test Loss: 0.3874559
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 1.2126996517181396
Epoch: 48, Steps: 66 | Train Loss: 0.3577981 Vali Loss: 0.7003904 Test Loss: 0.3874180
Validation loss decreased (0.702903 --> 0.700390).  Saving model ...
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 1.1861679553985596
Epoch: 49, Steps: 66 | Train Loss: 0.3576311 Vali Loss: 0.7092878 Test Loss: 0.3873980
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 1.205782413482666
Epoch: 50, Steps: 66 | Train Loss: 0.3576230 Vali Loss: 0.7062209 Test Loss: 0.3873488
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 1.2497835159301758
Epoch: 51, Steps: 66 | Train Loss: 0.3576003 Vali Loss: 0.7079326 Test Loss: 0.3873322
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 1.213209867477417
Epoch: 52, Steps: 66 | Train Loss: 0.3576994 Vali Loss: 0.7035054 Test Loss: 0.3873012
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 1.2171452045440674
Epoch: 53, Steps: 66 | Train Loss: 0.3575763 Vali Loss: 0.7063080 Test Loss: 0.3872862
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 1.3921983242034912
Epoch: 54, Steps: 66 | Train Loss: 0.3575575 Vali Loss: 0.7064481 Test Loss: 0.3872512
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.298534908893597e-05
Epoch: 55 cost time: 1.3115134239196777
Epoch: 55, Steps: 66 | Train Loss: 0.3576247 Vali Loss: 0.7097681 Test Loss: 0.3872263
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.1336081634489166e-05
Epoch: 56 cost time: 1.2115306854248047
Epoch: 56, Steps: 66 | Train Loss: 0.3575926 Vali Loss: 0.7081369 Test Loss: 0.3872069
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.9769277552764706e-05
Epoch: 57 cost time: 1.351808786392212
Epoch: 57, Steps: 66 | Train Loss: 0.3575626 Vali Loss: 0.7054093 Test Loss: 0.3871865
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.8280813675126466e-05
Epoch: 58 cost time: 1.2965953350067139
Epoch: 58, Steps: 66 | Train Loss: 0.3576178 Vali Loss: 0.7088780 Test Loss: 0.3871600
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.6866772991370145e-05
Epoch: 59 cost time: 1.130528211593628
Epoch: 59, Steps: 66 | Train Loss: 0.3575455 Vali Loss: 0.7063864 Test Loss: 0.3871533
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.5523434341801633e-05
Epoch: 60 cost time: 1.138063907623291
Epoch: 60, Steps: 66 | Train Loss: 0.3575166 Vali Loss: 0.7026830 Test Loss: 0.3871398
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.4247262624711552e-05
Epoch: 61 cost time: 1.2173964977264404
Epoch: 61, Steps: 66 | Train Loss: 0.3575188 Vali Loss: 0.7039057 Test Loss: 0.3871157
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.3034899493475973e-05
Epoch: 62 cost time: 1.2722647190093994
Epoch: 62, Steps: 66 | Train Loss: 0.3574857 Vali Loss: 0.7072217 Test Loss: 0.3870948
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.1883154518802173e-05
Epoch: 63 cost time: 1.2110545635223389
Epoch: 63, Steps: 66 | Train Loss: 0.3574847 Vali Loss: 0.7085333 Test Loss: 0.3870878
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.0788996792862066e-05
Epoch: 64 cost time: 1.2750258445739746
Epoch: 64, Steps: 66 | Train Loss: 0.3574257 Vali Loss: 0.7077315 Test Loss: 0.3870745
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.974954695321896e-05
Epoch: 65 cost time: 1.1382050514221191
Epoch: 65, Steps: 66 | Train Loss: 0.3575184 Vali Loss: 0.7043737 Test Loss: 0.3870675
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.876206960555801e-05
Epoch: 66 cost time: 1.227393388748169
Epoch: 66, Steps: 66 | Train Loss: 0.3574590 Vali Loss: 0.7056886 Test Loss: 0.3870545
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.782396612528011e-05
Epoch: 67 cost time: 1.1692652702331543
Epoch: 67, Steps: 66 | Train Loss: 0.3573410 Vali Loss: 0.7041587 Test Loss: 0.3870430
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.6932767819016104e-05
Epoch: 68 cost time: 1.1876380443572998
Epoch: 68, Steps: 66 | Train Loss: 0.3573345 Vali Loss: 0.7053779 Test Loss: 0.3870361
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTh1_90_96_FITS_ETTh1_ftM_sl90_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3866788148880005, mae:0.3943330943584442, rse:0.5906538367271423, corr:[0.2712497  0.27268142 0.27201462 0.27255943 0.26961938 0.26880258
 0.26732218 0.26707882 0.2676765  0.26674762 0.26639354 0.26615858
 0.26540753 0.26540217 0.26553622 0.26516613 0.2655875  0.26598766
 0.26587296 0.2660476  0.26543453 0.26494175 0.26457217 0.2641901
 0.26248202 0.26158565 0.26192677 0.26210198 0.26213482 0.2621227
 0.26209033 0.26218876 0.26207933 0.2615881  0.26153514 0.26132983
 0.26119927 0.26121676 0.26142117 0.26136026 0.26172256 0.2623994
 0.26262096 0.2628766  0.2625998  0.2622616  0.2621541  0.261611
 0.2602626  0.25918052 0.25835523 0.25773558 0.2568161  0.25570795
 0.25549376 0.2553438  0.25536317 0.2553609  0.25522313 0.25527844
 0.25531954 0.25529316 0.25525713 0.25482607 0.25499314 0.25526476
 0.25540873 0.25565937 0.2551556  0.25479773 0.254585   0.25339848
 0.2516622  0.25079146 0.2501087  0.2499405  0.24959517 0.24939166
 0.24982418 0.24995439 0.25000015 0.24986221 0.24973825 0.24944156
 0.2494394  0.2491283  0.24907577 0.24904224 0.24854153 0.2484198
 0.24857669 0.24750535 0.24712168 0.24688967 0.24525301 0.24912171]
