Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_192_FITS_ETTm1_ftM_sl720_ll48_pl192_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=74, out_features=93, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  6166272.0
params:  6975.0
Trainable parameters:  6975
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3359495
	speed: 0.0342s/iter; left time: 893.3817s
	iters: 200, epoch: 1 | loss: 0.2715005
	speed: 0.0232s/iter; left time: 603.1206s
Epoch: 1 cost time: 7.237870454788208
Epoch: 1, Steps: 262 | Train Loss: 0.3499306 Vali Loss: 0.7236674 Test Loss: 0.4546140
Validation loss decreased (inf --> 0.723667).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2183961
	speed: 0.1414s/iter; left time: 3652.4633s
	iters: 200, epoch: 2 | loss: 0.1881279
	speed: 0.0350s/iter; left time: 901.5807s
Epoch: 2 cost time: 9.723087787628174
Epoch: 2, Steps: 262 | Train Loss: 0.2048323 Vali Loss: 0.6603331 Test Loss: 0.4318019
Validation loss decreased (0.723667 --> 0.660333).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1582774
	speed: 0.1338s/iter; left time: 3421.3371s
	iters: 200, epoch: 3 | loss: 0.1448164
	speed: 0.0314s/iter; left time: 800.9290s
Epoch: 3 cost time: 8.428881406784058
Epoch: 3, Steps: 262 | Train Loss: 0.1573609 Vali Loss: 0.6310939 Test Loss: 0.4162273
Validation loss decreased (0.660333 --> 0.631094).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1288325
	speed: 0.1546s/iter; left time: 3914.5844s
	iters: 200, epoch: 4 | loss: 0.1238893
	speed: 0.0418s/iter; left time: 1052.7500s
Epoch: 4 cost time: 11.608735084533691
Epoch: 4, Steps: 262 | Train Loss: 0.1306880 Vali Loss: 0.6088617 Test Loss: 0.4031026
Validation loss decreased (0.631094 --> 0.608862).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1155427
	speed: 0.1472s/iter; left time: 3687.5327s
	iters: 200, epoch: 5 | loss: 0.1153900
	speed: 0.0371s/iter; left time: 926.1770s
Epoch: 5 cost time: 9.978623867034912
Epoch: 5, Steps: 262 | Train Loss: 0.1139787 Vali Loss: 0.5916384 Test Loss: 0.3915335
Validation loss decreased (0.608862 --> 0.591638).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1039278
	speed: 0.1577s/iter; left time: 3910.5085s
	iters: 200, epoch: 6 | loss: 0.0974587
	speed: 0.0331s/iter; left time: 818.1937s
Epoch: 6 cost time: 10.771207571029663
Epoch: 6, Steps: 262 | Train Loss: 0.1031861 Vali Loss: 0.5791988 Test Loss: 0.3830087
Validation loss decreased (0.591638 --> 0.579199).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0951272
	speed: 0.1524s/iter; left time: 3739.1864s
	iters: 200, epoch: 7 | loss: 0.0905315
	speed: 0.0318s/iter; left time: 776.7497s
Epoch: 7 cost time: 8.659054517745972
Epoch: 7, Steps: 262 | Train Loss: 0.0961228 Vali Loss: 0.5690914 Test Loss: 0.3760852
Validation loss decreased (0.579199 --> 0.569091).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0925692
	speed: 0.1595s/iter; left time: 3870.0479s
	iters: 200, epoch: 8 | loss: 0.0976734
	speed: 0.0252s/iter; left time: 610.0936s
Epoch: 8 cost time: 7.202088117599487
Epoch: 8, Steps: 262 | Train Loss: 0.0914348 Vali Loss: 0.5603315 Test Loss: 0.3706778
Validation loss decreased (0.569091 --> 0.560332).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0851317
	speed: 0.1271s/iter; left time: 3051.8973s
	iters: 200, epoch: 9 | loss: 0.0966572
	speed: 0.0327s/iter; left time: 780.8805s
Epoch: 9 cost time: 8.674154996871948
Epoch: 9, Steps: 262 | Train Loss: 0.0882762 Vali Loss: 0.5550253 Test Loss: 0.3660542
Validation loss decreased (0.560332 --> 0.555025).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0872856
	speed: 0.1423s/iter; left time: 3378.8185s
	iters: 200, epoch: 10 | loss: 0.0936481
	speed: 0.0292s/iter; left time: 691.2775s
Epoch: 10 cost time: 8.429336786270142
Epoch: 10, Steps: 262 | Train Loss: 0.0861899 Vali Loss: 0.5519360 Test Loss: 0.3628318
Validation loss decreased (0.555025 --> 0.551936).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0833385
	speed: 0.1498s/iter; left time: 3517.1671s
	iters: 200, epoch: 11 | loss: 0.0845961
	speed: 0.0361s/iter; left time: 843.0807s
Epoch: 11 cost time: 9.633139610290527
Epoch: 11, Steps: 262 | Train Loss: 0.0846998 Vali Loss: 0.5458645 Test Loss: 0.3598054
Validation loss decreased (0.551936 --> 0.545864).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0841057
	speed: 0.1290s/iter; left time: 2994.6858s
	iters: 200, epoch: 12 | loss: 0.0858691
	speed: 0.0375s/iter; left time: 866.8441s
Epoch: 12 cost time: 9.78177523612976
Epoch: 12, Steps: 262 | Train Loss: 0.0837630 Vali Loss: 0.5434557 Test Loss: 0.3577791
Validation loss decreased (0.545864 --> 0.543456).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0806412
	speed: 0.1626s/iter; left time: 3732.9795s
	iters: 200, epoch: 13 | loss: 0.0808041
	speed: 0.0390s/iter; left time: 891.0951s
Epoch: 13 cost time: 10.263959407806396
Epoch: 13, Steps: 262 | Train Loss: 0.0830967 Vali Loss: 0.5416650 Test Loss: 0.3558403
Validation loss decreased (0.543456 --> 0.541665).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0802330
	speed: 0.1418s/iter; left time: 3217.7774s
	iters: 200, epoch: 14 | loss: 0.0815082
	speed: 0.0313s/iter; left time: 707.0406s
Epoch: 14 cost time: 9.034947872161865
Epoch: 14, Steps: 262 | Train Loss: 0.0826505 Vali Loss: 0.5412893 Test Loss: 0.3544588
Validation loss decreased (0.541665 --> 0.541289).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0822466
	speed: 0.1485s/iter; left time: 3330.3263s
	iters: 200, epoch: 15 | loss: 0.0822653
	speed: 0.0353s/iter; left time: 787.5149s
Epoch: 15 cost time: 10.11478567123413
Epoch: 15, Steps: 262 | Train Loss: 0.0823169 Vali Loss: 0.5407190 Test Loss: 0.3537026
Validation loss decreased (0.541289 --> 0.540719).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0885133
	speed: 0.1352s/iter; left time: 2998.5997s
	iters: 200, epoch: 16 | loss: 0.0916035
	speed: 0.0346s/iter; left time: 764.1154s
Epoch: 16 cost time: 9.107556581497192
Epoch: 16, Steps: 262 | Train Loss: 0.0820973 Vali Loss: 0.5377839 Test Loss: 0.3531450
Validation loss decreased (0.540719 --> 0.537784).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0791930
	speed: 0.1376s/iter; left time: 3014.8090s
	iters: 200, epoch: 17 | loss: 0.0854822
	speed: 0.0358s/iter; left time: 780.0758s
Epoch: 17 cost time: 10.063220500946045
Epoch: 17, Steps: 262 | Train Loss: 0.0819434 Vali Loss: 0.5383847 Test Loss: 0.3515786
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0812976
	speed: 0.1218s/iter; left time: 2636.6192s
	iters: 200, epoch: 18 | loss: 0.0855967
	speed: 0.0324s/iter; left time: 699.0151s
Epoch: 18 cost time: 8.904217004776001
Epoch: 18, Steps: 262 | Train Loss: 0.0818777 Vali Loss: 0.5368381 Test Loss: 0.3511008
Validation loss decreased (0.537784 --> 0.536838).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0832674
	speed: 0.1389s/iter; left time: 2970.3262s
	iters: 200, epoch: 19 | loss: 0.0777982
	speed: 0.0343s/iter; left time: 729.3235s
Epoch: 19 cost time: 9.825267553329468
Epoch: 19, Steps: 262 | Train Loss: 0.0818092 Vali Loss: 0.5374749 Test Loss: 0.3507293
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0811429
	speed: 0.1369s/iter; left time: 2890.8053s
	iters: 200, epoch: 20 | loss: 0.0784488
	speed: 0.0287s/iter; left time: 603.0533s
Epoch: 20 cost time: 7.7927610874176025
Epoch: 20, Steps: 262 | Train Loss: 0.0817421 Vali Loss: 0.5370365 Test Loss: 0.3496849
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0776032
	speed: 0.1177s/iter; left time: 2455.2765s
	iters: 200, epoch: 21 | loss: 0.0857980
	speed: 0.0304s/iter; left time: 630.6480s
Epoch: 21 cost time: 8.344361543655396
Epoch: 21, Steps: 262 | Train Loss: 0.0816983 Vali Loss: 0.5362384 Test Loss: 0.3494075
Validation loss decreased (0.536838 --> 0.536238).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0814722
	speed: 0.1359s/iter; left time: 2799.9460s
	iters: 200, epoch: 22 | loss: 0.0743578
	speed: 0.0272s/iter; left time: 557.8762s
Epoch: 22 cost time: 8.010948896408081
Epoch: 22, Steps: 262 | Train Loss: 0.0816853 Vali Loss: 0.5376791 Test Loss: 0.3494571
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0758433
	speed: 0.1520s/iter; left time: 3090.9646s
	iters: 200, epoch: 23 | loss: 0.0834476
	speed: 0.0340s/iter; left time: 688.6780s
Epoch: 23 cost time: 9.34114122390747
Epoch: 23, Steps: 262 | Train Loss: 0.0816912 Vali Loss: 0.5366313 Test Loss: 0.3492401
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0855666
	speed: 0.1432s/iter; left time: 2874.7345s
	iters: 200, epoch: 24 | loss: 0.0845968
	speed: 0.0307s/iter; left time: 613.2092s
Epoch: 24 cost time: 8.47824215888977
Epoch: 24, Steps: 262 | Train Loss: 0.0817031 Vali Loss: 0.5369911 Test Loss: 0.3488208
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0813897
	speed: 0.1415s/iter; left time: 2804.5052s
	iters: 200, epoch: 25 | loss: 0.0862937
	speed: 0.0399s/iter; left time: 785.8826s
Epoch: 25 cost time: 10.716614723205566
Epoch: 25, Steps: 262 | Train Loss: 0.0816704 Vali Loss: 0.5368137 Test Loss: 0.3487454
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0888960
	speed: 0.1405s/iter; left time: 2746.2446s
	iters: 200, epoch: 26 | loss: 0.0811547
	speed: 0.0297s/iter; left time: 577.8003s
Epoch: 26 cost time: 8.461827754974365
Epoch: 26, Steps: 262 | Train Loss: 0.0816569 Vali Loss: 0.5357246 Test Loss: 0.3485856
Validation loss decreased (0.536238 --> 0.535725).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0795124
	speed: 0.1377s/iter; left time: 2655.9814s
	iters: 200, epoch: 27 | loss: 0.0877393
	speed: 0.0326s/iter; left time: 626.2219s
Epoch: 27 cost time: 9.611761569976807
Epoch: 27, Steps: 262 | Train Loss: 0.0816800 Vali Loss: 0.5364087 Test Loss: 0.3484206
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0823902
	speed: 0.1253s/iter; left time: 2384.7050s
	iters: 200, epoch: 28 | loss: 0.0847806
	speed: 0.0415s/iter; left time: 786.0373s
Epoch: 28 cost time: 10.522821187973022
Epoch: 28, Steps: 262 | Train Loss: 0.0816765 Vali Loss: 0.5366361 Test Loss: 0.3483481
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0799202
	speed: 0.1427s/iter; left time: 2678.6876s
	iters: 200, epoch: 29 | loss: 0.0785429
	speed: 0.0335s/iter; left time: 625.9300s
Epoch: 29 cost time: 9.236645460128784
Epoch: 29, Steps: 262 | Train Loss: 0.0816680 Vali Loss: 0.5372651 Test Loss: 0.3484150
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0852576
	speed: 0.1319s/iter; left time: 2440.8000s
	iters: 200, epoch: 30 | loss: 0.0845141
	speed: 0.0242s/iter; left time: 445.3615s
Epoch: 30 cost time: 7.117729425430298
Epoch: 30, Steps: 262 | Train Loss: 0.0816787 Vali Loss: 0.5363451 Test Loss: 0.3484684
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0815405
	speed: 0.1241s/iter; left time: 2263.5338s
	iters: 200, epoch: 31 | loss: 0.0757847
	speed: 0.0282s/iter; left time: 511.5354s
Epoch: 31 cost time: 8.972448110580444
Epoch: 31, Steps: 262 | Train Loss: 0.0816288 Vali Loss: 0.5367262 Test Loss: 0.3481408
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0766885
	speed: 0.1415s/iter; left time: 2544.8946s
	iters: 200, epoch: 32 | loss: 0.0793535
	speed: 0.0294s/iter; left time: 526.2219s
Epoch: 32 cost time: 8.114143133163452
Epoch: 32, Steps: 262 | Train Loss: 0.0816499 Vali Loss: 0.5369222 Test Loss: 0.3482792
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0782648
	speed: 0.1283s/iter; left time: 2273.4756s
	iters: 200, epoch: 33 | loss: 0.0871507
	speed: 0.0335s/iter; left time: 590.1605s
Epoch: 33 cost time: 10.068812131881714
Epoch: 33, Steps: 262 | Train Loss: 0.0816561 Vali Loss: 0.5359192 Test Loss: 0.3485083
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0875240
	speed: 0.1597s/iter; left time: 2788.4090s
	iters: 200, epoch: 34 | loss: 0.0835828
	speed: 0.0337s/iter; left time: 585.1265s
Epoch: 34 cost time: 9.815082550048828
Epoch: 34, Steps: 262 | Train Loss: 0.0816728 Vali Loss: 0.5363408 Test Loss: 0.3483809
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0850860
	speed: 0.1390s/iter; left time: 2389.5734s
	iters: 200, epoch: 35 | loss: 0.0855168
	speed: 0.0332s/iter; left time: 567.1190s
Epoch: 35 cost time: 9.611165285110474
Epoch: 35, Steps: 262 | Train Loss: 0.0816768 Vali Loss: 0.5371416 Test Loss: 0.3482515
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0866616
	speed: 0.1248s/iter; left time: 2113.0908s
	iters: 200, epoch: 36 | loss: 0.0829314
	speed: 0.0270s/iter; left time: 454.7726s
Epoch: 36 cost time: 7.693424940109253
Epoch: 36, Steps: 262 | Train Loss: 0.0816636 Vali Loss: 0.5364103 Test Loss: 0.3485693
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0869184
	speed: 0.1396s/iter; left time: 2326.4637s
	iters: 200, epoch: 37 | loss: 0.0831698
	speed: 0.0341s/iter; left time: 564.4990s
Epoch: 37 cost time: 10.352200269699097
Epoch: 37, Steps: 262 | Train Loss: 0.0816247 Vali Loss: 0.5367677 Test Loss: 0.3485855
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0796951
	speed: 0.1481s/iter; left time: 2430.4100s
	iters: 200, epoch: 38 | loss: 0.0838176
	speed: 0.0273s/iter; left time: 445.9595s
Epoch: 38 cost time: 10.628866195678711
Epoch: 38, Steps: 262 | Train Loss: 0.0816396 Vali Loss: 0.5368808 Test Loss: 0.3482789
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0790499
	speed: 0.1649s/iter; left time: 2661.6634s
	iters: 200, epoch: 39 | loss: 0.0787124
	speed: 0.0310s/iter; left time: 497.4832s
Epoch: 39 cost time: 9.819568157196045
Epoch: 39, Steps: 262 | Train Loss: 0.0816359 Vali Loss: 0.5366363 Test Loss: 0.3482815
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0824092
	speed: 0.1464s/iter; left time: 2325.5275s
	iters: 200, epoch: 40 | loss: 0.0712247
	speed: 0.0260s/iter; left time: 410.3656s
Epoch: 40 cost time: 8.999448299407959
Epoch: 40, Steps: 262 | Train Loss: 0.0816613 Vali Loss: 0.5364044 Test Loss: 0.3484329
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0870054
	speed: 0.1472s/iter; left time: 2298.8278s
	iters: 200, epoch: 41 | loss: 0.0798797
	speed: 0.0362s/iter; left time: 562.6096s
Epoch: 41 cost time: 9.701958417892456
Epoch: 41, Steps: 262 | Train Loss: 0.0816483 Vali Loss: 0.5365285 Test Loss: 0.3482984
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0773324
	speed: 0.1389s/iter; left time: 2133.1729s
	iters: 200, epoch: 42 | loss: 0.0786800
	speed: 0.0362s/iter; left time: 552.7821s
Epoch: 42 cost time: 9.456779956817627
Epoch: 42, Steps: 262 | Train Loss: 0.0816052 Vali Loss: 0.5363627 Test Loss: 0.3484737
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0767442
	speed: 0.1560s/iter; left time: 2355.2069s
	iters: 200, epoch: 43 | loss: 0.0843099
	speed: 0.0309s/iter; left time: 463.6995s
Epoch: 43 cost time: 9.46970510482788
Epoch: 43, Steps: 262 | Train Loss: 0.0816584 Vali Loss: 0.5368500 Test Loss: 0.3483072
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0785251
	speed: 0.1270s/iter; left time: 1884.6876s
	iters: 200, epoch: 44 | loss: 0.0821291
	speed: 0.0308s/iter; left time: 454.1147s
Epoch: 44 cost time: 8.245586633682251
Epoch: 44, Steps: 262 | Train Loss: 0.0816372 Vali Loss: 0.5368261 Test Loss: 0.3485395
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0874655
	speed: 0.1293s/iter; left time: 1883.6005s
	iters: 200, epoch: 45 | loss: 0.0864826
	speed: 0.0256s/iter; left time: 370.3585s
Epoch: 45 cost time: 7.8767149448394775
Epoch: 45, Steps: 262 | Train Loss: 0.0816278 Vali Loss: 0.5370901 Test Loss: 0.3484009
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0834458
	speed: 0.1300s/iter; left time: 1859.8944s
	iters: 200, epoch: 46 | loss: 0.0851579
	speed: 0.0250s/iter; left time: 355.3903s
Epoch: 46 cost time: 9.01578688621521
Epoch: 46, Steps: 262 | Train Loss: 0.0816211 Vali Loss: 0.5363368 Test Loss: 0.3485455
EarlyStopping counter: 20 out of 20
Early stopping
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=74, out_features=93, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  6166272.0
params:  6975.0
Trainable parameters:  6975
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2789916
	speed: 0.0415s/iter; left time: 1082.8545s
	iters: 200, epoch: 1 | loss: 0.3146438
	speed: 0.0337s/iter; left time: 876.1854s
Epoch: 1 cost time: 9.986170053482056
Epoch: 1, Steps: 262 | Train Loss: 0.3022432 Vali Loss: 0.5208772 Test Loss: 0.3410227
Validation loss decreased (inf --> 0.520877).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2996513
	speed: 0.1365s/iter; left time: 3526.8024s
	iters: 200, epoch: 2 | loss: 0.2804408
	speed: 0.0264s/iter; left time: 680.7505s
Epoch: 2 cost time: 8.469363689422607
Epoch: 2, Steps: 262 | Train Loss: 0.3005571 Vali Loss: 0.5153509 Test Loss: 0.3404052
Validation loss decreased (0.520877 --> 0.515351).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3162452
	speed: 0.1227s/iter; left time: 3137.7613s
	iters: 200, epoch: 3 | loss: 0.3148549
	speed: 0.0280s/iter; left time: 713.0311s
Epoch: 3 cost time: 8.091603994369507
Epoch: 3, Steps: 262 | Train Loss: 0.2998631 Vali Loss: 0.5150578 Test Loss: 0.3404328
Validation loss decreased (0.515351 --> 0.515058).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3134552
	speed: 0.1422s/iter; left time: 3599.2072s
	iters: 200, epoch: 4 | loss: 0.2818124
	speed: 0.0313s/iter; left time: 790.3921s
Epoch: 4 cost time: 9.56504511833191
Epoch: 4, Steps: 262 | Train Loss: 0.2995080 Vali Loss: 0.5148650 Test Loss: 0.3399502
Validation loss decreased (0.515058 --> 0.514865).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3606529
	speed: 0.1379s/iter; left time: 3454.2364s
	iters: 200, epoch: 5 | loss: 0.3083436
	speed: 0.0322s/iter; left time: 803.2996s
Epoch: 5 cost time: 9.200985431671143
Epoch: 5, Steps: 262 | Train Loss: 0.2991823 Vali Loss: 0.5137485 Test Loss: 0.3400482
Validation loss decreased (0.514865 --> 0.513749).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2867727
	speed: 0.1364s/iter; left time: 3381.7161s
	iters: 200, epoch: 6 | loss: 0.3145558
	speed: 0.0273s/iter; left time: 673.5535s
Epoch: 6 cost time: 8.105942964553833
Epoch: 6, Steps: 262 | Train Loss: 0.2991494 Vali Loss: 0.5135053 Test Loss: 0.3402742
Validation loss decreased (0.513749 --> 0.513505).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2846913
	speed: 0.1443s/iter; left time: 3539.4141s
	iters: 200, epoch: 7 | loss: 0.3427559
	speed: 0.0346s/iter; left time: 845.0828s
Epoch: 7 cost time: 9.006453037261963
Epoch: 7, Steps: 262 | Train Loss: 0.2987855 Vali Loss: 0.5157462 Test Loss: 0.3398749
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3161445
	speed: 0.1363s/iter; left time: 3308.7508s
	iters: 200, epoch: 8 | loss: 0.3108980
	speed: 0.0322s/iter; left time: 777.9701s
Epoch: 8 cost time: 8.706096410751343
Epoch: 8, Steps: 262 | Train Loss: 0.2990209 Vali Loss: 0.5155043 Test Loss: 0.3390406
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3194007
	speed: 0.1396s/iter; left time: 3349.9011s
	iters: 200, epoch: 9 | loss: 0.3184125
	speed: 0.0310s/iter; left time: 739.9536s
Epoch: 9 cost time: 8.834080934524536
Epoch: 9, Steps: 262 | Train Loss: 0.2987399 Vali Loss: 0.5140415 Test Loss: 0.3392451
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3199117
	speed: 0.1272s/iter; left time: 3019.4420s
	iters: 200, epoch: 10 | loss: 0.2869456
	speed: 0.0310s/iter; left time: 733.5504s
Epoch: 10 cost time: 9.050516128540039
Epoch: 10, Steps: 262 | Train Loss: 0.2987346 Vali Loss: 0.5141907 Test Loss: 0.3393262
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3157490
	speed: 0.1404s/iter; left time: 3295.9217s
	iters: 200, epoch: 11 | loss: 0.2896968
	speed: 0.0321s/iter; left time: 750.0753s
Epoch: 11 cost time: 9.491646528244019
Epoch: 11, Steps: 262 | Train Loss: 0.2985994 Vali Loss: 0.5154592 Test Loss: 0.3386190
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3163446
	speed: 0.1452s/iter; left time: 3371.4009s
	iters: 200, epoch: 12 | loss: 0.2837790
	speed: 0.0350s/iter; left time: 808.2794s
Epoch: 12 cost time: 9.78806471824646
Epoch: 12, Steps: 262 | Train Loss: 0.2985726 Vali Loss: 0.5118380 Test Loss: 0.3396934
Validation loss decreased (0.513505 --> 0.511838).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2695292
	speed: 0.1569s/iter; left time: 3601.8652s
	iters: 200, epoch: 13 | loss: 0.2862483
	speed: 0.0383s/iter; left time: 875.2896s
Epoch: 13 cost time: 11.074216842651367
Epoch: 13, Steps: 262 | Train Loss: 0.2985338 Vali Loss: 0.5137519 Test Loss: 0.3397918
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3005731
	speed: 0.1358s/iter; left time: 3081.5998s
	iters: 200, epoch: 14 | loss: 0.3328089
	speed: 0.0300s/iter; left time: 677.0782s
Epoch: 14 cost time: 8.51310658454895
Epoch: 14, Steps: 262 | Train Loss: 0.2985095 Vali Loss: 0.5129975 Test Loss: 0.3395735
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2668620
	speed: 0.1305s/iter; left time: 2927.3893s
	iters: 200, epoch: 15 | loss: 0.3505375
	speed: 0.0392s/iter; left time: 875.8545s
Epoch: 15 cost time: 10.122774362564087
Epoch: 15, Steps: 262 | Train Loss: 0.2986197 Vali Loss: 0.5128260 Test Loss: 0.3395847
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2793657
	speed: 0.1227s/iter; left time: 2720.1885s
	iters: 200, epoch: 16 | loss: 0.2896678
	speed: 0.0360s/iter; left time: 794.4230s
Epoch: 16 cost time: 9.42115569114685
Epoch: 16, Steps: 262 | Train Loss: 0.2983788 Vali Loss: 0.5138840 Test Loss: 0.3394958
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3011618
	speed: 0.1459s/iter; left time: 3196.5178s
	iters: 200, epoch: 17 | loss: 0.2870466
	speed: 0.0338s/iter; left time: 736.4571s
Epoch: 17 cost time: 10.5750150680542
Epoch: 17, Steps: 262 | Train Loss: 0.2984270 Vali Loss: 0.5138872 Test Loss: 0.3395382
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2827790
	speed: 0.1360s/iter; left time: 2944.0791s
	iters: 200, epoch: 18 | loss: 0.2935124
	speed: 0.0350s/iter; left time: 753.6920s
Epoch: 18 cost time: 9.549819231033325
Epoch: 18, Steps: 262 | Train Loss: 0.2984576 Vali Loss: 0.5136413 Test Loss: 0.3393556
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2899221
	speed: 0.1497s/iter; left time: 3200.9046s
	iters: 200, epoch: 19 | loss: 0.3055667
	speed: 0.0308s/iter; left time: 655.5263s
Epoch: 19 cost time: 9.215754747390747
Epoch: 19, Steps: 262 | Train Loss: 0.2984605 Vali Loss: 0.5134764 Test Loss: 0.3395740
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2771718
	speed: 0.1438s/iter; left time: 3036.8155s
	iters: 200, epoch: 20 | loss: 0.3196874
	speed: 0.0399s/iter; left time: 839.5055s
Epoch: 20 cost time: 10.448229312896729
Epoch: 20, Steps: 262 | Train Loss: 0.2984507 Vali Loss: 0.5130972 Test Loss: 0.3394559
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3319233
	speed: 0.1401s/iter; left time: 2923.4155s
	iters: 200, epoch: 21 | loss: 0.2785231
	speed: 0.0295s/iter; left time: 611.6319s
Epoch: 21 cost time: 8.724507570266724
Epoch: 21, Steps: 262 | Train Loss: 0.2985698 Vali Loss: 0.5123730 Test Loss: 0.3392735
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3048358
	speed: 0.1354s/iter; left time: 2789.1588s
	iters: 200, epoch: 22 | loss: 0.3111638
	speed: 0.0264s/iter; left time: 540.6218s
Epoch: 22 cost time: 7.937697649002075
Epoch: 22, Steps: 262 | Train Loss: 0.2983977 Vali Loss: 0.5141168 Test Loss: 0.3395123
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3429020
	speed: 0.1284s/iter; left time: 2611.3801s
	iters: 200, epoch: 23 | loss: 0.3100679
	speed: 0.0269s/iter; left time: 543.3941s
Epoch: 23 cost time: 7.733608722686768
Epoch: 23, Steps: 262 | Train Loss: 0.2983174 Vali Loss: 0.5131725 Test Loss: 0.3395132
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2950363
	speed: 0.1407s/iter; left time: 2824.2197s
	iters: 200, epoch: 24 | loss: 0.2819839
	speed: 0.0328s/iter; left time: 656.0806s
Epoch: 24 cost time: 9.69253921508789
Epoch: 24, Steps: 262 | Train Loss: 0.2983491 Vali Loss: 0.5137653 Test Loss: 0.3395624
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2902493
	speed: 0.1496s/iter; left time: 2963.4081s
	iters: 200, epoch: 25 | loss: 0.2798802
	speed: 0.0374s/iter; left time: 736.7106s
Epoch: 25 cost time: 9.941983699798584
Epoch: 25, Steps: 262 | Train Loss: 0.2980821 Vali Loss: 0.5136858 Test Loss: 0.3394490
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2665143
	speed: 0.1254s/iter; left time: 2452.4126s
	iters: 200, epoch: 26 | loss: 0.3085034
	speed: 0.0343s/iter; left time: 666.5052s
Epoch: 26 cost time: 9.417654275894165
Epoch: 26, Steps: 262 | Train Loss: 0.2984039 Vali Loss: 0.5127566 Test Loss: 0.3395293
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2862872
	speed: 0.1395s/iter; left time: 2690.1655s
	iters: 200, epoch: 27 | loss: 0.2618086
	speed: 0.0309s/iter; left time: 592.0469s
Epoch: 27 cost time: 9.26141095161438
Epoch: 27, Steps: 262 | Train Loss: 0.2982875 Vali Loss: 0.5129402 Test Loss: 0.3395097
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3155823
	speed: 0.1359s/iter; left time: 2586.0793s
	iters: 200, epoch: 28 | loss: 0.2848535
	speed: 0.0350s/iter; left time: 663.0079s
Epoch: 28 cost time: 10.292580366134644
Epoch: 28, Steps: 262 | Train Loss: 0.2982737 Vali Loss: 0.5125648 Test Loss: 0.3393952
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2942701
	speed: 0.1398s/iter; left time: 2623.9041s
	iters: 200, epoch: 29 | loss: 0.3060475
	speed: 0.0257s/iter; left time: 479.3763s
Epoch: 29 cost time: 8.069386005401611
Epoch: 29, Steps: 262 | Train Loss: 0.2981287 Vali Loss: 0.5123026 Test Loss: 0.3395633
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2714967
	speed: 0.1414s/iter; left time: 2615.9310s
	iters: 200, epoch: 30 | loss: 0.2747741
	speed: 0.0260s/iter; left time: 479.0708s
Epoch: 30 cost time: 7.962384223937988
Epoch: 30, Steps: 262 | Train Loss: 0.2982434 Vali Loss: 0.5131736 Test Loss: 0.3394510
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2987253
	speed: 0.1333s/iter; left time: 2432.3272s
	iters: 200, epoch: 31 | loss: 0.3056612
	speed: 0.0267s/iter; left time: 484.2957s
Epoch: 31 cost time: 7.902987480163574
Epoch: 31, Steps: 262 | Train Loss: 0.2982387 Vali Loss: 0.5122280 Test Loss: 0.3393570
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2980954
	speed: 0.1425s/iter; left time: 2561.3089s
	iters: 200, epoch: 32 | loss: 0.3207596
	speed: 0.0352s/iter; left time: 629.1130s
Epoch: 32 cost time: 9.054210662841797
Epoch: 32, Steps: 262 | Train Loss: 0.2982309 Vali Loss: 0.5130144 Test Loss: 0.3393161
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_192_FITS_ETTm1_ftM_sl720_ll48_pl192_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.33964797854423523, mae:0.36932045221328735, rse:0.5547739267349243, corr:[0.5436258  0.55127597 0.55672187 0.55927604 0.5597978  0.5597569
 0.5600614  0.56106955 0.56267333 0.5643614  0.5655998  0.5659765
 0.5655556  0.56459725 0.563417   0.5622768  0.561317   0.56052506
 0.5597271  0.558783   0.55764455 0.5562414  0.55460316 0.5529812
 0.5514445  0.5502494  0.54950094 0.54914373 0.5491998  0.5495664
 0.5500899  0.55070096 0.55123746 0.55169946 0.5519553  0.55211264
 0.55205876 0.5518548  0.5515296  0.5510247  0.55047905 0.549939
 0.5495147  0.5493592  0.5493964  0.54951406 0.54971653 0.5499359
 0.5500551  0.55002844 0.5499743  0.54993916 0.5499731  0.54993945
 0.5498009  0.549529   0.549157   0.54870313 0.5483225  0.5480255
 0.5478837  0.54790604 0.5480259  0.5480898  0.5481111  0.54810387
 0.54806244 0.54803985 0.54810965 0.5482741  0.5485412  0.5488234
 0.5490101  0.54904634 0.5489728  0.54878753 0.5485144  0.54822254
 0.5479743  0.5478118  0.54773766 0.5476894  0.54763883 0.5475107
 0.5473341  0.5471111  0.5469247  0.54679686 0.54677075 0.54690117
 0.547124   0.547315   0.5473847  0.54730153 0.54708374 0.54676574
 0.5464695  0.54633135 0.5462792  0.54630566 0.54636246 0.5463938
 0.54635185 0.54614687 0.5458224  0.545471   0.54507065 0.54471165
 0.5443994  0.5441754  0.54403967 0.54394037 0.5438376  0.5437126
 0.54354435 0.5433303  0.54308206 0.54280794 0.5425578  0.5424009
 0.5423121  0.5422166  0.542001   0.54169166 0.54131573 0.5408848
 0.54046685 0.540172   0.5400314  0.5400724  0.54019856 0.5403373
 0.5405019  0.54068184 0.5407909  0.54085606 0.5409405  0.54094356
 0.54091877 0.54091465 0.54086435 0.54080987 0.54079276 0.5408546
 0.5409874  0.5411062  0.54122305 0.5413137  0.5413824  0.5413453
 0.54114586 0.5408563  0.540502   0.5401373  0.5398203  0.5396909
 0.53975344 0.5399235  0.5401608  0.54030156 0.5403776  0.5403689
 0.54032946 0.54028285 0.5402903  0.5403844  0.5405833  0.5408676
 0.541122   0.5412388  0.5412853  0.54132855 0.54133195 0.5413247
 0.5413251  0.54132503 0.54128927 0.54118556 0.54096097 0.5406844
 0.54039574 0.54017276 0.5400103  0.54001206 0.54017895 0.54042786
 0.540608   0.5407508  0.540955   0.54130334 0.5417172  0.5420936 ]
