Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=24, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_96_FITS_ETTm1_ftM_sl90_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34375
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=24, out_features=49, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1053696.0
params:  1225.0
Trainable parameters:  1225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4417325
	speed: 0.0226s/iter; left time: 604.3633s
	iters: 200, epoch: 1 | loss: 0.3658836
	speed: 0.0198s/iter; left time: 526.3946s
Epoch: 1 cost time: 5.4310853481292725
Epoch: 1, Steps: 268 | Train Loss: 0.4602203 Vali Loss: 0.5139987 Test Loss: 0.4482166
Validation loss decreased (inf --> 0.513999).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3531145
	speed: 0.0970s/iter; left time: 2564.6574s
	iters: 200, epoch: 2 | loss: 0.3504606
	speed: 0.0171s/iter; left time: 451.2194s
Epoch: 2 cost time: 5.271273612976074
Epoch: 2, Steps: 268 | Train Loss: 0.3653376 Vali Loss: 0.4453227 Test Loss: 0.3842925
Validation loss decreased (0.513999 --> 0.445323).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3339705
	speed: 0.1224s/iter; left time: 3201.8392s
	iters: 200, epoch: 3 | loss: 0.3406791
	speed: 0.0228s/iter; left time: 594.4018s
Epoch: 3 cost time: 8.11789870262146
Epoch: 3, Steps: 268 | Train Loss: 0.3528866 Vali Loss: 0.4274972 Test Loss: 0.3677532
Validation loss decreased (0.445323 --> 0.427497).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3365641
	speed: 0.1358s/iter; left time: 3516.9982s
	iters: 200, epoch: 4 | loss: 0.3330531
	speed: 0.0307s/iter; left time: 792.9445s
Epoch: 4 cost time: 7.328291416168213
Epoch: 4, Steps: 268 | Train Loss: 0.3497388 Vali Loss: 0.4225411 Test Loss: 0.3630413
Validation loss decreased (0.427497 --> 0.422541).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3435736
	speed: 0.1416s/iter; left time: 3629.9301s
	iters: 200, epoch: 5 | loss: 0.3873135
	speed: 0.0192s/iter; left time: 489.8731s
Epoch: 5 cost time: 7.028101921081543
Epoch: 5, Steps: 268 | Train Loss: 0.3485486 Vali Loss: 0.4200887 Test Loss: 0.3617618
Validation loss decreased (0.422541 --> 0.420089).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3751316
	speed: 0.1897s/iter; left time: 4810.2266s
	iters: 200, epoch: 6 | loss: 0.3825252
	speed: 0.0164s/iter; left time: 414.0418s
Epoch: 6 cost time: 6.735529184341431
Epoch: 6, Steps: 268 | Train Loss: 0.3477047 Vali Loss: 0.4190967 Test Loss: 0.3610657
Validation loss decreased (0.420089 --> 0.419097).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3726994
	speed: 0.1021s/iter; left time: 2561.5344s
	iters: 200, epoch: 7 | loss: 0.3392320
	speed: 0.0257s/iter; left time: 642.5003s
Epoch: 7 cost time: 6.1790385246276855
Epoch: 7, Steps: 268 | Train Loss: 0.3475437 Vali Loss: 0.4185299 Test Loss: 0.3603680
Validation loss decreased (0.419097 --> 0.418530).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3402413
	speed: 0.0949s/iter; left time: 2356.3107s
	iters: 200, epoch: 8 | loss: 0.3398984
	speed: 0.0182s/iter; left time: 450.7223s
Epoch: 8 cost time: 5.382410764694214
Epoch: 8, Steps: 268 | Train Loss: 0.3473194 Vali Loss: 0.4195296 Test Loss: 0.3608028
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3322996
	speed: 0.1017s/iter; left time: 2496.8252s
	iters: 200, epoch: 9 | loss: 0.3566949
	speed: 0.0172s/iter; left time: 420.7858s
Epoch: 9 cost time: 5.77778172492981
Epoch: 9, Steps: 268 | Train Loss: 0.3472761 Vali Loss: 0.4191086 Test Loss: 0.3607335
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3336747
	speed: 0.1110s/iter; left time: 2695.2810s
	iters: 200, epoch: 10 | loss: 0.3652291
	speed: 0.0220s/iter; left time: 531.9610s
Epoch: 10 cost time: 6.974862337112427
Epoch: 10, Steps: 268 | Train Loss: 0.3471092 Vali Loss: 0.4189984 Test Loss: 0.3603027
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3578961
	speed: 0.1297s/iter; left time: 3116.1157s
	iters: 200, epoch: 11 | loss: 0.3843904
	speed: 0.0255s/iter; left time: 610.4643s
Epoch: 11 cost time: 7.670491933822632
Epoch: 11, Steps: 268 | Train Loss: 0.3469602 Vali Loss: 0.4185201 Test Loss: 0.3604949
Validation loss decreased (0.418530 --> 0.418520).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3381485
	speed: 0.1097s/iter; left time: 2606.5793s
	iters: 200, epoch: 12 | loss: 0.3737000
	speed: 0.0148s/iter; left time: 350.1095s
Epoch: 12 cost time: 5.4901649951934814
Epoch: 12, Steps: 268 | Train Loss: 0.3469213 Vali Loss: 0.4188250 Test Loss: 0.3610264
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3583095
	speed: 0.1012s/iter; left time: 2377.7961s
	iters: 200, epoch: 13 | loss: 0.3383773
	speed: 0.0184s/iter; left time: 430.5284s
Epoch: 13 cost time: 5.418868064880371
Epoch: 13, Steps: 268 | Train Loss: 0.3468071 Vali Loss: 0.4183551 Test Loss: 0.3604129
Validation loss decreased (0.418520 --> 0.418355).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3760314
	speed: 0.0856s/iter; left time: 1987.6880s
	iters: 200, epoch: 14 | loss: 0.3309473
	speed: 0.0196s/iter; left time: 452.4921s
Epoch: 14 cost time: 5.866591453552246
Epoch: 14, Steps: 268 | Train Loss: 0.3467539 Vali Loss: 0.4184355 Test Loss: 0.3609500
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3768280
	speed: 0.0829s/iter; left time: 1901.9578s
	iters: 200, epoch: 15 | loss: 0.3469573
	speed: 0.0100s/iter; left time: 227.5989s
Epoch: 15 cost time: 5.260974168777466
Epoch: 15, Steps: 268 | Train Loss: 0.3465842 Vali Loss: 0.4177211 Test Loss: 0.3599080
Validation loss decreased (0.418355 --> 0.417721).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3794199
	speed: 0.1277s/iter; left time: 2897.1241s
	iters: 200, epoch: 16 | loss: 0.3927287
	speed: 0.0208s/iter; left time: 469.2801s
Epoch: 16 cost time: 7.05032205581665
Epoch: 16, Steps: 268 | Train Loss: 0.3466975 Vali Loss: 0.4187081 Test Loss: 0.3605855
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3481492
	speed: 0.1305s/iter; left time: 2925.7198s
	iters: 200, epoch: 17 | loss: 0.3561887
	speed: 0.0294s/iter; left time: 655.1309s
Epoch: 17 cost time: 8.52866244316101
Epoch: 17, Steps: 268 | Train Loss: 0.3465849 Vali Loss: 0.4180045 Test Loss: 0.3601098
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3549176
	speed: 0.1175s/iter; left time: 2602.5429s
	iters: 200, epoch: 18 | loss: 0.3377375
	speed: 0.0186s/iter; left time: 410.2090s
Epoch: 18 cost time: 5.977847099304199
Epoch: 18, Steps: 268 | Train Loss: 0.3464723 Vali Loss: 0.4188988 Test Loss: 0.3606587
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3494514
	speed: 0.1248s/iter; left time: 2731.0808s
	iters: 200, epoch: 19 | loss: 0.3108827
	speed: 0.0153s/iter; left time: 334.0033s
Epoch: 19 cost time: 5.296519994735718
Epoch: 19, Steps: 268 | Train Loss: 0.3465564 Vali Loss: 0.4188532 Test Loss: 0.3611459
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3843275
	speed: 0.0913s/iter; left time: 1971.8502s
	iters: 200, epoch: 20 | loss: 0.3566843
	speed: 0.0215s/iter; left time: 461.5949s
Epoch: 20 cost time: 6.227933406829834
Epoch: 20, Steps: 268 | Train Loss: 0.3464857 Vali Loss: 0.4187409 Test Loss: 0.3606438
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3568137
	speed: 0.1128s/iter; left time: 2406.3737s
	iters: 200, epoch: 21 | loss: 0.3495021
	speed: 0.0175s/iter; left time: 371.4486s
Epoch: 21 cost time: 6.8273539543151855
Epoch: 21, Steps: 268 | Train Loss: 0.3465609 Vali Loss: 0.4185153 Test Loss: 0.3604494
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3704080
	speed: 0.1215s/iter; left time: 2560.6174s
	iters: 200, epoch: 22 | loss: 0.3516520
	speed: 0.0286s/iter; left time: 599.1589s
Epoch: 22 cost time: 8.873056650161743
Epoch: 22, Steps: 268 | Train Loss: 0.3464576 Vali Loss: 0.4181273 Test Loss: 0.3603689
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3434364
	speed: 0.1355s/iter; left time: 2819.5712s
	iters: 200, epoch: 23 | loss: 0.3750428
	speed: 0.0194s/iter; left time: 401.1374s
Epoch: 23 cost time: 6.745945692062378
Epoch: 23, Steps: 268 | Train Loss: 0.3463350 Vali Loss: 0.4180600 Test Loss: 0.3603834
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3496829
	speed: 0.0954s/iter; left time: 1958.9025s
	iters: 200, epoch: 24 | loss: 0.3087967
	speed: 0.0168s/iter; left time: 343.3225s
Epoch: 24 cost time: 5.094139337539673
Epoch: 24, Steps: 268 | Train Loss: 0.3465460 Vali Loss: 0.4180905 Test Loss: 0.3604489
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3311370
	speed: 0.1152s/iter; left time: 2335.9000s
	iters: 200, epoch: 25 | loss: 0.3376461
	speed: 0.0455s/iter; left time: 917.7269s
Epoch: 25 cost time: 11.192463397979736
Epoch: 25, Steps: 268 | Train Loss: 0.3463899 Vali Loss: 0.4187955 Test Loss: 0.3606992
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3868631
	speed: 0.1316s/iter; left time: 2631.4828s
	iters: 200, epoch: 26 | loss: 0.3506444
	speed: 0.0189s/iter; left time: 376.4714s
Epoch: 26 cost time: 6.04300332069397
Epoch: 26, Steps: 268 | Train Loss: 0.3463243 Vali Loss: 0.4186936 Test Loss: 0.3606496
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3260656
	speed: 0.1191s/iter; left time: 2350.0263s
	iters: 200, epoch: 27 | loss: 0.3567058
	speed: 0.0192s/iter; left time: 377.8589s
Epoch: 27 cost time: 7.228152513504028
Epoch: 27, Steps: 268 | Train Loss: 0.3463469 Vali Loss: 0.4182217 Test Loss: 0.3604575
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3625966
	speed: 0.0973s/iter; left time: 1893.9665s
	iters: 200, epoch: 28 | loss: 0.3596221
	speed: 0.0353s/iter; left time: 683.8665s
Epoch: 28 cost time: 7.540126323699951
Epoch: 28, Steps: 268 | Train Loss: 0.3462949 Vali Loss: 0.4184479 Test Loss: 0.3604138
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3496696
	speed: 0.1401s/iter; left time: 2690.0258s
	iters: 200, epoch: 29 | loss: 0.3462619
	speed: 0.0332s/iter; left time: 634.1528s
Epoch: 29 cost time: 9.134779453277588
Epoch: 29, Steps: 268 | Train Loss: 0.3463860 Vali Loss: 0.4185582 Test Loss: 0.3605690
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3499646
	speed: 0.1356s/iter; left time: 2565.9621s
	iters: 200, epoch: 30 | loss: 0.3221093
	speed: 0.0261s/iter; left time: 491.4710s
Epoch: 30 cost time: 7.579371452331543
Epoch: 30, Steps: 268 | Train Loss: 0.3463005 Vali Loss: 0.4186053 Test Loss: 0.3605852
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3299994
	speed: 0.1010s/iter; left time: 1885.1303s
	iters: 200, epoch: 31 | loss: 0.3557664
	speed: 0.0176s/iter; left time: 326.4159s
Epoch: 31 cost time: 5.235853433609009
Epoch: 31, Steps: 268 | Train Loss: 0.3463607 Vali Loss: 0.4185678 Test Loss: 0.3606918
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3574751
	speed: 0.1018s/iter; left time: 1872.3016s
	iters: 200, epoch: 32 | loss: 0.3369664
	speed: 0.0206s/iter; left time: 376.0498s
Epoch: 32 cost time: 6.259059429168701
Epoch: 32, Steps: 268 | Train Loss: 0.3462692 Vali Loss: 0.4183560 Test Loss: 0.3605590
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3266957
	speed: 0.1119s/iter; left time: 2028.0842s
	iters: 200, epoch: 33 | loss: 0.3353414
	speed: 0.0305s/iter; left time: 550.6084s
Epoch: 33 cost time: 7.857545852661133
Epoch: 33, Steps: 268 | Train Loss: 0.3461827 Vali Loss: 0.4184953 Test Loss: 0.3603545
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3465037
	speed: 0.1165s/iter; left time: 2080.0463s
	iters: 200, epoch: 34 | loss: 0.3225763
	speed: 0.0217s/iter; left time: 386.2113s
Epoch: 34 cost time: 5.679596662521362
Epoch: 34, Steps: 268 | Train Loss: 0.3461367 Vali Loss: 0.4184979 Test Loss: 0.3605175
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3722369
	speed: 0.0942s/iter; left time: 1657.1107s
	iters: 200, epoch: 35 | loss: 0.3279490
	speed: 0.0307s/iter; left time: 537.7785s
Epoch: 35 cost time: 7.210679292678833
Epoch: 35, Steps: 268 | Train Loss: 0.3463156 Vali Loss: 0.4186394 Test Loss: 0.3607304
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_96_FITS_ETTm1_ftM_sl90_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.36244434118270874, mae:0.3800426125526428, rse:0.57286536693573, corr:[0.55352557 0.55398995 0.54803    0.5478762  0.5461798  0.5421503
 0.5406702  0.5405433  0.5391354  0.5372485  0.5364939  0.536276
 0.53561044 0.5339365  0.5310753  0.52758205 0.5245865  0.521878
 0.51862574 0.51529115 0.5126919  0.510283   0.50707006 0.50340635
 0.500254   0.4971912  0.49377367 0.49073914 0.48915496 0.48821026
 0.48717546 0.48691377 0.48723772 0.48760948 0.48765993 0.48784795
 0.487988   0.48795736 0.4877348  0.4876026  0.48776758 0.4875655
 0.48709887 0.4869339  0.48699257 0.48694292 0.48671725 0.48661068
 0.48687613 0.48739052 0.48780447 0.4878555  0.48796326 0.48821184
 0.48864803 0.48898044 0.48926115 0.48941484 0.48931524 0.48931235
 0.48936778 0.48906565 0.48881584 0.4886912  0.48866782 0.48839435
 0.48803505 0.48807743 0.4885609  0.48902485 0.4891537  0.48938915
 0.48992282 0.4903266  0.49069223 0.49109465 0.49178892 0.49264035
 0.49339744 0.49393627 0.49433511 0.4947683  0.49535847 0.49558857
 0.49584544 0.49664065 0.4974248  0.49779704 0.49881834 0.5006486
 0.50161374 0.50185275 0.5035388  0.5054014  0.5060881  0.5073126 ]
