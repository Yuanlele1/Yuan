Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=50, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_96_FITS_ETTm1_ftM_sl360_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=50, out_features=63, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2822400.0
params:  3213.0
Trainable parameters:  3213
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3511387
	speed: 0.0424s/iter; left time: 1124.3342s
	iters: 200, epoch: 1 | loss: 0.2827854
	speed: 0.0242s/iter; left time: 638.3602s
Epoch: 1 cost time: 7.669022083282471
Epoch: 1, Steps: 266 | Train Loss: 0.3422904 Vali Loss: 0.6238852 Test Loss: 0.4492487
Validation loss decreased (inf --> 0.623885).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2019660
	speed: 0.0735s/iter; left time: 1927.9057s
	iters: 200, epoch: 2 | loss: 0.1842108
	speed: 0.0150s/iter; left time: 391.9351s
Epoch: 2 cost time: 4.999749422073364
Epoch: 2, Steps: 266 | Train Loss: 0.1924276 Vali Loss: 0.5405685 Test Loss: 0.3963751
Validation loss decreased (0.623885 --> 0.540568).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1442142
	speed: 0.0749s/iter; left time: 1943.9389s
	iters: 200, epoch: 3 | loss: 0.1251944
	speed: 0.0154s/iter; left time: 399.1867s
Epoch: 3 cost time: 4.37990927696228
Epoch: 3, Steps: 266 | Train Loss: 0.1416349 Vali Loss: 0.5047512 Test Loss: 0.3766370
Validation loss decreased (0.540568 --> 0.504751).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1081402
	speed: 0.0728s/iter; left time: 1870.7705s
	iters: 200, epoch: 4 | loss: 0.1100767
	speed: 0.0154s/iter; left time: 395.0234s
Epoch: 4 cost time: 4.857147932052612
Epoch: 4, Steps: 266 | Train Loss: 0.1162760 Vali Loss: 0.4837866 Test Loss: 0.3653123
Validation loss decreased (0.504751 --> 0.483787).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1043574
	speed: 0.1172s/iter; left time: 2982.4469s
	iters: 200, epoch: 5 | loss: 0.1013487
	speed: 0.0255s/iter; left time: 645.4740s
Epoch: 5 cost time: 8.683686017990112
Epoch: 5, Steps: 266 | Train Loss: 0.1014291 Vali Loss: 0.4697124 Test Loss: 0.3568714
Validation loss decreased (0.483787 --> 0.469712).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0954411
	speed: 0.1059s/iter; left time: 2664.5949s
	iters: 200, epoch: 6 | loss: 0.0956654
	speed: 0.0164s/iter; left time: 410.6492s
Epoch: 6 cost time: 6.740455150604248
Epoch: 6, Steps: 266 | Train Loss: 0.0921400 Vali Loss: 0.4576839 Test Loss: 0.3482708
Validation loss decreased (0.469712 --> 0.457684).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0928164
	speed: 0.1020s/iter; left time: 2541.5363s
	iters: 200, epoch: 7 | loss: 0.0856053
	speed: 0.0151s/iter; left time: 374.1007s
Epoch: 7 cost time: 5.390172481536865
Epoch: 7, Steps: 266 | Train Loss: 0.0860900 Vali Loss: 0.4465232 Test Loss: 0.3416515
Validation loss decreased (0.457684 --> 0.446523).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0848682
	speed: 0.0867s/iter; left time: 2136.1274s
	iters: 200, epoch: 8 | loss: 0.0800300
	speed: 0.0149s/iter; left time: 366.4657s
Epoch: 8 cost time: 4.482952117919922
Epoch: 8, Steps: 266 | Train Loss: 0.0820528 Vali Loss: 0.4371289 Test Loss: 0.3352738
Validation loss decreased (0.446523 --> 0.437129).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0832960
	speed: 0.0905s/iter; left time: 2205.4666s
	iters: 200, epoch: 9 | loss: 0.0792294
	speed: 0.0164s/iter; left time: 399.2843s
Epoch: 9 cost time: 5.04754638671875
Epoch: 9, Steps: 266 | Train Loss: 0.0793181 Vali Loss: 0.4321519 Test Loss: 0.3309066
Validation loss decreased (0.437129 --> 0.432152).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0804546
	speed: 0.0804s/iter; left time: 1937.6125s
	iters: 200, epoch: 10 | loss: 0.0791433
	speed: 0.0158s/iter; left time: 379.7233s
Epoch: 10 cost time: 5.22171950340271
Epoch: 10, Steps: 266 | Train Loss: 0.0774178 Vali Loss: 0.4253022 Test Loss: 0.3269648
Validation loss decreased (0.432152 --> 0.425302).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0786475
	speed: 0.0739s/iter; left time: 1760.7288s
	iters: 200, epoch: 11 | loss: 0.0737948
	speed: 0.0144s/iter; left time: 342.6244s
Epoch: 11 cost time: 4.593027591705322
Epoch: 11, Steps: 266 | Train Loss: 0.0761043 Vali Loss: 0.4223018 Test Loss: 0.3242738
Validation loss decreased (0.425302 --> 0.422302).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0771260
	speed: 0.0735s/iter; left time: 1731.7332s
	iters: 200, epoch: 12 | loss: 0.0802340
	speed: 0.0253s/iter; left time: 593.9529s
Epoch: 12 cost time: 6.653847932815552
Epoch: 12, Steps: 266 | Train Loss: 0.0751887 Vali Loss: 0.4184319 Test Loss: 0.3216874
Validation loss decreased (0.422302 --> 0.418432).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0724374
	speed: 0.1055s/iter; left time: 2459.2882s
	iters: 200, epoch: 13 | loss: 0.0696605
	speed: 0.0209s/iter; left time: 485.0163s
Epoch: 13 cost time: 5.911189079284668
Epoch: 13, Steps: 266 | Train Loss: 0.0745496 Vali Loss: 0.4177102 Test Loss: 0.3194026
Validation loss decreased (0.418432 --> 0.417710).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0807324
	speed: 0.0872s/iter; left time: 2010.0465s
	iters: 200, epoch: 14 | loss: 0.0731448
	speed: 0.0279s/iter; left time: 639.3751s
Epoch: 14 cost time: 6.897629261016846
Epoch: 14, Steps: 266 | Train Loss: 0.0741276 Vali Loss: 0.4149934 Test Loss: 0.3180296
Validation loss decreased (0.417710 --> 0.414993).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0697874
	speed: 0.0764s/iter; left time: 1739.6609s
	iters: 200, epoch: 15 | loss: 0.0719512
	speed: 0.0148s/iter; left time: 336.6124s
Epoch: 15 cost time: 4.2877020835876465
Epoch: 15, Steps: 266 | Train Loss: 0.0738312 Vali Loss: 0.4151137 Test Loss: 0.3171291
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0751847
	speed: 0.0768s/iter; left time: 1728.9807s
	iters: 200, epoch: 16 | loss: 0.0711319
	speed: 0.0155s/iter; left time: 348.3104s
Epoch: 16 cost time: 5.3064470291137695
Epoch: 16, Steps: 266 | Train Loss: 0.0736364 Vali Loss: 0.4140900 Test Loss: 0.3166424
Validation loss decreased (0.414993 --> 0.414090).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0739476
	speed: 0.0865s/iter; left time: 1923.7527s
	iters: 200, epoch: 17 | loss: 0.0835553
	speed: 0.0150s/iter; left time: 332.8173s
Epoch: 17 cost time: 4.578796148300171
Epoch: 17, Steps: 266 | Train Loss: 0.0735003 Vali Loss: 0.4133328 Test Loss: 0.3152738
Validation loss decreased (0.414090 --> 0.413333).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0686120
	speed: 0.0861s/iter; left time: 1892.9015s
	iters: 200, epoch: 18 | loss: 0.0743234
	speed: 0.0160s/iter; left time: 350.4219s
Epoch: 18 cost time: 5.052751541137695
Epoch: 18, Steps: 266 | Train Loss: 0.0734098 Vali Loss: 0.4111251 Test Loss: 0.3149564
Validation loss decreased (0.413333 --> 0.411125).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0776935
	speed: 0.0876s/iter; left time: 1901.5448s
	iters: 200, epoch: 19 | loss: 0.0742353
	speed: 0.0152s/iter; left time: 328.0989s
Epoch: 19 cost time: 5.820836305618286
Epoch: 19, Steps: 266 | Train Loss: 0.0733676 Vali Loss: 0.4115918 Test Loss: 0.3143061
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0660596
	speed: 0.0915s/iter; left time: 1963.0075s
	iters: 200, epoch: 20 | loss: 0.0724715
	speed: 0.0285s/iter; left time: 607.7602s
Epoch: 20 cost time: 7.306051015853882
Epoch: 20, Steps: 266 | Train Loss: 0.0733351 Vali Loss: 0.4115930 Test Loss: 0.3140870
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0749273
	speed: 0.0733s/iter; left time: 1552.4953s
	iters: 200, epoch: 21 | loss: 0.0707455
	speed: 0.0149s/iter; left time: 314.0869s
Epoch: 21 cost time: 4.491025447845459
Epoch: 21, Steps: 266 | Train Loss: 0.0733150 Vali Loss: 0.4114646 Test Loss: 0.3136758
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0675865
	speed: 0.0731s/iter; left time: 1529.6687s
	iters: 200, epoch: 22 | loss: 0.0770955
	speed: 0.0153s/iter; left time: 318.1248s
Epoch: 22 cost time: 4.623536586761475
Epoch: 22, Steps: 266 | Train Loss: 0.0733138 Vali Loss: 0.4116451 Test Loss: 0.3137200
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0783000
	speed: 0.0715s/iter; left time: 1476.6817s
	iters: 200, epoch: 23 | loss: 0.0761389
	speed: 0.0140s/iter; left time: 287.3201s
Epoch: 23 cost time: 4.6506288051605225
Epoch: 23, Steps: 266 | Train Loss: 0.0732884 Vali Loss: 0.4108412 Test Loss: 0.3133008
Validation loss decreased (0.411125 --> 0.410841).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0648612
	speed: 0.0774s/iter; left time: 1577.6285s
	iters: 200, epoch: 24 | loss: 0.0714307
	speed: 0.0166s/iter; left time: 335.9499s
Epoch: 24 cost time: 5.5063796043396
Epoch: 24, Steps: 266 | Train Loss: 0.0732887 Vali Loss: 0.4110692 Test Loss: 0.3136764
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0765990
	speed: 0.1016s/iter; left time: 2043.8697s
	iters: 200, epoch: 25 | loss: 0.0731792
	speed: 0.0266s/iter; left time: 531.8171s
Epoch: 25 cost time: 7.817268133163452
Epoch: 25, Steps: 266 | Train Loss: 0.0733043 Vali Loss: 0.4107508 Test Loss: 0.3135722
Validation loss decreased (0.410841 --> 0.410751).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0731277
	speed: 0.0976s/iter; left time: 1938.1494s
	iters: 200, epoch: 26 | loss: 0.0717911
	speed: 0.0151s/iter; left time: 297.6511s
Epoch: 26 cost time: 4.878185749053955
Epoch: 26, Steps: 266 | Train Loss: 0.0732904 Vali Loss: 0.4104329 Test Loss: 0.3135080
Validation loss decreased (0.410751 --> 0.410433).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0722377
	speed: 0.0722s/iter; left time: 1414.8560s
	iters: 200, epoch: 27 | loss: 0.0723789
	speed: 0.0151s/iter; left time: 295.1305s
Epoch: 27 cost time: 4.916385650634766
Epoch: 27, Steps: 266 | Train Loss: 0.0732889 Vali Loss: 0.4112922 Test Loss: 0.3136132
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0718932
	speed: 0.0900s/iter; left time: 1739.4698s
	iters: 200, epoch: 28 | loss: 0.0800495
	speed: 0.0146s/iter; left time: 281.2406s
Epoch: 28 cost time: 5.688180685043335
Epoch: 28, Steps: 266 | Train Loss: 0.0732888 Vali Loss: 0.4112535 Test Loss: 0.3134209
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0745370
	speed: 0.0758s/iter; left time: 1443.4015s
	iters: 200, epoch: 29 | loss: 0.0750232
	speed: 0.0158s/iter; left time: 300.3179s
Epoch: 29 cost time: 4.868138074874878
Epoch: 29, Steps: 266 | Train Loss: 0.0732716 Vali Loss: 0.4109941 Test Loss: 0.3132588
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0706712
	speed: 0.0909s/iter; left time: 1707.4605s
	iters: 200, epoch: 30 | loss: 0.0738546
	speed: 0.0149s/iter; left time: 278.8874s
Epoch: 30 cost time: 4.693115234375
Epoch: 30, Steps: 266 | Train Loss: 0.0732906 Vali Loss: 0.4111755 Test Loss: 0.3134728
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0749370
	speed: 0.0783s/iter; left time: 1449.4890s
	iters: 200, epoch: 31 | loss: 0.0748791
	speed: 0.0188s/iter; left time: 345.9532s
Epoch: 31 cost time: 6.02152419090271
Epoch: 31, Steps: 266 | Train Loss: 0.0732819 Vali Loss: 0.4112425 Test Loss: 0.3136044
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0724929
	speed: 0.0820s/iter; left time: 1497.3715s
	iters: 200, epoch: 32 | loss: 0.0707789
	speed: 0.0161s/iter; left time: 291.8697s
Epoch: 32 cost time: 4.562651634216309
Epoch: 32, Steps: 266 | Train Loss: 0.0732906 Vali Loss: 0.4106466 Test Loss: 0.3135950
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0723940
	speed: 0.0850s/iter; left time: 1529.6326s
	iters: 200, epoch: 33 | loss: 0.0769189
	speed: 0.0188s/iter; left time: 336.9165s
Epoch: 33 cost time: 5.310936689376831
Epoch: 33, Steps: 266 | Train Loss: 0.0732699 Vali Loss: 0.4106570 Test Loss: 0.3134879
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0708308
	speed: 0.1054s/iter; left time: 1868.5181s
	iters: 200, epoch: 34 | loss: 0.0732411
	speed: 0.0160s/iter; left time: 281.8892s
Epoch: 34 cost time: 5.767242670059204
Epoch: 34, Steps: 266 | Train Loss: 0.0732872 Vali Loss: 0.4110818 Test Loss: 0.3135163
EarlyStopping counter: 8 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0794822
	speed: 0.0772s/iter; left time: 1347.1038s
	iters: 200, epoch: 35 | loss: 0.0729068
	speed: 0.0157s/iter; left time: 273.0735s
Epoch: 35 cost time: 4.600350856781006
Epoch: 35, Steps: 266 | Train Loss: 0.0732931 Vali Loss: 0.4109459 Test Loss: 0.3132707
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0746158
	speed: 0.0726s/iter; left time: 1248.6610s
	iters: 200, epoch: 36 | loss: 0.0720643
	speed: 0.0148s/iter; left time: 252.3235s
Epoch: 36 cost time: 4.546656370162964
Epoch: 36, Steps: 266 | Train Loss: 0.0732864 Vali Loss: 0.4115443 Test Loss: 0.3134186
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0725849
	speed: 0.0745s/iter; left time: 1260.0746s
	iters: 200, epoch: 37 | loss: 0.0710478
	speed: 0.0150s/iter; left time: 251.7648s
Epoch: 37 cost time: 4.4302990436553955
Epoch: 37, Steps: 266 | Train Loss: 0.0732496 Vali Loss: 0.4111774 Test Loss: 0.3135442
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0762541
	speed: 0.0811s/iter; left time: 1350.8365s
	iters: 200, epoch: 38 | loss: 0.0772836
	speed: 0.0149s/iter; left time: 246.3955s
Epoch: 38 cost time: 5.258657693862915
Epoch: 38, Steps: 266 | Train Loss: 0.0732717 Vali Loss: 0.4105506 Test Loss: 0.3131777
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0700701
	speed: 0.0896s/iter; left time: 1468.8521s
	iters: 200, epoch: 39 | loss: 0.0780476
	speed: 0.0154s/iter; left time: 250.9710s
Epoch: 39 cost time: 4.606109142303467
Epoch: 39, Steps: 266 | Train Loss: 0.0733044 Vali Loss: 0.4108773 Test Loss: 0.3135523
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0764870
	speed: 0.0836s/iter; left time: 1348.4212s
	iters: 200, epoch: 40 | loss: 0.0763728
	speed: 0.0241s/iter; left time: 385.6080s
Epoch: 40 cost time: 6.758749961853027
Epoch: 40, Steps: 266 | Train Loss: 0.0732680 Vali Loss: 0.4111295 Test Loss: 0.3134341
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0699264
	speed: 0.1158s/iter; left time: 1837.1117s
	iters: 200, epoch: 41 | loss: 0.0718808
	speed: 0.0381s/iter; left time: 600.0524s
Epoch: 41 cost time: 8.148537874221802
Epoch: 41, Steps: 266 | Train Loss: 0.0732910 Vali Loss: 0.4106369 Test Loss: 0.3134616
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0735541
	speed: 0.0941s/iter; left time: 1466.7767s
	iters: 200, epoch: 42 | loss: 0.0739602
	speed: 0.0205s/iter; left time: 317.6745s
Epoch: 42 cost time: 7.018860578536987
Epoch: 42, Steps: 266 | Train Loss: 0.0732939 Vali Loss: 0.4110541 Test Loss: 0.3133348
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0696745
	speed: 0.0718s/iter; left time: 1100.5894s
	iters: 200, epoch: 43 | loss: 0.0763196
	speed: 0.0155s/iter; left time: 235.5574s
Epoch: 43 cost time: 5.932428598403931
Epoch: 43, Steps: 266 | Train Loss: 0.0732778 Vali Loss: 0.4107081 Test Loss: 0.3133414
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0749150
	speed: 0.0852s/iter; left time: 1283.1657s
	iters: 200, epoch: 44 | loss: 0.0638917
	speed: 0.0252s/iter; left time: 377.1265s
Epoch: 44 cost time: 5.66940712928772
Epoch: 44, Steps: 266 | Train Loss: 0.0732844 Vali Loss: 0.4110349 Test Loss: 0.3132936
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0677853
	speed: 0.0741s/iter; left time: 1096.9532s
	iters: 200, epoch: 45 | loss: 0.0729851
	speed: 0.0282s/iter; left time: 414.4974s
Epoch: 45 cost time: 5.935896635055542
Epoch: 45, Steps: 266 | Train Loss: 0.0732670 Vali Loss: 0.4110287 Test Loss: 0.3135031
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0674319
	speed: 0.0790s/iter; left time: 1147.5911s
	iters: 200, epoch: 46 | loss: 0.0703430
	speed: 0.0150s/iter; left time: 216.1094s
Epoch: 46 cost time: 5.283969163894653
Epoch: 46, Steps: 266 | Train Loss: 0.0732675 Vali Loss: 0.4112941 Test Loss: 0.3133597
EarlyStopping counter: 20 out of 20
Early stopping
train 34105
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=50, out_features=63, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2822400.0
params:  3213.0
Trainable parameters:  3213
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2428046
	speed: 0.0282s/iter; left time: 746.2508s
	iters: 200, epoch: 1 | loss: 0.2859302
	speed: 0.0147s/iter; left time: 388.7761s
Epoch: 1 cost time: 5.302798271179199
Epoch: 1, Steps: 266 | Train Loss: 0.2766372 Vali Loss: 0.4001499 Test Loss: 0.3047228
Validation loss decreased (inf --> 0.400150).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2579997
	speed: 0.0930s/iter; left time: 2439.2634s
	iters: 200, epoch: 2 | loss: 0.2608989
	speed: 0.0172s/iter; left time: 449.6527s
Epoch: 2 cost time: 5.9891862869262695
Epoch: 2, Steps: 266 | Train Loss: 0.2740621 Vali Loss: 0.3972614 Test Loss: 0.3037105
Validation loss decreased (0.400150 --> 0.397261).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2648292
	speed: 0.0798s/iter; left time: 2071.7404s
	iters: 200, epoch: 3 | loss: 0.2674347
	speed: 0.0141s/iter; left time: 365.7591s
Epoch: 3 cost time: 4.941132307052612
Epoch: 3, Steps: 266 | Train Loss: 0.2731004 Vali Loss: 0.3952718 Test Loss: 0.3035666
Validation loss decreased (0.397261 --> 0.395272).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2670320
	speed: 0.1037s/iter; left time: 2665.4904s
	iters: 200, epoch: 4 | loss: 0.2607181
	speed: 0.0199s/iter; left time: 508.5970s
Epoch: 4 cost time: 6.7539544105529785
Epoch: 4, Steps: 266 | Train Loss: 0.2726333 Vali Loss: 0.3943028 Test Loss: 0.3034570
Validation loss decreased (0.395272 --> 0.394303).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2563438
	speed: 0.0858s/iter; left time: 2183.3359s
	iters: 200, epoch: 5 | loss: 0.2873010
	speed: 0.0158s/iter; left time: 400.0653s
Epoch: 5 cost time: 4.924595594406128
Epoch: 5, Steps: 266 | Train Loss: 0.2723473 Vali Loss: 0.3946319 Test Loss: 0.3022925
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2566388
	speed: 0.0785s/iter; left time: 1975.1994s
	iters: 200, epoch: 6 | loss: 0.2445516
	speed: 0.0158s/iter; left time: 396.1101s
Epoch: 6 cost time: 5.401487112045288
Epoch: 6, Steps: 266 | Train Loss: 0.2720512 Vali Loss: 0.3951384 Test Loss: 0.3026252
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2618065
	speed: 0.0744s/iter; left time: 1852.7529s
	iters: 200, epoch: 7 | loss: 0.3028044
	speed: 0.0141s/iter; left time: 350.4494s
Epoch: 7 cost time: 4.255875825881958
Epoch: 7, Steps: 266 | Train Loss: 0.2719388 Vali Loss: 0.3925980 Test Loss: 0.3027887
Validation loss decreased (0.394303 --> 0.392598).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2900542
	speed: 0.0762s/iter; left time: 1876.3388s
	iters: 200, epoch: 8 | loss: 0.2667120
	speed: 0.0165s/iter; left time: 405.8278s
Epoch: 8 cost time: 5.7306907176971436
Epoch: 8, Steps: 266 | Train Loss: 0.2717708 Vali Loss: 0.3931731 Test Loss: 0.3026803
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2778268
	speed: 0.0854s/iter; left time: 2081.0355s
	iters: 200, epoch: 9 | loss: 0.2933453
	speed: 0.0152s/iter; left time: 368.7911s
Epoch: 9 cost time: 4.928459405899048
Epoch: 9, Steps: 266 | Train Loss: 0.2716086 Vali Loss: 0.3952374 Test Loss: 0.3036956
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2446613
	speed: 0.0914s/iter; left time: 2203.2837s
	iters: 200, epoch: 10 | loss: 0.2745640
	speed: 0.0223s/iter; left time: 534.3148s
Epoch: 10 cost time: 6.127625465393066
Epoch: 10, Steps: 266 | Train Loss: 0.2716039 Vali Loss: 0.3937038 Test Loss: 0.3026964
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2766382
	speed: 0.0864s/iter; left time: 2060.1673s
	iters: 200, epoch: 11 | loss: 0.3176962
	speed: 0.0245s/iter; left time: 582.2280s
Epoch: 11 cost time: 7.017361164093018
Epoch: 11, Steps: 266 | Train Loss: 0.2715769 Vali Loss: 0.3932003 Test Loss: 0.3026594
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2726052
	speed: 0.0812s/iter; left time: 1915.0483s
	iters: 200, epoch: 12 | loss: 0.2723449
	speed: 0.0320s/iter; left time: 751.7934s
Epoch: 12 cost time: 6.903881788253784
Epoch: 12, Steps: 266 | Train Loss: 0.2714883 Vali Loss: 0.3926476 Test Loss: 0.3018127
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2730830
	speed: 0.0771s/iter; left time: 1796.3682s
	iters: 200, epoch: 13 | loss: 0.2839619
	speed: 0.0175s/iter; left time: 406.9548s
Epoch: 13 cost time: 4.847949504852295
Epoch: 13, Steps: 266 | Train Loss: 0.2714723 Vali Loss: 0.3935582 Test Loss: 0.3023215
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2701470
	speed: 0.0698s/iter; left time: 1608.4951s
	iters: 200, epoch: 14 | loss: 0.2962412
	speed: 0.0149s/iter; left time: 341.0432s
Epoch: 14 cost time: 4.3491051197052
Epoch: 14, Steps: 266 | Train Loss: 0.2713334 Vali Loss: 0.3930662 Test Loss: 0.3025755
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2558459
	speed: 0.0741s/iter; left time: 1686.7932s
	iters: 200, epoch: 15 | loss: 0.2325031
	speed: 0.0163s/iter; left time: 368.6142s
Epoch: 15 cost time: 4.7852020263671875
Epoch: 15, Steps: 266 | Train Loss: 0.2714010 Vali Loss: 0.3926597 Test Loss: 0.3022103
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2604128
	speed: 0.0852s/iter; left time: 1917.0769s
	iters: 200, epoch: 16 | loss: 0.2619735
	speed: 0.0229s/iter; left time: 512.1895s
Epoch: 16 cost time: 6.572635650634766
Epoch: 16, Steps: 266 | Train Loss: 0.2713858 Vali Loss: 0.3939122 Test Loss: 0.3023691
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2862501
	speed: 0.0772s/iter; left time: 1717.8151s
	iters: 200, epoch: 17 | loss: 0.2631159
	speed: 0.0203s/iter; left time: 448.4882s
Epoch: 17 cost time: 5.001476287841797
Epoch: 17, Steps: 266 | Train Loss: 0.2713513 Vali Loss: 0.3925835 Test Loss: 0.3019410
Validation loss decreased (0.392598 --> 0.392583).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2478791
	speed: 0.0725s/iter; left time: 1593.9616s
	iters: 200, epoch: 18 | loss: 0.2506095
	speed: 0.0137s/iter; left time: 299.2411s
Epoch: 18 cost time: 4.2800726890563965
Epoch: 18, Steps: 266 | Train Loss: 0.2711825 Vali Loss: 0.3917738 Test Loss: 0.3024482
Validation loss decreased (0.392583 --> 0.391774).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2698920
	speed: 0.0740s/iter; left time: 1606.7754s
	iters: 200, epoch: 19 | loss: 0.2876018
	speed: 0.0135s/iter; left time: 292.1201s
Epoch: 19 cost time: 4.3639912605285645
Epoch: 19, Steps: 266 | Train Loss: 0.2712432 Vali Loss: 0.3917913 Test Loss: 0.3023320
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2637934
	speed: 0.0700s/iter; left time: 1501.7521s
	iters: 200, epoch: 20 | loss: 0.2574033
	speed: 0.0139s/iter; left time: 297.3484s
Epoch: 20 cost time: 4.419504880905151
Epoch: 20, Steps: 266 | Train Loss: 0.2711880 Vali Loss: 0.3922901 Test Loss: 0.3020921
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2641886
	speed: 0.0788s/iter; left time: 1669.8215s
	iters: 200, epoch: 21 | loss: 0.2807073
	speed: 0.0242s/iter; left time: 509.6059s
Epoch: 21 cost time: 6.142319679260254
Epoch: 21, Steps: 266 | Train Loss: 0.2711355 Vali Loss: 0.3930535 Test Loss: 0.3020714
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2781799
	speed: 0.0776s/iter; left time: 1622.5203s
	iters: 200, epoch: 22 | loss: 0.2893195
	speed: 0.0170s/iter; left time: 354.1446s
Epoch: 22 cost time: 5.078943252563477
Epoch: 22, Steps: 266 | Train Loss: 0.2711365 Vali Loss: 0.3937917 Test Loss: 0.3018062
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2569188
	speed: 0.1009s/iter; left time: 2083.8639s
	iters: 200, epoch: 23 | loss: 0.2726496
	speed: 0.0176s/iter; left time: 361.7005s
Epoch: 23 cost time: 6.812009811401367
Epoch: 23, Steps: 266 | Train Loss: 0.2710637 Vali Loss: 0.3929884 Test Loss: 0.3018788
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2739669
	speed: 0.0842s/iter; left time: 1715.9185s
	iters: 200, epoch: 24 | loss: 0.2994513
	speed: 0.0193s/iter; left time: 391.7059s
Epoch: 24 cost time: 6.4704978466033936
Epoch: 24, Steps: 266 | Train Loss: 0.2710079 Vali Loss: 0.3918566 Test Loss: 0.3019906
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2636838
	speed: 0.0833s/iter; left time: 1674.8262s
	iters: 200, epoch: 25 | loss: 0.2662116
	speed: 0.0223s/iter; left time: 445.7788s
Epoch: 25 cost time: 5.212472915649414
Epoch: 25, Steps: 266 | Train Loss: 0.2710896 Vali Loss: 0.3921644 Test Loss: 0.3021981
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2677382
	speed: 0.0726s/iter; left time: 1440.8878s
	iters: 200, epoch: 26 | loss: 0.2709779
	speed: 0.0159s/iter; left time: 314.8730s
Epoch: 26 cost time: 4.699402809143066
Epoch: 26, Steps: 266 | Train Loss: 0.2710807 Vali Loss: 0.3923222 Test Loss: 0.3024321
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2762242
	speed: 0.0721s/iter; left time: 1412.5591s
	iters: 200, epoch: 27 | loss: 0.2867112
	speed: 0.0152s/iter; left time: 296.0828s
Epoch: 27 cost time: 4.704365968704224
Epoch: 27, Steps: 266 | Train Loss: 0.2710506 Vali Loss: 0.3925244 Test Loss: 0.3019989
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2856338
	speed: 0.1038s/iter; left time: 2005.1895s
	iters: 200, epoch: 28 | loss: 0.2704082
	speed: 0.0147s/iter; left time: 281.7304s
Epoch: 28 cost time: 4.470508098602295
Epoch: 28, Steps: 266 | Train Loss: 0.2709208 Vali Loss: 0.3921957 Test Loss: 0.3021356
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2503559
	speed: 0.0985s/iter; left time: 1876.7578s
	iters: 200, epoch: 29 | loss: 0.2585701
	speed: 0.0147s/iter; left time: 277.8965s
Epoch: 29 cost time: 4.6594767570495605
Epoch: 29, Steps: 266 | Train Loss: 0.2709611 Vali Loss: 0.3928220 Test Loss: 0.3020949
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2427540
	speed: 0.0718s/iter; left time: 1349.6613s
	iters: 200, epoch: 30 | loss: 0.2743249
	speed: 0.0144s/iter; left time: 269.8304s
Epoch: 30 cost time: 4.245300054550171
Epoch: 30, Steps: 266 | Train Loss: 0.2709967 Vali Loss: 0.3921188 Test Loss: 0.3021966
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2445200
	speed: 0.0723s/iter; left time: 1339.3507s
	iters: 200, epoch: 31 | loss: 0.2522247
	speed: 0.0139s/iter; left time: 256.1237s
Epoch: 31 cost time: 4.613171100616455
Epoch: 31, Steps: 266 | Train Loss: 0.2709560 Vali Loss: 0.3919946 Test Loss: 0.3019378
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2428919
	speed: 0.0851s/iter; left time: 1553.6842s
	iters: 200, epoch: 32 | loss: 0.2625766
	speed: 0.0283s/iter; left time: 514.4561s
Epoch: 32 cost time: 6.180619239807129
Epoch: 32, Steps: 266 | Train Loss: 0.2709141 Vali Loss: 0.3927161 Test Loss: 0.3019802
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2669051
	speed: 0.0690s/iter; left time: 1240.6978s
	iters: 200, epoch: 33 | loss: 0.2821178
	speed: 0.0269s/iter; left time: 481.2681s
Epoch: 33 cost time: 5.8442888259887695
Epoch: 33, Steps: 266 | Train Loss: 0.2709706 Vali Loss: 0.3925842 Test Loss: 0.3020145
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2710731
	speed: 0.0728s/iter; left time: 1289.3497s
	iters: 200, epoch: 34 | loss: 0.2715591
	speed: 0.0152s/iter; left time: 267.9002s
Epoch: 34 cost time: 4.693827390670776
Epoch: 34, Steps: 266 | Train Loss: 0.2708546 Vali Loss: 0.3921523 Test Loss: 0.3020469
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2770062
	speed: 0.0720s/iter; left time: 1257.2762s
	iters: 200, epoch: 35 | loss: 0.2454038
	speed: 0.0156s/iter; left time: 270.2460s
Epoch: 35 cost time: 4.678905010223389
Epoch: 35, Steps: 266 | Train Loss: 0.2709542 Vali Loss: 0.3927872 Test Loss: 0.3021010
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2498002
	speed: 0.0717s/iter; left time: 1233.1517s
	iters: 200, epoch: 36 | loss: 0.2805965
	speed: 0.0151s/iter; left time: 258.8004s
Epoch: 36 cost time: 4.427369594573975
Epoch: 36, Steps: 266 | Train Loss: 0.2709491 Vali Loss: 0.3925818 Test Loss: 0.3020929
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2678790
	speed: 0.0695s/iter; left time: 1176.6542s
	iters: 200, epoch: 37 | loss: 0.3006605
	speed: 0.0151s/iter; left time: 254.5559s
Epoch: 37 cost time: 4.432624816894531
Epoch: 37, Steps: 266 | Train Loss: 0.2708894 Vali Loss: 0.3921265 Test Loss: 0.3021107
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2665865
	speed: 0.0807s/iter; left time: 1343.7851s
	iters: 200, epoch: 38 | loss: 0.2938750
	speed: 0.0181s/iter; left time: 300.0260s
Epoch: 38 cost time: 4.774445533752441
Epoch: 38, Steps: 266 | Train Loss: 0.2709254 Vali Loss: 0.3925187 Test Loss: 0.3021535
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_96_FITS_ETTm1_ftM_sl360_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.30431893467903137, mae:0.34611067175865173, rse:0.5249239206314087, corr:[0.54719454 0.55615485 0.5584133  0.557313   0.55649906 0.55718815
 0.55875427 0.5599338  0.5600166  0.5594951  0.5593969  0.55985135
 0.560593   0.5609948  0.560544   0.5592448  0.55770874 0.55647016
 0.5554461  0.5544775  0.5533533  0.5521637  0.55085105 0.54962134
 0.54849637 0.54732543 0.5462152  0.54532474 0.5446981  0.54426014
 0.5442938  0.54489625 0.54570407 0.5463096  0.5464361  0.54624784
 0.5458755  0.5454802  0.54521185 0.5450572  0.5449402  0.54471743
 0.54434067 0.5440209  0.54387957 0.5439982  0.54431665 0.544509
 0.5443471  0.5439655  0.5435354  0.54326624 0.5432995  0.5434863
 0.5436322  0.54362476 0.5433996  0.5430883  0.5429069  0.54281944
 0.54288983 0.5429366  0.54289    0.5426367  0.5423702  0.54224604
 0.54227793 0.5424147  0.5427649  0.54314893 0.54341817 0.54344815
 0.5433138  0.5431317  0.5429656  0.5428219  0.54271024 0.54254556
 0.54221916 0.54175943 0.54131997 0.5410027  0.5407774  0.5405251
 0.54020405 0.53972167 0.5392344  0.5387966  0.5384748  0.53839105
 0.5385138  0.5387268  0.53906804 0.5396201  0.54002815 0.53952825]
