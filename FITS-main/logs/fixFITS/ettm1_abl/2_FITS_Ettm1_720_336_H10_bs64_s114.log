Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=90, out_features=132, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  10644480.0
params:  12012.0
Trainable parameters:  12012
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4183762
	speed: 0.0429s/iter; left time: 1115.9274s
	iters: 200, epoch: 1 | loss: 0.3397096
	speed: 0.0326s/iter; left time: 843.8664s
Epoch: 1 cost time: 8.950617551803589
Epoch: 1, Steps: 261 | Train Loss: 0.4257456 Vali Loss: 0.9484317 Test Loss: 0.5593855
Validation loss decreased (inf --> 0.948432).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2603096
	speed: 0.1172s/iter; left time: 3015.4827s
	iters: 200, epoch: 2 | loss: 0.2345699
	speed: 0.0282s/iter; left time: 724.0769s
Epoch: 2 cost time: 9.106451749801636
Epoch: 2, Steps: 261 | Train Loss: 0.2540394 Vali Loss: 0.8137709 Test Loss: 0.4741741
Validation loss decreased (0.948432 --> 0.813771).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1896826
	speed: 0.1841s/iter; left time: 4690.4035s
	iters: 200, epoch: 3 | loss: 0.1916033
	speed: 0.0245s/iter; left time: 621.7839s
Epoch: 3 cost time: 9.462520122528076
Epoch: 3, Steps: 261 | Train Loss: 0.1961693 Vali Loss: 0.7571161 Test Loss: 0.4338191
Validation loss decreased (0.813771 --> 0.757116).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1697671
	speed: 0.2085s/iter; left time: 5256.9443s
	iters: 200, epoch: 4 | loss: 0.1582221
	speed: 0.0239s/iter; left time: 600.4445s
Epoch: 4 cost time: 8.665862798690796
Epoch: 4, Steps: 261 | Train Loss: 0.1682219 Vali Loss: 0.7272326 Test Loss: 0.4125431
Validation loss decreased (0.757116 --> 0.727233).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1530772
	speed: 0.1471s/iter; left time: 3670.1529s
	iters: 200, epoch: 5 | loss: 0.1436922
	speed: 0.0348s/iter; left time: 865.2186s
Epoch: 5 cost time: 10.880734920501709
Epoch: 5, Steps: 261 | Train Loss: 0.1525064 Vali Loss: 0.7103003 Test Loss: 0.3981883
Validation loss decreased (0.727233 --> 0.710300).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1562704
	speed: 0.1708s/iter; left time: 4217.1257s
	iters: 200, epoch: 6 | loss: 0.1359834
	speed: 0.0729s/iter; left time: 1794.1243s
Epoch: 6 cost time: 18.343119621276855
Epoch: 6, Steps: 261 | Train Loss: 0.1427931 Vali Loss: 0.6972016 Test Loss: 0.3876038
Validation loss decreased (0.710300 --> 0.697202).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1385564
	speed: 0.2099s/iter; left time: 5128.1987s
	iters: 200, epoch: 7 | loss: 0.1310717
	speed: 0.0296s/iter; left time: 719.2189s
Epoch: 7 cost time: 9.368679761886597
Epoch: 7, Steps: 261 | Train Loss: 0.1365454 Vali Loss: 0.6897520 Test Loss: 0.3818723
Validation loss decreased (0.697202 --> 0.689752).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1262835
	speed: 0.2144s/iter; left time: 5181.8479s
	iters: 200, epoch: 8 | loss: 0.1357465
	speed: 0.0640s/iter; left time: 1539.6626s
Epoch: 8 cost time: 17.16006898880005
Epoch: 8, Steps: 261 | Train Loss: 0.1322813 Vali Loss: 0.6833581 Test Loss: 0.3772418
Validation loss decreased (0.689752 --> 0.683358).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1258595
	speed: 0.1665s/iter; left time: 3981.9110s
	iters: 200, epoch: 9 | loss: 0.1333041
	speed: 0.0389s/iter; left time: 926.6663s
Epoch: 9 cost time: 10.750178337097168
Epoch: 9, Steps: 261 | Train Loss: 0.1294185 Vali Loss: 0.6797547 Test Loss: 0.3744968
Validation loss decreased (0.683358 --> 0.679755).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1264118
	speed: 0.1773s/iter; left time: 4194.2368s
	iters: 200, epoch: 10 | loss: 0.1221841
	speed: 0.0288s/iter; left time: 677.4216s
Epoch: 10 cost time: 9.055545330047607
Epoch: 10, Steps: 261 | Train Loss: 0.1273618 Vali Loss: 0.6773946 Test Loss: 0.3716117
Validation loss decreased (0.679755 --> 0.677395).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1374400
	speed: 0.1292s/iter; left time: 3022.0744s
	iters: 200, epoch: 11 | loss: 0.1282863
	speed: 0.0280s/iter; left time: 653.1018s
Epoch: 11 cost time: 8.498663425445557
Epoch: 11, Steps: 261 | Train Loss: 0.1259850 Vali Loss: 0.6757481 Test Loss: 0.3705913
Validation loss decreased (0.677395 --> 0.675748).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1310863
	speed: 0.1698s/iter; left time: 3926.6514s
	iters: 200, epoch: 12 | loss: 0.1201161
	speed: 0.0346s/iter; left time: 796.1298s
Epoch: 12 cost time: 9.631157875061035
Epoch: 12, Steps: 261 | Train Loss: 0.1249585 Vali Loss: 0.6742306 Test Loss: 0.3701120
Validation loss decreased (0.675748 --> 0.674231).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1151880
	speed: 0.1969s/iter; left time: 4503.4678s
	iters: 200, epoch: 13 | loss: 0.1262809
	speed: 0.0492s/iter; left time: 1120.0568s
Epoch: 13 cost time: 15.091283321380615
Epoch: 13, Steps: 261 | Train Loss: 0.1242226 Vali Loss: 0.6745595 Test Loss: 0.3700263
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1251664
	speed: 0.1686s/iter; left time: 3812.6559s
	iters: 200, epoch: 14 | loss: 0.1226373
	speed: 0.0359s/iter; left time: 807.0836s
Epoch: 14 cost time: 11.215367794036865
Epoch: 14, Steps: 261 | Train Loss: 0.1236689 Vali Loss: 0.6741203 Test Loss: 0.3694722
Validation loss decreased (0.674231 --> 0.674120).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1250534
	speed: 0.1693s/iter; left time: 3782.3992s
	iters: 200, epoch: 15 | loss: 0.1302675
	speed: 0.0379s/iter; left time: 843.1005s
Epoch: 15 cost time: 9.480806589126587
Epoch: 15, Steps: 261 | Train Loss: 0.1233471 Vali Loss: 0.6735479 Test Loss: 0.3697049
Validation loss decreased (0.674120 --> 0.673548).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1354622
	speed: 0.1752s/iter; left time: 3868.9881s
	iters: 200, epoch: 16 | loss: 0.1157276
	speed: 0.0363s/iter; left time: 798.6193s
Epoch: 16 cost time: 10.091483354568481
Epoch: 16, Steps: 261 | Train Loss: 0.1230981 Vali Loss: 0.6745432 Test Loss: 0.3700447
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1226736
	speed: 0.2451s/iter; left time: 5348.5763s
	iters: 200, epoch: 17 | loss: 0.1204632
	speed: 0.0537s/iter; left time: 1167.6683s
Epoch: 17 cost time: 19.405791759490967
Epoch: 17, Steps: 261 | Train Loss: 0.1229425 Vali Loss: 0.6735774 Test Loss: 0.3700477
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1222880
	speed: 0.2340s/iter; left time: 5046.2894s
	iters: 200, epoch: 18 | loss: 0.1259395
	speed: 0.0519s/iter; left time: 1113.0359s
Epoch: 18 cost time: 14.845304489135742
Epoch: 18, Steps: 261 | Train Loss: 0.1227868 Vali Loss: 0.6738514 Test Loss: 0.3702344
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1230650
	speed: 0.2235s/iter; left time: 4760.6902s
	iters: 200, epoch: 19 | loss: 0.1245169
	speed: 0.0348s/iter; left time: 738.2012s
Epoch: 19 cost time: 9.825057983398438
Epoch: 19, Steps: 261 | Train Loss: 0.1227564 Vali Loss: 0.6735694 Test Loss: 0.3709646
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1083828
	speed: 0.1677s/iter; left time: 3529.7912s
	iters: 200, epoch: 20 | loss: 0.1216360
	speed: 0.0455s/iter; left time: 953.4712s
Epoch: 20 cost time: 11.357421398162842
Epoch: 20, Steps: 261 | Train Loss: 0.1227182 Vali Loss: 0.6734893 Test Loss: 0.3708410
Validation loss decreased (0.673548 --> 0.673489).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1120459
	speed: 0.1777s/iter; left time: 3693.5320s
	iters: 200, epoch: 21 | loss: 0.1219934
	speed: 0.0454s/iter; left time: 939.7948s
Epoch: 21 cost time: 11.250995397567749
Epoch: 21, Steps: 261 | Train Loss: 0.1226963 Vali Loss: 0.6741430 Test Loss: 0.3708180
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1186620
	speed: 0.1580s/iter; left time: 3242.9411s
	iters: 200, epoch: 22 | loss: 0.1293757
	speed: 0.0323s/iter; left time: 659.0859s
Epoch: 22 cost time: 10.260953187942505
Epoch: 22, Steps: 261 | Train Loss: 0.1226711 Vali Loss: 0.6735297 Test Loss: 0.3712302
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1163977
	speed: 0.1890s/iter; left time: 3829.5662s
	iters: 200, epoch: 23 | loss: 0.1316154
	speed: 0.0437s/iter; left time: 880.1418s
Epoch: 23 cost time: 11.793558835983276
Epoch: 23, Steps: 261 | Train Loss: 0.1226361 Vali Loss: 0.6724531 Test Loss: 0.3715731
Validation loss decreased (0.673489 --> 0.672453).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1266935
	speed: 0.1569s/iter; left time: 3137.7792s
	iters: 200, epoch: 24 | loss: 0.1144139
	speed: 0.0411s/iter; left time: 817.2768s
Epoch: 24 cost time: 11.441086769104004
Epoch: 24, Steps: 261 | Train Loss: 0.1226132 Vali Loss: 0.6727369 Test Loss: 0.3716584
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1229118
	speed: 0.1593s/iter; left time: 3144.0474s
	iters: 200, epoch: 25 | loss: 0.1240307
	speed: 0.0356s/iter; left time: 698.5941s
Epoch: 25 cost time: 10.174089670181274
Epoch: 25, Steps: 261 | Train Loss: 0.1225778 Vali Loss: 0.6739259 Test Loss: 0.3714869
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1104549
	speed: 0.1466s/iter; left time: 2855.5628s
	iters: 200, epoch: 26 | loss: 0.1127406
	speed: 0.0262s/iter; left time: 506.7937s
Epoch: 26 cost time: 7.886574745178223
Epoch: 26, Steps: 261 | Train Loss: 0.1226130 Vali Loss: 0.6748793 Test Loss: 0.3716543
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1279766
	speed: 0.1365s/iter; left time: 2623.1689s
	iters: 200, epoch: 27 | loss: 0.1264734
	speed: 0.0238s/iter; left time: 454.9377s
Epoch: 27 cost time: 7.24927544593811
Epoch: 27, Steps: 261 | Train Loss: 0.1226229 Vali Loss: 0.6755819 Test Loss: 0.3715492
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1138452
	speed: 0.1457s/iter; left time: 2762.4474s
	iters: 200, epoch: 28 | loss: 0.1132124
	speed: 0.0464s/iter; left time: 875.1537s
Epoch: 28 cost time: 11.874758958816528
Epoch: 28, Steps: 261 | Train Loss: 0.1226210 Vali Loss: 0.6740486 Test Loss: 0.3716350
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1181851
	speed: 0.1661s/iter; left time: 3105.2015s
	iters: 200, epoch: 29 | loss: 0.1274717
	speed: 0.0285s/iter; left time: 530.0803s
Epoch: 29 cost time: 8.235083103179932
Epoch: 29, Steps: 261 | Train Loss: 0.1226336 Vali Loss: 0.6729278 Test Loss: 0.3718090
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1382225
	speed: 0.1485s/iter; left time: 2738.0532s
	iters: 200, epoch: 30 | loss: 0.1192813
	speed: 0.0259s/iter; left time: 474.8676s
Epoch: 30 cost time: 9.329552412033081
Epoch: 30, Steps: 261 | Train Loss: 0.1225946 Vali Loss: 0.6744161 Test Loss: 0.3717395
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1264315
	speed: 0.1700s/iter; left time: 3088.8438s
	iters: 200, epoch: 31 | loss: 0.1282944
	speed: 0.0335s/iter; left time: 605.6884s
Epoch: 31 cost time: 9.722279787063599
Epoch: 31, Steps: 261 | Train Loss: 0.1226239 Vali Loss: 0.6746479 Test Loss: 0.3720323
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1267874
	speed: 0.1586s/iter; left time: 2840.0976s
	iters: 200, epoch: 32 | loss: 0.1179086
	speed: 0.0316s/iter; left time: 562.3194s
Epoch: 32 cost time: 9.378090620040894
Epoch: 32, Steps: 261 | Train Loss: 0.1225901 Vali Loss: 0.6738761 Test Loss: 0.3717597
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1391697
	speed: 0.1986s/iter; left time: 3505.0376s
	iters: 200, epoch: 33 | loss: 0.1225371
	speed: 0.0533s/iter; left time: 934.6138s
Epoch: 33 cost time: 12.339040756225586
Epoch: 33, Steps: 261 | Train Loss: 0.1225814 Vali Loss: 0.6743612 Test Loss: 0.3718210
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1168074
	speed: 0.1406s/iter; left time: 2444.2401s
	iters: 200, epoch: 34 | loss: 0.1290936
	speed: 0.0588s/iter; left time: 1016.6610s
Epoch: 34 cost time: 14.458546876907349
Epoch: 34, Steps: 261 | Train Loss: 0.1225534 Vali Loss: 0.6740583 Test Loss: 0.3719319
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1380124
	speed: 0.1726s/iter; left time: 2956.1369s
	iters: 200, epoch: 35 | loss: 0.1255271
	speed: 0.0334s/iter; left time: 569.4262s
Epoch: 35 cost time: 9.360432863235474
Epoch: 35, Steps: 261 | Train Loss: 0.1225274 Vali Loss: 0.6740388 Test Loss: 0.3715981
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1160300
	speed: 0.1887s/iter; left time: 3183.2355s
	iters: 200, epoch: 36 | loss: 0.1295334
	speed: 0.0278s/iter; left time: 466.4740s
Epoch: 36 cost time: 9.93499755859375
Epoch: 36, Steps: 261 | Train Loss: 0.1226192 Vali Loss: 0.6738974 Test Loss: 0.3719384
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1356606
	speed: 0.1449s/iter; left time: 2406.1223s
	iters: 200, epoch: 37 | loss: 0.1238867
	speed: 0.0234s/iter; left time: 385.7630s
Epoch: 37 cost time: 7.280977010726929
Epoch: 37, Steps: 261 | Train Loss: 0.1226199 Vali Loss: 0.6736366 Test Loss: 0.3717720
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1277757
	speed: 0.1462s/iter; left time: 2388.9446s
	iters: 200, epoch: 38 | loss: 0.1341274
	speed: 0.0272s/iter; left time: 442.0273s
Epoch: 38 cost time: 8.602082967758179
Epoch: 38, Steps: 261 | Train Loss: 0.1225445 Vali Loss: 0.6740189 Test Loss: 0.3717017
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1203446
	speed: 0.1568s/iter; left time: 2522.5524s
	iters: 200, epoch: 39 | loss: 0.1219846
	speed: 0.0310s/iter; left time: 494.7628s
Epoch: 39 cost time: 9.703695058822632
Epoch: 39, Steps: 261 | Train Loss: 0.1225236 Vali Loss: 0.6740304 Test Loss: 0.3716701
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1265423
	speed: 0.1214s/iter; left time: 1920.8290s
	iters: 200, epoch: 40 | loss: 0.1287454
	speed: 0.0214s/iter; left time: 336.9232s
Epoch: 40 cost time: 6.560262203216553
Epoch: 40, Steps: 261 | Train Loss: 0.1225557 Vali Loss: 0.6741478 Test Loss: 0.3717813
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1181744
	speed: 0.1521s/iter; left time: 2367.4684s
	iters: 200, epoch: 41 | loss: 0.1190049
	speed: 0.0244s/iter; left time: 377.5297s
Epoch: 41 cost time: 8.023497581481934
Epoch: 41, Steps: 261 | Train Loss: 0.1226029 Vali Loss: 0.6741078 Test Loss: 0.3717992
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1218404
	speed: 0.1633s/iter; left time: 2498.5291s
	iters: 200, epoch: 42 | loss: 0.1150563
	speed: 0.0388s/iter; left time: 589.9198s
Epoch: 42 cost time: 9.257802486419678
Epoch: 42, Steps: 261 | Train Loss: 0.1225907 Vali Loss: 0.6730364 Test Loss: 0.3719193
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1258014
	speed: 0.1536s/iter; left time: 2310.3356s
	iters: 200, epoch: 43 | loss: 0.1225798
	speed: 0.0408s/iter; left time: 609.7974s
Epoch: 43 cost time: 10.198554039001465
Epoch: 43, Steps: 261 | Train Loss: 0.1225768 Vali Loss: 0.6738093 Test Loss: 0.3718318
EarlyStopping counter: 20 out of 20
Early stopping
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=90, out_features=132, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  10644480.0
params:  12012.0
Trainable parameters:  12012
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3349362
	speed: 0.0363s/iter; left time: 943.9919s
	iters: 200, epoch: 1 | loss: 0.3376660
	speed: 0.0355s/iter; left time: 919.4860s
Epoch: 1 cost time: 9.33742880821228
Epoch: 1, Steps: 261 | Train Loss: 0.3395815 Vali Loss: 0.6604470 Test Loss: 0.3685933
Validation loss decreased (inf --> 0.660447).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3293585
	speed: 0.1364s/iter; left time: 3511.7646s
	iters: 200, epoch: 2 | loss: 0.3604371
	speed: 0.0357s/iter; left time: 915.0779s
Epoch: 2 cost time: 9.953925132751465
Epoch: 2, Steps: 261 | Train Loss: 0.3382576 Vali Loss: 0.6587858 Test Loss: 0.3684508
Validation loss decreased (0.660447 --> 0.658786).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3245012
	speed: 0.1724s/iter; left time: 4392.0293s
	iters: 200, epoch: 3 | loss: 0.3410318
	speed: 0.0400s/iter; left time: 1015.0473s
Epoch: 3 cost time: 10.06171703338623
Epoch: 3, Steps: 261 | Train Loss: 0.3377227 Vali Loss: 0.6558540 Test Loss: 0.3678568
Validation loss decreased (0.658786 --> 0.655854).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3614329
	speed: 0.1519s/iter; left time: 3831.1945s
	iters: 200, epoch: 4 | loss: 0.3155379
	speed: 0.0273s/iter; left time: 686.7896s
Epoch: 4 cost time: 9.123517990112305
Epoch: 4, Steps: 261 | Train Loss: 0.3374353 Vali Loss: 0.6566045 Test Loss: 0.3676219
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3350407
	speed: 0.1571s/iter; left time: 3920.2575s
	iters: 200, epoch: 5 | loss: 0.3413340
	speed: 0.0377s/iter; left time: 936.2848s
Epoch: 5 cost time: 11.146352052688599
Epoch: 5, Steps: 261 | Train Loss: 0.3372547 Vali Loss: 0.6568725 Test Loss: 0.3676444
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3627149
	speed: 0.1634s/iter; left time: 4034.4743s
	iters: 200, epoch: 6 | loss: 0.3935682
	speed: 0.0309s/iter; left time: 761.2274s
Epoch: 6 cost time: 9.833049058914185
Epoch: 6, Steps: 261 | Train Loss: 0.3370853 Vali Loss: 0.6558573 Test Loss: 0.3676161
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2982149
	speed: 0.1664s/iter; left time: 4066.4029s
	iters: 200, epoch: 7 | loss: 0.3238657
	speed: 0.0300s/iter; left time: 730.1867s
Epoch: 7 cost time: 8.830774784088135
Epoch: 7, Steps: 261 | Train Loss: 0.3369440 Vali Loss: 0.6574083 Test Loss: 0.3674025
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3452390
	speed: 0.1412s/iter; left time: 3412.6051s
	iters: 200, epoch: 8 | loss: 0.3234159
	speed: 0.0291s/iter; left time: 699.5366s
Epoch: 8 cost time: 8.88544750213623
Epoch: 8, Steps: 261 | Train Loss: 0.3370193 Vali Loss: 0.6564791 Test Loss: 0.3677644
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3419487
	speed: 0.1769s/iter; left time: 4231.0756s
	iters: 200, epoch: 9 | loss: 0.3114180
	speed: 0.0351s/iter; left time: 836.7528s
Epoch: 9 cost time: 10.37765121459961
Epoch: 9, Steps: 261 | Train Loss: 0.3369469 Vali Loss: 0.6560373 Test Loss: 0.3672599
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3822051
	speed: 0.1497s/iter; left time: 3540.9851s
	iters: 200, epoch: 10 | loss: 0.3659261
	speed: 0.0319s/iter; left time: 751.7640s
Epoch: 10 cost time: 9.311630487442017
Epoch: 10, Steps: 261 | Train Loss: 0.3368604 Vali Loss: 0.6531708 Test Loss: 0.3680625
Validation loss decreased (0.655854 --> 0.653171).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3281665
	speed: 0.1602s/iter; left time: 3746.3433s
	iters: 200, epoch: 11 | loss: 0.3513393
	speed: 0.0346s/iter; left time: 806.8640s
Epoch: 11 cost time: 8.823223352432251
Epoch: 11, Steps: 261 | Train Loss: 0.3366739 Vali Loss: 0.6557710 Test Loss: 0.3673630
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3180870
	speed: 0.1535s/iter; left time: 3551.5734s
	iters: 200, epoch: 12 | loss: 0.3439853
	speed: 0.0278s/iter; left time: 639.2631s
Epoch: 12 cost time: 9.424010515213013
Epoch: 12, Steps: 261 | Train Loss: 0.3368362 Vali Loss: 0.6566065 Test Loss: 0.3674178
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3209157
	speed: 0.1607s/iter; left time: 3675.3062s
	iters: 200, epoch: 13 | loss: 0.3053190
	speed: 0.0353s/iter; left time: 803.5860s
Epoch: 13 cost time: 11.520460605621338
Epoch: 13, Steps: 261 | Train Loss: 0.3367973 Vali Loss: 0.6553707 Test Loss: 0.3678833
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3224779
	speed: 0.1931s/iter; left time: 4364.9573s
	iters: 200, epoch: 14 | loss: 0.3206165
	speed: 0.0327s/iter; left time: 736.9786s
Epoch: 14 cost time: 9.926974773406982
Epoch: 14, Steps: 261 | Train Loss: 0.3368156 Vali Loss: 0.6558645 Test Loss: 0.3676781
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3453644
	speed: 0.1313s/iter; left time: 2933.5672s
	iters: 200, epoch: 15 | loss: 0.3004695
	speed: 0.0306s/iter; left time: 680.3716s
Epoch: 15 cost time: 9.510135889053345
Epoch: 15, Steps: 261 | Train Loss: 0.3366494 Vali Loss: 0.6547035 Test Loss: 0.3673562
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3453777
	speed: 0.1641s/iter; left time: 3623.3323s
	iters: 200, epoch: 16 | loss: 0.3360114
	speed: 0.0325s/iter; left time: 714.7913s
Epoch: 16 cost time: 8.769610166549683
Epoch: 16, Steps: 261 | Train Loss: 0.3366921 Vali Loss: 0.6545393 Test Loss: 0.3674587
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3100533
	speed: 0.1621s/iter; left time: 3537.3605s
	iters: 200, epoch: 17 | loss: 0.3247858
	speed: 0.0298s/iter; left time: 646.4408s
Epoch: 17 cost time: 8.264430522918701
Epoch: 17, Steps: 261 | Train Loss: 0.3366198 Vali Loss: 0.6548153 Test Loss: 0.3680451
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3559676
	speed: 0.1348s/iter; left time: 2906.8304s
	iters: 200, epoch: 18 | loss: 0.3202463
	speed: 0.0279s/iter; left time: 598.2895s
Epoch: 18 cost time: 8.53180193901062
Epoch: 18, Steps: 261 | Train Loss: 0.3365437 Vali Loss: 0.6549129 Test Loss: 0.3677513
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3575417
	speed: 0.1666s/iter; left time: 3549.1211s
	iters: 200, epoch: 19 | loss: 0.3290242
	speed: 0.0273s/iter; left time: 578.6366s
Epoch: 19 cost time: 10.12278938293457
Epoch: 19, Steps: 261 | Train Loss: 0.3365121 Vali Loss: 0.6542712 Test Loss: 0.3676634
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3248029
	speed: 0.1667s/iter; left time: 3507.7111s
	iters: 200, epoch: 20 | loss: 0.3237803
	speed: 0.0291s/iter; left time: 610.1762s
Epoch: 20 cost time: 9.449524402618408
Epoch: 20, Steps: 261 | Train Loss: 0.3365666 Vali Loss: 0.6545732 Test Loss: 0.3676334
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3286911
	speed: 0.1442s/iter; left time: 2996.3120s
	iters: 200, epoch: 21 | loss: 0.3007632
	speed: 0.0339s/iter; left time: 701.7533s
Epoch: 21 cost time: 9.424993753433228
Epoch: 21, Steps: 261 | Train Loss: 0.3365136 Vali Loss: 0.6539082 Test Loss: 0.3675739
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3377372
	speed: 0.1500s/iter; left time: 3077.3839s
	iters: 200, epoch: 22 | loss: 0.3498264
	speed: 0.0460s/iter; left time: 939.2863s
Epoch: 22 cost time: 11.144408464431763
Epoch: 22, Steps: 261 | Train Loss: 0.3365961 Vali Loss: 0.6534144 Test Loss: 0.3674133
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3551449
	speed: 0.1869s/iter; left time: 3785.5649s
	iters: 200, epoch: 23 | loss: 0.3503228
	speed: 0.0371s/iter; left time: 747.2592s
Epoch: 23 cost time: 11.472202777862549
Epoch: 23, Steps: 261 | Train Loss: 0.3364987 Vali Loss: 0.6540745 Test Loss: 0.3675202
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3381282
	speed: 0.1510s/iter; left time: 3020.0850s
	iters: 200, epoch: 24 | loss: 0.3362041
	speed: 0.0323s/iter; left time: 643.4544s
Epoch: 24 cost time: 10.070425271987915
Epoch: 24, Steps: 261 | Train Loss: 0.3364293 Vali Loss: 0.6549466 Test Loss: 0.3674841
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3479598
	speed: 0.1455s/iter; left time: 2871.7720s
	iters: 200, epoch: 25 | loss: 0.3399318
	speed: 0.0287s/iter; left time: 563.1636s
Epoch: 25 cost time: 9.366509437561035
Epoch: 25, Steps: 261 | Train Loss: 0.3363738 Vali Loss: 0.6547191 Test Loss: 0.3673546
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3442995
	speed: 0.1551s/iter; left time: 3019.9286s
	iters: 200, epoch: 26 | loss: 0.3254516
	speed: 0.0325s/iter; left time: 629.4255s
Epoch: 26 cost time: 9.127026796340942
Epoch: 26, Steps: 261 | Train Loss: 0.3364043 Vali Loss: 0.6537284 Test Loss: 0.3673536
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3493282
	speed: 0.1764s/iter; left time: 3390.3105s
	iters: 200, epoch: 27 | loss: 0.3202899
	speed: 0.0443s/iter; left time: 847.0528s
Epoch: 27 cost time: 13.315286636352539
Epoch: 27, Steps: 261 | Train Loss: 0.3364818 Vali Loss: 0.6549920 Test Loss: 0.3674369
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2771012
	speed: 0.1320s/iter; left time: 2502.5077s
	iters: 200, epoch: 28 | loss: 0.3340067
	speed: 0.0300s/iter; left time: 565.4940s
Epoch: 28 cost time: 8.301906824111938
Epoch: 28, Steps: 261 | Train Loss: 0.3363577 Vali Loss: 0.6552150 Test Loss: 0.3672435
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3460566
	speed: 0.2108s/iter; left time: 3940.2846s
	iters: 200, epoch: 29 | loss: 0.3403830
	speed: 0.0357s/iter; left time: 664.2023s
Epoch: 29 cost time: 10.410950422286987
Epoch: 29, Steps: 261 | Train Loss: 0.3363977 Vali Loss: 0.6554118 Test Loss: 0.3673898
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3165065
	speed: 0.1997s/iter; left time: 3679.9932s
	iters: 200, epoch: 30 | loss: 0.3228577
	speed: 0.0379s/iter; left time: 694.2000s
Epoch: 30 cost time: 11.507977724075317
Epoch: 30, Steps: 261 | Train Loss: 0.3363798 Vali Loss: 0.6542437 Test Loss: 0.3673457
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3675863444805145, mae:0.3856939375400543, rse:0.5769364833831787, corr:[0.5393347  0.5481202  0.553332   0.5548149  0.5546215  0.5546704
 0.5555536  0.5570328  0.55852115 0.5594608  0.5598151  0.5597852
 0.55973613 0.55971295 0.55949277 0.5588376  0.5577154  0.5562816
 0.554723   0.55327666 0.55208737 0.55105305 0.54997563 0.54880303
 0.54734445 0.54583645 0.5445788  0.543775   0.54364145 0.5440798
 0.5447894  0.54549503 0.545891   0.5460274  0.5459497  0.5459635
 0.5459965  0.54602474 0.54595727 0.54563314 0.54517823 0.5446987
 0.54438317 0.54440725 0.5446438  0.5449127  0.54516745 0.54532635
 0.54532826 0.54518497 0.5450506  0.5449296  0.54481053 0.5445303
 0.544134   0.54374117 0.5434985  0.5434514  0.5436274  0.54381466
 0.54387033 0.5437307  0.5434014  0.54292613 0.5425758  0.54251707
 0.5427091  0.5429995  0.543232   0.54327595 0.5431434  0.54289275
 0.54261136 0.5424064  0.54235005 0.54236734 0.54234034 0.5422372
 0.542057   0.54183674 0.5416134  0.5413958  0.5411944  0.5409483
 0.54069316 0.54043984 0.540273   0.5402185  0.540322   0.54063284
 0.5410736  0.5415015  0.5417779  0.5418182  0.541609   0.5412094
 0.5407694  0.54046357 0.54021573 0.54003316 0.5398879  0.5397534
 0.53962135 0.53942806 0.5392329  0.5390918  0.5389038  0.53869104
 0.5384095  0.538111   0.53785664 0.53766567 0.5375544  0.5375184
 0.5374945  0.5374176  0.53723925 0.53693765 0.5365812  0.53630674
 0.5361645  0.5361358  0.53610456 0.53606474 0.535968   0.5357561
 0.535467   0.53523797 0.53512734 0.5351744  0.5352606  0.53528214
 0.53523034 0.53509665 0.5348668  0.53467256 0.53467625 0.53479767
 0.53502715 0.5353098  0.53547704 0.5355148  0.53549165 0.5355194
 0.5356745  0.535888   0.53612995 0.5362959  0.53635305 0.536228
 0.53594255 0.5356652  0.53549474 0.53548896 0.5355997  0.5358276
 0.536064   0.53620875 0.53630906 0.53633606 0.53643394 0.53663576
 0.53693146 0.5372001  0.5373494  0.5373331  0.53720623 0.53708535
 0.5370131  0.53698725 0.53706    0.5371914  0.5372562  0.537222
 0.5371294  0.53705627 0.5370633  0.53717285 0.53730947 0.53742355
 0.53742653 0.53729725 0.5370193  0.53674954 0.53661996 0.5366938
 0.536961   0.5373787  0.53784066 0.53820497 0.5383712  0.538339
 0.5381149  0.5378384  0.5374827  0.5370216  0.5364774  0.5359088
 0.53529775 0.5346478  0.53396    0.5332721  0.53259957 0.5319532
 0.53136057 0.5308054  0.5302546  0.52971673 0.5291709  0.5285778
 0.5279041  0.5272064  0.52652377 0.5259     0.52528936 0.5247678
 0.52438176 0.5240717  0.52384096 0.52362466 0.5234268  0.5233074
 0.5233377  0.5233864  0.52343684 0.52346563 0.5234271  0.5233601
 0.5233338  0.52340233 0.5235714  0.52375335 0.5239188  0.52405894
 0.52415884 0.5242759  0.5243046  0.5244038  0.52454865 0.52477914
 0.5250243  0.525112   0.5250504  0.52491915 0.52480584 0.52467066
 0.5245058  0.52434486 0.5241842  0.5240834  0.5239918  0.5239835
 0.5239862  0.5240735  0.52417254 0.5242401  0.5242854  0.52432436
 0.52437043 0.5244454  0.52451074 0.5245359  0.5245084  0.524514
 0.52449465 0.5244348  0.5243358  0.52424175 0.5241711  0.5241056
 0.5241064  0.5241631  0.52427775 0.52444375 0.52461    0.52474356
 0.5247708  0.52475137 0.524654   0.5245868  0.5245568  0.5245701
 0.5246567  0.52477545 0.52483106 0.52478665 0.5245885  0.52417624
 0.52359456 0.5230081  0.5224884  0.52197886 0.52149564 0.5210279
 0.5205721  0.52003425 0.5194509  0.5187528  0.51793736 0.5170679
 0.5161976  0.5154435  0.5149423  0.5147056  0.51466364 0.5146667
 0.5147108  0.5146438  0.5144317  0.51412266 0.51387703 0.51373273
 0.5137146  0.5138314  0.5139511  0.5139993  0.5139452  0.51386815
 0.51380914 0.5137404  0.5136672  0.5135845  0.5134722  0.51333016
 0.5131792  0.51311    0.5130645  0.5130062  0.5128179  0.51245636
 0.51210755 0.511957   0.5120649  0.51213336 0.5111676  0.50697   ]
