Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=90, out_features=132, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  10644480.0
params:  12012.0
Trainable parameters:  12012
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3997598
	speed: 0.0376s/iter; left time: 977.2376s
	iters: 200, epoch: 1 | loss: 0.4264095
	speed: 0.0272s/iter; left time: 705.1646s
Epoch: 1 cost time: 8.864067316055298
Epoch: 1, Steps: 261 | Train Loss: 0.4356930 Vali Loss: 0.7316960 Test Loss: 0.3863291
Validation loss decreased (inf --> 0.731696).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3499643
	speed: 0.1459s/iter; left time: 3755.9771s
	iters: 200, epoch: 2 | loss: 0.3656686
	speed: 0.0316s/iter; left time: 811.2629s
Epoch: 2 cost time: 9.370472431182861
Epoch: 2, Steps: 261 | Train Loss: 0.3498434 Vali Loss: 0.6869863 Test Loss: 0.3670966
Validation loss decreased (0.731696 --> 0.686986).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3158378
	speed: 0.1489s/iter; left time: 3792.9896s
	iters: 200, epoch: 3 | loss: 0.3431299
	speed: 0.0306s/iter; left time: 776.1554s
Epoch: 3 cost time: 9.170456886291504
Epoch: 3, Steps: 261 | Train Loss: 0.3418752 Vali Loss: 0.6753441 Test Loss: 0.3665044
Validation loss decreased (0.686986 --> 0.675344).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3396544
	speed: 0.1495s/iter; left time: 3768.8960s
	iters: 200, epoch: 4 | loss: 0.3258844
	speed: 0.0298s/iter; left time: 748.8101s
Epoch: 4 cost time: 9.036926507949829
Epoch: 4, Steps: 261 | Train Loss: 0.3396691 Vali Loss: 0.6677686 Test Loss: 0.3669283
Validation loss decreased (0.675344 --> 0.667769).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3380521
	speed: 0.1540s/iter; left time: 3842.8972s
	iters: 200, epoch: 5 | loss: 0.3240921
	speed: 0.0293s/iter; left time: 728.9263s
Epoch: 5 cost time: 8.721434354782104
Epoch: 5, Steps: 261 | Train Loss: 0.3387792 Vali Loss: 0.6660562 Test Loss: 0.3673131
Validation loss decreased (0.667769 --> 0.666056).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3692735
	speed: 0.1699s/iter; left time: 4195.3584s
	iters: 200, epoch: 6 | loss: 0.3221997
	speed: 0.0391s/iter; left time: 961.9829s
Epoch: 6 cost time: 9.885712623596191
Epoch: 6, Steps: 261 | Train Loss: 0.3381792 Vali Loss: 0.6630241 Test Loss: 0.3672024
Validation loss decreased (0.666056 --> 0.663024).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3440205
	speed: 0.1574s/iter; left time: 3846.8003s
	iters: 200, epoch: 7 | loss: 0.3282187
	speed: 0.0335s/iter; left time: 814.6975s
Epoch: 7 cost time: 9.270554542541504
Epoch: 7, Steps: 261 | Train Loss: 0.3379415 Vali Loss: 0.6607148 Test Loss: 0.3671075
Validation loss decreased (0.663024 --> 0.660715).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3124785
	speed: 0.1454s/iter; left time: 3515.8368s
	iters: 200, epoch: 8 | loss: 0.3553853
	speed: 0.0354s/iter; left time: 852.2231s
Epoch: 8 cost time: 9.972990989685059
Epoch: 8, Steps: 261 | Train Loss: 0.3375469 Vali Loss: 0.6590216 Test Loss: 0.3672790
Validation loss decreased (0.660715 --> 0.659022).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3232670
	speed: 0.1492s/iter; left time: 3568.2737s
	iters: 200, epoch: 9 | loss: 0.3489716
	speed: 0.0384s/iter; left time: 913.9255s
Epoch: 9 cost time: 10.485069513320923
Epoch: 9, Steps: 261 | Train Loss: 0.3374471 Vali Loss: 0.6576831 Test Loss: 0.3673203
Validation loss decreased (0.659022 --> 0.657683).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3376585
	speed: 0.1595s/iter; left time: 3772.5610s
	iters: 200, epoch: 10 | loss: 0.3218009
	speed: 0.0302s/iter; left time: 710.3823s
Epoch: 10 cost time: 9.440557956695557
Epoch: 10, Steps: 261 | Train Loss: 0.3371791 Vali Loss: 0.6580114 Test Loss: 0.3669146
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3694895
	speed: 0.1408s/iter; left time: 3292.8415s
	iters: 200, epoch: 11 | loss: 0.3429027
	speed: 0.0323s/iter; left time: 751.4394s
Epoch: 11 cost time: 9.73835825920105
Epoch: 11, Steps: 261 | Train Loss: 0.3372541 Vali Loss: 0.6575335 Test Loss: 0.3672732
Validation loss decreased (0.657683 --> 0.657534).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3536759
	speed: 0.1497s/iter; left time: 3461.6611s
	iters: 200, epoch: 12 | loss: 0.3249513
	speed: 0.0317s/iter; left time: 729.5566s
Epoch: 12 cost time: 9.311908483505249
Epoch: 12, Steps: 261 | Train Loss: 0.3371314 Vali Loss: 0.6561733 Test Loss: 0.3671923
Validation loss decreased (0.657534 --> 0.656173).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3105726
	speed: 0.1372s/iter; left time: 3138.5503s
	iters: 200, epoch: 13 | loss: 0.3470247
	speed: 0.0342s/iter; left time: 779.6272s
Epoch: 13 cost time: 9.886280059814453
Epoch: 13, Steps: 261 | Train Loss: 0.3370489 Vali Loss: 0.6569663 Test Loss: 0.3672459
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3449059
	speed: 0.1401s/iter; left time: 3166.7513s
	iters: 200, epoch: 14 | loss: 0.3358499
	speed: 0.0320s/iter; left time: 720.3480s
Epoch: 14 cost time: 9.288352251052856
Epoch: 14, Steps: 261 | Train Loss: 0.3368409 Vali Loss: 0.6567896 Test Loss: 0.3670090
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3416530
	speed: 0.1544s/iter; left time: 3451.1746s
	iters: 200, epoch: 15 | loss: 0.3536575
	speed: 0.0322s/iter; left time: 716.9315s
Epoch: 15 cost time: 10.097083330154419
Epoch: 15, Steps: 261 | Train Loss: 0.3369148 Vali Loss: 0.6562234 Test Loss: 0.3672912
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3732880
	speed: 0.1586s/iter; left time: 3503.0212s
	iters: 200, epoch: 16 | loss: 0.3172549
	speed: 0.0338s/iter; left time: 743.9464s
Epoch: 16 cost time: 9.85044240951538
Epoch: 16, Steps: 261 | Train Loss: 0.3368584 Vali Loss: 0.6571595 Test Loss: 0.3673356
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3356985
	speed: 0.1514s/iter; left time: 3304.2050s
	iters: 200, epoch: 17 | loss: 0.3351428
	speed: 0.0359s/iter; left time: 780.3073s
Epoch: 17 cost time: 10.316330194473267
Epoch: 17, Steps: 261 | Train Loss: 0.3368663 Vali Loss: 0.6558615 Test Loss: 0.3670771
Validation loss decreased (0.656173 --> 0.655861).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3361035
	speed: 0.1624s/iter; left time: 3502.6888s
	iters: 200, epoch: 18 | loss: 0.3467416
	speed: 0.0383s/iter; left time: 821.2643s
Epoch: 18 cost time: 11.338403940200806
Epoch: 18, Steps: 261 | Train Loss: 0.3366805 Vali Loss: 0.6559356 Test Loss: 0.3671573
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3370283
	speed: 0.1603s/iter; left time: 3414.9678s
	iters: 200, epoch: 19 | loss: 0.3385619
	speed: 0.0341s/iter; left time: 723.8080s
Epoch: 19 cost time: 9.884787559509277
Epoch: 19, Steps: 261 | Train Loss: 0.3367849 Vali Loss: 0.6554039 Test Loss: 0.3674131
Validation loss decreased (0.655861 --> 0.655404).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2940300
	speed: 0.1761s/iter; left time: 3705.0165s
	iters: 200, epoch: 20 | loss: 0.3331835
	speed: 0.0292s/iter; left time: 611.3193s
Epoch: 20 cost time: 10.402747631072998
Epoch: 20, Steps: 261 | Train Loss: 0.3367812 Vali Loss: 0.6553353 Test Loss: 0.3671223
Validation loss decreased (0.655404 --> 0.655335).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3017411
	speed: 0.1568s/iter; left time: 3257.8166s
	iters: 200, epoch: 21 | loss: 0.3345756
	speed: 0.0303s/iter; left time: 626.0900s
Epoch: 21 cost time: 8.632875442504883
Epoch: 21, Steps: 261 | Train Loss: 0.3367627 Vali Loss: 0.6559901 Test Loss: 0.3671480
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3209586
	speed: 0.1626s/iter; left time: 3336.5952s
	iters: 200, epoch: 22 | loss: 0.3599361
	speed: 0.0444s/iter; left time: 906.2851s
Epoch: 22 cost time: 10.321547746658325
Epoch: 22, Steps: 261 | Train Loss: 0.3367043 Vali Loss: 0.6551584 Test Loss: 0.3673025
Validation loss decreased (0.655335 --> 0.655158).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3192802
	speed: 0.1911s/iter; left time: 3872.3863s
	iters: 200, epoch: 23 | loss: 0.3629032
	speed: 0.0341s/iter; left time: 686.6138s
Epoch: 23 cost time: 11.058719158172607
Epoch: 23, Steps: 261 | Train Loss: 0.3366208 Vali Loss: 0.6540709 Test Loss: 0.3673789
Validation loss decreased (0.655158 --> 0.654071).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3493372
	speed: 0.1600s/iter; left time: 3199.0699s
	iters: 200, epoch: 24 | loss: 0.3112039
	speed: 0.0312s/iter; left time: 621.2422s
Epoch: 24 cost time: 10.053191184997559
Epoch: 24, Steps: 261 | Train Loss: 0.3365607 Vali Loss: 0.6541777 Test Loss: 0.3672981
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3396844
	speed: 0.1390s/iter; left time: 2742.7678s
	iters: 200, epoch: 25 | loss: 0.3430215
	speed: 0.0334s/iter; left time: 656.4401s
Epoch: 25 cost time: 8.927847146987915
Epoch: 25, Steps: 261 | Train Loss: 0.3364336 Vali Loss: 0.6552593 Test Loss: 0.3671715
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2993931
	speed: 0.1571s/iter; left time: 3060.2295s
	iters: 200, epoch: 26 | loss: 0.3085206
	speed: 0.0421s/iter; left time: 815.4484s
Epoch: 26 cost time: 10.294288396835327
Epoch: 26, Steps: 261 | Train Loss: 0.3365447 Vali Loss: 0.6560663 Test Loss: 0.3673067
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3535695
	speed: 0.1464s/iter; left time: 2813.8240s
	iters: 200, epoch: 27 | loss: 0.3534655
	speed: 0.0265s/iter; left time: 505.8041s
Epoch: 27 cost time: 9.546415090560913
Epoch: 27, Steps: 261 | Train Loss: 0.3365721 Vali Loss: 0.6565163 Test Loss: 0.3670302
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3072985
	speed: 0.2037s/iter; left time: 3861.5610s
	iters: 200, epoch: 28 | loss: 0.3080673
	speed: 0.0281s/iter; left time: 529.5604s
Epoch: 28 cost time: 11.343320369720459
Epoch: 28, Steps: 261 | Train Loss: 0.3365646 Vali Loss: 0.6551946 Test Loss: 0.3671582
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3267155
	speed: 0.1619s/iter; left time: 3025.5515s
	iters: 200, epoch: 29 | loss: 0.3560240
	speed: 0.0364s/iter; left time: 677.0749s
Epoch: 29 cost time: 9.383845090866089
Epoch: 29, Steps: 261 | Train Loss: 0.3365966 Vali Loss: 0.6540201 Test Loss: 0.3673538
Validation loss decreased (0.654071 --> 0.654020).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3864340
	speed: 0.1443s/iter; left time: 2659.1219s
	iters: 200, epoch: 30 | loss: 0.3309503
	speed: 0.0354s/iter; left time: 648.2165s
Epoch: 30 cost time: 9.858352184295654
Epoch: 30, Steps: 261 | Train Loss: 0.3364891 Vali Loss: 0.6554292 Test Loss: 0.3672681
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3508887
	speed: 0.1886s/iter; left time: 3426.2449s
	iters: 200, epoch: 31 | loss: 0.3540375
	speed: 0.0326s/iter; left time: 589.9162s
Epoch: 31 cost time: 9.968696117401123
Epoch: 31, Steps: 261 | Train Loss: 0.3365576 Vali Loss: 0.6555149 Test Loss: 0.3675351
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3507004
	speed: 0.1584s/iter; left time: 2836.1799s
	iters: 200, epoch: 32 | loss: 0.3223750
	speed: 0.0382s/iter; left time: 680.8441s
Epoch: 32 cost time: 11.256717681884766
Epoch: 32, Steps: 261 | Train Loss: 0.3364489 Vali Loss: 0.6547884 Test Loss: 0.3673078
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3889482
	speed: 0.2067s/iter; left time: 3648.1840s
	iters: 200, epoch: 33 | loss: 0.3363044
	speed: 0.0416s/iter; left time: 730.8250s
Epoch: 33 cost time: 11.179065227508545
Epoch: 33, Steps: 261 | Train Loss: 0.3364143 Vali Loss: 0.6553040 Test Loss: 0.3673176
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3193648
	speed: 0.1649s/iter; left time: 2868.1304s
	iters: 200, epoch: 34 | loss: 0.3583193
	speed: 0.0292s/iter; left time: 504.0355s
Epoch: 34 cost time: 10.666301727294922
Epoch: 34, Steps: 261 | Train Loss: 0.3363283 Vali Loss: 0.6548117 Test Loss: 0.3673867
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3824832
	speed: 0.1803s/iter; left time: 3087.3283s
	iters: 200, epoch: 35 | loss: 0.3415251
	speed: 0.0386s/iter; left time: 656.5675s
Epoch: 35 cost time: 9.449231386184692
Epoch: 35, Steps: 261 | Train Loss: 0.3362427 Vali Loss: 0.6548104 Test Loss: 0.3670760
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3149511
	speed: 0.1510s/iter; left time: 2546.1190s
	iters: 200, epoch: 36 | loss: 0.3579183
	speed: 0.0276s/iter; left time: 462.2985s
Epoch: 36 cost time: 8.427230834960938
Epoch: 36, Steps: 261 | Train Loss: 0.3365247 Vali Loss: 0.6546525 Test Loss: 0.3673756
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3798676
	speed: 0.2328s/iter; left time: 3866.4197s
	iters: 200, epoch: 37 | loss: 0.3397287
	speed: 0.0302s/iter; left time: 498.6264s
Epoch: 37 cost time: 10.614700078964233
Epoch: 37, Steps: 261 | Train Loss: 0.3365338 Vali Loss: 0.6544828 Test Loss: 0.3672031
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3548236
	speed: 0.1425s/iter; left time: 2329.1806s
	iters: 200, epoch: 38 | loss: 0.3704859
	speed: 0.0310s/iter; left time: 503.4420s
Epoch: 38 cost time: 9.512685298919678
Epoch: 38, Steps: 261 | Train Loss: 0.3362830 Vali Loss: 0.6547993 Test Loss: 0.3672082
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3343406
	speed: 0.1684s/iter; left time: 2707.5937s
	iters: 200, epoch: 39 | loss: 0.3366052
	speed: 0.0354s/iter; left time: 565.0948s
Epoch: 39 cost time: 9.90597677230835
Epoch: 39, Steps: 261 | Train Loss: 0.3362331 Vali Loss: 0.6548984 Test Loss: 0.3671633
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3508439
	speed: 0.1676s/iter; left time: 2651.6120s
	iters: 200, epoch: 40 | loss: 0.3567200
	speed: 0.0303s/iter; left time: 476.9933s
Epoch: 40 cost time: 10.02577018737793
Epoch: 40, Steps: 261 | Train Loss: 0.3363099 Vali Loss: 0.6549618 Test Loss: 0.3673202
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3236659
	speed: 0.1411s/iter; left time: 2196.1199s
	iters: 200, epoch: 41 | loss: 0.3250732
	speed: 0.0374s/iter; left time: 577.8121s
Epoch: 41 cost time: 9.649420976638794
Epoch: 41, Steps: 261 | Train Loss: 0.3364784 Vali Loss: 0.6548560 Test Loss: 0.3672938
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3342008
	speed: 0.1671s/iter; left time: 2555.9671s
	iters: 200, epoch: 42 | loss: 0.3106955
	speed: 0.0340s/iter; left time: 516.9275s
Epoch: 42 cost time: 10.872132062911987
Epoch: 42, Steps: 261 | Train Loss: 0.3364253 Vali Loss: 0.6538649 Test Loss: 0.3673814
Validation loss decreased (0.654020 --> 0.653865).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3433924
	speed: 0.1488s/iter; left time: 2238.3120s
	iters: 200, epoch: 43 | loss: 0.3347555
	speed: 0.0416s/iter; left time: 622.1879s
Epoch: 43 cost time: 9.822540044784546
Epoch: 43, Steps: 261 | Train Loss: 0.3363755 Vali Loss: 0.6545046 Test Loss: 0.3673258
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.3487246
	speed: 0.1857s/iter; left time: 2744.6634s
	iters: 200, epoch: 44 | loss: 0.3549477
	speed: 0.0345s/iter; left time: 506.1244s
Epoch: 44 cost time: 11.081636428833008
Epoch: 44, Steps: 261 | Train Loss: 0.3364705 Vali Loss: 0.6544043 Test Loss: 0.3673182
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.3661554
	speed: 0.1664s/iter; left time: 2415.8867s
	iters: 200, epoch: 45 | loss: 0.3751983
	speed: 0.0504s/iter; left time: 726.4942s
Epoch: 45 cost time: 11.65579891204834
Epoch: 45, Steps: 261 | Train Loss: 0.3361574 Vali Loss: 0.6545687 Test Loss: 0.3672294
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.3257304
	speed: 0.1435s/iter; left time: 2046.1115s
	iters: 200, epoch: 46 | loss: 0.3408862
	speed: 0.0400s/iter; left time: 566.3152s
Epoch: 46 cost time: 10.929457426071167
Epoch: 46, Steps: 261 | Train Loss: 0.3363420 Vali Loss: 0.6549501 Test Loss: 0.3672456
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3384412
	speed: 0.1845s/iter; left time: 2582.3696s
	iters: 200, epoch: 47 | loss: 0.3393667
	speed: 0.0316s/iter; left time: 438.9209s
Epoch: 47 cost time: 10.227619409561157
Epoch: 47, Steps: 261 | Train Loss: 0.3363191 Vali Loss: 0.6540817 Test Loss: 0.3672620
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3188335
	speed: 0.2295s/iter; left time: 3152.4012s
	iters: 200, epoch: 48 | loss: 0.3457421
	speed: 0.0268s/iter; left time: 364.7798s
Epoch: 48 cost time: 9.038582801818848
Epoch: 48, Steps: 261 | Train Loss: 0.3364070 Vali Loss: 0.6547201 Test Loss: 0.3672642
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.3332053
	speed: 0.1877s/iter; left time: 2528.6896s
	iters: 200, epoch: 49 | loss: 0.3339696
	speed: 0.0398s/iter; left time: 532.5420s
Epoch: 49 cost time: 10.881556510925293
Epoch: 49, Steps: 261 | Train Loss: 0.3363043 Vali Loss: 0.6547896 Test Loss: 0.3673567
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.3515122
	speed: 0.1363s/iter; left time: 1800.7410s
	iters: 200, epoch: 50 | loss: 0.2847561
	speed: 0.0319s/iter; left time: 417.7860s
Epoch: 50 cost time: 9.243997812271118
Epoch: 50, Steps: 261 | Train Loss: 0.3362892 Vali Loss: 0.6545920 Test Loss: 0.3673074
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.3092211
	speed: 0.1486s/iter; left time: 1924.8946s
	iters: 200, epoch: 51 | loss: 0.3014016
	speed: 0.0278s/iter; left time: 356.6832s
Epoch: 51 cost time: 8.28483510017395
Epoch: 51, Steps: 261 | Train Loss: 0.3363758 Vali Loss: 0.6546469 Test Loss: 0.3673028
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.3457532
	speed: 0.1518s/iter; left time: 1926.1257s
	iters: 200, epoch: 52 | loss: 0.3327548
	speed: 0.0281s/iter; left time: 353.1506s
Epoch: 52 cost time: 9.603585958480835
Epoch: 52, Steps: 261 | Train Loss: 0.3362383 Vali Loss: 0.6545499 Test Loss: 0.3673009
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.3372785
	speed: 0.1550s/iter; left time: 1926.4924s
	iters: 200, epoch: 53 | loss: 0.3165401
	speed: 0.0335s/iter; left time: 413.5791s
Epoch: 53 cost time: 10.56302523612976
Epoch: 53, Steps: 261 | Train Loss: 0.3364018 Vali Loss: 0.6552832 Test Loss: 0.3672650
EarlyStopping counter: 11 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.3087731
	speed: 0.1730s/iter; left time: 2105.2029s
	iters: 200, epoch: 54 | loss: 0.3656197
	speed: 0.0385s/iter; left time: 465.1525s
Epoch: 54 cost time: 10.256503343582153
Epoch: 54, Steps: 261 | Train Loss: 0.3362811 Vali Loss: 0.6538622 Test Loss: 0.3673864
Validation loss decreased (0.653865 --> 0.653862).  Saving model ...
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.3007151
	speed: 0.1537s/iter; left time: 1830.0998s
	iters: 200, epoch: 55 | loss: 0.3220351
	speed: 0.0243s/iter; left time: 286.6178s
Epoch: 55 cost time: 9.01793622970581
Epoch: 55, Steps: 261 | Train Loss: 0.3363467 Vali Loss: 0.6547783 Test Loss: 0.3673000
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3230060
	speed: 0.1661s/iter; left time: 1934.7200s
	iters: 200, epoch: 56 | loss: 0.3634664
	speed: 0.0398s/iter; left time: 459.5862s
Epoch: 56 cost time: 10.799574851989746
Epoch: 56, Steps: 261 | Train Loss: 0.3362912 Vali Loss: 0.6552983 Test Loss: 0.3673466
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3467349
	speed: 0.1334s/iter; left time: 1518.9932s
	iters: 200, epoch: 57 | loss: 0.3289734
	speed: 0.0333s/iter; left time: 376.2002s
Epoch: 57 cost time: 9.153075695037842
Epoch: 57, Steps: 261 | Train Loss: 0.3363627 Vali Loss: 0.6549158 Test Loss: 0.3673231
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3244621
	speed: 0.1666s/iter; left time: 1853.6122s
	iters: 200, epoch: 58 | loss: 0.3475167
	speed: 0.0480s/iter; left time: 529.5322s
Epoch: 58 cost time: 11.414671897888184
Epoch: 58, Steps: 261 | Train Loss: 0.3363234 Vali Loss: 0.6549694 Test Loss: 0.3672788
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.3198465
	speed: 0.1457s/iter; left time: 1582.9411s
	iters: 200, epoch: 59 | loss: 0.3318508
	speed: 0.0410s/iter; left time: 441.3162s
Epoch: 59 cost time: 10.19270396232605
Epoch: 59, Steps: 261 | Train Loss: 0.3361950 Vali Loss: 0.6545829 Test Loss: 0.3672265
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.3234651
	speed: 0.1545s/iter; left time: 1637.9949s
	iters: 200, epoch: 60 | loss: 0.3411553
	speed: 0.0299s/iter; left time: 314.0035s
Epoch: 60 cost time: 9.135069847106934
Epoch: 60, Steps: 261 | Train Loss: 0.3363448 Vali Loss: 0.6550188 Test Loss: 0.3673110
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.3275455
	speed: 0.1499s/iter; left time: 1550.1483s
	iters: 200, epoch: 61 | loss: 0.3525345
	speed: 0.0291s/iter; left time: 298.1896s
Epoch: 61 cost time: 7.49295973777771
Epoch: 61, Steps: 261 | Train Loss: 0.3361666 Vali Loss: 0.6547796 Test Loss: 0.3673055
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3525621
	speed: 0.1507s/iter; left time: 1518.8577s
	iters: 200, epoch: 62 | loss: 0.3238030
	speed: 0.0381s/iter; left time: 380.6628s
Epoch: 62 cost time: 12.949522018432617
Epoch: 62, Steps: 261 | Train Loss: 0.3362749 Vali Loss: 0.6543068 Test Loss: 0.3673090
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.3775852
	speed: 0.2203s/iter; left time: 2162.7082s
	iters: 200, epoch: 63 | loss: 0.3696627
	speed: 0.0332s/iter; left time: 323.1292s
Epoch: 63 cost time: 10.152187585830688
Epoch: 63, Steps: 261 | Train Loss: 0.3362757 Vali Loss: 0.6545333 Test Loss: 0.3673130
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.3469158
	speed: 0.1750s/iter; left time: 1672.7292s
	iters: 200, epoch: 64 | loss: 0.3598074
	speed: 0.0391s/iter; left time: 369.9485s
Epoch: 64 cost time: 11.943385362625122
Epoch: 64, Steps: 261 | Train Loss: 0.3363478 Vali Loss: 0.6545522 Test Loss: 0.3673030
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.3591116
	speed: 0.1849s/iter; left time: 1719.3384s
	iters: 200, epoch: 65 | loss: 0.3322184
	speed: 0.0392s/iter; left time: 360.2253s
Epoch: 65 cost time: 11.035911560058594
Epoch: 65, Steps: 261 | Train Loss: 0.3362860 Vali Loss: 0.6540588 Test Loss: 0.3673147
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.3449028
	speed: 0.1634s/iter; left time: 1476.0721s
	iters: 200, epoch: 66 | loss: 0.3126129
	speed: 0.0403s/iter; left time: 360.2277s
Epoch: 66 cost time: 10.191170930862427
Epoch: 66, Steps: 261 | Train Loss: 0.3362771 Vali Loss: 0.6545085 Test Loss: 0.3672882
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.3173009
	speed: 0.1302s/iter; left time: 1142.7537s
	iters: 200, epoch: 67 | loss: 0.3042102
	speed: 0.0321s/iter; left time: 278.1388s
Epoch: 67 cost time: 10.077131509780884
Epoch: 67, Steps: 261 | Train Loss: 0.3362025 Vali Loss: 0.6547680 Test Loss: 0.3673057
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.2951638
	speed: 0.1322s/iter; left time: 1125.1385s
	iters: 200, epoch: 68 | loss: 0.3239415
	speed: 0.0274s/iter; left time: 230.3830s
Epoch: 68 cost time: 7.791156530380249
Epoch: 68, Steps: 261 | Train Loss: 0.3363237 Vali Loss: 0.6552791 Test Loss: 0.3673280
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.3241324
	speed: 0.1402s/iter; left time: 1157.2738s
	iters: 200, epoch: 69 | loss: 0.3442565
	speed: 0.0345s/iter; left time: 281.3429s
Epoch: 69 cost time: 10.500736474990845
Epoch: 69, Steps: 261 | Train Loss: 0.3363079 Vali Loss: 0.6552003 Test Loss: 0.3673064
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.3635091
	speed: 0.1710s/iter; left time: 1366.4384s
	iters: 200, epoch: 70 | loss: 0.3236461
	speed: 0.0323s/iter; left time: 254.9773s
Epoch: 70 cost time: 10.273192405700684
Epoch: 70, Steps: 261 | Train Loss: 0.3362917 Vali Loss: 0.6548055 Test Loss: 0.3673400
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.3470927
	speed: 0.1863s/iter; left time: 1440.4942s
	iters: 200, epoch: 71 | loss: 0.3360717
	speed: 0.0323s/iter; left time: 246.1435s
Epoch: 71 cost time: 9.684452056884766
Epoch: 71, Steps: 261 | Train Loss: 0.3362353 Vali Loss: 0.6539062 Test Loss: 0.3673090
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.3211278
	speed: 0.1569s/iter; left time: 1171.8511s
	iters: 200, epoch: 72 | loss: 0.3650726
	speed: 0.0312s/iter; left time: 229.9144s
Epoch: 72 cost time: 8.90078067779541
Epoch: 72, Steps: 261 | Train Loss: 0.3362190 Vali Loss: 0.6543813 Test Loss: 0.3673149
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.3039278
	speed: 0.1447s/iter; left time: 1043.4359s
	iters: 200, epoch: 73 | loss: 0.4053009
	speed: 0.0333s/iter; left time: 236.4951s
Epoch: 73 cost time: 9.960833549499512
Epoch: 73, Steps: 261 | Train Loss: 0.3363964 Vali Loss: 0.6540151 Test Loss: 0.3673140
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.3380896
	speed: 0.1386s/iter; left time: 963.2339s
	iters: 200, epoch: 74 | loss: 0.3401878
	speed: 0.0416s/iter; left time: 285.0334s
Epoch: 74 cost time: 10.081299066543579
Epoch: 74, Steps: 261 | Train Loss: 0.3361902 Vali Loss: 0.6546167 Test Loss: 0.3673138
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.36687251925468445, mae:0.38512924313545227, rse:0.5763760209083557, corr:[0.53900796 0.5460699  0.55012536 0.5515435  0.552037   0.5529218
 0.5543211  0.5558653  0.5571756  0.5579892  0.5584451  0.5586544
 0.5588358  0.558914   0.55868953 0.55804384 0.55706275 0.55590457
 0.55464536 0.5533829  0.5521796  0.5509525  0.5496287  0.54833204
 0.5469348  0.5456514  0.54464704 0.5439602  0.54374975 0.54398096
 0.54449695 0.54517823 0.54576933 0.54624826 0.54647213 0.5466103
 0.54653805 0.54633904 0.5460851  0.5457531  0.5455311  0.54542226
 0.5454289  0.54555935 0.545611   0.54547876 0.54527926 0.5450872
 0.54491055 0.5447327  0.5446412  0.54458034 0.54451823 0.54430467
 0.54400015 0.54370433 0.54350525 0.5433766  0.54332876 0.543205
 0.5429798  0.542714   0.5424826  0.5423009  0.5423273  0.54257745
 0.542913   0.5431856  0.5433228  0.54329586 0.5431924  0.54307646
 0.54297733 0.54290974 0.5428878  0.5428276  0.5426573  0.5424038
 0.542123   0.5418888  0.54174346 0.54166144 0.5416015  0.54146326
 0.54125607 0.5409837  0.54074365 0.54058903 0.5405979  0.54084074
 0.54124075 0.5416525  0.54193723 0.54202294 0.5418909  0.5415773
 0.5411988  0.5409203  0.54066336 0.54044527 0.540258   0.5400867
 0.53993833 0.53975177 0.5395877  0.5395022  0.53939533 0.5392902
 0.5391237  0.53892124 0.5386986  0.5384474  0.5381741  0.53790677
 0.5376426  0.53739643 0.5371747  0.5369641  0.53677875 0.5366718
 0.5366012  0.53650224 0.5362863  0.5360287  0.53579307 0.53558785
 0.53545004 0.5354318  0.5354754  0.5355427  0.53550714 0.5353366
 0.53513235 0.5349756  0.5348644  0.53485227 0.53497964 0.5350729
 0.5351223  0.5351414  0.5350824  0.5350295  0.53507686 0.53525555
 0.5355188  0.535708   0.53578866 0.5357385  0.53562844 0.5354641
 0.53528196 0.5351825  0.53515196 0.53515476 0.53512967 0.5351307
 0.5351328  0.5350997  0.5350891  0.53504425 0.53505284 0.5351065
 0.5352099  0.5353211  0.5354381  0.5355675  0.5357339  0.5359565
 0.5361692  0.53628784 0.5363663  0.5364127  0.53637284 0.53626865
 0.5361576  0.53609425 0.5360917  0.53613603 0.5361587  0.5361444
 0.536078   0.53600323 0.53593    0.5359809  0.53619486 0.5365336
 0.5369281  0.5373281  0.5376705  0.53788114 0.5379158  0.5378027
 0.53754735 0.5372652  0.53690326 0.53642654 0.5358457  0.5352291
 0.5345777  0.5339309  0.5333012  0.53271794 0.5321607  0.53159755
 0.5310195  0.53041476 0.5297837  0.5291924  0.52866155 0.5281845
 0.5277103  0.52723545 0.52673286 0.5261888  0.5255445  0.5248995
 0.5243516  0.5239081  0.5236185  0.52344584 0.52338874 0.52347285
 0.5237175  0.5239561  0.5241312  0.5242172  0.5241805  0.5240888
 0.5240348  0.52407986 0.5242213  0.52435    0.5244229  0.5244409
 0.52442086 0.52445763 0.5244838  0.5246485  0.52489084 0.525197
 0.5254631  0.52552587 0.5254083  0.5252115  0.5250475  0.52491045
 0.5247897  0.5246903  0.524574   0.5244732  0.5243404  0.52425295
 0.52415085 0.5241157  0.5240883  0.52402997 0.52395743 0.5239034
 0.5239035  0.52398944 0.5241136  0.52422845 0.52429646 0.52438104
 0.52441293 0.52439976 0.5243742  0.5243898  0.5244379  0.52445
 0.5244431  0.5243973  0.52432775 0.5242672  0.5242135  0.5241871
 0.52414984 0.52417713 0.5242172  0.52434427 0.52450365 0.52465206
 0.5247856  0.52486914 0.52484596 0.52472764 0.5245022  0.5241279
 0.5236443  0.52317655 0.52273095 0.52220327 0.5216036  0.5209745
 0.52040565 0.51989585 0.5195352  0.5192331  0.518903   0.5184869
 0.5179302  0.5172824  0.51668096 0.51621133 0.51589996 0.5156886
 0.515618   0.51552063 0.5153135  0.5149873  0.5146604  0.5143812
 0.51421833 0.5142272  0.514295   0.5143334  0.5142695  0.51412904
 0.5139319  0.51368463 0.51347554 0.5133731  0.5133669  0.5133946
 0.5133762  0.5133192  0.5131835  0.5130491  0.51295185 0.51293087
 0.51306117 0.51327705 0.51348305 0.513567   0.51313484 0.51125115]
