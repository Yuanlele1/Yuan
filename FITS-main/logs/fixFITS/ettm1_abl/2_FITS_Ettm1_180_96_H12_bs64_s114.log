Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=34, out_features=52, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1584128.0
params:  1820.0
Trainable parameters:  1820
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4685951
	speed: 0.0321s/iter; left time: 855.1396s
	iters: 200, epoch: 1 | loss: 0.3499999
	speed: 0.0153s/iter; left time: 406.1345s
Epoch: 1 cost time: 5.998111963272095
Epoch: 1, Steps: 267 | Train Loss: 0.4246953 Vali Loss: 0.8062689 Test Loss: 0.6584300
Validation loss decreased (inf --> 0.806269).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2718861
	speed: 0.1006s/iter; left time: 2649.8410s
	iters: 200, epoch: 2 | loss: 0.2799578
	speed: 0.0152s/iter; left time: 399.6597s
Epoch: 2 cost time: 4.723592281341553
Epoch: 2, Steps: 267 | Train Loss: 0.2707781 Vali Loss: 0.6659164 Test Loss: 0.5367177
Validation loss decreased (0.806269 --> 0.665916).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2293212
	speed: 0.0937s/iter; left time: 2443.1557s
	iters: 200, epoch: 3 | loss: 0.2014714
	speed: 0.0163s/iter; left time: 422.9464s
Epoch: 3 cost time: 4.992014169692993
Epoch: 3, Steps: 267 | Train Loss: 0.2154662 Vali Loss: 0.5944654 Test Loss: 0.4732083
Validation loss decreased (0.665916 --> 0.594465).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1768151
	speed: 0.1008s/iter; left time: 2601.4476s
	iters: 200, epoch: 4 | loss: 0.2013179
	speed: 0.0140s/iter; left time: 360.1475s
Epoch: 4 cost time: 4.7849438190460205
Epoch: 4, Steps: 267 | Train Loss: 0.1845456 Vali Loss: 0.5485104 Test Loss: 0.4330197
Validation loss decreased (0.594465 --> 0.548510).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1523783
	speed: 0.1184s/iter; left time: 3024.2753s
	iters: 200, epoch: 5 | loss: 0.1700531
	speed: 0.0197s/iter; left time: 500.9593s
Epoch: 5 cost time: 5.88587498664856
Epoch: 5, Steps: 267 | Train Loss: 0.1641719 Vali Loss: 0.5173283 Test Loss: 0.4049245
Validation loss decreased (0.548510 --> 0.517328).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1474413
	speed: 0.1063s/iter; left time: 2686.9646s
	iters: 200, epoch: 6 | loss: 0.1416772
	speed: 0.0220s/iter; left time: 554.7540s
Epoch: 6 cost time: 8.351064443588257
Epoch: 6, Steps: 267 | Train Loss: 0.1497708 Vali Loss: 0.4911976 Test Loss: 0.3831218
Validation loss decreased (0.517328 --> 0.491198).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1313146
	speed: 0.1169s/iter; left time: 2921.4371s
	iters: 200, epoch: 7 | loss: 0.1232159
	speed: 0.0167s/iter; left time: 415.6923s
Epoch: 7 cost time: 5.994739532470703
Epoch: 7, Steps: 267 | Train Loss: 0.1393375 Vali Loss: 0.4716899 Test Loss: 0.3650450
Validation loss decreased (0.491198 --> 0.471690).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1244923
	speed: 0.1164s/iter; left time: 2879.6581s
	iters: 200, epoch: 8 | loss: 0.1312785
	speed: 0.0208s/iter; left time: 512.9183s
Epoch: 8 cost time: 6.055783748626709
Epoch: 8, Steps: 267 | Train Loss: 0.1316718 Vali Loss: 0.4567300 Test Loss: 0.3525054
Validation loss decreased (0.471690 --> 0.456730).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1201407
	speed: 0.0939s/iter; left time: 2298.3144s
	iters: 200, epoch: 9 | loss: 0.1327515
	speed: 0.0163s/iter; left time: 396.4878s
Epoch: 9 cost time: 5.193293333053589
Epoch: 9, Steps: 267 | Train Loss: 0.1260552 Vali Loss: 0.4459307 Test Loss: 0.3432864
Validation loss decreased (0.456730 --> 0.445931).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1230012
	speed: 0.0954s/iter; left time: 2307.8416s
	iters: 200, epoch: 10 | loss: 0.1226971
	speed: 0.0163s/iter; left time: 391.8313s
Epoch: 10 cost time: 5.493301868438721
Epoch: 10, Steps: 267 | Train Loss: 0.1219421 Vali Loss: 0.4362989 Test Loss: 0.3356895
Validation loss decreased (0.445931 --> 0.436299).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1169136
	speed: 0.1053s/iter; left time: 2520.5578s
	iters: 200, epoch: 11 | loss: 0.1218521
	speed: 0.0200s/iter; left time: 477.1384s
Epoch: 11 cost time: 5.876421689987183
Epoch: 11, Steps: 267 | Train Loss: 0.1189655 Vali Loss: 0.4307477 Test Loss: 0.3306925
Validation loss decreased (0.436299 --> 0.430748).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1223344
	speed: 0.1041s/iter; left time: 2464.4518s
	iters: 200, epoch: 12 | loss: 0.1171140
	speed: 0.0291s/iter; left time: 685.8388s
Epoch: 12 cost time: 6.922584533691406
Epoch: 12, Steps: 267 | Train Loss: 0.1168602 Vali Loss: 0.4246417 Test Loss: 0.3269867
Validation loss decreased (0.430748 --> 0.424642).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1128067
	speed: 0.1180s/iter; left time: 2760.3156s
	iters: 200, epoch: 13 | loss: 0.1077148
	speed: 0.0199s/iter; left time: 462.5977s
Epoch: 13 cost time: 7.204977989196777
Epoch: 13, Steps: 267 | Train Loss: 0.1154084 Vali Loss: 0.4219519 Test Loss: 0.3236547
Validation loss decreased (0.424642 --> 0.421952).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1135917
	speed: 0.0945s/iter; left time: 2186.8959s
	iters: 200, epoch: 14 | loss: 0.1138100
	speed: 0.0153s/iter; left time: 351.9936s
Epoch: 14 cost time: 5.706630229949951
Epoch: 14, Steps: 267 | Train Loss: 0.1143633 Vali Loss: 0.4185201 Test Loss: 0.3213923
Validation loss decreased (0.421952 --> 0.418520).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1098877
	speed: 0.0847s/iter; left time: 1937.3713s
	iters: 200, epoch: 15 | loss: 0.1148445
	speed: 0.0152s/iter; left time: 346.1511s
Epoch: 15 cost time: 5.051701545715332
Epoch: 15, Steps: 267 | Train Loss: 0.1136775 Vali Loss: 0.4160602 Test Loss: 0.3194474
Validation loss decreased (0.418520 --> 0.416060).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1172299
	speed: 0.1106s/iter; left time: 2498.5791s
	iters: 200, epoch: 16 | loss: 0.1111661
	speed: 0.0158s/iter; left time: 354.9002s
Epoch: 16 cost time: 5.671527862548828
Epoch: 16, Steps: 267 | Train Loss: 0.1132704 Vali Loss: 0.4144627 Test Loss: 0.3183806
Validation loss decreased (0.416060 --> 0.414463).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1219707
	speed: 0.1806s/iter; left time: 4032.3520s
	iters: 200, epoch: 17 | loss: 0.1178116
	speed: 0.0156s/iter; left time: 347.1621s
Epoch: 17 cost time: 8.893836498260498
Epoch: 17, Steps: 267 | Train Loss: 0.1129881 Vali Loss: 0.4132248 Test Loss: 0.3172418
Validation loss decreased (0.414463 --> 0.413225).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1379610
	speed: 0.1288s/iter; left time: 2840.8489s
	iters: 200, epoch: 18 | loss: 0.1245999
	speed: 0.0321s/iter; left time: 705.9436s
Epoch: 18 cost time: 8.607103824615479
Epoch: 18, Steps: 267 | Train Loss: 0.1128277 Vali Loss: 0.4125692 Test Loss: 0.3172536
Validation loss decreased (0.413225 --> 0.412569).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1164783
	speed: 0.1363s/iter; left time: 2971.0139s
	iters: 200, epoch: 19 | loss: 0.1090792
	speed: 0.0301s/iter; left time: 652.6213s
Epoch: 19 cost time: 8.260385274887085
Epoch: 19, Steps: 267 | Train Loss: 0.1127097 Vali Loss: 0.4113625 Test Loss: 0.3163705
Validation loss decreased (0.412569 --> 0.411362).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1087707
	speed: 0.1066s/iter; left time: 2293.9721s
	iters: 200, epoch: 20 | loss: 0.1105652
	speed: 0.0223s/iter; left time: 478.2235s
Epoch: 20 cost time: 5.950576543807983
Epoch: 20, Steps: 267 | Train Loss: 0.1126783 Vali Loss: 0.4115689 Test Loss: 0.3166514
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1153118
	speed: 0.0956s/iter; left time: 2031.9841s
	iters: 200, epoch: 21 | loss: 0.1073746
	speed: 0.0170s/iter; left time: 359.5935s
Epoch: 21 cost time: 5.912245988845825
Epoch: 21, Steps: 267 | Train Loss: 0.1126980 Vali Loss: 0.4111016 Test Loss: 0.3160151
Validation loss decreased (0.411362 --> 0.411102).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1114204
	speed: 0.0996s/iter; left time: 2091.4170s
	iters: 200, epoch: 22 | loss: 0.1079187
	speed: 0.0152s/iter; left time: 318.2519s
Epoch: 22 cost time: 5.133577585220337
Epoch: 22, Steps: 267 | Train Loss: 0.1126473 Vali Loss: 0.4111905 Test Loss: 0.3159734
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1092137
	speed: 0.1080s/iter; left time: 2239.4956s
	iters: 200, epoch: 23 | loss: 0.1144928
	speed: 0.0173s/iter; left time: 355.9357s
Epoch: 23 cost time: 5.383955955505371
Epoch: 23, Steps: 267 | Train Loss: 0.1125849 Vali Loss: 0.4106054 Test Loss: 0.3161350
Validation loss decreased (0.411102 --> 0.410605).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1103021
	speed: 0.0889s/iter; left time: 1818.6399s
	iters: 200, epoch: 24 | loss: 0.1171780
	speed: 0.0200s/iter; left time: 406.3587s
Epoch: 24 cost time: 6.002041816711426
Epoch: 24, Steps: 267 | Train Loss: 0.1126045 Vali Loss: 0.4107647 Test Loss: 0.3160670
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1025085
	speed: 0.1354s/iter; left time: 2734.1653s
	iters: 200, epoch: 25 | loss: 0.1134928
	speed: 0.0210s/iter; left time: 422.9082s
Epoch: 25 cost time: 7.89310884475708
Epoch: 25, Steps: 267 | Train Loss: 0.1126011 Vali Loss: 0.4102041 Test Loss: 0.3156036
Validation loss decreased (0.410605 --> 0.410204).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1171192
	speed: 0.1242s/iter; left time: 2475.2927s
	iters: 200, epoch: 26 | loss: 0.1047154
	speed: 0.0243s/iter; left time: 480.9193s
Epoch: 26 cost time: 6.628535509109497
Epoch: 26, Steps: 267 | Train Loss: 0.1126118 Vali Loss: 0.4100846 Test Loss: 0.3157676
Validation loss decreased (0.410204 --> 0.410085).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1198823
	speed: 0.1058s/iter; left time: 2079.9467s
	iters: 200, epoch: 27 | loss: 0.1234363
	speed: 0.0276s/iter; left time: 540.3354s
Epoch: 27 cost time: 7.3031487464904785
Epoch: 27, Steps: 267 | Train Loss: 0.1125588 Vali Loss: 0.4104301 Test Loss: 0.3157590
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1173989
	speed: 0.1181s/iter; left time: 2290.9741s
	iters: 200, epoch: 28 | loss: 0.1113348
	speed: 0.0212s/iter; left time: 408.4232s
Epoch: 28 cost time: 6.270834445953369
Epoch: 28, Steps: 267 | Train Loss: 0.1125892 Vali Loss: 0.4109336 Test Loss: 0.3161021
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1192403
	speed: 0.0884s/iter; left time: 1689.7667s
	iters: 200, epoch: 29 | loss: 0.1119568
	speed: 0.0259s/iter; left time: 492.5603s
Epoch: 29 cost time: 6.023744821548462
Epoch: 29, Steps: 267 | Train Loss: 0.1126197 Vali Loss: 0.4106595 Test Loss: 0.3159125
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1079396
	speed: 0.0935s/iter; left time: 1763.0533s
	iters: 200, epoch: 30 | loss: 0.1242421
	speed: 0.0168s/iter; left time: 316.0331s
Epoch: 30 cost time: 5.321873426437378
Epoch: 30, Steps: 267 | Train Loss: 0.1125514 Vali Loss: 0.4105156 Test Loss: 0.3160092
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1160253
	speed: 0.1021s/iter; left time: 1897.2268s
	iters: 200, epoch: 31 | loss: 0.1143740
	speed: 0.0163s/iter; left time: 301.7465s
Epoch: 31 cost time: 6.380626440048218
Epoch: 31, Steps: 267 | Train Loss: 0.1125822 Vali Loss: 0.4099410 Test Loss: 0.3158086
Validation loss decreased (0.410085 --> 0.409941).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1119396
	speed: 0.1168s/iter; left time: 2139.3726s
	iters: 200, epoch: 32 | loss: 0.1071476
	speed: 0.0169s/iter; left time: 308.8363s
Epoch: 32 cost time: 5.825557470321655
Epoch: 32, Steps: 267 | Train Loss: 0.1126136 Vali Loss: 0.4108880 Test Loss: 0.3159514
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1073585
	speed: 0.1193s/iter; left time: 2154.2861s
	iters: 200, epoch: 33 | loss: 0.1080721
	speed: 0.0199s/iter; left time: 356.8669s
Epoch: 33 cost time: 7.471508264541626
Epoch: 33, Steps: 267 | Train Loss: 0.1126010 Vali Loss: 0.4105326 Test Loss: 0.3159387
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1059474
	speed: 0.0972s/iter; left time: 1729.7596s
	iters: 200, epoch: 34 | loss: 0.1019908
	speed: 0.0187s/iter; left time: 330.1225s
Epoch: 34 cost time: 5.469600439071655
Epoch: 34, Steps: 267 | Train Loss: 0.1126176 Vali Loss: 0.4102079 Test Loss: 0.3159465
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1215593
	speed: 0.1115s/iter; left time: 1953.3479s
	iters: 200, epoch: 35 | loss: 0.1087385
	speed: 0.0158s/iter; left time: 275.3599s
Epoch: 35 cost time: 6.285071849822998
Epoch: 35, Steps: 267 | Train Loss: 0.1125877 Vali Loss: 0.4106653 Test Loss: 0.3158426
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1102279
	speed: 0.1197s/iter; left time: 2064.8253s
	iters: 200, epoch: 36 | loss: 0.1009957
	speed: 0.0230s/iter; left time: 394.3245s
Epoch: 36 cost time: 9.08275580406189
Epoch: 36, Steps: 267 | Train Loss: 0.1126237 Vali Loss: 0.4104726 Test Loss: 0.3157775
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1075138
	speed: 0.1237s/iter; left time: 2102.1890s
	iters: 200, epoch: 37 | loss: 0.1032314
	speed: 0.0232s/iter; left time: 392.4120s
Epoch: 37 cost time: 6.153652906417847
Epoch: 37, Steps: 267 | Train Loss: 0.1126032 Vali Loss: 0.4106573 Test Loss: 0.3158325
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1233908
	speed: 0.1449s/iter; left time: 2422.8179s
	iters: 200, epoch: 38 | loss: 0.1123599
	speed: 0.0278s/iter; left time: 461.6568s
Epoch: 38 cost time: 8.534838914871216
Epoch: 38, Steps: 267 | Train Loss: 0.1125998 Vali Loss: 0.4105165 Test Loss: 0.3159398
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1164143
	speed: 0.1035s/iter; left time: 1702.4064s
	iters: 200, epoch: 39 | loss: 0.1172975
	speed: 0.0166s/iter; left time: 271.5923s
Epoch: 39 cost time: 5.96467924118042
Epoch: 39, Steps: 267 | Train Loss: 0.1125729 Vali Loss: 0.4107445 Test Loss: 0.3159152
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1083860
	speed: 0.1027s/iter; left time: 1663.0119s
	iters: 200, epoch: 40 | loss: 0.1095029
	speed: 0.0184s/iter; left time: 295.5698s
Epoch: 40 cost time: 5.587757587432861
Epoch: 40, Steps: 267 | Train Loss: 0.1126125 Vali Loss: 0.4103534 Test Loss: 0.3158542
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1035769
	speed: 0.1017s/iter; left time: 1619.8558s
	iters: 200, epoch: 41 | loss: 0.1021306
	speed: 0.0132s/iter; left time: 209.1697s
Epoch: 41 cost time: 5.172069072723389
Epoch: 41, Steps: 267 | Train Loss: 0.1126002 Vali Loss: 0.4105474 Test Loss: 0.3159628
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1038010
	speed: 0.0983s/iter; left time: 1538.8761s
	iters: 200, epoch: 42 | loss: 0.1096370
	speed: 0.0236s/iter; left time: 366.4898s
Epoch: 42 cost time: 5.963108539581299
Epoch: 42, Steps: 267 | Train Loss: 0.1126121 Vali Loss: 0.4103450 Test Loss: 0.3158614
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1218205
	speed: 0.0841s/iter; left time: 1294.3082s
	iters: 200, epoch: 43 | loss: 0.1164987
	speed: 0.0210s/iter; left time: 320.4583s
Epoch: 43 cost time: 5.8809943199157715
Epoch: 43, Steps: 267 | Train Loss: 0.1126340 Vali Loss: 0.4107316 Test Loss: 0.3158883
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1236205
	speed: 0.1022s/iter; left time: 1545.7848s
	iters: 200, epoch: 44 | loss: 0.1163346
	speed: 0.0321s/iter; left time: 482.7454s
Epoch: 44 cost time: 7.559522390365601
Epoch: 44, Steps: 267 | Train Loss: 0.1126375 Vali Loss: 0.4106241 Test Loss: 0.3158031
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1182013
	speed: 0.1223s/iter; left time: 1816.2257s
	iters: 200, epoch: 45 | loss: 0.1045310
	speed: 0.0159s/iter; left time: 234.2356s
Epoch: 45 cost time: 6.818355083465576
Epoch: 45, Steps: 267 | Train Loss: 0.1125962 Vali Loss: 0.4104605 Test Loss: 0.3158425
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1195123
	speed: 0.0985s/iter; left time: 1437.3820s
	iters: 200, epoch: 46 | loss: 0.1191998
	speed: 0.0179s/iter; left time: 259.2965s
Epoch: 46 cost time: 5.986882448196411
Epoch: 46, Steps: 267 | Train Loss: 0.1125548 Vali Loss: 0.4104589 Test Loss: 0.3159688
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1036339
	speed: 0.1014s/iter; left time: 1451.7738s
	iters: 200, epoch: 47 | loss: 0.1128057
	speed: 0.0158s/iter; left time: 225.2429s
Epoch: 47 cost time: 5.814213037490845
Epoch: 47, Steps: 267 | Train Loss: 0.1125868 Vali Loss: 0.4102169 Test Loss: 0.3159860
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1035564
	speed: 0.1069s/iter; left time: 1502.2966s
	iters: 200, epoch: 48 | loss: 0.1108474
	speed: 0.0136s/iter; left time: 190.0323s
Epoch: 48 cost time: 4.6755523681640625
Epoch: 48, Steps: 267 | Train Loss: 0.1125252 Vali Loss: 0.4109887 Test Loss: 0.3159185
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1098448
	speed: 0.0864s/iter; left time: 1190.6572s
	iters: 200, epoch: 49 | loss: 0.1077645
	speed: 0.0166s/iter; left time: 227.2524s
Epoch: 49 cost time: 4.732651710510254
Epoch: 49, Steps: 267 | Train Loss: 0.1125877 Vali Loss: 0.4106213 Test Loss: 0.3159108
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.0978885
	speed: 0.1103s/iter; left time: 1490.9863s
	iters: 200, epoch: 50 | loss: 0.1304500
	speed: 0.0268s/iter; left time: 359.2031s
Epoch: 50 cost time: 8.441968202590942
Epoch: 50, Steps: 267 | Train Loss: 0.1125382 Vali Loss: 0.4107568 Test Loss: 0.3159030
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1040725
	speed: 0.1078s/iter; left time: 1427.9178s
	iters: 200, epoch: 51 | loss: 0.1229036
	speed: 0.0374s/iter; left time: 491.9887s
Epoch: 51 cost time: 7.986790657043457
Epoch: 51, Steps: 267 | Train Loss: 0.1126123 Vali Loss: 0.4103606 Test Loss: 0.3158506
EarlyStopping counter: 20 out of 20
Early stopping
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=34, out_features=52, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1584128.0
params:  1820.0
Trainable parameters:  1820
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2860328
	speed: 0.0319s/iter; left time: 847.9277s
	iters: 200, epoch: 1 | loss: 0.3369772
	speed: 0.0259s/iter; left time: 685.7113s
Epoch: 1 cost time: 7.158401012420654
Epoch: 1, Steps: 267 | Train Loss: 0.2936881 Vali Loss: 0.4076920 Test Loss: 0.3126242
Validation loss decreased (inf --> 0.407692).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3270125
	speed: 0.1019s/iter; left time: 2683.9339s
	iters: 200, epoch: 2 | loss: 0.2918407
	speed: 0.0177s/iter; left time: 464.0178s
Epoch: 2 cost time: 5.921586751937866
Epoch: 2, Steps: 267 | Train Loss: 0.2921228 Vali Loss: 0.4051869 Test Loss: 0.3107725
Validation loss decreased (0.407692 --> 0.405187).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2782915
	speed: 0.0958s/iter; left time: 2497.7329s
	iters: 200, epoch: 3 | loss: 0.2637092
	speed: 0.0166s/iter; left time: 430.5100s
Epoch: 3 cost time: 6.3491950035095215
Epoch: 3, Steps: 267 | Train Loss: 0.2915080 Vali Loss: 0.4052238 Test Loss: 0.3105120
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2966129
	speed: 0.1182s/iter; left time: 3049.5158s
	iters: 200, epoch: 4 | loss: 0.2724842
	speed: 0.0216s/iter; left time: 555.8446s
Epoch: 4 cost time: 6.45147967338562
Epoch: 4, Steps: 267 | Train Loss: 0.2911159 Vali Loss: 0.4049168 Test Loss: 0.3110950
Validation loss decreased (0.405187 --> 0.404917).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2700040
	speed: 0.1179s/iter; left time: 3010.6012s
	iters: 200, epoch: 5 | loss: 0.3244064
	speed: 0.0396s/iter; left time: 1007.8751s
Epoch: 5 cost time: 9.56562876701355
Epoch: 5, Steps: 267 | Train Loss: 0.2907800 Vali Loss: 0.4037729 Test Loss: 0.3103007
Validation loss decreased (0.404917 --> 0.403773).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3003674
	speed: 0.1141s/iter; left time: 2881.9863s
	iters: 200, epoch: 6 | loss: 0.2767420
	speed: 0.0289s/iter; left time: 727.7416s
Epoch: 6 cost time: 7.581988096237183
Epoch: 6, Steps: 267 | Train Loss: 0.2906529 Vali Loss: 0.4024582 Test Loss: 0.3098806
Validation loss decreased (0.403773 --> 0.402458).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2566872
	speed: 0.1448s/iter; left time: 3618.8099s
	iters: 200, epoch: 7 | loss: 0.2570518
	speed: 0.0257s/iter; left time: 640.4520s
Epoch: 7 cost time: 8.581523656845093
Epoch: 7, Steps: 267 | Train Loss: 0.2903766 Vali Loss: 0.4022575 Test Loss: 0.3094199
Validation loss decreased (0.402458 --> 0.402257).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2590576
	speed: 0.1296s/iter; left time: 3205.7014s
	iters: 200, epoch: 8 | loss: 0.2657753
	speed: 0.0255s/iter; left time: 629.1636s
Epoch: 8 cost time: 6.631679534912109
Epoch: 8, Steps: 267 | Train Loss: 0.2902876 Vali Loss: 0.4021415 Test Loss: 0.3091402
Validation loss decreased (0.402257 --> 0.402141).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2956131
	speed: 0.0874s/iter; left time: 2138.8315s
	iters: 200, epoch: 9 | loss: 0.3143884
	speed: 0.0165s/iter; left time: 401.3410s
Epoch: 9 cost time: 4.936484098434448
Epoch: 9, Steps: 267 | Train Loss: 0.2902447 Vali Loss: 0.4019209 Test Loss: 0.3102157
Validation loss decreased (0.402141 --> 0.401921).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3072262
	speed: 0.0908s/iter; left time: 2197.4777s
	iters: 200, epoch: 10 | loss: 0.3139604
	speed: 0.0180s/iter; left time: 432.6844s
Epoch: 10 cost time: 5.6579694747924805
Epoch: 10, Steps: 267 | Train Loss: 0.2901622 Vali Loss: 0.4020775 Test Loss: 0.3097259
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3233430
	speed: 0.1129s/iter; left time: 2701.4232s
	iters: 200, epoch: 11 | loss: 0.3042962
	speed: 0.0245s/iter; left time: 584.9022s
Epoch: 11 cost time: 8.25693655014038
Epoch: 11, Steps: 267 | Train Loss: 0.2901103 Vali Loss: 0.4005200 Test Loss: 0.3087149
Validation loss decreased (0.401921 --> 0.400520).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2890059
	speed: 0.1177s/iter; left time: 2786.2084s
	iters: 200, epoch: 12 | loss: 0.2905507
	speed: 0.0244s/iter; left time: 574.0649s
Epoch: 12 cost time: 6.624483108520508
Epoch: 12, Steps: 267 | Train Loss: 0.2901259 Vali Loss: 0.4018399 Test Loss: 0.3095651
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3063131
	speed: 0.1290s/iter; left time: 3017.0668s
	iters: 200, epoch: 13 | loss: 0.2928966
	speed: 0.0211s/iter; left time: 492.4542s
Epoch: 13 cost time: 6.517962455749512
Epoch: 13, Steps: 267 | Train Loss: 0.2899871 Vali Loss: 0.4025785 Test Loss: 0.3099055
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2985317
	speed: 0.1048s/iter; left time: 2423.0648s
	iters: 200, epoch: 14 | loss: 0.2970818
	speed: 0.0230s/iter; left time: 529.7314s
Epoch: 14 cost time: 6.124264717102051
Epoch: 14, Steps: 267 | Train Loss: 0.2899837 Vali Loss: 0.4012266 Test Loss: 0.3091736
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2978031
	speed: 0.0868s/iter; left time: 1984.9305s
	iters: 200, epoch: 15 | loss: 0.3123437
	speed: 0.0160s/iter; left time: 364.9964s
Epoch: 15 cost time: 4.885050535202026
Epoch: 15, Steps: 267 | Train Loss: 0.2899346 Vali Loss: 0.4018371 Test Loss: 0.3092962
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2951468
	speed: 0.0894s/iter; left time: 2020.5541s
	iters: 200, epoch: 16 | loss: 0.3100791
	speed: 0.0202s/iter; left time: 455.1200s
Epoch: 16 cost time: 5.63366961479187
Epoch: 16, Steps: 267 | Train Loss: 0.2898710 Vali Loss: 0.4016742 Test Loss: 0.3094143
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2748628
	speed: 0.0919s/iter; left time: 2051.5940s
	iters: 200, epoch: 17 | loss: 0.2862782
	speed: 0.0162s/iter; left time: 359.3834s
Epoch: 17 cost time: 5.2510528564453125
Epoch: 17, Steps: 267 | Train Loss: 0.2897948 Vali Loss: 0.4012104 Test Loss: 0.3092142
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2680128
	speed: 0.1093s/iter; left time: 2410.5705s
	iters: 200, epoch: 18 | loss: 0.2670463
	speed: 0.0238s/iter; left time: 522.9280s
Epoch: 18 cost time: 6.383817672729492
Epoch: 18, Steps: 267 | Train Loss: 0.2899085 Vali Loss: 0.4013189 Test Loss: 0.3091389
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3218177
	speed: 0.1289s/iter; left time: 2809.8604s
	iters: 200, epoch: 19 | loss: 0.2895363
	speed: 0.0376s/iter; left time: 814.9805s
Epoch: 19 cost time: 9.744524955749512
Epoch: 19, Steps: 267 | Train Loss: 0.2898104 Vali Loss: 0.4020384 Test Loss: 0.3094970
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2809127
	speed: 0.1201s/iter; left time: 2586.1331s
	iters: 200, epoch: 20 | loss: 0.2692439
	speed: 0.0282s/iter; left time: 603.2400s
Epoch: 20 cost time: 7.218702077865601
Epoch: 20, Steps: 267 | Train Loss: 0.2896965 Vali Loss: 0.4021595 Test Loss: 0.3096389
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2756994
	speed: 0.1104s/iter; left time: 2347.6125s
	iters: 200, epoch: 21 | loss: 0.2747213
	speed: 0.0174s/iter; left time: 369.1532s
Epoch: 21 cost time: 5.989656448364258
Epoch: 21, Steps: 267 | Train Loss: 0.2898734 Vali Loss: 0.4017586 Test Loss: 0.3093776
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2740704
	speed: 0.0845s/iter; left time: 1773.0771s
	iters: 200, epoch: 22 | loss: 0.3183493
	speed: 0.0154s/iter; left time: 320.8075s
Epoch: 22 cost time: 4.687987327575684
Epoch: 22, Steps: 267 | Train Loss: 0.2897491 Vali Loss: 0.4011647 Test Loss: 0.3093614
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3023333
	speed: 0.1186s/iter; left time: 2457.7245s
	iters: 200, epoch: 23 | loss: 0.2856143
	speed: 0.0159s/iter; left time: 328.1581s
Epoch: 23 cost time: 6.866618394851685
Epoch: 23, Steps: 267 | Train Loss: 0.2899210 Vali Loss: 0.4018004 Test Loss: 0.3091584
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2859721
	speed: 0.1419s/iter; left time: 2902.9229s
	iters: 200, epoch: 24 | loss: 0.2728908
	speed: 0.0300s/iter; left time: 610.6470s
Epoch: 24 cost time: 9.694007396697998
Epoch: 24, Steps: 267 | Train Loss: 0.2898073 Vali Loss: 0.4022161 Test Loss: 0.3095870
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2824022
	speed: 0.1408s/iter; left time: 2843.3828s
	iters: 200, epoch: 25 | loss: 0.2804441
	speed: 0.0256s/iter; left time: 513.4654s
Epoch: 25 cost time: 7.278416156768799
Epoch: 25, Steps: 267 | Train Loss: 0.2897628 Vali Loss: 0.4014956 Test Loss: 0.3091614
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2615015
	speed: 0.1392s/iter; left time: 2773.4328s
	iters: 200, epoch: 26 | loss: 0.3012437
	speed: 0.0302s/iter; left time: 599.2332s
Epoch: 26 cost time: 10.199311017990112
Epoch: 26, Steps: 267 | Train Loss: 0.2896596 Vali Loss: 0.4015320 Test Loss: 0.3093301
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2824645
	speed: 0.1305s/iter; left time: 2565.4701s
	iters: 200, epoch: 27 | loss: 0.2647016
	speed: 0.0224s/iter; left time: 437.4233s
Epoch: 27 cost time: 6.1508119106292725
Epoch: 27, Steps: 267 | Train Loss: 0.2898030 Vali Loss: 0.4015936 Test Loss: 0.3093484
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2905880
	speed: 0.0830s/iter; left time: 1609.9085s
	iters: 200, epoch: 28 | loss: 0.2776297
	speed: 0.0163s/iter; left time: 313.9802s
Epoch: 28 cost time: 4.648216247558594
Epoch: 28, Steps: 267 | Train Loss: 0.2897724 Vali Loss: 0.4017748 Test Loss: 0.3094312
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2505296
	speed: 0.0905s/iter; left time: 1729.9120s
	iters: 200, epoch: 29 | loss: 0.3136225
	speed: 0.0146s/iter; left time: 277.9729s
Epoch: 29 cost time: 4.703310012817383
Epoch: 29, Steps: 267 | Train Loss: 0.2896998 Vali Loss: 0.4018561 Test Loss: 0.3092432
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3092203
	speed: 0.0911s/iter; left time: 1718.0024s
	iters: 200, epoch: 30 | loss: 0.2767957
	speed: 0.0119s/iter; left time: 223.8323s
Epoch: 30 cost time: 4.762456178665161
Epoch: 30, Steps: 267 | Train Loss: 0.2897400 Vali Loss: 0.4014485 Test Loss: 0.3092562
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2769499
	speed: 0.1264s/iter; left time: 2350.7047s
	iters: 200, epoch: 31 | loss: 0.2832603
	speed: 0.0189s/iter; left time: 349.6093s
Epoch: 31 cost time: 6.726398468017578
Epoch: 31, Steps: 267 | Train Loss: 0.2896364 Vali Loss: 0.4014567 Test Loss: 0.3091612
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3110266327857971, mae:0.3473813831806183, rse:0.5306774973869324, corr:[0.55085695 0.5575883  0.55516756 0.5528078  0.55294156 0.553486
 0.55282235 0.5520187  0.5519416  0.55247223 0.5529104  0.55264765
 0.55207485 0.5510128  0.54948986 0.54796135 0.5465013  0.5448389
 0.5428612  0.5407559  0.53878486 0.53685004 0.53467745 0.5322684
 0.5298478  0.5277225  0.52598417 0.52433604 0.52288514 0.5219596
 0.52195084 0.5226308  0.5234218  0.5239104  0.52389634 0.5236397
 0.523299   0.52298826 0.5229008  0.5228385  0.5227466  0.52254486
 0.5224075  0.52252954 0.52273923 0.5228652  0.5229066  0.5229439
 0.5230825  0.52324027 0.52334696 0.5233655  0.52336174 0.52337927
 0.52346706 0.5235141  0.523537   0.52338964 0.5232132  0.5230673
 0.5230518  0.5230737  0.52297014 0.52268136 0.5223476  0.5222859
 0.52246755 0.52265686 0.52276933 0.5227708  0.52280426 0.52297443
 0.5232847  0.5235338  0.52365446 0.5235352  0.52336663 0.52327293
 0.52323484 0.52314574 0.5230302  0.52287954 0.52275383 0.5225496
 0.5223223  0.52225125 0.5223126  0.5222778  0.5221065  0.5220937
 0.5222822  0.52237356 0.5221931  0.522145   0.5224346  0.5214074 ]
