Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=24, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_192_FITS_ETTm1_ftM_sl90_ll48_pl192_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=24, out_features=75, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1612800.0
params:  1875.0
Trainable parameters:  1875
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6145440
	speed: 0.0292s/iter; left time: 777.2159s
	iters: 200, epoch: 1 | loss: 0.4637710
	speed: 0.0305s/iter; left time: 807.6610s
Epoch: 1 cost time: 7.287272214889526
Epoch: 1, Steps: 267 | Train Loss: 0.5405881 Vali Loss: 0.8718202 Test Loss: 0.7047445
Validation loss decreased (inf --> 0.871820).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3719062
	speed: 0.1078s/iter; left time: 2838.6130s
	iters: 200, epoch: 2 | loss: 0.3380157
	speed: 0.0362s/iter; left time: 949.0532s
Epoch: 2 cost time: 7.652222633361816
Epoch: 2, Steps: 267 | Train Loss: 0.3655969 Vali Loss: 0.7405489 Test Loss: 0.5747095
Validation loss decreased (0.871820 --> 0.740549).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3155585
	speed: 0.1182s/iter; left time: 3081.4812s
	iters: 200, epoch: 3 | loss: 0.2938912
	speed: 0.0234s/iter; left time: 607.6306s
Epoch: 3 cost time: 9.591537952423096
Epoch: 3, Steps: 267 | Train Loss: 0.3191981 Vali Loss: 0.6838934 Test Loss: 0.5206365
Validation loss decreased (0.740549 --> 0.683893).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3063436
	speed: 0.1331s/iter; left time: 3434.8646s
	iters: 200, epoch: 4 | loss: 0.2666014
	speed: 0.0447s/iter; left time: 1148.3058s
Epoch: 4 cost time: 10.030880689620972
Epoch: 4, Steps: 267 | Train Loss: 0.2966039 Vali Loss: 0.6448178 Test Loss: 0.4840109
Validation loss decreased (0.683893 --> 0.644818).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2801630
	speed: 0.1420s/iter; left time: 3626.5484s
	iters: 200, epoch: 5 | loss: 0.2981337
	speed: 0.0241s/iter; left time: 612.0268s
Epoch: 5 cost time: 6.460986614227295
Epoch: 5, Steps: 267 | Train Loss: 0.2824242 Vali Loss: 0.6150647 Test Loss: 0.4577782
Validation loss decreased (0.644818 --> 0.615065).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2575482
	speed: 0.1238s/iter; left time: 3128.5454s
	iters: 200, epoch: 6 | loss: 0.2753266
	speed: 0.0353s/iter; left time: 887.1259s
Epoch: 6 cost time: 7.7375648021698
Epoch: 6, Steps: 267 | Train Loss: 0.2732988 Vali Loss: 0.5946558 Test Loss: 0.4394655
Validation loss decreased (0.615065 --> 0.594656).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2574406
	speed: 0.1317s/iter; left time: 3291.9566s
	iters: 200, epoch: 7 | loss: 0.3013275
	speed: 0.0268s/iter; left time: 667.5813s
Epoch: 7 cost time: 6.950745582580566
Epoch: 7, Steps: 267 | Train Loss: 0.2672926 Vali Loss: 0.5798733 Test Loss: 0.4262236
Validation loss decreased (0.594656 --> 0.579873).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2593616
	speed: 0.1017s/iter; left time: 2514.8215s
	iters: 200, epoch: 8 | loss: 0.2559033
	speed: 0.0203s/iter; left time: 501.0825s
Epoch: 8 cost time: 6.280125856399536
Epoch: 8, Steps: 267 | Train Loss: 0.2637373 Vali Loss: 0.5688128 Test Loss: 0.4169002
Validation loss decreased (0.579873 --> 0.568813).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2458694
	speed: 0.0880s/iter; left time: 2154.0183s
	iters: 200, epoch: 9 | loss: 0.2227362
	speed: 0.0149s/iter; left time: 363.3589s
Epoch: 9 cost time: 4.9491846561431885
Epoch: 9, Steps: 267 | Train Loss: 0.2615185 Vali Loss: 0.5620754 Test Loss: 0.4110515
Validation loss decreased (0.568813 --> 0.562075).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2534184
	speed: 0.1113s/iter; left time: 2693.1265s
	iters: 200, epoch: 10 | loss: 0.2827764
	speed: 0.0200s/iter; left time: 483.1150s
Epoch: 10 cost time: 5.674551248550415
Epoch: 10, Steps: 267 | Train Loss: 0.2602333 Vali Loss: 0.5558925 Test Loss: 0.4064056
Validation loss decreased (0.562075 --> 0.555893).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2679408
	speed: 0.1409s/iter; left time: 3373.0375s
	iters: 200, epoch: 11 | loss: 0.2571816
	speed: 0.0411s/iter; left time: 979.6059s
Epoch: 11 cost time: 10.080514669418335
Epoch: 11, Steps: 267 | Train Loss: 0.2593367 Vali Loss: 0.5520256 Test Loss: 0.4036526
Validation loss decreased (0.555893 --> 0.552026).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2681853
	speed: 0.1034s/iter; left time: 2446.0097s
	iters: 200, epoch: 12 | loss: 0.2558022
	speed: 0.0244s/iter; left time: 575.8081s
Epoch: 12 cost time: 7.525255441665649
Epoch: 12, Steps: 267 | Train Loss: 0.2589729 Vali Loss: 0.5494706 Test Loss: 0.4021812
Validation loss decreased (0.552026 --> 0.549471).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2331043
	speed: 0.1180s/iter; left time: 2759.7489s
	iters: 200, epoch: 13 | loss: 0.2795531
	speed: 0.0195s/iter; left time: 455.1192s
Epoch: 13 cost time: 5.804182767868042
Epoch: 13, Steps: 267 | Train Loss: 0.2588894 Vali Loss: 0.5486469 Test Loss: 0.4010150
Validation loss decreased (0.549471 --> 0.548647).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2486511
	speed: 0.1124s/iter; left time: 2600.6772s
	iters: 200, epoch: 14 | loss: 0.2591604
	speed: 0.0391s/iter; left time: 899.6319s
Epoch: 14 cost time: 8.960773944854736
Epoch: 14, Steps: 267 | Train Loss: 0.2586867 Vali Loss: 0.5474547 Test Loss: 0.4001003
Validation loss decreased (0.548647 --> 0.547455).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2325293
	speed: 0.1126s/iter; left time: 2574.2389s
	iters: 200, epoch: 15 | loss: 0.2672265
	speed: 0.0259s/iter; left time: 588.8498s
Epoch: 15 cost time: 9.892106533050537
Epoch: 15, Steps: 267 | Train Loss: 0.2585411 Vali Loss: 0.5468628 Test Loss: 0.3996888
Validation loss decreased (0.547455 --> 0.546863).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2802455
	speed: 0.1383s/iter; left time: 3124.0605s
	iters: 200, epoch: 16 | loss: 0.2528475
	speed: 0.0394s/iter; left time: 886.4188s
Epoch: 16 cost time: 9.775641441345215
Epoch: 16, Steps: 267 | Train Loss: 0.2586494 Vali Loss: 0.5462137 Test Loss: 0.3994412
Validation loss decreased (0.546863 --> 0.546214).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2943201
	speed: 0.1304s/iter; left time: 2911.8738s
	iters: 200, epoch: 17 | loss: 0.2427240
	speed: 0.0322s/iter; left time: 714.8770s
Epoch: 17 cost time: 9.4678475856781
Epoch: 17, Steps: 267 | Train Loss: 0.2586045 Vali Loss: 0.5462241 Test Loss: 0.3995453
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2656628
	speed: 0.1559s/iter; left time: 3439.9931s
	iters: 200, epoch: 18 | loss: 0.2487693
	speed: 0.0289s/iter; left time: 634.1217s
Epoch: 18 cost time: 9.622536420822144
Epoch: 18, Steps: 267 | Train Loss: 0.2584842 Vali Loss: 0.5457621 Test Loss: 0.3992962
Validation loss decreased (0.546214 --> 0.545762).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2588613
	speed: 0.0994s/iter; left time: 2165.3590s
	iters: 200, epoch: 19 | loss: 0.2340504
	speed: 0.0202s/iter; left time: 437.1580s
Epoch: 19 cost time: 5.592243194580078
Epoch: 19, Steps: 267 | Train Loss: 0.2586054 Vali Loss: 0.5457489 Test Loss: 0.3991894
Validation loss decreased (0.545762 --> 0.545749).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2657091
	speed: 0.1054s/iter; left time: 2269.9100s
	iters: 200, epoch: 20 | loss: 0.2527511
	speed: 0.0188s/iter; left time: 402.5845s
Epoch: 20 cost time: 5.897068738937378
Epoch: 20, Steps: 267 | Train Loss: 0.2586866 Vali Loss: 0.5456051 Test Loss: 0.3991049
Validation loss decreased (0.545749 --> 0.545605).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2556386
	speed: 0.1193s/iter; left time: 2536.1524s
	iters: 200, epoch: 21 | loss: 0.2602863
	speed: 0.0260s/iter; left time: 551.1125s
Epoch: 21 cost time: 9.603990077972412
Epoch: 21, Steps: 267 | Train Loss: 0.2586367 Vali Loss: 0.5456321 Test Loss: 0.3991793
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2470662
	speed: 0.1568s/iter; left time: 3291.2773s
	iters: 200, epoch: 22 | loss: 0.2541127
	speed: 0.0253s/iter; left time: 528.9712s
Epoch: 22 cost time: 7.46363091468811
Epoch: 22, Steps: 267 | Train Loss: 0.2586584 Vali Loss: 0.5458179 Test Loss: 0.3990913
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2525357
	speed: 0.1469s/iter; left time: 3043.9231s
	iters: 200, epoch: 23 | loss: 0.2325270
	speed: 0.0365s/iter; left time: 753.6752s
Epoch: 23 cost time: 9.686489343643188
Epoch: 23, Steps: 267 | Train Loss: 0.2586319 Vali Loss: 0.5455559 Test Loss: 0.3992238
Validation loss decreased (0.545605 --> 0.545556).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2554473
	speed: 0.1435s/iter; left time: 2936.3184s
	iters: 200, epoch: 24 | loss: 0.2694375
	speed: 0.0256s/iter; left time: 521.3916s
Epoch: 24 cost time: 11.063792705535889
Epoch: 24, Steps: 267 | Train Loss: 0.2586627 Vali Loss: 0.5456385 Test Loss: 0.3993478
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2637392
	speed: 0.1203s/iter; left time: 2428.3719s
	iters: 200, epoch: 25 | loss: 0.2494704
	speed: 0.0214s/iter; left time: 429.1661s
Epoch: 25 cost time: 6.899539947509766
Epoch: 25, Steps: 267 | Train Loss: 0.2585969 Vali Loss: 0.5455071 Test Loss: 0.3992223
Validation loss decreased (0.545556 --> 0.545507).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2437290
	speed: 0.0942s/iter; left time: 1877.0923s
	iters: 200, epoch: 26 | loss: 0.2448515
	speed: 0.0147s/iter; left time: 291.9682s
Epoch: 26 cost time: 5.00040078163147
Epoch: 26, Steps: 267 | Train Loss: 0.2585825 Vali Loss: 0.5457290 Test Loss: 0.3995206
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2412211
	speed: 0.1128s/iter; left time: 2218.4820s
	iters: 200, epoch: 27 | loss: 0.2500837
	speed: 0.0215s/iter; left time: 420.9584s
Epoch: 27 cost time: 7.729417324066162
Epoch: 27, Steps: 267 | Train Loss: 0.2585686 Vali Loss: 0.5451111 Test Loss: 0.3993606
Validation loss decreased (0.545507 --> 0.545111).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2870961
	speed: 0.1565s/iter; left time: 3035.7921s
	iters: 200, epoch: 28 | loss: 0.2648277
	speed: 0.0228s/iter; left time: 439.2598s
Epoch: 28 cost time: 8.296876907348633
Epoch: 28, Steps: 267 | Train Loss: 0.2585247 Vali Loss: 0.5464274 Test Loss: 0.3994679
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2505970
	speed: 0.1358s/iter; left time: 2597.9960s
	iters: 200, epoch: 29 | loss: 0.2536730
	speed: 0.0224s/iter; left time: 426.8931s
Epoch: 29 cost time: 7.477352857589722
Epoch: 29, Steps: 267 | Train Loss: 0.2585856 Vali Loss: 0.5446764 Test Loss: 0.3990948
Validation loss decreased (0.545111 --> 0.544676).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2736939
	speed: 0.1248s/iter; left time: 2352.9462s
	iters: 200, epoch: 30 | loss: 0.2449142
	speed: 0.0200s/iter; left time: 376.0407s
Epoch: 30 cost time: 6.4865593910217285
Epoch: 30, Steps: 267 | Train Loss: 0.2586290 Vali Loss: 0.5453909 Test Loss: 0.3991247
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2471305
	speed: 0.1192s/iter; left time: 2215.2469s
	iters: 200, epoch: 31 | loss: 0.2452471
	speed: 0.0202s/iter; left time: 372.9039s
Epoch: 31 cost time: 7.123834133148193
Epoch: 31, Steps: 267 | Train Loss: 0.2586774 Vali Loss: 0.5453244 Test Loss: 0.3992175
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2617901
	speed: 0.0841s/iter; left time: 1541.6881s
	iters: 200, epoch: 32 | loss: 0.2364049
	speed: 0.0164s/iter; left time: 298.9350s
Epoch: 32 cost time: 4.926170587539673
Epoch: 32, Steps: 267 | Train Loss: 0.2584458 Vali Loss: 0.5456991 Test Loss: 0.3991574
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2874051
	speed: 0.1193s/iter; left time: 2154.3402s
	iters: 200, epoch: 33 | loss: 0.2917123
	speed: 0.0206s/iter; left time: 369.6125s
Epoch: 33 cost time: 7.598155498504639
Epoch: 33, Steps: 267 | Train Loss: 0.2586090 Vali Loss: 0.5453535 Test Loss: 0.3992222
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2390192
	speed: 0.1096s/iter; left time: 1950.5612s
	iters: 200, epoch: 34 | loss: 0.2566057
	speed: 0.0198s/iter; left time: 350.3920s
Epoch: 34 cost time: 6.3542540073394775
Epoch: 34, Steps: 267 | Train Loss: 0.2586697 Vali Loss: 0.5456774 Test Loss: 0.3991647
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2554412
	speed: 0.1370s/iter; left time: 2399.8869s
	iters: 200, epoch: 35 | loss: 0.2417472
	speed: 0.0362s/iter; left time: 630.7289s
Epoch: 35 cost time: 10.915444612503052
Epoch: 35, Steps: 267 | Train Loss: 0.2584780 Vali Loss: 0.5449432 Test Loss: 0.3990681
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2511971
	speed: 0.1555s/iter; left time: 2682.5772s
	iters: 200, epoch: 36 | loss: 0.2370094
	speed: 0.0211s/iter; left time: 361.7289s
Epoch: 36 cost time: 8.24352216720581
Epoch: 36, Steps: 267 | Train Loss: 0.2585911 Vali Loss: 0.5457255 Test Loss: 0.3991678
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2463410
	speed: 0.1061s/iter; left time: 1802.3652s
	iters: 200, epoch: 37 | loss: 0.2602699
	speed: 0.0140s/iter; left time: 236.2788s
Epoch: 37 cost time: 5.316380977630615
Epoch: 37, Steps: 267 | Train Loss: 0.2584906 Vali Loss: 0.5455265 Test Loss: 0.3992205
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2508478
	speed: 0.1056s/iter; left time: 1766.6203s
	iters: 200, epoch: 38 | loss: 0.2716621
	speed: 0.0185s/iter; left time: 307.9452s
Epoch: 38 cost time: 5.671322345733643
Epoch: 38, Steps: 267 | Train Loss: 0.2585426 Vali Loss: 0.5455343 Test Loss: 0.3992935
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2633532
	speed: 0.0925s/iter; left time: 1521.8412s
	iters: 200, epoch: 39 | loss: 0.2797326
	speed: 0.0280s/iter; left time: 457.2885s
Epoch: 39 cost time: 8.193365335464478
Epoch: 39, Steps: 267 | Train Loss: 0.2585500 Vali Loss: 0.5459398 Test Loss: 0.3992808
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2395764
	speed: 0.1365s/iter; left time: 2209.7636s
	iters: 200, epoch: 40 | loss: 0.2527473
	speed: 0.0297s/iter; left time: 477.2905s
Epoch: 40 cost time: 8.86204981803894
Epoch: 40, Steps: 267 | Train Loss: 0.2585422 Vali Loss: 0.5451841 Test Loss: 0.3992172
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2480686
	speed: 0.1826s/iter; left time: 2907.0041s
	iters: 200, epoch: 41 | loss: 0.2412627
	speed: 0.0253s/iter; left time: 400.6081s
Epoch: 41 cost time: 8.373723268508911
Epoch: 41, Steps: 267 | Train Loss: 0.2585251 Vali Loss: 0.5455742 Test Loss: 0.3992112
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2449890
	speed: 0.1559s/iter; left time: 2440.9202s
	iters: 200, epoch: 42 | loss: 0.2709611
	speed: 0.0327s/iter; left time: 508.7150s
Epoch: 42 cost time: 8.300974369049072
Epoch: 42, Steps: 267 | Train Loss: 0.2586292 Vali Loss: 0.5447155 Test Loss: 0.3992408
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2575879
	speed: 0.1192s/iter; left time: 1834.6155s
	iters: 200, epoch: 43 | loss: 0.2465930
	speed: 0.0252s/iter; left time: 384.5265s
Epoch: 43 cost time: 5.920032024383545
Epoch: 43, Steps: 267 | Train Loss: 0.2586265 Vali Loss: 0.5449442 Test Loss: 0.3993639
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2639256
	speed: 0.1017s/iter; left time: 1538.0561s
	iters: 200, epoch: 44 | loss: 0.2664058
	speed: 0.0201s/iter; left time: 301.9646s
Epoch: 44 cost time: 5.3321967124938965
Epoch: 44, Steps: 267 | Train Loss: 0.2585793 Vali Loss: 0.5454323 Test Loss: 0.3992564
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2658962
	speed: 0.1091s/iter; left time: 1620.3798s
	iters: 200, epoch: 45 | loss: 0.2603043
	speed: 0.0284s/iter; left time: 419.4406s
Epoch: 45 cost time: 7.384002685546875
Epoch: 45, Steps: 267 | Train Loss: 0.2586579 Vali Loss: 0.5454192 Test Loss: 0.3992872
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2648216
	speed: 0.1329s/iter; left time: 1938.9834s
	iters: 200, epoch: 46 | loss: 0.2447984
	speed: 0.0337s/iter; left time: 487.5016s
Epoch: 46 cost time: 8.439436197280884
Epoch: 46, Steps: 267 | Train Loss: 0.2586887 Vali Loss: 0.5453843 Test Loss: 0.3992938
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2715741
	speed: 0.1238s/iter; left time: 1772.0124s
	iters: 200, epoch: 47 | loss: 0.2531454
	speed: 0.0244s/iter; left time: 347.5386s
Epoch: 47 cost time: 8.333276748657227
Epoch: 47, Steps: 267 | Train Loss: 0.2586342 Vali Loss: 0.5459635 Test Loss: 0.3992220
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2605850
	speed: 0.1721s/iter; left time: 2418.1785s
	iters: 200, epoch: 48 | loss: 0.2342001
	speed: 0.0198s/iter; left time: 276.8350s
Epoch: 48 cost time: 7.722118616104126
Epoch: 48, Steps: 267 | Train Loss: 0.2585284 Vali Loss: 0.5455958 Test Loss: 0.3992706
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2396827
	speed: 0.1103s/iter; left time: 1519.8461s
	iters: 200, epoch: 49 | loss: 0.2516702
	speed: 0.0191s/iter; left time: 261.2759s
Epoch: 49 cost time: 6.56214714050293
Epoch: 49, Steps: 267 | Train Loss: 0.2585337 Vali Loss: 0.5448244 Test Loss: 0.3992958
EarlyStopping counter: 20 out of 20
Early stopping
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=24, out_features=75, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1612800.0
params:  1875.0
Trainable parameters:  1875
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3862722
	speed: 0.0242s/iter; left time: 645.0099s
	iters: 200, epoch: 1 | loss: 0.3556938
	speed: 0.0175s/iter; left time: 463.9013s
Epoch: 1 cost time: 5.663104772567749
Epoch: 1, Steps: 267 | Train Loss: 0.3743492 Vali Loss: 0.5442684 Test Loss: 0.3981482
Validation loss decreased (inf --> 0.544268).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3406297
	speed: 0.1056s/iter; left time: 2779.9623s
	iters: 200, epoch: 2 | loss: 0.3578026
	speed: 0.0158s/iter; left time: 414.1589s
Epoch: 2 cost time: 5.300133943557739
Epoch: 2, Steps: 267 | Train Loss: 0.3740093 Vali Loss: 0.5451911 Test Loss: 0.3987040
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3506448
	speed: 0.1306s/iter; left time: 3405.2714s
	iters: 200, epoch: 3 | loss: 0.3618245
	speed: 0.0241s/iter; left time: 626.6434s
Epoch: 3 cost time: 8.499990701675415
Epoch: 3, Steps: 267 | Train Loss: 0.3739655 Vali Loss: 0.5447968 Test Loss: 0.3985745
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3444043
	speed: 0.1617s/iter; left time: 4170.8280s
	iters: 200, epoch: 4 | loss: 0.3793539
	speed: 0.0269s/iter; left time: 691.3523s
Epoch: 4 cost time: 7.968011140823364
Epoch: 4, Steps: 267 | Train Loss: 0.3739140 Vali Loss: 0.5447554 Test Loss: 0.3983291
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4057136
	speed: 0.1116s/iter; left time: 2850.0040s
	iters: 200, epoch: 5 | loss: 0.4150074
	speed: 0.0266s/iter; left time: 677.0309s
Epoch: 5 cost time: 7.755659341812134
Epoch: 5, Steps: 267 | Train Loss: 0.3738256 Vali Loss: 0.5432371 Test Loss: 0.3982686
Validation loss decreased (0.544268 --> 0.543237).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3491387
	speed: 0.1126s/iter; left time: 2843.7015s
	iters: 200, epoch: 6 | loss: 0.3700600
	speed: 0.0209s/iter; left time: 527.0933s
Epoch: 6 cost time: 5.846956491470337
Epoch: 6, Steps: 267 | Train Loss: 0.3738289 Vali Loss: 0.5443058 Test Loss: 0.3979480
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4169540
	speed: 0.1233s/iter; left time: 3083.1715s
	iters: 200, epoch: 7 | loss: 0.3654906
	speed: 0.0200s/iter; left time: 498.6788s
Epoch: 7 cost time: 7.037888050079346
Epoch: 7, Steps: 267 | Train Loss: 0.3737793 Vali Loss: 0.5441037 Test Loss: 0.3988876
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3774885
	speed: 0.1017s/iter; left time: 2515.6018s
	iters: 200, epoch: 8 | loss: 0.4400542
	speed: 0.0247s/iter; left time: 609.5957s
Epoch: 8 cost time: 7.010338306427002
Epoch: 8, Steps: 267 | Train Loss: 0.3737392 Vali Loss: 0.5448588 Test Loss: 0.3988414
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3947662
	speed: 0.1490s/iter; left time: 3645.4386s
	iters: 200, epoch: 9 | loss: 0.3679617
	speed: 0.0209s/iter; left time: 509.1472s
Epoch: 9 cost time: 7.491990089416504
Epoch: 9, Steps: 267 | Train Loss: 0.3737386 Vali Loss: 0.5447319 Test Loss: 0.3987002
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.4162969
	speed: 0.1835s/iter; left time: 4440.5845s
	iters: 200, epoch: 10 | loss: 0.3862616
	speed: 0.0425s/iter; left time: 1023.9765s
Epoch: 10 cost time: 10.21284818649292
Epoch: 10, Steps: 267 | Train Loss: 0.3737049 Vali Loss: 0.5447904 Test Loss: 0.3985941
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.4121386
	speed: 0.1200s/iter; left time: 2871.3615s
	iters: 200, epoch: 11 | loss: 0.3714299
	speed: 0.0325s/iter; left time: 774.8975s
Epoch: 11 cost time: 7.736652374267578
Epoch: 11, Steps: 267 | Train Loss: 0.3736879 Vali Loss: 0.5448158 Test Loss: 0.3986165
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3658972
	speed: 0.1161s/iter; left time: 2747.2392s
	iters: 200, epoch: 12 | loss: 0.3486365
	speed: 0.0182s/iter; left time: 430.0156s
Epoch: 12 cost time: 4.829629182815552
Epoch: 12, Steps: 267 | Train Loss: 0.3735164 Vali Loss: 0.5444262 Test Loss: 0.3986359
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4002213
	speed: 0.1077s/iter; left time: 2520.7378s
	iters: 200, epoch: 13 | loss: 0.3720479
	speed: 0.0234s/iter; left time: 545.5526s
Epoch: 13 cost time: 7.403349876403809
Epoch: 13, Steps: 267 | Train Loss: 0.3735956 Vali Loss: 0.5440683 Test Loss: 0.3987150
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3922812
	speed: 0.1088s/iter; left time: 2517.2547s
	iters: 200, epoch: 14 | loss: 0.4148836
	speed: 0.0238s/iter; left time: 547.6166s
Epoch: 14 cost time: 8.17967414855957
Epoch: 14, Steps: 267 | Train Loss: 0.3736361 Vali Loss: 0.5444736 Test Loss: 0.3987420
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3444001
	speed: 0.1671s/iter; left time: 3821.1307s
	iters: 200, epoch: 15 | loss: 0.3834102
	speed: 0.0252s/iter; left time: 574.6131s
Epoch: 15 cost time: 10.405386447906494
Epoch: 15, Steps: 267 | Train Loss: 0.3734646 Vali Loss: 0.5434523 Test Loss: 0.3984502
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3949577
	speed: 0.1636s/iter; left time: 3697.5269s
	iters: 200, epoch: 16 | loss: 0.3888915
	speed: 0.0220s/iter; left time: 494.4157s
Epoch: 16 cost time: 7.507165431976318
Epoch: 16, Steps: 267 | Train Loss: 0.3735797 Vali Loss: 0.5442949 Test Loss: 0.3983575
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3730335
	speed: 0.1339s/iter; left time: 2990.1901s
	iters: 200, epoch: 17 | loss: 0.3686111
	speed: 0.0253s/iter; left time: 562.4870s
Epoch: 17 cost time: 8.556034564971924
Epoch: 17, Steps: 267 | Train Loss: 0.3736205 Vali Loss: 0.5443562 Test Loss: 0.3985945
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.4526528
	speed: 0.1192s/iter; left time: 2629.0571s
	iters: 200, epoch: 18 | loss: 0.4405844
	speed: 0.0171s/iter; left time: 376.1136s
Epoch: 18 cost time: 5.798418045043945
Epoch: 18, Steps: 267 | Train Loss: 0.3735961 Vali Loss: 0.5439069 Test Loss: 0.3984633
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.4020745
	speed: 0.1118s/iter; left time: 2436.5683s
	iters: 200, epoch: 19 | loss: 0.3443792
	speed: 0.0168s/iter; left time: 364.8416s
Epoch: 19 cost time: 6.390499830245972
Epoch: 19, Steps: 267 | Train Loss: 0.3737604 Vali Loss: 0.5445759 Test Loss: 0.3986301
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3549803
	speed: 0.1118s/iter; left time: 2406.0680s
	iters: 200, epoch: 20 | loss: 0.3557250
	speed: 0.0287s/iter; left time: 615.1654s
Epoch: 20 cost time: 7.9231932163238525
Epoch: 20, Steps: 267 | Train Loss: 0.3735923 Vali Loss: 0.5437527 Test Loss: 0.3985811
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.4014684
	speed: 0.1263s/iter; left time: 2684.9689s
	iters: 200, epoch: 21 | loss: 0.4231779
	speed: 0.0277s/iter; left time: 587.0968s
Epoch: 21 cost time: 8.910556077957153
Epoch: 21, Steps: 267 | Train Loss: 0.3735184 Vali Loss: 0.5443630 Test Loss: 0.3985896
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3630599
	speed: 0.1441s/iter; left time: 3025.9496s
	iters: 200, epoch: 22 | loss: 0.3745162
	speed: 0.0251s/iter; left time: 523.7684s
Epoch: 22 cost time: 9.114359855651855
Epoch: 22, Steps: 267 | Train Loss: 0.3734998 Vali Loss: 0.5436140 Test Loss: 0.3983983
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3632832
	speed: 0.1294s/iter; left time: 2681.1294s
	iters: 200, epoch: 23 | loss: 0.3608937
	speed: 0.0243s/iter; left time: 501.3485s
Epoch: 23 cost time: 8.416694641113281
Epoch: 23, Steps: 267 | Train Loss: 0.3735314 Vali Loss: 0.5439873 Test Loss: 0.3985103
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3918061
	speed: 0.1070s/iter; left time: 2189.6653s
	iters: 200, epoch: 24 | loss: 0.3765464
	speed: 0.0198s/iter; left time: 402.1993s
Epoch: 24 cost time: 5.9547340869903564
Epoch: 24, Steps: 267 | Train Loss: 0.3735056 Vali Loss: 0.5448212 Test Loss: 0.3983701
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.4215081
	speed: 0.1228s/iter; left time: 2478.8835s
	iters: 200, epoch: 25 | loss: 0.3772386
	speed: 0.0226s/iter; left time: 454.9328s
Epoch: 25 cost time: 7.933242321014404
Epoch: 25, Steps: 267 | Train Loss: 0.3736217 Vali Loss: 0.5442694 Test Loss: 0.3983943
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_192_FITS_ETTm1_ftM_sl90_ll48_pl192_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.39924880862236023, mae:0.39785951375961304, rse:0.6014829277992249, corr:[0.5499795  0.5509003  0.54532963 0.54494494 0.5438716  0.5403263
 0.5381223  0.5373056  0.53578717 0.5339305  0.5329569  0.532497
 0.5317321  0.5300712  0.5271783  0.5235323  0.52028924 0.51738393
 0.51413673 0.51084477 0.50804806 0.5053357  0.5019971  0.49839526
 0.4952998  0.49222258 0.4889938  0.48632875 0.48474407 0.48326528
 0.4817203  0.4814934  0.4821291  0.48263156 0.48251933 0.48255762
 0.48277596 0.48296684 0.48281914 0.48249817 0.48245975 0.48225978
 0.48202914 0.48218828 0.4824178  0.4822484  0.48173115 0.4814678
 0.48183635 0.48245302 0.48276895 0.48274347 0.48309588 0.48370844
 0.48425448 0.48448524 0.4848125  0.48513785 0.48498806 0.4847753
 0.48483035 0.48472354 0.48448503 0.48394686 0.48357448 0.48339576
 0.48319817 0.48295367 0.48289576 0.4831674  0.4835802  0.48421428
 0.4849301  0.48536494 0.4858155  0.4863199  0.48714927 0.48812675
 0.48898187 0.48974657 0.49038073 0.4906607  0.4909783  0.4913621
 0.49183005 0.4921542  0.49236682 0.4927843  0.49366862 0.49489474
 0.49602276 0.49668914 0.49697542 0.4971509  0.49738088 0.49747312
 0.49693656 0.49594608 0.49494296 0.4939987  0.49313876 0.49265265
 0.49242884 0.49203265 0.4916021  0.49131447 0.49097383 0.4903667
 0.48960564 0.48875386 0.4877456  0.48663583 0.48563325 0.48477027
 0.48390043 0.48321635 0.48255298 0.48154816 0.4801231  0.47869554
 0.4776826  0.47665712 0.4753883  0.47436702 0.47378907 0.47342685
 0.472876   0.47207466 0.47157085 0.47167182 0.4719235  0.47186497
 0.47157377 0.4715966  0.47162274 0.47133636 0.47098026 0.47099555
 0.4712051  0.47126952 0.47120127 0.47117713 0.47106203 0.47095305
 0.47104067 0.47142595 0.47178835 0.47182158 0.47195223 0.4720656
 0.47202167 0.47212207 0.4723522  0.47248596 0.47231895 0.47220102
 0.47230297 0.47241327 0.47218233 0.47184673 0.47189566 0.4719924
 0.47178763 0.47157878 0.47191417 0.47261962 0.47325903 0.47377422
 0.47440523 0.4750435  0.475499   0.4762057  0.4771906  0.47817272
 0.47890386 0.4795797  0.4802212  0.48075113 0.48122415 0.48188898
 0.48263904 0.4836432  0.4847348  0.48553836 0.48624334 0.48750064
 0.48903862 0.4902578  0.49187458 0.49388084 0.49525568 0.49833965]
