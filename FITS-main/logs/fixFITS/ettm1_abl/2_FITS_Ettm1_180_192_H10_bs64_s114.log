Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=30, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=30, out_features=62, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1666560.0
params:  1922.0
Trainable parameters:  1922
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4863907
	speed: 0.0176s/iter; left time: 468.8988s
	iters: 200, epoch: 1 | loss: 0.3570732
	speed: 0.0117s/iter; left time: 309.6711s
Epoch: 1 cost time: 3.6738014221191406
Epoch: 1, Steps: 267 | Train Loss: 0.4164395 Vali Loss: 0.7583047 Test Loss: 0.5538214
Validation loss decreased (inf --> 0.758305).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2659122
	speed: 0.0596s/iter; left time: 1570.6200s
	iters: 200, epoch: 2 | loss: 0.2685911
	speed: 0.0107s/iter; left time: 279.7520s
Epoch: 2 cost time: 3.4932072162628174
Epoch: 2, Steps: 267 | Train Loss: 0.2715462 Vali Loss: 0.6558840 Test Loss: 0.4589366
Validation loss decreased (0.758305 --> 0.655884).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2256121
	speed: 0.0617s/iter; left time: 1608.8780s
	iters: 200, epoch: 3 | loss: 0.2449699
	speed: 0.0109s/iter; left time: 281.9376s
Epoch: 3 cost time: 3.488886594772339
Epoch: 3, Steps: 267 | Train Loss: 0.2311200 Vali Loss: 0.6094945 Test Loss: 0.4173274
Validation loss decreased (0.655884 --> 0.609495).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2219528
	speed: 0.0619s/iter; left time: 1598.0559s
	iters: 200, epoch: 4 | loss: 0.2273890
	speed: 0.0119s/iter; left time: 304.8338s
Epoch: 4 cost time: 3.6082444190979004
Epoch: 4, Steps: 267 | Train Loss: 0.2109809 Vali Loss: 0.5800143 Test Loss: 0.3925423
Validation loss decreased (0.609495 --> 0.580014).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2069845
	speed: 0.0627s/iter; left time: 1599.8386s
	iters: 200, epoch: 5 | loss: 0.1835203
	speed: 0.0109s/iter; left time: 276.5139s
Epoch: 5 cost time: 3.5028235912323
Epoch: 5, Steps: 267 | Train Loss: 0.1989219 Vali Loss: 0.5614084 Test Loss: 0.3761343
Validation loss decreased (0.580014 --> 0.561408).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1993533
	speed: 0.0622s/iter; left time: 1570.3620s
	iters: 200, epoch: 6 | loss: 0.1928280
	speed: 0.0109s/iter; left time: 273.7032s
Epoch: 6 cost time: 3.4601223468780518
Epoch: 6, Steps: 267 | Train Loss: 0.1914004 Vali Loss: 0.5504653 Test Loss: 0.3673409
Validation loss decreased (0.561408 --> 0.550465).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1713098
	speed: 0.0607s/iter; left time: 1517.5693s
	iters: 200, epoch: 7 | loss: 0.1826479
	speed: 0.0102s/iter; left time: 253.0549s
Epoch: 7 cost time: 3.276595115661621
Epoch: 7, Steps: 267 | Train Loss: 0.1866856 Vali Loss: 0.5422707 Test Loss: 0.3611438
Validation loss decreased (0.550465 --> 0.542271).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1885506
	speed: 0.0611s/iter; left time: 1511.4921s
	iters: 200, epoch: 8 | loss: 0.1965016
	speed: 0.0104s/iter; left time: 256.6252s
Epoch: 8 cost time: 3.389479398727417
Epoch: 8, Steps: 267 | Train Loss: 0.1837889 Vali Loss: 0.5374088 Test Loss: 0.3572537
Validation loss decreased (0.542271 --> 0.537409).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1847011
	speed: 0.0603s/iter; left time: 1475.3728s
	iters: 200, epoch: 9 | loss: 0.1877081
	speed: 0.0104s/iter; left time: 252.1975s
Epoch: 9 cost time: 3.322502613067627
Epoch: 9, Steps: 267 | Train Loss: 0.1819856 Vali Loss: 0.5344610 Test Loss: 0.3547379
Validation loss decreased (0.537409 --> 0.534461).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1850341
	speed: 0.0605s/iter; left time: 1464.7449s
	iters: 200, epoch: 10 | loss: 0.1893092
	speed: 0.0104s/iter; left time: 250.0337s
Epoch: 10 cost time: 3.3649401664733887
Epoch: 10, Steps: 267 | Train Loss: 0.1809170 Vali Loss: 0.5312338 Test Loss: 0.3531703
Validation loss decreased (0.534461 --> 0.531234).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1704588
	speed: 0.0596s/iter; left time: 1426.5641s
	iters: 200, epoch: 11 | loss: 0.1804385
	speed: 0.0103s/iter; left time: 245.9864s
Epoch: 11 cost time: 3.377760887145996
Epoch: 11, Steps: 267 | Train Loss: 0.1803046 Vali Loss: 0.5294570 Test Loss: 0.3524642
Validation loss decreased (0.531234 --> 0.529457).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1820957
	speed: 0.0620s/iter; left time: 1467.4297s
	iters: 200, epoch: 12 | loss: 0.1933373
	speed: 0.0108s/iter; left time: 253.5635s
Epoch: 12 cost time: 3.514951467514038
Epoch: 12, Steps: 267 | Train Loss: 0.1799572 Vali Loss: 0.5293107 Test Loss: 0.3515647
Validation loss decreased (0.529457 --> 0.529311).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1850944
	speed: 0.0612s/iter; left time: 1430.8546s
	iters: 200, epoch: 13 | loss: 0.1830805
	speed: 0.0109s/iter; left time: 254.4921s
Epoch: 13 cost time: 3.5290417671203613
Epoch: 13, Steps: 267 | Train Loss: 0.1797466 Vali Loss: 0.5288603 Test Loss: 0.3508671
Validation loss decreased (0.529311 --> 0.528860).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1686629
	speed: 0.0618s/iter; left time: 1429.8981s
	iters: 200, epoch: 14 | loss: 0.1783556
	speed: 0.0107s/iter; left time: 245.3637s
Epoch: 14 cost time: 3.4483728408813477
Epoch: 14, Steps: 267 | Train Loss: 0.1796862 Vali Loss: 0.5287299 Test Loss: 0.3510918
Validation loss decreased (0.528860 --> 0.528730).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1819890
	speed: 0.0606s/iter; left time: 1386.4201s
	iters: 200, epoch: 15 | loss: 0.1724194
	speed: 0.0102s/iter; left time: 231.4206s
Epoch: 15 cost time: 3.2953710556030273
Epoch: 15, Steps: 267 | Train Loss: 0.1796133 Vali Loss: 0.5270424 Test Loss: 0.3507747
Validation loss decreased (0.528730 --> 0.527042).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1926831
	speed: 0.0626s/iter; left time: 1413.6629s
	iters: 200, epoch: 16 | loss: 0.1826618
	speed: 0.0103s/iter; left time: 230.7507s
Epoch: 16 cost time: 3.4842729568481445
Epoch: 16, Steps: 267 | Train Loss: 0.1796005 Vali Loss: 0.5278109 Test Loss: 0.3509662
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1793465
	speed: 0.0612s/iter; left time: 1366.8034s
	iters: 200, epoch: 17 | loss: 0.1579663
	speed: 0.0107s/iter; left time: 238.8452s
Epoch: 17 cost time: 3.453099012374878
Epoch: 17, Steps: 267 | Train Loss: 0.1795829 Vali Loss: 0.5273449 Test Loss: 0.3508258
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1756491
	speed: 0.0623s/iter; left time: 1373.4114s
	iters: 200, epoch: 18 | loss: 0.1633255
	speed: 0.0121s/iter; left time: 265.7299s
Epoch: 18 cost time: 3.653805732727051
Epoch: 18, Steps: 267 | Train Loss: 0.1795973 Vali Loss: 0.5271195 Test Loss: 0.3506156
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1937418
	speed: 0.0630s/iter; left time: 1373.1431s
	iters: 200, epoch: 19 | loss: 0.1936992
	speed: 0.0110s/iter; left time: 239.6032s
Epoch: 19 cost time: 3.6024680137634277
Epoch: 19, Steps: 267 | Train Loss: 0.1795726 Vali Loss: 0.5280524 Test Loss: 0.3507340
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1748278
	speed: 0.0643s/iter; left time: 1383.6839s
	iters: 200, epoch: 20 | loss: 0.1923252
	speed: 0.0111s/iter; left time: 237.0302s
Epoch: 20 cost time: 3.604231834411621
Epoch: 20, Steps: 267 | Train Loss: 0.1795400 Vali Loss: 0.5274475 Test Loss: 0.3505968
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1700145
	speed: 0.0637s/iter; left time: 1354.3600s
	iters: 200, epoch: 21 | loss: 0.1728379
	speed: 0.0111s/iter; left time: 234.1287s
Epoch: 21 cost time: 3.478752851486206
Epoch: 21, Steps: 267 | Train Loss: 0.1795602 Vali Loss: 0.5277855 Test Loss: 0.3507246
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1806257
	speed: 0.0616s/iter; left time: 1293.1707s
	iters: 200, epoch: 22 | loss: 0.1746857
	speed: 0.0107s/iter; left time: 224.4065s
Epoch: 22 cost time: 3.52108097076416
Epoch: 22, Steps: 267 | Train Loss: 0.1795756 Vali Loss: 0.5267667 Test Loss: 0.3506197
Validation loss decreased (0.527042 --> 0.526767).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1670072
	speed: 0.0617s/iter; left time: 1278.3804s
	iters: 200, epoch: 23 | loss: 0.1946370
	speed: 0.0104s/iter; left time: 214.6608s
Epoch: 23 cost time: 3.401294231414795
Epoch: 23, Steps: 267 | Train Loss: 0.1795463 Vali Loss: 0.5277728 Test Loss: 0.3508028
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1857539
	speed: 0.0609s/iter; left time: 1245.4516s
	iters: 200, epoch: 24 | loss: 0.1688580
	speed: 0.0107s/iter; left time: 218.5261s
Epoch: 24 cost time: 3.449622869491577
Epoch: 24, Steps: 267 | Train Loss: 0.1795490 Vali Loss: 0.5279900 Test Loss: 0.3508826
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1651862
	speed: 0.0598s/iter; left time: 1207.3601s
	iters: 200, epoch: 25 | loss: 0.1736919
	speed: 0.0113s/iter; left time: 226.3539s
Epoch: 25 cost time: 3.4927971363067627
Epoch: 25, Steps: 267 | Train Loss: 0.1795814 Vali Loss: 0.5278549 Test Loss: 0.3507889
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1800950
	speed: 0.0618s/iter; left time: 1230.7311s
	iters: 200, epoch: 26 | loss: 0.1923612
	speed: 0.0108s/iter; left time: 214.5121s
Epoch: 26 cost time: 3.533705472946167
Epoch: 26, Steps: 267 | Train Loss: 0.1795698 Vali Loss: 0.5273332 Test Loss: 0.3506907
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1554094
	speed: 0.0616s/iter; left time: 1210.3540s
	iters: 200, epoch: 27 | loss: 0.1716914
	speed: 0.0107s/iter; left time: 208.5382s
Epoch: 27 cost time: 3.470067262649536
Epoch: 27, Steps: 267 | Train Loss: 0.1795651 Vali Loss: 0.5266489 Test Loss: 0.3507745
Validation loss decreased (0.526767 --> 0.526649).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1613456
	speed: 0.0598s/iter; left time: 1159.0219s
	iters: 200, epoch: 28 | loss: 0.1961697
	speed: 0.0109s/iter; left time: 210.5933s
Epoch: 28 cost time: 3.3981664180755615
Epoch: 28, Steps: 267 | Train Loss: 0.1795466 Vali Loss: 0.5269926 Test Loss: 0.3508463
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1711112
	speed: 0.0619s/iter; left time: 1183.6147s
	iters: 200, epoch: 29 | loss: 0.1636271
	speed: 0.0104s/iter; left time: 198.4106s
Epoch: 29 cost time: 3.50610613822937
Epoch: 29, Steps: 267 | Train Loss: 0.1795816 Vali Loss: 0.5276033 Test Loss: 0.3509111
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1891214
	speed: 0.0618s/iter; left time: 1164.8570s
	iters: 200, epoch: 30 | loss: 0.2142180
	speed: 0.0105s/iter; left time: 197.7825s
Epoch: 30 cost time: 3.458298444747925
Epoch: 30, Steps: 267 | Train Loss: 0.1795589 Vali Loss: 0.5272930 Test Loss: 0.3507312
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1777679
	speed: 0.0620s/iter; left time: 1153.2914s
	iters: 200, epoch: 31 | loss: 0.1712497
	speed: 0.0105s/iter; left time: 194.2033s
Epoch: 31 cost time: 3.4995055198669434
Epoch: 31, Steps: 267 | Train Loss: 0.1795535 Vali Loss: 0.5277361 Test Loss: 0.3507444
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1748423
	speed: 0.0618s/iter; left time: 1132.7559s
	iters: 200, epoch: 32 | loss: 0.1850568
	speed: 0.0102s/iter; left time: 186.5029s
Epoch: 32 cost time: 3.4416821002960205
Epoch: 32, Steps: 267 | Train Loss: 0.1795458 Vali Loss: 0.5276074 Test Loss: 0.3508113
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1686307
	speed: 0.0619s/iter; left time: 1118.3708s
	iters: 200, epoch: 33 | loss: 0.1622471
	speed: 0.0105s/iter; left time: 188.3769s
Epoch: 33 cost time: 3.4553754329681396
Epoch: 33, Steps: 267 | Train Loss: 0.1795671 Vali Loss: 0.5271274 Test Loss: 0.3508031
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1756269
	speed: 0.0629s/iter; left time: 1119.3001s
	iters: 200, epoch: 34 | loss: 0.1554207
	speed: 0.0110s/iter; left time: 195.4002s
Epoch: 34 cost time: 3.6988139152526855
Epoch: 34, Steps: 267 | Train Loss: 0.1795284 Vali Loss: 0.5272065 Test Loss: 0.3507500
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1994460
	speed: 0.0736s/iter; left time: 1290.5034s
	iters: 200, epoch: 35 | loss: 0.1693786
	speed: 0.0290s/iter; left time: 505.9371s
Epoch: 35 cost time: 6.449175596237183
Epoch: 35, Steps: 267 | Train Loss: 0.1795700 Vali Loss: 0.5267034 Test Loss: 0.3509435
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1734067
	speed: 0.0625s/iter; left time: 1078.4516s
	iters: 200, epoch: 36 | loss: 0.1934586
	speed: 0.0114s/iter; left time: 195.2115s
Epoch: 36 cost time: 3.635829210281372
Epoch: 36, Steps: 267 | Train Loss: 0.1795493 Vali Loss: 0.5273523 Test Loss: 0.3508293
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1823384
	speed: 0.0623s/iter; left time: 1058.3360s
	iters: 200, epoch: 37 | loss: 0.1752391
	speed: 0.0104s/iter; left time: 176.2050s
Epoch: 37 cost time: 3.538360357284546
Epoch: 37, Steps: 267 | Train Loss: 0.1795493 Vali Loss: 0.5269971 Test Loss: 0.3508739
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1737760
	speed: 0.0607s/iter; left time: 1015.5460s
	iters: 200, epoch: 38 | loss: 0.1729519
	speed: 0.0103s/iter; left time: 171.5683s
Epoch: 38 cost time: 3.416832685470581
Epoch: 38, Steps: 267 | Train Loss: 0.1795445 Vali Loss: 0.5278833 Test Loss: 0.3508130
EarlyStopping counter: 11 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1617277
	speed: 0.0636s/iter; left time: 1046.0831s
	iters: 200, epoch: 39 | loss: 0.1602281
	speed: 0.0106s/iter; left time: 174.0567s
Epoch: 39 cost time: 3.536102771759033
Epoch: 39, Steps: 267 | Train Loss: 0.1795417 Vali Loss: 0.5271927 Test Loss: 0.3509462
EarlyStopping counter: 12 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1759896
	speed: 0.0619s/iter; left time: 1002.1782s
	iters: 200, epoch: 40 | loss: 0.1870358
	speed: 0.0102s/iter; left time: 164.0156s
Epoch: 40 cost time: 3.410142183303833
Epoch: 40, Steps: 267 | Train Loss: 0.1795368 Vali Loss: 0.5268959 Test Loss: 0.3508083
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1735317
	speed: 0.0585s/iter; left time: 931.7138s
	iters: 200, epoch: 41 | loss: 0.1770201
	speed: 0.0105s/iter; left time: 165.7900s
Epoch: 41 cost time: 3.358201026916504
Epoch: 41, Steps: 267 | Train Loss: 0.1795350 Vali Loss: 0.5278069 Test Loss: 0.3508547
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1597113
	speed: 0.0646s/iter; left time: 1010.8125s
	iters: 200, epoch: 42 | loss: 0.1809059
	speed: 0.0109s/iter; left time: 170.1037s
Epoch: 42 cost time: 3.551318883895874
Epoch: 42, Steps: 267 | Train Loss: 0.1795341 Vali Loss: 0.5279658 Test Loss: 0.3508685
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1986357
	speed: 0.0681s/iter; left time: 1048.6110s
	iters: 200, epoch: 43 | loss: 0.1707134
	speed: 0.0109s/iter; left time: 166.1334s
Epoch: 43 cost time: 3.8740415573120117
Epoch: 43, Steps: 267 | Train Loss: 0.1795618 Vali Loss: 0.5270481 Test Loss: 0.3508421
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1668279
	speed: 0.0643s/iter; left time: 971.5458s
	iters: 200, epoch: 44 | loss: 0.1602173
	speed: 0.0109s/iter; left time: 163.5883s
Epoch: 44 cost time: 3.5849268436431885
Epoch: 44, Steps: 267 | Train Loss: 0.1795436 Vali Loss: 0.5280234 Test Loss: 0.3508529
EarlyStopping counter: 17 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1889432
	speed: 0.0616s/iter; left time: 914.2680s
	iters: 200, epoch: 45 | loss: 0.1852551
	speed: 0.0107s/iter; left time: 158.1005s
Epoch: 45 cost time: 3.4710023403167725
Epoch: 45, Steps: 267 | Train Loss: 0.1795048 Vali Loss: 0.5282214 Test Loss: 0.3508093
EarlyStopping counter: 18 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1792458
	speed: 0.0605s/iter; left time: 882.7761s
	iters: 200, epoch: 46 | loss: 0.1841526
	speed: 0.0107s/iter; left time: 155.1881s
Epoch: 46 cost time: 3.554311990737915
Epoch: 46, Steps: 267 | Train Loss: 0.1795486 Vali Loss: 0.5279472 Test Loss: 0.3508329
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1787478
	speed: 0.0647s/iter; left time: 926.9575s
	iters: 200, epoch: 47 | loss: 0.1815409
	speed: 0.0109s/iter; left time: 154.5749s
Epoch: 47 cost time: 3.5535216331481934
Epoch: 47, Steps: 267 | Train Loss: 0.1795320 Vali Loss: 0.5276890 Test Loss: 0.3508116
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=30, out_features=62, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1666560.0
params:  1922.0
Trainable parameters:  1922
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3220642
	speed: 0.0191s/iter; left time: 508.5469s
	iters: 200, epoch: 1 | loss: 0.3262573
	speed: 0.0120s/iter; left time: 319.0586s
Epoch: 1 cost time: 3.9787487983703613
Epoch: 1, Steps: 267 | Train Loss: 0.3315809 Vali Loss: 0.5249832 Test Loss: 0.3488426
Validation loss decreased (inf --> 0.524983).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3221417
	speed: 0.0618s/iter; left time: 1627.9004s
	iters: 200, epoch: 2 | loss: 0.3268207
	speed: 0.0124s/iter; left time: 326.3734s
Epoch: 2 cost time: 3.7393720149993896
Epoch: 2, Steps: 267 | Train Loss: 0.3307797 Vali Loss: 0.5234308 Test Loss: 0.3481051
Validation loss decreased (0.524983 --> 0.523431).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3234368
	speed: 0.0662s/iter; left time: 1726.4866s
	iters: 200, epoch: 3 | loss: 0.3307209
	speed: 0.0130s/iter; left time: 337.3245s
Epoch: 3 cost time: 3.9910385608673096
Epoch: 3, Steps: 267 | Train Loss: 0.3305286 Vali Loss: 0.5226842 Test Loss: 0.3479150
Validation loss decreased (0.523431 --> 0.522684).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3399718
	speed: 0.0653s/iter; left time: 1684.5799s
	iters: 200, epoch: 4 | loss: 0.3212765
	speed: 0.0104s/iter; left time: 267.5834s
Epoch: 4 cost time: 3.5829944610595703
Epoch: 4, Steps: 267 | Train Loss: 0.3303504 Vali Loss: 0.5230282 Test Loss: 0.3475341
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3363454
	speed: 0.0588s/iter; left time: 1500.8001s
	iters: 200, epoch: 5 | loss: 0.3478608
	speed: 0.0104s/iter; left time: 264.6603s
Epoch: 5 cost time: 3.250739574432373
Epoch: 5, Steps: 267 | Train Loss: 0.3302568 Vali Loss: 0.5211034 Test Loss: 0.3478080
Validation loss decreased (0.522684 --> 0.521103).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3128942
	speed: 0.0609s/iter; left time: 1538.6775s
	iters: 200, epoch: 6 | loss: 0.3275191
	speed: 0.0105s/iter; left time: 264.1335s
Epoch: 6 cost time: 3.4036271572113037
Epoch: 6, Steps: 267 | Train Loss: 0.3301827 Vali Loss: 0.5220392 Test Loss: 0.3474264
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3393790
	speed: 0.0631s/iter; left time: 1576.6438s
	iters: 200, epoch: 7 | loss: 0.3402312
	speed: 0.0108s/iter; left time: 269.7787s
Epoch: 7 cost time: 3.537504196166992
Epoch: 7, Steps: 267 | Train Loss: 0.3300852 Vali Loss: 0.5222198 Test Loss: 0.3479050
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2906022
	speed: 0.0615s/iter; left time: 1521.5232s
	iters: 200, epoch: 8 | loss: 0.2955196
	speed: 0.0108s/iter; left time: 265.9678s
Epoch: 8 cost time: 3.5949180126190186
Epoch: 8, Steps: 267 | Train Loss: 0.3300162 Vali Loss: 0.5219104 Test Loss: 0.3476777
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3445453
	speed: 0.0611s/iter; left time: 1495.4074s
	iters: 200, epoch: 9 | loss: 0.3510163
	speed: 0.0109s/iter; left time: 266.1784s
Epoch: 9 cost time: 3.5763676166534424
Epoch: 9, Steps: 267 | Train Loss: 0.3300199 Vali Loss: 0.5220943 Test Loss: 0.3473161
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3105611
	speed: 0.0603s/iter; left time: 1458.9162s
	iters: 200, epoch: 10 | loss: 0.3283311
	speed: 0.0104s/iter; left time: 250.7800s
Epoch: 10 cost time: 3.459435224533081
Epoch: 10, Steps: 267 | Train Loss: 0.3299765 Vali Loss: 0.5218764 Test Loss: 0.3475803
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3432747
	speed: 0.0600s/iter; left time: 1435.1219s
	iters: 200, epoch: 11 | loss: 0.3503141
	speed: 0.0104s/iter; left time: 248.5648s
Epoch: 11 cost time: 3.3565826416015625
Epoch: 11, Steps: 267 | Train Loss: 0.3299494 Vali Loss: 0.5220420 Test Loss: 0.3477068
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3838488
	speed: 0.0596s/iter; left time: 1410.7291s
	iters: 200, epoch: 12 | loss: 0.3139376
	speed: 0.0106s/iter; left time: 250.6555s
Epoch: 12 cost time: 3.413384199142456
Epoch: 12, Steps: 267 | Train Loss: 0.3299098 Vali Loss: 0.5221277 Test Loss: 0.3474616
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3378060
	speed: 0.0614s/iter; left time: 1437.5776s
	iters: 200, epoch: 13 | loss: 0.3248762
	speed: 0.0103s/iter; left time: 239.7318s
Epoch: 13 cost time: 3.5134100914001465
Epoch: 13, Steps: 267 | Train Loss: 0.3298925 Vali Loss: 0.5216078 Test Loss: 0.3475896
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3885550
	speed: 0.0607s/iter; left time: 1403.0107s
	iters: 200, epoch: 14 | loss: 0.3733407
	speed: 0.0107s/iter; left time: 246.1529s
Epoch: 14 cost time: 3.51521635055542
Epoch: 14, Steps: 267 | Train Loss: 0.3298807 Vali Loss: 0.5219603 Test Loss: 0.3473452
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3235455
	speed: 0.0622s/iter; left time: 1422.4620s
	iters: 200, epoch: 15 | loss: 0.3155152
	speed: 0.0112s/iter; left time: 254.6477s
Epoch: 15 cost time: 3.6980738639831543
Epoch: 15, Steps: 267 | Train Loss: 0.3298739 Vali Loss: 0.5217854 Test Loss: 0.3474153
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3549975
	speed: 0.0631s/iter; left time: 1425.9614s
	iters: 200, epoch: 16 | loss: 0.3520602
	speed: 0.0105s/iter; left time: 236.5796s
Epoch: 16 cost time: 3.4960856437683105
Epoch: 16, Steps: 267 | Train Loss: 0.3298471 Vali Loss: 0.5217291 Test Loss: 0.3471946
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3260483
	speed: 0.0633s/iter; left time: 1412.8656s
	iters: 200, epoch: 17 | loss: 0.3413110
	speed: 0.0107s/iter; left time: 238.9300s
Epoch: 17 cost time: 3.552809715270996
Epoch: 17, Steps: 267 | Train Loss: 0.3298441 Vali Loss: 0.5221479 Test Loss: 0.3474643
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2968258
	speed: 0.0597s/iter; left time: 1317.8698s
	iters: 200, epoch: 18 | loss: 0.3434847
	speed: 0.0104s/iter; left time: 228.0393s
Epoch: 18 cost time: 3.345543384552002
Epoch: 18, Steps: 267 | Train Loss: 0.3297981 Vali Loss: 0.5222188 Test Loss: 0.3473692
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2944663
	speed: 0.0614s/iter; left time: 1338.2031s
	iters: 200, epoch: 19 | loss: 0.3579819
	speed: 0.0102s/iter; left time: 220.6862s
Epoch: 19 cost time: 3.4036688804626465
Epoch: 19, Steps: 267 | Train Loss: 0.3298102 Vali Loss: 0.5216299 Test Loss: 0.3474516
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3332454
	speed: 0.0619s/iter; left time: 1333.0655s
	iters: 200, epoch: 20 | loss: 0.3524282
	speed: 0.0109s/iter; left time: 234.0233s
Epoch: 20 cost time: 3.5231130123138428
Epoch: 20, Steps: 267 | Train Loss: 0.3297464 Vali Loss: 0.5221702 Test Loss: 0.3475782
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3129971
	speed: 0.0585s/iter; left time: 1244.7934s
	iters: 200, epoch: 21 | loss: 0.2924278
	speed: 0.0103s/iter; left time: 218.9998s
Epoch: 21 cost time: 3.365906238555908
Epoch: 21, Steps: 267 | Train Loss: 0.3297847 Vali Loss: 0.5211422 Test Loss: 0.3473955
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3117663
	speed: 0.0600s/iter; left time: 1258.7036s
	iters: 200, epoch: 22 | loss: 0.3634084
	speed: 0.0108s/iter; left time: 225.6445s
Epoch: 22 cost time: 3.5177576541900635
Epoch: 22, Steps: 267 | Train Loss: 0.3297228 Vali Loss: 0.5216247 Test Loss: 0.3474798
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3438639
	speed: 0.0621s/iter; left time: 1286.8028s
	iters: 200, epoch: 23 | loss: 0.3299637
	speed: 0.0109s/iter; left time: 224.8507s
Epoch: 23 cost time: 3.5614402294158936
Epoch: 23, Steps: 267 | Train Loss: 0.3297813 Vali Loss: 0.5220343 Test Loss: 0.3471816
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3100518
	speed: 0.0621s/iter; left time: 1270.8198s
	iters: 200, epoch: 24 | loss: 0.3170279
	speed: 0.0105s/iter; left time: 213.1970s
Epoch: 24 cost time: 3.417163848876953
Epoch: 24, Steps: 267 | Train Loss: 0.3297577 Vali Loss: 0.5211315 Test Loss: 0.3474857
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3175740
	speed: 0.0617s/iter; left time: 1245.2004s
	iters: 200, epoch: 25 | loss: 0.3386477
	speed: 0.0110s/iter; left time: 221.0507s
Epoch: 25 cost time: 3.4783806800842285
Epoch: 25, Steps: 267 | Train Loss: 0.3296934 Vali Loss: 0.5217286 Test Loss: 0.3475970
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3480028212070465, mae:0.36895522475242615, rse:0.561555802822113, corr:[0.54759353 0.554397   0.5529797  0.5492781  0.5477848  0.54861015
 0.54956174 0.54948896 0.548623   0.54830754 0.5489095  0.5492341
 0.5486785  0.54716456 0.545261   0.5433723  0.54151696 0.53971255
 0.53802335 0.53637993 0.5345862  0.5324704  0.53010476 0.52776116
 0.52559626 0.5236615  0.52200097 0.5204903  0.5192446  0.5184533
 0.51839006 0.5189053  0.5195583  0.5199959  0.5199669  0.519581
 0.5189627  0.5183454  0.51804256 0.5179558  0.5180317  0.5180208
 0.5178907  0.5177946  0.51778966 0.5179081  0.5181382  0.51837647
 0.5185271  0.5185449  0.51856285 0.5186609  0.5188306  0.51895505
 0.51899236 0.51892334 0.5189069  0.5188526  0.5188067  0.5186824
 0.5185162  0.5182962  0.51803404 0.51778466 0.51763254 0.5177407
 0.51799077 0.5182007  0.5184211  0.5186486  0.51891243 0.51916134
 0.5193477  0.519406   0.5194242  0.51933163 0.51923406 0.51913816
 0.5190289  0.51889557 0.51880616 0.5187539  0.51874113 0.51860386
 0.51830816 0.517977   0.51773477 0.5175245  0.5172863  0.5171334
 0.5170104  0.51685005 0.5166053  0.5162439  0.51565784 0.51477295
 0.5137825  0.5129666  0.5124102  0.512022   0.51185894 0.512004
 0.51243913 0.51305336 0.51374906 0.5144634  0.51521176 0.51606727
 0.51702005 0.51785773 0.5183559  0.51852375 0.5183473  0.518016
 0.5177025  0.51761115 0.51764196 0.5175942  0.51737845 0.5169469
 0.5164346  0.5158536  0.51529986 0.5148684  0.5144295  0.51390195
 0.51340294 0.51307756 0.5129508  0.51294047 0.51289064 0.51270413
 0.512423   0.51222235 0.51201195 0.5116209  0.51119566 0.5108073
 0.5106006  0.5107449  0.511083   0.5113692  0.51145077 0.51138115
 0.511318   0.5114394  0.51160127 0.5117291  0.5118232  0.51163673
 0.5113424  0.51118934 0.51124716 0.5114588  0.51155335 0.5115185
 0.51135254 0.5111527  0.51091033 0.51075065 0.51065606 0.51065224
 0.5107252  0.5108347  0.5109182  0.5110836  0.51127774 0.5115057
 0.51183814 0.5121601  0.5123298  0.51245815 0.51246727 0.5123679
 0.51228535 0.5122062  0.5121352  0.51204556 0.5118484  0.51174754
 0.51186883 0.51221687 0.5125486  0.5126688  0.5126227  0.51271325
 0.51320577 0.51399285 0.5147014  0.5152052  0.5159216  0.5174417 ]
