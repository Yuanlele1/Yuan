Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_90_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=90, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_90_192_FITS_ETTm1_ftM_sl90_ll48_pl192_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=68, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1340416.0
params:  1564.0
Trainable parameters:  1564
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6260892
	speed: 0.0621s/iter; left time: 1651.7180s
	iters: 200, epoch: 1 | loss: 0.5291046
	speed: 0.0364s/iter; left time: 964.9658s
Epoch: 1 cost time: 11.428942680358887
Epoch: 1, Steps: 267 | Train Loss: 0.5963374 Vali Loss: 1.0273743 Test Loss: 0.8474299
Validation loss decreased (inf --> 1.027374).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4497499
	speed: 0.1224s/iter; left time: 3222.9981s
	iters: 200, epoch: 2 | loss: 0.4368316
	speed: 0.0295s/iter; left time: 774.6977s
Epoch: 2 cost time: 7.230776071548462
Epoch: 2, Steps: 267 | Train Loss: 0.4198551 Vali Loss: 0.8680983 Test Loss: 0.6915893
Validation loss decreased (1.027374 --> 0.868098).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3402166
	speed: 0.1184s/iter; left time: 3087.3121s
	iters: 200, epoch: 3 | loss: 0.3749896
	speed: 0.0288s/iter; left time: 748.9258s
Epoch: 3 cost time: 7.174866199493408
Epoch: 3, Steps: 267 | Train Loss: 0.3644323 Vali Loss: 0.7870423 Test Loss: 0.6141471
Validation loss decreased (0.868098 --> 0.787042).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3064476
	speed: 0.1028s/iter; left time: 2651.3583s
	iters: 200, epoch: 4 | loss: 0.3189322
	speed: 0.0204s/iter; left time: 524.8618s
Epoch: 4 cost time: 5.982693672180176
Epoch: 4, Steps: 267 | Train Loss: 0.3331029 Vali Loss: 0.7285623 Test Loss: 0.5590242
Validation loss decreased (0.787042 --> 0.728562).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3057038
	speed: 0.1071s/iter; left time: 2735.2399s
	iters: 200, epoch: 5 | loss: 0.2811522
	speed: 0.0153s/iter; left time: 388.7638s
Epoch: 5 cost time: 5.310092449188232
Epoch: 5, Steps: 267 | Train Loss: 0.3113446 Vali Loss: 0.6849577 Test Loss: 0.5184231
Validation loss decreased (0.728562 --> 0.684958).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3245513
	speed: 0.1127s/iter; left time: 2846.6348s
	iters: 200, epoch: 6 | loss: 0.2637897
	speed: 0.0166s/iter; left time: 418.3380s
Epoch: 6 cost time: 6.044124603271484
Epoch: 6, Steps: 267 | Train Loss: 0.2955207 Vali Loss: 0.6494085 Test Loss: 0.4867427
Validation loss decreased (0.684958 --> 0.649409).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2811012
	speed: 0.0942s/iter; left time: 2353.7810s
	iters: 200, epoch: 7 | loss: 0.2653757
	speed: 0.0283s/iter; left time: 703.6556s
Epoch: 7 cost time: 9.024487018585205
Epoch: 7, Steps: 267 | Train Loss: 0.2840936 Vali Loss: 0.6225668 Test Loss: 0.4633404
Validation loss decreased (0.649409 --> 0.622567).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2942039
	speed: 0.1658s/iter; left time: 4100.9183s
	iters: 200, epoch: 8 | loss: 0.2490932
	speed: 0.0159s/iter; left time: 392.6432s
Epoch: 8 cost time: 6.427203893661499
Epoch: 8, Steps: 267 | Train Loss: 0.2759104 Vali Loss: 0.6036360 Test Loss: 0.4455466
Validation loss decreased (0.622567 --> 0.603636).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2471088
	speed: 0.1134s/iter; left time: 2774.7427s
	iters: 200, epoch: 9 | loss: 0.2642954
	speed: 0.0292s/iter; left time: 712.3788s
Epoch: 9 cost time: 6.648381948471069
Epoch: 9, Steps: 267 | Train Loss: 0.2702111 Vali Loss: 0.5879111 Test Loss: 0.4328620
Validation loss decreased (0.603636 --> 0.587911).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2592079
	speed: 0.0981s/iter; left time: 2374.3347s
	iters: 200, epoch: 10 | loss: 0.2578931
	speed: 0.0242s/iter; left time: 584.1718s
Epoch: 10 cost time: 6.249337434768677
Epoch: 10, Steps: 267 | Train Loss: 0.2662280 Vali Loss: 0.5758091 Test Loss: 0.4224583
Validation loss decreased (0.587911 --> 0.575809).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2870057
	speed: 0.1089s/iter; left time: 2605.7639s
	iters: 200, epoch: 11 | loss: 0.2475147
	speed: 0.0253s/iter; left time: 603.4713s
Epoch: 11 cost time: 6.00283670425415
Epoch: 11, Steps: 267 | Train Loss: 0.2636339 Vali Loss: 0.5683739 Test Loss: 0.4161479
Validation loss decreased (0.575809 --> 0.568374).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2529117
	speed: 0.0937s/iter; left time: 2217.2408s
	iters: 200, epoch: 12 | loss: 0.2706848
	speed: 0.0236s/iter; left time: 555.4083s
Epoch: 12 cost time: 6.842594861984253
Epoch: 12, Steps: 267 | Train Loss: 0.2618983 Vali Loss: 0.5615932 Test Loss: 0.4108592
Validation loss decreased (0.568374 --> 0.561593).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2592678
	speed: 0.1285s/iter; left time: 3005.7376s
	iters: 200, epoch: 13 | loss: 0.2855865
	speed: 0.0293s/iter; left time: 683.3577s
Epoch: 13 cost time: 8.898368835449219
Epoch: 13, Steps: 267 | Train Loss: 0.2608190 Vali Loss: 0.5571955 Test Loss: 0.4075296
Validation loss decreased (0.561593 --> 0.557195).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2714002
	speed: 0.1550s/iter; left time: 3585.8559s
	iters: 200, epoch: 14 | loss: 0.2842692
	speed: 0.0282s/iter; left time: 650.1297s
Epoch: 14 cost time: 8.910713195800781
Epoch: 14, Steps: 267 | Train Loss: 0.2601414 Vali Loss: 0.5538763 Test Loss: 0.4052407
Validation loss decreased (0.557195 --> 0.553876).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2785765
	speed: 0.1372s/iter; left time: 3137.8397s
	iters: 200, epoch: 15 | loss: 0.2741736
	speed: 0.0237s/iter; left time: 539.1782s
Epoch: 15 cost time: 6.990043878555298
Epoch: 15, Steps: 267 | Train Loss: 0.2596510 Vali Loss: 0.5510616 Test Loss: 0.4031176
Validation loss decreased (0.553876 --> 0.551062).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2503603
	speed: 0.1006s/iter; left time: 2273.6265s
	iters: 200, epoch: 16 | loss: 0.2738174
	speed: 0.0179s/iter; left time: 401.7022s
Epoch: 16 cost time: 5.354555606842041
Epoch: 16, Steps: 267 | Train Loss: 0.2594031 Vali Loss: 0.5490984 Test Loss: 0.4016812
Validation loss decreased (0.551062 --> 0.549098).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2639624
	speed: 0.1065s/iter; left time: 2377.5072s
	iters: 200, epoch: 17 | loss: 0.2281850
	speed: 0.0192s/iter; left time: 426.7219s
Epoch: 17 cost time: 6.423090934753418
Epoch: 17, Steps: 267 | Train Loss: 0.2593451 Vali Loss: 0.5485646 Test Loss: 0.4011928
Validation loss decreased (0.549098 --> 0.548565).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2765161
	speed: 0.0992s/iter; left time: 2188.6223s
	iters: 200, epoch: 18 | loss: 0.2661066
	speed: 0.0290s/iter; left time: 636.6211s
Epoch: 18 cost time: 7.575753688812256
Epoch: 18, Steps: 267 | Train Loss: 0.2593081 Vali Loss: 0.5475045 Test Loss: 0.3999992
Validation loss decreased (0.548565 --> 0.547504).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2946074
	speed: 0.1590s/iter; left time: 3464.9616s
	iters: 200, epoch: 19 | loss: 0.2436832
	speed: 0.0448s/iter; left time: 972.4530s
Epoch: 19 cost time: 13.246443271636963
Epoch: 19, Steps: 267 | Train Loss: 0.2592444 Vali Loss: 0.5469663 Test Loss: 0.4002504
Validation loss decreased (0.547504 --> 0.546966).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2678896
	speed: 0.1427s/iter; left time: 3071.1511s
	iters: 200, epoch: 20 | loss: 0.2560012
	speed: 0.0469s/iter; left time: 1003.9906s
Epoch: 20 cost time: 10.883785247802734
Epoch: 20, Steps: 267 | Train Loss: 0.2591931 Vali Loss: 0.5459533 Test Loss: 0.3997903
Validation loss decreased (0.546966 --> 0.545953).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2763005
	speed: 0.1478s/iter; left time: 3142.1599s
	iters: 200, epoch: 21 | loss: 0.2753379
	speed: 0.0334s/iter; left time: 706.8602s
Epoch: 21 cost time: 10.366542339324951
Epoch: 21, Steps: 267 | Train Loss: 0.2591207 Vali Loss: 0.5467937 Test Loss: 0.3997760
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2425439
	speed: 0.1750s/iter; left time: 3674.3806s
	iters: 200, epoch: 22 | loss: 0.2943804
	speed: 0.0214s/iter; left time: 447.1937s
Epoch: 22 cost time: 6.536957263946533
Epoch: 22, Steps: 267 | Train Loss: 0.2590003 Vali Loss: 0.5462572 Test Loss: 0.3995456
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2810482
	speed: 0.1245s/iter; left time: 2580.1946s
	iters: 200, epoch: 23 | loss: 0.2854130
	speed: 0.0343s/iter; left time: 708.2880s
Epoch: 23 cost time: 8.638655424118042
Epoch: 23, Steps: 267 | Train Loss: 0.2592004 Vali Loss: 0.5457227 Test Loss: 0.3993714
Validation loss decreased (0.545953 --> 0.545723).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2581301
	speed: 0.1107s/iter; left time: 2265.1988s
	iters: 200, epoch: 24 | loss: 0.2826602
	speed: 0.0260s/iter; left time: 529.8232s
Epoch: 24 cost time: 7.853567838668823
Epoch: 24, Steps: 267 | Train Loss: 0.2592732 Vali Loss: 0.5454540 Test Loss: 0.3993793
Validation loss decreased (0.545723 --> 0.545454).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2512902
	speed: 0.1032s/iter; left time: 2083.8979s
	iters: 200, epoch: 25 | loss: 0.2287204
	speed: 0.0167s/iter; left time: 336.1712s
Epoch: 25 cost time: 5.63636040687561
Epoch: 25, Steps: 267 | Train Loss: 0.2591766 Vali Loss: 0.5461339 Test Loss: 0.3994537
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2414102
	speed: 0.1027s/iter; left time: 2046.4677s
	iters: 200, epoch: 26 | loss: 0.2417062
	speed: 0.0164s/iter; left time: 324.8862s
Epoch: 26 cost time: 5.232319355010986
Epoch: 26, Steps: 267 | Train Loss: 0.2591457 Vali Loss: 0.5455717 Test Loss: 0.3994657
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2638242
	speed: 0.1195s/iter; left time: 2350.0320s
	iters: 200, epoch: 27 | loss: 0.2515917
	speed: 0.0290s/iter; left time: 566.6104s
Epoch: 27 cost time: 7.955620765686035
Epoch: 27, Steps: 267 | Train Loss: 0.2591621 Vali Loss: 0.5456809 Test Loss: 0.3994941
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2709010
	speed: 0.1338s/iter; left time: 2594.8073s
	iters: 200, epoch: 28 | loss: 0.2727693
	speed: 0.0177s/iter; left time: 341.4755s
Epoch: 28 cost time: 7.5120439529418945
Epoch: 28, Steps: 267 | Train Loss: 0.2591220 Vali Loss: 0.5454931 Test Loss: 0.3993064
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2354591
	speed: 0.1480s/iter; left time: 2829.6648s
	iters: 200, epoch: 29 | loss: 0.2567605
	speed: 0.0408s/iter; left time: 776.5095s
Epoch: 29 cost time: 9.876105546951294
Epoch: 29, Steps: 267 | Train Loss: 0.2591200 Vali Loss: 0.5461948 Test Loss: 0.3995545
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2660439
	speed: 0.1267s/iter; left time: 2389.1009s
	iters: 200, epoch: 30 | loss: 0.2972856
	speed: 0.0178s/iter; left time: 333.0305s
Epoch: 30 cost time: 5.309939384460449
Epoch: 30, Steps: 267 | Train Loss: 0.2592366 Vali Loss: 0.5457076 Test Loss: 0.3995273
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2610475
	speed: 0.1136s/iter; left time: 2111.2615s
	iters: 200, epoch: 31 | loss: 0.2557920
	speed: 0.0213s/iter; left time: 394.6176s
Epoch: 31 cost time: 5.34034538269043
Epoch: 31, Steps: 267 | Train Loss: 0.2591165 Vali Loss: 0.5457022 Test Loss: 0.3995572
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2523877
	speed: 0.1077s/iter; left time: 1973.7645s
	iters: 200, epoch: 32 | loss: 0.2804666
	speed: 0.0280s/iter; left time: 510.2502s
Epoch: 32 cost time: 6.454615354537964
Epoch: 32, Steps: 267 | Train Loss: 0.2592075 Vali Loss: 0.5466101 Test Loss: 0.3995792
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2802454
	speed: 0.1108s/iter; left time: 2000.0389s
	iters: 200, epoch: 33 | loss: 0.2512465
	speed: 0.0192s/iter; left time: 345.4187s
Epoch: 33 cost time: 6.064466238021851
Epoch: 33, Steps: 267 | Train Loss: 0.2591381 Vali Loss: 0.5460485 Test Loss: 0.3995993
EarlyStopping counter: 9 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2678452
	speed: 0.1162s/iter; left time: 2067.9265s
	iters: 200, epoch: 34 | loss: 0.2708261
	speed: 0.0343s/iter; left time: 606.6212s
Epoch: 34 cost time: 9.129638671875
Epoch: 34, Steps: 267 | Train Loss: 0.2590322 Vali Loss: 0.5458495 Test Loss: 0.3995278
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2611839
	speed: 0.1227s/iter; left time: 2149.6986s
	iters: 200, epoch: 35 | loss: 0.2541241
	speed: 0.0163s/iter; left time: 284.0234s
Epoch: 35 cost time: 5.876578330993652
Epoch: 35, Steps: 267 | Train Loss: 0.2590808 Vali Loss: 0.5458146 Test Loss: 0.3995819
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2326322
	speed: 0.1259s/iter; left time: 2172.6220s
	iters: 200, epoch: 36 | loss: 0.2726578
	speed: 0.0215s/iter; left time: 368.0126s
Epoch: 36 cost time: 6.280533075332642
Epoch: 36, Steps: 267 | Train Loss: 0.2591317 Vali Loss: 0.5460993 Test Loss: 0.3995993
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2810687
	speed: 0.1506s/iter; left time: 2559.0128s
	iters: 200, epoch: 37 | loss: 0.2555154
	speed: 0.0496s/iter; left time: 836.9932s
Epoch: 37 cost time: 12.641058921813965
Epoch: 37, Steps: 267 | Train Loss: 0.2591555 Vali Loss: 0.5456666 Test Loss: 0.3995409
EarlyStopping counter: 13 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2386953
	speed: 0.1272s/iter; left time: 2126.8423s
	iters: 200, epoch: 38 | loss: 0.2643107
	speed: 0.0209s/iter; left time: 347.9597s
Epoch: 38 cost time: 7.394390344619751
Epoch: 38, Steps: 267 | Train Loss: 0.2591648 Vali Loss: 0.5457913 Test Loss: 0.3995393
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2510785
	speed: 0.1499s/iter; left time: 2467.2409s
	iters: 200, epoch: 39 | loss: 0.3039466
	speed: 0.0173s/iter; left time: 283.1583s
Epoch: 39 cost time: 7.245897054672241
Epoch: 39, Steps: 267 | Train Loss: 0.2591118 Vali Loss: 0.5466166 Test Loss: 0.3994982
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2510481
	speed: 0.0966s/iter; left time: 1563.5443s
	iters: 200, epoch: 40 | loss: 0.2937242
	speed: 0.0205s/iter; left time: 330.1362s
Epoch: 40 cost time: 6.424966335296631
Epoch: 40, Steps: 267 | Train Loss: 0.2590413 Vali Loss: 0.5463352 Test Loss: 0.3995840
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2396313
	speed: 0.1084s/iter; left time: 1725.3200s
	iters: 200, epoch: 41 | loss: 0.2666920
	speed: 0.0231s/iter; left time: 365.5177s
Epoch: 41 cost time: 6.541277885437012
Epoch: 41, Steps: 267 | Train Loss: 0.2590570 Vali Loss: 0.5459246 Test Loss: 0.3996172
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2951080
	speed: 0.1164s/iter; left time: 1822.7585s
	iters: 200, epoch: 42 | loss: 0.2399989
	speed: 0.0286s/iter; left time: 445.1500s
Epoch: 42 cost time: 6.287495136260986
Epoch: 42, Steps: 267 | Train Loss: 0.2590871 Vali Loss: 0.5454876 Test Loss: 0.3995881
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2524467
	speed: 0.1358s/iter; left time: 2090.1617s
	iters: 200, epoch: 43 | loss: 0.2731357
	speed: 0.0312s/iter; left time: 477.5152s
Epoch: 43 cost time: 7.335712194442749
Epoch: 43, Steps: 267 | Train Loss: 0.2591395 Vali Loss: 0.5459719 Test Loss: 0.3995938
EarlyStopping counter: 19 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2293664
	speed: 0.1307s/iter; left time: 1976.6208s
	iters: 200, epoch: 44 | loss: 0.2480430
	speed: 0.0157s/iter; left time: 235.6987s
Epoch: 44 cost time: 6.021511554718018
Epoch: 44, Steps: 267 | Train Loss: 0.2591314 Vali Loss: 0.5456973 Test Loss: 0.3995115
EarlyStopping counter: 20 out of 20
Early stopping
train 34279
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=68, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1340416.0
params:  1564.0
Trainable parameters:  1564
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4288839
	speed: 0.0262s/iter; left time: 696.5279s
	iters: 200, epoch: 1 | loss: 0.3557770
	speed: 0.0178s/iter; left time: 471.4906s
Epoch: 1 cost time: 5.48110556602478
Epoch: 1, Steps: 267 | Train Loss: 0.3745615 Vali Loss: 0.5442154 Test Loss: 0.3983638
Validation loss decreased (inf --> 0.544215).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3985003
	speed: 0.0929s/iter; left time: 2446.7100s
	iters: 200, epoch: 2 | loss: 0.3877947
	speed: 0.0219s/iter; left time: 573.7331s
Epoch: 2 cost time: 6.153252601623535
Epoch: 2, Steps: 267 | Train Loss: 0.3742460 Vali Loss: 0.5440365 Test Loss: 0.3983205
Validation loss decreased (0.544215 --> 0.544037).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3628180
	speed: 0.1021s/iter; left time: 2660.4434s
	iters: 200, epoch: 3 | loss: 0.3500787
	speed: 0.0174s/iter; left time: 452.1461s
Epoch: 3 cost time: 5.911416292190552
Epoch: 3, Steps: 267 | Train Loss: 0.3741900 Vali Loss: 0.5457574 Test Loss: 0.3993336
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3426038
	speed: 0.1175s/iter; left time: 3031.6756s
	iters: 200, epoch: 4 | loss: 0.3503046
	speed: 0.0184s/iter; left time: 472.7840s
Epoch: 4 cost time: 5.896651268005371
Epoch: 4, Steps: 267 | Train Loss: 0.3741317 Vali Loss: 0.5446565 Test Loss: 0.3982886
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3482660
	speed: 0.1328s/iter; left time: 3390.9106s
	iters: 200, epoch: 5 | loss: 0.3665673
	speed: 0.0191s/iter; left time: 485.7713s
Epoch: 5 cost time: 7.609792470932007
Epoch: 5, Steps: 267 | Train Loss: 0.3740767 Vali Loss: 0.5449762 Test Loss: 0.3984522
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3929849
	speed: 0.1400s/iter; left time: 3538.3027s
	iters: 200, epoch: 6 | loss: 0.3861100
	speed: 0.0178s/iter; left time: 446.9021s
Epoch: 6 cost time: 7.023230791091919
Epoch: 6, Steps: 267 | Train Loss: 0.3740765 Vali Loss: 0.5449232 Test Loss: 0.3985376
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3724610
	speed: 0.1030s/iter; left time: 2573.8762s
	iters: 200, epoch: 7 | loss: 0.3805818
	speed: 0.0333s/iter; left time: 830.3267s
Epoch: 7 cost time: 8.051052808761597
Epoch: 7, Steps: 267 | Train Loss: 0.3738857 Vali Loss: 0.5455115 Test Loss: 0.3992204
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3776847
	speed: 0.1352s/iter; left time: 3342.5771s
	iters: 200, epoch: 8 | loss: 0.3833296
	speed: 0.0168s/iter; left time: 414.7208s
Epoch: 8 cost time: 5.960676908493042
Epoch: 8, Steps: 267 | Train Loss: 0.3739105 Vali Loss: 0.5431975 Test Loss: 0.3979706
Validation loss decreased (0.544037 --> 0.543197).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3514088
	speed: 0.1152s/iter; left time: 2819.0686s
	iters: 200, epoch: 9 | loss: 0.3638711
	speed: 0.0484s/iter; left time: 1180.4777s
Epoch: 9 cost time: 11.419615268707275
Epoch: 9, Steps: 267 | Train Loss: 0.3739091 Vali Loss: 0.5447412 Test Loss: 0.3992429
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3499127
	speed: 0.1221s/iter; left time: 2954.9105s
	iters: 200, epoch: 10 | loss: 0.3542605
	speed: 0.0248s/iter; left time: 596.5018s
Epoch: 10 cost time: 8.867424964904785
Epoch: 10, Steps: 267 | Train Loss: 0.3736377 Vali Loss: 0.5437416 Test Loss: 0.3986936
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3538975
	speed: 0.1504s/iter; left time: 3599.6459s
	iters: 200, epoch: 11 | loss: 0.3527026
	speed: 0.0322s/iter; left time: 767.4420s
Epoch: 11 cost time: 9.159320831298828
Epoch: 11, Steps: 267 | Train Loss: 0.3738115 Vali Loss: 0.5443648 Test Loss: 0.3989908
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3607027
	speed: 0.1389s/iter; left time: 3286.3470s
	iters: 200, epoch: 12 | loss: 0.3693636
	speed: 0.0208s/iter; left time: 490.3916s
Epoch: 12 cost time: 7.285006999969482
Epoch: 12, Steps: 267 | Train Loss: 0.3739393 Vali Loss: 0.5434344 Test Loss: 0.3985882
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4073891
	speed: 0.1142s/iter; left time: 2672.8954s
	iters: 200, epoch: 13 | loss: 0.3657927
	speed: 0.0256s/iter; left time: 597.0726s
Epoch: 13 cost time: 6.2573981285095215
Epoch: 13, Steps: 267 | Train Loss: 0.3737963 Vali Loss: 0.5442953 Test Loss: 0.3987553
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3942921
	speed: 0.1203s/iter; left time: 2782.6528s
	iters: 200, epoch: 14 | loss: 0.3712084
	speed: 0.0383s/iter; left time: 882.3008s
Epoch: 14 cost time: 8.116280794143677
Epoch: 14, Steps: 267 | Train Loss: 0.3738575 Vali Loss: 0.5435803 Test Loss: 0.3987063
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3814586
	speed: 0.1722s/iter; left time: 3937.3289s
	iters: 200, epoch: 15 | loss: 0.3600408
	speed: 0.0292s/iter; left time: 665.0958s
Epoch: 15 cost time: 9.301769733428955
Epoch: 15, Steps: 267 | Train Loss: 0.3738581 Vali Loss: 0.5441183 Test Loss: 0.3989144
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3194223
	speed: 0.1618s/iter; left time: 3656.4721s
	iters: 200, epoch: 16 | loss: 0.3414354
	speed: 0.0286s/iter; left time: 643.2947s
Epoch: 16 cost time: 9.50342583656311
Epoch: 16, Steps: 267 | Train Loss: 0.3737476 Vali Loss: 0.5441609 Test Loss: 0.3984175
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4039849
	speed: 0.1042s/iter; left time: 2327.0529s
	iters: 200, epoch: 17 | loss: 0.3362336
	speed: 0.0191s/iter; left time: 423.9073s
Epoch: 17 cost time: 5.687435626983643
Epoch: 17, Steps: 267 | Train Loss: 0.3737711 Vali Loss: 0.5444365 Test Loss: 0.3987379
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3190627
	speed: 0.0972s/iter; left time: 2144.5135s
	iters: 200, epoch: 18 | loss: 0.4235190
	speed: 0.0179s/iter; left time: 392.8806s
Epoch: 18 cost time: 6.561751842498779
Epoch: 18, Steps: 267 | Train Loss: 0.3736997 Vali Loss: 0.5441473 Test Loss: 0.3987381
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3616572
	speed: 0.0995s/iter; left time: 2168.8427s
	iters: 200, epoch: 19 | loss: 0.3566667
	speed: 0.0216s/iter; left time: 469.4356s
Epoch: 19 cost time: 6.84795069694519
Epoch: 19, Steps: 267 | Train Loss: 0.3735612 Vali Loss: 0.5446814 Test Loss: 0.3988684
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3907233
	speed: 0.1074s/iter; left time: 2311.1210s
	iters: 200, epoch: 20 | loss: 0.3608569
	speed: 0.0220s/iter; left time: 472.4775s
Epoch: 20 cost time: 6.0092689990997314
Epoch: 20, Steps: 267 | Train Loss: 0.3738123 Vali Loss: 0.5447758 Test Loss: 0.3988755
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3592968
	speed: 0.1022s/iter; left time: 2173.8081s
	iters: 200, epoch: 21 | loss: 0.3953403
	speed: 0.0159s/iter; left time: 336.4645s
Epoch: 21 cost time: 6.205197095870972
Epoch: 21, Steps: 267 | Train Loss: 0.3738405 Vali Loss: 0.5440309 Test Loss: 0.3988625
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3605370
	speed: 0.1200s/iter; left time: 2520.3257s
	iters: 200, epoch: 22 | loss: 0.3904725
	speed: 0.0164s/iter; left time: 342.5601s
Epoch: 22 cost time: 6.195404767990112
Epoch: 22, Steps: 267 | Train Loss: 0.3736855 Vali Loss: 0.5447237 Test Loss: 0.3989501
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3875975
	speed: 0.1492s/iter; left time: 3093.3497s
	iters: 200, epoch: 23 | loss: 0.3656634
	speed: 0.0318s/iter; left time: 655.1118s
Epoch: 23 cost time: 7.725388050079346
Epoch: 23, Steps: 267 | Train Loss: 0.3736967 Vali Loss: 0.5445497 Test Loss: 0.3989498
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3631559
	speed: 0.1078s/iter; left time: 2206.6012s
	iters: 200, epoch: 24 | loss: 0.3623013
	speed: 0.0193s/iter; left time: 393.8096s
Epoch: 24 cost time: 7.32525634765625
Epoch: 24, Steps: 267 | Train Loss: 0.3737279 Vali Loss: 0.5441770 Test Loss: 0.3987904
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3822110
	speed: 0.1351s/iter; left time: 2727.9336s
	iters: 200, epoch: 25 | loss: 0.4097375
	speed: 0.0201s/iter; left time: 403.4425s
Epoch: 25 cost time: 5.911419630050659
Epoch: 25, Steps: 267 | Train Loss: 0.3737415 Vali Loss: 0.5445290 Test Loss: 0.3988250
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3606727
	speed: 0.1061s/iter; left time: 2113.5168s
	iters: 200, epoch: 26 | loss: 0.3635906
	speed: 0.0219s/iter; left time: 433.8797s
Epoch: 26 cost time: 7.8571813106536865
Epoch: 26, Steps: 267 | Train Loss: 0.3738541 Vali Loss: 0.5444402 Test Loss: 0.3987253
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3587522
	speed: 0.1355s/iter; left time: 2663.4393s
	iters: 200, epoch: 27 | loss: 0.3735541
	speed: 0.0303s/iter; left time: 591.6673s
Epoch: 27 cost time: 8.510871648788452
Epoch: 27, Steps: 267 | Train Loss: 0.3736926 Vali Loss: 0.5435454 Test Loss: 0.3985974
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3842205
	speed: 0.1739s/iter; left time: 3373.0779s
	iters: 200, epoch: 28 | loss: 0.4033572
	speed: 0.0268s/iter; left time: 517.2411s
Epoch: 28 cost time: 9.61510682106018
Epoch: 28, Steps: 267 | Train Loss: 0.3738772 Vali Loss: 0.5449514 Test Loss: 0.3988281
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_90_192_FITS_ETTm1_ftM_sl90_ll48_pl192_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3989577293395996, mae:0.39719319343566895, rse:0.6012636423110962, corr:[0.55002195 0.55103046 0.54598063 0.5447589  0.5438698  0.5408121
 0.53798306 0.53679794 0.5355542  0.53365636 0.5323508  0.53202325
 0.53136784 0.5297034  0.52697235 0.5235919  0.5200555  0.5170095
 0.514225   0.511345   0.50824463 0.5051694  0.502219   0.49912187
 0.49561405 0.49183786 0.48877895 0.48681286 0.48532885 0.48348033
 0.48198017 0.481864   0.482125   0.48226342 0.48258904 0.48332927
 0.48356426 0.48330334 0.48299524 0.48290655 0.48299685 0.48277274
 0.4825534  0.4826667  0.48264086 0.4821838  0.4817207  0.4817327
 0.48213005 0.4824693  0.48265043 0.48280025 0.48328623 0.48380125
 0.4842161  0.48444456 0.48483282 0.48528203 0.48529598 0.4850577
 0.4848763  0.4845849  0.4842869  0.48382127 0.4836917  0.48382354
 0.4836945  0.48330197 0.48326433 0.483773   0.48422077 0.4845269
 0.48495042 0.485512   0.48624888 0.4867956  0.487403   0.48826006
 0.48916838 0.48985562 0.49029058 0.49053764 0.49091375 0.4911701
 0.49138525 0.49182895 0.49266043 0.4936212  0.49441728 0.49510553
 0.495892   0.49671698 0.49735668 0.4975595  0.49725673 0.49672264
 0.49621868 0.49556628 0.4944393  0.49323246 0.4926183  0.4923751
 0.49193075 0.49145222 0.49140897 0.491276   0.4906013  0.48962867
 0.48880145 0.48809835 0.48726213 0.48637077 0.4855886  0.4847753
 0.48372984 0.4827614  0.48199973 0.48118472 0.48002756 0.4786606
 0.47753748 0.47655997 0.47549537 0.47446933 0.47355083 0.472868
 0.47252718 0.472334   0.47212687 0.47200155 0.47205573 0.4721211
 0.47191048 0.47174525 0.47172657 0.4717578  0.47157946 0.4712331
 0.47103465 0.471159   0.47130212 0.47128093 0.47116846 0.471181
 0.4711726  0.47109374 0.47114092 0.47145912 0.47215003 0.47263366
 0.47267097 0.47270665 0.47290915 0.4731726  0.47325447 0.47323692
 0.4731058  0.47292963 0.47274834 0.4726766  0.47278938 0.47281083
 0.47268194 0.47262824 0.47287226 0.47326162 0.47367972 0.47421393
 0.47492668 0.47561184 0.4760749  0.4766341  0.47743472 0.4784429
 0.47918513 0.47959757 0.48003864 0.48068324 0.48126978 0.48186374
 0.48255488 0.48333377 0.48400787 0.48497793 0.48655477 0.4880673
 0.48898923 0.49011898 0.4920193  0.49326208 0.49375007 0.4987704 ]
