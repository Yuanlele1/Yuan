Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=30, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34285
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=30, out_features=46, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1236480.0
params:  1426.0
Trainable parameters:  1426
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3921441
	speed: 0.0163s/iter; left time: 434.8142s
	iters: 200, epoch: 1 | loss: 0.3215647
	speed: 0.0104s/iter; left time: 276.0835s
Epoch: 1 cost time: 3.400393486022949
Epoch: 1, Steps: 267 | Train Loss: 0.4298701 Vali Loss: 0.5098443 Test Loss: 0.4031888
Validation loss decreased (inf --> 0.509844).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2957938
	speed: 0.0582s/iter; left time: 1533.1085s
	iters: 200, epoch: 2 | loss: 0.3307367
	speed: 0.0101s/iter; left time: 263.8456s
Epoch: 2 cost time: 3.222475051879883
Epoch: 2, Steps: 267 | Train Loss: 0.3182736 Vali Loss: 0.4379843 Test Loss: 0.3348252
Validation loss decreased (0.509844 --> 0.437984).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3177181
	speed: 0.0578s/iter; left time: 1507.8279s
	iters: 200, epoch: 3 | loss: 0.3039724
	speed: 0.0099s/iter; left time: 258.1305s
Epoch: 3 cost time: 3.2436511516571045
Epoch: 3, Steps: 267 | Train Loss: 0.3005615 Vali Loss: 0.4179368 Test Loss: 0.3194085
Validation loss decreased (0.437984 --> 0.417937).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3205968
	speed: 0.0593s/iter; left time: 1530.2569s
	iters: 200, epoch: 4 | loss: 0.3000365
	speed: 0.0103s/iter; left time: 264.1933s
Epoch: 4 cost time: 3.227570056915283
Epoch: 4, Steps: 267 | Train Loss: 0.2956500 Vali Loss: 0.4107930 Test Loss: 0.3146825
Validation loss decreased (0.417937 --> 0.410793).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3015394
	speed: 0.0583s/iter; left time: 1488.1429s
	iters: 200, epoch: 5 | loss: 0.3013902
	speed: 0.0107s/iter; left time: 272.9591s
Epoch: 5 cost time: 3.348170757293701
Epoch: 5, Steps: 267 | Train Loss: 0.2937206 Vali Loss: 0.4085788 Test Loss: 0.3125640
Validation loss decreased (0.410793 --> 0.408579).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2850778
	speed: 0.0605s/iter; left time: 1528.3753s
	iters: 200, epoch: 6 | loss: 0.2948401
	speed: 0.0104s/iter; left time: 260.7874s
Epoch: 6 cost time: 3.34722638130188
Epoch: 6, Steps: 267 | Train Loss: 0.2927404 Vali Loss: 0.4069509 Test Loss: 0.3118460
Validation loss decreased (0.408579 --> 0.406951).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2892209
	speed: 0.0600s/iter; left time: 1498.7913s
	iters: 200, epoch: 7 | loss: 0.2838300
	speed: 0.0099s/iter; left time: 245.8872s
Epoch: 7 cost time: 3.266599655151367
Epoch: 7, Steps: 267 | Train Loss: 0.2921576 Vali Loss: 0.4053880 Test Loss: 0.3112447
Validation loss decreased (0.406951 --> 0.405388).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2948875
	speed: 0.0582s/iter; left time: 1440.1771s
	iters: 200, epoch: 8 | loss: 0.3157370
	speed: 0.0099s/iter; left time: 244.2031s
Epoch: 8 cost time: 3.2931430339813232
Epoch: 8, Steps: 267 | Train Loss: 0.2917336 Vali Loss: 0.4041000 Test Loss: 0.3107646
Validation loss decreased (0.405388 --> 0.404100).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2845598
	speed: 0.0571s/iter; left time: 1395.9306s
	iters: 200, epoch: 9 | loss: 0.3066343
	speed: 0.0100s/iter; left time: 244.7807s
Epoch: 9 cost time: 3.2667465209960938
Epoch: 9, Steps: 267 | Train Loss: 0.2915569 Vali Loss: 0.4047186 Test Loss: 0.3104709
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3026020
	speed: 0.0591s/iter; left time: 1429.7230s
	iters: 200, epoch: 10 | loss: 0.3009606
	speed: 0.0101s/iter; left time: 243.4676s
Epoch: 10 cost time: 3.306520700454712
Epoch: 10, Steps: 267 | Train Loss: 0.2912862 Vali Loss: 0.4041379 Test Loss: 0.3102971
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2581900
	speed: 0.0609s/iter; left time: 1456.8799s
	iters: 200, epoch: 11 | loss: 0.2906153
	speed: 0.0105s/iter; left time: 249.2279s
Epoch: 11 cost time: 3.296241283416748
Epoch: 11, Steps: 267 | Train Loss: 0.2911406 Vali Loss: 0.4039482 Test Loss: 0.3099639
Validation loss decreased (0.404100 --> 0.403948).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2785796
	speed: 0.0593s/iter; left time: 1403.2688s
	iters: 200, epoch: 12 | loss: 0.3079487
	speed: 0.0100s/iter; left time: 235.8116s
Epoch: 12 cost time: 5.031033754348755
Epoch: 12, Steps: 267 | Train Loss: 0.2909698 Vali Loss: 0.4039963 Test Loss: 0.3101485
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2709721
	speed: 0.0747s/iter; left time: 1747.2551s
	iters: 200, epoch: 13 | loss: 0.3202728
	speed: 0.0100s/iter; left time: 232.9543s
Epoch: 13 cost time: 3.1818552017211914
Epoch: 13, Steps: 267 | Train Loss: 0.2908922 Vali Loss: 0.4032049 Test Loss: 0.3103771
Validation loss decreased (0.403948 --> 0.403205).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2796958
	speed: 0.0578s/iter; left time: 1336.1997s
	iters: 200, epoch: 14 | loss: 0.2563148
	speed: 0.0099s/iter; left time: 228.0364s
Epoch: 14 cost time: 3.2094571590423584
Epoch: 14, Steps: 267 | Train Loss: 0.2907795 Vali Loss: 0.4033553 Test Loss: 0.3099823
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2978824
	speed: 0.0664s/iter; left time: 1518.6646s
	iters: 200, epoch: 15 | loss: 0.2997389
	speed: 0.0104s/iter; left time: 236.3033s
Epoch: 15 cost time: 3.260371446609497
Epoch: 15, Steps: 267 | Train Loss: 0.2906985 Vali Loss: 0.4030794 Test Loss: 0.3101302
Validation loss decreased (0.403205 --> 0.403079).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3063619
	speed: 0.0576s/iter; left time: 1301.7472s
	iters: 200, epoch: 16 | loss: 0.2893481
	speed: 0.0100s/iter; left time: 224.5781s
Epoch: 16 cost time: 3.2149155139923096
Epoch: 16, Steps: 267 | Train Loss: 0.2907104 Vali Loss: 0.4037276 Test Loss: 0.3099266
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2656192
	speed: 0.0590s/iter; left time: 1317.5254s
	iters: 200, epoch: 17 | loss: 0.2699743
	speed: 0.0099s/iter; left time: 219.0561s
Epoch: 17 cost time: 3.3004744052886963
Epoch: 17, Steps: 267 | Train Loss: 0.2905323 Vali Loss: 0.4026738 Test Loss: 0.3100075
Validation loss decreased (0.403079 --> 0.402674).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2663364
	speed: 0.0593s/iter; left time: 1307.7663s
	iters: 200, epoch: 18 | loss: 0.3004497
	speed: 0.0102s/iter; left time: 224.2159s
Epoch: 18 cost time: 3.32434344291687
Epoch: 18, Steps: 267 | Train Loss: 0.2906831 Vali Loss: 0.4019953 Test Loss: 0.3096204
Validation loss decreased (0.402674 --> 0.401995).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2859100
	speed: 0.0612s/iter; left time: 1334.3924s
	iters: 200, epoch: 19 | loss: 0.2970790
	speed: 0.0105s/iter; left time: 226.9828s
Epoch: 19 cost time: 3.3824262619018555
Epoch: 19, Steps: 267 | Train Loss: 0.2904825 Vali Loss: 0.4024799 Test Loss: 0.3099491
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2816250
	speed: 0.0570s/iter; left time: 1227.4822s
	iters: 200, epoch: 20 | loss: 0.2971648
	speed: 0.0100s/iter; left time: 215.2589s
Epoch: 20 cost time: 3.139240264892578
Epoch: 20, Steps: 267 | Train Loss: 0.2905965 Vali Loss: 0.4032177 Test Loss: 0.3101017
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2905106
	speed: 0.0566s/iter; left time: 1204.1290s
	iters: 200, epoch: 21 | loss: 0.2597013
	speed: 0.0100s/iter; left time: 210.6745s
Epoch: 21 cost time: 3.152057409286499
Epoch: 21, Steps: 267 | Train Loss: 0.2904700 Vali Loss: 0.4023793 Test Loss: 0.3100005
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3273434
	speed: 0.0589s/iter; left time: 1237.1084s
	iters: 200, epoch: 22 | loss: 0.3136596
	speed: 0.0100s/iter; left time: 208.6546s
Epoch: 22 cost time: 3.2695422172546387
Epoch: 22, Steps: 267 | Train Loss: 0.2905090 Vali Loss: 0.4027868 Test Loss: 0.3099503
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2854346
	speed: 0.0598s/iter; left time: 1238.4397s
	iters: 200, epoch: 23 | loss: 0.2722628
	speed: 0.0102s/iter; left time: 209.9287s
Epoch: 23 cost time: 3.2385659217834473
Epoch: 23, Steps: 267 | Train Loss: 0.2905060 Vali Loss: 0.4020093 Test Loss: 0.3093993
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2466403
	speed: 0.0623s/iter; left time: 1274.4555s
	iters: 200, epoch: 24 | loss: 0.2888549
	speed: 0.0102s/iter; left time: 207.8200s
Epoch: 24 cost time: 3.3367919921875
Epoch: 24, Steps: 267 | Train Loss: 0.2904113 Vali Loss: 0.4028576 Test Loss: 0.3096240
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3347878
	speed: 0.0599s/iter; left time: 1208.6888s
	iters: 200, epoch: 25 | loss: 0.2878799
	speed: 0.0102s/iter; left time: 205.1145s
Epoch: 25 cost time: 3.358602285385132
Epoch: 25, Steps: 267 | Train Loss: 0.2903656 Vali Loss: 0.4025988 Test Loss: 0.3097947
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2776740
	speed: 0.0620s/iter; left time: 1234.6136s
	iters: 200, epoch: 26 | loss: 0.2812300
	speed: 0.0100s/iter; left time: 198.6109s
Epoch: 26 cost time: 3.2540087699890137
Epoch: 26, Steps: 267 | Train Loss: 0.2902590 Vali Loss: 0.4026835 Test Loss: 0.3096820
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2802856
	speed: 0.0603s/iter; left time: 1186.1473s
	iters: 200, epoch: 27 | loss: 0.3038281
	speed: 0.0101s/iter; left time: 196.8144s
Epoch: 27 cost time: 3.2924551963806152
Epoch: 27, Steps: 267 | Train Loss: 0.2902573 Vali Loss: 0.4024003 Test Loss: 0.3096517
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2658993
	speed: 0.0567s/iter; left time: 1100.4338s
	iters: 200, epoch: 28 | loss: 0.3309040
	speed: 0.0101s/iter; left time: 195.6982s
Epoch: 28 cost time: 3.2304790019989014
Epoch: 28, Steps: 267 | Train Loss: 0.2903903 Vali Loss: 0.4023854 Test Loss: 0.3096164
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2707263
	speed: 0.0573s/iter; left time: 1095.9328s
	iters: 200, epoch: 29 | loss: 0.2761135
	speed: 0.0100s/iter; left time: 190.6019s
Epoch: 29 cost time: 3.275270462036133
Epoch: 29, Steps: 267 | Train Loss: 0.2902662 Vali Loss: 0.4025871 Test Loss: 0.3096215
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2979111
	speed: 0.0602s/iter; left time: 1136.1863s
	iters: 200, epoch: 30 | loss: 0.2951519
	speed: 0.0099s/iter; left time: 186.4324s
Epoch: 30 cost time: 3.2986414432525635
Epoch: 30, Steps: 267 | Train Loss: 0.2903896 Vali Loss: 0.4021131 Test Loss: 0.3093602
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2976536
	speed: 0.0605s/iter; left time: 1125.0296s
	iters: 200, epoch: 31 | loss: 0.2847504
	speed: 0.0102s/iter; left time: 189.3488s
Epoch: 31 cost time: 3.313587188720703
Epoch: 31, Steps: 267 | Train Loss: 0.2903346 Vali Loss: 0.4026068 Test Loss: 0.3097972
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2908364
	speed: 0.0595s/iter; left time: 1090.8505s
	iters: 200, epoch: 32 | loss: 0.2919627
	speed: 0.0100s/iter; left time: 182.2997s
Epoch: 32 cost time: 3.3113553524017334
Epoch: 32, Steps: 267 | Train Loss: 0.2903040 Vali Loss: 0.4021446 Test Loss: 0.3096852
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2839675
	speed: 0.0632s/iter; left time: 1141.1663s
	iters: 200, epoch: 33 | loss: 0.2678063
	speed: 0.0164s/iter; left time: 295.1485s
Epoch: 33 cost time: 3.8628437519073486
Epoch: 33, Steps: 267 | Train Loss: 0.2902277 Vali Loss: 0.4022687 Test Loss: 0.3096377
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2858277
	speed: 0.0587s/iter; left time: 1045.1268s
	iters: 200, epoch: 34 | loss: 0.3069985
	speed: 0.0103s/iter; left time: 182.9721s
Epoch: 34 cost time: 3.313509941101074
Epoch: 34, Steps: 267 | Train Loss: 0.2902420 Vali Loss: 0.4024778 Test Loss: 0.3095530
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2665229
	speed: 0.0574s/iter; left time: 1005.6114s
	iters: 200, epoch: 35 | loss: 0.2776074
	speed: 0.0099s/iter; left time: 172.0707s
Epoch: 35 cost time: 3.20003342628479
Epoch: 35, Steps: 267 | Train Loss: 0.2902178 Vali Loss: 0.4028227 Test Loss: 0.3096750
EarlyStopping counter: 17 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2517364
	speed: 0.0558s/iter; left time: 962.0578s
	iters: 200, epoch: 36 | loss: 0.2747389
	speed: 0.0104s/iter; left time: 178.5532s
Epoch: 36 cost time: 3.391538381576538
Epoch: 36, Steps: 267 | Train Loss: 0.2901742 Vali Loss: 0.4023992 Test Loss: 0.3095932
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3000628
	speed: 0.0592s/iter; left time: 1005.4211s
	iters: 200, epoch: 37 | loss: 0.3052715
	speed: 0.0105s/iter; left time: 177.5222s
Epoch: 37 cost time: 3.3251492977142334
Epoch: 37, Steps: 267 | Train Loss: 0.2903409 Vali Loss: 0.4024987 Test Loss: 0.3096776
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3310412
	speed: 0.0586s/iter; left time: 979.1507s
	iters: 200, epoch: 38 | loss: 0.2874116
	speed: 0.0117s/iter; left time: 195.1308s
Epoch: 38 cost time: 3.377660036087036
Epoch: 38, Steps: 267 | Train Loss: 0.2901517 Vali Loss: 0.4020425 Test Loss: 0.3097157
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_96_FITS_ETTm1_ftM_sl180_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3119269907474518, mae:0.3485123813152313, rse:0.5314450860023499, corr:[0.55295306 0.556607   0.5541886  0.551758   0.5515262  0.5520931
 0.55192024 0.55124897 0.55083346 0.5514935  0.5526879  0.553071
 0.55261856 0.5514103  0.5498301  0.54807425 0.54609764 0.5440746
 0.5422083  0.5405369  0.5389199  0.53702635 0.53470784 0.53210604
 0.5294638  0.52716374 0.5255268  0.52431875 0.5233246  0.5224924
 0.5221512  0.52241147 0.52301055 0.5235592  0.52367634 0.52337193
 0.52274555 0.5221126  0.5218585  0.52184236 0.5219584  0.5219168
 0.5216788  0.5214874  0.52147156 0.5216819  0.5220805  0.5224868
 0.52274686 0.5227875  0.5227673  0.52280456 0.5229468  0.52307373
 0.5231079  0.5230193  0.52298456 0.52295053 0.5229776  0.5229568
 0.5228829  0.5227338  0.522533   0.52236706 0.5223091  0.52247375
 0.5227113  0.52284795 0.5229508  0.5230549  0.52321905 0.5233909
 0.52349275 0.52342576 0.52326596 0.5229937  0.52278477 0.5226895
 0.52268744 0.52268517 0.52260834 0.5223706  0.52207404 0.5218032
 0.5217003  0.52175325 0.5217084  0.5213032  0.52068895 0.520436
 0.52073765 0.52120256 0.5213055  0.5212447  0.5221939  0.52468556]
