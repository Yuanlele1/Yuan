Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=34, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2132480.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5396854
	speed: 0.0293s/iter; left time: 778.1732s
	iters: 200, epoch: 1 | loss: 0.3935130
	speed: 0.0436s/iter; left time: 1154.2083s
Epoch: 1 cost time: 8.518776893615723
Epoch: 1, Steps: 267 | Train Loss: 0.5007643 Vali Loss: 0.9211403 Test Loss: 0.7040819
Validation loss decreased (inf --> 0.921140).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3431377
	speed: 0.1041s/iter; left time: 2741.4815s
	iters: 200, epoch: 2 | loss: 0.3196555
	speed: 0.0163s/iter; left time: 427.6786s
Epoch: 2 cost time: 5.859817028045654
Epoch: 2, Steps: 267 | Train Loss: 0.3311716 Vali Loss: 0.7762933 Test Loss: 0.5695196
Validation loss decreased (0.921140 --> 0.776293).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2774841
	speed: 0.0953s/iter; left time: 2484.9324s
	iters: 200, epoch: 3 | loss: 0.2821644
	speed: 0.0172s/iter; left time: 445.4486s
Epoch: 3 cost time: 5.757545471191406
Epoch: 3, Steps: 267 | Train Loss: 0.2758285 Vali Loss: 0.7016150 Test Loss: 0.5006409
Validation loss decreased (0.776293 --> 0.701615).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2481378
	speed: 0.0884s/iter; left time: 2281.1621s
	iters: 200, epoch: 4 | loss: 0.2456058
	speed: 0.0202s/iter; left time: 518.9864s
Epoch: 4 cost time: 5.596644163131714
Epoch: 4, Steps: 267 | Train Loss: 0.2457630 Vali Loss: 0.6536015 Test Loss: 0.4574552
Validation loss decreased (0.701615 --> 0.653601).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2202816
	speed: 0.0966s/iter; left time: 2466.4462s
	iters: 200, epoch: 5 | loss: 0.2361848
	speed: 0.0187s/iter; left time: 476.3265s
Epoch: 5 cost time: 5.909382343292236
Epoch: 5, Steps: 267 | Train Loss: 0.2263211 Vali Loss: 0.6183255 Test Loss: 0.4268562
Validation loss decreased (0.653601 --> 0.618325).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2066852
	speed: 0.1259s/iter; left time: 3180.2610s
	iters: 200, epoch: 6 | loss: 0.2139984
	speed: 0.0278s/iter; left time: 698.7218s
Epoch: 6 cost time: 9.166406869888306
Epoch: 6, Steps: 267 | Train Loss: 0.2128644 Vali Loss: 0.5945521 Test Loss: 0.4066628
Validation loss decreased (0.618325 --> 0.594552).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2063208
	speed: 0.1123s/iter; left time: 2806.2141s
	iters: 200, epoch: 7 | loss: 0.2138479
	speed: 0.0254s/iter; left time: 631.9765s
Epoch: 7 cost time: 6.808964490890503
Epoch: 7, Steps: 267 | Train Loss: 0.2031999 Vali Loss: 0.5771781 Test Loss: 0.3920664
Validation loss decreased (0.594552 --> 0.577178).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1925569
	speed: 0.1407s/iter; left time: 3479.2513s
	iters: 200, epoch: 8 | loss: 0.1760616
	speed: 0.0320s/iter; left time: 788.3005s
Epoch: 8 cost time: 8.941291093826294
Epoch: 8, Steps: 267 | Train Loss: 0.1961851 Vali Loss: 0.5651284 Test Loss: 0.3804023
Validation loss decreased (0.577178 --> 0.565128).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1735893
	speed: 0.1145s/iter; left time: 2801.8688s
	iters: 200, epoch: 9 | loss: 0.1872890
	speed: 0.0285s/iter; left time: 693.2494s
Epoch: 9 cost time: 9.125471115112305
Epoch: 9, Steps: 267 | Train Loss: 0.1910190 Vali Loss: 0.5541359 Test Loss: 0.3720635
Validation loss decreased (0.565128 --> 0.554136).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1895240
	speed: 0.1741s/iter; left time: 4212.6630s
	iters: 200, epoch: 10 | loss: 0.1833976
	speed: 0.0429s/iter; left time: 1034.3252s
Epoch: 10 cost time: 13.743144273757935
Epoch: 10, Steps: 267 | Train Loss: 0.1872244 Vali Loss: 0.5477147 Test Loss: 0.3662023
Validation loss decreased (0.554136 --> 0.547715).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1720272
	speed: 0.1555s/iter; left time: 3720.4611s
	iters: 200, epoch: 11 | loss: 0.1667420
	speed: 0.0192s/iter; left time: 457.1841s
Epoch: 11 cost time: 6.149519443511963
Epoch: 11, Steps: 267 | Train Loss: 0.1845026 Vali Loss: 0.5419880 Test Loss: 0.3618746
Validation loss decreased (0.547715 --> 0.541988).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1846781
	speed: 0.1589s/iter; left time: 3759.2802s
	iters: 200, epoch: 12 | loss: 0.1975861
	speed: 0.0370s/iter; left time: 872.8211s
Epoch: 12 cost time: 12.044008255004883
Epoch: 12, Steps: 267 | Train Loss: 0.1825315 Vali Loss: 0.5375709 Test Loss: 0.3581959
Validation loss decreased (0.541988 --> 0.537571).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1862938
	speed: 0.1196s/iter; left time: 2797.9626s
	iters: 200, epoch: 13 | loss: 0.2007100
	speed: 0.0326s/iter; left time: 760.4001s
Epoch: 13 cost time: 8.07871699333191
Epoch: 13, Steps: 267 | Train Loss: 0.1812357 Vali Loss: 0.5350211 Test Loss: 0.3555967
Validation loss decreased (0.537571 --> 0.535021).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1653869
	speed: 0.1795s/iter; left time: 4151.1693s
	iters: 200, epoch: 14 | loss: 0.1869466
	speed: 0.0190s/iter; left time: 438.2896s
Epoch: 14 cost time: 6.230769872665405
Epoch: 14, Steps: 267 | Train Loss: 0.1803187 Vali Loss: 0.5317836 Test Loss: 0.3540887
Validation loss decreased (0.535021 --> 0.531784).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1790313
	speed: 0.1084s/iter; left time: 2478.6261s
	iters: 200, epoch: 15 | loss: 0.1627044
	speed: 0.0186s/iter; left time: 424.0779s
Epoch: 15 cost time: 6.0141379833221436
Epoch: 15, Steps: 267 | Train Loss: 0.1797060 Vali Loss: 0.5309855 Test Loss: 0.3532431
Validation loss decreased (0.531784 --> 0.530986).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1503035
	speed: 0.1088s/iter; left time: 2458.1948s
	iters: 200, epoch: 16 | loss: 0.1866370
	speed: 0.0213s/iter; left time: 478.3651s
Epoch: 16 cost time: 6.96202540397644
Epoch: 16, Steps: 267 | Train Loss: 0.1793311 Vali Loss: 0.5293413 Test Loss: 0.3523982
Validation loss decreased (0.530986 --> 0.529341).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1778783
	speed: 0.1094s/iter; left time: 2442.9548s
	iters: 200, epoch: 17 | loss: 0.1984838
	speed: 0.0232s/iter; left time: 515.3014s
Epoch: 17 cost time: 7.491532802581787
Epoch: 17, Steps: 267 | Train Loss: 0.1790528 Vali Loss: 0.5291824 Test Loss: 0.3516756
Validation loss decreased (0.529341 --> 0.529182).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1787662
	speed: 0.0966s/iter; left time: 2130.4366s
	iters: 200, epoch: 18 | loss: 0.1862500
	speed: 0.0165s/iter; left time: 361.4095s
Epoch: 18 cost time: 5.399608135223389
Epoch: 18, Steps: 267 | Train Loss: 0.1789107 Vali Loss: 0.5278299 Test Loss: 0.3513720
Validation loss decreased (0.529182 --> 0.527830).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1668483
	speed: 0.0980s/iter; left time: 2136.1254s
	iters: 200, epoch: 19 | loss: 0.1883221
	speed: 0.0168s/iter; left time: 364.4603s
Epoch: 19 cost time: 5.476925373077393
Epoch: 19, Steps: 267 | Train Loss: 0.1788326 Vali Loss: 0.5268421 Test Loss: 0.3513824
Validation loss decreased (0.527830 --> 0.526842).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1839289
	speed: 0.1029s/iter; left time: 2216.2991s
	iters: 200, epoch: 20 | loss: 0.1848143
	speed: 0.0194s/iter; left time: 414.7169s
Epoch: 20 cost time: 6.829914569854736
Epoch: 20, Steps: 267 | Train Loss: 0.1788013 Vali Loss: 0.5282554 Test Loss: 0.3509470
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1950817
	speed: 0.1261s/iter; left time: 2680.7950s
	iters: 200, epoch: 21 | loss: 0.1739454
	speed: 0.0222s/iter; left time: 469.1066s
Epoch: 21 cost time: 6.478542327880859
Epoch: 21, Steps: 267 | Train Loss: 0.1787827 Vali Loss: 0.5272871 Test Loss: 0.3509405
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1732826
	speed: 0.1041s/iter; left time: 2184.4733s
	iters: 200, epoch: 22 | loss: 0.1721228
	speed: 0.0193s/iter; left time: 402.9012s
Epoch: 22 cost time: 6.397769212722778
Epoch: 22, Steps: 267 | Train Loss: 0.1787494 Vali Loss: 0.5271134 Test Loss: 0.3506710
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1777662
	speed: 0.1095s/iter; left time: 2268.6150s
	iters: 200, epoch: 23 | loss: 0.1691370
	speed: 0.0210s/iter; left time: 432.5051s
Epoch: 23 cost time: 5.534271955490112
Epoch: 23, Steps: 267 | Train Loss: 0.1787460 Vali Loss: 0.5275736 Test Loss: 0.3506185
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1671234
	speed: 0.1055s/iter; left time: 2159.0138s
	iters: 200, epoch: 24 | loss: 0.1853080
	speed: 0.0160s/iter; left time: 325.3621s
Epoch: 24 cost time: 5.947699308395386
Epoch: 24, Steps: 267 | Train Loss: 0.1787303 Vali Loss: 0.5270476 Test Loss: 0.3506400
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1994624
	speed: 0.1106s/iter; left time: 2234.2429s
	iters: 200, epoch: 25 | loss: 0.1825109
	speed: 0.0277s/iter; left time: 556.9577s
Epoch: 25 cost time: 6.21580696105957
Epoch: 25, Steps: 267 | Train Loss: 0.1787359 Vali Loss: 0.5266742 Test Loss: 0.3506198
Validation loss decreased (0.526842 --> 0.526674).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1818692
	speed: 0.1047s/iter; left time: 2086.4233s
	iters: 200, epoch: 26 | loss: 0.1916466
	speed: 0.0204s/iter; left time: 404.7951s
Epoch: 26 cost time: 5.803148984909058
Epoch: 26, Steps: 267 | Train Loss: 0.1787196 Vali Loss: 0.5270475 Test Loss: 0.3506652
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1887250
	speed: 0.1340s/iter; left time: 2633.9431s
	iters: 200, epoch: 27 | loss: 0.1865311
	speed: 0.0283s/iter; left time: 554.2075s
Epoch: 27 cost time: 8.481642484664917
Epoch: 27, Steps: 267 | Train Loss: 0.1787220 Vali Loss: 0.5269113 Test Loss: 0.3506914
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1862734
	speed: 0.1137s/iter; left time: 2204.6159s
	iters: 200, epoch: 28 | loss: 0.1868620
	speed: 0.0421s/iter; left time: 813.1561s
Epoch: 28 cost time: 9.490822792053223
Epoch: 28, Steps: 267 | Train Loss: 0.1787171 Vali Loss: 0.5274574 Test Loss: 0.3506472
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1745766
	speed: 0.1367s/iter; left time: 2614.7863s
	iters: 200, epoch: 29 | loss: 0.1849014
	speed: 0.0265s/iter; left time: 503.7868s
Epoch: 29 cost time: 8.957097053527832
Epoch: 29, Steps: 267 | Train Loss: 0.1786925 Vali Loss: 0.5270321 Test Loss: 0.3506315
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1777760
	speed: 0.1518s/iter; left time: 2863.1904s
	iters: 200, epoch: 30 | loss: 0.1869564
	speed: 0.0388s/iter; left time: 727.4744s
Epoch: 30 cost time: 10.676631212234497
Epoch: 30, Steps: 267 | Train Loss: 0.1787262 Vali Loss: 0.5265548 Test Loss: 0.3506388
Validation loss decreased (0.526674 --> 0.526555).  Saving model ...
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1727277
	speed: 0.1562s/iter; left time: 2904.0623s
	iters: 200, epoch: 31 | loss: 0.1719189
	speed: 0.0231s/iter; left time: 427.2404s
Epoch: 31 cost time: 8.80484390258789
Epoch: 31, Steps: 267 | Train Loss: 0.1787259 Vali Loss: 0.5261503 Test Loss: 0.3506491
Validation loss decreased (0.526555 --> 0.526150).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1905952
	speed: 0.1211s/iter; left time: 2219.7870s
	iters: 200, epoch: 32 | loss: 0.1721770
	speed: 0.0159s/iter; left time: 290.4247s
Epoch: 32 cost time: 6.230618000030518
Epoch: 32, Steps: 267 | Train Loss: 0.1787227 Vali Loss: 0.5267383 Test Loss: 0.3505944
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1727249
	speed: 0.1064s/iter; left time: 1921.7509s
	iters: 200, epoch: 33 | loss: 0.2037581
	speed: 0.0213s/iter; left time: 381.8379s
Epoch: 33 cost time: 5.780310153961182
Epoch: 33, Steps: 267 | Train Loss: 0.1787194 Vali Loss: 0.5271339 Test Loss: 0.3505485
EarlyStopping counter: 2 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1850291
	speed: 0.1023s/iter; left time: 1820.7944s
	iters: 200, epoch: 34 | loss: 0.1739037
	speed: 0.0170s/iter; left time: 300.0599s
Epoch: 34 cost time: 6.507655382156372
Epoch: 34, Steps: 267 | Train Loss: 0.1787432 Vali Loss: 0.5264434 Test Loss: 0.3507207
EarlyStopping counter: 3 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1550357
	speed: 0.1143s/iter; left time: 2003.6338s
	iters: 200, epoch: 35 | loss: 0.1839343
	speed: 0.0261s/iter; left time: 454.6172s
Epoch: 35 cost time: 7.66484808921814
Epoch: 35, Steps: 267 | Train Loss: 0.1787283 Vali Loss: 0.5269507 Test Loss: 0.3505756
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1855101
	speed: 0.1258s/iter; left time: 2170.1892s
	iters: 200, epoch: 36 | loss: 0.1806605
	speed: 0.0232s/iter; left time: 397.2178s
Epoch: 36 cost time: 6.732008218765259
Epoch: 36, Steps: 267 | Train Loss: 0.1787264 Vali Loss: 0.5271097 Test Loss: 0.3506109
EarlyStopping counter: 5 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2033292
	speed: 0.1060s/iter; left time: 1800.1352s
	iters: 200, epoch: 37 | loss: 0.1766712
	speed: 0.0250s/iter; left time: 422.9138s
Epoch: 37 cost time: 7.53112268447876
Epoch: 37, Steps: 267 | Train Loss: 0.1787312 Vali Loss: 0.5274065 Test Loss: 0.3505076
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1910498
	speed: 0.1036s/iter; left time: 1732.5052s
	iters: 200, epoch: 38 | loss: 0.1861476
	speed: 0.0223s/iter; left time: 370.0591s
Epoch: 38 cost time: 5.798667669296265
Epoch: 38, Steps: 267 | Train Loss: 0.1787251 Vali Loss: 0.5271084 Test Loss: 0.3505496
EarlyStopping counter: 7 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1894082
	speed: 0.0967s/iter; left time: 1590.6677s
	iters: 200, epoch: 39 | loss: 0.1875002
	speed: 0.0173s/iter; left time: 282.6243s
Epoch: 39 cost time: 5.677165985107422
Epoch: 39, Steps: 267 | Train Loss: 0.1787232 Vali Loss: 0.5273067 Test Loss: 0.3506122
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1738683
	speed: 0.0914s/iter; left time: 1479.2872s
	iters: 200, epoch: 40 | loss: 0.1927340
	speed: 0.0176s/iter; left time: 282.7855s
Epoch: 40 cost time: 5.166133880615234
Epoch: 40, Steps: 267 | Train Loss: 0.1786893 Vali Loss: 0.5269766 Test Loss: 0.3505429
EarlyStopping counter: 9 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2014321
	speed: 0.1036s/iter; left time: 1649.2913s
	iters: 200, epoch: 41 | loss: 0.1740149
	speed: 0.0326s/iter; left time: 515.7733s
Epoch: 41 cost time: 7.3548126220703125
Epoch: 41, Steps: 267 | Train Loss: 0.1787075 Vali Loss: 0.5265816 Test Loss: 0.3505987
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1958309
	speed: 0.1031s/iter; left time: 1613.3684s
	iters: 200, epoch: 42 | loss: 0.1715560
	speed: 0.0317s/iter; left time: 492.8431s
Epoch: 42 cost time: 8.858408451080322
Epoch: 42, Steps: 267 | Train Loss: 0.1787245 Vali Loss: 0.5264286 Test Loss: 0.3506674
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1769231
	speed: 0.1488s/iter; left time: 2290.1699s
	iters: 200, epoch: 43 | loss: 0.1761480
	speed: 0.0262s/iter; left time: 401.0706s
Epoch: 43 cost time: 7.937737941741943
Epoch: 43, Steps: 267 | Train Loss: 0.1787020 Vali Loss: 0.5263703 Test Loss: 0.3507247
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1788990
	speed: 0.1131s/iter; left time: 1710.6329s
	iters: 200, epoch: 44 | loss: 0.1626164
	speed: 0.0173s/iter; left time: 259.6161s
Epoch: 44 cost time: 5.2056169509887695
Epoch: 44, Steps: 267 | Train Loss: 0.1786801 Vali Loss: 0.5267872 Test Loss: 0.3506938
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1717292
	speed: 0.1287s/iter; left time: 1911.7843s
	iters: 200, epoch: 45 | loss: 0.1910248
	speed: 0.0304s/iter; left time: 448.9234s
Epoch: 45 cost time: 8.622699975967407
Epoch: 45, Steps: 267 | Train Loss: 0.1787212 Vali Loss: 0.5273995 Test Loss: 0.3506394
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1808749
	speed: 0.1195s/iter; left time: 1742.3508s
	iters: 200, epoch: 46 | loss: 0.1846370
	speed: 0.0286s/iter; left time: 414.0375s
Epoch: 46 cost time: 10.23020625114441
Epoch: 46, Steps: 267 | Train Loss: 0.1786797 Vali Loss: 0.5275096 Test Loss: 0.3506286
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1925709
	speed: 0.1376s/iter; left time: 1969.9716s
	iters: 200, epoch: 47 | loss: 0.1930582
	speed: 0.0164s/iter; left time: 233.8119s
Epoch: 47 cost time: 6.300301790237427
Epoch: 47, Steps: 267 | Train Loss: 0.1787210 Vali Loss: 0.5266136 Test Loss: 0.3506463
EarlyStopping counter: 16 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1645503
	speed: 0.1520s/iter; left time: 2135.6710s
	iters: 200, epoch: 48 | loss: 0.1678188
	speed: 0.0376s/iter; left time: 524.7692s
Epoch: 48 cost time: 11.245588302612305
Epoch: 48, Steps: 267 | Train Loss: 0.1786619 Vali Loss: 0.5262771 Test Loss: 0.3506259
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1743428
	speed: 0.1206s/iter; left time: 1662.6756s
	iters: 200, epoch: 49 | loss: 0.1669479
	speed: 0.0210s/iter; left time: 286.8107s
Epoch: 49 cost time: 6.386257648468018
Epoch: 49, Steps: 267 | Train Loss: 0.1786887 Vali Loss: 0.5269802 Test Loss: 0.3506481
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.1761979
	speed: 0.1058s/iter; left time: 1429.8466s
	iters: 200, epoch: 50 | loss: 0.1714619
	speed: 0.0164s/iter; left time: 219.5727s
Epoch: 50 cost time: 5.500927209854126
Epoch: 50, Steps: 267 | Train Loss: 0.1786974 Vali Loss: 0.5274956 Test Loss: 0.3506258
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.1846382
	speed: 0.1077s/iter; left time: 1427.0182s
	iters: 200, epoch: 51 | loss: 0.1831746
	speed: 0.0209s/iter; left time: 275.3021s
Epoch: 51 cost time: 6.317076921463013
Epoch: 51, Steps: 267 | Train Loss: 0.1787239 Vali Loss: 0.5264599 Test Loss: 0.3506059
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=34, out_features=70, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2132480.0
params:  2450.0
Trainable parameters:  2450
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3180767
	speed: 0.0329s/iter; left time: 875.2179s
	iters: 200, epoch: 1 | loss: 0.3094274
	speed: 0.0251s/iter; left time: 664.3286s
Epoch: 1 cost time: 7.655136346817017
Epoch: 1, Steps: 267 | Train Loss: 0.3314159 Vali Loss: 0.5245098 Test Loss: 0.3480469
Validation loss decreased (inf --> 0.524510).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3418325
	speed: 0.1308s/iter; left time: 3445.5139s
	iters: 200, epoch: 2 | loss: 0.3256047
	speed: 0.0254s/iter; left time: 665.9919s
Epoch: 2 cost time: 7.493671894073486
Epoch: 2, Steps: 267 | Train Loss: 0.3306093 Vali Loss: 0.5233066 Test Loss: 0.3479944
Validation loss decreased (0.524510 --> 0.523307).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2907139
	speed: 0.0978s/iter; left time: 2548.1298s
	iters: 200, epoch: 3 | loss: 0.3527251
	speed: 0.0242s/iter; left time: 629.5754s
Epoch: 3 cost time: 6.696168899536133
Epoch: 3, Steps: 267 | Train Loss: 0.3303217 Vali Loss: 0.5225425 Test Loss: 0.3476510
Validation loss decreased (0.523307 --> 0.522543).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3419073
	speed: 0.1136s/iter; left time: 2930.3066s
	iters: 200, epoch: 4 | loss: 0.3100262
	speed: 0.0390s/iter; left time: 1002.1869s
Epoch: 4 cost time: 8.331093788146973
Epoch: 4, Steps: 267 | Train Loss: 0.3301512 Vali Loss: 0.5224452 Test Loss: 0.3475372
Validation loss decreased (0.522543 --> 0.522445).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3253107
	speed: 0.1218s/iter; left time: 3108.8225s
	iters: 200, epoch: 5 | loss: 0.3276390
	speed: 0.0226s/iter; left time: 575.0735s
Epoch: 5 cost time: 6.720048189163208
Epoch: 5, Steps: 267 | Train Loss: 0.3300032 Vali Loss: 0.5214544 Test Loss: 0.3474651
Validation loss decreased (0.522445 --> 0.521454).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3359759
	speed: 0.0955s/iter; left time: 2412.8231s
	iters: 200, epoch: 6 | loss: 0.3689747
	speed: 0.0186s/iter; left time: 467.2969s
Epoch: 6 cost time: 5.672227621078491
Epoch: 6, Steps: 267 | Train Loss: 0.3299367 Vali Loss: 0.5221894 Test Loss: 0.3475212
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3484015
	speed: 0.1120s/iter; left time: 2798.6572s
	iters: 200, epoch: 7 | loss: 0.3044118
	speed: 0.0248s/iter; left time: 617.0167s
Epoch: 7 cost time: 7.890557527542114
Epoch: 7, Steps: 267 | Train Loss: 0.3298615 Vali Loss: 0.5215668 Test Loss: 0.3470855
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3457986
	speed: 0.1250s/iter; left time: 3091.3995s
	iters: 200, epoch: 8 | loss: 0.3682512
	speed: 0.0239s/iter; left time: 589.2343s
Epoch: 8 cost time: 7.110097408294678
Epoch: 8, Steps: 267 | Train Loss: 0.3298064 Vali Loss: 0.5221871 Test Loss: 0.3471721
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3556601
	speed: 0.1150s/iter; left time: 2814.2185s
	iters: 200, epoch: 9 | loss: 0.3240036
	speed: 0.0283s/iter; left time: 689.7840s
Epoch: 9 cost time: 7.156147718429565
Epoch: 9, Steps: 267 | Train Loss: 0.3297756 Vali Loss: 0.5219526 Test Loss: 0.3471200
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3242328
	speed: 0.1429s/iter; left time: 3457.2483s
	iters: 200, epoch: 10 | loss: 0.3140401
	speed: 0.0213s/iter; left time: 512.4039s
Epoch: 10 cost time: 8.135544538497925
Epoch: 10, Steps: 267 | Train Loss: 0.3297695 Vali Loss: 0.5214905 Test Loss: 0.3475276
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3192615
	speed: 0.1175s/iter; left time: 2811.1956s
	iters: 200, epoch: 11 | loss: 0.3352331
	speed: 0.0433s/iter; left time: 1031.9576s
Epoch: 11 cost time: 11.0414559841156
Epoch: 11, Steps: 267 | Train Loss: 0.3297468 Vali Loss: 0.5220891 Test Loss: 0.3475091
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3259698
	speed: 0.1601s/iter; left time: 3787.5235s
	iters: 200, epoch: 12 | loss: 0.3425464
	speed: 0.0248s/iter; left time: 585.4081s
Epoch: 12 cost time: 7.348564386367798
Epoch: 12, Steps: 267 | Train Loss: 0.3297385 Vali Loss: 0.5206362 Test Loss: 0.3473882
Validation loss decreased (0.521454 --> 0.520636).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3420518
	speed: 0.1089s/iter; left time: 2548.0436s
	iters: 200, epoch: 13 | loss: 0.3496414
	speed: 0.0169s/iter; left time: 393.8600s
Epoch: 13 cost time: 5.017476320266724
Epoch: 13, Steps: 267 | Train Loss: 0.3296865 Vali Loss: 0.5209906 Test Loss: 0.3469661
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3270172
	speed: 0.1033s/iter; left time: 2388.9239s
	iters: 200, epoch: 14 | loss: 0.3394793
	speed: 0.0194s/iter; left time: 447.2972s
Epoch: 14 cost time: 5.9355175495147705
Epoch: 14, Steps: 267 | Train Loss: 0.3296800 Vali Loss: 0.5216258 Test Loss: 0.3473213
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3155657
	speed: 0.1265s/iter; left time: 2891.3804s
	iters: 200, epoch: 15 | loss: 0.3677358
	speed: 0.0450s/iter; left time: 1025.2293s
Epoch: 15 cost time: 10.484358787536621
Epoch: 15, Steps: 267 | Train Loss: 0.3296598 Vali Loss: 0.5216572 Test Loss: 0.3471979
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3632482
	speed: 0.1038s/iter; left time: 2344.6622s
	iters: 200, epoch: 16 | loss: 0.3262989
	speed: 0.0310s/iter; left time: 696.7664s
Epoch: 16 cost time: 8.801025867462158
Epoch: 16, Steps: 267 | Train Loss: 0.3296262 Vali Loss: 0.5218588 Test Loss: 0.3472433
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3058985
	speed: 0.1491s/iter; left time: 3329.6000s
	iters: 200, epoch: 17 | loss: 0.3378760
	speed: 0.0255s/iter; left time: 566.4336s
Epoch: 17 cost time: 7.642415523529053
Epoch: 17, Steps: 267 | Train Loss: 0.3296250 Vali Loss: 0.5223926 Test Loss: 0.3473505
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3241023
	speed: 0.1300s/iter; left time: 2867.6069s
	iters: 200, epoch: 18 | loss: 0.3038096
	speed: 0.0344s/iter; left time: 754.5727s
Epoch: 18 cost time: 8.815024375915527
Epoch: 18, Steps: 267 | Train Loss: 0.3295764 Vali Loss: 0.5216688 Test Loss: 0.3473028
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3550000
	speed: 0.1026s/iter; left time: 2236.6301s
	iters: 200, epoch: 19 | loss: 0.3649322
	speed: 0.0174s/iter; left time: 376.6606s
Epoch: 19 cost time: 5.253916025161743
Epoch: 19, Steps: 267 | Train Loss: 0.3295748 Vali Loss: 0.5219440 Test Loss: 0.3473510
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3387893
	speed: 0.0863s/iter; left time: 1857.7904s
	iters: 200, epoch: 20 | loss: 0.3269268
	speed: 0.0259s/iter; left time: 555.6590s
Epoch: 20 cost time: 6.1797404289245605
Epoch: 20, Steps: 267 | Train Loss: 0.3295713 Vali Loss: 0.5219888 Test Loss: 0.3474532
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3110025
	speed: 0.0929s/iter; left time: 1976.1702s
	iters: 200, epoch: 21 | loss: 0.3282850
	speed: 0.0171s/iter; left time: 361.1890s
Epoch: 21 cost time: 5.331374883651733
Epoch: 21, Steps: 267 | Train Loss: 0.3295797 Vali Loss: 0.5214294 Test Loss: 0.3474939
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3413312
	speed: 0.1144s/iter; left time: 2402.0783s
	iters: 200, epoch: 22 | loss: 0.3771442
	speed: 0.0199s/iter; left time: 415.5778s
Epoch: 22 cost time: 6.670879125595093
Epoch: 22, Steps: 267 | Train Loss: 0.3294687 Vali Loss: 0.5215725 Test Loss: 0.3473320
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3588635
	speed: 0.1200s/iter; left time: 2487.3472s
	iters: 200, epoch: 23 | loss: 0.3742540
	speed: 0.0213s/iter; left time: 438.5490s
Epoch: 23 cost time: 7.525881767272949
Epoch: 23, Steps: 267 | Train Loss: 0.3295792 Vali Loss: 0.5213643 Test Loss: 0.3473761
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3386432
	speed: 0.1371s/iter; left time: 2806.0170s
	iters: 200, epoch: 24 | loss: 0.3314878
	speed: 0.0224s/iter; left time: 456.4725s
Epoch: 24 cost time: 7.536936044692993
Epoch: 24, Steps: 267 | Train Loss: 0.3295160 Vali Loss: 0.5216715 Test Loss: 0.3472269
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3456616
	speed: 0.1207s/iter; left time: 2436.7584s
	iters: 200, epoch: 25 | loss: 0.2894588
	speed: 0.0162s/iter; left time: 325.0221s
Epoch: 25 cost time: 6.166264772415161
Epoch: 25, Steps: 267 | Train Loss: 0.3295281 Vali Loss: 0.5213201 Test Loss: 0.3473310
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3129823
	speed: 0.1096s/iter; left time: 2183.4534s
	iters: 200, epoch: 26 | loss: 0.2920808
	speed: 0.0199s/iter; left time: 394.4785s
Epoch: 26 cost time: 6.490834951400757
Epoch: 26, Steps: 267 | Train Loss: 0.3295170 Vali Loss: 0.5209936 Test Loss: 0.3473565
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3194458
	speed: 0.0975s/iter; left time: 1917.3840s
	iters: 200, epoch: 27 | loss: 0.3283510
	speed: 0.0165s/iter; left time: 321.8480s
Epoch: 27 cost time: 5.053108215332031
Epoch: 27, Steps: 267 | Train Loss: 0.3295233 Vali Loss: 0.5217420 Test Loss: 0.3472722
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3849571
	speed: 0.0894s/iter; left time: 1733.2625s
	iters: 200, epoch: 28 | loss: 0.3393064
	speed: 0.0200s/iter; left time: 386.4207s
Epoch: 28 cost time: 5.8805413246154785
Epoch: 28, Steps: 267 | Train Loss: 0.3295000 Vali Loss: 0.5219662 Test Loss: 0.3472866
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2718729
	speed: 0.1205s/iter; left time: 2304.7196s
	iters: 200, epoch: 29 | loss: 0.3284684
	speed: 0.0285s/iter; left time: 543.0963s
Epoch: 29 cost time: 7.820833921432495
Epoch: 29, Steps: 267 | Train Loss: 0.3294848 Vali Loss: 0.5218855 Test Loss: 0.3471742
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3157285
	speed: 0.1980s/iter; left time: 3734.0052s
	iters: 200, epoch: 30 | loss: 0.3599438
	speed: 0.0247s/iter; left time: 463.2388s
Epoch: 30 cost time: 9.768565893173218
Epoch: 30, Steps: 267 | Train Loss: 0.3294937 Vali Loss: 0.5213875 Test Loss: 0.3472744
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3136511
	speed: 0.1470s/iter; left time: 2733.5814s
	iters: 200, epoch: 31 | loss: 0.3286372
	speed: 0.0289s/iter; left time: 533.7929s
Epoch: 31 cost time: 6.925714731216431
Epoch: 31, Steps: 267 | Train Loss: 0.3294959 Vali Loss: 0.5217904 Test Loss: 0.3471324
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3198741
	speed: 0.1147s/iter; left time: 2101.0649s
	iters: 200, epoch: 32 | loss: 0.3184662
	speed: 0.0218s/iter; left time: 396.9433s
Epoch: 32 cost time: 7.528291702270508
Epoch: 32, Steps: 267 | Train Loss: 0.3294946 Vali Loss: 0.5215151 Test Loss: 0.3471258
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.34758618474006653, mae:0.36880990862846375, rse:0.5612195134162903, corr:[0.548524   0.55430603 0.55151284 0.5492454  0.54964244 0.5503401
 0.54960537 0.54858446 0.54844284 0.54927343 0.5501607  0.5501116
 0.54931676 0.54776585 0.54579175 0.54391515 0.542197   0.5404059
 0.5384476  0.53642035 0.5345039  0.5325945  0.5304193  0.5280207
 0.52565366 0.52360696 0.5219904  0.5204827  0.51908535 0.51806337
 0.5178228  0.5182232  0.5188018  0.5192591  0.51938665 0.51928866
 0.5189704  0.518562   0.51839054 0.5183441  0.51837134 0.5182672
 0.51810443 0.5181006  0.5182027  0.5182747  0.51824945 0.5181365
 0.51805377 0.51806515 0.51821035 0.5184122  0.51860774 0.5187427
 0.5188739  0.5189688  0.5191021  0.51909757 0.5190096  0.5187983
 0.5186131  0.51847166 0.5183143  0.5181047  0.51787865 0.5178541
 0.5180123  0.51821434 0.518477   0.5187115  0.518913   0.51907134
 0.5192051  0.5192864  0.5193876  0.51935446 0.51927704 0.51921517
 0.5192068  0.5191646  0.51904726 0.5188241  0.51859707 0.51836824
 0.5181988  0.5181315  0.51810306 0.5179192  0.5175126  0.51711625
 0.5168152  0.5166166  0.5164114  0.51604253 0.5153916  0.5145261
 0.51367855 0.51293033 0.5121264  0.51119626 0.5105029  0.5104185
 0.5109735  0.511852   0.5127116  0.51346046 0.51422566 0.5151268
 0.5160825  0.51687413 0.5174425  0.51790076 0.5180947  0.517932
 0.5174427  0.51695746 0.5166688  0.51661825 0.5166789  0.5165396
 0.51611394 0.5153649  0.5145642  0.5140438  0.5137444  0.5134364
 0.51304996 0.5127079  0.5126102  0.51281244 0.51307636 0.5131055
 0.5128469  0.5125777  0.5123709  0.5120934  0.5118167  0.5115227
 0.511321   0.5113921  0.51157206 0.51164246 0.5115541  0.51147157
 0.5115328  0.5117285  0.5117422  0.51154256 0.5113915  0.5112784
 0.511369   0.51160365 0.5117586  0.5117675  0.51160055 0.5114985
 0.5114941  0.5115081  0.51135164 0.5111427  0.5109667  0.51092
 0.51100713 0.51117176 0.5113602  0.5116796  0.51195645 0.51203346
 0.51196223 0.51189    0.512018   0.51253545 0.5130358  0.51309794
 0.51273805 0.5123023  0.5122558  0.5126184  0.5128812  0.51278776
 0.5124516  0.512336   0.5126123  0.5129661  0.5130201  0.51290214
 0.5131887  0.51408386 0.51497686 0.5152052  0.5152679  0.51683384]
