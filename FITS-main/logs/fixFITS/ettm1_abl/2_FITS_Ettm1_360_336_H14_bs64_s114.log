Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=66, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_360_336', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=360, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_360_336_FITS_ETTm1_ftM_sl360_ll48_pl336_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33865
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=66, out_features=127, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  7510272.0
params:  8509.0
Trainable parameters:  8509
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4292864
	speed: 0.0205s/iter; left time: 539.0614s
	iters: 200, epoch: 1 | loss: 0.3351929
	speed: 0.0139s/iter; left time: 365.0280s
Epoch: 1 cost time: 4.300350904464722
Epoch: 1, Steps: 264 | Train Loss: 0.4385311 Vali Loss: 0.8700632 Test Loss: 0.5239103
Validation loss decreased (inf --> 0.870063).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2818381
	speed: 0.0647s/iter; left time: 1684.6543s
	iters: 200, epoch: 2 | loss: 0.2539751
	speed: 0.0135s/iter; left time: 350.0129s
Epoch: 2 cost time: 4.343207359313965
Epoch: 2, Steps: 264 | Train Loss: 0.2682034 Vali Loss: 0.7586793 Test Loss: 0.4391949
Validation loss decreased (0.870063 --> 0.758679).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2176580
	speed: 0.0630s/iter; left time: 1622.9544s
	iters: 200, epoch: 3 | loss: 0.2079751
	speed: 0.0122s/iter; left time: 313.0527s
Epoch: 3 cost time: 3.8090384006500244
Epoch: 3, Steps: 264 | Train Loss: 0.2231382 Vali Loss: 0.7154601 Test Loss: 0.4086374
Validation loss decreased (0.758679 --> 0.715460).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2053628
	speed: 0.0641s/iter; left time: 1636.0286s
	iters: 200, epoch: 4 | loss: 0.1953472
	speed: 0.0131s/iter; left time: 333.1661s
Epoch: 4 cost time: 4.1267311573028564
Epoch: 4, Steps: 264 | Train Loss: 0.2030186 Vali Loss: 0.6933967 Test Loss: 0.3935936
Validation loss decreased (0.715460 --> 0.693397).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1921502
	speed: 0.0640s/iter; left time: 1615.8095s
	iters: 200, epoch: 5 | loss: 0.1939519
	speed: 0.0125s/iter; left time: 313.2450s
Epoch: 5 cost time: 3.9623003005981445
Epoch: 5, Steps: 264 | Train Loss: 0.1925964 Vali Loss: 0.6809230 Test Loss: 0.3857193
Validation loss decreased (0.693397 --> 0.680923).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1935173
	speed: 0.0609s/iter; left time: 1521.9560s
	iters: 200, epoch: 6 | loss: 0.1858601
	speed: 0.0129s/iter; left time: 320.6834s
Epoch: 6 cost time: 3.917733669281006
Epoch: 6, Steps: 264 | Train Loss: 0.1867512 Vali Loss: 0.6743602 Test Loss: 0.3812931
Validation loss decreased (0.680923 --> 0.674360).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2023981
	speed: 0.0589s/iter; left time: 1456.4534s
	iters: 200, epoch: 7 | loss: 0.1865652
	speed: 0.0122s/iter; left time: 301.5216s
Epoch: 7 cost time: 3.9468817710876465
Epoch: 7, Steps: 264 | Train Loss: 0.1833043 Vali Loss: 0.6698279 Test Loss: 0.3787503
Validation loss decreased (0.674360 --> 0.669828).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1839704
	speed: 0.0616s/iter; left time: 1506.8000s
	iters: 200, epoch: 8 | loss: 0.1618132
	speed: 0.0126s/iter; left time: 305.6335s
Epoch: 8 cost time: 3.8380534648895264
Epoch: 8, Steps: 264 | Train Loss: 0.1812133 Vali Loss: 0.6673472 Test Loss: 0.3773790
Validation loss decreased (0.669828 --> 0.667347).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1688955
	speed: 0.0589s/iter; left time: 1424.2732s
	iters: 200, epoch: 9 | loss: 0.1722120
	speed: 0.0150s/iter; left time: 360.8459s
Epoch: 9 cost time: 4.181406259536743
Epoch: 9, Steps: 264 | Train Loss: 0.1799788 Vali Loss: 0.6655089 Test Loss: 0.3765630
Validation loss decreased (0.667347 --> 0.665509).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1757702
	speed: 0.0590s/iter; left time: 1411.0273s
	iters: 200, epoch: 10 | loss: 0.1601590
	speed: 0.0124s/iter; left time: 296.0913s
Epoch: 10 cost time: 3.837113380432129
Epoch: 10, Steps: 264 | Train Loss: 0.1791632 Vali Loss: 0.6652979 Test Loss: 0.3763252
Validation loss decreased (0.665509 --> 0.665298).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1714119
	speed: 0.0603s/iter; left time: 1427.5610s
	iters: 200, epoch: 11 | loss: 0.1633476
	speed: 0.0124s/iter; left time: 291.1177s
Epoch: 11 cost time: 3.79862380027771
Epoch: 11, Steps: 264 | Train Loss: 0.1786110 Vali Loss: 0.6638094 Test Loss: 0.3758216
Validation loss decreased (0.665298 --> 0.663809).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1693776
	speed: 0.0583s/iter; left time: 1364.3569s
	iters: 200, epoch: 12 | loss: 0.1796279
	speed: 0.0136s/iter; left time: 315.9409s
Epoch: 12 cost time: 4.002039670944214
Epoch: 12, Steps: 264 | Train Loss: 0.1782996 Vali Loss: 0.6623694 Test Loss: 0.3759083
Validation loss decreased (0.663809 --> 0.662369).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1803354
	speed: 0.0629s/iter; left time: 1454.1312s
	iters: 200, epoch: 13 | loss: 0.1764548
	speed: 0.0126s/iter; left time: 290.4894s
Epoch: 13 cost time: 4.0180394649505615
Epoch: 13, Steps: 264 | Train Loss: 0.1780334 Vali Loss: 0.6621109 Test Loss: 0.3761066
Validation loss decreased (0.662369 --> 0.662111).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1846932
	speed: 0.0594s/iter; left time: 1358.4851s
	iters: 200, epoch: 14 | loss: 0.1677762
	speed: 0.0124s/iter; left time: 281.9499s
Epoch: 14 cost time: 3.8426194190979004
Epoch: 14, Steps: 264 | Train Loss: 0.1777980 Vali Loss: 0.6633784 Test Loss: 0.3755462
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1609370
	speed: 0.0587s/iter; left time: 1327.0549s
	iters: 200, epoch: 15 | loss: 0.1910815
	speed: 0.0121s/iter; left time: 272.6169s
Epoch: 15 cost time: 3.899367570877075
Epoch: 15, Steps: 264 | Train Loss: 0.1777318 Vali Loss: 0.6636087 Test Loss: 0.3755179
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1912223
	speed: 0.0557s/iter; left time: 1243.4045s
	iters: 200, epoch: 16 | loss: 0.1743330
	speed: 0.0131s/iter; left time: 291.3110s
Epoch: 16 cost time: 4.243340969085693
Epoch: 16, Steps: 264 | Train Loss: 0.1776664 Vali Loss: 0.6626715 Test Loss: 0.3757240
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1632174
	speed: 0.0644s/iter; left time: 1421.9392s
	iters: 200, epoch: 17 | loss: 0.1695369
	speed: 0.0126s/iter; left time: 276.3839s
Epoch: 17 cost time: 3.924046754837036
Epoch: 17, Steps: 264 | Train Loss: 0.1775787 Vali Loss: 0.6631792 Test Loss: 0.3757464
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1763193
	speed: 0.0594s/iter; left time: 1294.6439s
	iters: 200, epoch: 18 | loss: 0.1700709
	speed: 0.0130s/iter; left time: 283.0988s
Epoch: 18 cost time: 3.907961368560791
Epoch: 18, Steps: 264 | Train Loss: 0.1775590 Vali Loss: 0.6633688 Test Loss: 0.3752736
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1857883
	speed: 0.0578s/iter; left time: 1245.0366s
	iters: 200, epoch: 19 | loss: 0.1936394
	speed: 0.0130s/iter; left time: 278.3299s
Epoch: 19 cost time: 3.776073932647705
Epoch: 19, Steps: 264 | Train Loss: 0.1774780 Vali Loss: 0.6637443 Test Loss: 0.3755189
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1671078
	speed: 0.0609s/iter; left time: 1295.7361s
	iters: 200, epoch: 20 | loss: 0.1865765
	speed: 0.0130s/iter; left time: 274.9459s
Epoch: 20 cost time: 3.968433141708374
Epoch: 20, Steps: 264 | Train Loss: 0.1774903 Vali Loss: 0.6637053 Test Loss: 0.3756678
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1689337
	speed: 0.0598s/iter; left time: 1257.4518s
	iters: 200, epoch: 21 | loss: 0.1747901
	speed: 0.0131s/iter; left time: 273.7178s
Epoch: 21 cost time: 3.911957025527954
Epoch: 21, Steps: 264 | Train Loss: 0.1774817 Vali Loss: 0.6630343 Test Loss: 0.3754635
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1816075
	speed: 0.0581s/iter; left time: 1205.9166s
	iters: 200, epoch: 22 | loss: 0.1786241
	speed: 0.0134s/iter; left time: 276.7540s
Epoch: 22 cost time: 4.00752067565918
Epoch: 22, Steps: 264 | Train Loss: 0.1774711 Vali Loss: 0.6623980 Test Loss: 0.3754975
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1674574
	speed: 0.0612s/iter; left time: 1255.1397s
	iters: 200, epoch: 23 | loss: 0.1760294
	speed: 0.0128s/iter; left time: 260.2133s
Epoch: 23 cost time: 3.938236951828003
Epoch: 23, Steps: 264 | Train Loss: 0.1774202 Vali Loss: 0.6632394 Test Loss: 0.3757037
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1756931
	speed: 0.0577s/iter; left time: 1167.9808s
	iters: 200, epoch: 24 | loss: 0.1796394
	speed: 0.0130s/iter; left time: 262.4330s
Epoch: 24 cost time: 3.7982800006866455
Epoch: 24, Steps: 264 | Train Loss: 0.1774488 Vali Loss: 0.6633822 Test Loss: 0.3755091
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1838311
	speed: 0.0579s/iter; left time: 1155.6273s
	iters: 200, epoch: 25 | loss: 0.1891233
	speed: 0.0126s/iter; left time: 249.8627s
Epoch: 25 cost time: 3.8815114498138428
Epoch: 25, Steps: 264 | Train Loss: 0.1774631 Vali Loss: 0.6633836 Test Loss: 0.3756507
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1778172
	speed: 0.0567s/iter; left time: 1116.5195s
	iters: 200, epoch: 26 | loss: 0.1663714
	speed: 0.0126s/iter; left time: 247.8841s
Epoch: 26 cost time: 3.855534791946411
Epoch: 26, Steps: 264 | Train Loss: 0.1774667 Vali Loss: 0.6627654 Test Loss: 0.3755438
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1831533
	speed: 0.0603s/iter; left time: 1172.5173s
	iters: 200, epoch: 27 | loss: 0.1771387
	speed: 0.0131s/iter; left time: 252.6343s
Epoch: 27 cost time: 4.027305841445923
Epoch: 27, Steps: 264 | Train Loss: 0.1774588 Vali Loss: 0.6628160 Test Loss: 0.3755703
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1760414
	speed: 0.0674s/iter; left time: 1292.7805s
	iters: 200, epoch: 28 | loss: 0.1764134
	speed: 0.0124s/iter; left time: 235.5976s
Epoch: 28 cost time: 3.8891489505767822
Epoch: 28, Steps: 264 | Train Loss: 0.1773933 Vali Loss: 0.6632248 Test Loss: 0.3755990
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1910686
	speed: 0.0583s/iter; left time: 1102.5210s
	iters: 200, epoch: 29 | loss: 0.1723771
	speed: 0.0129s/iter; left time: 242.2357s
Epoch: 29 cost time: 3.9211785793304443
Epoch: 29, Steps: 264 | Train Loss: 0.1774270 Vali Loss: 0.6615483 Test Loss: 0.3756076
Validation loss decreased (0.662111 --> 0.661548).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1795559
	speed: 0.0576s/iter; left time: 1074.3707s
	iters: 200, epoch: 30 | loss: 0.1807980
	speed: 0.0128s/iter; left time: 238.0790s
Epoch: 30 cost time: 3.8650386333465576
Epoch: 30, Steps: 264 | Train Loss: 0.1774184 Vali Loss: 0.6625226 Test Loss: 0.3756170
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1697076
	speed: 0.0604s/iter; left time: 1109.7751s
	iters: 200, epoch: 31 | loss: 0.1681763
	speed: 0.0133s/iter; left time: 242.3120s
Epoch: 31 cost time: 4.02530837059021
Epoch: 31, Steps: 264 | Train Loss: 0.1774079 Vali Loss: 0.6625262 Test Loss: 0.3756943
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1754263
	speed: 0.0590s/iter; left time: 1068.6895s
	iters: 200, epoch: 32 | loss: 0.1935133
	speed: 0.0129s/iter; left time: 231.6769s
Epoch: 32 cost time: 3.9193646907806396
Epoch: 32, Steps: 264 | Train Loss: 0.1774186 Vali Loss: 0.6628613 Test Loss: 0.3756648
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1699907
	speed: 0.0609s/iter; left time: 1086.8230s
	iters: 200, epoch: 33 | loss: 0.1860550
	speed: 0.0128s/iter; left time: 228.0214s
Epoch: 33 cost time: 4.003362655639648
Epoch: 33, Steps: 264 | Train Loss: 0.1773780 Vali Loss: 0.6632736 Test Loss: 0.3757010
EarlyStopping counter: 4 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1857559
	speed: 0.0640s/iter; left time: 1126.2047s
	iters: 200, epoch: 34 | loss: 0.1692894
	speed: 0.0128s/iter; left time: 223.1966s
Epoch: 34 cost time: 3.9015352725982666
Epoch: 34, Steps: 264 | Train Loss: 0.1774196 Vali Loss: 0.6633170 Test Loss: 0.3755752
EarlyStopping counter: 5 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1781202
	speed: 0.0608s/iter; left time: 1052.7093s
	iters: 200, epoch: 35 | loss: 0.1809095
	speed: 0.0130s/iter; left time: 224.3737s
Epoch: 35 cost time: 4.000971794128418
Epoch: 35, Steps: 264 | Train Loss: 0.1773630 Vali Loss: 0.6628586 Test Loss: 0.3755910
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1770579
	speed: 0.0594s/iter; left time: 1012.5871s
	iters: 200, epoch: 36 | loss: 0.1814430
	speed: 0.0131s/iter; left time: 222.6233s
Epoch: 36 cost time: 4.30922532081604
Epoch: 36, Steps: 264 | Train Loss: 0.1774167 Vali Loss: 0.6637079 Test Loss: 0.3756557
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1966075
	speed: 0.0639s/iter; left time: 1074.0351s
	iters: 200, epoch: 37 | loss: 0.1544322
	speed: 0.0130s/iter; left time: 216.3287s
Epoch: 37 cost time: 3.9698569774627686
Epoch: 37, Steps: 264 | Train Loss: 0.1773997 Vali Loss: 0.6629387 Test Loss: 0.3756059
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1798450
	speed: 0.0612s/iter; left time: 1012.5515s
	iters: 200, epoch: 38 | loss: 0.1693742
	speed: 0.0143s/iter; left time: 235.7009s
Epoch: 38 cost time: 4.16222882270813
Epoch: 38, Steps: 264 | Train Loss: 0.1774098 Vali Loss: 0.6629013 Test Loss: 0.3756410
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1652833
	speed: 0.0638s/iter; left time: 1037.5783s
	iters: 200, epoch: 39 | loss: 0.1823829
	speed: 0.0141s/iter; left time: 227.2513s
Epoch: 39 cost time: 4.530866622924805
Epoch: 39, Steps: 264 | Train Loss: 0.1773653 Vali Loss: 0.6630378 Test Loss: 0.3756233
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1745873
	speed: 0.0658s/iter; left time: 1053.3606s
	iters: 200, epoch: 40 | loss: 0.1738483
	speed: 0.0117s/iter; left time: 186.1443s
Epoch: 40 cost time: 3.951853036880493
Epoch: 40, Steps: 264 | Train Loss: 0.1774082 Vali Loss: 0.6626791 Test Loss: 0.3756725
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1655042
	speed: 0.0641s/iter; left time: 1009.6086s
	iters: 200, epoch: 41 | loss: 0.1615445
	speed: 0.0125s/iter; left time: 196.1514s
Epoch: 41 cost time: 4.001489877700806
Epoch: 41, Steps: 264 | Train Loss: 0.1773374 Vali Loss: 0.6632866 Test Loss: 0.3756505
EarlyStopping counter: 12 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1685982
	speed: 0.0624s/iter; left time: 965.0113s
	iters: 200, epoch: 42 | loss: 0.1686343
	speed: 0.0131s/iter; left time: 201.5586s
Epoch: 42 cost time: 3.92794132232666
Epoch: 42, Steps: 264 | Train Loss: 0.1773606 Vali Loss: 0.6621799 Test Loss: 0.3755961
EarlyStopping counter: 13 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1988007
	speed: 0.0587s/iter; left time: 893.2042s
	iters: 200, epoch: 43 | loss: 0.1727027
	speed: 0.0154s/iter; left time: 233.4212s
Epoch: 43 cost time: 4.534590005874634
Epoch: 43, Steps: 264 | Train Loss: 0.1773924 Vali Loss: 0.6629218 Test Loss: 0.3756209
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.1845088
	speed: 0.0646s/iter; left time: 964.9783s
	iters: 200, epoch: 44 | loss: 0.1522101
	speed: 0.0127s/iter; left time: 188.8161s
Epoch: 44 cost time: 3.9648778438568115
Epoch: 44, Steps: 264 | Train Loss: 0.1773677 Vali Loss: 0.6631277 Test Loss: 0.3756364
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.1820042
	speed: 0.0629s/iter; left time: 923.1383s
	iters: 200, epoch: 45 | loss: 0.1669795
	speed: 0.0146s/iter; left time: 213.4270s
Epoch: 45 cost time: 4.280941963195801
Epoch: 45, Steps: 264 | Train Loss: 0.1774258 Vali Loss: 0.6629001 Test Loss: 0.3756248
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.1832988
	speed: 0.0712s/iter; left time: 1027.1813s
	iters: 200, epoch: 46 | loss: 0.1724695
	speed: 0.0148s/iter; left time: 211.4046s
Epoch: 46 cost time: 5.131807804107666
Epoch: 46, Steps: 264 | Train Loss: 0.1773936 Vali Loss: 0.6630800 Test Loss: 0.3756233
EarlyStopping counter: 17 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.1856187
	speed: 0.0658s/iter; left time: 930.9039s
	iters: 200, epoch: 47 | loss: 0.1816187
	speed: 0.0118s/iter; left time: 165.2201s
Epoch: 47 cost time: 3.859687328338623
Epoch: 47, Steps: 264 | Train Loss: 0.1773795 Vali Loss: 0.6628438 Test Loss: 0.3755985
EarlyStopping counter: 18 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.1767457
	speed: 0.0592s/iter; left time: 822.8113s
	iters: 200, epoch: 48 | loss: 0.1778680
	speed: 0.0118s/iter; left time: 162.9902s
Epoch: 48 cost time: 3.713197708129883
Epoch: 48, Steps: 264 | Train Loss: 0.1773786 Vali Loss: 0.6626557 Test Loss: 0.3756222
EarlyStopping counter: 19 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.1987960
	speed: 0.0564s/iter; left time: 769.2558s
	iters: 200, epoch: 49 | loss: 0.1783939
	speed: 0.0127s/iter; left time: 171.8802s
Epoch: 49 cost time: 3.8261287212371826
Epoch: 49, Steps: 264 | Train Loss: 0.1774077 Vali Loss: 0.6625292 Test Loss: 0.3756703
EarlyStopping counter: 20 out of 20
Early stopping
train 33865
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=66, out_features=127, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  7510272.0
params:  8509.0
Trainable parameters:  8509
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3545817
	speed: 0.0173s/iter; left time: 454.9281s
	iters: 200, epoch: 1 | loss: 0.3059432
	speed: 0.0123s/iter; left time: 321.9492s
Epoch: 1 cost time: 3.753164768218994
Epoch: 1, Steps: 264 | Train Loss: 0.3489847 Vali Loss: 0.6574894 Test Loss: 0.3730870
Validation loss decreased (inf --> 0.657489).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3368334
	speed: 0.0590s/iter; left time: 1537.0532s
	iters: 200, epoch: 2 | loss: 0.3353020
	speed: 0.0130s/iter; left time: 336.1649s
Epoch: 2 cost time: 3.8957200050354004
Epoch: 2, Steps: 264 | Train Loss: 0.3481481 Vali Loss: 0.6561929 Test Loss: 0.3725016
Validation loss decreased (0.657489 --> 0.656193).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3939846
	speed: 0.0704s/iter; left time: 1815.3144s
	iters: 200, epoch: 3 | loss: 0.3597483
	speed: 0.0127s/iter; left time: 326.2078s
Epoch: 3 cost time: 3.8575894832611084
Epoch: 3, Steps: 264 | Train Loss: 0.3477425 Vali Loss: 0.6541856 Test Loss: 0.3723766
Validation loss decreased (0.656193 --> 0.654186).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3691604
	speed: 0.0593s/iter; left time: 1513.3236s
	iters: 200, epoch: 4 | loss: 0.3404230
	speed: 0.0166s/iter; left time: 422.7774s
Epoch: 4 cost time: 4.511534690856934
Epoch: 4, Steps: 264 | Train Loss: 0.3474629 Vali Loss: 0.6544340 Test Loss: 0.3721449
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3322132
	speed: 0.0610s/iter; left time: 1540.8783s
	iters: 200, epoch: 5 | loss: 0.3406848
	speed: 0.0143s/iter; left time: 359.9021s
Epoch: 5 cost time: 4.076337814331055
Epoch: 5, Steps: 264 | Train Loss: 0.3472758 Vali Loss: 0.6535878 Test Loss: 0.3715295
Validation loss decreased (0.654186 --> 0.653588).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3716745
	speed: 0.0624s/iter; left time: 1559.9957s
	iters: 200, epoch: 6 | loss: 0.3331604
	speed: 0.0119s/iter; left time: 296.9243s
Epoch: 6 cost time: 4.065161466598511
Epoch: 6, Steps: 264 | Train Loss: 0.3473732 Vali Loss: 0.6547593 Test Loss: 0.3717413
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3239289
	speed: 0.0629s/iter; left time: 1553.7114s
	iters: 200, epoch: 7 | loss: 0.3539677
	speed: 0.0130s/iter; left time: 320.7907s
Epoch: 7 cost time: 4.054107666015625
Epoch: 7, Steps: 264 | Train Loss: 0.3474108 Vali Loss: 0.6534676 Test Loss: 0.3720858
Validation loss decreased (0.653588 --> 0.653468).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3057579
	speed: 0.0616s/iter; left time: 1506.7504s
	iters: 200, epoch: 8 | loss: 0.3712569
	speed: 0.0123s/iter; left time: 298.4397s
Epoch: 8 cost time: 3.8477728366851807
Epoch: 8, Steps: 264 | Train Loss: 0.3472191 Vali Loss: 0.6537262 Test Loss: 0.3723629
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3271930
	speed: 0.0647s/iter; left time: 1565.7342s
	iters: 200, epoch: 9 | loss: 0.3320388
	speed: 0.0189s/iter; left time: 455.0701s
Epoch: 9 cost time: 5.0473949909210205
Epoch: 9, Steps: 264 | Train Loss: 0.3472037 Vali Loss: 0.6531239 Test Loss: 0.3713482
Validation loss decreased (0.653468 --> 0.653124).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3510952
	speed: 0.0756s/iter; left time: 1808.0130s
	iters: 200, epoch: 10 | loss: 0.3638152
	speed: 0.0145s/iter; left time: 345.3538s
Epoch: 10 cost time: 5.302684783935547
Epoch: 10, Steps: 264 | Train Loss: 0.3471139 Vali Loss: 0.6522871 Test Loss: 0.3717638
Validation loss decreased (0.653124 --> 0.652287).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3280988
	speed: 0.0876s/iter; left time: 2071.6076s
	iters: 200, epoch: 11 | loss: 0.3556896
	speed: 0.0375s/iter; left time: 883.1237s
Epoch: 11 cost time: 9.969650506973267
Epoch: 11, Steps: 264 | Train Loss: 0.3471343 Vali Loss: 0.6533425 Test Loss: 0.3718271
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3449203
	speed: 0.1097s/iter; left time: 2566.9995s
	iters: 200, epoch: 12 | loss: 0.3330691
	speed: 0.0224s/iter; left time: 522.5900s
Epoch: 12 cost time: 7.816385984420776
Epoch: 12, Steps: 264 | Train Loss: 0.3471266 Vali Loss: 0.6535925 Test Loss: 0.3718199
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3223447
	speed: 0.0957s/iter; left time: 2212.9470s
	iters: 200, epoch: 13 | loss: 0.3205839
	speed: 0.0141s/iter; left time: 325.1339s
Epoch: 13 cost time: 4.974899053573608
Epoch: 13, Steps: 264 | Train Loss: 0.3470340 Vali Loss: 0.6529816 Test Loss: 0.3719922
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3499298
	speed: 0.0896s/iter; left time: 2049.4610s
	iters: 200, epoch: 14 | loss: 0.3985766
	speed: 0.0206s/iter; left time: 469.7376s
Epoch: 14 cost time: 5.3551857471466064
Epoch: 14, Steps: 264 | Train Loss: 0.3471214 Vali Loss: 0.6529053 Test Loss: 0.3716980
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3413799
	speed: 0.0915s/iter; left time: 2068.4159s
	iters: 200, epoch: 15 | loss: 0.3238946
	speed: 0.0218s/iter; left time: 491.0145s
Epoch: 15 cost time: 6.5619261264801025
Epoch: 15, Steps: 264 | Train Loss: 0.3470729 Vali Loss: 0.6532716 Test Loss: 0.3722291
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3454115
	speed: 0.0777s/iter; left time: 1735.1575s
	iters: 200, epoch: 16 | loss: 0.3912553
	speed: 0.0155s/iter; left time: 344.5002s
Epoch: 16 cost time: 4.732632875442505
Epoch: 16, Steps: 264 | Train Loss: 0.3469395 Vali Loss: 0.6529078 Test Loss: 0.3719995
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3503150
	speed: 0.0910s/iter; left time: 2008.4614s
	iters: 200, epoch: 17 | loss: 0.3279180
	speed: 0.0354s/iter; left time: 777.0753s
Epoch: 17 cost time: 8.028127193450928
Epoch: 17, Steps: 264 | Train Loss: 0.3470845 Vali Loss: 0.6530698 Test Loss: 0.3717151
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3351894
	speed: 0.0557s/iter; left time: 1214.5236s
	iters: 200, epoch: 18 | loss: 0.3290234
	speed: 0.0112s/iter; left time: 242.4969s
Epoch: 18 cost time: 3.5141806602478027
Epoch: 18, Steps: 264 | Train Loss: 0.3469962 Vali Loss: 0.6527517 Test Loss: 0.3716428
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3739983
	speed: 0.0572s/iter; left time: 1233.0014s
	iters: 200, epoch: 19 | loss: 0.3672706
	speed: 0.0140s/iter; left time: 299.8603s
Epoch: 19 cost time: 4.161037921905518
Epoch: 19, Steps: 264 | Train Loss: 0.3470053 Vali Loss: 0.6526130 Test Loss: 0.3718370
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3611376
	speed: 0.0598s/iter; left time: 1273.8461s
	iters: 200, epoch: 20 | loss: 0.3692726
	speed: 0.0117s/iter; left time: 246.8316s
Epoch: 20 cost time: 3.640951633453369
Epoch: 20, Steps: 264 | Train Loss: 0.3468518 Vali Loss: 0.6524007 Test Loss: 0.3721725
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3204547
	speed: 0.0557s/iter; left time: 1171.5775s
	iters: 200, epoch: 21 | loss: 0.3874559
	speed: 0.0150s/iter; left time: 313.2050s
Epoch: 21 cost time: 4.084211587905884
Epoch: 21, Steps: 264 | Train Loss: 0.3469910 Vali Loss: 0.6525353 Test Loss: 0.3715344
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3541545
	speed: 0.0602s/iter; left time: 1248.8947s
	iters: 200, epoch: 22 | loss: 0.3361187
	speed: 0.0128s/iter; left time: 265.2172s
Epoch: 22 cost time: 3.9773192405700684
Epoch: 22, Steps: 264 | Train Loss: 0.3469859 Vali Loss: 0.6529823 Test Loss: 0.3717149
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3445798
	speed: 0.0619s/iter; left time: 1269.1006s
	iters: 200, epoch: 23 | loss: 0.3643709
	speed: 0.0129s/iter; left time: 262.4322s
Epoch: 23 cost time: 4.008220672607422
Epoch: 23, Steps: 264 | Train Loss: 0.3469774 Vali Loss: 0.6526039 Test Loss: 0.3716818
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3930349
	speed: 0.0625s/iter; left time: 1264.0855s
	iters: 200, epoch: 24 | loss: 0.3605233
	speed: 0.0145s/iter; left time: 291.7251s
Epoch: 24 cost time: 4.158838987350464
Epoch: 24, Steps: 264 | Train Loss: 0.3470102 Vali Loss: 0.6525591 Test Loss: 0.3720069
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3843353
	speed: 0.0606s/iter; left time: 1209.5809s
	iters: 200, epoch: 25 | loss: 0.3653774
	speed: 0.0128s/iter; left time: 254.9245s
Epoch: 25 cost time: 4.187984943389893
Epoch: 25, Steps: 264 | Train Loss: 0.3469829 Vali Loss: 0.6533355 Test Loss: 0.3718603
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3252520
	speed: 0.0651s/iter; left time: 1282.3910s
	iters: 200, epoch: 26 | loss: 0.3376947
	speed: 0.0126s/iter; left time: 247.8967s
Epoch: 26 cost time: 4.008525371551514
Epoch: 26, Steps: 264 | Train Loss: 0.3468253 Vali Loss: 0.6526209 Test Loss: 0.3717783
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3203772
	speed: 0.0600s/iter; left time: 1165.9805s
	iters: 200, epoch: 27 | loss: 0.3407405
	speed: 0.0124s/iter; left time: 239.1580s
Epoch: 27 cost time: 4.212222099304199
Epoch: 27, Steps: 264 | Train Loss: 0.3469269 Vali Loss: 0.6532767 Test Loss: 0.3718458
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3396040
	speed: 0.0631s/iter; left time: 1209.6152s
	iters: 200, epoch: 28 | loss: 0.3211583
	speed: 0.0128s/iter; left time: 244.3274s
Epoch: 28 cost time: 3.868095874786377
Epoch: 28, Steps: 264 | Train Loss: 0.3468093 Vali Loss: 0.6528529 Test Loss: 0.3718841
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3634765
	speed: 0.0612s/iter; left time: 1157.8168s
	iters: 200, epoch: 29 | loss: 0.3344238
	speed: 0.0125s/iter; left time: 234.2102s
Epoch: 29 cost time: 3.8601298332214355
Epoch: 29, Steps: 264 | Train Loss: 0.3468120 Vali Loss: 0.6525057 Test Loss: 0.3717849
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3062354
	speed: 0.0609s/iter; left time: 1135.3237s
	iters: 200, epoch: 30 | loss: 0.3801485
	speed: 0.0127s/iter; left time: 236.1035s
Epoch: 30 cost time: 4.043288469314575
Epoch: 30, Steps: 264 | Train Loss: 0.3468215 Vali Loss: 0.6525618 Test Loss: 0.3717827
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_360_336_FITS_ETTm1_ftM_sl360_ll48_pl336_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3714595139026642, mae:0.3847004473209381, rse:0.5799680352210999, corr:[0.53949255 0.549255   0.54954576 0.5482133  0.5490297  0.5505822
 0.5506153  0.5493125  0.54849887 0.54926175 0.5509439  0.55190015
 0.55185694 0.55139214 0.55084985 0.54999393 0.54871327 0.5472562
 0.54572445 0.54433876 0.5431136  0.54218197 0.5412802  0.54036254
 0.53931576 0.53808033 0.536952   0.5361083  0.5355133  0.5350787
 0.5350197  0.5353683  0.53582793 0.53614193 0.5362795  0.5364971
 0.53661585 0.536417   0.5359854  0.5355347  0.53527886 0.5351394
 0.53490883 0.5346233  0.53436863 0.53432804 0.5345535  0.5346786
 0.5344775  0.534172   0.53393656 0.5338233  0.5337974  0.53367573
 0.5335046  0.53345907 0.53349644 0.5335135  0.53344846 0.53318304
 0.53298116 0.53284305 0.532765   0.5325839  0.5324739  0.5325968
 0.53292173 0.53329533 0.53374696 0.53406495 0.5342215  0.53429264
 0.534457   0.53470224 0.53486264 0.5348543  0.53474456 0.53461665
 0.5344477  0.53416675 0.5337629  0.53332293 0.5329564  0.53272015
 0.532663   0.5325217  0.5322275  0.5317332  0.5312478  0.5311281
 0.5313677  0.5316299  0.53162396 0.53135717 0.53086734 0.5302273
 0.529506   0.52874726 0.5280053  0.5273251  0.52693826 0.52686733
 0.52696174 0.52700365 0.527206   0.527627   0.5280459  0.5284392
 0.5285213  0.5284666  0.5283733  0.5284155  0.52855295 0.5288373
 0.5290917  0.5292403  0.52921623 0.5290906  0.5289508  0.52906686
 0.5293377  0.52949715 0.52947503 0.52937585 0.52914727 0.5287298
 0.52826846 0.5279606  0.52785516 0.52794653 0.5281319  0.5282621
 0.52832496 0.5281972  0.5279485  0.5275556  0.5271292  0.52668995
 0.5264192  0.5263322  0.52633953 0.5264482  0.52653337 0.5265345
 0.5264031  0.5262057  0.526003   0.52591753 0.52598023 0.52592653
 0.52573586 0.5255996  0.5255373  0.5255866  0.52569336 0.52579725
 0.5257934  0.5257417  0.52574635 0.5259155  0.5261672  0.52623236
 0.5260757  0.52585775 0.5259586  0.5264091  0.5268886  0.5271841
 0.52717555 0.5270727  0.5271853  0.52762073 0.52808553 0.5283445
 0.52829725 0.5281365  0.5279978  0.5279424  0.5278005  0.52758116
 0.52731335 0.5272499  0.5273498  0.5275716  0.5276924  0.52758485
 0.52730817 0.52714896 0.5272584  0.52753896 0.52768695 0.5274703
 0.52683794 0.52611977 0.52553505 0.5250817  0.52473015 0.5244586
 0.52408653 0.5236161  0.52331245 0.5232358  0.52319485 0.5230457
 0.52275026 0.52225685 0.52180576 0.52139515 0.52101153 0.5206127
 0.5201458  0.51981956 0.51959836 0.51943624 0.51912004 0.5187107
 0.5182834  0.5179203  0.51762104 0.51745546 0.51721704 0.51688045
 0.51664317 0.5165841  0.51677567 0.5170832  0.5173409  0.51729316
 0.517018   0.5167116  0.5164725  0.5162682  0.5160629  0.51576406
 0.5155451  0.51552606 0.5155378  0.51566136 0.5157228  0.51562005
 0.5154025  0.51522714 0.51519877 0.51514184 0.51493686 0.5147171
 0.5145788  0.51460403 0.5147567  0.5149354  0.5149158  0.5148054
 0.51461005 0.51457906 0.514645   0.5147094  0.5145554  0.51433194
 0.5140441  0.51390505 0.51405376 0.5144232  0.5147205  0.5149788
 0.51518005 0.51538044 0.5156145  0.51596576 0.51618767 0.51606345
 0.51586145 0.51581734 0.5159856  0.51623785 0.51626664 0.5161366
 0.51591855 0.51589394 0.5159881  0.5161768  0.5161691  0.5159268
 0.5156408  0.5154511  0.51546526 0.51552975 0.5154179  0.514902
 0.5139344  0.51295125 0.51229775 0.5117802  0.511401   0.51099926
 0.5105256  0.5099365  0.50958645 0.5094485  0.50940704 0.5091584
 0.50866646 0.50809777 0.5076663  0.50749063 0.50744736 0.50741196
 0.5073729  0.50725853 0.50717735 0.50715846 0.50714326 0.50702214
 0.5068732  0.50674653 0.50666904 0.506816   0.5068938  0.5067301
 0.5063656  0.50602907 0.50584924 0.5057452  0.50548726 0.50503033
 0.50461835 0.5044839  0.5044889  0.5044242  0.5040682  0.50371766
 0.50364316 0.5038148  0.5039162  0.50434977 0.5054545  0.50507146]
