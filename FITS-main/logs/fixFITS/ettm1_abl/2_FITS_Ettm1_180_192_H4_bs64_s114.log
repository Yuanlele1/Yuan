Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=18, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5228032
	speed: 0.1180s/iter; left time: 3140.1295s
	iters: 200, epoch: 1 | loss: 0.4828455
	speed: 0.1061s/iter; left time: 2812.9725s
Epoch: 1 cost time: 29.887234926223755
Epoch: 1, Steps: 267 | Train Loss: 0.5315573 Vali Loss: 0.9174351 Test Loss: 0.7010075
Validation loss decreased (inf --> 0.917435).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3473534
	speed: 0.5015s/iter; left time: 13206.6280s
	iters: 200, epoch: 2 | loss: 0.3207481
	speed: 0.1182s/iter; left time: 3100.1476s
Epoch: 2 cost time: 32.55993628501892
Epoch: 2, Steps: 267 | Train Loss: 0.3460848 Vali Loss: 0.7479497 Test Loss: 0.5408644
Validation loss decreased (0.917435 --> 0.747950).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2742045
	speed: 0.5171s/iter; left time: 13478.4489s
	iters: 200, epoch: 3 | loss: 0.2689484
	speed: 0.1105s/iter; left time: 2868.1861s
Epoch: 3 cost time: 30.18485164642334
Epoch: 3, Steps: 267 | Train Loss: 0.2802543 Vali Loss: 0.6704897 Test Loss: 0.4697537
Validation loss decreased (0.747950 --> 0.670490).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2617359
	speed: 0.5049s/iter; left time: 13026.0433s
	iters: 200, epoch: 4 | loss: 0.2332298
	speed: 0.1235s/iter; left time: 3172.9566s
Epoch: 4 cost time: 34.02712082862854
Epoch: 4, Steps: 267 | Train Loss: 0.2471945 Vali Loss: 0.6248125 Test Loss: 0.4301143
Validation loss decreased (0.670490 --> 0.624812).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2283989
	speed: 0.5338s/iter; left time: 13629.5014s
	iters: 200, epoch: 5 | loss: 0.2199734
	speed: 0.1152s/iter; left time: 2929.2387s
Epoch: 5 cost time: 31.877686500549316
Epoch: 5, Steps: 267 | Train Loss: 0.2267061 Vali Loss: 0.5959958 Test Loss: 0.4044763
Validation loss decreased (0.624812 --> 0.595996).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2048212
	speed: 0.4592s/iter; left time: 11601.5202s
	iters: 200, epoch: 6 | loss: 0.2126466
	speed: 0.1091s/iter; left time: 2746.1956s
Epoch: 6 cost time: 29.72536849975586
Epoch: 6, Steps: 267 | Train Loss: 0.2129280 Vali Loss: 0.5765869 Test Loss: 0.3880532
Validation loss decreased (0.595996 --> 0.576587).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1932442
	speed: 0.5337s/iter; left time: 13342.2716s
	iters: 200, epoch: 7 | loss: 0.2003486
	speed: 0.1260s/iter; left time: 3138.1003s
Epoch: 7 cost time: 32.836179971694946
Epoch: 7, Steps: 267 | Train Loss: 0.2034025 Vali Loss: 0.5623472 Test Loss: 0.3759643
Validation loss decreased (0.576587 --> 0.562347).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1936550
	speed: 0.4978s/iter; left time: 12310.7636s
	iters: 200, epoch: 8 | loss: 0.1965765
	speed: 0.1220s/iter; left time: 3004.7319s
Epoch: 8 cost time: 31.00251841545105
Epoch: 8, Steps: 267 | Train Loss: 0.1968005 Vali Loss: 0.5531026 Test Loss: 0.3680933
Validation loss decreased (0.562347 --> 0.553103).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1809487
	speed: 0.5134s/iter; left time: 12559.8958s
	iters: 200, epoch: 9 | loss: 0.2157397
	speed: 0.1201s/iter; left time: 2926.6592s
Epoch: 9 cost time: 32.73582601547241
Epoch: 9, Steps: 267 | Train Loss: 0.1922681 Vali Loss: 0.5462538 Test Loss: 0.3626650
Validation loss decreased (0.553103 --> 0.546254).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2046768
	speed: 0.5107s/iter; left time: 12358.7539s
	iters: 200, epoch: 10 | loss: 0.1768128
	speed: 0.1137s/iter; left time: 2740.2938s
Epoch: 10 cost time: 31.95435881614685
Epoch: 10, Steps: 267 | Train Loss: 0.1891820 Vali Loss: 0.5413449 Test Loss: 0.3589005
Validation loss decreased (0.546254 --> 0.541345).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1784524
	speed: 0.5188s/iter; left time: 12414.2303s
	iters: 200, epoch: 11 | loss: 0.2035201
	speed: 0.1103s/iter; left time: 2628.9872s
Epoch: 11 cost time: 30.698286294937134
Epoch: 11, Steps: 267 | Train Loss: 0.1871314 Vali Loss: 0.5378405 Test Loss: 0.3561593
Validation loss decreased (0.541345 --> 0.537840).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1758618
	speed: 0.5012s/iter; left time: 11859.6821s
	iters: 200, epoch: 12 | loss: 0.1832985
	speed: 0.1199s/iter; left time: 2826.4161s
Epoch: 12 cost time: 33.70985555648804
Epoch: 12, Steps: 267 | Train Loss: 0.1858140 Vali Loss: 0.5353498 Test Loss: 0.3547206
Validation loss decreased (0.537840 --> 0.535350).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1945118
	speed: 0.5198s/iter; left time: 12161.4897s
	iters: 200, epoch: 13 | loss: 0.2000432
	speed: 0.1063s/iter; left time: 2476.0294s
Epoch: 13 cost time: 29.795917749404907
Epoch: 13, Steps: 267 | Train Loss: 0.1849762 Vali Loss: 0.5338168 Test Loss: 0.3537978
Validation loss decreased (0.535350 --> 0.533817).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1877594
	speed: 0.4941s/iter; left time: 11427.4699s
	iters: 200, epoch: 14 | loss: 0.1742523
	speed: 0.1226s/iter; left time: 2822.6516s
Epoch: 14 cost time: 31.993595600128174
Epoch: 14, Steps: 267 | Train Loss: 0.1844668 Vali Loss: 0.5324782 Test Loss: 0.3531909
Validation loss decreased (0.533817 --> 0.532478).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1841417
	speed: 0.5299s/iter; left time: 12114.5780s
	iters: 200, epoch: 15 | loss: 0.1766786
	speed: 0.1108s/iter; left time: 2521.9007s
Epoch: 15 cost time: 31.271211624145508
Epoch: 15, Steps: 267 | Train Loss: 0.1842177 Vali Loss: 0.5319992 Test Loss: 0.3527300
Validation loss decreased (0.532478 --> 0.531999).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1914661
	speed: 0.5136s/iter; left time: 11606.1618s
	iters: 200, epoch: 16 | loss: 0.1737469
	speed: 0.1122s/iter; left time: 2524.0065s
Epoch: 16 cost time: 32.02615666389465
Epoch: 16, Steps: 267 | Train Loss: 0.1840363 Vali Loss: 0.5309570 Test Loss: 0.3523680
Validation loss decreased (0.531999 --> 0.530957).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1897670
	speed: 0.5530s/iter; left time: 12348.8747s
	iters: 200, epoch: 17 | loss: 0.1997898
	speed: 0.1220s/iter; left time: 2713.0147s
Epoch: 17 cost time: 33.67274880409241
Epoch: 17, Steps: 267 | Train Loss: 0.1839384 Vali Loss: 0.5313936 Test Loss: 0.3521394
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1791441
	speed: 0.5455s/iter; left time: 12035.3589s
	iters: 200, epoch: 18 | loss: 0.1799523
	speed: 0.1152s/iter; left time: 2531.0849s
Epoch: 18 cost time: 31.453863382339478
Epoch: 18, Steps: 267 | Train Loss: 0.1838874 Vali Loss: 0.5310220 Test Loss: 0.3520219
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1959786
	speed: 0.5290s/iter; left time: 11530.5576s
	iters: 200, epoch: 19 | loss: 0.1841897
	speed: 0.1223s/iter; left time: 2654.3207s
Epoch: 19 cost time: 32.43365216255188
Epoch: 19, Steps: 267 | Train Loss: 0.1838570 Vali Loss: 0.5306721 Test Loss: 0.3521723
Validation loss decreased (0.530957 --> 0.530672).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1817034
	speed: 0.5408s/iter; left time: 11641.3444s
	iters: 200, epoch: 20 | loss: 0.2010510
	speed: 0.1276s/iter; left time: 2733.9152s
Epoch: 20 cost time: 33.679410219192505
Epoch: 20, Steps: 267 | Train Loss: 0.1838386 Vali Loss: 0.5310804 Test Loss: 0.3519631
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2100193
	speed: 0.5319s/iter; left time: 11308.2292s
	iters: 200, epoch: 21 | loss: 0.1748822
	speed: 0.1168s/iter; left time: 2472.4089s
Epoch: 21 cost time: 33.43303394317627
Epoch: 21, Steps: 267 | Train Loss: 0.1838282 Vali Loss: 0.5299934 Test Loss: 0.3519944
Validation loss decreased (0.530672 --> 0.529993).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1929247
	speed: 0.5602s/iter; left time: 11761.4923s
	iters: 200, epoch: 22 | loss: 0.1700557
	speed: 0.1297s/iter; left time: 2710.4582s
Epoch: 22 cost time: 33.408950328826904
Epoch: 22, Steps: 267 | Train Loss: 0.1838553 Vali Loss: 0.5306425 Test Loss: 0.3522305
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1909753
	speed: 0.5193s/iter; left time: 10763.3409s
	iters: 200, epoch: 23 | loss: 0.1778985
	speed: 0.1264s/iter; left time: 2606.7091s
Epoch: 23 cost time: 34.231276512145996
Epoch: 23, Steps: 267 | Train Loss: 0.1838480 Vali Loss: 0.5292082 Test Loss: 0.3521791
Validation loss decreased (0.529993 --> 0.529208).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1940998
	speed: 0.5755s/iter; left time: 11773.8004s
	iters: 200, epoch: 24 | loss: 0.1907808
	speed: 0.1189s/iter; left time: 2421.3073s
Epoch: 24 cost time: 32.619855880737305
Epoch: 24, Steps: 267 | Train Loss: 0.1838417 Vali Loss: 0.5298632 Test Loss: 0.3519941
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1976520
	speed: 0.5361s/iter; left time: 10825.6916s
	iters: 200, epoch: 25 | loss: 0.1614202
	speed: 0.1202s/iter; left time: 2414.4529s
Epoch: 25 cost time: 32.586302280426025
Epoch: 25, Steps: 267 | Train Loss: 0.1838478 Vali Loss: 0.5303044 Test Loss: 0.3519944
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1879773
	speed: 0.5455s/iter; left time: 10869.6249s
	iters: 200, epoch: 26 | loss: 0.1686684
	speed: 0.1196s/iter; left time: 2371.7677s
Epoch: 26 cost time: 31.9843430519104
Epoch: 26, Steps: 267 | Train Loss: 0.1838355 Vali Loss: 0.5302502 Test Loss: 0.3520681
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1860849
	speed: 0.5454s/iter; left time: 10721.5586s
	iters: 200, epoch: 27 | loss: 0.2073784
	speed: 0.1175s/iter; left time: 2297.7796s
Epoch: 27 cost time: 32.115493297576904
Epoch: 27, Steps: 267 | Train Loss: 0.1838547 Vali Loss: 0.5299906 Test Loss: 0.3520182
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1830267
	speed: 0.5270s/iter; left time: 10219.4360s
	iters: 200, epoch: 28 | loss: 0.1771825
	speed: 0.1166s/iter; left time: 2249.1632s
Epoch: 28 cost time: 32.85693383216858
Epoch: 28, Steps: 267 | Train Loss: 0.1838313 Vali Loss: 0.5305253 Test Loss: 0.3521390
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1773032
	speed: 0.5580s/iter; left time: 10671.3868s
	iters: 200, epoch: 29 | loss: 0.1888517
	speed: 0.1262s/iter; left time: 2400.9357s
Epoch: 29 cost time: 34.02389144897461
Epoch: 29, Steps: 267 | Train Loss: 0.1838215 Vali Loss: 0.5299750 Test Loss: 0.3520222
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1799120
	speed: 0.5188s/iter; left time: 9783.5200s
	iters: 200, epoch: 30 | loss: 0.1896646
	speed: 0.1308s/iter; left time: 2454.0027s
Epoch: 30 cost time: 33.2482385635376
Epoch: 30, Steps: 267 | Train Loss: 0.1838443 Vali Loss: 0.5304529 Test Loss: 0.3521219
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1836624
	speed: 0.5640s/iter; left time: 10486.1426s
	iters: 200, epoch: 31 | loss: 0.1761920
	speed: 0.1193s/iter; left time: 2206.8044s
Epoch: 31 cost time: 33.38839793205261
Epoch: 31, Steps: 267 | Train Loss: 0.1838352 Vali Loss: 0.5304529 Test Loss: 0.3520528
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.1991192
	speed: 0.5170s/iter; left time: 9472.7057s
	iters: 200, epoch: 32 | loss: 0.1825596
	speed: 0.1162s/iter; left time: 2117.5264s
Epoch: 32 cost time: 32.454181432724
Epoch: 32, Steps: 267 | Train Loss: 0.1838307 Vali Loss: 0.5300742 Test Loss: 0.3520276
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1825433
	speed: 0.5589s/iter; left time: 10091.2186s
	iters: 200, epoch: 33 | loss: 0.1750002
	speed: 0.1196s/iter; left time: 2146.9613s
Epoch: 33 cost time: 32.49469304084778
Epoch: 33, Steps: 267 | Train Loss: 0.1838518 Vali Loss: 0.5304152 Test Loss: 0.3520012
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.1621485
	speed: 0.5180s/iter; left time: 9215.2045s
	iters: 200, epoch: 34 | loss: 0.1672561
	speed: 0.1191s/iter; left time: 2107.6278s
Epoch: 34 cost time: 32.04638981819153
Epoch: 34, Steps: 267 | Train Loss: 0.1838286 Vali Loss: 0.5303684 Test Loss: 0.3520554
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.1832150
	speed: 0.5245s/iter; left time: 9191.1716s
	iters: 200, epoch: 35 | loss: 0.1789127
	speed: 0.1236s/iter; left time: 2153.9546s
Epoch: 35 cost time: 33.65697169303894
Epoch: 35, Steps: 267 | Train Loss: 0.1837899 Vali Loss: 0.5305434 Test Loss: 0.3520805
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1714421
	speed: 0.5581s/iter; left time: 9631.0304s
	iters: 200, epoch: 36 | loss: 0.1836470
	speed: 0.1127s/iter; left time: 1932.8935s
Epoch: 36 cost time: 30.89359474182129
Epoch: 36, Steps: 267 | Train Loss: 0.1838322 Vali Loss: 0.5302400 Test Loss: 0.3520870
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1986715
	speed: 0.5241s/iter; left time: 8904.5919s
	iters: 200, epoch: 37 | loss: 0.1894893
	speed: 0.1219s/iter; left time: 2058.1056s
Epoch: 37 cost time: 32.69361329078674
Epoch: 37, Steps: 267 | Train Loss: 0.1838223 Vali Loss: 0.5298447 Test Loss: 0.3520745
EarlyStopping counter: 14 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.1716614
	speed: 0.5314s/iter; left time: 8885.5124s
	iters: 200, epoch: 38 | loss: 0.1913605
	speed: 0.0947s/iter; left time: 1574.4909s
Epoch: 38 cost time: 28.14267110824585
Epoch: 38, Steps: 267 | Train Loss: 0.1838230 Vali Loss: 0.5300276 Test Loss: 0.3520724
EarlyStopping counter: 15 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.1805151
	speed: 0.4449s/iter; left time: 7320.2565s
	iters: 200, epoch: 39 | loss: 0.1832262
	speed: 0.1001s/iter; left time: 1637.1986s
Epoch: 39 cost time: 28.619321823120117
Epoch: 39, Steps: 267 | Train Loss: 0.1838155 Vali Loss: 0.5302705 Test Loss: 0.3520676
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.1907088
	speed: 0.4206s/iter; left time: 6809.0837s
	iters: 200, epoch: 40 | loss: 0.1723289
	speed: 0.0944s/iter; left time: 1519.1356s
Epoch: 40 cost time: 24.4278461933136
Epoch: 40, Steps: 267 | Train Loss: 0.1838332 Vali Loss: 0.5307844 Test Loss: 0.3521184
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.1808053
	speed: 0.4853s/iter; left time: 7726.5735s
	iters: 200, epoch: 41 | loss: 0.1865034
	speed: 0.1882s/iter; left time: 2977.2777s
Epoch: 41 cost time: 47.82117676734924
Epoch: 41, Steps: 267 | Train Loss: 0.1838222 Vali Loss: 0.5302441 Test Loss: 0.3521084
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.1925883
	speed: 0.8060s/iter; left time: 12617.6602s
	iters: 200, epoch: 42 | loss: 0.1859180
	speed: 0.1796s/iter; left time: 2793.0112s
Epoch: 42 cost time: 47.71523118019104
Epoch: 42, Steps: 267 | Train Loss: 0.1838190 Vali Loss: 0.5302195 Test Loss: 0.3521405
EarlyStopping counter: 19 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.1861989
	speed: 0.7954s/iter; left time: 12238.5660s
	iters: 200, epoch: 43 | loss: 0.1771662
	speed: 0.1776s/iter; left time: 2715.1290s
Epoch: 43 cost time: 48.086857080459595
Epoch: 43, Steps: 267 | Train Loss: 0.1838263 Vali Loss: 0.5294931 Test Loss: 0.3521466
EarlyStopping counter: 20 out of 20
Early stopping
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=18, out_features=37, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  596736.0
params:  703.0
Trainable parameters:  703
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3218641
	speed: 0.1703s/iter; left time: 4530.8494s
	iters: 200, epoch: 1 | loss: 0.3455720
	speed: 0.1682s/iter; left time: 4458.0373s
Epoch: 1 cost time: 45.7247953414917
Epoch: 1, Steps: 267 | Train Loss: 0.3330968 Vali Loss: 0.5275590 Test Loss: 0.3487453
Validation loss decreased (inf --> 0.527559).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3333640
	speed: 0.8175s/iter; left time: 21528.0638s
	iters: 200, epoch: 2 | loss: 0.3370221
	speed: 0.1805s/iter; left time: 4736.3835s
Epoch: 2 cost time: 49.173523902893066
Epoch: 2, Steps: 267 | Train Loss: 0.3322706 Vali Loss: 0.5257815 Test Loss: 0.3488369
Validation loss decreased (0.527559 --> 0.525782).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3494428
	speed: 0.7866s/iter; left time: 20503.9917s
	iters: 200, epoch: 3 | loss: 0.3445520
	speed: 0.1784s/iter; left time: 4632.5458s
Epoch: 3 cost time: 48.277464866638184
Epoch: 3, Steps: 267 | Train Loss: 0.3320209 Vali Loss: 0.5246896 Test Loss: 0.3492077
Validation loss decreased (0.525782 --> 0.524690).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3125921
	speed: 0.8484s/iter; left time: 21888.8174s
	iters: 200, epoch: 4 | loss: 0.3095197
	speed: 0.1833s/iter; left time: 4709.9603s
Epoch: 4 cost time: 51.393341064453125
Epoch: 4, Steps: 267 | Train Loss: 0.3318248 Vali Loss: 0.5247042 Test Loss: 0.3483720
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3095555
	speed: 0.8275s/iter; left time: 21127.4826s
	iters: 200, epoch: 5 | loss: 0.3196088
	speed: 0.1881s/iter; left time: 4782.8955s
Epoch: 5 cost time: 50.3723464012146
Epoch: 5, Steps: 267 | Train Loss: 0.3317363 Vali Loss: 0.5242726 Test Loss: 0.3486085
Validation loss decreased (0.524690 --> 0.524273).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3378211
	speed: 0.8270s/iter; left time: 20894.5037s
	iters: 200, epoch: 6 | loss: 0.3577335
	speed: 0.1838s/iter; left time: 4625.4073s
Epoch: 6 cost time: 48.62563896179199
Epoch: 6, Steps: 267 | Train Loss: 0.3316005 Vali Loss: 0.5245733 Test Loss: 0.3488981
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3634200
	speed: 0.8107s/iter; left time: 20266.3089s
	iters: 200, epoch: 7 | loss: 0.3521269
	speed: 0.1748s/iter; left time: 4352.1600s
Epoch: 7 cost time: 49.4936740398407
Epoch: 7, Steps: 267 | Train Loss: 0.3315876 Vali Loss: 0.5245331 Test Loss: 0.3488841
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3009046
	speed: 0.8036s/iter; left time: 19875.5389s
	iters: 200, epoch: 8 | loss: 0.3477709
	speed: 0.1853s/iter; left time: 4565.0136s
Epoch: 8 cost time: 48.91496014595032
Epoch: 8, Steps: 267 | Train Loss: 0.3315294 Vali Loss: 0.5238388 Test Loss: 0.3484843
Validation loss decreased (0.524273 --> 0.523839).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3291690
	speed: 0.7989s/iter; left time: 19544.9834s
	iters: 200, epoch: 9 | loss: 0.3511530
	speed: 0.1778s/iter; left time: 4332.1336s
Epoch: 9 cost time: 47.094894886016846
Epoch: 9, Steps: 267 | Train Loss: 0.3314816 Vali Loss: 0.5242665 Test Loss: 0.3489307
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3477305
	speed: 0.7985s/iter; left time: 19322.2301s
	iters: 200, epoch: 10 | loss: 0.3253900
	speed: 0.1719s/iter; left time: 4141.9354s
Epoch: 10 cost time: 47.14776611328125
Epoch: 10, Steps: 267 | Train Loss: 0.3314387 Vali Loss: 0.5240383 Test Loss: 0.3484122
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3438345
	speed: 0.7796s/iter; left time: 18656.8984s
	iters: 200, epoch: 11 | loss: 0.3487375
	speed: 0.1722s/iter; left time: 4102.5699s
Epoch: 11 cost time: 46.1444034576416
Epoch: 11, Steps: 267 | Train Loss: 0.3314074 Vali Loss: 0.5243807 Test Loss: 0.3485888
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3116636
	speed: 0.8160s/iter; left time: 19309.7611s
	iters: 200, epoch: 12 | loss: 0.3213598
	speed: 0.1784s/iter; left time: 4202.7716s
Epoch: 12 cost time: 48.60065674781799
Epoch: 12, Steps: 267 | Train Loss: 0.3313963 Vali Loss: 0.5245031 Test Loss: 0.3484695
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3574634
	speed: 0.7818s/iter; left time: 18290.9459s
	iters: 200, epoch: 13 | loss: 0.3283134
	speed: 0.1780s/iter; left time: 4147.9692s
Epoch: 13 cost time: 48.02444338798523
Epoch: 13, Steps: 267 | Train Loss: 0.3313526 Vali Loss: 0.5233033 Test Loss: 0.3484991
Validation loss decreased (0.523839 --> 0.523303).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3121662
	speed: 0.8171s/iter; left time: 18899.7723s
	iters: 200, epoch: 14 | loss: 0.3107508
	speed: 0.1473s/iter; left time: 3392.3794s
Epoch: 14 cost time: 44.963151693344116
Epoch: 14, Steps: 267 | Train Loss: 0.3313422 Vali Loss: 0.5237415 Test Loss: 0.3490652
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2995999
	speed: 0.7786s/iter; left time: 17800.4345s
	iters: 200, epoch: 15 | loss: 0.3742491
	speed: 0.1801s/iter; left time: 4100.5265s
Epoch: 15 cost time: 49.29473280906677
Epoch: 15, Steps: 267 | Train Loss: 0.3313613 Vali Loss: 0.5242579 Test Loss: 0.3486786
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3735418
	speed: 0.8106s/iter; left time: 18315.6810s
	iters: 200, epoch: 16 | loss: 0.3761062
	speed: 0.1739s/iter; left time: 3911.6309s
Epoch: 16 cost time: 48.197333574295044
Epoch: 16, Steps: 267 | Train Loss: 0.3313190 Vali Loss: 0.5248461 Test Loss: 0.3488761
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3013381
	speed: 0.8047s/iter; left time: 17968.6215s
	iters: 200, epoch: 17 | loss: 0.3214529
	speed: 0.1857s/iter; left time: 4127.0243s
Epoch: 17 cost time: 49.466291666030884
Epoch: 17, Steps: 267 | Train Loss: 0.3313090 Vali Loss: 0.5248753 Test Loss: 0.3488578
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3587016
	speed: 0.8075s/iter; left time: 17815.1441s
	iters: 200, epoch: 18 | loss: 0.3372704
	speed: 0.1722s/iter; left time: 3782.3845s
Epoch: 18 cost time: 47.50811409950256
Epoch: 18, Steps: 267 | Train Loss: 0.3312970 Vali Loss: 0.5239854 Test Loss: 0.3487849
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3343722
	speed: 0.7906s/iter; left time: 17231.2831s
	iters: 200, epoch: 19 | loss: 0.3467364
	speed: 0.1867s/iter; left time: 4049.6009s
Epoch: 19 cost time: 50.888211488723755
Epoch: 19, Steps: 267 | Train Loss: 0.3313064 Vali Loss: 0.5237343 Test Loss: 0.3484710
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2960978
	speed: 0.8230s/iter; left time: 17717.7385s
	iters: 200, epoch: 20 | loss: 0.3166526
	speed: 0.1794s/iter; left time: 3844.9610s
Epoch: 20 cost time: 48.73361420631409
Epoch: 20, Steps: 267 | Train Loss: 0.3312604 Vali Loss: 0.5242811 Test Loss: 0.3487368
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3290411
	speed: 0.8155s/iter; left time: 17338.5369s
	iters: 200, epoch: 21 | loss: 0.3270326
	speed: 0.1862s/iter; left time: 3939.9654s
Epoch: 21 cost time: 51.1491904258728
Epoch: 21, Steps: 267 | Train Loss: 0.3311878 Vali Loss: 0.5246536 Test Loss: 0.3487111
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3697675
	speed: 0.8219s/iter; left time: 17254.7021s
	iters: 200, epoch: 22 | loss: 0.3210007
	speed: 0.1783s/iter; left time: 3724.9405s
Epoch: 22 cost time: 47.045804262161255
Epoch: 22, Steps: 267 | Train Loss: 0.3312403 Vali Loss: 0.5237772 Test Loss: 0.3484813
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3264928
	speed: 0.7872s/iter; left time: 16316.6408s
	iters: 200, epoch: 23 | loss: 0.3274958
	speed: 0.1901s/iter; left time: 3921.3256s
Epoch: 23 cost time: 52.995354413986206
Epoch: 23, Steps: 267 | Train Loss: 0.3312482 Vali Loss: 0.5244405 Test Loss: 0.3487223
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3232117
	speed: 0.8498s/iter; left time: 17386.8067s
	iters: 200, epoch: 24 | loss: 0.3125660
	speed: 0.1867s/iter; left time: 3801.4087s
Epoch: 24 cost time: 50.496076345443726
Epoch: 24, Steps: 267 | Train Loss: 0.3312233 Vali Loss: 0.5242597 Test Loss: 0.3486039
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2969753
	speed: 0.8946s/iter; left time: 18064.9562s
	iters: 200, epoch: 25 | loss: 0.3417008
	speed: 0.1870s/iter; left time: 3758.0867s
Epoch: 25 cost time: 51.227701902389526
Epoch: 25, Steps: 267 | Train Loss: 0.3311438 Vali Loss: 0.5243232 Test Loss: 0.3486533
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3183417
	speed: 0.8533s/iter; left time: 17002.9115s
	iters: 200, epoch: 26 | loss: 0.3178132
	speed: 0.1784s/iter; left time: 3537.5422s
Epoch: 26 cost time: 49.84970188140869
Epoch: 26, Steps: 267 | Train Loss: 0.3311938 Vali Loss: 0.5244938 Test Loss: 0.3486978
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3403040
	speed: 0.8599s/iter; left time: 16905.4569s
	iters: 200, epoch: 27 | loss: 0.3147950
	speed: 0.1929s/iter; left time: 3773.5503s
Epoch: 27 cost time: 52.20158338546753
Epoch: 27, Steps: 267 | Train Loss: 0.3312285 Vali Loss: 0.5242292 Test Loss: 0.3486865
EarlyStopping counter: 14 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3227241
	speed: 0.8137s/iter; left time: 15780.0557s
	iters: 200, epoch: 28 | loss: 0.3349469
	speed: 0.2057s/iter; left time: 3968.7990s
Epoch: 28 cost time: 52.961522340774536
Epoch: 28, Steps: 267 | Train Loss: 0.3311183 Vali Loss: 0.5241546 Test Loss: 0.3486952
EarlyStopping counter: 15 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3286020
	speed: 0.8697s/iter; left time: 16633.6446s
	iters: 200, epoch: 29 | loss: 0.3141234
	speed: 0.1891s/iter; left time: 3598.3221s
Epoch: 29 cost time: 50.847450256347656
Epoch: 29, Steps: 267 | Train Loss: 0.3312100 Vali Loss: 0.5236328 Test Loss: 0.3487588
EarlyStopping counter: 16 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2927574
	speed: 0.8387s/iter; left time: 15816.9423s
	iters: 200, epoch: 30 | loss: 0.3277560
	speed: 0.1903s/iter; left time: 3570.1403s
Epoch: 30 cost time: 51.34274458885193
Epoch: 30, Steps: 267 | Train Loss: 0.3311982 Vali Loss: 0.5238949 Test Loss: 0.3486010
EarlyStopping counter: 17 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3305421
	speed: 0.8630s/iter; left time: 16044.4843s
	iters: 200, epoch: 31 | loss: 0.3312174
	speed: 0.1869s/iter; left time: 3456.1435s
Epoch: 31 cost time: 50.728007316589355
Epoch: 31, Steps: 267 | Train Loss: 0.3311980 Vali Loss: 0.5242236 Test Loss: 0.3487378
EarlyStopping counter: 18 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3409972
	speed: 0.8551s/iter; left time: 15669.1811s
	iters: 200, epoch: 32 | loss: 0.3575545
	speed: 0.1901s/iter; left time: 3464.9646s
Epoch: 32 cost time: 52.1689453125
Epoch: 32, Steps: 267 | Train Loss: 0.3312181 Vali Loss: 0.5238473 Test Loss: 0.3487159
EarlyStopping counter: 19 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3094402
	speed: 0.8722s/iter; left time: 15749.5046s
	iters: 200, epoch: 33 | loss: 0.2887596
	speed: 0.1819s/iter; left time: 3266.8473s
Epoch: 33 cost time: 50.850996255874634
Epoch: 33, Steps: 267 | Train Loss: 0.3311896 Vali Loss: 0.5238886 Test Loss: 0.3487102
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.34866610169410706, mae:0.36948373913764954, rse:0.5620906949043274, corr:[0.54700106 0.5513288  0.55289215 0.5521389  0.5502397  0.54855657
 0.54776925 0.5481085  0.54897463 0.54986995 0.5504369  0.5501437
 0.5491172  0.54733616 0.5451472  0.5429877  0.5409605  0.53907895
 0.53728837 0.535502   0.533646   0.531572   0.5292541  0.526813
 0.52441514 0.522291   0.5207023  0.5196776  0.51918983 0.5191123
 0.5193911  0.5198127  0.52012134 0.5202479  0.520159   0.51993
 0.51956326 0.51910937 0.51870394 0.5183256  0.5180469  0.51782763
 0.51768243 0.5176743  0.51777864 0.5179627  0.5182056  0.5184458
 0.5186222  0.51867276 0.5186465  0.51862484 0.51866657 0.51875687
 0.5188709  0.5189462  0.5190255  0.5190185  0.51894426 0.51877004
 0.51855683 0.5183409  0.5181169  0.51789635 0.5177199  0.5176912
 0.5178109  0.5180331  0.5183819  0.5187815  0.51916635 0.5194469
 0.5195636  0.51950496 0.51936907 0.5191724  0.51900727 0.5189044
 0.5188551  0.51881987 0.51877815 0.51868314 0.5185318  0.5182754
 0.51794523 0.5176182  0.5173444  0.5170696  0.5167692  0.5164951
 0.5162477  0.51598686 0.51567096 0.5153026  0.5148519  0.5142321
 0.5134613  0.5126444  0.5118441  0.5111048  0.51058817 0.51040363
 0.5105553  0.511021   0.51177275 0.5127569  0.51384014 0.5148782
 0.51574063 0.51631206 0.5165995  0.51681817 0.5169866  0.5171363
 0.51723146 0.5172701  0.51716125 0.516858   0.51639795 0.51583207
 0.5152674  0.5146883  0.5141213  0.5136483  0.51327604 0.5129864
 0.51280034 0.5127062  0.51265544 0.5126002  0.5124873  0.51227266
 0.5119683  0.5117038  0.51150185 0.5113296  0.5112511  0.5112101
 0.5111508  0.51110506 0.51104516 0.51099026 0.510968   0.511018
 0.5111261  0.51128113 0.5113891  0.5114588  0.5115546  0.51154906
 0.5114668  0.511373   0.5112857  0.5112469  0.51119787 0.51118004
 0.5111821  0.5112078  0.51119196 0.5111578  0.51110697 0.5110779
 0.51110584 0.5112206  0.51139474 0.51165676 0.5119377  0.51220006
 0.51242006 0.5125423  0.51255393 0.51257324 0.5125928  0.51261324
 0.51265436 0.51266533 0.51264375 0.5125769  0.51240945 0.51221454
 0.51204884 0.5119782  0.5120092  0.5121242  0.5122607  0.5123345
 0.5123178  0.51229966 0.51254964 0.51350564 0.5152965  0.5173167 ]
