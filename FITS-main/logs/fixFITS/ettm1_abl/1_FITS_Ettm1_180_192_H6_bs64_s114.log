Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=22, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_180_192', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=192, root_path='./dataset/', seed=114, seq_len=180, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34189
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=22, out_features=45, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  887040.0
params:  1035.0
Trainable parameters:  1035
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5150130
	speed: 0.0356s/iter; left time: 946.7453s
	iters: 200, epoch: 1 | loss: 0.4000225
	speed: 0.0127s/iter; left time: 337.1042s
Epoch: 1 cost time: 6.126612901687622
Epoch: 1, Steps: 267 | Train Loss: 0.5146298 Vali Loss: 0.6800740 Test Loss: 0.4768060
Validation loss decreased (inf --> 0.680074).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3882243
	speed: 0.0786s/iter; left time: 2069.4666s
	iters: 200, epoch: 2 | loss: 0.3922406
	speed: 0.0132s/iter; left time: 347.4436s
Epoch: 2 cost time: 3.9722812175750732
Epoch: 2, Steps: 267 | Train Loss: 0.3706355 Vali Loss: 0.5781353 Test Loss: 0.3871420
Validation loss decreased (0.680074 --> 0.578135).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3299541
	speed: 0.0635s/iter; left time: 1654.2828s
	iters: 200, epoch: 3 | loss: 0.3204758
	speed: 0.0131s/iter; left time: 340.3389s
Epoch: 3 cost time: 4.181233167648315
Epoch: 3, Steps: 267 | Train Loss: 0.3451490 Vali Loss: 0.5481225 Test Loss: 0.3629119
Validation loss decreased (0.578135 --> 0.548122).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3511147
	speed: 0.0679s/iter; left time: 1751.4446s
	iters: 200, epoch: 4 | loss: 0.3532472
	speed: 0.0129s/iter; left time: 331.8356s
Epoch: 4 cost time: 4.0837602615356445
Epoch: 4, Steps: 267 | Train Loss: 0.3368930 Vali Loss: 0.5353832 Test Loss: 0.3545720
Validation loss decreased (0.548122 --> 0.535383).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3279794
	speed: 0.0688s/iter; left time: 1756.8933s
	iters: 200, epoch: 5 | loss: 0.3311988
	speed: 0.0125s/iter; left time: 317.2761s
Epoch: 5 cost time: 4.242725133895874
Epoch: 5, Steps: 267 | Train Loss: 0.3337984 Vali Loss: 0.5309736 Test Loss: 0.3512857
Validation loss decreased (0.535383 --> 0.530974).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3314813
	speed: 0.0677s/iter; left time: 1711.1191s
	iters: 200, epoch: 6 | loss: 0.3475256
	speed: 0.0128s/iter; left time: 323.0631s
Epoch: 6 cost time: 4.239769697189331
Epoch: 6, Steps: 267 | Train Loss: 0.3325631 Vali Loss: 0.5268010 Test Loss: 0.3497512
Validation loss decreased (0.530974 --> 0.526801).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3328623
	speed: 0.0717s/iter; left time: 1792.3309s
	iters: 200, epoch: 7 | loss: 0.2906598
	speed: 0.0124s/iter; left time: 308.4100s
Epoch: 7 cost time: 4.1668455600738525
Epoch: 7, Steps: 267 | Train Loss: 0.3320023 Vali Loss: 0.5258608 Test Loss: 0.3493258
Validation loss decreased (0.526801 --> 0.525861).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3340752
	speed: 0.0779s/iter; left time: 1926.3635s
	iters: 200, epoch: 8 | loss: 0.3352168
	speed: 0.0181s/iter; left time: 445.5426s
Epoch: 8 cost time: 4.879611968994141
Epoch: 8, Steps: 267 | Train Loss: 0.3317584 Vali Loss: 0.5252628 Test Loss: 0.3492071
Validation loss decreased (0.525861 --> 0.525263).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3197568
	speed: 0.0837s/iter; left time: 2048.3713s
	iters: 200, epoch: 9 | loss: 0.3416826
	speed: 0.0142s/iter; left time: 346.1796s
Epoch: 9 cost time: 4.5405659675598145
Epoch: 9, Steps: 267 | Train Loss: 0.3315092 Vali Loss: 0.5258337 Test Loss: 0.3490731
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3526277
	speed: 0.0735s/iter; left time: 1777.9023s
	iters: 200, epoch: 10 | loss: 0.3473305
	speed: 0.0158s/iter; left time: 381.1336s
Epoch: 10 cost time: 4.680289268493652
Epoch: 10, Steps: 267 | Train Loss: 0.3314500 Vali Loss: 0.5248543 Test Loss: 0.3489502
Validation loss decreased (0.525263 --> 0.524854).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3216022
	speed: 0.0710s/iter; left time: 1699.7203s
	iters: 200, epoch: 11 | loss: 0.3243421
	speed: 0.0127s/iter; left time: 302.9863s
Epoch: 11 cost time: 4.007122039794922
Epoch: 11, Steps: 267 | Train Loss: 0.3313149 Vali Loss: 0.5241454 Test Loss: 0.3485520
Validation loss decreased (0.524854 --> 0.524145).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3587556
	speed: 0.0675s/iter; left time: 1597.4063s
	iters: 200, epoch: 12 | loss: 0.3284230
	speed: 0.0130s/iter; left time: 305.4572s
Epoch: 12 cost time: 4.3149518966674805
Epoch: 12, Steps: 267 | Train Loss: 0.3312648 Vali Loss: 0.5238596 Test Loss: 0.3484223
Validation loss decreased (0.524145 --> 0.523860).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3744240
	speed: 0.0682s/iter; left time: 1596.7943s
	iters: 200, epoch: 13 | loss: 0.3712559
	speed: 0.0137s/iter; left time: 319.2840s
Epoch: 13 cost time: 4.523698091506958
Epoch: 13, Steps: 267 | Train Loss: 0.3312061 Vali Loss: 0.5236635 Test Loss: 0.3483616
Validation loss decreased (0.523860 --> 0.523664).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3256203
	speed: 0.0704s/iter; left time: 1627.2906s
	iters: 200, epoch: 14 | loss: 0.3440570
	speed: 0.0134s/iter; left time: 309.3041s
Epoch: 14 cost time: 4.610534191131592
Epoch: 14, Steps: 267 | Train Loss: 0.3311972 Vali Loss: 0.5233201 Test Loss: 0.3482411
Validation loss decreased (0.523664 --> 0.523320).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3616710
	speed: 0.0725s/iter; left time: 1656.8505s
	iters: 200, epoch: 15 | loss: 0.3230897
	speed: 0.0156s/iter; left time: 356.0118s
Epoch: 15 cost time: 4.985855340957642
Epoch: 15, Steps: 267 | Train Loss: 0.3310868 Vali Loss: 0.5234231 Test Loss: 0.3484679
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3415862
	speed: 0.0810s/iter; left time: 1829.9439s
	iters: 200, epoch: 16 | loss: 0.3328203
	speed: 0.0136s/iter; left time: 305.9168s
Epoch: 16 cost time: 4.728912353515625
Epoch: 16, Steps: 267 | Train Loss: 0.3311019 Vali Loss: 0.5240154 Test Loss: 0.3480634
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3494538
	speed: 0.0699s/iter; left time: 1560.0404s
	iters: 200, epoch: 17 | loss: 0.3148293
	speed: 0.0131s/iter; left time: 291.7171s
Epoch: 17 cost time: 4.237104177474976
Epoch: 17, Steps: 267 | Train Loss: 0.3309936 Vali Loss: 0.5235644 Test Loss: 0.3483513
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3646361
	speed: 0.0647s/iter; left time: 1427.8630s
	iters: 200, epoch: 18 | loss: 0.3596442
	speed: 0.0126s/iter; left time: 277.4922s
Epoch: 18 cost time: 4.029540538787842
Epoch: 18, Steps: 267 | Train Loss: 0.3310099 Vali Loss: 0.5238045 Test Loss: 0.3483364
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3204063
	speed: 0.0824s/iter; left time: 1796.1479s
	iters: 200, epoch: 19 | loss: 0.3203322
	speed: 0.0130s/iter; left time: 282.3117s
Epoch: 19 cost time: 4.641976833343506
Epoch: 19, Steps: 267 | Train Loss: 0.3309738 Vali Loss: 0.5238297 Test Loss: 0.3483479
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3230400
	speed: 0.0697s/iter; left time: 1500.3473s
	iters: 200, epoch: 20 | loss: 0.3401649
	speed: 0.0135s/iter; left time: 288.3631s
Epoch: 20 cost time: 4.349241018295288
Epoch: 20, Steps: 267 | Train Loss: 0.3309308 Vali Loss: 0.5230989 Test Loss: 0.3484451
Validation loss decreased (0.523320 --> 0.523099).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3733547
	speed: 0.0709s/iter; left time: 1506.8912s
	iters: 200, epoch: 21 | loss: 0.3400795
	speed: 0.0127s/iter; left time: 268.4830s
Epoch: 21 cost time: 4.532172203063965
Epoch: 21, Steps: 267 | Train Loss: 0.3309020 Vali Loss: 0.5237526 Test Loss: 0.3481975
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3117037
	speed: 0.0725s/iter; left time: 1522.2977s
	iters: 200, epoch: 22 | loss: 0.3204875
	speed: 0.0140s/iter; left time: 293.0211s
Epoch: 22 cost time: 4.423094272613525
Epoch: 22, Steps: 267 | Train Loss: 0.3308738 Vali Loss: 0.5230909 Test Loss: 0.3483129
Validation loss decreased (0.523099 --> 0.523091).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3274010
	speed: 0.0678s/iter; left time: 1405.1736s
	iters: 200, epoch: 23 | loss: 0.3263739
	speed: 0.0131s/iter; left time: 270.9023s
Epoch: 23 cost time: 4.151941299438477
Epoch: 23, Steps: 267 | Train Loss: 0.3308720 Vali Loss: 0.5234905 Test Loss: 0.3482114
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3692004
	speed: 0.0743s/iter; left time: 1519.9447s
	iters: 200, epoch: 24 | loss: 0.3301924
	speed: 0.0141s/iter; left time: 286.4040s
Epoch: 24 cost time: 5.024417161941528
Epoch: 24, Steps: 267 | Train Loss: 0.3308530 Vali Loss: 0.5233896 Test Loss: 0.3482028
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3456311
	speed: 0.0770s/iter; left time: 1555.6271s
	iters: 200, epoch: 25 | loss: 0.3171881
	speed: 0.0210s/iter; left time: 421.2734s
Epoch: 25 cost time: 6.271293878555298
Epoch: 25, Steps: 267 | Train Loss: 0.3308024 Vali Loss: 0.5229042 Test Loss: 0.3482637
Validation loss decreased (0.523091 --> 0.522904).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3245559
	speed: 0.0811s/iter; left time: 1616.1995s
	iters: 200, epoch: 26 | loss: 0.3238867
	speed: 0.0130s/iter; left time: 257.2648s
Epoch: 26 cost time: 4.123816967010498
Epoch: 26, Steps: 267 | Train Loss: 0.3308363 Vali Loss: 0.5227256 Test Loss: 0.3482872
Validation loss decreased (0.522904 --> 0.522726).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3250990
	speed: 0.0736s/iter; left time: 1446.3597s
	iters: 200, epoch: 27 | loss: 0.3400880
	speed: 0.0131s/iter; left time: 255.3905s
Epoch: 27 cost time: 4.320940732955933
Epoch: 27, Steps: 267 | Train Loss: 0.3308219 Vali Loss: 0.5228330 Test Loss: 0.3482167
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.3868105
	speed: 0.0656s/iter; left time: 1272.6480s
	iters: 200, epoch: 28 | loss: 0.3549460
	speed: 0.0118s/iter; left time: 227.0507s
Epoch: 28 cost time: 4.019223928451538
Epoch: 28, Steps: 267 | Train Loss: 0.3308074 Vali Loss: 0.5232178 Test Loss: 0.3481691
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3452705
	speed: 0.0704s/iter; left time: 1346.1249s
	iters: 200, epoch: 29 | loss: 0.3110845
	speed: 0.0124s/iter; left time: 235.2210s
Epoch: 29 cost time: 4.093558311462402
Epoch: 29, Steps: 267 | Train Loss: 0.3307409 Vali Loss: 0.5230068 Test Loss: 0.3482019
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3289817
	speed: 0.0694s/iter; left time: 1309.2437s
	iters: 200, epoch: 30 | loss: 0.3284896
	speed: 0.0138s/iter; left time: 258.5660s
Epoch: 30 cost time: 4.530110120773315
Epoch: 30, Steps: 267 | Train Loss: 0.3307206 Vali Loss: 0.5229623 Test Loss: 0.3481959
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3065820
	speed: 0.0699s/iter; left time: 1300.3767s
	iters: 200, epoch: 31 | loss: 0.3414733
	speed: 0.0150s/iter; left time: 276.4956s
Epoch: 31 cost time: 4.504045724868774
Epoch: 31, Steps: 267 | Train Loss: 0.3307658 Vali Loss: 0.5238247 Test Loss: 0.3482004
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.3199583
	speed: 0.0838s/iter; left time: 1535.1299s
	iters: 200, epoch: 32 | loss: 0.3490284
	speed: 0.0135s/iter; left time: 245.9361s
Epoch: 32 cost time: 4.536859512329102
Epoch: 32, Steps: 267 | Train Loss: 0.3307672 Vali Loss: 0.5228846 Test Loss: 0.3481685
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.3613916
	speed: 0.0750s/iter; left time: 1354.9330s
	iters: 200, epoch: 33 | loss: 0.3187128
	speed: 0.0134s/iter; left time: 240.3309s
Epoch: 33 cost time: 4.793384075164795
Epoch: 33, Steps: 267 | Train Loss: 0.3307523 Vali Loss: 0.5235736 Test Loss: 0.3482480
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3055798
	speed: 0.0825s/iter; left time: 1468.5451s
	iters: 200, epoch: 34 | loss: 0.4040883
	speed: 0.0139s/iter; left time: 245.2332s
Epoch: 34 cost time: 4.697405815124512
Epoch: 34, Steps: 267 | Train Loss: 0.3307191 Vali Loss: 0.5226961 Test Loss: 0.3482013
Validation loss decreased (0.522726 --> 0.522696).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3041167
	speed: 0.0763s/iter; left time: 1336.7426s
	iters: 200, epoch: 35 | loss: 0.3559719
	speed: 0.0151s/iter; left time: 263.8398s
Epoch: 35 cost time: 5.039170742034912
Epoch: 35, Steps: 267 | Train Loss: 0.3306967 Vali Loss: 0.5232967 Test Loss: 0.3482679
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3454393
	speed: 0.0809s/iter; left time: 1395.4737s
	iters: 200, epoch: 36 | loss: 0.3250427
	speed: 0.0128s/iter; left time: 219.9971s
Epoch: 36 cost time: 4.21004581451416
Epoch: 36, Steps: 267 | Train Loss: 0.3307311 Vali Loss: 0.5231202 Test Loss: 0.3482229
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3390084
	speed: 0.0685s/iter; left time: 1163.7756s
	iters: 200, epoch: 37 | loss: 0.3130677
	speed: 0.0138s/iter; left time: 232.3904s
Epoch: 37 cost time: 4.337377309799194
Epoch: 37, Steps: 267 | Train Loss: 0.3307068 Vali Loss: 0.5232093 Test Loss: 0.3482134
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3129071
	speed: 0.0753s/iter; left time: 1259.9515s
	iters: 200, epoch: 38 | loss: 0.3249864
	speed: 0.0146s/iter; left time: 242.1777s
Epoch: 38 cost time: 5.186420917510986
Epoch: 38, Steps: 267 | Train Loss: 0.3306971 Vali Loss: 0.5231319 Test Loss: 0.3481868
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3514813
	speed: 0.0793s/iter; left time: 1304.1080s
	iters: 200, epoch: 39 | loss: 0.3173243
	speed: 0.0163s/iter; left time: 267.3164s
Epoch: 39 cost time: 4.436589956283569
Epoch: 39, Steps: 267 | Train Loss: 0.3307118 Vali Loss: 0.5231521 Test Loss: 0.3481253
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3097297
	speed: 0.0742s/iter; left time: 1200.7478s
	iters: 200, epoch: 40 | loss: 0.3620438
	speed: 0.0217s/iter; left time: 349.4501s
Epoch: 40 cost time: 5.11469030380249
Epoch: 40, Steps: 267 | Train Loss: 0.3306803 Vali Loss: 0.5230640 Test Loss: 0.3481378
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.3061047
	speed: 0.0684s/iter; left time: 1088.9796s
	iters: 200, epoch: 41 | loss: 0.3107477
	speed: 0.0148s/iter; left time: 233.5830s
Epoch: 41 cost time: 4.720031976699829
Epoch: 41, Steps: 267 | Train Loss: 0.3306986 Vali Loss: 0.5230437 Test Loss: 0.3481579
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.3304334
	speed: 0.0842s/iter; left time: 1317.3723s
	iters: 200, epoch: 42 | loss: 0.3283138
	speed: 0.0133s/iter; left time: 206.6139s
Epoch: 42 cost time: 4.132033586502075
Epoch: 42, Steps: 267 | Train Loss: 0.3306278 Vali Loss: 0.5233428 Test Loss: 0.3481490
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.3066821
	speed: 0.0701s/iter; left time: 1078.2824s
	iters: 200, epoch: 43 | loss: 0.3347743
	speed: 0.0185s/iter; left time: 282.5912s
Epoch: 43 cost time: 5.173359155654907
Epoch: 43, Steps: 267 | Train Loss: 0.3306512 Vali Loss: 0.5228646 Test Loss: 0.3481653
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2896785
	speed: 0.0706s/iter; left time: 1068.2276s
	iters: 200, epoch: 44 | loss: 0.2982846
	speed: 0.0123s/iter; left time: 184.5661s
Epoch: 44 cost time: 4.052490949630737
Epoch: 44, Steps: 267 | Train Loss: 0.3306750 Vali Loss: 0.5234917 Test Loss: 0.3481413
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.3628918
	speed: 0.0786s/iter; left time: 1167.5467s
	iters: 200, epoch: 45 | loss: 0.3503650
	speed: 0.0136s/iter; left time: 200.2715s
Epoch: 45 cost time: 5.044888734817505
Epoch: 45, Steps: 267 | Train Loss: 0.3306469 Vali Loss: 0.5228978 Test Loss: 0.3481557
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2938205
	speed: 0.0732s/iter; left time: 1067.4490s
	iters: 200, epoch: 46 | loss: 0.3308635
	speed: 0.0186s/iter; left time: 268.9500s
Epoch: 46 cost time: 5.163318634033203
Epoch: 46, Steps: 267 | Train Loss: 0.3306691 Vali Loss: 0.5225629 Test Loss: 0.3481560
Validation loss decreased (0.522696 --> 0.522563).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.3361786
	speed: 0.0883s/iter; left time: 1264.6541s
	iters: 200, epoch: 47 | loss: 0.3217883
	speed: 0.0142s/iter; left time: 202.2068s
Epoch: 47 cost time: 4.714187860488892
Epoch: 47, Steps: 267 | Train Loss: 0.3306561 Vali Loss: 0.5224429 Test Loss: 0.3481669
Validation loss decreased (0.522563 --> 0.522443).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.3314726
	speed: 0.0736s/iter; left time: 1034.6309s
	iters: 200, epoch: 48 | loss: 0.2962200
	speed: 0.0160s/iter; left time: 223.6107s
Epoch: 48 cost time: 4.336011648178101
Epoch: 48, Steps: 267 | Train Loss: 0.3306777 Vali Loss: 0.5231208 Test Loss: 0.3481375
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.3666725
	speed: 0.0665s/iter; left time: 916.5481s
	iters: 200, epoch: 49 | loss: 0.2848684
	speed: 0.0127s/iter; left time: 174.3298s
Epoch: 49 cost time: 4.240575790405273
Epoch: 49, Steps: 267 | Train Loss: 0.3306743 Vali Loss: 0.5232891 Test Loss: 0.3481520
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.3367977
	speed: 0.0738s/iter; left time: 997.6843s
	iters: 200, epoch: 50 | loss: 0.3238799
	speed: 0.0160s/iter; left time: 215.2821s
Epoch: 50 cost time: 4.338944911956787
Epoch: 50, Steps: 267 | Train Loss: 0.3306510 Vali Loss: 0.5230952 Test Loss: 0.3481751
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.0497355408796396e-05
	iters: 100, epoch: 51 | loss: 0.3659481
	speed: 0.0714s/iter; left time: 946.1206s
	iters: 200, epoch: 51 | loss: 0.3555231
	speed: 0.0134s/iter; left time: 175.6126s
Epoch: 51 cost time: 4.287098407745361
Epoch: 51, Steps: 267 | Train Loss: 0.3306739 Vali Loss: 0.5225818 Test Loss: 0.3481409
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.8472487638356575e-05
	iters: 100, epoch: 52 | loss: 0.3480469
	speed: 0.0741s/iter; left time: 961.7149s
	iters: 200, epoch: 52 | loss: 0.3181149
	speed: 0.0144s/iter; left time: 185.1595s
Epoch: 52 cost time: 4.348721981048584
Epoch: 52, Steps: 267 | Train Loss: 0.3306218 Vali Loss: 0.5231966 Test Loss: 0.3481428
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.654886325643875e-05
	iters: 100, epoch: 53 | loss: 0.2972209
	speed: 0.0703s/iter; left time: 893.5909s
	iters: 200, epoch: 53 | loss: 0.2725850
	speed: 0.0191s/iter; left time: 241.2684s
Epoch: 53 cost time: 5.022246599197388
Epoch: 53, Steps: 267 | Train Loss: 0.3306594 Vali Loss: 0.5226123 Test Loss: 0.3481505
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.47214200936168e-05
	iters: 100, epoch: 54 | loss: 0.2862418
	speed: 0.0763s/iter; left time: 949.8378s
	iters: 200, epoch: 54 | loss: 0.3204098
	speed: 0.0130s/iter; left time: 159.9692s
Epoch: 54 cost time: 4.345774412155151
Epoch: 54, Steps: 267 | Train Loss: 0.3306684 Vali Loss: 0.5231332 Test Loss: 0.3481363
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.298534908893597e-05
	iters: 100, epoch: 55 | loss: 0.3052076
	speed: 0.0689s/iter; left time: 839.3658s
	iters: 200, epoch: 55 | loss: 0.3520853
	speed: 0.0142s/iter; left time: 171.2043s
Epoch: 55 cost time: 4.281498432159424
Epoch: 55, Steps: 267 | Train Loss: 0.3306626 Vali Loss: 0.5232736 Test Loss: 0.3481248
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.1336081634489166e-05
	iters: 100, epoch: 56 | loss: 0.3293047
	speed: 0.0732s/iter; left time: 871.7743s
	iters: 200, epoch: 56 | loss: 0.2993973
	speed: 0.0143s/iter; left time: 169.5110s
Epoch: 56 cost time: 4.666699647903442
Epoch: 56, Steps: 267 | Train Loss: 0.3305963 Vali Loss: 0.5231794 Test Loss: 0.3481447
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.9769277552764706e-05
	iters: 100, epoch: 57 | loss: 0.3107820
	speed: 0.0727s/iter; left time: 846.8156s
	iters: 200, epoch: 57 | loss: 0.2890765
	speed: 0.0118s/iter; left time: 136.5791s
Epoch: 57 cost time: 4.221006393432617
Epoch: 57, Steps: 267 | Train Loss: 0.3306330 Vali Loss: 0.5225569 Test Loss: 0.3481577
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.8280813675126466e-05
	iters: 100, epoch: 58 | loss: 0.3729267
	speed: 0.0722s/iter; left time: 821.9908s
	iters: 200, epoch: 58 | loss: 0.3199911
	speed: 0.0187s/iter; left time: 211.3515s
Epoch: 58 cost time: 5.035802125930786
Epoch: 58, Steps: 267 | Train Loss: 0.3306264 Vali Loss: 0.5225735 Test Loss: 0.3481475
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.6866772991370145e-05
	iters: 100, epoch: 59 | loss: 0.3105544
	speed: 0.0778s/iter; left time: 865.0182s
	iters: 200, epoch: 59 | loss: 0.2831445
	speed: 0.0141s/iter; left time: 155.0879s
Epoch: 59 cost time: 4.486889600753784
Epoch: 59, Steps: 267 | Train Loss: 0.3306501 Vali Loss: 0.5231912 Test Loss: 0.3481236
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.5523434341801633e-05
	iters: 100, epoch: 60 | loss: 0.3276808
	speed: 0.0681s/iter; left time: 738.3481s
	iters: 200, epoch: 60 | loss: 0.3415354
	speed: 0.0131s/iter; left time: 141.0360s
Epoch: 60 cost time: 4.146088361740112
Epoch: 60, Steps: 267 | Train Loss: 0.3306049 Vali Loss: 0.5229425 Test Loss: 0.3481483
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.4247262624711552e-05
	iters: 100, epoch: 61 | loss: 0.3253480
	speed: 0.0692s/iter; left time: 732.5961s
	iters: 200, epoch: 61 | loss: 0.3305079
	speed: 0.0133s/iter; left time: 139.7995s
Epoch: 61 cost time: 4.04920506477356
Epoch: 61, Steps: 267 | Train Loss: 0.3306499 Vali Loss: 0.5228574 Test Loss: 0.3481373
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.3034899493475973e-05
	iters: 100, epoch: 62 | loss: 0.3048936
	speed: 0.0673s/iter; left time: 693.7141s
	iters: 200, epoch: 62 | loss: 0.3806821
	speed: 0.0130s/iter; left time: 132.9604s
Epoch: 62 cost time: 4.156836271286011
Epoch: 62, Steps: 267 | Train Loss: 0.3306306 Vali Loss: 0.5221424 Test Loss: 0.3481487
Validation loss decreased (0.522443 --> 0.522142).  Saving model ...
Updating learning rate to 2.1883154518802173e-05
	iters: 100, epoch: 63 | loss: 0.3620839
	speed: 0.0700s/iter; left time: 703.1147s
	iters: 200, epoch: 63 | loss: 0.3105439
	speed: 0.0136s/iter; left time: 135.4034s
Epoch: 63 cost time: 4.191096305847168
Epoch: 63, Steps: 267 | Train Loss: 0.3306397 Vali Loss: 0.5230260 Test Loss: 0.3481371
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0788996792862066e-05
	iters: 100, epoch: 64 | loss: 0.3240181
	speed: 0.0737s/iter; left time: 720.7351s
	iters: 200, epoch: 64 | loss: 0.3371531
	speed: 0.0170s/iter; left time: 164.5478s
Epoch: 64 cost time: 5.061959505081177
Epoch: 64, Steps: 267 | Train Loss: 0.3305722 Vali Loss: 0.5231702 Test Loss: 0.3481485
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.974954695321896e-05
	iters: 100, epoch: 65 | loss: 0.3219874
	speed: 0.0712s/iter; left time: 677.0155s
	iters: 200, epoch: 65 | loss: 0.3464296
	speed: 0.0138s/iter; left time: 130.1401s
Epoch: 65 cost time: 4.346205949783325
Epoch: 65, Steps: 267 | Train Loss: 0.3306346 Vali Loss: 0.5235854 Test Loss: 0.3481484
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.876206960555801e-05
	iters: 100, epoch: 66 | loss: 0.3100478
	speed: 0.0642s/iter; left time: 594.0519s
	iters: 200, epoch: 66 | loss: 0.3302853
	speed: 0.0149s/iter; left time: 136.6472s
Epoch: 66 cost time: 4.45402193069458
Epoch: 66, Steps: 267 | Train Loss: 0.3306323 Vali Loss: 0.5229391 Test Loss: 0.3481380
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.782396612528011e-05
	iters: 100, epoch: 67 | loss: 0.3146588
	speed: 0.0727s/iter; left time: 653.2048s
	iters: 200, epoch: 67 | loss: 0.3613893
	speed: 0.0143s/iter; left time: 127.1633s
Epoch: 67 cost time: 4.309247255325317
Epoch: 67, Steps: 267 | Train Loss: 0.3306204 Vali Loss: 0.5225132 Test Loss: 0.3481454
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.6932767819016104e-05
	iters: 100, epoch: 68 | loss: 0.3403220
	speed: 0.0685s/iter; left time: 597.1507s
	iters: 200, epoch: 68 | loss: 0.3600016
	speed: 0.0131s/iter; left time: 112.7268s
Epoch: 68 cost time: 4.177827596664429
Epoch: 68, Steps: 267 | Train Loss: 0.3305604 Vali Loss: 0.5232136 Test Loss: 0.3481389
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.6086129428065296e-05
	iters: 100, epoch: 69 | loss: 0.3243692
	speed: 0.0825s/iter; left time: 696.5174s
	iters: 200, epoch: 69 | loss: 0.2973652
	speed: 0.0131s/iter; left time: 109.1366s
Epoch: 69 cost time: 4.98492169380188
Epoch: 69, Steps: 267 | Train Loss: 0.3305976 Vali Loss: 0.5234029 Test Loss: 0.3481398
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.5281822956662033e-05
	iters: 100, epoch: 70 | loss: 0.3601916
	speed: 0.0639s/iter; left time: 522.8227s
	iters: 200, epoch: 70 | loss: 0.3696834
	speed: 0.0129s/iter; left time: 104.5808s
Epoch: 70 cost time: 3.953634738922119
Epoch: 70, Steps: 267 | Train Loss: 0.3306016 Vali Loss: 0.5235201 Test Loss: 0.3481433
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.451773180882893e-05
	iters: 100, epoch: 71 | loss: 0.3020219
	speed: 0.0679s/iter; left time: 536.9894s
	iters: 200, epoch: 71 | loss: 0.3267049
	speed: 0.0136s/iter; left time: 106.1040s
Epoch: 71 cost time: 4.136998653411865
Epoch: 71, Steps: 267 | Train Loss: 0.3306004 Vali Loss: 0.5229627 Test Loss: 0.3481407
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.3791845218387483e-05
	iters: 100, epoch: 72 | loss: 0.3559781
	speed: 0.0597s/iter; left time: 456.0286s
	iters: 200, epoch: 72 | loss: 0.3162297
	speed: 0.0141s/iter; left time: 106.4957s
Epoch: 72 cost time: 4.303008556365967
Epoch: 72, Steps: 267 | Train Loss: 0.3306165 Vali Loss: 0.5224513 Test Loss: 0.3481362
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.3102252957468109e-05
	iters: 100, epoch: 73 | loss: 0.3483101
	speed: 0.0700s/iter; left time: 516.4972s
	iters: 200, epoch: 73 | loss: 0.2880571
	speed: 0.0126s/iter; left time: 91.7504s
Epoch: 73 cost time: 4.382735013961792
Epoch: 73, Steps: 267 | Train Loss: 0.3306220 Vali Loss: 0.5228794 Test Loss: 0.3481334
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.2447140309594702e-05
	iters: 100, epoch: 74 | loss: 0.3462038
	speed: 0.0686s/iter; left time: 487.5335s
	iters: 200, epoch: 74 | loss: 0.3225452
	speed: 0.0126s/iter; left time: 88.0698s
Epoch: 74 cost time: 4.135602951049805
Epoch: 74, Steps: 267 | Train Loss: 0.3306390 Vali Loss: 0.5232558 Test Loss: 0.3481404
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.1824783294114967e-05
	iters: 100, epoch: 75 | loss: 0.3191675
	speed: 0.0685s/iter; left time: 469.0707s
	iters: 200, epoch: 75 | loss: 0.3360618
	speed: 0.0145s/iter; left time: 98.0681s
Epoch: 75 cost time: 4.328256130218506
Epoch: 75, Steps: 267 | Train Loss: 0.3306295 Vali Loss: 0.5235474 Test Loss: 0.3481379
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.1233544129409218e-05
	iters: 100, epoch: 76 | loss: 0.3579906
	speed: 0.0654s/iter; left time: 430.0023s
	iters: 200, epoch: 76 | loss: 0.3125514
	speed: 0.0130s/iter; left time: 84.0281s
Epoch: 76 cost time: 4.123485803604126
Epoch: 76, Steps: 267 | Train Loss: 0.3306015 Vali Loss: 0.5226708 Test Loss: 0.3481360
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.0671866922938755e-05
	iters: 100, epoch: 77 | loss: 0.3264323
	speed: 0.0655s/iter; left time: 413.0392s
	iters: 200, epoch: 77 | loss: 0.3444469
	speed: 0.0130s/iter; left time: 80.8002s
Epoch: 77 cost time: 4.006122827529907
Epoch: 77, Steps: 267 | Train Loss: 0.3306137 Vali Loss: 0.5235869 Test Loss: 0.3481416
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.0138273576791817e-05
	iters: 100, epoch: 78 | loss: 0.3062092
	speed: 0.0716s/iter; left time: 432.5667s
	iters: 200, epoch: 78 | loss: 0.3610663
	speed: 0.0134s/iter; left time: 79.3859s
Epoch: 78 cost time: 4.587596893310547
Epoch: 78, Steps: 267 | Train Loss: 0.3305687 Vali Loss: 0.5221581 Test Loss: 0.3481342
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.631359897952226e-06
	iters: 100, epoch: 79 | loss: 0.3725249
	speed: 0.0811s/iter; left time: 468.4470s
	iters: 200, epoch: 79 | loss: 0.3080115
	speed: 0.0125s/iter; left time: 71.0838s
Epoch: 79 cost time: 3.8029422760009766
Epoch: 79, Steps: 267 | Train Loss: 0.3305904 Vali Loss: 0.5224696 Test Loss: 0.3481381
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.149791903054614e-06
	iters: 100, epoch: 80 | loss: 0.3299111
	speed: 0.0679s/iter; left time: 374.2618s
	iters: 200, epoch: 80 | loss: 0.3512541
	speed: 0.0189s/iter; left time: 102.0650s
Epoch: 80 cost time: 4.8487184047698975
Epoch: 80, Steps: 267 | Train Loss: 0.3305662 Vali Loss: 0.5230844 Test Loss: 0.3481406
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.692302307901884e-06
	iters: 100, epoch: 81 | loss: 0.3292483
	speed: 0.0666s/iter; left time: 349.2361s
	iters: 200, epoch: 81 | loss: 0.3152007
	speed: 0.0127s/iter; left time: 65.3500s
Epoch: 81 cost time: 4.431869029998779
Epoch: 81, Steps: 267 | Train Loss: 0.3306220 Vali Loss: 0.5228892 Test Loss: 0.3481401
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.25768719250679e-06
	iters: 100, epoch: 82 | loss: 0.3624927
	speed: 0.0759s/iter; left time: 377.3534s
	iters: 200, epoch: 82 | loss: 0.3043354
	speed: 0.0130s/iter; left time: 63.5557s
Epoch: 82 cost time: 4.313135862350464
Epoch: 82, Steps: 267 | Train Loss: 0.3305743 Vali Loss: 0.5226158 Test Loss: 0.3481404
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_180_192_FITS_ETTm1_ftM_sl180_ll48_pl192_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.34833723306655884, mae:0.36942407488822937, rse:0.5618255138397217, corr:[0.55087364 0.55334103 0.55225015 0.5496165  0.5474803  0.5468464
 0.54723626 0.54799515 0.54839563 0.54856324 0.5488293  0.54891664
 0.54872775 0.5476547  0.54569393 0.54341304 0.5412571  0.5394236
 0.537826   0.53627366 0.5346516  0.5328143  0.53073394 0.528494
 0.5261313  0.5237814  0.52173316 0.520143   0.519195   0.51890874
 0.51925874 0.5198821  0.5203131  0.5203674  0.5200305  0.5195215
 0.5189816  0.5185189  0.5182597  0.5180665  0.517919   0.517696
 0.5174255  0.5172439  0.5171932  0.51728505 0.51751596 0.5177902
 0.5179898  0.5180099  0.51791143 0.5178133  0.5178032  0.5178692
 0.5179754  0.51804525 0.51812834 0.51810616 0.51800066 0.51778394
 0.5175679  0.51741916 0.5173386  0.5173102  0.51732534 0.5174518
 0.51763433 0.5178089  0.5180419  0.51831    0.51861024 0.51888925
 0.5191074  0.5192267  0.51931477 0.5193115  0.51927674 0.5192181
 0.5191393  0.5190384  0.51895446 0.5188623  0.5187555  0.51855123
 0.51826406 0.51798576 0.51776934 0.5175457  0.51728314 0.5170601
 0.5168672  0.51665986 0.5163831  0.5160199  0.5155178  0.5147895
 0.5138916  0.51297987 0.51216936 0.5115296  0.511207   0.5112714
 0.5116403  0.5121949  0.51288056 0.5136894  0.51460785 0.51559395
 0.5165442  0.5172803  0.5177022  0.5179348  0.5179595  0.5178335
 0.5175823  0.5172999  0.5169709  0.5166048  0.5162728  0.51597387
 0.5157218  0.5153694  0.51486766 0.5142992  0.5137201  0.51320875
 0.51288176 0.51277065 0.5127982  0.51285315 0.5128168  0.51262116
 0.5122901  0.5119894  0.51175755 0.5115569  0.51145625 0.5113779
 0.51126957 0.5111844  0.5111231  0.5111261  0.511218   0.51139563
 0.5115832  0.511734   0.51174647 0.5116975  0.5117195  0.5117044
 0.51168925 0.5117086  0.51173234 0.5117581  0.5116949  0.51160604
 0.51152223 0.51149803 0.51149434 0.51154745 0.5116319  0.51173407
 0.5118351  0.5119238  0.51197964 0.51208746 0.51224077 0.51244587
 0.51270384 0.51291925 0.51300555 0.5130186  0.5129081  0.5126984
 0.51250637 0.512393   0.512421   0.51254284 0.5125714  0.5124337
 0.512104   0.51170737 0.5114366  0.5114728  0.51181775 0.51223063
 0.51239145 0.5121481  0.51180726 0.5123023  0.51463103 0.5182613 ]
