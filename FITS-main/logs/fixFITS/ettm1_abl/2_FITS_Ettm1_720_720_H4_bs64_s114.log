Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_720', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=720, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_720_FITS_ETTm1_ftM_sl720_ll48_pl720_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
Model(
  (freq_upsampler): Linear(in_features=42, out_features=84, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3161088.0
params:  3612.0
Trainable parameters:  3612
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5266448
	speed: 0.0238s/iter; left time: 610.4727s
	iters: 200, epoch: 1 | loss: 0.4200293
	speed: 0.0176s/iter; left time: 451.4990s
Epoch: 1 cost time: 5.1151018142700195
Epoch: 1, Steps: 258 | Train Loss: 0.5152224 Vali Loss: 1.2074156 Test Loss: 0.5891832
Validation loss decreased (inf --> 1.207416).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3443964
	speed: 0.0726s/iter; left time: 1846.4709s
	iters: 200, epoch: 2 | loss: 0.2968515
	speed: 0.0194s/iter; left time: 492.7100s
Epoch: 2 cost time: 5.327415227890015
Epoch: 2, Steps: 258 | Train Loss: 0.3303500 Vali Loss: 1.0651373 Test Loss: 0.4922059
Validation loss decreased (1.207416 --> 1.065137).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2784467
	speed: 0.0747s/iter; left time: 1881.4864s
	iters: 200, epoch: 3 | loss: 0.2597662
	speed: 0.0195s/iter; left time: 488.5538s
Epoch: 3 cost time: 5.353947162628174
Epoch: 3, Steps: 258 | Train Loss: 0.2746426 Vali Loss: 1.0095342 Test Loss: 0.4565746
Validation loss decreased (1.065137 --> 1.009534).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2573146
	speed: 0.0751s/iter; left time: 1871.4009s
	iters: 200, epoch: 4 | loss: 0.2417972
	speed: 0.0194s/iter; left time: 482.2037s
Epoch: 4 cost time: 5.286625385284424
Epoch: 4, Steps: 258 | Train Loss: 0.2508945 Vali Loss: 0.9818651 Test Loss: 0.4406981
Validation loss decreased (1.009534 --> 0.981865).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2497463
	speed: 0.0706s/iter; left time: 1740.5102s
	iters: 200, epoch: 5 | loss: 0.2268588
	speed: 0.0169s/iter; left time: 414.2811s
Epoch: 5 cost time: 4.731201887130737
Epoch: 5, Steps: 258 | Train Loss: 0.2387773 Vali Loss: 0.9662834 Test Loss: 0.4322735
Validation loss decreased (0.981865 --> 0.966283).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2304070
	speed: 0.0702s/iter; left time: 1714.7029s
	iters: 200, epoch: 6 | loss: 0.2403768
	speed: 0.0167s/iter; left time: 405.8000s
Epoch: 6 cost time: 4.76833176612854
Epoch: 6, Steps: 258 | Train Loss: 0.2319367 Vali Loss: 0.9573016 Test Loss: 0.4268493
Validation loss decreased (0.966283 --> 0.957302).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2321254
	speed: 0.0699s/iter; left time: 1688.1428s
	iters: 200, epoch: 7 | loss: 0.2325353
	speed: 0.0172s/iter; left time: 414.1484s
Epoch: 7 cost time: 5.026453256607056
Epoch: 7, Steps: 258 | Train Loss: 0.2276423 Vali Loss: 0.9524701 Test Loss: 0.4236075
Validation loss decreased (0.957302 --> 0.952470).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2284959
	speed: 0.0751s/iter; left time: 1793.6104s
	iters: 200, epoch: 8 | loss: 0.2046351
	speed: 0.0190s/iter; left time: 451.2310s
Epoch: 8 cost time: 5.266125679016113
Epoch: 8, Steps: 258 | Train Loss: 0.2249323 Vali Loss: 0.9480134 Test Loss: 0.4213511
Validation loss decreased (0.952470 --> 0.948013).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2242196
	speed: 0.0764s/iter; left time: 1806.9692s
	iters: 200, epoch: 9 | loss: 0.2275693
	speed: 0.0191s/iter; left time: 448.6284s
Epoch: 9 cost time: 5.3942506313323975
Epoch: 9, Steps: 258 | Train Loss: 0.2231576 Vali Loss: 0.9455239 Test Loss: 0.4204116
Validation loss decreased (0.948013 --> 0.945524).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2100763
	speed: 0.0751s/iter; left time: 1756.4253s
	iters: 200, epoch: 10 | loss: 0.2260590
	speed: 0.0182s/iter; left time: 423.1033s
Epoch: 10 cost time: 5.154335260391235
Epoch: 10, Steps: 258 | Train Loss: 0.2219600 Vali Loss: 0.9439435 Test Loss: 0.4199460
Validation loss decreased (0.945524 --> 0.943944).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2031874
	speed: 0.0741s/iter; left time: 1714.1960s
	iters: 200, epoch: 11 | loss: 0.2196680
	speed: 0.0190s/iter; left time: 436.3442s
Epoch: 11 cost time: 5.282057285308838
Epoch: 11, Steps: 258 | Train Loss: 0.2212124 Vali Loss: 0.9438573 Test Loss: 0.4197613
Validation loss decreased (0.943944 --> 0.943857).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2340461
	speed: 0.0745s/iter; left time: 1702.7664s
	iters: 200, epoch: 12 | loss: 0.2092923
	speed: 0.0192s/iter; left time: 437.4157s
Epoch: 12 cost time: 5.201662302017212
Epoch: 12, Steps: 258 | Train Loss: 0.2207106 Vali Loss: 0.9425982 Test Loss: 0.4200510
Validation loss decreased (0.943857 --> 0.942598).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2312971
	speed: 0.0713s/iter; left time: 1612.0398s
	iters: 200, epoch: 13 | loss: 0.2241939
	speed: 0.0168s/iter; left time: 377.3257s
Epoch: 13 cost time: 4.731804370880127
Epoch: 13, Steps: 258 | Train Loss: 0.2203548 Vali Loss: 0.9428355 Test Loss: 0.4201735
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2178109
	speed: 0.0722s/iter; left time: 1613.3565s
	iters: 200, epoch: 14 | loss: 0.2129022
	speed: 0.0169s/iter; left time: 375.2745s
Epoch: 14 cost time: 4.974679946899414
Epoch: 14, Steps: 258 | Train Loss: 0.2200881 Vali Loss: 0.9431254 Test Loss: 0.4206097
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2372777
	speed: 0.0700s/iter; left time: 1546.2371s
	iters: 200, epoch: 15 | loss: 0.2335270
	speed: 0.0183s/iter; left time: 402.0844s
Epoch: 15 cost time: 5.0734875202178955
Epoch: 15, Steps: 258 | Train Loss: 0.2198795 Vali Loss: 0.9428951 Test Loss: 0.4211415
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2315584
	speed: 0.0710s/iter; left time: 1549.9386s
	iters: 200, epoch: 16 | loss: 0.2101983
	speed: 0.0163s/iter; left time: 354.5217s
Epoch: 16 cost time: 4.676045894622803
Epoch: 16, Steps: 258 | Train Loss: 0.2197838 Vali Loss: 0.9443103 Test Loss: 0.4212251
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2017892
	speed: 0.0689s/iter; left time: 1485.4134s
	iters: 200, epoch: 17 | loss: 0.2207355
	speed: 0.0161s/iter; left time: 346.7004s
Epoch: 17 cost time: 4.654123067855835
Epoch: 17, Steps: 258 | Train Loss: 0.2197412 Vali Loss: 0.9430190 Test Loss: 0.4212820
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2108698
	speed: 0.0688s/iter; left time: 1467.1679s
	iters: 200, epoch: 18 | loss: 0.2127043
	speed: 0.0161s/iter; left time: 340.9221s
Epoch: 18 cost time: 4.662889003753662
Epoch: 18, Steps: 258 | Train Loss: 0.2196646 Vali Loss: 0.9432901 Test Loss: 0.4218127
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1999093
	speed: 0.0685s/iter; left time: 1442.9739s
	iters: 200, epoch: 19 | loss: 0.2239838
	speed: 0.0158s/iter; left time: 331.9214s
Epoch: 19 cost time: 4.576464653015137
Epoch: 19, Steps: 258 | Train Loss: 0.2196054 Vali Loss: 0.9431854 Test Loss: 0.4220010
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2055376
	speed: 0.0688s/iter; left time: 1431.6404s
	iters: 200, epoch: 20 | loss: 0.2208571
	speed: 0.0161s/iter; left time: 332.5740s
Epoch: 20 cost time: 4.697977304458618
Epoch: 20, Steps: 258 | Train Loss: 0.2195836 Vali Loss: 0.9441804 Test Loss: 0.4224181
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2108605
	speed: 0.0659s/iter; left time: 1353.4840s
	iters: 200, epoch: 21 | loss: 0.2078307
	speed: 0.0158s/iter; left time: 322.6979s
Epoch: 21 cost time: 4.552425384521484
Epoch: 21, Steps: 258 | Train Loss: 0.2195133 Vali Loss: 0.9431241 Test Loss: 0.4226338
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2012690
	speed: 0.0676s/iter; left time: 1370.6372s
	iters: 200, epoch: 22 | loss: 0.2218505
	speed: 0.0170s/iter; left time: 344.0157s
Epoch: 22 cost time: 4.670395374298096
Epoch: 22, Steps: 258 | Train Loss: 0.2195628 Vali Loss: 0.9433344 Test Loss: 0.4227343
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2196705
	speed: 0.0687s/iter; left time: 1375.0928s
	iters: 200, epoch: 23 | loss: 0.2290040
	speed: 0.0168s/iter; left time: 335.6555s
Epoch: 23 cost time: 4.7204883098602295
Epoch: 23, Steps: 258 | Train Loss: 0.2195250 Vali Loss: 0.9441230 Test Loss: 0.4225980
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2079128
	speed: 0.0681s/iter; left time: 1346.3774s
	iters: 200, epoch: 24 | loss: 0.2107383
	speed: 0.0157s/iter; left time: 309.3089s
Epoch: 24 cost time: 4.648755073547363
Epoch: 24, Steps: 258 | Train Loss: 0.2194854 Vali Loss: 0.9434451 Test Loss: 0.4227949
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2288391
	speed: 0.0703s/iter; left time: 1371.8368s
	iters: 200, epoch: 25 | loss: 0.2173032
	speed: 0.0168s/iter; left time: 325.5793s
Epoch: 25 cost time: 4.8545920848846436
Epoch: 25, Steps: 258 | Train Loss: 0.2195214 Vali Loss: 0.9435410 Test Loss: 0.4226366
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2343491
	speed: 0.0677s/iter; left time: 1303.5969s
	iters: 200, epoch: 26 | loss: 0.2379112
	speed: 0.0169s/iter; left time: 323.5969s
Epoch: 26 cost time: 4.666465759277344
