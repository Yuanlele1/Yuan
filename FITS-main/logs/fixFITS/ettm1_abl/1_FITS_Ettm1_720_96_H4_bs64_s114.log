Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=42, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=4, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=42, out_features=47, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1768704.0
params:  2021.0
Trainable parameters:  2021
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3053322
	speed: 0.0177s/iter; left time: 463.1831s
	iters: 200, epoch: 1 | loss: 0.3197948
	speed: 0.0142s/iter; left time: 370.5737s
Epoch: 1 cost time: 4.071096658706665
Epoch: 1, Steps: 263 | Train Loss: 0.3359469 Vali Loss: 0.4477605 Test Loss: 0.3220229
Validation loss decreased (inf --> 0.447760).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2782812
	speed: 0.0589s/iter; left time: 1528.2696s
	iters: 200, epoch: 2 | loss: 0.2916072
	speed: 0.0137s/iter; left time: 353.5429s
Epoch: 2 cost time: 4.11878776550293
Epoch: 2, Steps: 263 | Train Loss: 0.2796885 Vali Loss: 0.4258790 Test Loss: 0.3196389
Validation loss decreased (0.447760 --> 0.425879).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2545497
	speed: 0.0572s/iter; left time: 1468.2436s
	iters: 200, epoch: 3 | loss: 0.3099317
	speed: 0.0145s/iter; left time: 370.8943s
Epoch: 3 cost time: 4.135095596313477
Epoch: 3, Steps: 263 | Train Loss: 0.2752401 Vali Loss: 0.4167016 Test Loss: 0.3182749
Validation loss decreased (0.425879 --> 0.416702).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2668486
	speed: 0.0578s/iter; left time: 1469.7074s
	iters: 200, epoch: 4 | loss: 0.2715138
	speed: 0.0143s/iter; left time: 362.6200s
Epoch: 4 cost time: 4.120473384857178
Epoch: 4, Steps: 263 | Train Loss: 0.2735401 Vali Loss: 0.4128684 Test Loss: 0.3182671
Validation loss decreased (0.416702 --> 0.412868).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2808357
	speed: 0.0591s/iter; left time: 1486.7421s
	iters: 200, epoch: 5 | loss: 0.2676896
	speed: 0.0144s/iter; left time: 361.0678s
Epoch: 5 cost time: 4.261840105056763
Epoch: 5, Steps: 263 | Train Loss: 0.2727500 Vali Loss: 0.4086865 Test Loss: 0.3172298
Validation loss decreased (0.412868 --> 0.408687).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2212350
	speed: 0.0580s/iter; left time: 1442.6400s
	iters: 200, epoch: 6 | loss: 0.2821103
	speed: 0.0138s/iter; left time: 342.0949s
Epoch: 6 cost time: 4.196691513061523
Epoch: 6, Steps: 263 | Train Loss: 0.2721594 Vali Loss: 0.4079064 Test Loss: 0.3174300
Validation loss decreased (0.408687 --> 0.407906).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2613890
	speed: 0.0569s/iter; left time: 1400.0420s
	iters: 200, epoch: 7 | loss: 0.2711429
	speed: 0.0143s/iter; left time: 350.8839s
Epoch: 7 cost time: 4.040602684020996
Epoch: 7, Steps: 263 | Train Loss: 0.2717931 Vali Loss: 0.4084623 Test Loss: 0.3182918
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2826620
	speed: 0.0572s/iter; left time: 1392.3878s
	iters: 200, epoch: 8 | loss: 0.2748697
	speed: 0.0147s/iter; left time: 357.4612s
Epoch: 8 cost time: 4.204738616943359
Epoch: 8, Steps: 263 | Train Loss: 0.2715623 Vali Loss: 0.4071002 Test Loss: 0.3175723
Validation loss decreased (0.407906 --> 0.407100).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2639974
	speed: 0.0571s/iter; left time: 1377.0109s
	iters: 200, epoch: 9 | loss: 0.2500632
	speed: 0.0139s/iter; left time: 332.4975s
Epoch: 9 cost time: 4.051656246185303
Epoch: 9, Steps: 263 | Train Loss: 0.2714105 Vali Loss: 0.4084880 Test Loss: 0.3177067
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2489583
	speed: 0.0578s/iter; left time: 1378.4178s
	iters: 200, epoch: 10 | loss: 0.2699785
	speed: 0.0146s/iter; left time: 345.6480s
Epoch: 10 cost time: 4.165502071380615
Epoch: 10, Steps: 263 | Train Loss: 0.2712838 Vali Loss: 0.4069251 Test Loss: 0.3175539
Validation loss decreased (0.407100 --> 0.406925).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2773063
	speed: 0.0565s/iter; left time: 1331.6268s
	iters: 200, epoch: 11 | loss: 0.2680805
	speed: 0.0145s/iter; left time: 340.4182s
Epoch: 11 cost time: 4.301008939743042
Epoch: 11, Steps: 263 | Train Loss: 0.2713207 Vali Loss: 0.4057309 Test Loss: 0.3170915
Validation loss decreased (0.406925 --> 0.405731).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2655403
	speed: 0.0590s/iter; left time: 1374.1183s
	iters: 200, epoch: 12 | loss: 0.2941791
	speed: 0.0141s/iter; left time: 328.2963s
Epoch: 12 cost time: 4.092720031738281
Epoch: 12, Steps: 263 | Train Loss: 0.2711491 Vali Loss: 0.4064081 Test Loss: 0.3185463
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2383593
	speed: 0.0564s/iter; left time: 1300.7107s
	iters: 200, epoch: 13 | loss: 0.2554557
	speed: 0.0145s/iter; left time: 333.5842s
Epoch: 13 cost time: 4.141516208648682
Epoch: 13, Steps: 263 | Train Loss: 0.2709557 Vali Loss: 0.4062050 Test Loss: 0.3183104
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2895933
	speed: 0.0568s/iter; left time: 1293.1270s
	iters: 200, epoch: 14 | loss: 0.2711232
	speed: 0.0151s/iter; left time: 342.3201s
Epoch: 14 cost time: 4.214957237243652
Epoch: 14, Steps: 263 | Train Loss: 0.2709285 Vali Loss: 0.4037343 Test Loss: 0.3177448
Validation loss decreased (0.405731 --> 0.403734).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2542378
	speed: 0.0577s/iter; left time: 1299.1677s
	iters: 200, epoch: 15 | loss: 0.2629650
	speed: 0.0142s/iter; left time: 318.1258s
Epoch: 15 cost time: 4.162305593490601
Epoch: 15, Steps: 263 | Train Loss: 0.2709376 Vali Loss: 0.4045413 Test Loss: 0.3180481
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2649940
	speed: 0.0576s/iter; left time: 1282.2734s
	iters: 200, epoch: 16 | loss: 0.2773850
	speed: 0.0139s/iter; left time: 308.9053s
Epoch: 16 cost time: 4.188323736190796
Epoch: 16, Steps: 263 | Train Loss: 0.2709061 Vali Loss: 0.4048631 Test Loss: 0.3178041
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2629426
	speed: 0.0573s/iter; left time: 1259.4209s
	iters: 200, epoch: 17 | loss: 0.2950503
	speed: 0.0146s/iter; left time: 320.0608s
Epoch: 17 cost time: 4.2138776779174805
Epoch: 17, Steps: 263 | Train Loss: 0.2707361 Vali Loss: 0.4063302 Test Loss: 0.3175946
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2797394
	speed: 0.0600s/iter; left time: 1304.0059s
	iters: 200, epoch: 18 | loss: 0.2720048
	speed: 0.0143s/iter; left time: 309.3947s
Epoch: 18 cost time: 4.197356700897217
Epoch: 18, Steps: 263 | Train Loss: 0.2707941 Vali Loss: 0.4045817 Test Loss: 0.3178105
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2513229
	speed: 0.0581s/iter; left time: 1246.7854s
	iters: 200, epoch: 19 | loss: 0.3024978
	speed: 0.0137s/iter; left time: 292.1001s
Epoch: 19 cost time: 4.0199501514434814
Epoch: 19, Steps: 263 | Train Loss: 0.2707049 Vali Loss: 0.4041938 Test Loss: 0.3177422
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2713524
	speed: 0.0577s/iter; left time: 1224.4304s
	iters: 200, epoch: 20 | loss: 0.2467602
	speed: 0.0153s/iter; left time: 323.4871s
Epoch: 20 cost time: 4.274360656738281
Epoch: 20, Steps: 263 | Train Loss: 0.2707319 Vali Loss: 0.4036873 Test Loss: 0.3177344
Validation loss decreased (0.403734 --> 0.403687).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2774836
	speed: 0.0594s/iter; left time: 1243.3234s
	iters: 200, epoch: 21 | loss: 0.2895794
	speed: 0.0146s/iter; left time: 303.6874s
Epoch: 21 cost time: 4.212448835372925
Epoch: 21, Steps: 263 | Train Loss: 0.2707056 Vali Loss: 0.4047713 Test Loss: 0.3174289
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2731068
	speed: 0.0571s/iter; left time: 1180.8468s
	iters: 200, epoch: 22 | loss: 0.2557176
	speed: 0.0146s/iter; left time: 300.8197s
Epoch: 22 cost time: 4.209133625030518
Epoch: 22, Steps: 263 | Train Loss: 0.2706576 Vali Loss: 0.4054368 Test Loss: 0.3175399
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2498703
	speed: 0.0582s/iter; left time: 1188.2402s
	iters: 200, epoch: 23 | loss: 0.2883419
	speed: 0.0147s/iter; left time: 298.3245s
Epoch: 23 cost time: 4.323810577392578
Epoch: 23, Steps: 263 | Train Loss: 0.2705878 Vali Loss: 0.4051605 Test Loss: 0.3172527
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2564371
	speed: 0.0574s/iter; left time: 1156.2146s
	iters: 200, epoch: 24 | loss: 0.2615140
	speed: 0.0141s/iter; left time: 283.1276s
Epoch: 24 cost time: 4.112748622894287
Epoch: 24, Steps: 263 | Train Loss: 0.2705330 Vali Loss: 0.4056898 Test Loss: 0.3173454
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2806638
	speed: 0.0575s/iter; left time: 1144.1301s
	iters: 200, epoch: 25 | loss: 0.2688953
	speed: 0.0147s/iter; left time: 290.5545s
Epoch: 25 cost time: 4.164685964584351
Epoch: 25, Steps: 263 | Train Loss: 0.2706209 Vali Loss: 0.4055369 Test Loss: 0.3174358
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2539742
	speed: 0.0583s/iter; left time: 1145.1550s
	iters: 200, epoch: 26 | loss: 0.2760175
	speed: 0.0144s/iter; left time: 282.0470s
Epoch: 26 cost time: 4.285861253738403
Epoch: 26, Steps: 263 | Train Loss: 0.2705610 Vali Loss: 0.4053594 Test Loss: 0.3175820
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2781565
	speed: 0.0570s/iter; left time: 1103.0287s
	iters: 200, epoch: 27 | loss: 0.2741793
	speed: 0.0139s/iter; left time: 266.8013s
Epoch: 27 cost time: 4.151201248168945
Epoch: 27, Steps: 263 | Train Loss: 0.2704479 Vali Loss: 0.4046995 Test Loss: 0.3171353
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2510971
	speed: 0.0574s/iter; left time: 1096.3400s
	iters: 200, epoch: 28 | loss: 0.2453772
	speed: 0.0140s/iter; left time: 266.1862s
Epoch: 28 cost time: 4.094749450683594
Epoch: 28, Steps: 263 | Train Loss: 0.2704738 Vali Loss: 0.4047280 Test Loss: 0.3173411
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2667300
	speed: 0.0580s/iter; left time: 1092.6916s
	iters: 200, epoch: 29 | loss: 0.2755600
	speed: 0.0146s/iter; left time: 272.7189s
Epoch: 29 cost time: 4.202911376953125
Epoch: 29, Steps: 263 | Train Loss: 0.2704609 Vali Loss: 0.4046775 Test Loss: 0.3174356
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2692137
	speed: 0.0583s/iter; left time: 1083.2390s
	iters: 200, epoch: 30 | loss: 0.2446208
	speed: 0.0146s/iter; left time: 269.3927s
Epoch: 30 cost time: 4.21485710144043
Epoch: 30, Steps: 263 | Train Loss: 0.2704910 Vali Loss: 0.4041180 Test Loss: 0.3176852
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2870389
	speed: 0.0572s/iter; left time: 1047.8621s
	iters: 200, epoch: 31 | loss: 0.2923904
	speed: 0.0146s/iter; left time: 266.5539s
Epoch: 31 cost time: 4.1796653270721436
Epoch: 31, Steps: 263 | Train Loss: 0.2704115 Vali Loss: 0.4051165 Test Loss: 0.3175406
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2546578
	speed: 0.0576s/iter; left time: 1038.8630s
	iters: 200, epoch: 32 | loss: 0.2819103
	speed: 0.0144s/iter; left time: 257.8240s
Epoch: 32 cost time: 4.117347717285156
Epoch: 32, Steps: 263 | Train Loss: 0.2704236 Vali Loss: 0.4046870 Test Loss: 0.3177444
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2427335
	speed: 0.0577s/iter; left time: 1026.3124s
	iters: 200, epoch: 33 | loss: 0.2475122
	speed: 0.0147s/iter; left time: 260.3172s
Epoch: 33 cost time: 4.199029207229614
Epoch: 33, Steps: 263 | Train Loss: 0.2704227 Vali Loss: 0.4048078 Test Loss: 0.3176654
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2956960
	speed: 0.0582s/iter; left time: 1020.2343s
	iters: 200, epoch: 34 | loss: 0.3228054
	speed: 0.0142s/iter; left time: 247.9103s
Epoch: 34 cost time: 4.15153169631958
Epoch: 34, Steps: 263 | Train Loss: 0.2703272 Vali Loss: 0.4049244 Test Loss: 0.3171086
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3013501
	speed: 0.0568s/iter; left time: 980.8134s
	iters: 200, epoch: 35 | loss: 0.2629797
	speed: 0.0138s/iter; left time: 236.7615s
Epoch: 35 cost time: 4.1501898765563965
Epoch: 35, Steps: 263 | Train Loss: 0.2703442 Vali Loss: 0.4050790 Test Loss: 0.3174429
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2310386
	speed: 0.0586s/iter; left time: 995.3260s
	iters: 200, epoch: 36 | loss: 0.2778690
	speed: 0.0143s/iter; left time: 241.5905s
Epoch: 36 cost time: 4.173756837844849
Epoch: 36, Steps: 263 | Train Loss: 0.2703399 Vali Loss: 0.4047700 Test Loss: 0.3174001
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2667016
	speed: 0.0597s/iter; left time: 998.2009s
	iters: 200, epoch: 37 | loss: 0.2940889
	speed: 0.0144s/iter; left time: 238.7171s
Epoch: 37 cost time: 4.204370737075806
Epoch: 37, Steps: 263 | Train Loss: 0.2704196 Vali Loss: 0.4046881 Test Loss: 0.3173581
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2936775
	speed: 0.0591s/iter; left time: 973.8183s
	iters: 200, epoch: 38 | loss: 0.2824214
	speed: 0.0149s/iter; left time: 243.3268s
Epoch: 38 cost time: 4.275091648101807
Epoch: 38, Steps: 263 | Train Loss: 0.2704160 Vali Loss: 0.4041141 Test Loss: 0.3174599
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2599719
	speed: 0.0572s/iter; left time: 927.3018s
	iters: 200, epoch: 39 | loss: 0.2794869
	speed: 0.0140s/iter; left time: 225.0337s
Epoch: 39 cost time: 4.159181118011475
Epoch: 39, Steps: 263 | Train Loss: 0.2703838 Vali Loss: 0.4047808 Test Loss: 0.3173141
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2808004
	speed: 0.0599s/iter; left time: 954.6103s
	iters: 200, epoch: 40 | loss: 0.2358878
	speed: 0.0149s/iter; left time: 235.5685s
Epoch: 40 cost time: 4.3014233112335205
Epoch: 40, Steps: 263 | Train Loss: 0.2702697 Vali Loss: 0.4053697 Test Loss: 0.3172702
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31938597559928894, mae:0.35995200276374817, rse:0.5377616286277771, corr:[0.5493811  0.5534796  0.5573466  0.5607083  0.5633459  0.5653088
 0.5666438  0.5674697  0.5679545  0.56821346 0.56835335 0.5683199
 0.5681396  0.56775    0.5671064  0.5661882  0.56504595 0.5636988
 0.5621625  0.56048524 0.5587828  0.5571041  0.5555168  0.5541849
 0.5531158  0.5524103  0.5520983  0.5520683  0.55229867 0.5526928
 0.5531302  0.55354494 0.55380803 0.5539282  0.5538236  0.5535896
 0.5531881  0.5527203  0.552269   0.55181843 0.5514452  0.5511669
 0.5509973  0.5510166  0.5511668  0.55137837 0.5516524  0.5519159
 0.5520572  0.5519705  0.55170196 0.5513002  0.550853   0.5503732
 0.5499477  0.54963213 0.54945844 0.5494135  0.5495107  0.5496717
 0.54987484 0.55008215 0.55023587 0.55024207 0.55013096 0.5499153
 0.5495885  0.5491888  0.54878694 0.5484103  0.5481213  0.54792595
 0.5477927  0.547696   0.5476423  0.5475962  0.54751813 0.54741013
 0.5472543  0.5470548  0.5468139  0.5465126  0.5461706  0.54577917
 0.54540193 0.54506344 0.54483426 0.5447067  0.5447086  0.5448722
 0.54516786 0.54548836 0.54573905 0.5458067  0.545558   0.5448008 ]
